<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Would use latest version, you'd better specify a version -->
    <script src="https://unpkg.com/naive-ui"></script>

    <title>Bruno</title>
    <style>
      .error > .status {
        color: red;
      }
      .success > .status {
        color: green;
      }

      .n-collapse-item.success > .n-collapse-item__header {
        background-color: rgba(237, 247, 242, 1);
      }
      .n-collapse-item.error > .n-collapse-item__header {
        background-color: rgba(251, 238, 241, 1);
      }
      .skipped > .status {
        color: orange;
      }

      .min-width-150 {
        min-width: 150px;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <n-config-provider :theme="theme">
        <n-layout embedded position="absolute" content-style="padding: 24px;">
          <n-card>
            <n-flex>
              <n-page-header title="Bruno run dashboard">
                <template #avatar>
                  <n-avatar size="large" style="background-color: transparent">
                    <svg id="emoji" width="34" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg">
                      <g id="color">
                        <path
                          fill="#F4AA41"
                          stroke="none"
                          d="M23.5,14.5855l-4.5,1.75l-7.25,8.5l-4.5,10.75l2,5.25c1.2554,3.7911,3.5231,7.1832,7.25,10l2.5-3.3333 c0,0,3.8218,7.7098,10.7384,8.9598c0,0,10.2616,1.936,15.5949-0.8765c3.4203-1.8037,4.4167-4.4167,4.4167-4.4167l3.4167-3.4167 l1.5833,2.3333l2.0833-0.0833l5.4167-7.25L64,37.3355l-0.1667-4.5l-2.3333-5.5l-4.8333-7.4167c0,0-2.6667-4.9167-8.1667-3.9167 c0,0-6.5-4.8333-11.8333-4.0833S32.0833,10.6688,23.5,14.5855z"
                        ></path>
                        <polygon
                          fill="#EA5A47"
                          stroke="none"
                          points="36,47.2521 32.9167,49.6688 30.4167,49.6688 30.3333,53.5021 31.0833,57.0021 32.1667,58.9188 35,60.4188 39.5833,59.8355 41.1667,58.0855 42.1667,53.8355 41.9167,49.8355 39.9167,50.0855"
                        ></polygon>
                        <polygon
                          fill="#3F3F3F"
                          stroke="none"
                          points="32.5,36.9188 30.9167,40.6688 33.0833,41.9188 34.3333,42.4188 38.6667,42.5855 41.5833,40.3355 39.8333,37.0855"
                        ></polygon>
                      </g>
                      <g id="hair"></g>
                      <g id="skin"></g>
                      <g id="skin-shadow"></g>
                      <g id="line">
                        <path
                          fill="#000000"
                          stroke="none"
                          d="M29.5059,30.1088c0,0-1.8051,1.2424-2.7484,0.6679c-0.9434-0.5745-1.2424-1.8051-0.6679-2.7484 s1.805-1.2424,2.7484-0.6679S29.5059,30.1088,29.5059,30.1088z"
                        ></path>
                        <path
                          fill="none"
                          stroke="#000000"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-miterlimit="10"
                          stroke-width="2"
                          d="M33.1089,37.006h6.1457c0.4011,0,0.7634,0.2397,0.9203,0.6089l1.1579,2.7245l-2.1792,1.1456 c-0.6156,0.3236-1.3654-0.0645-1.4567-0.754"
                        ></path>
                        <path
                          fill="none"
                          stroke="#000000"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-miterlimit="10"
                          stroke-width="2"
                          d="M34.7606,40.763c-0.1132,0.6268-0.7757,0.9895-1.3647,0.7471l-2.3132-0.952l1.0899-2.9035 c0.1465-0.3901,0.5195-0.6486,0.9362-0.6486"
                        ></path>
                        <path
                          fill="none"
                          stroke="#000000"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-miterlimit="10"
                          stroke-width="2"
                          d="M30.4364,50.0268c0,0-0.7187,8.7934,3.0072,9.9375c2.6459,0.8125,5.1497,0.5324,6.0625-0.25 c0.875-0.75,2.6323-4.4741,1.8267-9.6875"
                        ></path>
                        <path
                          fill="#000000"
                          stroke="none"
                          d="M44.2636,30.1088c0,0,1.805,1.2424,2.7484,0.6679c0.9434-0.5745,1.2424-1.8051,0.6679-2.7484 c-0.5745-0.9434-1.805-1.2424-2.7484-0.6679C43.9881,27.9349,44.2636,30.1088,44.2636,30.1088z"
                        ></path>
                        <path
                          fill="none"
                          stroke="#000000"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-miterlimit="10"
                          stroke-width="2"
                          d="M25.6245,42.8393c-0.475,3.6024,2.2343,5.7505,4.2847,6.8414c1.1968,0.6367,2.6508,0.5182,3.7176-0.3181l2.581-2.0233l2.581,2.0233 c1.0669,0.8363,2.5209,0.9548,3.7176,0.3181c2.0504-1.0909,4.7597-3.239,4.2847-6.8414"
                        ></path>
                        <path
                          fill="none"
                          stroke="#000000"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-miterlimit="10"
                          stroke-width="2"
                          d="M19.9509,28.3572c-2.3166,5.1597-0.5084,13.0249,0.119,15.3759c0.122,0.4571,0.0755,0.9355-0.1271,1.3631l-1.9874,4.1937 c-0.623,1.3146-2.3934,1.5533-3.331,0.4409c-3.1921-3.7871-8.5584-11.3899-6.5486-16.686 c7.0625-18.6104,15.8677-18.1429,15.8677-18.1429c2.8453-1.9336,13.1042-6.9375,24.8125,0.875c0,0,8.6323-1.7175,14.9375,16.9375 c1.8036,5.3362-3.4297,12.8668-6.5506,16.6442c-0.9312,1.127-2.7162,0.8939-3.3423-0.4272l-1.9741-4.1656 c-0.2026-0.4275-0.2491-0.906-0.1271-1.3631c0.6275-2.3509,2.4356-10.2161,0.119-15.3759"
                        ></path>
                        <path
                          fill="none"
                          stroke="#000000"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-miterlimit="10"
                          stroke-width="2"
                          d="M52.6309,46.4628c0,0-3.0781,6.7216-7.8049,8.2712"
                        ></path>
                        <path
                          fill="none"
                          stroke="#000000"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-miterlimit="10"
                          stroke-width="2"
                          d="M19.437,46.969c0,0,3.0781,6.0823,7.8049,7.632"
                        ></path>
                        <line
                          x1="36.2078"
                          x2="36.2078"
                          y1="47.3393"
                          y2="44.3093"
                          fill="none"
                          stroke="#000000"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-miterlimit="10"
                          stroke-width="2"
                        ></line>
                      </g>
                    </svg>
                  </n-avatar>
                </template>
                <template #extra>
                  <n-flex justify="end">
                    <n-switch v-model:value="darkMode" :rail-style="darkModeRailStyle">
                      <template #checked> Dark </template>
                      <template #unchecked> Light </template>
                    </n-switch>
                  </n-flex>
                </template>
              </n-page-header>
              <n-tabs type="segment" animated v-model:value="currentTab">
                <n-tab-pane name="summary" tab="Summary">
                  <n-flex justify="center" vertical>
                    <x-summary v-for="(result, index) in res" :res="result" :key="index"></x-summary>
                  </n-flex>
                </n-tab-pane>
                <n-tab-pane name="requests" tab="Requests">
                  <n-flex justify="center" vertical>
                    <x-requests v-for="(result, index) in res" :res="result" :key="index"></x-requests>
                  </n-flex>
                </n-tab-pane>
              </n-tabs>
            </n-flex>
          </n-card>
        </n-layout>
      </n-config-provider>
    </div>
    <script type="text/x-template" id="summary-component">
      <n-flex vertical style="margin-bottom: 50px;">
        <n-card>
          <template #header>
            <span style="font-size: 24px;">{{ iterationTitle }}</span>
          </template>
          <n-flex justify="center">
            <n-flex justify="center">
              <n-alert type="success">
                <n-statistic
                  label="Total requests"
                  :value="summaryTotalRequests"
                >
                </n-statistic>
              </n-alert>
              <n-alert :type="summaryErrors ? 'error' : 'success'">
                <n-statistic label="Total errors" :value="summaryErrors">
                </n-statistic>
              </n-alert>
              <n-alert type="success">
                <n-statistic
                  label="Total Controls"
                  :value="summaryTotalControls"
                >
                </n-statistic>
              </n-alert>
              <n-alert :type="summaryFailedControls ? 'error' : 'success'">
                <n-statistic
                  label="Total Failed Controls"
                  :value="summaryFailedControls"
                >
                </n-statistic>
              </n-alert>
              <n-alert type="warning" v-if="summarySkippedRequests">
                <n-statistic label="Skipped requests" :value="summarySkippedRequests">
                </n-statistic>
              </n-alert>
              <n-statistic
              label="Total run duration"
              :value="Math.round(totalRunDuration*1000)/1000"
            >
              <template #suffix>s</template>
            </n-statistic>
            </n-flex>
          </n-flex>
        </n-card>
        <n-data-table :columns="summaryColumns" :data="summaryData" />
      </n-flex>
    </script>
    <script type="text/x-template" id="requests-component">
      <n-card>
        <template #header>
          <span style="font-size: 24px;">{{ iterationTitle }}</span>
        </template>
        <n-flex vertical style="margin-bottom: 50px">
          <n-switch
            v-model:value="onlyFailed"
            :rail-style="railStyle"
          >
            <template #checked> Only Failed </template>
            <template #unchecked> Show All </template>
          </n-switch>

          <n-collapse>
            <x-result v-for="(result, index) in results" :result="result" :key="results.length"></x-result>
          </n-collapse>
        </n-flex>
      </n-card>
    </script>
    <script type="text/x-template" id="result-component">
      <n-collapse-item
        :name="resultTitle"
        arrow-placement="right"
      >
        <template #header>
          <n-alert
            :type="getAlertType"
            :bordered="false"
          >
            <template #header>
              {{result.path}} - {{result.response.status === 'skipped' ? 'Request Skipped' : (totalPassed + '/' + total + ' Passed')}} {{hasError ? " - (request failed)" : "" }}
            </template>
          </n-alert>
        </template>
        <n-flex vertical>
          <n-grid x-gap="12" :cols="2">
            <n-gi>
              <n-card title="REQUEST INFORMATION">
                <n-list>
                  <n-list-item>
                    <n-thing
                      title="File"
                      :description="result.path"
                    />
                  </n-list-item>
                  <n-list-item>
                    <n-thing
                      title="Request Method"
                      :description="result.request.method"
                    />
                  </n-list-item>
                  <n-list-item>
                    <n-thing
                      title="Request URL"
                      :description="result.request.url"
                    />
                  </n-list-item>
                </n-list>
              </n-card>
            </n-gi>
            <n-gi>
              <n-card title="RESPONSE INFORMATION">
                <n-list>
                  <n-list-item>
                    <n-thing
                      title="Response Code"
                      :description="'' + result.response.status"
                    />
                  </n-list-item>
                  <n-list-item>
                    <n-thing
                      title="Response time"
                      :description="result.response.responseTime + ' ms'"
                    />
                  </n-list-item>
                  <n-list-item>
                    <n-thing
                      title="Test duration"
                      :description="testDuration"
                    />
                  </n-list-item>
                </n-list>
              </n-card>
            </n-gi>
          </n-grid>
          <n-alert v-if="hasError" title="Error" type="error">
            {{result.error}}
          </n-alert>
          <n-card title="REQUEST HEADERS">
            <n-data-table
              :columns="headerColumns"
              :data="headerDataRequest"
            />
          </n-card>
          <n-card
            v-if="result.request.data"
            title="REQUEST BODY"
          >
          <iframe
            v-if="result.request.isHtml"
            :srcdoc="result.request.data"
            style="width: 100%; height: 400px; border: none;"
          ></iframe>

          <pre v-else>{{ result.request.data }}</pre>
          </n-card>
          <n-card title="RESPONSE HEADERS">
            <n-data-table
              :columns="headerColumns"
              :data="headerDataResponse"
            />
          </n-card>
          <n-card
            v-if="result.response.data"
            title="RESPONSE BODY"
          >
          <iframe
            v-if="result.response.isHtml"
            :srcdoc="result.response.data"
            style="width: 100%; height: 400px; border: none;"
          ></iframe>

          <pre v-else>{{ result.response.data }}</pre>          </n-card>
          <n-card title="ASSERTIONS INFORMATION">
            <n-data-table
              :columns="assertionsColumns"
              :data="result.assertionResults"
              :row-class-name="assertionsRowClassName"
            />
          </n-card>
          <n-card title="TESTS INFORMATION">
            <n-data-table
              :columns="testsColumns"
              :data="result.testResults"
              :row-class-name="testsRowClassName"
            />
          </n-card>
        </n-flex>
      </n-collapse-item>
    </script>
    <script>
      const { createApp, ref, computed, onMounted } = Vue;

      function mergeTests(runnerResults) {
        if (!Array.isArray(runnerResults)) return runnerResults; 

        runnerResults.forEach(iteration => {
          const { totalTests, passedTests, failedTests, totalPreRequestTests, passedPreRequestTests, failedPreRequestTests, totalPostResponseTests, passedPostResponseTests, failedPostResponseTests } = iteration.summary;
          
          // Merge summary test counts
          iteration.summary.totalTests = totalTests + totalPreRequestTests + totalPostResponseTests;
          iteration.summary.passedTests = passedTests + passedPreRequestTests + passedPostResponseTests;
          iteration.summary.failedTests = failedTests + failedPreRequestTests + failedPostResponseTests;
          
          // Merge individual result test arrays
          iteration.results.forEach(result => {
            result.testResults = [
              ...(result.preRequestTestResults || []),
              ...(result.postResponseTestResults || []),
              ...(result.testResults || [])
            ];
          }); 
        });
        
        return runnerResults;
      }

      const App = {
        setup() {
          function decodeBase64(base64) {
            const binary = atob(base64);
            const bytes = Uint8Array.from(binary, c => c.charCodeAt(0));
            return new TextDecoder().decode(bytes);
          }

          const res = computed(() => {
            const rawResults = JSON.parse(decodeBase64('W3siaXRlcmF0aW9uSW5kZXgiOjAsInJlc3VsdHMiOlt7InRlc3QiOnsiZmlsZW5hbWUiOiJmaWxlcy50eHQuYnJ1In0sInJlcXVlc3QiOnsibWV0aG9kIjoiR0VUIiwidXJsIjoiaHR0cHM6Ly9yZWFjdC1uYXRpdmUtYXJ0aWZhY3RzLm5ldGxpZnkuYXBwL2ZpbGVzLnR4dCIsImhlYWRlcnMiOnsiVXNlci1BZ2VudCI6Imluc29tbmlhLzExLjIuMCJ9LCJpc0h0bWwiOmZhbHNlfSwicmVzcG9uc2UiOnsic3RhdHVzIjoiZXJyb3IiLCJzdGF0dXNUZXh0IjpudWxsLCJoZWFkZXJzIjpudWxsLCJkYXRhIjpudWxsLCJyZXNwb25zZVRpbWUiOjAsImlzSHRtbCI6ZmFsc2V9LCJlcnJvciI6ImNvbm5lY3QgRVRJTUVET1VUIDEzLjIxNS4yMzkuMjE5OjQ0MyIsInN0YXR1cyI6ImVycm9yIiwiYXNzZXJ0aW9uUmVzdWx0cyI6W10sInRlc3RSZXN1bHRzIjpbXSwicHJlUmVxdWVzdFRlc3RSZXN1bHRzIjpbXSwicG9zdFJlc3BvbnNlVGVzdFJlc3VsdHMiOltdLCJzaG91bGRTdG9wUnVubmVyRXhlY3V0aW9uIjpmYWxzZSwicnVuRHVyYXRpb24iOjEuNTkyNTcyMzA0LCJuYW1lIjoiZmlsZXMudHh0IiwicGF0aCI6ImZpbGVzLnR4dCIsIml0ZXJhdGlvbkluZGV4IjowfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJtb3ZpZXMtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC1tb3ZpZXMuY29udGFpbmVyLmJ1bmRsZS5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvYXJ0aWZhY3RzL21vdmllcy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L21vdmllcy5jb250YWluZXIuYnVuZGxlIiwiaGVhZGVycyI6eyJVc2VyLUFnZW50IjoiaW5zb21uaWEvMTEuMi4wIn0sImlzSHRtbCI6ZmFsc2V9LCJyZXNwb25zZSI6eyJzdGF0dXMiOiJlcnJvciIsInN0YXR1c1RleHQiOm51bGwsImhlYWRlcnMiOm51bGwsImRhdGEiOm51bGwsInJlc3BvbnNlVGltZSI6MCwiaXNIdG1sIjpmYWxzZX0sImVycm9yIjoiY29ubmVjdCBFVElNRURPVVQgNTIuNzQuNi4xMDk6NDQzIiwic3RhdHVzIjoiZXJyb3IiLCJhc3NlcnRpb25SZXN1bHRzIjpbXSwidGVzdFJlc3VsdHMiOltdLCJwcmVSZXF1ZXN0VGVzdFJlc3VsdHMiOltdLCJwb3N0UmVzcG9uc2VUZXN0UmVzdWx0cyI6W10sInNob3VsZFN0b3BSdW5uZXJFeGVjdXRpb24iOmZhbHNlLCJydW5EdXJhdGlvbiI6MS41MDk4MTcyMjcsIm5hbWUiOiIvbW92aWVzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvbW92aWVzLmNvbnRhaW5lci5idW5kbGUiLCJwYXRoIjoibW92aWVzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbW92aWVzLmNvbnRhaW5lci5idW5kbGUiLCJpdGVyYXRpb25JbmRleCI6MH0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoibW92aWVzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbWYtbWFuaWZlc3QuanNvbi5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvYXJ0aWZhY3RzL21vdmllcy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L21mLW1hbmlmZXN0Lmpzb24iLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJjb25uZWN0IEVUSU1FRE9VVCA1Mi43NC42LjEwOTo0NDMiLCJzdGF0dXMiOiJlcnJvciIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjoxLjUxMTI5OTQ0NiwibmFtZSI6Ii9tb3ZpZXMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9tZi1tYW5pZmVzdC5qc29uIiwicGF0aCI6Im1vdmllcy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LW1mLW1hbmlmZXN0Lmpzb24iLCJpdGVyYXRpb25JbmRleCI6MH0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoibXVzaWNzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbXVzaWNzLmNvbnRhaW5lci5idW5kbGUuYnJ1In0sInJlcXVlc3QiOnsibWV0aG9kIjoiR0VUIiwidXJsIjoiaHR0cHM6Ly9yZWFjdC1uYXRpdmUtYXJ0aWZhY3RzLm5ldGxpZnkuYXBwL2FydGlmYWN0cy9tdXNpY3MvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9tdXNpY3MuY29udGFpbmVyLmJ1bmRsZSIsImhlYWRlcnMiOnsiVXNlci1BZ2VudCI6Imluc29tbmlhLzExLjIuMCJ9LCJpc0h0bWwiOmZhbHNlfSwicmVzcG9uc2UiOnsic3RhdHVzIjoiZXJyb3IiLCJzdGF0dXNUZXh0IjpudWxsLCJoZWFkZXJzIjpudWxsLCJkYXRhIjpudWxsLCJyZXNwb25zZVRpbWUiOjAsImlzSHRtbCI6ZmFsc2V9LCJlcnJvciI6ImNvbm5lY3QgRVRJTUVET1VUIDUyLjc0LjYuMTA5OjQ0MyIsInN0YXR1cyI6ImVycm9yIiwiYXNzZXJ0aW9uUmVzdWx0cyI6W10sInRlc3RSZXN1bHRzIjpbXSwicHJlUmVxdWVzdFRlc3RSZXN1bHRzIjpbXSwicG9zdFJlc3BvbnNlVGVzdFJlc3VsdHMiOltdLCJzaG91bGRTdG9wUnVubmVyRXhlY3V0aW9uIjpmYWxzZSwicnVuRHVyYXRpb24iOjEuNTA5NDgxMTcsIm5hbWUiOiIvbXVzaWNzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvbXVzaWNzLmNvbnRhaW5lci5idW5kbGUiLCJwYXRoIjoibXVzaWNzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbXVzaWNzLmNvbnRhaW5lci5idW5kbGUiLCJpdGVyYXRpb25JbmRleCI6MH0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoibXVzaWNzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbWYtbWFuaWZlc3QuanNvbi5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvYXJ0aWZhY3RzL211c2ljcy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L21mLW1hbmlmZXN0Lmpzb24iLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJzb2NrZXQgaGFuZyB1cCIsInN0YXR1cyI6ImVycm9yIiwiYXNzZXJ0aW9uUmVzdWx0cyI6W10sInRlc3RSZXN1bHRzIjpbXSwicHJlUmVxdWVzdFRlc3RSZXN1bHRzIjpbXSwicG9zdFJlc3BvbnNlVGVzdFJlc3VsdHMiOltdLCJzaG91bGRTdG9wUnVubmVyRXhlY3V0aW9uIjpmYWxzZSwicnVuRHVyYXRpb24iOjYuMzg1NjcxMDYyLCJuYW1lIjoiL211c2ljcy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L21mLW1hbmlmZXN0Lmpzb24iLCJwYXRoIjoibXVzaWNzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbWYtbWFuaWZlc3QuanNvbiIsIml0ZXJhdGlvbkluZGV4IjowfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJvdXRkb29ycy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LW1mLW1hbmlmZXN0Lmpzb24uYnJ1In0sInJlcXVlc3QiOnsibWV0aG9kIjoiR0VUIiwidXJsIjoiaHR0cHM6Ly9yZWFjdC1uYXRpdmUtYXJ0aWZhY3RzLm5ldGxpZnkuYXBwL2FydGlmYWN0cy9vdXRkb29ycy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L21mLW1hbmlmZXN0Lmpzb24iLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJjb25uZWN0IEVUSU1FRE9VVCA1Mi43NC42LjEwOTo0NDMiLCJzdGF0dXMiOiJlcnJvciIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjoxLjUxMDIxOTU4OSwibmFtZSI6Ii9vdXRkb29ycy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L21mLW1hbmlmZXN0Lmpzb24iLCJwYXRoIjoib3V0ZG9vcnMtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC1tZi1tYW5pZmVzdC5qc29uIiwiaXRlcmF0aW9uSW5kZXgiOjB9LHsidGVzdCI6eyJmaWxlbmFtZSI6Im91dGRvb3JzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtb3V0ZG9vcnMuY29udGFpbmVyLmJ1bmRsZS5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvYXJ0aWZhY3RzL291dGRvb3JzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvb3V0ZG9vcnMuY29udGFpbmVyLmJ1bmRsZSIsImhlYWRlcnMiOnsiVXNlci1BZ2VudCI6Imluc29tbmlhLzExLjIuMCJ9LCJpc0h0bWwiOmZhbHNlfSwicmVzcG9uc2UiOnsic3RhdHVzIjoiZXJyb3IiLCJzdGF0dXNUZXh0IjpudWxsLCJoZWFkZXJzIjpudWxsLCJkYXRhIjpudWxsLCJyZXNwb25zZVRpbWUiOjAsImlzSHRtbCI6ZmFsc2V9LCJlcnJvciI6ImNvbm5lY3QgRVRJTUVET1VUIDUyLjc0LjYuMTA5OjQ0MyIsInN0YXR1cyI6ImVycm9yIiwiYXNzZXJ0aW9uUmVzdWx0cyI6W10sInRlc3RSZXN1bHRzIjpbXSwicHJlUmVxdWVzdFRlc3RSZXN1bHRzIjpbXSwicG9zdFJlc3BvbnNlVGVzdFJlc3VsdHMiOltdLCJzaG91bGRTdG9wUnVubmVyRXhlY3V0aW9uIjpmYWxzZSwicnVuRHVyYXRpb24iOjEuNTA5Mzc3MzE5LCJuYW1lIjoiL291dGRvb3JzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvb3V0ZG9vcnMuY29udGFpbmVyLmJ1bmRsZSIsInBhdGgiOiJvdXRkb29ycy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LW91dGRvb3JzLmNvbnRhaW5lci5idW5kbGUiLCJpdGVyYXRpb25JbmRleCI6MH0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoic3BvcnRzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbWYtbWFuaWZlc3QuanNvbi5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvYXJ0aWZhY3RzL3Nwb3J0cy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L21mLW1hbmlmZXN0Lmpzb24iLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJjb25uZWN0IEVUSU1FRE9VVCA1Mi43NC42LjEwOTo0NDMiLCJzdGF0dXMiOiJlcnJvciIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjoxLjUwOTY0MDUwMSwibmFtZSI6Ii9zcG9ydHMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9tZi1tYW5pZmVzdC5qc29uIiwicGF0aCI6InNwb3J0cy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LW1mLW1hbmlmZXN0Lmpzb24iLCJpdGVyYXRpb25JbmRleCI6MH0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoic3BvcnRzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtc3BvcnRzLmNvbnRhaW5lci5idW5kbGUuYnJ1In0sInJlcXVlc3QiOnsibWV0aG9kIjoiR0VUIiwidXJsIjoiaHR0cHM6Ly9yZWFjdC1uYXRpdmUtYXJ0aWZhY3RzLm5ldGxpZnkuYXBwL2FydGlmYWN0cy9zcG9ydHMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9zcG9ydHMuY29udGFpbmVyLmJ1bmRsZSIsImhlYWRlcnMiOnsiVXNlci1BZ2VudCI6Imluc29tbmlhLzExLjIuMCJ9LCJpc0h0bWwiOmZhbHNlfSwicmVzcG9uc2UiOnsic3RhdHVzIjoyMDAsInN0YXR1c1RleHQiOiJPSyIsImhlYWRlcnMiOnsiYWNjZXB0LXJhbmdlcyI6ImJ5dGVzIiwiYWdlIjoiMCIsImNhY2hlLWNvbnRyb2wiOiJwdWJsaWMsbWF4LWFnZT0wLG11c3QtcmV2YWxpZGF0ZSIsImNhY2hlLXN0YXR1cyI6IlwiTmV0bGlmeSBFZGdlXCI7IGZ3ZD1taXNzIiwiY29udGVudC10eXBlIjoidGV4dC9qYXZhc2NyaXB0IiwiZGF0ZSI6IlRodSwgMTcgSnVsIDIwMjUgMTY6MTU6NTYgR01UIiwiZXRhZyI6IlwiYzE2MzgxODVjMzY1ZWFhNjE1OGI5NmQ1NDRmMmI5MWUtc3NsLWRmXCIiLCJzZXJ2ZXIiOiJOZXRsaWZ5Iiwic3RyaWN0LXRyYW5zcG9ydC1zZWN1cml0eSI6Im1heC1hZ2U9MzE1MzYwMDA7IGluY2x1ZGVTdWJEb21haW5zOyBwcmVsb2FkIiwidmFyeSI6IkFjY2VwdC1FbmNvZGluZyIsIngtbmYtcmVxdWVzdC1pZCI6IjAxSzBDSlFIUTRLREhFM1JIOTRDOUZNMFZFIiwiY29ubmVjdGlvbiI6ImNsb3NlIiwidHJhbnNmZXItZW5jb2RpbmciOiJjaHVua2VkIn0sImRhdGEiOiIvKioqKioqLyB2YXIgc2VsZiA9IHNlbGYgfHwgdGhpcyB8fCBuZXcgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpIHx8ICh7fSk7IC8vIHJlcGFja0dsb2JhbCdcbi8qKioqKiovXG52YXIgc3BvcnRzO1xuKGZ1bmN0aW9uKCkgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG52YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7XG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvQ29yZVBsdWdpbi5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvQ29yZVBsdWdpbi5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImRlZmF1bHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBfZGVmYXVsdDtcbiAgICB9XG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIFJlcGFja0NvcmVQbHVnaW4gPSAoKT0+KHtcbiAgICAgICAgbmFtZTogJ3JlcGFjay1jb3JlLXBsdWdpbicsXG4gICAgICAgIGxvYWRFbnRyeTogKHJlZik9PntcbiAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gcmVmLnJlbW90ZUluZm87XG4gICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2xpZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vU2NyaXB0TWFuYWdlci9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzXCIpO1xuICAgICAgICAgICAgICAgIHZhciBTY3JpcHRNYW5hZ2VyID0gY2xpZW50LlNjcmlwdE1hbmFnZXIsIGdldFdlYnBhY2tDb250ZXh0ID0gY2xpZW50LmdldFdlYnBhY2tDb250ZXh0O1xuICAgICAgICAgICAgICAgIHZhciBlbnRyeSA9IHJlbW90ZUluZm8uZW50cnksIGVudHJ5R2xvYmFsTmFtZSA9IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIFNjcmlwdE1hbmFnZXIuc2hhcmVkLmxvYWRTY3JpcHQoZW50cnlHbG9iYWxOYW1lLCB1bmRlZmluZWQsIGdldFdlYnBhY2tDb250ZXh0KCksIGVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBpZiAoIWdsb2JhbFRoaXNbZW50cnlHbG9iYWxOYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2xvYmFsVGhpc1tlbnRyeUdsb2JhbE5hbWVdO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGxvYWQgcmVtb3RlIGVudHJ5OiAke2VudHJ5R2xvYmFsTmFtZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSgpO1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZVByZWxvYWRBc3NldHM6ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIC8vIG5vb3AgZm9yIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgY3NzQXNzZXRzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAganNBc3NldHNXaXRob3V0RW50cnk6IFtdLFxuICAgICAgICAgICAgICAgICAgICBlbnRyeUFzc2V0czogW11cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pKClcbiAgICB9KTtcbnZhciBfZGVmYXVsdCA9IFJlcGFja0NvcmVQbHVnaW47XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvUmVzb2x2ZXJQbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL0ZlZGVyYXRpb25SdW50aW1lUGx1Z2lucy9SZXNvbHZlclBsdWdpbi5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX2RlZmF1bHQ7XG4gICAgfVxufSkpO1xudmFyIF9hc3luY190b19nZW5lcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fYXN5bmNfdG9fZ2VuZXJhdG9yICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiKTtcbnZhciBfb2JqZWN0X3NwcmVhZCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19vYmplY3Rfc3ByZWFkICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fb2JqZWN0X3NwcmVhZC5janNcIik7XG52YXIgY3JlYXRlU2NyaXB0TG9jYXRvciA9IChlbnRyeVVybCwgY29uZmlnKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHZhciBsb2NhdG9yID0geWllbGQgY29uZmlnKGVudHJ5VXJsKTtcbiAgICAgICAgICAgIHJldHVybiBsb2NhdG9yO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIF9vYmplY3Rfc3ByZWFkLl8oe1xuICAgICAgICAgICAgICAgIHVybDogZW50cnlVcmxcbiAgICAgICAgICAgIH0sIGNvbmZpZyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVybDogZW50cnlVcmxcbiAgICAgICAgfTtcbiAgICB9KSgpO1xudmFyIFJlcGFja1Jlc29sdmVyUGx1Z2luID0gKGNvbmZpZyk9Pih7XG4gICAgICAgIG5hbWU6ICdyZXBhY2stcmVzb2x2ZXItcGx1Z2luJyxcbiAgICAgICAgYWZ0ZXJSZXNvbHZlIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgU2NyaXB0TWFuYWdlciA9IChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvaW5kZXguanNcIikvKiAuU2NyaXB0TWFuYWdlciAqLy5TY3JpcHRNYW5hZ2VyKTtcbiAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gYXJncy5yZW1vdGVJbmZvO1xuICAgICAgICAgICAgU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoKHNjcmlwdElkLCBjYWxsZXIsIHJlZmVyZW5jZVVybCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVudHJ5IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NyaXB0SWQgPT09IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRvciA9IHlpZWxkIGNyZWF0ZVNjcmlwdExvY2F0b3IocmVtb3RlSW5mby5lbnRyeSwgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhdG9yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGVudHJ5IGNodW5rc1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVmZXJlbmNlVXJsICYmIGNhbGxlciA9PT0gcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwdWJsaWNQYXRoID0gcmVtb3RlSW5mby5lbnRyeS5zcGxpdCgnLycpLnNsaWNlKDAsIC0xKS5qb2luKCcvJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnVuZGxlUGF0aCA9IHNjcmlwdElkICsgcmVmZXJlbmNlVXJsLnNwbGl0KHNjcmlwdElkKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBwdWJsaWNQYXRoICsgJy8nICsgYnVuZGxlUGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdG9yMSA9IHlpZWxkIGNyZWF0ZVNjcmlwdExvY2F0b3IodXJsLCBjb25maWcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvY2F0b3IxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkoKSwge1xuICAgICAgICAgICAgICAgIGtleTogcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgICAgIH1cbiAgICB9KTtcbnZhciBfZGVmYXVsdCA9IFJlcGFja1Jlc29sdmVyUGx1Z2luO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJTY3JpcHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBTY3JpcHQ7XG4gICAgfVxufSkpO1xudmFyIF9jbGFzc19jYWxsX2NoZWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NsYXNzX2NhbGxfY2hlY2sgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqc1wiKTtcbnZhciBfY3JlYXRlX2NsYXNzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NyZWF0ZV9jbGFzcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janNcIik7XG52YXIgX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuY2pzXCIpO1xudmFyIF9zaGFsbG93ZXF1YWwgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIHNoYWxsb3dlcXVhbCAqLyBcIi4vbm9kZV9tb2R1bGVzL3NoYWxsb3dlcXVhbC9pbmRleC5qc1wiKSk7XG52YXIgX05hdGl2ZVNjcmlwdE1hbmFnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL05hdGl2ZVNjcmlwdE1hbmFnZXIuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzXCIpO1xudmFyIFNjcmlwdCA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgZnVuY3Rpb24gU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIGxvY2F0b3IsIHJlZikge1xuICAgICAgICB2YXIgY2FjaGUgPSByZWYgPT09IHZvaWQgMCA/IHRydWUgOiByZWY7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU2NyaXB0KTtcbiAgICAgICAgdGhpcy5zY3JpcHRJZCA9IHNjcmlwdElkO1xuICAgICAgICB0aGlzLmNhbGxlciA9IGNhbGxlcjtcbiAgICAgICAgdGhpcy5sb2NhdG9yID0gbG9jYXRvcjtcbiAgICAgICAgdGhpcy5jYWNoZSA9IGNhY2hlO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oU2NyaXB0LCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBDaGVjayBpZiB0aGUgc2NyaXB0IHdhcyBhbHJlYWR5IGNhY2hlZCBhbmQgY2FjaGUgc2hvdWxkIGJlIHVwZGF0ZWQgd2l0aCBuZXcgZGF0YS5cbiAgICpcbiAgICogQHBhcmFtIGNhY2hlZERhdGEgQ2FjaGVkIGRhdGEgZm9yIHRoZSBzYW1lIHNjcmlwdC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwic2hvdWxkVXBkYXRlQ2FjaGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzaG91bGRVcGRhdGVDYWNoZShjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhY2hlIHx8ICFjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkKGNhY2hlZERhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIHNjcmlwdCBzaG91bGQgYmUgZmV0Y2hlZCBhZ2FpbiBvciByZXVzZWQsXG4gICAqIGJhc2VkIG9uIHByZXZpb3VzIGNhY2hlZCBkYXRhLlxuICAgKlxuICAgKiBAcGFyYW0gY2FjaGVkRGF0YSBDYWNoZWQgZGF0YSBmb3IgdGhlIHNhbWUgc2NyaXB0LlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICovIGtleTogXCJzaG91bGRSZWZldGNoXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdWxkUmVmZXRjaChjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhY2hlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jaGVja0lmQ2FjaGVEYXRhT3V0ZGF0ZWQoY2FjaGVkRGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBDaGVjayBpZiBwcmV2aW91cyBjYWNoZWQgZGF0YSBpcyB0aGUgc2FtZSBhcyB0aGUgbmV3IG9uZS5cbiAgICpcbiAgICogQHBhcmFtIGNhY2hlZERhdGEgQ2FjaGVkIGRhdGEgZm9yIHRoZSBzYW1lIHNjcmlwdC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwiY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkKGNhY2hlZERhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVkRGF0YS5tZXRob2QgIT09IHRoaXMubG9jYXRvci5tZXRob2QgfHwgY2FjaGVkRGF0YS51cmwgIT09IHRoaXMubG9jYXRvci51cmwgfHwgY2FjaGVkRGF0YS5xdWVyeSAhPT0gdGhpcy5sb2NhdG9yLnF1ZXJ5IHx8ICEoMCwgX3NoYWxsb3dlcXVhbC5kZWZhdWx0KShjYWNoZWREYXRhLmhlYWRlcnMsIHRoaXMubG9jYXRvci5oZWFkZXJzKSB8fCBjYWNoZWREYXRhLmJvZHkgIT09IHRoaXMubG9jYXRvci5ib2R5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogR2V0IG9iamVjdCB0byBzdG9yZSBpbiBjYWNoZS5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwiZ2V0Q2FjaGVEYXRhXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2FjaGVEYXRhKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogdGhpcy5sb2NhdG9yLm1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLmxvY2F0b3IudXJsLFxuICAgICAgICAgICAgICAgICAgICBxdWVyeTogdGhpcy5sb2NhdG9yLnF1ZXJ5LFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmxvY2F0b3IuaGVhZGVycyxcbiAgICAgICAgICAgICAgICAgICAgYm9keTogdGhpcy5sb2NhdG9yLmJvZHlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwidG9PYmplY3RcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b09iamVjdCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzY3JpcHRJZDogdGhpcy5zY3JpcHRJZCxcbiAgICAgICAgICAgICAgICAgICAgY2FsbGVyOiB0aGlzLmNhbGxlcixcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRvcjogdGhpcy5sb2NhdG9yLFxuICAgICAgICAgICAgICAgICAgICBjYWNoZTogdGhpcy5jYWNoZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXREZXZTZXJ2ZXJVUkxcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogR2V0IFVSTCBvZiBhIHNjcmlwdCBob3N0ZWQgb24gZGV2ZWxvcG1lbnQgc2VydmVyLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdC5cbiAgICovIGZ1bmN0aW9uIGdldERldlNlcnZlclVSTChzY3JpcHRJZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT5gJHt3ZWJwYWNrQ29udGV4dC5wfSR7d2VicGFja0NvbnRleHQudShzY3JpcHRJZCl9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldEZpbGVTeXN0ZW1VUkxcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogR2V0IFVSTCBvZiBhIHNjcmlwdCBzdG9yZWQgb24gZmlsZXN5c3RlbSBvbiB0aGUgdGFyZ2V0IG1vYmlsZSBkZXZpY2UuXG4gICAqXG4gICAqIEBwYXJhbSBzY3JpcHRJZCBJZCBvZiB0aGUgc2NyaXB0LlxuICAgKi8gZnVuY3Rpb24gZ2V0RmlsZVN5c3RlbVVSTChzY3JpcHRJZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT53ZWJwYWNrQ29udGV4dC51KGBmaWxlOi8vLyR7c2NyaXB0SWR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRSZW1vdGVVUkxcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogR2V0IFVSTCBvZiBhIHNjcmlwdCBob3N0ZWQgb24gYSByZW1vdGUgc2VydmVyLlxuICAgKlxuICAgKiBCeSBkZWZhdWx0IGAuY2h1bmsuYnVuZGxlYCBleHRlbnNpb24gd2lsbCBiZSBhZGRlZCB0byB0aGUgVVJMLlxuICAgKiBJZiB5b3VyIHNjcmlwdCBoYXMgZGlmZmVyZW50IGV4dGVuc2lvbiwgeW91IHNob3VsZCBwYXNzIGB7IGV4Y2x1ZGVFeHRlbnNpb246IHRydWUgfWAgYXMgMm5kIGFyZ3VtZW50LlxuICAgKlxuICAgKiBAcGFyYW0gdXJsIEEgVVJMIHRvIHJlbW90ZSBsb2NhdGlvbiB3aGVyZSB0aGUgc2NyaXB0IGlzIHN0b3JlZC5cbiAgICogQHBhcmFtIG9wdGlvbnMgQWRkaXRpb25hbCBvcHRpb25zLlxuICAgKi8gZnVuY3Rpb24gZ2V0UmVtb3RlVVJMKHVybCwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSByZWYgPT09IHZvaWQgMCA/IHt9IDogcmVmO1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmV4Y2x1ZGVFeHRlbnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICh3ZWJwYWNrQ29udGV4dCk9PndlYnBhY2tDb250ZXh0LnUodXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldFNjcmlwdFVuaXF1ZUlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIEdldCB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHNjcmlwdC5cbiAgICpcbiAgICogVXNlZCB0byBjcmVhdGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBzY3JpcHQsIHdoaWNoIHNlcnZlcyBhcyBpdHMga2V5IGluIHRoZSBjYWNoZS5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQuXG4gICAqIEBwYXJhbSBjYWxsZXIgT3B0aW9uYWwgY2FsbGVyIG5hbWUgdG8gcHJlZml4IHRoZSBzY3JpcHQgaWQuXG4gICAqLyBmdW5jdGlvbiBnZXRTY3JpcHRVbmlxdWVJZChzY3JpcHRJZCwgY2FsbGVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByZWZpeCA9IGNhbGxlciA/IGNhbGxlciArICdfJyA6ICcnO1xuICAgICAgICAgICAgICAgIHJldHVybiBwcmVmaXggKyBzY3JpcHRJZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImZyb21cIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogQ3JlYXRlIG5ldyBpbnN0YW5jZSBvZiBgU2NyaXB0YCBmcm9tIG5vbi1ub3JtYWxpemVkIHNjcmlwdCBsb2NhdG9yIGRhdGEuXG4gICAqXG4gICAqIEBwYXJhbSBsb2NhdG9yIE5vbi1ub3JtYWxpemVkIGxvY2F0b3IgZGF0YS5cbiAgICogQHBhcmFtIGZldGNoIEluaXRpYWwgZmxhZyBmb3Igd2hldGhlciBzY3JpcHQgc2hvdWxkIGJlIGZldGNoZWQgb3Igbm90LlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICovIGZ1bmN0aW9uIGZyb20oa2V5LCBsb2NhdG9yLCBmZXRjaCkge1xuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0ge307XG4gICAgICAgICAgICAgICAgbmV3IEhlYWRlcnMobG9jYXRvci5oZWFkZXJzKS5mb3JFYWNoKCh2YWx1ZSwga2V5KT0+e1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW2tleS50b0xvd2VyQ2FzZSgpXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciB1bmlxdWVJZCA9IFNjcmlwdC5nZXRTY3JpcHRVbmlxdWVJZChrZXkuc2NyaXB0SWQsIGtleS5jYWxsZXIpO1xuICAgICAgICAgICAgICAgIHZhciBib2R5O1xuICAgICAgICAgICAgICAgIGlmIChsb2NhdG9yLmJvZHkgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm9keU9iamVjdCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBsb2NhdG9yLmJvZHkuZm9yRWFjaCgodmFsdWUsIGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keU9iamVjdFtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignU2NyaXB0IGRvZXMgbm90IHN1cHBvcnQgRmlsZSBhcyBGb3JtRGF0YSBrZXkgaW4gYm9keScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KGJvZHlPYmplY3QpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobG9jYXRvci5ib2R5IGluc3RhbmNlb2YgVVJMU2VhcmNoUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBib2R5T2JqZWN0MSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBsb2NhdG9yLmJvZHkuZm9yRWFjaCgodmFsdWUsIGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHlPYmplY3QxW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJvZHkgPSBKU09OLnN0cmluZ2lmeShib2R5T2JqZWN0MSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYm9keSA9IGxvY2F0b3IuYm9keSA/PyB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbG9jYXRvci51cmwgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQcm9wZXJ0eSB1cmwgYXMgYSBmdW5jdGlvbiBpcyBub3Qgc3VwcG9ydCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdChrZXkuc2NyaXB0SWQsIGtleS5jYWxsZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlSWQsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogbG9jYXRvci5tZXRob2QgPz8gX05hdGl2ZVNjcmlwdE1hbmFnZXIuTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kLkdFVCxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBsb2NhdG9yLnVybCxcbiAgICAgICAgICAgICAgICAgICAgYWJzb2x1dGU6IGxvY2F0b3IuYWJzb2x1dGUgPz8gZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IGxvY2F0b3IudGltZW91dCA/PyBTY3JpcHQuREVGQVVMVF9USU1FT1VULFxuICAgICAgICAgICAgICAgICAgICByZXRyeTogbG9jYXRvci5yZXRyeSxcbiAgICAgICAgICAgICAgICAgICAgcmV0cnlEZWxheTogbG9jYXRvci5yZXRyeURlbGF5LFxuICAgICAgICAgICAgICAgICAgICBxdWVyeTogbmV3IFVSTFNlYXJjaFBhcmFtcyhsb2NhdG9yLnF1ZXJ5KS50b1N0cmluZygpIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgYm9keSxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogT2JqZWN0LmtleXMoaGVhZGVycykubGVuZ3RoID8gaGVhZGVycyA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgZmV0Y2g6IGxvY2F0b3IuY2FjaGUgPT09IGZhbHNlID8gdHJ1ZSA6IGZldGNoLFxuICAgICAgICAgICAgICAgICAgICB2ZXJpZnlTY3JpcHRTaWduYXR1cmU6IGxvY2F0b3IudmVyaWZ5U2NyaXB0U2lnbmF0dXJlID8/IF9OYXRpdmVTY3JpcHRNYW5hZ2VyLk5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZS5PRkZcbiAgICAgICAgICAgICAgICB9LCBsb2NhdG9yLmNhY2hlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBTY3JpcHQ7XG59IC8vIyBzb3VyY2VNYXBwaW5nVVJMPVNjcmlwdC5qcy5tYXBcbigpO1xuU2NyaXB0LkRFRkFVTFRfVElNRU9VVCA9IDMwMDAwIC8vIDMwc1xuO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHRNYW5hZ2VyLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL1NjcmlwdE1hbmFnZXIuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbi8vIGJpb21lLWlnbm9yZSBsaW50L3N0eWxlL3VzZU5vZGVqc0ltcG9ydFByb3RvY29sOiB1c2UgJ2V2ZW50cycgbW9kdWxlIGluc3RlYWQgb2Ygbm9kZSBidWlsdGluXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIlNjcmlwdE1hbmFnZXJcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBTY3JpcHRNYW5hZ2VyO1xuICAgIH1cbn0pKTtcbnZhciBfYXN5bmNfdG9fZ2VuZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2FzeW5jX3RvX2dlbmVyYXRvciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FzeW5jX3RvX2dlbmVyYXRvci5janNcIik7XG52YXIgX2NhbGxfc3VwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY2FsbF9zdXBlciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NhbGxfc3VwZXIuY2pzXCIpO1xudmFyIF9jbGFzc19jYWxsX2NoZWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NsYXNzX2NhbGxfY2hlY2sgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqc1wiKTtcbnZhciBfY3JlYXRlX2NsYXNzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NyZWF0ZV9jbGFzcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janNcIik7XG52YXIgX2luaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2luaGVyaXRzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW5oZXJpdHMuY2pzXCIpO1xudmFyIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiKTtcbnZhciBfc2xpY2VkX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3NsaWNlZF90b19hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janNcIik7XG52YXIgX3RvX2NvbnN1bWFibGVfYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fdG9fY29uc3VtYWJsZV9hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzXCIpO1xudmFyIF9ldmVudHMgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIGV2ZW50cyAqLyBcIi4vbm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanNcIikpO1xudmFyIF9OYXRpdmVTY3JpcHRNYW5hZ2VyID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL05hdGl2ZVNjcmlwdE1hbmFnZXIuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzXCIpKTtcbnZhciBfU2NyaXB0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9TY3JpcHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanNcIik7XG52YXIgX2dldFdlYnBhY2tDb250ZXh0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9nZXRXZWJwYWNrQ29udGV4dC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2dldFdlYnBhY2tDb250ZXh0LmpzXCIpO1xudmFyIERFRkFVTFRfUkVTT0xWRVJfUFJJT1JJVFkgPSAyO1xudmFyIERFRkFVTFRfUkVTT0xWRVJfS0VZID0gJ19fZGVmYXVsdF9fJztcbnZhciBDQUNIRV9OQU1FID0gJ1JlcGFjay5TY3JpcHRNYW5hZ2VyLkNhY2hlJztcbnZhciBDQUNIRV9WRVJTSU9OID0gJ3Y0JztcbnZhciBDQUNIRV9FTlYgPSAgdHJ1ZSA/ICdkZWJ1ZycgOiAwO1xudmFyIENBQ0hFX0tFWSA9IFtcbiAgICBDQUNIRV9OQU1FLFxuICAgIENBQ0hFX1ZFUlNJT04sXG4gICAgQ0FDSEVfRU5WXG5dLmpvaW4oJy4nKTtcbnZhciBMT0FESU5HX0VSUk9SX0NPREVTID0gW1xuICAgIC8vIGFuZHJvaWRcbiAgICAnTmV0d29ya0ZhaWx1cmUnLFxuICAgICdSZXF1ZXN0RmFpbHVyZScsXG4gICAgLy8gaW9zXG4gICAgJ1NjcmlwdERvd25sb2FkRmFpbHVyZSdcbl07XG52YXIgU2NyaXB0TWFuYWdlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oRXZlbnRFbWl0dGVyKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgX2luaGVyaXRzLl8oU2NyaXB0TWFuYWdlciwgRXZlbnRFbWl0dGVyKTtcbiAgICBmdW5jdGlvbiBTY3JpcHRNYW5hZ2VyKHJlZikge1xuICAgICAgICB2YXIgbmF0aXZlU2NyaXB0TWFuYWdlciA9IHJlZiA9PT0gdm9pZCAwID8gX05hdGl2ZVNjcmlwdE1hbmFnZXIuZGVmYXVsdCA6IHJlZjtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBTY3JpcHRNYW5hZ2VyKTtcbiAgICAgICAgdmFyIF90aGlzO1xuICAgICAgICBfdGhpcyA9IF9jYWxsX3N1cGVyLl8odGhpcywgU2NyaXB0TWFuYWdlciksIF90aGlzLmNhY2hlID0ge30sIF90aGlzLnNjcmlwdHNQcm9taXNlcyA9IHt9LCBfdGhpcy5jYWNoZUluaXRpYWxpemVkID0gZmFsc2UsIF90aGlzLnJlc29sdmVycyA9IFtdO1xuICAgICAgICBfdGhpcy5uYXRpdmVTY3JpcHRNYW5hZ2VyID0gbmF0aXZlU2NyaXB0TWFuYWdlcjtcbiAgICAgICAgaWYgKCFuYXRpdmVTY3JpcHRNYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3JlcGFjayByZWFjdC1uYXRpdmUgbW9kdWxlIHdhcyBub3QgZm91bmQuJyArICggdHJ1ZSA/ICcgRGlkIHlvdSBmb3JnZXQgdG8gdXBkYXRlIG5hdGl2ZSBkZXBlbmRlbmNpZXM/JyA6IDApKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2NyaXB0TWFuYWdlciB3YXMgYWxyZWFkeSBpbnN0YW50aWF0ZWQuIFVzZSBTY3JpcHRNYW5hZ2VyLnNoYXJlZCBpbnN0ZWFkLicpO1xuICAgICAgICB9XG4gICAgICAgIF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyID0gX3RoaXM7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFNjcmlwdE1hbmFnZXIsIFtcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIFNldHMgYSBzdG9yYWdlIGJhY2tlbmQgdG8gY2FjaGUgcmVzb2x2ZWQgc2NyaXB0cyBsb2NhdG9yIGRhdGEuXG4gICAqXG4gICAqIFRoZSBzdG9yZWQgZGF0YSBpcyB1c2VkIHRvIGRldGVjdCBpZiBzY3JpcHRzIGxvY2F0b3IgZGF0YSBvZiBwcmV2aW91c2x5IGRvd25sb2FkZWRcbiAgICogc2NyaXB0IGhhc24ndCBjaGFuZ2VkIHRvIGF2b2lkIG92ZXItZmV0Y2hpbmcgdGhlIHNjcmlwdC5cbiAgICpcbiAgICogQHBhcmFtIHN0b3JhZ2UgSW1wbGVtZW50YXRpb24gb2Ygc3RvcmFnZSBmdW5jdGlvbnMuXG4gICAqLyBrZXk6IFwic2V0U3RvcmFnZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFN0b3JhZ2Uoc3RvcmFnZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBBZGRzIG5ldyBzY3JpcHQgbG9jYXRvciByZXNvbHZlci5cbiAgICpcbiAgICogUmVzb2x2ZXIgaXMgYW4gYXN5bmMgZnVuY3Rpb24gdG8gcmVzb2x2ZSBzY3JpcHQgbG9jYXRvciBkYXRhIC0gaW4gb3RoZXIgd29yZHMsIGl0J3MgYSBmdW5jdGlvbiB0b1xuICAgKiB0ZWxsIHRoZSB7QGxpbmsgU2NyaXB0TWFuYWdlcn0gaG93IHRvIGZldGNoIHRoZSBzY3JpcHQuXG4gICAqXG4gICAqIFRoZXJlJ3Mgbm8gbGltaXRhdGlvbiBvbiB3aGF0IGxvZ2ljIHlvdSBjYW4gcnVuIGluc2lkZSB0aGlzIGZ1bmN0aW9uIC0gaXQgY2FuIGluY2x1ZGU6XG4gICAqIC0gZmV0Y2hpbmcvbG9hZGluZyByZW1vdGUgY29uZmlnXG4gICAqIC0gZmV0Y2hpbmcvbG9hZGluZyBmZWF0dXJlIGZsYWdzXG4gICAqIC0gZmV0Y2hpbmcvbG9hZGluZyBBL0IgdGVzdGluZyBkYXRhXG4gICAqIC0gY2FsbGluZyBuYXRpdmUgbW9kdWxlc1xuICAgKiAtIHJ1bm5pbmcgYXJiaXRyYXJ5IGxvZ2ljXG4gICAqXG4gICAqIEBwYXJhbSByZXNvbHZlciBSZXNvbHZlciBmdW5jdGlvbiB0byBhZGQuXG4gICAqIEBwYXJhbSBvcHRpb25zIFJlc29sdmVyIG9wdGlvbnMuXG4gICAqLyBrZXk6IFwiYWRkUmVzb2x2ZXJcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRSZXNvbHZlcihyZXNvbHZlciwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSByZWYgPT09IHZvaWQgMCA/IHt9IDogcmVmO1xuICAgICAgICAgICAgICAgIHZhciBwcmlvcml0eSA9IG9wdGlvbnMucHJpb3JpdHkgPz8gREVGQVVMVF9SRVNPTFZFUl9QUklPUklUWTtcbiAgICAgICAgICAgICAgICB2YXIgdW5pcXVlS2V5ID0gb3B0aW9ucy5rZXk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlcnMgPSB0aGlzLnJlc29sdmVycy5maWx0ZXIoKHJlZik9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAxKSwga2V5ID0gX3JlZlswXTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleSAhPT0gdW5pcXVlS2V5O1xuICAgICAgICAgICAgICAgIH0pLmNvbmNhdChbXG4gICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXF1ZUtleSA/PyBERUZBVUxUX1JFU09MVkVSX0tFWSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW9yaXR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZXJcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIF0pLnNvcnQoKHJlZiwgcmVmMSk9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgYSA9IF9yZWZbMV0sIF9yZWYxID0gX3NsaWNlZF90b19hcnJheS5fKHJlZjEsIDIpLCBiID0gX3JlZjFbMV07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiIC0gYTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIFJlbW92ZXMgcHJldmlvdXNseSBhZGRlZCByZXNvbHZlci5cbiAgICpcbiAgICogQHBhcmFtIHJlc29sdmVyIFJlc29sdmVyIGZ1bmN0aW9uIG9yIHJlc29sdmVyJ3MgYHVuaXF1ZUtleWAgdG8gcmVtb3ZlLlxuICAgKiBAcmV0dXJucyBgdHJ1ZWAgaWYgcmVzb2x2ZXIgd2FzIGZvdW5kIGFuZCByZW1vdmVkLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICovIGtleTogXCJyZW1vdmVSZXNvbHZlclwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVJlc29sdmVyKHJlc29sdmVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4O1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzb2x2ZXIgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5yZXNvbHZlcnMuZmluZEluZGV4KChyZWYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDEpLCBrZXkgPSBfcmVmWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleSA9PT0gcmVzb2x2ZXI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5yZXNvbHZlcnMuZmluZEluZGV4KChyZWYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDMpLCBpdGVtID0gX3JlZlsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtID09PSByZXNvbHZlcjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBSZW1vdmVzIGFsbCBwcmV2aW91c2x5IGFkZGVkIHJlc29sdmVycy5cbiAgICovIGtleTogXCJyZW1vdmVBbGxSZXNvbHZlcnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVBbGxSZXNvbHZlcnMoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlcnMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImluaXRDYWNoZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRDYWNoZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhY2hlSW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfdGhpc19zdG9yYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlRW50cnkgPSB5aWVsZCAoX3RoaXNfc3RvcmFnZSA9IHRoaXMuc3RvcmFnZSkgPT09IG51bGwgfHwgX3RoaXNfc3RvcmFnZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXNfc3RvcmFnZS5nZXRJdGVtKENBQ0hFX0tFWSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlID0gY2FjaGVFbnRyeSA/IEpTT04ucGFyc2UoY2FjaGVFbnRyeSkgOiB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic2F2ZUNhY2hlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2F2ZUNhY2hlKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXNfc3RvcmFnZTtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgKF90aGlzX3N0b3JhZ2UgPSB0aGlzLnN0b3JhZ2UpID09PSBudWxsIHx8IF90aGlzX3N0b3JhZ2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzX3N0b3JhZ2Uuc2V0SXRlbShDQUNIRV9LRVksIEpTT04uc3RyaW5naWZ5KHRoaXMuY2FjaGUpKTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaGFuZGxlRXJyb3JcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSwgLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5lcnJvci5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlXG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSwgW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEVycm9yOiBlcnJvclxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXSkpO1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgIGFyZ3MsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsRXJyb3I6IGVycm9yXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZXNvbHZlU2NyaXB0XCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIFJlc29sdmVzIGEge0BsaW5rIFNjcmlwdH0gaW5zdGFuY2Ugd2l0aCBub3JtYWxpemVkIGxvY2F0b3IgZGF0YS5cbiAgICpcbiAgICogUmVzb2x1dGlvbiB3aWxsIHVzZSBwcmV2aW91c2x5IGFkZGVkICh2aWEgYFNjcmlwdE1hbmFnZXIuc2hhcmVkLmFkZFJlc29sdmVyKC4uLilgKSByZXNvbHZlcnNcbiAgICogaW4gc2VyaWVzLCB1dGlsIG9uZSByZXR1cm5zIGEgbG9jYXRvciBkYXRhIG9yIHdpbGwgdGhyb3cgaWYgbm8gcmVzb2x2ZXIgaGFuZGxlZCB0aGUgcmVxdWVzdC5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbigncmVzb2x2aW5nJywgKHsgc2NyaXB0SWQsIGNhbGxlciB9KSA9PiB7IH0pYCB0byBsaXN0ZW4gZm9yIHdoZW5cbiAgICogdGhlIHNjcmlwdCByZXNvbHV0aW9uIGJlZ2lucy5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbigncmVzb2x2ZWQnLCAoc2NyaXB0KSA9PiB7IH0pYCB0byBsaXN0ZW4gZm9yIHdoZW5cbiAgICogdGhlIHNjcmlwdCdzIGxvY2F0b3IgZGF0YSBpcyByZXNvbHZlZC5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQgdG8gcmVzb2x2ZS5cbiAgICogQHBhcmFtIGNhbGxlciBOYW1lIG9mIHRoZSBjYWxsaW5nIHNjcmlwdCAtIGl0IGNhbiBiZSBmb3IgZXhhbXBsZTogbmFtZSBvZiB0aGUgYnVuZGxlLCBjaHVuayBvciBjb250YWluZXIuXG4gICAqLyBmdW5jdGlvbiByZXNvbHZlU2NyaXB0KF8wLCBfMSwgXzIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihzY3JpcHRJZCwgY2FsbGVyLCByZWYsIHJlZmVyZW5jZVVybCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgd2VicGFja0NvbnRleHQgPSByZWYgPT09IHZvaWQgMCA/ICgwLCBfZ2V0V2VicGFja0NvbnRleHQuZ2V0V2VicGFja0NvbnRleHQpKCkgOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaW5pdENhY2hlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmVzb2x2ZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc2NyaXB0IHJlc29sdmVycyB3ZXJlIGFkZGVkLiBEaWQgeW91IGZvcmdldCB0byBjYWxsIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlciguLi4pYD8nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgncmVzb2x2aW5nJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF8kcmVmIG9mIHRoaXMucmVzb2x2ZXJzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhfJHJlZiwgMyksIHJlc29sdmUgPSBfcmVmWzJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0b3IgPSB5aWVsZCByZXNvbHZlKHNjcmlwdElkLCBjYWxsZXIsIHJlZmVyZW5jZVVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsb2NhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyByZXNvbHZlciB3YXMgYWJsZSB0byByZXNvbHZlIHNjcmlwdCAke3NjcmlwdElkfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBsb2NhdG9yLnVybCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0b3IudXJsID0gbG9jYXRvci51cmwod2VicGFja0NvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdCA9IF9TY3JpcHQuU2NyaXB0LmZyb20oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgbG9jYXRvciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gc2NyaXB0LmxvY2F0b3IudW5pcXVlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB1c2VyIHByb3ZpZGVkIGEgY3VzdG9tIHNob3VsZFVwZGF0ZVNjcmlwdCBmdW5jdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0b3Iuc2hvdWxkVXBkYXRlU2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgc28sIHdlIG5lZWQgdG8gd2FpdCBmb3IgaXQgdG8gcmVzb2x2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmZXRjaCA9IHlpZWxkIGxvY2F0b3Iuc2hvdWxkVXBkYXRlU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIHNjcmlwdC5zaG91bGRVcGRhdGVDYWNoZSh0aGlzLmNhY2hlW2NhY2hlS2V5XSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGl0IHJldHVybnMgdHJ1ZSwgd2UgbmVlZCB0byBmZXRjaCB0aGUgc2NyaXB0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZldGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdC5sb2NhdG9yLmZldGNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdyZXNvbHZlZCcsIHNjcmlwdC50b09iamVjdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCByZXR1cm5zIGZhbHNlLCB3ZSBkb24ndCBuZWVkIHRvIGZldGNoIHRoZSBzY3JpcHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NyaXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgbm8gY3VzdG9tIHNob3VsZFVwZGF0ZVNjcmlwdCBmdW5jdGlvbiB3YXMgcHJvdmlkZWQsIHdlIHVzZSB0aGUgZGVmYXVsdCBiZWhhdmlvdXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZVtjYWNoZUtleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHQubG9jYXRvci5mZXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNjcmlwdC5zaG91bGRSZWZldGNoKHRoaXMuY2FjaGVbY2FjaGVLZXldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdC5sb2NhdG9yLmZldGNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgncmVzb2x2ZWQnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NyaXB0O1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1tTY3JpcHRNYW5hZ2VyXSBGYWlsZWQgd2hpbGUgcmVzb2x2aW5nIHNjcmlwdCBsb2NhdG9yOicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInVwZGF0ZUNhY2hlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQ2FjaGUoc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY3JpcHQubG9jYXRvci5mZXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gc2NyaXB0LmxvY2F0b3IudW5pcXVlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlW2NhY2hlS2V5XSA9IHNjcmlwdC5nZXRDYWNoZURhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2F2ZUNhY2hlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNjcmlwdFwiLFxuICAgICAgICAgICAgdmFsdWU6IC8qKlxuICAgKiBSZXNvbHZlcyBnaXZlbiBzY3JpcHQncyBsb2NhdGlvbiwgZG93bmxvYWRzIGFuZCBleGVjdXRlcyBpdC5cbiAgICogVGhlIGV4ZWN1dGlvbiBvZiB0aGUgY29kZSBpcyBoYW5kbGVkIGludGVybmFsbHkgYnkgdGhyZWFkaW5nIGluIFJlYWN0IE5hdGl2ZS5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbignbG9hZGluZycsIChzY3JpcHQpID0+IHsgfSlgIHRvIGxpc3RlbiBmb3Igd2hlblxuICAgKiB0aGUgc2NyaXB0IGlzIGFib3V0IHRvIGJlIGxvYWRlZC5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbignbG9hZGVkJywgKHNjcmlwdCkgPT4geyB9KWAgdG8gbGlzdGVuIGZvciB3aGVuXG4gICAqIHRoZSBzY3JpcHQgaXMgbG9hZGVkLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdCB0byBsb2FkLlxuICAgKiBAcGFyYW0gY2FsbGVyIE5hbWUgb2YgdGhlIGNhbGxpbmcgc2NyaXB0IC0gaXQgY2FuIGJlIGZvciBleGFtcGxlOiBuYW1lIG9mIHRoZSBidW5kbGUsIGNodW5rIG9yIGNvbnRhaW5lci5cbiAgICovIGZ1bmN0aW9uIGxvYWRTY3JpcHQoXzAsIF8xLCBfMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKHNjcmlwdElkLCBjYWxsZXIsIHJlZiwgcmVmZXJlbmNlVXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB3ZWJwYWNrQ29udGV4dCA9IHJlZiA9PT0gdm9pZCAwID8gKDAsIF9nZXRXZWJwYWNrQ29udGV4dC5nZXRXZWJwYWNrQ29udGV4dCkoKSA6IHJlZjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVuaXF1ZUlkID0gX1NjcmlwdC5TY3JpcHQuZ2V0U2NyaXB0VW5pcXVlSWQoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1ByZWZldGNoID0gdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdLmlzUHJlZmV0Y2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmVmZXRjaCBpcyBub3QgZXhlY3V0ZSB0aGUgc2NyaXB0IHNvIHdlIG5lZWQgdG8gcnVuIGxvYWRTY3JpcHQgaWYgcHJvbWlzZSBpcyBmb3IgcHJlZmV0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1ByZWZldGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkUHJvY2VzcyA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzY3JpcHQgPSB5aWVsZCB0aGlzLnJlc29sdmVTY3JpcHQoc2NyaXB0SWQsIGNhbGxlciwgd2VicGFja0NvbnRleHQsIHJlZmVyZW5jZVVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdsb2FkaW5nJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmxvYWRTY3JpcHRXaXRoUmV0cnkoc2NyaXB0SWQsIHNjcmlwdC5sb2NhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdsb2FkZWQnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMudXBkYXRlQ2FjaGUoc2NyaXB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29kZSA9IGVycm9yLmNvZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdbU2NyaXB0TWFuYWdlcl0gRmFpbGVkIHRvIGxvYWQgc2NyaXB0OicsIGNvZGUgPyBgWyR7Y29kZX1dYCA6ICcnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgZGVsZXRlIHNjcmlwdCBwcm9taXNlIGV2ZW4gc2NyaXB0IGZhaWxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXSA9IGxvYWRQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF07XG4gICAgICAgICAgICAgICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTY3JpcHRXaXRoUmV0cnlcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogTG9hZHMgYSBzY3JpcHQgd2l0aCByZXRyeSBsb2dpYy5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbiBhdHRlbXB0cyB0byBsb2FkIGEgc2NyaXB0IHVzaW5nIHRoZSBuYXRpdmVTY3JpcHRNYW5hZ2VyLlxuICAgKiBJZiB0aGUgaW5pdGlhbCBhdHRlbXB0IGZhaWxzLCBpdCByZXRyaWVzIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzXG4gICAqIHdpdGggYW4gb3B0aW9uYWwgZGVsYXkgYmV0d2VlbiByZXRyaWVzLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2NyaXB0SWQgLSBUaGUgSUQgb2YgdGhlIHNjcmlwdCB0byBsb2FkLlxuICAgKiBAcGFyYW0ge05vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yfSBsb2NhdG9yIC0gQW4gTm9ybWFsaXplZFNjcmlwdExvY2F0b3IgY29udGFpbmluZyByZXRyeSBjb25maWd1cmF0aW9uLlxuICAgKiBAcGFyYW0ge251bWJlcn0gW2xvY2F0b3IucmV0cnk9MF0gLSBUaGUgbnVtYmVyIG9mIHJldHJ5IGF0dGVtcHRzLlxuICAgKiBAcGFyYW0ge251bWJlcn0gW2xvY2F0b3IucmV0cnlEZWxheT0wXSAtIFRoZSBkZWxheSBpbiBtaWxsaXNlY29uZHMgYmV0d2VlbiByZXRyaWVzLlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3dzIGFuIGVycm9yIGlmIGFsbCByZXRyeSBhdHRlbXB0cyBmYWlsLlxuICAgKi8gZnVuY3Rpb24gbG9hZFNjcmlwdFdpdGhSZXRyeShzY3JpcHRJZCwgbG9jYXRvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2xvY2F0b3JfcmV0cnkgPSBsb2NhdG9yLnJldHJ5LCByZXRyeSA9IF9sb2NhdG9yX3JldHJ5ID09PSB2b2lkIDAgPyAwIDogX2xvY2F0b3JfcmV0cnksIF9sb2NhdG9yX3JldHJ5RGVsYXkgPSBsb2NhdG9yLnJldHJ5RGVsYXksIHJldHJ5RGVsYXkgPSBfbG9jYXRvcl9yZXRyeURlbGF5ID09PSB2b2lkIDAgPyAwIDogX2xvY2F0b3JfcmV0cnlEZWxheTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0dGVtcHRzID0gcmV0cnkgKyAxOyAvLyBJbmNsdWRlIHRoZSBpbml0aWFsIGF0dGVtcHRcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUoYXR0ZW1wdHMgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5uYXRpdmVTY3JpcHRNYW5hZ2VyLmxvYWRTY3JpcHQoc2NyaXB0SWQsIGxvY2F0b3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gU3VjY2Vzc2Z1bGx5IGxvYWRlZCB0aGUgc2NyaXB0LCBleGl0IHRoZSBsb29wXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGVtcHRzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBlcnJvci5jb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRlbXB0cyA+IDAgJiYgTE9BRElOR19FUlJPUl9DT0RFUy5pbmNsdWRlcyhjb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0cnlEZWxheSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKT0+c2V0VGltZW91dChyZXNvbHZlLCByZXRyeURlbGF5KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjsgLy8gTm8gbW9yZSByZXRyaWVzLCB0aHJvdyB0aGUgZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicHJlZmV0Y2hTY3JpcHRcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogUmVzb2x2ZXMgZ2l2ZW4gc2NyaXB0J3MgbG9jYXRpb24gYW5kIGRvd25sb2FkcyBpdCB3aXRob3V0IGV4ZWN1dGluZy5cbiAgICogVGhpcyBmdW5jdGlvbiBjYW4gYmUgYXdhaXRlZCB0byBkZXRlY3QgaWYgdGhlIHNjcmlwdCB3YXMgZG93bmxvYWRlZCBhbmQgZm9yIGVycm9yIGhhbmRsaW5nLlxuICAgKlxuICAgKiBVc2UgYFNjcmlwdE1hbmFnZXIuc2hhcmVkLm9uKCdwcmVmZXRjaGluZycsIChzY3JpcHQpID0+IHsgfSlgIHRvIGxpc3RlbiBmb3Igd2hlblxuICAgKiB0aGUgc2NyaXB0J3MgcHJlZmV0Y2ggYmVpbmdzLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdCB0byBwcmVmZXRjaC5cbiAgICogQHBhcmFtIGNhbGxlciBOYW1lIG9mIHRoZSBjYWxsaW5nIHNjcmlwdCAtIGl0IGNhbiBiZSBmb3IgZXhhbXBsZTogbmFtZSBvZiB0aGUgYnVuZGxlLCBjaHVuayBvciBjb250YWluZXIuXG4gICAqLyBmdW5jdGlvbiBwcmVmZXRjaFNjcmlwdChfMCwgXzEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihzY3JpcHRJZCwgY2FsbGVyLCByZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdlYnBhY2tDb250ZXh0ID0gcmVmID09PSB2b2lkIDAgPyAoMCwgX2dldFdlYnBhY2tDb250ZXh0LmdldFdlYnBhY2tDb250ZXh0KSgpIDogcmVmO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdW5pcXVlSWQgPSBfU2NyaXB0LlNjcmlwdC5nZXRTY3JpcHRVbmlxdWVJZChzY3JpcHRJZCwgY2FsbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFByb2Nlc3MgPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2NyaXB0ID0geWllbGQgdGhpcy5yZXNvbHZlU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIHdlYnBhY2tDb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ3ByZWZldGNoaW5nJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLm5hdGl2ZVNjcmlwdE1hbmFnZXIucHJlZmV0Y2hTY3JpcHQoc2NyaXB0SWQsIHNjcmlwdC5sb2NhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy51cGRhdGVDYWNoZShzY3JpcHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZXJyb3IuY29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1tTY3JpcHRNYW5hZ2VyXSBGYWlsZWQgdG8gcHJlZmV0Y2ggc2NyaXB0OicsIGNvZGUgPyBgWyR7Y29kZX1dYCA6ICcnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgZGVsZXRlIHNjcmlwdCBwcm9taXNlIGV2ZW4gc2NyaXB0IGZhaWxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXSA9IGxvYWRQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXS5pc1ByZWZldGNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW52YWxpZGF0ZVNjcmlwdHNcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogQ2xlYXJzIHRoZSBjYWNoZSAoaWYgY29uZmlndXJlZCBpbiB7QGxpbmsgU2NyaXB0TWFuYWdlci5zZXRTdG9yYWdlfSkgYW5kIHJlbW92ZXMgZG93bmxvYWRlZFxuICAgKiBmaWxlcyBmb3IgZ2l2ZW4gc2NyaXB0cyBmcm9tIHRoZSBmaWxlc3lzdGVtLiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBhd2FpdGVkIHRvIGRldGVjdCBpZiB0aGVcbiAgICogc2NyaXB0cyB3ZXJlIGludmFsaWRhdGVkIGFuZCBmb3IgZXJyb3IgaGFuZGxpbmcuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ2ludmFsaWRhdGVkJywgKHNjcmlwdElkcykgPT4geyB9KWAgdG8gbGlzdGVuIGZvciB3aGVuXG4gICAqIHRoZSBpbnZhbGlkYXRpb24gY29tcGxldGVzLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWRzIEFycmF5IG9mIHNjcmlwdCBpZHMgdG8gY2xlYXIgZnJvbSBjYWNoZSBhbmQgcmVtb3ZlIGZyb20gZmlsZXN5c3RlbS5cbiAgICogQHJldHVybnMgQXJyYXkgb2Ygc2NyaXB0IGlkcyB0aGF0IHdlcmUgaW52YWxpZGF0ZWQuXG4gICAqLyBmdW5jdGlvbiBpbnZhbGlkYXRlU2NyaXB0cygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdElkcyA9IHJlZiA9PT0gdm9pZCAwID8gW10gOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmluaXRDYWNoZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkcyA9IHNjcmlwdElkcy5sZW5ndGggPyBzY3JpcHRJZHMgOiBPYmplY3Qua2V5cyh0aGlzLmNhY2hlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkcy5mb3JFYWNoKChzY3JpcHRJZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5jYWNoZVtzY3JpcHRJZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2NyaXB0c1Byb21pc2VzW3NjcmlwdElkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zYXZlQ2FjaGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMubmF0aXZlU2NyaXB0TWFuYWdlci5pbnZhbGlkYXRlU2NyaXB0cyhzY3JpcHRJZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdpbnZhbGlkYXRlZCcsIGlkcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaWRzO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBlcnJvci5jb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1tTY3JpcHRNYW5hZ2VyXSBGYWlsZWQgdG8gaW52YWxpZGF0ZSBzY3JpcHRzOicsIGNvZGUgPyBgWyR7Y29kZX1dYCA6ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBFdmFsdWF0ZXMgYSBzY3JpcHQgc3luY2hyb25vdXNseS5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbiBzZW5kcyB0aGUgc2NyaXB0IHNvdXJjZSBhbmQgaXRzIFVSTCB0byB0aGUgbmF0aXZlIHNjcmlwdCBtYW5hZ2VyIGZvciBldmFsdWF0aW9uLlxuICAgKiBJdCBpcyBmdW5jdGlvbmFsbHkgaWRlbnRpY2FsIHRvIGBnbG9iYWxFdmFsV2l0aFNvdXJjZVVybGAuXG4gICAqXG4gICAqIEBwYXJhbSBzY3JpcHRTb3VyY2UgVGhlIHNvdXJjZSBjb2RlIG9mIHRoZSBzY3JpcHQgdG8gZXZhbHVhdGUuXG4gICAqIEBwYXJhbSBzY3JpcHRTb3VyY2VVcmwgVGhlIFVSTCBvZiB0aGUgc2NyaXB0IHNvdXJjZSwgdXNlZCBmb3IgZGVidWdnaW5nIHB1cnBvc2VzLlxuICAgKi8ga2V5OiBcInVuc3RhYmxlX2V2YWx1YXRlU2NyaXB0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdGFibGVfZXZhbHVhdGVTY3JpcHQoc2NyaXB0U291cmNlLCBzY3JpcHRTb3VyY2VVcmwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVNjcmlwdE1hbmFnZXIudW5zdGFibGVfZXZhbHVhdGVTY3JpcHQoc2NyaXB0U291cmNlLCBzY3JpcHRTb3VyY2VVcmwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlcikge1xuICAgICAgICAgICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlciA9IG5ldyBTY3JpcHRNYW5hZ2VyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic2hhcmVkXCIsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBTY3JpcHRNYW5hZ2VyO1xufSAvLyMgc291cmNlTWFwcGluZ1VSTD1TY3JpcHRNYW5hZ2VyLmpzLm1hcFxuKF9ldmVudHMuZGVmYXVsdCk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2ZlZGVyYXRlZC5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2ZlZGVyYXRlZC5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkZlZGVyYXRlZFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEZlZGVyYXRlZDtcbiAgICB9XG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIF9TY3JpcHRNYW5hZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9TY3JpcHRNYW5hZ2VyLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0TWFuYWdlci5qc1wiKTtcbnZhciBGZWRlcmF0ZWQ7XG4oZnVuY3Rpb24oX0ZlZGVyYXRlZCkge1xuICAgIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKlxuICAgKiBSZXNvbHZlcyBVUkwgdG8gYSBjb250YWluZXIgb3IgYSBjaHVuayB3aGVuIHVzaW5nIE1vZHVsZSBGZWRlcmF0aW9uLFxuICAgKiBiYXNlZCBvbiBnaXZlbiBgc2NyaXB0SWRgIGFuZCBgY2FsbGVyYC5cbiAgICovIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKlxuICAgKiBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHtAbGluayBjcmVhdGVVUkxSZXNvbHZlcn0gZm9yIE1vZHVsZSBGZWRlcmF0aW9uLlxuICAgKiBBbGxvd3MgdG8gY29uZmlndXJlIGhvdyBjcmVhdGVkIHtAbGluayBVUkxSZXNvbHZlcn0gd2lsbCBiZWhhdmUuXG4gICAqLyAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICpcbiAgICogQ3JlYXRlcyBVUkwgcmVzb2x2ZXIgZm9yIE1vZHVsZSBGZWRlcmF0aW9uIGZyb20gcHJvdmlkZWQgY29uZmlnLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgeyBTY3JpcHRNYW5hZ2VyLCBTY3JpcHQsIEZlZGVyYXRlZCB9IGZyb20gJ0BjYWxsc3RhY2svcmVwYWNrL2NsaWVudCc7XG4gICAqXG4gICAqIGNvbnN0IHJlc29sdmVVUkwgPSBGZWRlcmF0ZWQuY3JlYXRlVVJMUmVzb2x2ZXIoe1xuICAgKiAgIGNvbnRhaW5lcnM6IHtcbiAgICogICAgIGFwcDE6ICdodHRwOi8vbG9jYWxob3N0OjkwMDEvW25hbWVdW2V4dF0nLFxuICAgKiAgICAgYXBwMjogJ2h0dHA6Ly9sb2NhbGhvc3Q6OTAwMi9bbmFtZV0uY29udGFpbmVyLmpzJyxcbiAgICogICB9LFxuICAgKiAgIGNodW5rczoge1xuICAgKiAgICAgYXBwMjogJ2h0dHA6Ly9sb2NhbGhvc3Q6OTAwMi9jaHVua3MvW25hbWVdW2V4dF0nLFxuICAgKiAgIH0sXG4gICAqIH0pO1xuICAgKlxuICAgKiBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlcihhc3luYyAoc2NyaXB0SWQsIGNhbGxlcikgPT4ge1xuICAgKiAgIGxldCB1cmw7XG4gICAqICAgaWYgKGNhbGxlciA9PT0gJ21haW4nKSB7XG4gICAqICAgICB1cmwgPSBfX0RFVl9fXG4gICAqICAgICAgID8gU2NyaXB0LmdldERldlNlcnZlclVSTChzY3JpcHRJZClcbiAgICogICAgICAgOiBTY3JpcHQuZ2V0UmVtb3RlVVJMKGBodHRwOi8vbG9jYWxob3N0OjkwMDAvJHtzY3JpcHRJZH1gKTtcbiAgICogICB9IGVsc2Uge1xuICAgKiAgICAgdXJsID0gcmVzb2x2ZVVSTChzY3JpcHRJZCwgY2FsbGVyKTtcbiAgICogICB9XG4gICAqXG4gICAqICAgaWYgKCF1cmwpIHtcbiAgICogICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAqICAgfVxuICAgKlxuICAgKiAgIHJldHVybiB7XG4gICAqICAgICB1cmwsXG4gICAqICAgICBxdWVyeToge1xuICAgKiAgICAgICBwbGF0Zm9ybTogUGxhdGZvcm0uT1MsXG4gICAqICAgICB9LFxuICAgKiAgIH07XG4gICAqIH0pO1xuICAgKiBgYGBcbiAgICpcbiAgICogYGNyZWF0ZVVSTFJlc29sdmVyYCBpcyBhIGFic3RyYWN0aW9uIG92ZXIge0BsaW5rIFNjcmlwdC5nZXRSZW1vdGVVUkx9LFxuICAgKiBmb3IgZXhhbXBsZTpcbiAgICogYGBgdHNcbiAgICogaW1wb3J0IHsgU2NyaXB0TWFuYWdlciwgRmVkZXJhdGVkIH0gZnJvbSAnQGNhbGxzdGFjay9yZXBhY2svY2xpZW50JztcbiAgICpcbiAgICogU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoKHNjcmlwdElkLCBjYWxsZXIpID0+IHtcbiAgICogICBjb25zdCByZXNvbHZlVVJMID0gRmVkZXJhdGVkLmNyZWF0ZVVSTFJlc29sdmVyKHtcbiAgICogICAgIGNvbnRhaW5lcnM6IHtcbiAgICogICAgICAgYXBwMTogJ2h0dHA6Ly9sb2NhbGhvc3Q6OTAwMC9bbmFtZV1bZXh0XScsXG4gICAqICAgICB9LFxuICAgKiAgIH0pO1xuICAgKlxuICAgKiAgIHJldHVybiB7XG4gICAqICAgICB1cmw6IHJlc29sdmVVUkwoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAqICAgfTtcbiAgICogfSk7XG4gICAqIGBgYFxuICAgKiBpcyBlcXVpdmFsZW50IHRvOlxuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgeyBTY3JpcHRNYW5hZ2VyLCBTY3JpcHQgfSBmcm9tICdAY2FsbHN0YWNrL3JlcGFjay9jbGllbnQnO1xuICAgKlxuICAgKiBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlcihhc3luYyAoc2NyaXB0SWQsIGNhbGxlcikgPT4ge1xuICAgKiAgIGlmIChzY3JpcHRJZCA9PT0gJ2FwcDEnKSB7XG4gICAqICAgICByZXR1cm4ge1xuICAgKiAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjkwMDAvYXBwMS5jb250YWluZXIuYnVuZGxlJyxcbiAgICogICAgIH07XG4gICAqICAgfVxuICAgKlxuICAgKiAgIGlmIChjYWxsZXIgPT09ICdhcHAxJykge1xuICAgKiAgICAgcmV0dXJuIHtcbiAgICogICAgICAgdXJsOiBTY3JpcHQuZ2V0UmVtb3RlVVJMKGBodHRwOi8vbG9jYWxob3N0OjkwMDAvJHtzY3JpcHRJZH1gKSxcbiAgICogICAgIH07XG4gICAqICAgfVxuICAgKiB9KTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSBjb25maWcgQ29uZmlndXJhdGlvbiBmb3IgdGhlIHJlc29sdmVyLlxuICAgKiBAcGFyYW0gY29udGFpbmVyRXh0IEV4dGVuc2lvbiBvZiBjb250YWluZXIgYnVuZGxlcy4gRGVmYXVsdHMgdG8gYC5jb250YWluZXIuYnVuZGxlYC5cbiAgICogQHJldHVybnMgQSByZXNvbHZlciBmdW5jdGlvbiB3aGljaCB3aWxsIHRyeSB0byByZXNvbHZlIFVSTCBiYXNlZCBvbiBnaXZlbiBgc2NyaXB0SWRgIGFuZCBgY2FsbGVyYC5cbiAgICovIGZ1bmN0aW9uIGNyZWF0ZVVSTFJlc29sdmVyKGNvbmZpZywgcmVmKSB7XG4gICAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgcmVzb2x2ZXJzW2tleV0gPSAoc2NyaXB0SWQsIGNhbGxlcik9PntcbiAgICAgICAgICAgICAgICBpZiAoc2NyaXB0SWQgPT09IGtleSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gY29uZmlnLmNvbnRhaW5lcnNba2V5XS5yZXBsYWNlKC9cXFtuYW1lXFxdL2csIHNjcmlwdElkKS5yZXBsYWNlKC9cXFtleHRcXF0vZywgY29udGFpbmVyRXh0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxlciA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY29uZmlnX2NodW5rcztcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybDEgPSAoKChfY29uZmlnX2NodW5rcyA9IGNvbmZpZy5jaHVua3MpID09PSBudWxsIHx8IF9jb25maWdfY2h1bmtzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY29uZmlnX2NodW5rc1trZXldKSA/PyBjb25maWcuY29udGFpbmVyc1trZXldKS5yZXBsYWNlKC9cXFtuYW1lXFxdL2csIHNjcmlwdElkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVybDEuaW5jbHVkZXMoJ1tleHRdJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT53ZWJwYWNrQ29udGV4dC51KHVybDEucmVwbGFjZSgvXFxbZXh0XFxdL2csICcnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICB2YXIgY29udGFpbmVyRXh0ID0gcmVmID09PSB2b2lkIDAgPyAnLmNvbnRhaW5lci5idW5kbGUnIDogcmVmO1xuICAgICAgICB2YXIgcmVzb2x2ZXJzID0ge307XG4gICAgICAgIGZvcih2YXIga2V5IGluIGNvbmZpZy5jb250YWluZXJzKV9sb29wKGtleSk7XG4gICAgICAgIHJldHVybiAoc2NyaXB0SWQsIGNhbGxlcik9PntcbiAgICAgICAgICAgIHZhciByZXNvbHZlciA9IChjYWxsZXIgPyByZXNvbHZlcnNbY2FsbGVyXSA6IHVuZGVmaW5lZCkgPz8gcmVzb2x2ZXJzW3NjcmlwdElkXTtcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlcihzY3JpcHRJZCwgY2FsbGVyKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgX0ZlZGVyYXRlZC5jcmVhdGVVUkxSZXNvbHZlciA9IGNyZWF0ZVVSTFJlc29sdmVyO1xuICAgIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKlxuICAgKiBEeW5hbWljYWxseSBpbXBvcnRzIG1vZHVsZSBmcm9tIGEgTW9kdWxlIEZlZGVyYXRpb24gY29udGFpbmVyLiBTaW1pbGFyIHRvIGBpbXBvcnQoJ2ZpbGUnKWAsIGJ1dFxuICAgKiBzcGVjaWZpYyB0byBNb2R1bGUgRmVkZXJhdGlvbi4gQ2FsbGluZyBgaW1wb3J0TW9kdWxlYCB3aWxsIGNyZWF0ZSBhbiBhc3luYyBib3VuZGFyeS5cbiAgICpcbiAgICogQ29udGFpbmVyIHdpbGwgYmUgZXZhbHVhdGVkIG9ubHkgb25jZS4gSWYgeW91IHVzZSBgaW1wb3J0TW9kdWxlYCBmb3IgdGhlIHNhbWUgY29udGFpbmVyIHR3aWNlLFxuICAgKiB0aGUgY29udGFpbmVyIHdpbGwgYmUgbG9hZGVkIGFuZCBldmFsdWF0ZWQgb25seSBvbiB0aGUgZmlyc3QgaW1wb3J0LlxuICAgKlxuICAgKiBVbmRlciB0aGUgaG9vZCwgYGltcG9ydE1vZHVsZWAgd2lsbCBjYWxsIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5sb2FkU2NyaXB0KGNvbnRhaW5lck5hbWUpYC5cbiAgICogVGhpcyBtZWFucywgYSByZXNvbHZlciBtdXN0IGJlIGFkZGVkIHdpdGggYFNjcmlwdE1hbmFnZXIuc2hhcmVkLmFkZFJlc29sdmVyKC4uLilgIGJlZm9yZWhhbmQgYW5kIHByb3ZpZGVkIHByb3BlclxuICAgKiByZXNvbHV0aW9uIGxvZ2ljIHRvIHJlc29sdmUgVVJMIGJhc2VkIG9uIHRoZSBgY29udGFpbmVyTmFtZWAuXG4gICAqXG4gICAqIEBwYXJhbSBjb250YWluZXJOYW1lIE5hbWUgb2YgdGhlIGNvbnRhaW5lciAtIHNob3VsZCBiZSB0aGUgc2FtZSBuYW1lIHByb3ZpZGVkIHRvXG4gICAqIGB3ZWJwYWNrLmNvbnRhaW5lci5Nb2R1bGVGZWRlcmF0aW9uUGx1Z2luYCBpbiBgbGlicmFyeS5uYW1lYC5cbiAgICogQHBhcmFtIG1vZHVsZSBGdWxsIG5hbWUgd2l0aCBleHRlbnNpb24gb2YgdGhlIG1vZHVsZSB0byBpbXBvcnQgZnJvbSB0aGUgY29udGFpbmVyIC0gb25seSBtb2R1bGVzXG4gICAqIGV4cG9zZWQgaW4gYGV4cG9zZXNgIGluIGB3ZWJwYWNrLmNvbnRhaW5lci5Nb2R1bGVGZWRlcmF0aW9uUGx1Z2luYCBjYW4gYmUgdXNlZC5cbiAgICogQHBhcmFtIHNjb3BlIE9wdGlvbmFsLCBzY29wZSBmb3Igc2hhcmluZyBtb2R1bGVzIGJldHdlZW4gY29udGFpbmVycy4gRGVmYXVsdHMgdG8gYCdkZWZhdWx0J2AuXG4gICAqIEByZXR1cm5zIEV4cG9ydHMgb2YgZ2l2ZW4gYG1vZHVsZWAgZnJvbSBnaXZlbiBjb250YWluZXIuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHRzXG4gICAqIGltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbiAgICogaW1wb3J0IHsgRmVkZXJhdGVkIH0gZnJvbSAnQGNhbGxzdGFjay9yZXBhY2svY2xpZW50JztcbiAgICpcbiAgICogY29uc3QgQnV0dG9uID0gUmVhY3QubGF6eSgoKSA9PiBGZWRlcmF0ZWQuaW1wb3J0TW9kdWxlKCdteS1jb21wb25lbnRzJywgJy4vQnV0dG9uLmpzJykpO1xuICAgKlxuICAgKiBjb25zdCBteVV0aWwgPSBhd2FpdCBGZWRlcmF0ZWQuaW1wb3J0TW9kdWxlKCdteS1saWInLCAnLi9teVV0aWwuanMnKTtcbiAgICogYGBgXG4gICAqLyBmdW5jdGlvbiBpbXBvcnRNb2R1bGUoY29udGFpbmVyTmFtZSwgbW9kdWxlLCByZWYpIHtcbiAgICAgICAgdmFyIHNjb3BlID0gcmVmID09PSB2b2lkIDAgPyAnZGVmYXVsdCcgOiByZWY7XG4gICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgdmFyIF9fd2VicGFja19zaGFyZV9zY29wZXNfX19zY29wZTtcbiAgICAgICAgICAgIGlmICghKChfX3dlYnBhY2tfc2hhcmVfc2NvcGVzX19fc2NvcGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLlNbc2NvcGVdKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfc2hhcmVfc2NvcGVzX19fc2NvcGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19zaGFyZV9zY29wZXNfX19zY29wZS5fX2lzSW5pdGlhbGl6ZWQpKSB7XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZXMgdGhlIHNoYXJlIHNjb3BlLlxuICAgICAgICAgICAgICAgIC8vIFRoaXMgZmlsbHMgaXQgd2l0aCBrbm93biBwcm92aWRlZCBtb2R1bGVzIGZyb20gdGhpcyBidWlsZCBhbmQgYWxsIHJlbW90ZXMuXG4gICAgICAgICAgICAgICAgeWllbGQgX193ZWJwYWNrX3JlcXVpcmVfXy5JKHNjb3BlKTtcbiAgICAgICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLlNbc2NvcGVdLl9faXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBEbyBub3QgdXNlIGBjb25zdCBjb250YWluZXIgPSBzZWxmW2NvbnRhaW5lck5hbWVdO2AgaGVyZS4gT25jZSBjb250YWluZXIgaXMgbG9hZGVkXG4gICAgICAgICAgICAvLyBgY29udGFpbmVyYCByZWZlcmVuY2UgaXMgbm90IHVwZGF0ZWQsIHNvIGBjb250YWluZXIuX19pc0luaXRpYWxpemVkYFxuICAgICAgICAgICAgLy8gd2lsbCBjcmFzaCB0aGUgYXBwbGljYXRpb24sIGJlY2F1c2Ugb2YgcmVhZGluZyBwcm9wZXJ0eSBmcm9tIGB1bmRlZmluZWRgLlxuICAgICAgICAgICAgaWYgKCFzZWxmW2NvbnRhaW5lck5hbWVdKSB7XG4gICAgICAgICAgICAgICAgLy8gRG93bmxvYWQgYW5kIGV4ZWN1dGUgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgeWllbGQgX1NjcmlwdE1hbmFnZXIuU2NyaXB0TWFuYWdlci5zaGFyZWQubG9hZFNjcmlwdChjb250YWluZXJOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBzZWxmW2NvbnRhaW5lck5hbWVdO1xuICAgICAgICAgICAgaWYgKCFjb250YWluZXIuX19pc0luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLl9faXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgY29udGFpbmVyLCBpdCBtYXkgcHJvdmlkZSBzaGFyZWQgbW9kdWxlc1xuICAgICAgICAgICAgICAgIHlpZWxkIGNvbnRhaW5lci5pbml0KF9fd2VicGFja19yZXF1aXJlX18uU1tzY29wZV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZhY3RvcnkgPSB5aWVsZCBjb250YWluZXIuZ2V0KG1vZHVsZSk7XG4gICAgICAgICAgICB2YXIgZXhwb3J0czEgPSBmYWN0b3J5KCk7XG4gICAgICAgICAgICByZXR1cm4gZXhwb3J0czE7XG4gICAgICAgIH0pKCk7XG4gICAgfVxuICAgIF9GZWRlcmF0ZWQuaW1wb3J0TW9kdWxlID0gaW1wb3J0TW9kdWxlO1xufSkoRmVkZXJhdGVkIHx8IChGZWRlcmF0ZWQgPSB7fSkpOyAvLyMgc291cmNlTWFwcGluZ1VSTD1mZWRlcmF0ZWQuanMubWFwXG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2dldFdlYnBhY2tDb250ZXh0LmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9nZXRXZWJwYWNrQ29udGV4dC5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbi8qKlxuICogR2V0IFdlYnBhY2sgcnVudGltZSBjb250ZXh0IGZvcm0gY3VycmVudCBKYXZhU2NyaXB0IHNjb3BlLlxuICpcbiAqIF9fWW91IGxpa2VseSBkb24ndCBuZWVkIHRvIHVzZSBpdC5fX1xuICovIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZ2V0V2VicGFja0NvbnRleHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBnZXRXZWJwYWNrQ29udGV4dDtcbiAgICB9XG59KSk7XG5mdW5jdGlvbiBnZXRXZWJwYWNrQ29udGV4dCgpIHtcbiAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXztcbn0gLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2V0V2VicGFja0NvbnRleHQuanMubWFwXG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9pbmRleC5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiRmVkZXJhdGVkXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX2ZlZGVyYXRlZC5GZWRlcmF0ZWQ7XG4gICAgfVxufSkpO1xudmFyIF9leHBvcnRfc3RhciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19leHBvcnRfc3RhciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2V4cG9ydF9zdGFyLmNqc1wiKTtcbl9leHBvcnRfc3Rhci5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vU2NyaXB0TWFuYWdlci5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL1NjcmlwdE1hbmFnZXIuanNcIiksIGV4cG9ydHMpO1xuX2V4cG9ydF9zdGFyLl8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9TY3JpcHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanNcIiksIGV4cG9ydHMpO1xuX2V4cG9ydF9zdGFyLl8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi90eXBlcy5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL3R5cGVzLmpzXCIpLCBleHBvcnRzKTtcbl9leHBvcnRfc3Rhci5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZ2V0V2VicGFja0NvbnRleHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9nZXRXZWJwYWNrQ29udGV4dC5qc1wiKSwgZXhwb3J0cyk7XG52YXIgX2ZlZGVyYXRlZCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZmVkZXJhdGVkLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvZmVkZXJhdGVkLmpzXCIpO1xuIC8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci90eXBlcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvdHlwZXMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbiAvLyMgc291cmNlTWFwcGluZ1VSTD10eXBlcy5qcy5tYXBcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX0NvcmVQbHVnaW4uZGVmYXVsdDtcbiAgICB9XG59KSk7XG52YXIgX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuY2pzXCIpO1xudmFyIF9Db3JlUGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL0NvcmVQbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL0NvcmVQbHVnaW4uanNcIikpO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX1Jlc29sdmVyUGx1Z2luLmRlZmF1bHQ7XG4gICAgfVxufSkpO1xudmFyIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiKTtcbnZhciBfUmVzb2x2ZXJQbHVnaW4gPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvUmVzb2x2ZXJQbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL1Jlc29sdmVyUGx1Z2luLmpzXCIpKTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzL2Rpc3QvaW5kZXguY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgUlVOVElNRV8wMDEgPSAnUlVOVElNRS0wMDEnO1xudmFyIFJVTlRJTUVfMDAyID0gJ1JVTlRJTUUtMDAyJztcbnZhciBSVU5USU1FXzAwMyA9ICdSVU5USU1FLTAwMyc7XG52YXIgUlVOVElNRV8wMDQgPSAnUlVOVElNRS0wMDQnO1xudmFyIFJVTlRJTUVfMDA1ID0gJ1JVTlRJTUUtMDA1JztcbnZhciBSVU5USU1FXzAwNiA9ICdSVU5USU1FLTAwNic7XG52YXIgUlVOVElNRV8wMDcgPSAnUlVOVElNRS0wMDcnO1xudmFyIFJVTlRJTUVfMDA4ID0gJ1JVTlRJTUUtMDA4JztcbnZhciBUWVBFXzAwMSA9ICdUWVBFLTAwMSc7XG52YXIgQlVJTERfMDAxID0gJ0JVSUxELTAwMSc7XG52YXIgZ2V0RG9jc1VybCA9IChlcnJvckNvZGUpPT57XG4gICAgdmFyIHR5cGUgPSBlcnJvckNvZGUuc3BsaXQoJy0nKVswXS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBgaHR0cHM6Ly9tb2R1bGUtZmVkZXJhdGlvbi5pby9ndWlkZS90cm91Ymxlc2hvb3RpbmcvJHt0eXBlfS8ke2Vycm9yQ29kZX1gO1xufTtcbnZhciBnZXRTaG9ydEVycm9yTXNnID0gKGVycm9yQ29kZSwgZXJyb3JEZXNjTWFwLCBhcmdzLCBvcmlnaW5hbEVycm9yTXNnKT0+e1xuICAgIHZhciBtc2cgPSBbXG4gICAgICAgIGAke1tcbiAgICAgICAgICAgIGVycm9yRGVzY01hcFtlcnJvckNvZGVdXG4gICAgICAgIF19ICMke2Vycm9yQ29kZX1gXG4gICAgXTtcbiAgICBhcmdzICYmIG1zZy5wdXNoKGBhcmdzOiAke0pTT04uc3RyaW5naWZ5KGFyZ3MpfWApO1xuICAgIG1zZy5wdXNoKGdldERvY3NVcmwoZXJyb3JDb2RlKSk7XG4gICAgb3JpZ2luYWxFcnJvck1zZyAmJiBtc2cucHVzaChgT3JpZ2luYWwgRXJyb3IgTWVzc2FnZTpcXG4gJHtvcmlnaW5hbEVycm9yTXNnfWApO1xuICAgIHJldHVybiBtc2cuam9pbignXFxuJyk7XG59O1xuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gICAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQpIHtcbiAgICAgICAgZm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gc291cmNlKWlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbiAgICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbnZhciBydW50aW1lRGVzY01hcCA9IHtcbiAgICBbUlVOVElNRV8wMDFdOiAnRmFpbGVkIHRvIGdldCByZW1vdGVFbnRyeSBleHBvcnRzLicsXG4gICAgW1JVTlRJTUVfMDAyXTogJ1RoZSByZW1vdGUgZW50cnkgaW50ZXJmYWNlIGRvZXMgbm90IGNvbnRhaW4gXCJpbml0XCInLFxuICAgIFtSVU5USU1FXzAwM106ICdGYWlsZWQgdG8gZ2V0IG1hbmlmZXN0LicsXG4gICAgW1JVTlRJTUVfMDA0XTogJ0ZhaWxlZCB0byBsb2NhdGUgcmVtb3RlLicsXG4gICAgW1JVTlRJTUVfMDA1XTogJ0ludmFsaWQgbG9hZFNoYXJlU3luYyBmdW5jdGlvbiBjYWxsIGZyb20gYnVuZGxlciBydW50aW1lJyxcbiAgICBbUlVOVElNRV8wMDZdOiAnSW52YWxpZCBsb2FkU2hhcmVTeW5jIGZ1bmN0aW9uIGNhbGwgZnJvbSBydW50aW1lJyxcbiAgICBbUlVOVElNRV8wMDddOiAnRmFpbGVkIHRvIGdldCByZW1vdGUgc25hcHNob3QuJyxcbiAgICBbUlVOVElNRV8wMDhdOiAnRmFpbGVkIHRvIGxvYWQgc2NyaXB0IHJlc291cmNlcy4nXG59O1xudmFyIHR5cGVEZXNjTWFwID0ge1xuICAgIFtUWVBFXzAwMV06ICdGYWlsZWQgdG8gZ2VuZXJhdGUgdHlwZSBkZWNsYXJhdGlvbi4nXG59O1xudmFyIGJ1aWxkRGVzY01hcCA9IHtcbiAgICBbQlVJTERfMDAxXTogJ0ZhaWxlZCB0byBmaW5kIGV4cG9zZSBtb2R1bGUuJ1xufTtcbnZhciBlcnJvckRlc2NNYXAgPSBfZXh0ZW5kcyh7fSwgcnVudGltZURlc2NNYXAsIHR5cGVEZXNjTWFwLCBidWlsZERlc2NNYXApO1xuZXhwb3J0cy5CVUlMRF8wMDEgPSBCVUlMRF8wMDE7XG5leHBvcnRzLlJVTlRJTUVfMDAxID0gUlVOVElNRV8wMDE7XG5leHBvcnRzLlJVTlRJTUVfMDAyID0gUlVOVElNRV8wMDI7XG5leHBvcnRzLlJVTlRJTUVfMDAzID0gUlVOVElNRV8wMDM7XG5leHBvcnRzLlJVTlRJTUVfMDA0ID0gUlVOVElNRV8wMDQ7XG5leHBvcnRzLlJVTlRJTUVfMDA1ID0gUlVOVElNRV8wMDU7XG5leHBvcnRzLlJVTlRJTUVfMDA2ID0gUlVOVElNRV8wMDY7XG5leHBvcnRzLlJVTlRJTUVfMDA3ID0gUlVOVElNRV8wMDc7XG5leHBvcnRzLlJVTlRJTUVfMDA4ID0gUlVOVElNRV8wMDg7XG5leHBvcnRzLlRZUEVfMDAxID0gVFlQRV8wMDE7XG5leHBvcnRzLmJ1aWxkRGVzY01hcCA9IGJ1aWxkRGVzY01hcDtcbmV4cG9ydHMuZXJyb3JEZXNjTWFwID0gZXJyb3JEZXNjTWFwO1xuZXhwb3J0cy5nZXRTaG9ydEVycm9yTXNnID0gZ2V0U2hvcnRFcnJvck1zZztcbmV4cG9ydHMucnVudGltZURlc2NNYXAgPSBydW50aW1lRGVzY01hcDtcbmV4cG9ydHMudHlwZURlc2NNYXAgPSB0eXBlRGVzY01hcDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L2luZGV4LmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIF9jYWxsX3N1cGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NhbGxfc3VwZXIgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jYWxsX3N1cGVyLmNqc1wiKTtcbnZhciBfY2xhc3NfY2FsbF9jaGVjayA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jbGFzc19jYWxsX2NoZWNrICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janNcIik7XG52YXIgX2NyZWF0ZV9jbGFzcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jcmVhdGVfY2xhc3MgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzXCIpO1xudmFyIF9pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbmhlcml0cyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2luaGVyaXRzLmNqc1wiKTtcbnZhciBfc2xpY2VkX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3NsaWNlZF90b19hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janNcIik7XG52YXIgX3RvX2NvbnN1bWFibGVfYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fdG9fY29uc3VtYWJsZV9hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzXCIpO1xudmFyIF90eXBlX29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3R5cGVfb2YgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190eXBlX29mLmNqc1wiKTtcbnZhciBwb2x5ZmlsbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3BvbHlmaWxscy5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvcG9seWZpbGxzLmNqcy5qc1wiKTtcbnZhciBzZGsgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAbW9kdWxlLWZlZGVyYXRpb24vc2RrICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbnZhciBlcnJvckNvZGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzL2Rpc3QvaW5kZXguY2pzLmpzXCIpO1xudmFyIExPR19DQVRFR09SWSA9ICdbIEZlZGVyYXRpb24gUnVudGltZSBdJztcbi8vIEZJWE1FOiBwcmUtYnVuZGxlID9cbnZhciBsb2dnZXIgPSBzZGsuY3JlYXRlTG9nZ2VyKExPR19DQVRFR09SWSk7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xuZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgbXNnKSB7XG4gICAgaWYgKCFjb25kaXRpb24pIHtcbiAgICAgICAgZXJyb3IobXNnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBlcnJvcihtc2cpIHtcbiAgICBpZiAobXNnIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgbXNnLm1lc3NhZ2UgPSBgJHtMT0dfQ0FURUdPUll9OiAke21zZy5tZXNzYWdlfWA7XG4gICAgICAgIHRocm93IG1zZztcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGAke0xPR19DQVRFR09SWX06ICR7bXNnfWApO1xufVxuZnVuY3Rpb24gd2Fybihtc2cpIHtcbiAgICBpZiAobXNnIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgbXNnLm1lc3NhZ2UgPSBgJHtMT0dfQ0FURUdPUll9OiAke21zZy5tZXNzYWdlfWA7XG4gICAgICAgIGxvZ2dlci53YXJuKG1zZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbG9nZ2VyLndhcm4obXNnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhZGRVbmlxdWVJdGVtKGFyciwgaXRlbSkge1xuICAgIGlmIChhcnIuZmluZEluZGV4KChuYW1lMSk9Pm5hbWUxID09PSBpdGVtKSA9PT0gLTEpIHtcbiAgICAgICAgYXJyLnB1c2goaXRlbSk7XG4gICAgfVxuICAgIHJldHVybiBhcnI7XG59XG5mdW5jdGlvbiBnZXRGTUlkKHJlbW90ZUluZm8pIHtcbiAgICBpZiAoJ3ZlcnNpb24nIGluIHJlbW90ZUluZm8gJiYgcmVtb3RlSW5mby52ZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiBgJHtyZW1vdGVJbmZvLm5hbWV9OiR7cmVtb3RlSW5mby52ZXJzaW9ufWA7XG4gICAgfSBlbHNlIGlmICgnZW50cnknIGluIHJlbW90ZUluZm8gJiYgcmVtb3RlSW5mby5lbnRyeSkge1xuICAgICAgICByZXR1cm4gYCR7cmVtb3RlSW5mby5uYW1lfToke3JlbW90ZUluZm8uZW50cnl9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYCR7cmVtb3RlSW5mby5uYW1lfWA7XG4gICAgfVxufVxuZnVuY3Rpb24gaXNSZW1vdGVJbmZvV2l0aEVudHJ5KHJlbW90ZSkge1xuICAgIHJldHVybiB0eXBlb2YgcmVtb3RlLmVudHJ5ICE9PSAndW5kZWZpbmVkJztcbn1cbmZ1bmN0aW9uIGlzUHVyZVJlbW90ZUVudHJ5KHJlbW90ZSkge1xuICAgIHJldHVybiAhcmVtb3RlLmVudHJ5LmluY2x1ZGVzKCcuanNvbicpICYmIHJlbW90ZS5lbnRyeS5pbmNsdWRlcygnLmpzJyk7XG59XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZnVuY3Rpb24gc2FmZVdyYXBwZXIoY2FsbGJhY2ssIGRpc2FibGVXYXJuKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgcmVzID0geWllbGQgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICFkaXNhYmxlV2FybiAmJiB3YXJuKGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSkoKTtcbn1cbmZ1bmN0aW9uIGlzT2JqZWN0KHZhbCkge1xuICAgIHJldHVybiB2YWwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCc7XG59XG52YXIgb2JqZWN0VG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcbmZ1bmN0aW9uIGlzUGxhaW5PYmplY3QodmFsKSB7XG4gICAgcmV0dXJuIG9iamVjdFRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgT2JqZWN0XSc7XG59XG5mdW5jdGlvbiBpc1N0YXRpY1Jlc291cmNlc0VxdWFsKHVybDEsIHVybDIpIHtcbiAgICB2YXIgUkVHX0VYUCA9IC9eKGh0dHBzPzopP1xcL1xcLy9pO1xuICAgIC8vIFRyYW5zZm9ybSB1cmwxIGFuZCB1cmwyIGludG8gcmVsYXRpdmUgcGF0aHNcbiAgICB2YXIgcmVsYXRpdmVVcmwxID0gdXJsMS5yZXBsYWNlKFJFR19FWFAsICcnKS5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgIHZhciByZWxhdGl2ZVVybDIgPSB1cmwyLnJlcGxhY2UoUkVHX0VYUCwgJycpLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gICAgLy8gQ2hlY2sgaWYgdGhlIHJlbGF0aXZlIHBhdGhzIGFyZSBpZGVudGljYWxcbiAgICByZXR1cm4gcmVsYXRpdmVVcmwxID09PSByZWxhdGl2ZVVybDI7XG59XG5mdW5jdGlvbiBhcnJheU9wdGlvbnMob3B0aW9ucykge1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KG9wdGlvbnMpID8gb3B0aW9ucyA6IFtcbiAgICAgICAgb3B0aW9uc1xuICAgIF07XG59XG5mdW5jdGlvbiBnZXRSZW1vdGVFbnRyeUluZm9Gcm9tU25hcHNob3Qoc25hcHNob3QpIHtcbiAgICB2YXIgZGVmYXVsdFJlbW90ZUVudHJ5SW5mbyA9IHtcbiAgICAgICAgdXJsOiAnJyxcbiAgICAgICAgdHlwZTogJ2dsb2JhbCcsXG4gICAgICAgIGdsb2JhbE5hbWU6ICcnXG4gICAgfTtcbiAgICBpZiAoc2RrLmlzQnJvd3NlckVudigpKSB7XG4gICAgICAgIHJldHVybiAncmVtb3RlRW50cnknIGluIHNuYXBzaG90ID8ge1xuICAgICAgICAgICAgdXJsOiBzbmFwc2hvdC5yZW1vdGVFbnRyeSxcbiAgICAgICAgICAgIHR5cGU6IHNuYXBzaG90LnJlbW90ZUVudHJ5VHlwZSxcbiAgICAgICAgICAgIGdsb2JhbE5hbWU6IHNuYXBzaG90Lmdsb2JhbE5hbWVcbiAgICAgICAgfSA6IGRlZmF1bHRSZW1vdGVFbnRyeUluZm87XG4gICAgfVxuICAgIGlmICgnc3NyUmVtb3RlRW50cnknIGluIHNuYXBzaG90KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cmw6IHNuYXBzaG90LnNzclJlbW90ZUVudHJ5IHx8IGRlZmF1bHRSZW1vdGVFbnRyeUluZm8udXJsLFxuICAgICAgICAgICAgdHlwZTogc25hcHNob3Quc3NyUmVtb3RlRW50cnlUeXBlIHx8IGRlZmF1bHRSZW1vdGVFbnRyeUluZm8udHlwZSxcbiAgICAgICAgICAgIGdsb2JhbE5hbWU6IHNuYXBzaG90Lmdsb2JhbE5hbWVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmF1bHRSZW1vdGVFbnRyeUluZm87XG59XG52YXIgcHJvY2Vzc01vZHVsZUFsaWFzID0gKG5hbWUxLCBzdWJQYXRoKT0+e1xuICAgIC8vIEBob3N0LyAuL2J1dHRvbiAtPiBAaG9zdC9idXR0b25cbiAgICB2YXIgbW9kdWxlTmFtZTtcbiAgICBpZiAobmFtZTEuZW5kc1dpdGgoJy8nKSkge1xuICAgICAgICBtb2R1bGVOYW1lID0gbmFtZTEuc2xpY2UoMCwgLTEpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZHVsZU5hbWUgPSBuYW1lMTtcbiAgICB9XG4gICAgaWYgKHN1YlBhdGguc3RhcnRzV2l0aCgnLicpKSB7XG4gICAgICAgIHN1YlBhdGggPSBzdWJQYXRoLnNsaWNlKDEpO1xuICAgIH1cbiAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZSArIHN1YlBhdGg7XG4gICAgcmV0dXJuIG1vZHVsZU5hbWU7XG59O1xudmFyIEN1cnJlbnRHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcgPyBnbG9iYWxUaGlzIDogd2luZG93O1xudmFyIG5hdGl2ZUdsb2JhbCA9ICgoKT0+e1xuICAgIHRyeSB7XG4gICAgICAgIC8vIGdldCByZWFsIHdpbmRvdyAoaW5jYXNlIG9mIHNhbmRib3gpXG4gICAgICAgIHJldHVybiBkb2N1bWVudC5kZWZhdWx0VmlldztcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIG5vZGUgZW52XG4gICAgICAgIHJldHVybiBDdXJyZW50R2xvYmFsO1xuICAgIH1cbn0pKCk7XG52YXIgR2xvYmFsID0gbmF0aXZlR2xvYmFsO1xuZnVuY3Rpb24gZGVmaW5lUHJvcGVydHlHbG9iYWxWYWwodGFyZ2V0LCBrZXksIHZhbCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwge1xuICAgICAgICB2YWx1ZTogdmFsLFxuICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xufVxuZnVuY3Rpb24gaW5jbHVkZU93blByb3BlcnR5KHRhcmdldCwga2V5KSB7XG4gICAgcmV0dXJuIE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRhcmdldCwga2V5KTtcbn1cbi8vIFRoaXMgc2VjdGlvbiBpcyB0byBwcmV2ZW50IGVuY2Fwc3VsYXRpb24gYnkgY2VydGFpbiBtaWNyb2Zyb250ZW5kIGZyYW1ld29ya3MuIER1ZSB0byByZXVzZSBwb2xpY2llcywgc2FuZGJveCBlc2NhcGVzLlxuLy8gVGhlIHNhbmRib3ggaW4gdGhlIG1pY3JvZnJvbnRlbmQgZG9lcyBub3QgcmVwbGljYXRlIHRoZSB2YWx1ZSBvZiAnY29uZmlndXJhYmxlJy5cbi8vIElmIHRoZXJlIGlzIG5vIGxvYWRpbmcgY29udGVudCBvbiB0aGUgZ2xvYmFsIG9iamVjdCwgdGhpcyBzZWN0aW9uIGRlZmluZXMgdGhlIGxvYWRpbmcgb2JqZWN0LlxuaWYgKCFpbmNsdWRlT3duUHJvcGVydHkoQ3VycmVudEdsb2JhbCwgJ19fR0xPQkFMX0xPQURJTkdfUkVNT1RFX0VOVFJZX18nKSkge1xuICAgIGRlZmluZVByb3BlcnR5R2xvYmFsVmFsKEN1cnJlbnRHbG9iYWwsICdfX0dMT0JBTF9MT0FESU5HX1JFTU9URV9FTlRSWV9fJywge30pO1xufVxudmFyIGdsb2JhbExvYWRpbmcgPSBDdXJyZW50R2xvYmFsLl9fR0xPQkFMX0xPQURJTkdfUkVNT1RFX0VOVFJZX187XG5mdW5jdGlvbiBzZXRHbG9iYWxEZWZhdWx0VmFsKHRhcmdldCkge1xuICAgIHZhciBfdGFyZ2V0X19fRkVERVJBVElPTl9fLCBfdGFyZ2V0X19fRkVERVJBVElPTl9fMSwgX3RhcmdldF9fX0ZFREVSQVRJT05fXzIsIF90YXJnZXRfX19GRURFUkFUSU9OX18zLCBfdGFyZ2V0X19fRkVERVJBVElPTl9fNCwgX3RhcmdldF9fX0ZFREVSQVRJT05fXzU7XG4gICAgaWYgKGluY2x1ZGVPd25Qcm9wZXJ0eSh0YXJnZXQsICdfX1ZNT0tfXycpICYmICFpbmNsdWRlT3duUHJvcGVydHkodGFyZ2V0LCAnX19GRURFUkFUSU9OX18nKSkge1xuICAgICAgICBkZWZpbmVQcm9wZXJ0eUdsb2JhbFZhbCh0YXJnZXQsICdfX0ZFREVSQVRJT05fXycsIHRhcmdldC5fX1ZNT0tfXyk7XG4gICAgfVxuICAgIGlmICghaW5jbHVkZU93blByb3BlcnR5KHRhcmdldCwgJ19fRkVERVJBVElPTl9fJykpIHtcbiAgICAgICAgZGVmaW5lUHJvcGVydHlHbG9iYWxWYWwodGFyZ2V0LCAnX19GRURFUkFUSU9OX18nLCB7XG4gICAgICAgICAgICBfX0dMT0JBTF9QTFVHSU5fXzogW10sXG4gICAgICAgICAgICBfX0lOU1RBTkNFU19fOiBbXSxcbiAgICAgICAgICAgIG1vZHVsZUluZm86IHt9LFxuICAgICAgICAgICAgX19TSEFSRV9fOiB7fSxcbiAgICAgICAgICAgIF9fTUFOSUZFU1RfTE9BRElOR19fOiB7fSxcbiAgICAgICAgICAgIF9fUFJFTE9BREVEX01BUF9fOiBuZXcgTWFwKClcbiAgICAgICAgfSk7XG4gICAgICAgIGRlZmluZVByb3BlcnR5R2xvYmFsVmFsKHRhcmdldCwgJ19fVk1PS19fJywgdGFyZ2V0Ll9fRkVERVJBVElPTl9fKTtcbiAgICB9XG4gICAgdmFyIF9fX0dMT0JBTF9QTFVHSU5fXztcbiAgICAoX19fR0xPQkFMX1BMVUdJTl9fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX18gPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fR0xPQkFMX1BMVUdJTl9fKSAhPSBudWxsID8gX19fR0xPQkFMX1BMVUdJTl9fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXyA9IFtdO1xuICAgIHZhciBfX19JTlNUQU5DRVNfXztcbiAgICAoX19fSU5TVEFOQ0VTX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzEgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fSU5TVEFOQ0VTX18pICE9IG51bGwgPyBfX19JTlNUQU5DRVNfXyA6IF90YXJnZXRfX19GRURFUkFUSU9OX18xLl9fSU5TVEFOQ0VTX18gPSBbXTtcbiAgICB2YXIgX21vZHVsZUluZm87XG4gICAgKF9tb2R1bGVJbmZvID0gKF90YXJnZXRfX19GRURFUkFUSU9OX18yID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5tb2R1bGVJbmZvKSAhPSBudWxsID8gX21vZHVsZUluZm8gOiBfdGFyZ2V0X19fRkVERVJBVElPTl9fMi5tb2R1bGVJbmZvID0ge307XG4gICAgdmFyIF9fX1NIQVJFX187XG4gICAgKF9fX1NIQVJFX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzMgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fU0hBUkVfXykgIT0gbnVsbCA/IF9fX1NIQVJFX18gOiBfdGFyZ2V0X19fRkVERVJBVElPTl9fMy5fX1NIQVJFX18gPSB7fTtcbiAgICB2YXIgX19fTUFOSUZFU1RfTE9BRElOR19fO1xuICAgIChfX19NQU5JRkVTVF9MT0FESU5HX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzQgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fTUFOSUZFU1RfTE9BRElOR19fKSAhPSBudWxsID8gX19fTUFOSUZFU1RfTE9BRElOR19fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXzQuX19NQU5JRkVTVF9MT0FESU5HX18gPSB7fTtcbiAgICB2YXIgX19fUFJFTE9BREVEX01BUF9fO1xuICAgIChfX19QUkVMT0FERURfTUFQX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzUgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fUFJFTE9BREVEX01BUF9fKSAhPSBudWxsID8gX19fUFJFTE9BREVEX01BUF9fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXzUuX19QUkVMT0FERURfTUFQX18gPSBuZXcgTWFwKCk7XG59XG5zZXRHbG9iYWxEZWZhdWx0VmFsKEN1cnJlbnRHbG9iYWwpO1xuc2V0R2xvYmFsRGVmYXVsdFZhbChuYXRpdmVHbG9iYWwpO1xuZnVuY3Rpb24gcmVzZXRGZWRlcmF0aW9uR2xvYmFsSW5mbygpIHtcbiAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fR0xPQkFMX1BMVUdJTl9fID0gW107XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0lOU1RBTkNFU19fID0gW107XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvID0ge307XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1NIQVJFX18gPSB7fTtcbiAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fTUFOSUZFU1RfTE9BRElOR19fID0ge307XG4gICAgT2JqZWN0LmtleXMoZ2xvYmFsTG9hZGluZykuZm9yRWFjaCgoa2V5KT0+e1xuICAgICAgICBkZWxldGUgZ2xvYmFsTG9hZGluZ1trZXldO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlKEZlZGVyYXRpb25JbnN0YW5jZSkge1xuICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19JTlNUQU5DRVNfXy5wdXNoKEZlZGVyYXRpb25JbnN0YW5jZSk7XG59XG5mdW5jdGlvbiBnZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IoKSB7XG4gICAgcmV0dXJuIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19ERUJVR19DT05TVFJVQ1RPUl9fO1xufVxuZnVuY3Rpb24gc2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yKEZlZGVyYXRpb25Db25zdHJ1Y3RvciwgcmVmKSB7XG4gICAgdmFyIGlzRGVidWcgPSByZWYgPT09IHZvaWQgMCA/IHNkay5pc0RlYnVnTW9kZSgpIDogcmVmO1xuICAgIGlmIChpc0RlYnVnKSB7XG4gICAgICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19ERUJVR19DT05TVFJVQ1RPUl9fID0gRmVkZXJhdGlvbkNvbnN0cnVjdG9yO1xuICAgICAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fREVCVUdfQ09OU1RSVUNUT1JfVkVSU0lPTl9fID0gXCIwLjEwLjBcIjtcbiAgICB9XG59XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xuZnVuY3Rpb24gZ2V0SW5mb1dpdGhvdXRUeXBlKHRhcmdldCwga2V5KSB7XG4gICAgaWYgKHR5cGVvZiBrZXkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHZhciBrZXlSZXMgPSB0YXJnZXRba2V5XTtcbiAgICAgICAgaWYgKGtleVJlcykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGFyZ2V0W2tleV0sXG4gICAgICAgICAgICAgICAga2V5OiBrZXlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0S2V5cyA9IE9iamVjdC5rZXlzKHRhcmdldCk7XG4gICAgICAgICAgICBmb3IgKHZhciB0YXJnZXRLZXkgb2YgdGFyZ2V0S2V5cyl7XG4gICAgICAgICAgICAgICAgdmFyIF90YXJnZXRLZXlfc3BsaXQgPSBfc2xpY2VkX3RvX2FycmF5Ll8odGFyZ2V0S2V5LnNwbGl0KCc6JyksIDIpLCB0YXJnZXRUeXBlT3JOYW1lID0gX3RhcmdldEtleV9zcGxpdFswXSwgXyA9IF90YXJnZXRLZXlfc3BsaXRbMV07XG4gICAgICAgICAgICAgICAgdmFyIG5LZXkgPSBgJHt0YXJnZXRUeXBlT3JOYW1lfToke2tleX1gO1xuICAgICAgICAgICAgICAgIHZhciB0eXBlV2l0aEtleVJlcyA9IHRhcmdldFtuS2V5XTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZVdpdGhLZXlSZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0eXBlV2l0aEtleVJlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTogbktleVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBrZXk6IGtleVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigna2V5IG11c3QgYmUgc3RyaW5nJyk7XG4gICAgfVxufVxudmFyIGdldEdsb2JhbFNuYXBzaG90ID0gKCk9Pm5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvO1xudmFyIGdldFRhcmdldFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyA9IChtb2R1bGVJbmZvLCBzbmFwc2hvdCk9PntcbiAgICAvLyBDaGVjayBpZiB0aGUgcmVtb3RlIGlzIGluY2x1ZGVkIGluIHRoZSBob3N0U25hcHNob3RcbiAgICB2YXIgbW9kdWxlS2V5ID0gZ2V0Rk1JZChtb2R1bGVJbmZvKTtcbiAgICB2YXIgZ2V0TW9kdWxlSW5mbyA9IGdldEluZm9XaXRob3V0VHlwZShzbmFwc2hvdCwgbW9kdWxlS2V5KS52YWx1ZTtcbiAgICAvLyBUaGUgcmVtb3RlU25hcHNob3QgbWlnaHQgbm90IGluY2x1ZGUgYSB2ZXJzaW9uXG4gICAgaWYgKGdldE1vZHVsZUluZm8gJiYgIWdldE1vZHVsZUluZm8udmVyc2lvbiAmJiAndmVyc2lvbicgaW4gbW9kdWxlSW5mbyAmJiBtb2R1bGVJbmZvWyd2ZXJzaW9uJ10pIHtcbiAgICAgICAgZ2V0TW9kdWxlSW5mby52ZXJzaW9uID0gbW9kdWxlSW5mb1sndmVyc2lvbiddO1xuICAgIH1cbiAgICBpZiAoZ2V0TW9kdWxlSW5mbykge1xuICAgICAgICByZXR1cm4gZ2V0TW9kdWxlSW5mbztcbiAgICB9XG4gICAgLy8gSWYgdGhlIHJlbW90ZSBpcyBub3QgaW5jbHVkZWQgaW4gdGhlIGhvc3RTbmFwc2hvdCwgZGVwbG95IGEgbWljcm8gYXBwIHNuYXBzaG90XG4gICAgaWYgKCd2ZXJzaW9uJyBpbiBtb2R1bGVJbmZvICYmIG1vZHVsZUluZm9bJ3ZlcnNpb24nXSkge1xuICAgICAgICB2YXIgdmVyc2lvbiA9IG1vZHVsZUluZm8udmVyc2lvbiwgcmVzTW9kdWxlSW5mbyA9IHBvbHlmaWxscy5fb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllc19sb29zZShtb2R1bGVJbmZvLCBbXG4gICAgICAgICAgICBcInZlcnNpb25cIlxuICAgICAgICBdKTtcbiAgICAgICAgdmFyIG1vZHVsZUtleVdpdGhvdXRWZXJzaW9uID0gZ2V0Rk1JZChyZXNNb2R1bGVJbmZvKTtcbiAgICAgICAgdmFyIGdldE1vZHVsZUluZm9XaXRob3V0VmVyc2lvbiA9IGdldEluZm9XaXRob3V0VHlwZShuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbywgbW9kdWxlS2V5V2l0aG91dFZlcnNpb24pLnZhbHVlO1xuICAgICAgICBpZiAoKGdldE1vZHVsZUluZm9XaXRob3V0VmVyc2lvbiA9PSBudWxsID8gdm9pZCAwIDogZ2V0TW9kdWxlSW5mb1dpdGhvdXRWZXJzaW9uLnZlcnNpb24pID09PSB2ZXJzaW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0TW9kdWxlSW5mb1dpdGhvdXRWZXJzaW9uO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybjtcbn07XG52YXIgZ2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvID0gKG1vZHVsZUluZm8pPT5nZXRUYXJnZXRTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8obW9kdWxlSW5mbywgbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm8pO1xudmFyIHNldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyA9IChyZW1vdGVJbmZvLCBtb2R1bGVEZXRhaWxJbmZvKT0+e1xuICAgIHZhciBtb2R1bGVLZXkgPSBnZXRGTUlkKHJlbW90ZUluZm8pO1xuICAgIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvW21vZHVsZUtleV0gPSBtb2R1bGVEZXRhaWxJbmZvO1xuICAgIHJldHVybiBuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbztcbn07XG52YXIgYWRkR2xvYmFsU25hcHNob3QgPSAobW9kdWxlSW5mb3MpPT57XG4gICAgbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm8gPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvLCBtb2R1bGVJbmZvcyk7XG4gICAgcmV0dXJuICgpPT57XG4gICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMobW9kdWxlSW5mb3MpO1xuICAgICAgICBmb3IgKHZhciBrZXkgb2Yga2V5cyl7XG4gICAgICAgICAgICBkZWxldGUgbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm9ba2V5XTtcbiAgICAgICAgfVxuICAgIH07XG59O1xudmFyIGdldFJlbW90ZUVudHJ5RXhwb3J0cyA9IChuYW1lMSwgZ2xvYmFsTmFtZSk9PntcbiAgICB2YXIgcmVtb3RlRW50cnlLZXkgPSBnbG9iYWxOYW1lIHx8IGBfX0ZFREVSQVRJT05fJHtuYW1lMX06Y3VzdG9tX19gO1xuICAgIHZhciBlbnRyeUV4cG9ydHMgPSBDdXJyZW50R2xvYmFsW3JlbW90ZUVudHJ5S2V5XTtcbiAgICByZXR1cm4ge1xuICAgICAgICByZW1vdGVFbnRyeUtleSxcbiAgICAgICAgZW50cnlFeHBvcnRzXG4gICAgfTtcbn07XG4vLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVnaXN0ZXIgZ2xvYmFsIHBsdWdpbnMuXG4vLyBJdCBpdGVyYXRlcyBvdmVyIHRoZSBwcm92aWRlZCBwbHVnaW5zIGFuZCBjaGVja3MgaWYgdGhleSBhcmUgYWxyZWFkeSByZWdpc3RlcmVkLlxuLy8gSWYgYSBwbHVnaW4gaXMgbm90IHJlZ2lzdGVyZWQsIGl0IGlzIGFkZGVkIHRvIHRoZSBnbG9iYWwgcGx1Z2lucy5cbi8vIElmIGEgcGx1Z2luIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCwgYSB3YXJuaW5nIG1lc3NhZ2UgaXMgbG9nZ2VkLlxudmFyIHJlZ2lzdGVyR2xvYmFsUGx1Z2lucyA9IChwbHVnaW5zKT0+e1xuICAgIHZhciBfX0dMT0JBTF9QTFVHSU5fXyA9IG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXztcbiAgICBwbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgaWYgKF9fR0xPQkFMX1BMVUdJTl9fLmZpbmRJbmRleCgocCk9PnAubmFtZSA9PT0gcGx1Z2luLm5hbWUpID09PSAtMSkge1xuICAgICAgICAgICAgX19HTE9CQUxfUExVR0lOX18ucHVzaChwbHVnaW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgd2FybihgVGhlIHBsdWdpbiAke3BsdWdpbi5uYW1lfSBoYXMgYmVlbiByZWdpc3RlcmVkLmApO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xudmFyIGdldEdsb2JhbEhvc3RQbHVnaW5zID0gKCk9Pm5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXztcbnZhciBnZXRQcmVsb2FkZWQgPSAoaWQpPT5DdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fUFJFTE9BREVEX01BUF9fLmdldChpZCk7XG52YXIgc2V0UHJlbG9hZGVkID0gKGlkKT0+Q3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1BSRUxPQURFRF9NQVBfXy5zZXQoaWQsIHRydWUpO1xudmFyIERFRkFVTFRfU0NPUEUgPSAnZGVmYXVsdCc7XG52YXIgREVGQVVMVF9SRU1PVEVfVFlQRSA9ICdnbG9iYWwnO1xuLy8gZm9yayBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9vcmlnaW5qcy92aXRlLXBsdWdpbi1mZWRlcmF0aW9uL2Jsb2IvdjEuMS4xMi9wYWNrYWdlcy9saWIvc3JjL3V0aWxzL3NlbXZlci9pbmRleC50c1xuLy8gdGhvc2UgY29uc3RhbnRzIGFyZSBiYXNlZCBvbiBodHRwczovL3d3dy5ydWJ5ZG9jLmluZm8vZ2Vtcy9zZW1hbnRpY19yYW5nZS8zLjAuMC9TZW1hbnRpY1JhbmdlI0JVSUxESURFTlRJRklFUi1jb25zdGFudFxuLy8gQ29weXJpZ2h0IChjKVxuLy8gdml0ZS1wbHVnaW4tZmVkZXJhdGlvbiBpcyBsaWNlbnNlZCB1bmRlciBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgY2FuIHVzZSB0aGlzIHNvZnR3YXJlIGFjY29yZGluZyB0byB0aGUgdGVybXMgYW5kIGNvbmRpdGlvbnMgb2YgdGhlIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiBNdWxhbiBQU0wgdjIgYXQ6XG4vLyAgICAgIGh0dHA6Ly9saWNlbnNlLmNvc2NsLm9yZy5jbi9NdWxhblBTTDJcbi8vIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgT04gQU4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT0YgQU5ZIEtJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gTk9OLUlORlJJTkdFTUVOVCwgTUVSQ0hBTlRBQklMSVRZIE9SIEZJVCBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuXG4vLyBTZWUgdGhlIE11bGFuIFBTTCB2MiBmb3IgbW9yZSBkZXRhaWxzLlxudmFyIGJ1aWxkSWRlbnRpZmllciA9ICdbMC05QS1aYS16LV0rJztcbnZhciBidWlsZCA9IGAoPzpcXFxcKygke2J1aWxkSWRlbnRpZmllcn0oPzpcXFxcLiR7YnVpbGRJZGVudGlmaWVyfSkqKSlgO1xudmFyIG51bWVyaWNJZGVudGlmaWVyID0gJzB8WzEtOV1cXFxcZConO1xudmFyIG51bWVyaWNJZGVudGlmaWVyTG9vc2UgPSAnWzAtOV0rJztcbnZhciBub25OdW1lcmljSWRlbnRpZmllciA9ICdcXFxcZCpbYS16QS1aLV1bYS16QS1aMC05LV0qJztcbnZhciBwcmVSZWxlYXNlSWRlbnRpZmllckxvb3NlID0gYCg/OiR7bnVtZXJpY0lkZW50aWZpZXJMb29zZX18JHtub25OdW1lcmljSWRlbnRpZmllcn0pYDtcbnZhciBwcmVSZWxlYXNlTG9vc2UgPSBgKD86LT8oJHtwcmVSZWxlYXNlSWRlbnRpZmllckxvb3NlfSg/OlxcXFwuJHtwcmVSZWxlYXNlSWRlbnRpZmllckxvb3NlfSkqKSlgO1xudmFyIHByZVJlbGVhc2VJZGVudGlmaWVyID0gYCg/OiR7bnVtZXJpY0lkZW50aWZpZXJ9fCR7bm9uTnVtZXJpY0lkZW50aWZpZXJ9KWA7XG52YXIgcHJlUmVsZWFzZSA9IGAoPzotKCR7cHJlUmVsZWFzZUlkZW50aWZpZXJ9KD86XFxcXC4ke3ByZVJlbGVhc2VJZGVudGlmaWVyfSkqKSlgO1xudmFyIHhSYW5nZUlkZW50aWZpZXIgPSBgJHtudW1lcmljSWRlbnRpZmllcn18eHxYfFxcXFwqYDtcbnZhciB4UmFuZ2VQbGFpbiA9IGBbdj1cXFxcc10qKCR7eFJhbmdlSWRlbnRpZmllcn0pKD86XFxcXC4oJHt4UmFuZ2VJZGVudGlmaWVyfSkoPzpcXFxcLigke3hSYW5nZUlkZW50aWZpZXJ9KSg/OiR7cHJlUmVsZWFzZX0pPyR7YnVpbGR9Pyk/KT9gO1xudmFyIGh5cGhlblJhbmdlID0gYF5cXFxccyooJHt4UmFuZ2VQbGFpbn0pXFxcXHMrLVxcXFxzKygke3hSYW5nZVBsYWlufSlcXFxccyokYDtcbnZhciBtYWluVmVyc2lvbkxvb3NlID0gYCgke251bWVyaWNJZGVudGlmaWVyTG9vc2V9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJMb29zZX0pXFxcXC4oJHtudW1lcmljSWRlbnRpZmllckxvb3NlfSlgO1xudmFyIGxvb3NlUGxhaW4gPSBgW3Y9XFxcXHNdKiR7bWFpblZlcnNpb25Mb29zZX0ke3ByZVJlbGVhc2VMb29zZX0/JHtidWlsZH0/YDtcbnZhciBndGx0ID0gJygoPzo8fD4pPz0/KSc7XG52YXIgY29tcGFyYXRvclRyaW0gPSBgKFxcXFxzKikke2d0bHR9XFxcXHMqKCR7bG9vc2VQbGFpbn18JHt4UmFuZ2VQbGFpbn0pYDtcbnZhciBsb25lVGlsZGUgPSAnKD86fj4/KSc7XG52YXIgdGlsZGVUcmltID0gYChcXFxccyopJHtsb25lVGlsZGV9XFxcXHMrYDtcbnZhciBsb25lQ2FyZXQgPSAnKD86XFxcXF4pJztcbnZhciBjYXJldFRyaW0gPSBgKFxcXFxzKikke2xvbmVDYXJldH1cXFxccytgO1xudmFyIHN0YXIgPSAnKDx8Pik/PT9cXFxccypcXFxcKic7XG52YXIgY2FyZXQgPSBgXiR7bG9uZUNhcmV0fSR7eFJhbmdlUGxhaW59JGA7XG52YXIgbWFpblZlcnNpb24gPSBgKCR7bnVtZXJpY0lkZW50aWZpZXJ9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJ9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJ9KWA7XG52YXIgZnVsbFBsYWluID0gYHY/JHttYWluVmVyc2lvbn0ke3ByZVJlbGVhc2V9PyR7YnVpbGR9P2A7XG52YXIgdGlsZGUgPSBgXiR7bG9uZVRpbGRlfSR7eFJhbmdlUGxhaW59JGA7XG52YXIgeFJhbmdlID0gYF4ke2d0bHR9XFxcXHMqJHt4UmFuZ2VQbGFpbn0kYDtcbnZhciBjb21wYXJhdG9yID0gYF4ke2d0bHR9XFxcXHMqKCR7ZnVsbFBsYWlufSkkfF4kYDtcbi8vIGNvcHkgZnJvbSBzZW12ZXIgcGFja2FnZVxudmFyIGd0ZTAgPSAnXlxcXFxzKj49XFxcXHMqMC4wLjBcXFxccyokJztcbi8vIGZvcmsgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vb3JpZ2luanMvdml0ZS1wbHVnaW4tZmVkZXJhdGlvbi9ibG9iL3YxLjEuMTIvcGFja2FnZXMvbGliL3NyYy91dGlscy9zZW12ZXIvaW5kZXgudHNcbi8vIENvcHlyaWdodCAoYylcbi8vIHZpdGUtcGx1Z2luLWZlZGVyYXRpb24gaXMgbGljZW5zZWQgdW5kZXIgTXVsYW4gUFNMIHYyLlxuLy8gWW91IGNhbiB1c2UgdGhpcyBzb2Z0d2FyZSBhY2NvcmRpbmcgdG8gdGhlIHRlcm1zIGFuZCBjb25kaXRpb25zIG9mIHRoZSBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgTXVsYW4gUFNMIHYyIGF0OlxuLy8gICAgICBodHRwOi8vbGljZW5zZS5jb3NjbC5vcmcuY24vTXVsYW5QU0wyXG4vLyBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIE9OIEFOIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9GIEFOWSBLSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIE5PTi1JTkZSSU5HRU1FTlQsIE1FUkNIQU5UQUJJTElUWSBPUiBGSVQgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLlxuLy8gU2VlIHRoZSBNdWxhbiBQU0wgdjIgZm9yIG1vcmUgZGV0YWlscy5cbmZ1bmN0aW9uIHBhcnNlUmVnZXgoc291cmNlKSB7XG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoc291cmNlKTtcbn1cbmZ1bmN0aW9uIGlzWFZlcnNpb24odmVyc2lvbikge1xuICAgIHJldHVybiAhdmVyc2lvbiB8fCB2ZXJzaW9uLnRvTG93ZXJDYXNlKCkgPT09ICd4JyB8fCB2ZXJzaW9uID09PSAnKic7XG59XG5mdW5jdGlvbiBwaXBlKC4uLmZucykge1xuICAgIHJldHVybiAoeCk9PmZucy5yZWR1Y2UoKHYsIGYpPT5mKHYpLCB4KTtcbn1cbmZ1bmN0aW9uIGV4dHJhY3RDb21wYXJhdG9yKGNvbXBhcmF0b3JTdHJpbmcpIHtcbiAgICByZXR1cm4gY29tcGFyYXRvclN0cmluZy5tYXRjaChwYXJzZVJlZ2V4KGNvbXBhcmF0b3IpKTtcbn1cbmZ1bmN0aW9uIGNvbWJpbmVWZXJzaW9uKG1ham9yLCBtaW5vciwgcGF0Y2gsIHByZVJlbGVhc2UpIHtcbiAgICB2YXIgbWFpblZlcnNpb24gPSBgJHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH1gO1xuICAgIGlmIChwcmVSZWxlYXNlKSB7XG4gICAgICAgIHJldHVybiBgJHttYWluVmVyc2lvbn0tJHtwcmVSZWxlYXNlfWA7XG4gICAgfVxuICAgIHJldHVybiBtYWluVmVyc2lvbjtcbn1cbi8vIGZvcmsgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vb3JpZ2luanMvdml0ZS1wbHVnaW4tZmVkZXJhdGlvbi9ibG9iL3YxLjEuMTIvcGFja2FnZXMvbGliL3NyYy91dGlscy9zZW12ZXIvaW5kZXgudHNcbi8vIENvcHlyaWdodCAoYylcbi8vIHZpdGUtcGx1Z2luLWZlZGVyYXRpb24gaXMgbGljZW5zZWQgdW5kZXIgTXVsYW4gUFNMIHYyLlxuLy8gWW91IGNhbiB1c2UgdGhpcyBzb2Z0d2FyZSBhY2NvcmRpbmcgdG8gdGhlIHRlcm1zIGFuZCBjb25kaXRpb25zIG9mIHRoZSBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgTXVsYW4gUFNMIHYyIGF0OlxuLy8gICAgICBodHRwOi8vbGljZW5zZS5jb3NjbC5vcmcuY24vTXVsYW5QU0wyXG4vLyBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIE9OIEFOIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9GIEFOWSBLSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIE5PTi1JTkZSSU5HRU1FTlQsIE1FUkNIQU5UQUJJTElUWSBPUiBGSVQgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLlxuLy8gU2VlIHRoZSBNdWxhbiBQU0wgdjIgZm9yIG1vcmUgZGV0YWlscy5cbmZ1bmN0aW9uIHBhcnNlSHlwaGVuKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnJlcGxhY2UocGFyc2VSZWdleChoeXBoZW5SYW5nZSksIChfcmFuZ2UsIGZyb20sIGZyb21NYWpvciwgZnJvbU1pbm9yLCBmcm9tUGF0Y2gsIF9mcm9tUHJlUmVsZWFzZSwgX2Zyb21CdWlsZCwgdG8sIHRvTWFqb3IsIHRvTWlub3IsIHRvUGF0Y2gsIHRvUHJlUmVsZWFzZSk9PntcbiAgICAgICAgaWYgKGlzWFZlcnNpb24oZnJvbU1ham9yKSkge1xuICAgICAgICAgICAgZnJvbSA9ICcnO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24oZnJvbU1pbm9yKSkge1xuICAgICAgICAgICAgZnJvbSA9IGA+PSR7ZnJvbU1ham9yfS4wLjBgO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24oZnJvbVBhdGNoKSkge1xuICAgICAgICAgICAgZnJvbSA9IGA+PSR7ZnJvbU1ham9yfS4ke2Zyb21NaW5vcn0uMGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmcm9tID0gYD49JHtmcm9tfWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzWFZlcnNpb24odG9NYWpvcikpIHtcbiAgICAgICAgICAgIHRvID0gJyc7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbih0b01pbm9yKSkge1xuICAgICAgICAgICAgdG8gPSBgPCR7TnVtYmVyKHRvTWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24odG9QYXRjaCkpIHtcbiAgICAgICAgICAgIHRvID0gYDwke3RvTWFqb3J9LiR7TnVtYmVyKHRvTWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgfSBlbHNlIGlmICh0b1ByZVJlbGVhc2UpIHtcbiAgICAgICAgICAgIHRvID0gYDw9JHt0b01ham9yfS4ke3RvTWlub3J9LiR7dG9QYXRjaH0tJHt0b1ByZVJlbGVhc2V9YDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRvID0gYDw9JHt0b31gO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgJHtmcm9tfSAke3RvfWAudHJpbSgpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VDb21wYXJhdG9yVHJpbShyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS5yZXBsYWNlKHBhcnNlUmVnZXgoY29tcGFyYXRvclRyaW0pLCAnJDEkMiQzJyk7XG59XG5mdW5jdGlvbiBwYXJzZVRpbGRlVHJpbShyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS5yZXBsYWNlKHBhcnNlUmVnZXgodGlsZGVUcmltKSwgJyQxficpO1xufVxuZnVuY3Rpb24gcGFyc2VDYXJldFRyaW0ocmFuZ2UpIHtcbiAgICByZXR1cm4gcmFuZ2UucmVwbGFjZShwYXJzZVJlZ2V4KGNhcmV0VHJpbSksICckMV4nKTtcbn1cbmZ1bmN0aW9uIHBhcnNlQ2FyZXRzKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnRyaW0oKS5zcGxpdCgvXFxzKy8pLm1hcCgocmFuZ2VWZXJzaW9uKT0+cmFuZ2VWZXJzaW9uLnJlcGxhY2UocGFyc2VSZWdleChjYXJldCksIChfLCBtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKT0+e1xuICAgICAgICAgICAgaWYgKGlzWFZlcnNpb24obWFqb3IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKG1pbm9yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4wLjAgPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbihwYXRjaCkpIHtcbiAgICAgICAgICAgICAgICBpZiAobWFqb3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCA8JHtOdW1iZXIobWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlUmVsZWFzZSkge1xuICAgICAgICAgICAgICAgIGlmIChtYWpvciA9PT0gJzAnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtaW5vciA9PT0gJzAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0tJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHttaW5vcn0uJHtOdW1iZXIocGF0Y2gpICsgMX0tMGA7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0tJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofS0ke3ByZVJlbGVhc2V9IDwke051bWJlcihtYWpvcikgKyAxfS4wLjAtMGA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAobWFqb3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWlub3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9IDwke21ham9yfS4ke21pbm9yfS4ke051bWJlcihwYXRjaCkgKyAxfS0wYDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0gPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLmpvaW4oJyAnKTtcbn1cbmZ1bmN0aW9uIHBhcnNlVGlsZGVzKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnRyaW0oKS5zcGxpdCgvXFxzKy8pLm1hcCgocmFuZ2VWZXJzaW9uKT0+cmFuZ2VWZXJzaW9uLnJlcGxhY2UocGFyc2VSZWdleCh0aWxkZSksIChfLCBtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKT0+e1xuICAgICAgICAgICAgaWYgKGlzWFZlcnNpb24obWFqb3IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKG1pbm9yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4wLjAgPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbihwYXRjaCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlUmVsZWFzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofS0ke3ByZVJlbGVhc2V9IDwke21ham9yfS4ke051bWJlcihtaW5vcikgKyAxfS4wLTBgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9IDwke21ham9yfS4ke051bWJlcihtaW5vcikgKyAxfS4wLTBgO1xuICAgICAgICB9KSkuam9pbignICcpO1xufVxuZnVuY3Rpb24gcGFyc2VYUmFuZ2VzKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnNwbGl0KC9cXHMrLykubWFwKChyYW5nZVZlcnNpb24pPT5yYW5nZVZlcnNpb24udHJpbSgpLnJlcGxhY2UocGFyc2VSZWdleCh4UmFuZ2UpLCAocmV0LCBndGx0LCBtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKT0+e1xuICAgICAgICAgICAgdmFyIGlzWE1ham9yID0gaXNYVmVyc2lvbihtYWpvcik7XG4gICAgICAgICAgICB2YXIgaXNYTWlub3IgPSBpc1hNYWpvciB8fCBpc1hWZXJzaW9uKG1pbm9yKTtcbiAgICAgICAgICAgIHZhciBpc1hQYXRjaCA9IGlzWE1pbm9yIHx8IGlzWFZlcnNpb24ocGF0Y2gpO1xuICAgICAgICAgICAgaWYgKGd0bHQgPT09ICc9JyAmJiBpc1hQYXRjaCkge1xuICAgICAgICAgICAgICAgIGd0bHQgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByZVJlbGVhc2UgPSAnJztcbiAgICAgICAgICAgIGlmIChpc1hNYWpvcikge1xuICAgICAgICAgICAgICAgIGlmIChndGx0ID09PSAnPicgfHwgZ3RsdCA9PT0gJzwnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdGhpbmcgaXMgYWxsb3dlZFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzwwLjAuMC0wJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBub3RoaW5nIGlzIGZvcmJpZGRlblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyonO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3RsdCAmJiBpc1hQYXRjaCkge1xuICAgICAgICAgICAgICAgIC8vIHJlcGxhY2UgWCB3aXRoIDBcbiAgICAgICAgICAgICAgICBpZiAoaXNYTWlub3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbWlub3IgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwYXRjaCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKGd0bHQgPT09ICc+Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyA+MSA9PiA+PTIuMC4wXG4gICAgICAgICAgICAgICAgICAgIC8vID4xLjIgPT4gPj0xLjMuMFxuICAgICAgICAgICAgICAgICAgICBndGx0ID0gJz49JztcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzWE1pbm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWpvciA9IE51bWJlcihtYWpvcikgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWlub3IgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0Y2ggPSAwO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWlub3IgPSBOdW1iZXIobWlub3IpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3RsdCA9PT0gJzw9Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyA8PTAuNy54IGlzIGFjdHVhbGx5IDwwLjguMCwgc2luY2UgYW55IDAuNy54IHNob3VsZCBwYXNzXG4gICAgICAgICAgICAgICAgICAgIC8vIFNpbWlsYXJseSwgPD03LnggaXMgYWN0dWFsbHkgPDguMC4wLCBldGMuXG4gICAgICAgICAgICAgICAgICAgIGd0bHQgPSAnPCc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1hNaW5vcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFqb3IgPSBOdW1iZXIobWFqb3IpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbm9yID0gTnVtYmVyKG1pbm9yKSArIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGd0bHQgPT09ICc8Jykge1xuICAgICAgICAgICAgICAgICAgICBwcmVSZWxlYXNlID0gJy0wJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke2d0bHQgKyBtYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0ke3ByZVJlbGVhc2V9YDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYTWlub3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uMC4wJHtwcmVSZWxlYXNlfSA8JHtOdW1iZXIobWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1hQYXRjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4wJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH0pKS5qb2luKCcgJyk7XG59XG5mdW5jdGlvbiBwYXJzZVN0YXIocmFuZ2UpIHtcbiAgICByZXR1cm4gcmFuZ2UudHJpbSgpLnJlcGxhY2UocGFyc2VSZWdleChzdGFyKSwgJycpO1xufVxuZnVuY3Rpb24gcGFyc2VHVEUwKGNvbXBhcmF0b3JTdHJpbmcpIHtcbiAgICByZXR1cm4gY29tcGFyYXRvclN0cmluZy50cmltKCkucmVwbGFjZShwYXJzZVJlZ2V4KGd0ZTApLCAnJyk7XG59XG4vLyBmb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL29yaWdpbmpzL3ZpdGUtcGx1Z2luLWZlZGVyYXRpb24vYmxvYi92MS4xLjEyL3BhY2thZ2VzL2xpYi9zcmMvdXRpbHMvc2VtdmVyL2luZGV4LnRzXG4vLyBDb3B5cmlnaHQgKGMpXG4vLyB2aXRlLXBsdWdpbi1mZWRlcmF0aW9uIGlzIGxpY2Vuc2VkIHVuZGVyIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBjYW4gdXNlIHRoaXMgc29mdHdhcmUgYWNjb3JkaW5nIHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgTXVsYW4gUFNMIHYyLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIE11bGFuIFBTTCB2MiBhdDpcbi8vICAgICAgaHR0cDovL2xpY2Vuc2UuY29zY2wub3JnLmNuL011bGFuUFNMMlxuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBOT04tSU5GUklOR0VNRU5ULCBNRVJDSEFOVEFCSUxJVFkgT1IgRklUIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cbi8vIFNlZSB0aGUgTXVsYW4gUFNMIHYyIGZvciBtb3JlIGRldGFpbHMuXG5mdW5jdGlvbiBjb21wYXJlQXRvbShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB7XG4gICAgcmFuZ2VBdG9tID0gTnVtYmVyKHJhbmdlQXRvbSkgfHwgcmFuZ2VBdG9tO1xuICAgIHZlcnNpb25BdG9tID0gTnVtYmVyKHZlcnNpb25BdG9tKSB8fCB2ZXJzaW9uQXRvbTtcbiAgICBpZiAocmFuZ2VBdG9tID4gdmVyc2lvbkF0b20pIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGlmIChyYW5nZUF0b20gPT09IHZlcnNpb25BdG9tKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gLTE7XG59XG5mdW5jdGlvbiBjb21wYXJlUHJlUmVsZWFzZShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB7XG4gICAgdmFyIHJhbmdlUHJlUmVsZWFzZSA9IHJhbmdlQXRvbS5wcmVSZWxlYXNlO1xuICAgIHZhciB2ZXJzaW9uUHJlUmVsZWFzZSA9IHZlcnNpb25BdG9tLnByZVJlbGVhc2U7XG4gICAgaWYgKHJhbmdlUHJlUmVsZWFzZSA9PT0gdW5kZWZpbmVkICYmIEJvb2xlYW4odmVyc2lvblByZVJlbGVhc2UpKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBpZiAoQm9vbGVhbihyYW5nZVByZVJlbGVhc2UpICYmIHZlcnNpb25QcmVSZWxlYXNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpZiAocmFuZ2VQcmVSZWxlYXNlID09PSB1bmRlZmluZWQgJiYgdmVyc2lvblByZVJlbGVhc2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgZm9yKHZhciBpID0gMCwgbiA9IHJhbmdlUHJlUmVsZWFzZS5sZW5ndGg7IGkgPD0gbjsgaSsrKXtcbiAgICAgICAgdmFyIHJhbmdlRWxlbWVudCA9IHJhbmdlUHJlUmVsZWFzZVtpXTtcbiAgICAgICAgdmFyIHZlcnNpb25FbGVtZW50ID0gdmVyc2lvblByZVJlbGVhc2VbaV07XG4gICAgICAgIGlmIChyYW5nZUVsZW1lbnQgPT09IHZlcnNpb25FbGVtZW50KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmFuZ2VFbGVtZW50ID09PSB1bmRlZmluZWQgJiYgdmVyc2lvbkVsZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyYW5nZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmVyc2lvbkVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29tcGFyZUF0b20ocmFuZ2VFbGVtZW50LCB2ZXJzaW9uRWxlbWVudCk7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuZnVuY3Rpb24gY29tcGFyZVZlcnNpb24ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkge1xuICAgIHJldHVybiBjb21wYXJlQXRvbShyYW5nZUF0b20ubWFqb3IsIHZlcnNpb25BdG9tLm1ham9yKSB8fCBjb21wYXJlQXRvbShyYW5nZUF0b20ubWlub3IsIHZlcnNpb25BdG9tLm1pbm9yKSB8fCBjb21wYXJlQXRvbShyYW5nZUF0b20ucGF0Y2gsIHZlcnNpb25BdG9tLnBhdGNoKSB8fCBjb21wYXJlUHJlUmVsZWFzZShyYW5nZUF0b20sIHZlcnNpb25BdG9tKTtcbn1cbmZ1bmN0aW9uIGVxKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHtcbiAgICByZXR1cm4gcmFuZ2VBdG9tLnZlcnNpb24gPT09IHZlcnNpb25BdG9tLnZlcnNpb247XG59XG5mdW5jdGlvbiBjb21wYXJlKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHtcbiAgICBzd2l0Y2gocmFuZ2VBdG9tLm9wZXJhdG9yKXtcbiAgICAgICAgY2FzZSAnJzpcbiAgICAgICAgY2FzZSAnPSc6XG4gICAgICAgICAgICByZXR1cm4gZXEocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSk7XG4gICAgICAgIGNhc2UgJz4nOlxuICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIDwgMDtcbiAgICAgICAgY2FzZSAnPj0nOlxuICAgICAgICAgICAgcmV0dXJuIGVxKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHx8IGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIDwgMDtcbiAgICAgICAgY2FzZSAnPCc6XG4gICAgICAgICAgICByZXR1cm4gY29tcGFyZVZlcnNpb24ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkgPiAwO1xuICAgICAgICBjYXNlICc8PSc6XG4gICAgICAgICAgICByZXR1cm4gZXEocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkgfHwgY29tcGFyZVZlcnNpb24ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkgPiAwO1xuICAgICAgICBjYXNlIHVuZGVmaW5lZDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBtZWFuICogb3IgeCAtPiBhbGwgdmVyc2lvbnNcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG4vLyBmb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL29yaWdpbmpzL3ZpdGUtcGx1Z2luLWZlZGVyYXRpb24vYmxvYi92MS4xLjEyL3BhY2thZ2VzL2xpYi9zcmMvdXRpbHMvc2VtdmVyL2luZGV4LnRzXG4vLyBDb3B5cmlnaHQgKGMpXG4vLyB2aXRlLXBsdWdpbi1mZWRlcmF0aW9uIGlzIGxpY2Vuc2VkIHVuZGVyIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBjYW4gdXNlIHRoaXMgc29mdHdhcmUgYWNjb3JkaW5nIHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgTXVsYW4gUFNMIHYyLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIE11bGFuIFBTTCB2MiBhdDpcbi8vICAgICAgaHR0cDovL2xpY2Vuc2UuY29zY2wub3JnLmNuL011bGFuUFNMMlxuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBOT04tSU5GUklOR0VNRU5ULCBNRVJDSEFOVEFCSUxJVFkgT1IgRklUIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cbi8vIFNlZSB0aGUgTXVsYW4gUFNMIHYyIGZvciBtb3JlIGRldGFpbHMuXG5mdW5jdGlvbiBwYXJzZUNvbXBhcmF0b3JTdHJpbmcocmFuZ2UpIHtcbiAgICByZXR1cm4gcGlwZSgvLyBeIC0tPiAqIChhbnksIGtpbmRhIHNpbGx5KVxuICAgIC8vIF4yLCBeMi54LCBeMi54LnggLS0+ID49Mi4wLjAgPDMuMC4wLTBcbiAgICAvLyBeMi4wLCBeMi4wLnggLS0+ID49Mi4wLjAgPDMuMC4wLTBcbiAgICAvLyBeMS4yLCBeMS4yLnggLS0+ID49MS4yLjAgPDIuMC4wLTBcbiAgICAvLyBeMS4yLjMgLS0+ID49MS4yLjMgPDIuMC4wLTBcbiAgICAvLyBeMS4yLjAgLS0+ID49MS4yLjAgPDIuMC4wLTBcbiAgICBwYXJzZUNhcmV0cywgLy8gfiwgfj4gLS0+ICogKGFueSwga2luZGEgc2lsbHkpXG4gICAgLy8gfjIsIH4yLngsIH4yLngueCwgfj4yLCB+PjIueCB+PjIueC54IC0tPiA+PTIuMC4wIDwzLjAuMC0wXG4gICAgLy8gfjIuMCwgfjIuMC54LCB+PjIuMCwgfj4yLjAueCAtLT4gPj0yLjAuMCA8Mi4xLjAtMFxuICAgIC8vIH4xLjIsIH4xLjIueCwgfj4xLjIsIH4+MS4yLnggLS0+ID49MS4yLjAgPDEuMy4wLTBcbiAgICAvLyB+MS4yLjMsIH4+MS4yLjMgLS0+ID49MS4yLjMgPDEuMy4wLTBcbiAgICAvLyB+MS4yLjAsIH4+MS4yLjAgLS0+ID49MS4yLjAgPDEuMy4wLTBcbiAgICBwYXJzZVRpbGRlcywgcGFyc2VYUmFuZ2VzLCBwYXJzZVN0YXIpKHJhbmdlKTtcbn1cbmZ1bmN0aW9uIHBhcnNlUmFuZ2UocmFuZ2UpIHtcbiAgICByZXR1cm4gcGlwZSgvLyBgMS4yLjMgLSAxLjIuNGAgPT4gYD49MS4yLjMgPD0xLjIuNGBcbiAgICBwYXJzZUh5cGhlbiwgLy8gYD4gMS4yLjMgPCAxLjIuNWAgPT4gYD4xLjIuMyA8MS4yLjVgXG4gICAgcGFyc2VDb21wYXJhdG9yVHJpbSwgLy8gYH4gMS4yLjNgID0+IGB+MS4yLjNgXG4gICAgcGFyc2VUaWxkZVRyaW0sIC8vIGBeIDEuMi4zYCA9PiBgXjEuMi4zYFxuICAgIHBhcnNlQ2FyZXRUcmltKShyYW5nZS50cmltKCkpLnNwbGl0KC9cXHMrLykuam9pbignICcpO1xufVxuZnVuY3Rpb24gc2F0aXNmeSh2ZXJzaW9uLCByYW5nZSkge1xuICAgIGlmICghdmVyc2lvbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBwYXJzZWRSYW5nZSA9IHBhcnNlUmFuZ2UocmFuZ2UpO1xuICAgIHZhciBwYXJzZWRDb21wYXJhdG9yID0gcGFyc2VkUmFuZ2Uuc3BsaXQoJyAnKS5tYXAoKHJhbmdlVmVyc2lvbik9PnBhcnNlQ29tcGFyYXRvclN0cmluZyhyYW5nZVZlcnNpb24pKS5qb2luKCcgJyk7XG4gICAgdmFyIGNvbXBhcmF0b3JzID0gcGFyc2VkQ29tcGFyYXRvci5zcGxpdCgvXFxzKy8pLm1hcCgoY29tcGFyYXRvcik9PnBhcnNlR1RFMChjb21wYXJhdG9yKSk7XG4gICAgdmFyIGV4dHJhY3RlZFZlcnNpb24gPSBleHRyYWN0Q29tcGFyYXRvcih2ZXJzaW9uKTtcbiAgICBpZiAoIWV4dHJhY3RlZFZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgX2V4dHJhY3RlZFZlcnNpb24gPSBfc2xpY2VkX3RvX2FycmF5Ll8oZXh0cmFjdGVkVmVyc2lvbiwgNyksIHZlcnNpb25PcGVyYXRvciA9IF9leHRyYWN0ZWRWZXJzaW9uWzFdLCB2ZXJzaW9uTWFqb3IgPSBfZXh0cmFjdGVkVmVyc2lvblszXSwgdmVyc2lvbk1pbm9yID0gX2V4dHJhY3RlZFZlcnNpb25bNF0sIHZlcnNpb25QYXRjaCA9IF9leHRyYWN0ZWRWZXJzaW9uWzVdLCB2ZXJzaW9uUHJlUmVsZWFzZSA9IF9leHRyYWN0ZWRWZXJzaW9uWzZdO1xuICAgIHZhciB2ZXJzaW9uQXRvbSA9IHtcbiAgICAgICAgb3BlcmF0b3I6IHZlcnNpb25PcGVyYXRvcixcbiAgICAgICAgdmVyc2lvbjogY29tYmluZVZlcnNpb24odmVyc2lvbk1ham9yLCB2ZXJzaW9uTWlub3IsIHZlcnNpb25QYXRjaCwgdmVyc2lvblByZVJlbGVhc2UpLFxuICAgICAgICBtYWpvcjogdmVyc2lvbk1ham9yLFxuICAgICAgICBtaW5vcjogdmVyc2lvbk1pbm9yLFxuICAgICAgICBwYXRjaDogdmVyc2lvblBhdGNoLFxuICAgICAgICBwcmVSZWxlYXNlOiB2ZXJzaW9uUHJlUmVsZWFzZSA9PSBudWxsID8gdm9pZCAwIDogdmVyc2lvblByZVJlbGVhc2Uuc3BsaXQoJy4nKVxuICAgIH07XG4gICAgZm9yICh2YXIgY29tcGFyYXRvciBvZiBjb21wYXJhdG9ycyl7XG4gICAgICAgIHZhciBleHRyYWN0ZWRDb21wYXJhdG9yID0gZXh0cmFjdENvbXBhcmF0b3IoY29tcGFyYXRvcik7XG4gICAgICAgIGlmICghZXh0cmFjdGVkQ29tcGFyYXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBfZXh0cmFjdGVkQ29tcGFyYXRvciA9IF9zbGljZWRfdG9fYXJyYXkuXyhleHRyYWN0ZWRDb21wYXJhdG9yLCA3KSwgcmFuZ2VPcGVyYXRvciA9IF9leHRyYWN0ZWRDb21wYXJhdG9yWzFdLCByYW5nZU1ham9yID0gX2V4dHJhY3RlZENvbXBhcmF0b3JbM10sIHJhbmdlTWlub3IgPSBfZXh0cmFjdGVkQ29tcGFyYXRvcls0XSwgcmFuZ2VQYXRjaCA9IF9leHRyYWN0ZWRDb21wYXJhdG9yWzVdLCByYW5nZVByZVJlbGVhc2UgPSBfZXh0cmFjdGVkQ29tcGFyYXRvcls2XTtcbiAgICAgICAgdmFyIHJhbmdlQXRvbSA9IHtcbiAgICAgICAgICAgIG9wZXJhdG9yOiByYW5nZU9wZXJhdG9yLFxuICAgICAgICAgICAgdmVyc2lvbjogY29tYmluZVZlcnNpb24ocmFuZ2VNYWpvciwgcmFuZ2VNaW5vciwgcmFuZ2VQYXRjaCwgcmFuZ2VQcmVSZWxlYXNlKSxcbiAgICAgICAgICAgIG1ham9yOiByYW5nZU1ham9yLFxuICAgICAgICAgICAgbWlub3I6IHJhbmdlTWlub3IsXG4gICAgICAgICAgICBwYXRjaDogcmFuZ2VQYXRjaCxcbiAgICAgICAgICAgIHByZVJlbGVhc2U6IHJhbmdlUHJlUmVsZWFzZSA9PSBudWxsID8gdm9pZCAwIDogcmFuZ2VQcmVSZWxlYXNlLnNwbGl0KCcuJylcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCFjb21wYXJlKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIGVhcmx5IHJldHVyblxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gZm9ybWF0U2hhcmUoc2hhcmVBcmdzLCBmcm9tLCBuYW1lMSwgc2hhcmVTdHJhdGVneSkge1xuICAgIHZhciBnZXQ7XG4gICAgaWYgKCdnZXQnIGluIHNoYXJlQXJncykge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWRlc3RydWN0dXJpbmdcbiAgICAgICAgZ2V0ID0gc2hhcmVBcmdzLmdldDtcbiAgICB9IGVsc2UgaWYgKCdsaWInIGluIHNoYXJlQXJncykge1xuICAgICAgICBnZXQgPSAoKT0+UHJvbWlzZS5yZXNvbHZlKHNoYXJlQXJncy5saWIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGdldCA9ICgpPT5Qcm9taXNlLnJlc29sdmUoKCk9PntcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbiBub3QgZ2V0IHNoYXJlZCAnJHtuYW1lMX0nIWApO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChzaGFyZUFyZ3Muc3RyYXRlZ3kpIHtcbiAgICAgICAgd2FybihgXCJzaGFyZWQuc3RyYXRlZ3kgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHNldCBpbiBpbml0T3B0aW9ucy5zaGFyZVN0cmF0ZWd5IGluc3RlYWQhXCJgKTtcbiAgICB9XG4gICAgdmFyIF9zaGFyZUFyZ3NfdmVyc2lvbiwgX3NoYXJlQXJnc19zY29wZSwgX3NoYXJlQXJnc19zdHJhdGVneTtcbiAgICByZXR1cm4gcG9seWZpbGxzLl9leHRlbmRzKHtcbiAgICAgICAgZGVwczogW10sXG4gICAgICAgIHVzZUluOiBbXSxcbiAgICAgICAgZnJvbSxcbiAgICAgICAgbG9hZGluZzogbnVsbFxuICAgIH0sIHNoYXJlQXJncywge1xuICAgICAgICBzaGFyZUNvbmZpZzogcG9seWZpbGxzLl9leHRlbmRzKHtcbiAgICAgICAgICAgIHJlcXVpcmVkVmVyc2lvbjogYF4ke3NoYXJlQXJncy52ZXJzaW9ufWAsXG4gICAgICAgICAgICBzaW5nbGV0b246IGZhbHNlLFxuICAgICAgICAgICAgZWFnZXI6IGZhbHNlLFxuICAgICAgICAgICAgc3RyaWN0VmVyc2lvbjogZmFsc2VcbiAgICAgICAgfSwgc2hhcmVBcmdzLnNoYXJlQ29uZmlnKSxcbiAgICAgICAgZ2V0LFxuICAgICAgICBsb2FkZWQ6IChzaGFyZUFyZ3MgPT0gbnVsbCA/IHZvaWQgMCA6IHNoYXJlQXJncy5sb2FkZWQpIHx8ICdsaWInIGluIHNoYXJlQXJncyA/IHRydWUgOiB1bmRlZmluZWQsXG4gICAgICAgIHZlcnNpb246IChfc2hhcmVBcmdzX3ZlcnNpb24gPSBzaGFyZUFyZ3MudmVyc2lvbikgIT0gbnVsbCA/IF9zaGFyZUFyZ3NfdmVyc2lvbiA6ICcwJyxcbiAgICAgICAgc2NvcGU6IEFycmF5LmlzQXJyYXkoc2hhcmVBcmdzLnNjb3BlKSA/IHNoYXJlQXJncy5zY29wZSA6IFtcbiAgICAgICAgICAgIChfc2hhcmVBcmdzX3Njb3BlID0gc2hhcmVBcmdzLnNjb3BlKSAhPSBudWxsID8gX3NoYXJlQXJnc19zY29wZSA6ICdkZWZhdWx0J1xuICAgICAgICBdLFxuICAgICAgICBzdHJhdGVneTogKChfc2hhcmVBcmdzX3N0cmF0ZWd5ID0gc2hhcmVBcmdzLnN0cmF0ZWd5KSAhPSBudWxsID8gX3NoYXJlQXJnc19zdHJhdGVneSA6IHNoYXJlU3RyYXRlZ3kpIHx8ICd2ZXJzaW9uLWZpcnN0J1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZm9ybWF0U2hhcmVDb25maWdzKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKSB7XG4gICAgdmFyIHNoYXJlQXJncyA9IHVzZXJPcHRpb25zLnNoYXJlZCB8fCB7fTtcbiAgICB2YXIgZnJvbSA9IHVzZXJPcHRpb25zLm5hbWU7XG4gICAgdmFyIHNoYXJlSW5mb3MgPSBPYmplY3Qua2V5cyhzaGFyZUFyZ3MpLnJlZHVjZSgocmVzLCBwa2dOYW1lKT0+e1xuICAgICAgICB2YXIgYXJyYXlTaGFyZUFyZ3MgPSBhcnJheU9wdGlvbnMoc2hhcmVBcmdzW3BrZ05hbWVdKTtcbiAgICAgICAgcmVzW3BrZ05hbWVdID0gcmVzW3BrZ05hbWVdIHx8IFtdO1xuICAgICAgICBhcnJheVNoYXJlQXJncy5mb3JFYWNoKChzaGFyZUNvbmZpZyk9PntcbiAgICAgICAgICAgIHJlc1twa2dOYW1lXS5wdXNoKGZvcm1hdFNoYXJlKHNoYXJlQ29uZmlnLCBmcm9tLCBwa2dOYW1lLCB1c2VyT3B0aW9ucy5zaGFyZVN0cmF0ZWd5KSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH0sIHt9KTtcbiAgICB2YXIgc2hhcmVkID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBnbG9iYWxPcHRpb25zLnNoYXJlZCk7XG4gICAgT2JqZWN0LmtleXMoc2hhcmVJbmZvcykuZm9yRWFjaCgoc2hhcmVLZXkpPT57XG4gICAgICAgIGlmICghc2hhcmVkW3NoYXJlS2V5XSkge1xuICAgICAgICAgICAgc2hhcmVkW3NoYXJlS2V5XSA9IHNoYXJlSW5mb3Nbc2hhcmVLZXldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2hhcmVJbmZvc1tzaGFyZUtleV0uZm9yRWFjaCgobmV3VXNlclNoYXJlZE9wdGlvbnMpPT57XG4gICAgICAgICAgICAgICAgdmFyIGlzU2FtZVZlcnNpb24gPSBzaGFyZWRbc2hhcmVLZXldLmZpbmQoKHNoYXJlZFZhbCk9PnNoYXJlZFZhbC52ZXJzaW9uID09PSBuZXdVc2VyU2hhcmVkT3B0aW9ucy52ZXJzaW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzU2FtZVZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkW3NoYXJlS2V5XS5wdXNoKG5ld1VzZXJTaGFyZWRPcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIHNoYXJlZCxcbiAgICAgICAgc2hhcmVJbmZvc1xuICAgIH07XG59XG5mdW5jdGlvbiB2ZXJzaW9uTHQoYSwgYikge1xuICAgIHZhciB0cmFuc2Zvcm1JbnZhbGlkVmVyc2lvbiA9ICh2ZXJzaW9uKT0+e1xuICAgICAgICB2YXIgaXNOdW1iZXJWZXJzaW9uID0gIU51bWJlci5pc05hTihOdW1iZXIodmVyc2lvbikpO1xuICAgICAgICBpZiAoaXNOdW1iZXJWZXJzaW9uKSB7XG4gICAgICAgICAgICB2YXIgc3BsaXRBcnIgPSB2ZXJzaW9uLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICB2YXIgdmFsaWRWZXJzaW9uID0gdmVyc2lvbjtcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCAzIC0gc3BsaXRBcnIubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgIHZhbGlkVmVyc2lvbiArPSAnLjAnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbGlkVmVyc2lvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmVyc2lvbjtcbiAgICB9O1xuICAgIGlmIChzYXRpc2Z5KHRyYW5zZm9ybUludmFsaWRWZXJzaW9uKGEpLCBgPD0ke3RyYW5zZm9ybUludmFsaWRWZXJzaW9uKGIpfWApKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG52YXIgZmluZFZlcnNpb24gPSAoc2hhcmVWZXJzaW9uTWFwLCBjYik9PntcbiAgICB2YXIgY2FsbGJhY2sgPSBjYiB8fCBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgcmV0dXJuIHZlcnNpb25MdChwcmV2LCBjdXIpO1xuICAgIH07XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHNoYXJlVmVyc2lvbk1hcCkucmVkdWNlKChwcmV2LCBjdXIpPT57XG4gICAgICAgIGlmICghcHJldikge1xuICAgICAgICAgICAgcmV0dXJuIGN1cjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FsbGJhY2socHJldiwgY3VyKSkge1xuICAgICAgICAgICAgcmV0dXJuIGN1cjtcbiAgICAgICAgfVxuICAgICAgICAvLyBkZWZhdWx0IHZlcnNpb24gaXMgJzAnIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJwYWNrL3dlYnBhY2svYmxvYi9tYWluL2xpYi9zaGFyaW5nL1Byb3ZpZGVTaGFyZWRNb2R1bGUuanMjTDEzNlxuICAgICAgICBpZiAocHJldiA9PT0gJzAnKSB7XG4gICAgICAgICAgICByZXR1cm4gY3VyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmV2O1xuICAgIH0sIDApO1xufTtcbnZhciBpc0xvYWRlZCA9IChzaGFyZWQpPT57XG4gICAgcmV0dXJuIEJvb2xlYW4oc2hhcmVkLmxvYWRlZCkgfHwgdHlwZW9mIHNoYXJlZC5saWIgPT09ICdmdW5jdGlvbic7XG59O1xudmFyIGlzTG9hZGluZyA9IChzaGFyZWQpPT57XG4gICAgcmV0dXJuIEJvb2xlYW4oc2hhcmVkLmxvYWRpbmcpO1xufTtcbmZ1bmN0aW9uIGZpbmRTaW5nbGV0b25WZXJzaW9uT3JkZXJCeVZlcnNpb24oc2hhcmVTY29wZU1hcCwgc2NvcGUsIHBrZ05hbWUpIHtcbiAgICB2YXIgdmVyc2lvbnMgPSBzaGFyZVNjb3BlTWFwW3Njb3BlXVtwa2dOYW1lXTtcbiAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgcmV0dXJuICFpc0xvYWRlZCh2ZXJzaW9uc1twcmV2XSkgJiYgdmVyc2lvbkx0KHByZXYsIGN1cik7XG4gICAgfTtcbiAgICByZXR1cm4gZmluZFZlcnNpb24oc2hhcmVTY29wZU1hcFtzY29wZV1bcGtnTmFtZV0sIGNhbGxiYWNrKTtcbn1cbmZ1bmN0aW9uIGZpbmRTaW5nbGV0b25WZXJzaW9uT3JkZXJCeUxvYWRlZChzaGFyZVNjb3BlTWFwLCBzY29wZSwgcGtnTmFtZSkge1xuICAgIHZhciB2ZXJzaW9ucyA9IHNoYXJlU2NvcGVNYXBbc2NvcGVdW3BrZ05hbWVdO1xuICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKHByZXYsIGN1cikge1xuICAgICAgICB2YXIgaXNMb2FkaW5nT3JMb2FkZWQgPSAoc2hhcmVkKT0+e1xuICAgICAgICAgICAgcmV0dXJuIGlzTG9hZGVkKHNoYXJlZCkgfHwgaXNMb2FkaW5nKHNoYXJlZCk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChpc0xvYWRpbmdPckxvYWRlZCh2ZXJzaW9uc1tjdXJdKSkge1xuICAgICAgICAgICAgaWYgKGlzTG9hZGluZ09yTG9hZGVkKHZlcnNpb25zW3ByZXZdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBCb29sZWFuKHZlcnNpb25MdChwcmV2LCBjdXIpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTG9hZGluZ09yTG9hZGVkKHZlcnNpb25zW3ByZXZdKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2ZXJzaW9uTHQocHJldiwgY3VyKTtcbiAgICB9O1xuICAgIHJldHVybiBmaW5kVmVyc2lvbihzaGFyZVNjb3BlTWFwW3Njb3BlXVtwa2dOYW1lXSwgY2FsbGJhY2spO1xufVxuZnVuY3Rpb24gZ2V0RmluZFNoYXJlRnVuY3Rpb24oc3RyYXRlZ3kpIHtcbiAgICBpZiAoc3RyYXRlZ3kgPT09ICdsb2FkZWQtZmlyc3QnKSB7XG4gICAgICAgIHJldHVybiBmaW5kU2luZ2xldG9uVmVyc2lvbk9yZGVyQnlMb2FkZWQ7XG4gICAgfVxuICAgIHJldHVybiBmaW5kU2luZ2xldG9uVmVyc2lvbk9yZGVyQnlWZXJzaW9uO1xufVxuZnVuY3Rpb24gZ2V0UmVnaXN0ZXJlZFNoYXJlKGxvY2FsU2hhcmVTY29wZU1hcCwgcGtnTmFtZSwgc2hhcmVJbmZvLCByZXNvbHZlU2hhcmUpIHtcbiAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbihzYykge1xuICAgICAgICBpZiAoc2hhcmVDb25maWcgJiYgbG9jYWxTaGFyZVNjb3BlTWFwW3NjXSAmJiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdKSB7XG4gICAgICAgICAgICB2YXIgcmVxdWlyZWRWZXJzaW9uID0gc2hhcmVDb25maWcucmVxdWlyZWRWZXJzaW9uO1xuICAgICAgICAgICAgdmFyIGZpbmRTaGFyZUZ1bmN0aW9uID0gZ2V0RmluZFNoYXJlRnVuY3Rpb24oc3RyYXRlZ3kpO1xuICAgICAgICAgICAgdmFyIG1heE9yU2luZ2xldG9uVmVyc2lvbiA9IGZpbmRTaGFyZUZ1bmN0aW9uKGxvY2FsU2hhcmVTY29wZU1hcCwgc2MsIHBrZ05hbWUpO1xuICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICB2YXIgZGVmYXVsdFJlc29sdmVyID0gKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoc2hhcmVDb25maWcuc2luZ2xldG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVxdWlyZWRWZXJzaW9uID09PSAnc3RyaW5nJyAmJiAhc2F0aXNmeShtYXhPclNpbmdsZXRvblZlcnNpb24sIHJlcXVpcmVkVmVyc2lvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtc2cgPSBgVmVyc2lvbiAke21heE9yU2luZ2xldG9uVmVyc2lvbn0gZnJvbSAke21heE9yU2luZ2xldG9uVmVyc2lvbiAmJiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW21heE9yU2luZ2xldG9uVmVyc2lvbl0uZnJvbX0gb2Ygc2hhcmVkIHNpbmdsZXRvbiBtb2R1bGUgJHtwa2dOYW1lfSBkb2VzIG5vdCBzYXRpc2Z5IHRoZSByZXF1aXJlbWVudCBvZiAke3NoYXJlSW5mby5mcm9tfSB3aGljaCBuZWVkcyAke3JlcXVpcmVkVmVyc2lvbn0pYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IobXNnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2Fybihtc2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW21heE9yU2luZ2xldG9uVmVyc2lvbl07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVpcmVkVmVyc2lvbiA9PT0gZmFsc2UgfHwgcmVxdWlyZWRWZXJzaW9uID09PSAnKicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW21heE9yU2luZ2xldG9uVmVyc2lvbl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNhdGlzZnkobWF4T3JTaW5nbGV0b25WZXJzaW9uLCByZXF1aXJlZFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVttYXhPclNpbmdsZXRvblZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHJlZiBvZiBPYmplY3QuZW50cmllcyhsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDIpLCB2ZXJzaW9uS2V5ID0gX3JlZlswXSwgdmVyc2lvblZhbHVlID0gX3JlZlsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzYXRpc2Z5KHZlcnNpb25LZXksIHJlcXVpcmVkVmVyc2lvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmVyc2lvblZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgc2hhcmVTY29wZU1hcDogbG9jYWxTaGFyZVNjb3BlTWFwLFxuICAgICAgICAgICAgICAgIHNjb3BlOiBzYyxcbiAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IG1heE9yU2luZ2xldG9uVmVyc2lvbixcbiAgICAgICAgICAgICAgICBHbG9iYWxGZWRlcmF0aW9uOiBHbG9iYWwuX19GRURFUkFUSU9OX18sXG4gICAgICAgICAgICAgICAgcmVzb2x2ZXI6IGRlZmF1bHRSZXNvbHZlclxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciByZXNvbHZlU2hhcmVkID0gcmVzb2x2ZVNoYXJlLmVtaXQocGFyYW1zKSB8fCBwYXJhbXM7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHY6IHJlc29sdmVTaGFyZWQucmVzb2x2ZXIoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgaWYgKCFsb2NhbFNoYXJlU2NvcGVNYXApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgc2hhcmVDb25maWcgPSBzaGFyZUluZm8uc2hhcmVDb25maWcsIF9zaGFyZUluZm9fc2NvcGUgPSBzaGFyZUluZm8uc2NvcGUsIHNjb3BlID0gX3NoYXJlSW5mb19zY29wZSA9PT0gdm9pZCAwID8gREVGQVVMVF9TQ09QRSA6IF9zaGFyZUluZm9fc2NvcGUsIHN0cmF0ZWd5ID0gc2hhcmVJbmZvLnN0cmF0ZWd5O1xuICAgIHZhciBzY29wZXMgPSBBcnJheS5pc0FycmF5KHNjb3BlKSA/IHNjb3BlIDogW1xuICAgICAgICBzY29wZVxuICAgIF07XG4gICAgZm9yICh2YXIgc2Mgb2Ygc2NvcGVzKXtcbiAgICAgICAgdmFyIF9yZXQgPSBfbG9vcChzYyk7XG4gICAgICAgIGlmIChfdHlwZV9vZi5fKF9yZXQpID09PSBcIm9iamVjdFwiKSByZXR1cm4gX3JldC52O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldEdsb2JhbFNoYXJlU2NvcGUoKSB7XG4gICAgcmV0dXJuIEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1NIQVJFX187XG59XG5mdW5jdGlvbiBnZXRUYXJnZXRTaGFyZWRPcHRpb25zKG9wdGlvbnMpIHtcbiAgICB2YXIgcGtnTmFtZSA9IG9wdGlvbnMucGtnTmFtZSwgZXh0cmFPcHRpb25zID0gb3B0aW9ucy5leHRyYU9wdGlvbnMsIHNoYXJlSW5mb3MgPSBvcHRpb25zLnNoYXJlSW5mb3M7XG4gICAgdmFyIGRlZmF1bHRSZXNvbHZlciA9IChzaGFyZWRPcHRpb25zKT0+e1xuICAgICAgICBpZiAoIXNoYXJlZE9wdGlvbnMpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNoYXJlVmVyc2lvbk1hcCA9IHt9O1xuICAgICAgICBzaGFyZWRPcHRpb25zLmZvckVhY2goKHNoYXJlZCk9PntcbiAgICAgICAgICAgIHNoYXJlVmVyc2lvbk1hcFtzaGFyZWQudmVyc2lvbl0gPSBzaGFyZWQ7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgICAgIHJldHVybiAhaXNMb2FkZWQoc2hhcmVWZXJzaW9uTWFwW3ByZXZdKSAmJiB2ZXJzaW9uTHQocHJldiwgY3VyKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG1heFZlcnNpb24gPSBmaW5kVmVyc2lvbihzaGFyZVZlcnNpb25NYXAsIGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuIHNoYXJlVmVyc2lvbk1hcFttYXhWZXJzaW9uXTtcbiAgICB9O1xuICAgIHZhciBfZXh0cmFPcHRpb25zX3Jlc29sdmVyO1xuICAgIHZhciByZXNvbHZlciA9IChfZXh0cmFPcHRpb25zX3Jlc29sdmVyID0gZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMucmVzb2x2ZXIpICE9IG51bGwgPyBfZXh0cmFPcHRpb25zX3Jlc29sdmVyIDogZGVmYXVsdFJlc29sdmVyO1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCByZXNvbHZlcihzaGFyZUluZm9zW3BrZ05hbWVdKSwgZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuY3VzdG9tU2hhcmVJbmZvKTtcbn1cbnZhciBTaGFyZVV0aWxzID0ge1xuICAgIGdldFJlZ2lzdGVyZWRTaGFyZSxcbiAgICBnZXRHbG9iYWxTaGFyZVNjb3BlXG59O1xudmFyIEdsb2JhbFV0aWxzID0ge1xuICAgIEdsb2JhbCxcbiAgICBuYXRpdmVHbG9iYWwsXG4gICAgcmVzZXRGZWRlcmF0aW9uR2xvYmFsSW5mbyxcbiAgICBzZXRHbG9iYWxGZWRlcmF0aW9uSW5zdGFuY2UsXG4gICAgZ2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yLFxuICAgIHNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcixcbiAgICBnZXRJbmZvV2l0aG91dFR5cGUsXG4gICAgZ2V0R2xvYmFsU25hcHNob3QsXG4gICAgZ2V0VGFyZ2V0U25hcHNob3RJbmZvQnlNb2R1bGVJbmZvLFxuICAgIGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyxcbiAgICBzZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8sXG4gICAgYWRkR2xvYmFsU25hcHNob3QsXG4gICAgZ2V0UmVtb3RlRW50cnlFeHBvcnRzLFxuICAgIHJlZ2lzdGVyR2xvYmFsUGx1Z2lucyxcbiAgICBnZXRHbG9iYWxIb3N0UGx1Z2lucyxcbiAgICBnZXRQcmVsb2FkZWQsXG4gICAgc2V0UHJlbG9hZGVkXG59O1xudmFyIGhlbHBlcnMgPSB7XG4gICAgZ2xvYmFsOiBHbG9iYWxVdGlscyxcbiAgICBzaGFyZTogU2hhcmVVdGlsc1xufTtcbmZ1bmN0aW9uIGdldEJ1aWxkZXJJZCgpIHtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICByZXR1cm4gIHRydWUgPyBcInNwb3J0czoxLjAuMFwiIDogMDtcbn1cbi8vIEZ1bmN0aW9uIHRvIG1hdGNoIGEgcmVtb3RlIHdpdGggaXRzIG5hbWUgYW5kIGV4cG9zZVxuLy8gaWQ6IHBrZ05hbWUoQGZlZGVyYXRpb24vYXBwMSkgKyBleHBvc2UoYnV0dG9uKSA9IEBmZWRlcmF0aW9uL2FwcDEvYnV0dG9uXG4vLyBpZDogYWxpYXMoYXBwMSkgKyBleHBvc2UoYnV0dG9uKSA9IGFwcDEvYnV0dG9uXG4vLyBpZDogYWxpYXMoYXBwMS91dGlscykgKyBleHBvc2UobG9hZGFzaC9zb3J0KSA9IGFwcDEvdXRpbHMvbG9hZGFzaC9zb3J0XG5mdW5jdGlvbiBtYXRjaFJlbW90ZVdpdGhOYW1lQW5kRXhwb3NlKHJlbW90ZXMsIGlkKSB7XG4gICAgZm9yICh2YXIgcmVtb3RlIG9mIHJlbW90ZXMpe1xuICAgICAgICAvLyBtYXRjaCBwa2dOYW1lXG4gICAgICAgIHZhciBpc05hbWVNYXRjaGVkID0gaWQuc3RhcnRzV2l0aChyZW1vdGUubmFtZSk7XG4gICAgICAgIHZhciBleHBvc2UgPSBpZC5yZXBsYWNlKHJlbW90ZS5uYW1lLCAnJyk7XG4gICAgICAgIGlmIChpc05hbWVNYXRjaGVkKSB7XG4gICAgICAgICAgICBpZiAoZXhwb3NlLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgICAgIHZhciBwa2dOYW1lT3JBbGlhcyA9IHJlbW90ZS5uYW1lO1xuICAgICAgICAgICAgICAgIGV4cG9zZSA9IGAuJHtleHBvc2V9YDtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwa2dOYW1lT3JBbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChleHBvc2UgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcGtnTmFtZU9yQWxpYXM6IHJlbW90ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBleHBvc2U6ICcuJyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBtYXRjaCBhbGlhc1xuICAgICAgICB2YXIgaXNBbGlhc01hdGNoZWQgPSByZW1vdGUuYWxpYXMgJiYgaWQuc3RhcnRzV2l0aChyZW1vdGUuYWxpYXMpO1xuICAgICAgICB2YXIgZXhwb3NlV2l0aEFsaWFzID0gcmVtb3RlLmFsaWFzICYmIGlkLnJlcGxhY2UocmVtb3RlLmFsaWFzLCAnJyk7XG4gICAgICAgIGlmIChyZW1vdGUuYWxpYXMgJiYgaXNBbGlhc01hdGNoZWQpIHtcbiAgICAgICAgICAgIGlmIChleHBvc2VXaXRoQWxpYXMgJiYgZXhwb3NlV2l0aEFsaWFzLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgICAgIHZhciBwa2dOYW1lT3JBbGlhczEgPSByZW1vdGUuYWxpYXM7XG4gICAgICAgICAgICAgICAgZXhwb3NlV2l0aEFsaWFzID0gYC4ke2V4cG9zZVdpdGhBbGlhc31gO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzOiBwa2dOYW1lT3JBbGlhczEsXG4gICAgICAgICAgICAgICAgICAgIGV4cG9zZTogZXhwb3NlV2l0aEFsaWFzLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChleHBvc2VXaXRoQWxpYXMgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcGtnTmFtZU9yQWxpYXM6IHJlbW90ZS5hbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlOiAnLicsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuO1xufVxuLy8gRnVuY3Rpb24gdG8gbWF0Y2ggYSByZW1vdGUgd2l0aCBpdHMgbmFtZSBvciBhbGlhc1xuZnVuY3Rpb24gbWF0Y2hSZW1vdGUocmVtb3RlcywgbmFtZU9yQWxpYXMpIHtcbiAgICBmb3IgKHZhciByZW1vdGUgb2YgcmVtb3Rlcyl7XG4gICAgICAgIHZhciBpc05hbWVNYXRjaGVkID0gbmFtZU9yQWxpYXMgPT09IHJlbW90ZS5uYW1lO1xuICAgICAgICBpZiAoaXNOYW1lTWF0Y2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXNBbGlhc01hdGNoZWQgPSByZW1vdGUuYWxpYXMgJiYgbmFtZU9yQWxpYXMgPT09IHJlbW90ZS5hbGlhcztcbiAgICAgICAgaWYgKGlzQWxpYXNNYXRjaGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3RlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybjtcbn1cbmZ1bmN0aW9uIHJlZ2lzdGVyUGx1Z2lucyhwbHVnaW5zLCBob29rSW5zdGFuY2VzKSB7XG4gICAgdmFyIGdsb2JhbFBsdWdpbnMgPSBnZXRHbG9iYWxIb3N0UGx1Z2lucygpO1xuICAgIC8vIEluY29ycG9yYXRlIGdsb2JhbCBwbHVnaW5zXG4gICAgaWYgKGdsb2JhbFBsdWdpbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBnbG9iYWxQbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgICAgIGlmIChwbHVnaW5zID09IG51bGwgPyB2b2lkIDAgOiBwbHVnaW5zLmZpbmQoKGl0ZW0pPT5pdGVtLm5hbWUgIT09IHBsdWdpbi5uYW1lKSkge1xuICAgICAgICAgICAgICAgIHBsdWdpbnMucHVzaChwbHVnaW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHBsdWdpbnMgJiYgcGx1Z2lucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHBsdWdpbnMuZm9yRWFjaCgocGx1Z2luKT0+e1xuICAgICAgICAgICAgaG9va0luc3RhbmNlcy5mb3JFYWNoKChob29rSW5zdGFuY2UpPT57XG4gICAgICAgICAgICAgICAgaG9va0luc3RhbmNlLmFwcGx5UGx1Z2luKHBsdWdpbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBwbHVnaW5zO1xufVxuZnVuY3Rpb24gbG9hZEVzbUVudHJ5KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHJlZi5lbnRyeSwgcmVtb3RlRW50cnlFeHBvcnRzID0gcmVmLnJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpPT57XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghcmVtb3RlRW50cnlFeHBvcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRnVuY3Rpb24oJ2NhbGxiYWNrcycsIGBpbXBvcnQoXCIke2VudHJ5fVwiKS50aGVuKGNhbGxiYWNrc1swXSkuY2F0Y2goY2FsbGJhY2tzWzFdKWApKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7fVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVtb3RlRW50cnlFeHBvcnRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gbG9hZFN5c3RlbUpzRW50cnkoXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gcmVmLmVudHJ5LCByZW1vdGVFbnRyeUV4cG9ydHMgPSByZWYucmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCk9PntcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZW1vdGVFbnRyeUV4cG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWxzZSkge30gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRnVuY3Rpb24oJ2NhbGxiYWNrcycsIGBTeXN0ZW0uaW1wb3J0KFwiJHtlbnRyeX1cIikudGhlbihjYWxsYmFja3NbMF0pLmNhdGNoKGNhbGxiYWNrc1sxXSlgKShbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZW1vdGVFbnRyeUV4cG9ydHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBsb2FkRW50cnlTY3JpcHQoXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIG5hbWUxID0gcmVmLm5hbWUsIGdsb2JhbE5hbWUgPSByZWYuZ2xvYmFsTmFtZSwgZW50cnkgPSByZWYuZW50cnksIGxvYWRlckhvb2sgPSByZWYubG9hZGVySG9vaztcbiAgICAgICAgdmFyIF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMgPSBnZXRSZW1vdGVFbnRyeUV4cG9ydHMobmFtZTEsIGdsb2JhbE5hbWUpLCByZW1vdGVFbnRyeUV4cG9ydHMgPSBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzLmVudHJ5RXhwb3J0cztcbiAgICAgICAgaWYgKHJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2RrLmxvYWRTY3JpcHQoZW50cnksIHtcbiAgICAgICAgICAgIGF0dHJzOiB7fSxcbiAgICAgICAgICAgIGNyZWF0ZVNjcmlwdEhvb2s6ICh1cmwsIGF0dHJzKT0+e1xuICAgICAgICAgICAgICAgIHZhciByZXMgPSBsb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVTY3JpcHQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICAgICAgYXR0cnNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlcykgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MU2NyaXB0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJ3NjcmlwdCcgaW4gcmVzIHx8ICd0aW1lb3V0JyBpbiByZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS50aGVuKCgpPT57XG4gICAgICAgICAgICB2YXIgX2dldFJlbW90ZUVudHJ5RXhwb3J0cyA9IGdldFJlbW90ZUVudHJ5RXhwb3J0cyhuYW1lMSwgZ2xvYmFsTmFtZSksIHJlbW90ZUVudHJ5S2V5ID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5yZW1vdGVFbnRyeUtleSwgZW50cnlFeHBvcnRzID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5lbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICBhc3NlcnQoZW50cnlFeHBvcnRzLCBlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwMSwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgIHJlbW90ZU5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5VXJsOiBlbnRyeSxcbiAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUtleVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIGVudHJ5RXhwb3J0cztcbiAgICAgICAgfSkuY2F0Y2goKGUpPT57XG4gICAgICAgICAgICBhc3NlcnQodW5kZWZpbmVkLCBlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwOCwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgIHJlbW90ZU5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIHJlc291cmNlVXJsOiBlbnRyeVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfSk7XG4gICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIGxvYWRFbnRyeURvbShfMCkge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKHJlZikge1xuICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IHJlZi5yZW1vdGVJbmZvLCByZW1vdGVFbnRyeUV4cG9ydHMgPSByZWYucmVtb3RlRW50cnlFeHBvcnRzLCBsb2FkZXJIb29rID0gcmVmLmxvYWRlckhvb2s7XG4gICAgICAgIHZhciBlbnRyeSA9IHJlbW90ZUluZm8uZW50cnksIGdsb2JhbE5hbWUgPSByZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZSwgbmFtZTEgPSByZW1vdGVJbmZvLm5hbWUsIHR5cGUgPSByZW1vdGVJbmZvLnR5cGU7XG4gICAgICAgIHN3aXRjaCh0eXBlKXtcbiAgICAgICAgICAgIGNhc2UgJ2VzbSc6XG4gICAgICAgICAgICBjYXNlICdtb2R1bGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkRXNtRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICBlbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjYXNlICdzeXN0ZW0nOlxuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkU3lzdGVtSnNFbnRyeSh7XG4gICAgICAgICAgICAgICAgICAgIGVudHJ5LFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRFbnRyeVNjcmlwdCh7XG4gICAgICAgICAgICAgICAgICAgIGVudHJ5LFxuICAgICAgICAgICAgICAgICAgICBnbG9iYWxOYW1lLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVySG9va1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIGxvYWRFbnRyeU5vZGUoXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSByZWYucmVtb3RlSW5mbywgbG9hZGVySG9vayA9IHJlZi5sb2FkZXJIb29rO1xuICAgICAgICB2YXIgZW50cnkgPSByZW1vdGVJbmZvLmVudHJ5LCBnbG9iYWxOYW1lID0gcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUsIG5hbWUxID0gcmVtb3RlSW5mby5uYW1lLCB0eXBlID0gcmVtb3RlSW5mby50eXBlO1xuICAgICAgICB2YXIgX2dldFJlbW90ZUVudHJ5RXhwb3J0cyA9IGdldFJlbW90ZUVudHJ5RXhwb3J0cyhuYW1lMSwgZ2xvYmFsTmFtZSksIHJlbW90ZUVudHJ5RXhwb3J0cyA9IF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMuZW50cnlFeHBvcnRzO1xuICAgICAgICBpZiAocmVtb3RlRW50cnlFeHBvcnRzKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZGsubG9hZFNjcmlwdE5vZGUoZW50cnksIHtcbiAgICAgICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgZ2xvYmFsTmFtZSxcbiAgICAgICAgICAgICAgICB0eXBlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbG9hZGVySG9vazoge1xuICAgICAgICAgICAgICAgIGNyZWF0ZVNjcmlwdEhvb2s6ICh1cmwsIHJlZik9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJzID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IGxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZVNjcmlwdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlcykgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJ3VybCcgaW4gcmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLnRoZW4oKCk9PntcbiAgICAgICAgICAgIHZhciBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzID0gZ2V0UmVtb3RlRW50cnlFeHBvcnRzKG5hbWUxLCBnbG9iYWxOYW1lKSwgcmVtb3RlRW50cnlLZXkgPSBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzLnJlbW90ZUVudHJ5S2V5LCBlbnRyeUV4cG9ydHMgPSBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzLmVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgIGFzc2VydChlbnRyeUV4cG9ydHMsIGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDAxLCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgcmVtb3RlTmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgcmVtb3RlRW50cnlVcmw6IGVudHJ5LFxuICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5S2V5XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gZW50cnlFeHBvcnRzO1xuICAgICAgICB9KS5jYXRjaCgoZSk9PntcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgIH0pO1xuICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBnZXRSZW1vdGVFbnRyeVVuaXF1ZUtleShyZW1vdGVJbmZvKSB7XG4gICAgdmFyIGVudHJ5ID0gcmVtb3RlSW5mby5lbnRyeSwgbmFtZTEgPSByZW1vdGVJbmZvLm5hbWU7XG4gICAgcmV0dXJuIHNkay5jb21wb3NlS2V5V2l0aFNlcGFyYXRvcihuYW1lMSwgZW50cnkpO1xufVxuZnVuY3Rpb24gZ2V0UmVtb3RlRW50cnkoXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIG9yaWdpbiA9IHJlZi5vcmlnaW4sIHJlbW90ZUVudHJ5RXhwb3J0cyA9IHJlZi5yZW1vdGVFbnRyeUV4cG9ydHMsIHJlbW90ZUluZm8gPSByZWYucmVtb3RlSW5mbztcbiAgICAgICAgdmFyIHVuaXF1ZUtleSA9IGdldFJlbW90ZUVudHJ5VW5pcXVlS2V5KHJlbW90ZUluZm8pO1xuICAgICAgICBpZiAocmVtb3RlRW50cnlFeHBvcnRzKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZ2xvYmFsTG9hZGluZ1t1bmlxdWVLZXldKSB7XG4gICAgICAgICAgICB2YXIgbG9hZEVudHJ5SG9vayA9IG9yaWdpbi5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5sb2FkRW50cnk7XG4gICAgICAgICAgICB2YXIgbG9hZGVySG9vayA9IG9yaWdpbi5sb2FkZXJIb29rO1xuICAgICAgICAgICAgZ2xvYmFsTG9hZGluZ1t1bmlxdWVLZXldID0gbG9hZEVudHJ5SG9vay5lbWl0KHtcbiAgICAgICAgICAgICAgICBsb2FkZXJIb29rLFxuICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICB9KS50aGVuKChyZXMpPT57XG4gICAgICAgICAgICAgICAgaWYgKHJlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gc2RrLmlzQnJvd3NlckVudigpID8gbG9hZEVudHJ5RG9tKHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzLFxuICAgICAgICAgICAgICAgICAgICBsb2FkZXJIb29rXG4gICAgICAgICAgICAgICAgfSkgOiBsb2FkRW50cnlOb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVySG9va1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGdsb2JhbExvYWRpbmdbdW5pcXVlS2V5XTtcbiAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gZ2V0UmVtb3RlSW5mbyhyZW1vdGUpIHtcbiAgICByZXR1cm4gcG9seWZpbGxzLl9leHRlbmRzKHt9LCByZW1vdGUsIHtcbiAgICAgICAgZW50cnk6ICdlbnRyeScgaW4gcmVtb3RlID8gcmVtb3RlLmVudHJ5IDogJycsXG4gICAgICAgIHR5cGU6IHJlbW90ZS50eXBlIHx8IERFRkFVTFRfUkVNT1RFX1RZUEUsXG4gICAgICAgIGVudHJ5R2xvYmFsTmFtZTogcmVtb3RlLmVudHJ5R2xvYmFsTmFtZSB8fCByZW1vdGUubmFtZSxcbiAgICAgICAgc2hhcmVTY29wZTogcmVtb3RlLnNoYXJlU2NvcGUgfHwgREVGQVVMVF9TQ09QRVxuICAgIH0pO1xufVxudmFyIE1vZHVsZSA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gTW9kdWxlKHJlZikge1xuICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IHJlZi5yZW1vdGVJbmZvLCBob3N0ID0gcmVmLmhvc3Q7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgTW9kdWxlKTtcbiAgICAgICAgdGhpcy5pbml0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5saWIgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucmVtb3RlSW5mbyA9IHJlbW90ZUluZm87XG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhNb2R1bGUsIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldEVudHJ5XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RW50cnkoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHMgPSB5aWVsZCBnZXRSZW1vdGVFbnRyeSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB0aGlzLmhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbzogdGhpcy5yZW1vdGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0czogdGhpcy5yZW1vdGVFbnRyeUV4cG9ydHNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1bmlxdWVLZXkgPSBnZXRSZW1vdGVFbnRyeVVuaXF1ZUtleSh0aGlzLnJlbW90ZUluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgdGhpcy5ob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmxvYWRFbnRyeUVycm9yLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFJlbW90ZUVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogdGhpcy5ob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IHRoaXMucmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHM6IHRoaXMucmVtb3RlRW50cnlFeHBvcnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbExvYWRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pcXVlS2V5XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQocmVtb3RlRW50cnlFeHBvcnRzLCBgcmVtb3RlRW50cnlFeHBvcnRzIGlzIHVuZGVmaW5lZCBcXG4gJHtzZGsuc2FmZVRvU3RyaW5nKHRoaXMucmVtb3RlSW5mbyl9YCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3RlRW50cnlFeHBvcnRzID0gcmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldFwiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvZXhwbGljaXQtbW9kdWxlLWJvdW5kYXJ5LXR5cGVzXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXQoaWQsIGV4cG9zZSwgb3B0aW9ucywgcmVtb3RlU25hcHNob3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBvcHRpb25zIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRGYWN0b3J5OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0sIF9yZWZfbG9hZEZhY3RvcnkgPSBfcmVmLmxvYWRGYWN0b3J5LCBsb2FkRmFjdG9yeSA9IF9yZWZfbG9hZEZhY3RvcnkgPT09IHZvaWQgMCA/IHRydWUgOiBfcmVmX2xvYWRGYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgcmVtb3RlRW50cnkuanNcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5RXhwb3J0cyA9IHlpZWxkIHRoaXMuZ2V0RW50cnkoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmluaXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsU2hhcmVTY29wZU1hcCA9IHRoaXMuaG9zdC5zaGFyZVNjb3BlTWFwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZVNoYXJlU2NvcGUgPSB0aGlzLnJlbW90ZUluZm8uc2hhcmVTY29wZSB8fCAnZGVmYXVsdCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxvY2FsU2hhcmVTY29wZU1hcFtyZW1vdGVTaGFyZVNjb3BlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU2hhcmVTY29wZU1hcFtyZW1vdGVTaGFyZVNjb3BlXSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGUgPSBsb2NhbFNoYXJlU2NvcGVNYXBbcmVtb3RlU2hhcmVTY29wZV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5pdFNjb3BlID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnlJbml0T3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnJlbW90ZUluZm8udmVyc2lvbiB8fCAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhlbHAgdG8gZmluZCBob3N0IGluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVtb3RlRW50cnlJbml0T3B0aW9ucywgJ3NoYXJlU2NvcGVNYXAnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGxvY2FsU2hhcmVTY29wZU1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZW1vdGVFbnRyeUluaXRPcHRpb25zIHdpbGwgYmUgdHJhdmVyc2VkIGFuZCBhc3NpZ25lZCBkdXJpbmcgY29udGFpbmVyIGluaXQsICxzbyB0aGlzIGF0dHJpYnV0ZSBpcyBub3QgYWxsb3dlZCB0byBiZSB0cmF2ZXJzZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5pdENvbnRhaW5lck9wdGlvbnMgPSB5aWVsZCB0aGlzLmhvc3QuaG9va3MubGlmZWN5Y2xlLmJlZm9yZUluaXRDb250YWluZXIuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIHNoYXJlU2NvcGVNYXAgd2lsbCBiZSBzZXQgYnkgT2JqZWN0LmRlZmluZVByb3BlcnR5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlJbml0T3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0U2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbzogdGhpcy5yZW1vdGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogdGhpcy5ob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKHJlbW90ZUVudHJ5RXhwb3J0cyA9PSBudWxsID8gdm9pZCAwIDogcmVtb3RlRW50cnlFeHBvcnRzLmluaXQpID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDAyLCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZU5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5VXJsOiB0aGlzLnJlbW90ZUluZm8uZW50cnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5S2V5OiB0aGlzLnJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgcmVtb3RlRW50cnlFeHBvcnRzLmluaXQoaW5pdENvbnRhaW5lck9wdGlvbnMuc2hhcmVTY29wZSwgaW5pdENvbnRhaW5lck9wdGlvbnMuaW5pdFNjb3BlLCBpbml0Q29udGFpbmVyT3B0aW9ucy5yZW1vdGVFbnRyeUluaXRPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaG9zdC5ob29rcy5saWZlY3ljbGUuaW5pdENvbnRhaW5lci5lbWl0KHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgaW5pdENvbnRhaW5lck9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpYiA9IHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlRmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlRmFjdG9yeSA9IHlpZWxkIHRoaXMuaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5nZXRNb2R1bGVGYWN0b3J5LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbzogdGhpcy5yZW1vdGVJbmZvXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZXhwb3NlR2V0dGVyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbW9kdWxlRmFjdG9yeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlRmFjdG9yeSA9IHlpZWxkIHJlbW90ZUVudHJ5RXhwb3J0cy5nZXQoZXhwb3NlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobW9kdWxlRmFjdG9yeSwgYCR7Z2V0Rk1JZCh0aGlzLnJlbW90ZUluZm8pfSByZW1vdGUgZG9uJ3QgZXhwb3J0ICR7ZXhwb3NlfS5gKTtcbiAgICAgICAgICAgICAgICAgICAgLy8ga2VlcCBzeW1ib2wgZm9yIG1vZHVsZSBuYW1lIGFsd2F5cyBvbmUgZm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIHZhciBzeW1ib2xOYW1lID0gcHJvY2Vzc01vZHVsZUFsaWFzKHRoaXMucmVtb3RlSW5mby5uYW1lLCBleHBvc2UpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgd3JhcE1vZHVsZUZhY3RvcnkgPSB0aGlzLndyYXBlckZhY3RvcnkobW9kdWxlRmFjdG9yeSwgc3ltYm9sTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghbG9hZEZhY3RvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3cmFwTW9kdWxlRmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhwb3NlQ29udGVudCA9IHlpZWxkIHdyYXBNb2R1bGVGYWN0b3J5KCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBleHBvc2VDb250ZW50O1xuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJ3cmFwZXJGYWN0b3J5XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd3JhcGVyRmFjdG9yeShtb2R1bGVGYWN0b3J5LCBpZCkge1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRlZmluZU1vZHVsZUlkKHJlcywgaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyAmJiB0eXBlb2YgcmVzID09PSAnb2JqZWN0JyAmJiBPYmplY3QuaXNFeHRlbnNpYmxlKHJlcykgJiYgIU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocmVzLCBTeW1ib2wuZm9yKCdtZl9tb2R1bGVfaWQnKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXMsIFN5bWJvbC5mb3IoJ21mX21vZHVsZV9pZCcpLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobW9kdWxlRmFjdG9yeSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB5aWVsZCBtb2R1bGVGYWN0b3J5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBwYXJhbWV0ZXIgaXMgdXNlZCBmb3IgYnJpZGdlIGRlYnVnZ2luZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmluZU1vZHVsZUlkKHJlcywgaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IG1vZHVsZUZhY3RvcnkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgcGFyYW1ldGVyIGlzIHVzZWQgZm9yIGJyaWRnZSBkZWJ1Z2dpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmluZU1vZHVsZUlkKHJlcywgaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gTW9kdWxlO1xufSgpO1xudmFyIFN5bmNIb29rID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBTeW5jSG9vayh0eXBlKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU3luY0hvb2spO1xuICAgICAgICB0aGlzLnR5cGUgPSAnJztcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSBuZXcgU2V0KCk7XG4gICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTeW5jSG9vaywgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwib25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbihmbikge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnMuYWRkKGZuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJvbmNlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25jZShmbikge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhc1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzLm9uKGZ1bmN0aW9uIHdyYXBwZXIoLi4uYXJncykge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnJlbW92ZSh3cmFwcGVyKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZW1pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGVtaXQoLi4uZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLmZvckVhY2goKGZuKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZm4uYXBwbHkodm9pZCAwLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGRhdGEpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZW1vdmVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoZm4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5kZWxldGUoZm4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVtb3ZlQWxsXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlQWxsKCkge1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLmNsZWFyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gU3luY0hvb2s7XG59KCk7XG52YXIgQXN5bmNIb29rID0gLyojX19QVVJFX18qLyBmdW5jdGlvbihTeW5jSG9vaykge1xuICAgIF9pbmhlcml0cy5fKEFzeW5jSG9vaywgU3luY0hvb2spO1xuICAgIGZ1bmN0aW9uIEFzeW5jSG9vaygpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBBc3luY0hvb2spO1xuICAgICAgICByZXR1cm4gX2NhbGxfc3VwZXIuXyh0aGlzLCBBc3luY0hvb2ssIGFyZ3VtZW50cyk7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhBc3luY0hvb2ssIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImVtaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlbWl0KC4uLmRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgICAgIHZhciBscyA9IEFycmF5LmZyb20odGhpcy5saXN0ZW5lcnMpO1xuICAgICAgICAgICAgICAgIGlmIChscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGwgPSAocHJldik9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gQWJvcnQgcHJvY2Vzc1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpIDwgbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShsc1tpKytdLmFwcGx5KG51bGwsIGRhdGEpKS50aGVuKGNhbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJldjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gY2FsbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gQXN5bmNIb29rO1xufShTeW5jSG9vayk7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xuZnVuY3Rpb24gY2hlY2tSZXR1cm5EYXRhKG9yaWdpbmFsRGF0YSwgcmV0dXJuZWREYXRhKSB7XG4gICAgaWYgKCFpc09iamVjdChyZXR1cm5lZERhdGEpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKG9yaWdpbmFsRGF0YSAhPT0gcmV0dXJuZWREYXRhKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXN5bnRheFxuICAgICAgICBmb3IodmFyIGtleSBpbiBvcmlnaW5hbERhdGEpe1xuICAgICAgICAgICAgaWYgKCEoa2V5IGluIHJldHVybmVkRGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG52YXIgU3luY1dhdGVyZmFsbEhvb2sgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKFN5bmNIb29rKSB7XG4gICAgX2luaGVyaXRzLl8oU3luY1dhdGVyZmFsbEhvb2ssIFN5bmNIb29rKTtcbiAgICBmdW5jdGlvbiBTeW5jV2F0ZXJmYWxsSG9vayh0eXBlKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU3luY1dhdGVyZmFsbEhvb2spO1xuICAgICAgICB2YXIgX3RoaXM7XG4gICAgICAgIF90aGlzID0gX2NhbGxfc3VwZXIuXyh0aGlzLCBTeW5jV2F0ZXJmYWxsSG9vayksIF90aGlzLm9uZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgX3RoaXMudHlwZSA9IHR5cGU7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFN5bmNXYXRlcmZhbGxIb29rLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJlbWl0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZW1pdChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc09iamVjdChkYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcihgVGhlIGRhdGEgZm9yIHRoZSBcIiR7dGhpcy50eXBlfVwiIGhvb2sgc2hvdWxkIGJlIGFuIG9iamVjdC5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZm4gb2YgdGhpcy5saXN0ZW5lcnMpe1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBEYXRhID0gZm4oZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2tSZXR1cm5EYXRhKGRhdGEsIHRlbXBEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0ZW1wRGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGBBIHBsdWdpbiByZXR1cm5lZCBhbiB1bmFjY2VwdGFibGUgdmFsdWUgZm9yIHRoZSBcIiR7dGhpcy50eXBlfVwiIHR5cGUuYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gU3luY1dhdGVyZmFsbEhvb2s7XG59KFN5bmNIb29rKTtcbnZhciBBc3luY1dhdGVyZmFsbEhvb2sgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKFN5bmNIb29rKSB7XG4gICAgX2luaGVyaXRzLl8oQXN5bmNXYXRlcmZhbGxIb29rLCBTeW5jSG9vayk7XG4gICAgZnVuY3Rpb24gQXN5bmNXYXRlcmZhbGxIb29rKHR5cGUpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBBc3luY1dhdGVyZmFsbEhvb2spO1xuICAgICAgICB2YXIgX3RoaXM7XG4gICAgICAgIF90aGlzID0gX2NhbGxfc3VwZXIuXyh0aGlzLCBBc3luY1dhdGVyZmFsbEhvb2spLCBfdGhpcy5vbmVycm9yID0gZXJyb3I7XG4gICAgICAgIF90aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhBc3luY1dhdGVyZmFsbEhvb2ssIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImVtaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlbWl0KGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWlzT2JqZWN0KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yKGBUaGUgcmVzcG9uc2UgZGF0YSBmb3IgdGhlIFwiJHt0aGlzLnR5cGV9XCIgaG9vayBtdXN0IGJlIGFuIG9iamVjdC5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGxzID0gQXJyYXkuZnJvbSh0aGlzLmxpc3RlbmVycyk7XG4gICAgICAgICAgICAgICAgaWYgKGxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0Vycm9yID0gKGUpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBjYWxsID0gKHByZXZEYXRhKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrUmV0dXJuRGF0YShkYXRhLCBwcmV2RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gcHJldkRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCBscy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobHNbaSsrXShkYXRhKSkudGhlbihjYWxsLCBwcm9jZXNzRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvY2Vzc0Vycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uZXJyb3IoYEEgcGx1Z2luIHJldHVybmVkIGFuIGluY29ycmVjdCB2YWx1ZSBmb3IgdGhlIFwiJHt0aGlzLnR5cGV9XCIgdHlwZS5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNhbGwoZGF0YSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIEFzeW5jV2F0ZXJmYWxsSG9vaztcbn0oU3luY0hvb2spO1xudmFyIFBsdWdpblN5c3RlbSA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gUGx1Z2luU3lzdGVtKGxpZmVjeWNsZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFBsdWdpblN5c3RlbSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJQbHVnaW5zID0ge307XG4gICAgICAgIHRoaXMubGlmZWN5Y2xlID0gbGlmZWN5Y2xlO1xuICAgICAgICB0aGlzLmxpZmVjeWNsZUtleXMgPSBPYmplY3Qua2V5cyhsaWZlY3ljbGUpO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oUGx1Z2luU3lzdGVtLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJhcHBseVBsdWdpblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5UGx1Z2luKHBsdWdpbikge1xuICAgICAgICAgICAgICAgIGFzc2VydChpc1BsYWluT2JqZWN0KHBsdWdpbiksICdQbHVnaW4gY29uZmlndXJhdGlvbiBpcyBpbnZhbGlkLicpO1xuICAgICAgICAgICAgICAgIC8vIFRoZSBwbHVnaW4ncyBuYW1lIGlzIG1hbmRhdG9yeSBhbmQgbXVzdCBiZSB1bmlxdWVcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2luTmFtZSA9IHBsdWdpbi5uYW1lO1xuICAgICAgICAgICAgICAgIGFzc2VydChwbHVnaW5OYW1lLCAnQSBuYW1lIG11c3QgYmUgcHJvdmlkZWQgYnkgdGhlIHBsdWdpbi4nKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdID0gcGx1Z2luO1xuICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmxpZmVjeWNsZSkuZm9yRWFjaCgoa2V5KT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsdWdpbkxpZmUgPSBwbHVnaW5ba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbHVnaW5MaWZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saWZlY3ljbGVba2V5XS5vbihwbHVnaW5MaWZlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVtb3ZlUGx1Z2luXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlUGx1Z2luKHBsdWdpbk5hbWUpIHtcbiAgICAgICAgICAgICAgICBhc3NlcnQocGx1Z2luTmFtZSwgJ0EgbmFtZSBpcyByZXF1aXJlZC4nKTtcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2luID0gdGhpcy5yZWdpc3RlclBsdWdpbnNbcGx1Z2luTmFtZV07XG4gICAgICAgICAgICAgICAgYXNzZXJ0KHBsdWdpbiwgYFRoZSBwbHVnaW4gXCIke3BsdWdpbk5hbWV9XCIgaXMgbm90IHJlZ2lzdGVyZWQuYCk7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMocGx1Z2luKS5mb3JFYWNoKChrZXkpPT57XG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgIT09ICduYW1lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saWZlY3ljbGVba2V5XS5yZW1vdmUocGx1Z2luW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tc2hhZG93XG4gICAgICAgICAgICBrZXk6IFwiaW5oZXJpdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaGVyaXQocmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpZmVjeWNsZSA9IHJlZi5saWZlY3ljbGUsIHJlZ2lzdGVyUGx1Z2lucyA9IHJlZi5yZWdpc3RlclBsdWdpbnM7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMobGlmZWN5Y2xlKS5mb3JFYWNoKChob29rTmFtZSk9PntcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCF0aGlzLmxpZmVjeWNsZVtob29rTmFtZV0sIGBUaGUgaG9vayBcIiR7aG9va05hbWV9XCIgaGFzIGEgY29uZmxpY3QgYW5kIGNhbm5vdCBiZSBpbmhlcml0ZWQuYCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlmZWN5Y2xlW2hvb2tOYW1lXSA9IGxpZmVjeWNsZVtob29rTmFtZV07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMocmVnaXN0ZXJQbHVnaW5zKS5mb3JFYWNoKChwbHVnaW5OYW1lKT0+e1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoIXRoaXMucmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdLCBgVGhlIHBsdWdpbiBcIiR7cGx1Z2luTmFtZX1cIiBoYXMgYSBjb25mbGljdCBhbmQgY2Fubm90IGJlIGluaGVyaXRlZC5gKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseVBsdWdpbihyZWdpc3RlclBsdWdpbnNbcGx1Z2luTmFtZV0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFBsdWdpblN5c3RlbTtcbn0oKTtcbmZ1bmN0aW9uIGRlZmF1bHRQcmVsb2FkQXJncyhwcmVsb2FkQ29uZmlnKSB7XG4gICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7XG4gICAgICAgIHJlc291cmNlQ2F0ZWdvcnk6ICdzeW5jJyxcbiAgICAgICAgc2hhcmU6IHRydWUsXG4gICAgICAgIGRlcHNSZW1vdGU6IHRydWUsXG4gICAgICAgIHByZWZldGNoSW50ZXJmYWNlOiBmYWxzZVxuICAgIH0sIHByZWxvYWRDb25maWcpO1xufVxuZnVuY3Rpb24gZm9ybWF0UHJlbG9hZEFyZ3MocmVtb3RlcywgcHJlbG9hZEFyZ3MpIHtcbiAgICByZXR1cm4gcHJlbG9hZEFyZ3MubWFwKChhcmdzKT0+e1xuICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IG1hdGNoUmVtb3RlKHJlbW90ZXMsIGFyZ3MubmFtZU9yQWxpYXMpO1xuICAgICAgICBhc3NlcnQocmVtb3RlSW5mbywgYFVuYWJsZSB0byBwcmVsb2FkICR7YXJncy5uYW1lT3JBbGlhc30gYXMgaXQgaXMgbm90IGluY2x1ZGVkIGluICR7IXJlbW90ZUluZm8gJiYgc2RrLnNhZmVUb1N0cmluZyh7XG4gICAgICAgICAgICByZW1vdGVJbmZvLFxuICAgICAgICAgICAgcmVtb3Rlc1xuICAgICAgICB9KX1gKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlbW90ZTogcmVtb3RlSW5mbyxcbiAgICAgICAgICAgIHByZWxvYWRDb25maWc6IGRlZmF1bHRQcmVsb2FkQXJncyhhcmdzKVxuICAgICAgICB9O1xuICAgIH0pO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplUHJlbG9hZEV4cG9zZXMoZXhwb3Nlcykge1xuICAgIGlmICghZXhwb3Nlcykge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIHJldHVybiBleHBvc2VzLm1hcCgoZXhwb3NlKT0+e1xuICAgICAgICBpZiAoZXhwb3NlID09PSAnLicpIHtcbiAgICAgICAgICAgIHJldHVybiBleHBvc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4cG9zZS5zdGFydHNXaXRoKCcuLycpKSB7XG4gICAgICAgICAgICByZXR1cm4gZXhwb3NlLnJlcGxhY2UoJy4vJywgJycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHBvc2U7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBwcmVsb2FkQXNzZXRzKHJlbW90ZUluZm8sIGhvc3QsIGFzc2V0cywgcmVmKSB7XG4gICAgdmFyIHVzZUxpbmtQcmVsb2FkID0gcmVmID09PSB2b2lkIDAgPyB0cnVlIDogcmVmO1xuICAgIHZhciBjc3NBc3NldHMgPSBhc3NldHMuY3NzQXNzZXRzLCBqc0Fzc2V0c1dpdGhvdXRFbnRyeSA9IGFzc2V0cy5qc0Fzc2V0c1dpdGhvdXRFbnRyeSwgZW50cnlBc3NldHMgPSBhc3NldHMuZW50cnlBc3NldHM7XG4gICAgaWYgKGhvc3Qub3B0aW9ucy5pbkJyb3dzZXIpIHtcbiAgICAgICAgZW50cnlBc3NldHMuZm9yRWFjaCgoYXNzZXQpPT57XG4gICAgICAgICAgICB2YXIgbW9kdWxlSW5mbyA9IGFzc2V0Lm1vZHVsZUluZm87XG4gICAgICAgICAgICB2YXIgbW9kdWxlID0gaG9zdC5tb2R1bGVDYWNoZS5nZXQocmVtb3RlSW5mby5uYW1lKTtcbiAgICAgICAgICAgIGlmIChtb2R1bGUpIHtcbiAgICAgICAgICAgICAgICBnZXRSZW1vdGVFbnRyeSh7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbzogbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzOiBtb2R1bGUucmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdldFJlbW90ZUVudHJ5KHtcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0LFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvOiBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHM6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHVzZUxpbmtQcmVsb2FkKSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdEF0dHJzID0ge1xuICAgICAgICAgICAgICAgIHJlbDogJ3ByZWxvYWQnLFxuICAgICAgICAgICAgICAgIGFzOiAnc3R5bGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY3NzQXNzZXRzLmZvckVhY2goKGNzc1VybCk9PntcbiAgICAgICAgICAgICAgICB2YXIgX3Nka19jcmVhdGVMaW5rID0gc2RrLmNyZWF0ZUxpbmsoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGNzc1VybCxcbiAgICAgICAgICAgICAgICAgICAgY2I6ICgpPT57XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vb3BcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYXR0cnM6IGRlZmF1bHRBdHRycyxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlTGlua0hvb2s6ICh1cmwsIGF0dHJzKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IGhvc3QubG9hZGVySG9vay5saWZlY3ljbGUuY3JlYXRlTGluay5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyBpbnN0YW5jZW9mIEhUTUxMaW5rRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSwgY3NzRWwgPSBfc2RrX2NyZWF0ZUxpbmsubGluaywgbmVlZEF0dGFjaCA9IF9zZGtfY3JlYXRlTGluay5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjc3NFbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0QXR0cnMxID0ge1xuICAgICAgICAgICAgICAgIHJlbDogJ3N0eWxlc2hlZXQnLFxuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0L2NzcydcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjc3NBc3NldHMuZm9yRWFjaCgoY3NzVXJsKT0+e1xuICAgICAgICAgICAgICAgIHZhciBfc2RrX2NyZWF0ZUxpbmsgPSBzZGsuY3JlYXRlTGluayh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogY3NzVXJsLFxuICAgICAgICAgICAgICAgICAgICBjYjogKCk9PntcbiAgICAgICAgICAgICAgICAgICAgLy8gbm9vcFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhdHRyczogZGVmYXVsdEF0dHJzMSxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlTGlua0hvb2s6ICh1cmwsIGF0dHJzKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IGhvc3QubG9hZGVySG9vay5saWZlY3ljbGUuY3JlYXRlTGluay5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyBpbnN0YW5jZW9mIEhUTUxMaW5rRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVMaW5rOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pLCBjc3NFbCA9IF9zZGtfY3JlYXRlTGluay5saW5rLCBuZWVkQXR0YWNoID0gX3Nka19jcmVhdGVMaW5rLm5lZWRBdHRhY2g7XG4gICAgICAgICAgICAgICAgbmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGNzc0VsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1c2VMaW5rUHJlbG9hZCkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRBdHRyczIgPSB7XG4gICAgICAgICAgICAgICAgcmVsOiAncHJlbG9hZCcsXG4gICAgICAgICAgICAgICAgYXM6ICdzY3JpcHQnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAganNBc3NldHNXaXRob3V0RW50cnkuZm9yRWFjaCgoanNVcmwpPT57XG4gICAgICAgICAgICAgICAgdmFyIF9zZGtfY3JlYXRlTGluayA9IHNkay5jcmVhdGVMaW5rKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBqc1VybCxcbiAgICAgICAgICAgICAgICAgICAgY2I6ICgpPT57XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vb3BcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYXR0cnM6IGRlZmF1bHRBdHRyczIsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxpbmtIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZUxpbmsuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MTGlua0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksIGxpbmtFbCA9IF9zZGtfY3JlYXRlTGluay5saW5rLCBuZWVkQXR0YWNoID0gX3Nka19jcmVhdGVMaW5rLm5lZWRBdHRhY2g7XG4gICAgICAgICAgICAgICAgbmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGxpbmtFbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0QXR0cnMzID0ge1xuICAgICAgICAgICAgICAgIGZldGNocHJpb3JpdHk6ICdoaWdoJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAocmVtb3RlSW5mbyA9PSBudWxsID8gdm9pZCAwIDogcmVtb3RlSW5mby50eXBlKSA9PT0gJ21vZHVsZScgPyAnbW9kdWxlJyA6ICd0ZXh0L2phdmFzY3JpcHQnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAganNBc3NldHNXaXRob3V0RW50cnkuZm9yRWFjaCgoanNVcmwpPT57XG4gICAgICAgICAgICAgICAgdmFyIF9zZGtfY3JlYXRlU2NyaXB0ID0gc2RrLmNyZWF0ZVNjcmlwdCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDoganNVcmwsXG4gICAgICAgICAgICAgICAgICAgIGNiOiAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAvLyBub29wXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzOiBkZWZhdWx0QXR0cnMzLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVTY3JpcHRIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZVNjcmlwdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyBpbnN0YW5jZW9mIEhUTUxTY3JpcHRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbmVlZERlbGV0ZVNjcmlwdDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pLCBzY3JpcHRFbCA9IF9zZGtfY3JlYXRlU2NyaXB0LnNjcmlwdCwgbmVlZEF0dGFjaCA9IF9zZGtfY3JlYXRlU2NyaXB0Lm5lZWRBdHRhY2g7XG4gICAgICAgICAgICAgICAgbmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdEVsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gYXNzaWduUmVtb3RlSW5mbyhyZW1vdGVJbmZvLCByZW1vdGVTbmFwc2hvdCkge1xuICAgIHZhciByZW1vdGVFbnRyeUluZm8gPSBnZXRSZW1vdGVFbnRyeUluZm9Gcm9tU25hcHNob3QocmVtb3RlU25hcHNob3QpO1xuICAgIGlmICghcmVtb3RlRW50cnlJbmZvLnVybCkge1xuICAgICAgICBlcnJvcihgVGhlIGF0dHJpYnV0ZSByZW1vdGVFbnRyeSBvZiAke3JlbW90ZUluZm8ubmFtZX0gbXVzdCBub3QgYmUgdW5kZWZpbmVkLmApO1xuICAgIH1cbiAgICB2YXIgZW50cnlVcmwgPSBzZGsuZ2V0UmVzb3VyY2VVcmwocmVtb3RlU25hcHNob3QsIHJlbW90ZUVudHJ5SW5mby51cmwpO1xuICAgIGlmICghc2RrLmlzQnJvd3NlckVudigpICYmICFlbnRyeVVybC5zdGFydHNXaXRoKCdodHRwJykpIHtcbiAgICAgICAgZW50cnlVcmwgPSBgaHR0cHM6JHtlbnRyeVVybH1gO1xuICAgIH1cbiAgICByZW1vdGVJbmZvLnR5cGUgPSByZW1vdGVFbnRyeUluZm8udHlwZTtcbiAgICByZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZSA9IHJlbW90ZUVudHJ5SW5mby5nbG9iYWxOYW1lO1xuICAgIHJlbW90ZUluZm8uZW50cnkgPSBlbnRyeVVybDtcbiAgICByZW1vdGVJbmZvLnZlcnNpb24gPSByZW1vdGVTbmFwc2hvdC52ZXJzaW9uO1xuICAgIHJlbW90ZUluZm8uYnVpbGRWZXJzaW9uID0gcmVtb3RlU25hcHNob3QuYnVpbGRWZXJzaW9uO1xufVxuZnVuY3Rpb24gc25hcHNob3RQbHVnaW4oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogJ3NuYXBzaG90LXBsdWdpbicsXG4gICAgICAgIGFmdGVyUmVzb2x2ZSAoYXJncykge1xuICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZSA9IGFyZ3MucmVtb3RlLCBwa2dOYW1lT3JBbGlhcyA9IGFyZ3MucGtnTmFtZU9yQWxpYXMsIGV4cG9zZSA9IGFyZ3MuZXhwb3NlLCBvcmlnaW4gPSBhcmdzLm9yaWdpbiwgcmVtb3RlSW5mbyA9IGFyZ3MucmVtb3RlSW5mbztcbiAgICAgICAgICAgICAgICBpZiAoIWlzUmVtb3RlSW5mb1dpdGhFbnRyeShyZW1vdGUpIHx8ICFpc1B1cmVSZW1vdGVFbnRyeShyZW1vdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgb3JpZ2luLnNuYXBzaG90SGFuZGxlci5sb2FkUmVtb3RlU25hcHNob3RJbmZvKHJlbW90ZSksIHJlbW90ZVNuYXBzaG90ID0gX3JlZi5yZW1vdGVTbmFwc2hvdCwgZ2xvYmFsU25hcHNob3QgPSBfcmVmLmdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICBhc3NpZ25SZW1vdGVJbmZvKHJlbW90ZUluZm8sIHJlbW90ZVNuYXBzaG90KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gcHJlbG9hZGluZyBhc3NldHNcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZWxvYWRPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlbG9hZENvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVPckFsaWFzOiBwa2dOYW1lT3JBbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VDYXRlZ29yeTogJ3N5bmMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXBzUmVtb3RlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXNzZXRzID0geWllbGQgb3JpZ2luLnJlbW90ZUhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLmdlbmVyYXRlUHJlbG9hZEFzc2V0cy5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhc3NldHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRBc3NldHMocmVtb3RlSW5mbywgb3JpZ2luLCBhc3NldHMsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBhcmdzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgICAgICAgICB9KSgpO1xuICAgICAgICB9XG4gICAgfTtcbn1cbi8vIG5hbWVcbi8vIG5hbWU6dmVyc2lvblxuZnVuY3Rpb24gc3BsaXRJZChpZCkge1xuICAgIHZhciBzcGxpdEluZm8gPSBpZC5zcGxpdCgnOicpO1xuICAgIGlmIChzcGxpdEluZm8ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBzcGxpdEluZm9bMF0sXG4gICAgICAgICAgICB2ZXJzaW9uOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHNwbGl0SW5mby5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IHNwbGl0SW5mb1swXSxcbiAgICAgICAgICAgIHZlcnNpb246IHNwbGl0SW5mb1sxXVxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBzcGxpdEluZm9bMV0sXG4gICAgICAgICAgICB2ZXJzaW9uOiBzcGxpdEluZm9bMl1cbiAgICAgICAgfTtcbiAgICB9XG59XG4vLyBUcmF2ZXJzZSBhbGwgbm9kZXMgaW4gbW9kdWxlSW5mbyBhbmQgdHJhdmVyc2UgdGhlIGVudGlyZSBzbmFwc2hvdFxuZnVuY3Rpb24gdHJhdmVyc2VNb2R1bGVJbmZvKGdsb2JhbFNuYXBzaG90LCByZW1vdGVJbmZvLCB0cmF2ZXJzZSwgaXNSb290LCByZWYsIHJlbW90ZVNuYXBzaG90KSB7XG4gICAgdmFyIG1lbW8gPSByZWYgPT09IHZvaWQgMCA/IHt9IDogcmVmO1xuICAgIHZhciBpZCA9IGdldEZNSWQocmVtb3RlSW5mbyk7XG4gICAgdmFyIF9nZXRJbmZvV2l0aG91dFR5cGUgPSBnZXRJbmZvV2l0aG91dFR5cGUoZ2xvYmFsU25hcHNob3QsIGlkKSwgc25hcHNob3RWYWx1ZSA9IF9nZXRJbmZvV2l0aG91dFR5cGUudmFsdWU7XG4gICAgdmFyIGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90ID0gcmVtb3RlU25hcHNob3QgfHwgc25hcHNob3RWYWx1ZTtcbiAgICBpZiAoZWZmZWN0aXZlUmVtb3RlU25hcHNob3QgJiYgIXNkay5pc01hbmlmZXN0UHJvdmlkZXIoZWZmZWN0aXZlUmVtb3RlU25hcHNob3QpKSB7XG4gICAgICAgIHRyYXZlcnNlKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LCByZW1vdGVJbmZvLCBpc1Jvb3QpO1xuICAgICAgICBpZiAoZWZmZWN0aXZlUmVtb3RlU25hcHNob3QucmVtb3Rlc0luZm8pIHtcbiAgICAgICAgICAgIHZhciByZW1vdGVLZXlzID0gT2JqZWN0LmtleXMoZWZmZWN0aXZlUmVtb3RlU25hcHNob3QucmVtb3Rlc0luZm8pO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IG9mIHJlbW90ZUtleXMpe1xuICAgICAgICAgICAgICAgIGlmIChtZW1vW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1lbW9ba2V5XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIHN1YlJlbW90ZUluZm8gPSBzcGxpdElkKGtleSk7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZVZhbHVlID0gZWZmZWN0aXZlUmVtb3RlU25hcHNob3QucmVtb3Rlc0luZm9ba2V5XTtcbiAgICAgICAgICAgICAgICB0cmF2ZXJzZU1vZHVsZUluZm8oZ2xvYmFsU25hcHNob3QsIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogc3ViUmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiByZW1vdGVWYWx1ZS5tYXRjaGVkVmVyc2lvblxuICAgICAgICAgICAgICAgIH0sIHRyYXZlcnNlLCBmYWxzZSwgbWVtbywgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGluZXMtcGVyLWZ1bmN0aW9uXG5mdW5jdGlvbiBnZW5lcmF0ZVByZWxvYWRBc3NldHMob3JpZ2luLCBwcmVsb2FkT3B0aW9ucywgcmVtb3RlLCBnbG9iYWxTbmFwc2hvdCwgcmVtb3RlU25hcHNob3QpIHtcbiAgICB2YXIgY3NzQXNzZXRzID0gW107XG4gICAgdmFyIGpzQXNzZXRzID0gW107XG4gICAgdmFyIGVudHJ5QXNzZXRzID0gW107XG4gICAgdmFyIGxvYWRlZFNoYXJlZEpzQXNzZXRzID0gbmV3IFNldCgpO1xuICAgIHZhciBsb2FkZWRTaGFyZWRDc3NBc3NldHMgPSBuZXcgU2V0KCk7XG4gICAgdmFyIG9wdGlvbnMgPSBvcmlnaW4ub3B0aW9ucztcbiAgICB2YXIgcm9vdFByZWxvYWRDb25maWcgPSBwcmVsb2FkT3B0aW9ucy5wcmVsb2FkQ29uZmlnO1xuICAgIHZhciBkZXBzUmVtb3RlID0gcm9vdFByZWxvYWRDb25maWcuZGVwc1JlbW90ZTtcbiAgICB2YXIgbWVtbyA9IHt9O1xuICAgIHRyYXZlcnNlTW9kdWxlSW5mbyhnbG9iYWxTbmFwc2hvdCwgcmVtb3RlLCAobW9kdWxlSW5mb1NuYXBzaG90LCByZW1vdGVJbmZvLCBpc1Jvb3QpPT57XG4gICAgICAgIHZhciBwcmVsb2FkQ29uZmlnO1xuICAgICAgICBpZiAoaXNSb290KSB7XG4gICAgICAgICAgICBwcmVsb2FkQ29uZmlnID0gcm9vdFByZWxvYWRDb25maWc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkZXBzUmVtb3RlKSkge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBhcnJheS1jYWxsYmFjay1yZXR1cm5cbiAgICAgICAgICAgICAgICB2YXIgZmluZFByZWxvYWRDb25maWcgPSBkZXBzUmVtb3RlLmZpbmQoKHJlbW90ZUNvbmZpZyk9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUNvbmZpZy5uYW1lT3JBbGlhcyA9PT0gcmVtb3RlSW5mby5uYW1lIHx8IHJlbW90ZUNvbmZpZy5uYW1lT3JBbGlhcyA9PT0gcmVtb3RlSW5mby5hbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmICghZmluZFByZWxvYWRDb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcmVsb2FkQ29uZmlnID0gZGVmYXVsdFByZWxvYWRBcmdzKGZpbmRQcmVsb2FkQ29uZmlnKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVwc1JlbW90ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHByZWxvYWRDb25maWcgPSByb290UHJlbG9hZENvbmZpZztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciByZW1vdGVFbnRyeVVybCA9IHNkay5nZXRSZXNvdXJjZVVybChtb2R1bGVJbmZvU25hcHNob3QsIGdldFJlbW90ZUVudHJ5SW5mb0Zyb21TbmFwc2hvdChtb2R1bGVJbmZvU25hcHNob3QpLnVybCk7XG4gICAgICAgIGlmIChyZW1vdGVFbnRyeVVybCkge1xuICAgICAgICAgICAgZW50cnlBc3NldHMucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgIG1vZHVsZUluZm86IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBlbnRyeTogcmVtb3RlRW50cnlVcmwsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZW1vdGVFbnRyeVR5cGUnIGluIG1vZHVsZUluZm9TbmFwc2hvdCA/IG1vZHVsZUluZm9TbmFwc2hvdC5yZW1vdGVFbnRyeVR5cGUgOiAnZ2xvYmFsJyxcbiAgICAgICAgICAgICAgICAgICAgZW50cnlHbG9iYWxOYW1lOiAnZ2xvYmFsTmFtZScgaW4gbW9kdWxlSW5mb1NuYXBzaG90ID8gbW9kdWxlSW5mb1NuYXBzaG90Lmdsb2JhbE5hbWUgOiByZW1vdGVJbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGU6ICcnLFxuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAndmVyc2lvbicgaW4gbW9kdWxlSW5mb1NuYXBzaG90ID8gbW9kdWxlSW5mb1NuYXBzaG90LnZlcnNpb24gOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHVybDogcmVtb3RlRW50cnlVcmxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtb2R1bGVBc3NldHNJbmZvID0gJ21vZHVsZXMnIGluIG1vZHVsZUluZm9TbmFwc2hvdCA/IG1vZHVsZUluZm9TbmFwc2hvdC5tb2R1bGVzIDogW107XG4gICAgICAgIHZhciBub3JtYWxpemVkUHJlbG9hZEV4cG9zZXMgPSBub3JtYWxpemVQcmVsb2FkRXhwb3NlcyhwcmVsb2FkQ29uZmlnLmV4cG9zZXMpO1xuICAgICAgICBpZiAobm9ybWFsaXplZFByZWxvYWRFeHBvc2VzLmxlbmd0aCAmJiAnbW9kdWxlcycgaW4gbW9kdWxlSW5mb1NuYXBzaG90KSB7XG4gICAgICAgICAgICB2YXIgX21vZHVsZUluZm9TbmFwc2hvdF9tb2R1bGVzO1xuICAgICAgICAgICAgbW9kdWxlQXNzZXRzSW5mbyA9IG1vZHVsZUluZm9TbmFwc2hvdCA9PSBudWxsID8gdm9pZCAwIDogKF9tb2R1bGVJbmZvU25hcHNob3RfbW9kdWxlcyA9IG1vZHVsZUluZm9TbmFwc2hvdC5tb2R1bGVzKSA9PSBudWxsID8gdm9pZCAwIDogX21vZHVsZUluZm9TbmFwc2hvdF9tb2R1bGVzLnJlZHVjZSgoYXNzZXRzLCBtb2R1bGVBc3NldEluZm8pPT57XG4gICAgICAgICAgICAgICAgaWYgKChub3JtYWxpemVkUHJlbG9hZEV4cG9zZXMgPT0gbnVsbCA/IHZvaWQgMCA6IG5vcm1hbGl6ZWRQcmVsb2FkRXhwb3Nlcy5pbmRleE9mKG1vZHVsZUFzc2V0SW5mby5tb2R1bGVOYW1lKSkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0cy5wdXNoKG1vZHVsZUFzc2V0SW5mbyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhc3NldHM7XG4gICAgICAgICAgICB9LCBbXSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlQXNzZXRzKGFzc2V0cykge1xuICAgICAgICAgICAgdmFyIGFzc2V0c1JlcyA9IGFzc2V0cy5tYXAoKGFzc2V0KT0+c2RrLmdldFJlc291cmNlVXJsKG1vZHVsZUluZm9TbmFwc2hvdCwgYXNzZXQpKTtcbiAgICAgICAgICAgIGlmIChwcmVsb2FkQ29uZmlnLmZpbHRlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBhc3NldHNSZXMuZmlsdGVyKHByZWxvYWRDb25maWcuZmlsdGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhc3NldHNSZXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZHVsZUFzc2V0c0luZm8pIHtcbiAgICAgICAgICAgIHZhciBhc3NldHNMZW5ndGggPSBtb2R1bGVBc3NldHNJbmZvLmxlbmd0aDtcbiAgICAgICAgICAgIGZvcih2YXIgaW5kZXggPSAwOyBpbmRleCA8IGFzc2V0c0xlbmd0aDsgaW5kZXgrKyl7XG4gICAgICAgICAgICAgICAgdmFyIGFzc2V0c0luZm8gPSBtb2R1bGVBc3NldHNJbmZvW2luZGV4XTtcbiAgICAgICAgICAgICAgICB2YXIgZXhwb3NlRnVsbFBhdGggPSBgJHtyZW1vdGVJbmZvLm5hbWV9LyR7YXNzZXRzSW5mby5tb2R1bGVOYW1lfWA7XG4gICAgICAgICAgICAgICAgb3JpZ2luLnJlbW90ZUhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLmhhbmRsZVByZWxvYWRNb2R1bGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBhc3NldHNJbmZvLm1vZHVsZU5hbWUgPT09ICcuJyA/IHJlbW90ZUluZm8ubmFtZSA6IGV4cG9zZUZ1bGxQYXRoLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGVJbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBtb2R1bGVJbmZvU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgIHByZWxvYWRDb25maWcsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZTogcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHByZWxvYWRlZCA9IGdldFByZWxvYWRlZChleHBvc2VGdWxsUGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKHByZWxvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHByZWxvYWRDb25maWcucmVzb3VyY2VDYXRlZ29yeSA9PT0gJ2FsbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9jc3NBc3NldHMsIF9jc3NBc3NldHMxLCBfanNBc3NldHMsIF9qc0Fzc2V0czE7XG4gICAgICAgICAgICAgICAgICAgIChfY3NzQXNzZXRzID0gY3NzQXNzZXRzKS5wdXNoLmFwcGx5KF9jc3NBc3NldHMsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmNzcy5hc3luYykpKTtcbiAgICAgICAgICAgICAgICAgICAgKF9jc3NBc3NldHMxID0gY3NzQXNzZXRzKS5wdXNoLmFwcGx5KF9jc3NBc3NldHMxLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5jc3Muc3luYykpKTtcbiAgICAgICAgICAgICAgICAgICAgKF9qc0Fzc2V0cyA9IGpzQXNzZXRzKS5wdXNoLmFwcGx5KF9qc0Fzc2V0cywgX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhoYW5kbGVBc3NldHMoYXNzZXRzSW5mby5hc3NldHMuanMuYXN5bmMpKSk7XG4gICAgICAgICAgICAgICAgICAgIChfanNBc3NldHMxID0ganNBc3NldHMpLnB1c2guYXBwbHkoX2pzQXNzZXRzMSwgX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhoYW5kbGVBc3NldHMoYXNzZXRzSW5mby5hc3NldHMuanMuc3luYykpKTtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcmVsb2FkQ29uZmlnLnJlc291cmNlQ2F0ZWdvcnkgPSAnc3luYycpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9jc3NBc3NldHMyLCBfanNBc3NldHMyO1xuICAgICAgICAgICAgICAgICAgICAoX2Nzc0Fzc2V0czIgPSBjc3NBc3NldHMpLnB1c2guYXBwbHkoX2Nzc0Fzc2V0czIsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmNzcy5zeW5jKSkpO1xuICAgICAgICAgICAgICAgICAgICAoX2pzQXNzZXRzMiA9IGpzQXNzZXRzKS5wdXNoLmFwcGx5KF9qc0Fzc2V0czIsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmpzLnN5bmMpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNldFByZWxvYWRlZChleHBvc2VGdWxsUGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB0cnVlLCBtZW1vLCByZW1vdGVTbmFwc2hvdCk7XG4gICAgaWYgKHJlbW90ZVNuYXBzaG90LnNoYXJlZCkge1xuICAgICAgICB2YXIgY29sbGVjdFNoYXJlZEFzc2V0cyA9IChzaGFyZUluZm8sIHNuYXBzaG90U2hhcmVkKT0+e1xuICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUob3JpZ2luLnNoYXJlU2NvcGVNYXAsIHNuYXBzaG90U2hhcmVkLnNoYXJlZE5hbWUsIHNoYXJlSW5mbywgb3JpZ2luLnNoYXJlZEhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAvLyBJZiB0aGUgZ2xvYmFsIHNoYXJlIGRvZXMgbm90IGV4aXN0LCBvciB0aGUgbGliIGZ1bmN0aW9uIGRvZXMgbm90IGV4aXN0LCBpdCBtZWFucyB0aGF0IHRoZSBzaGFyZWQgaGFzIG5vdCBiZWVuIGxvYWRlZCB5ZXQgYW5kIGNhbiBiZSBwcmVsb2FkZWQuXG4gICAgICAgICAgICBpZiAocmVnaXN0ZXJlZFNoYXJlZCAmJiB0eXBlb2YgcmVnaXN0ZXJlZFNoYXJlZC5saWIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBzbmFwc2hvdFNoYXJlZC5hc3NldHMuanMuc3luYy5mb3JFYWNoKChhc3NldCk9PntcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVkU2hhcmVkSnNBc3NldHMuYWRkKGFzc2V0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBzbmFwc2hvdFNoYXJlZC5hc3NldHMuY3NzLnN5bmMuZm9yRWFjaCgoYXNzZXQpPT57XG4gICAgICAgICAgICAgICAgICAgIGxvYWRlZFNoYXJlZENzc0Fzc2V0cy5hZGQoYXNzZXQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZW1vdGVTbmFwc2hvdC5zaGFyZWQuZm9yRWFjaCgoc2hhcmVkKT0+e1xuICAgICAgICAgICAgdmFyIF9vcHRpb25zX3NoYXJlZDtcbiAgICAgICAgICAgIHZhciBzaGFyZUluZm9zID0gKF9vcHRpb25zX3NoYXJlZCA9IG9wdGlvbnMuc2hhcmVkKSA9PSBudWxsID8gdm9pZCAwIDogX29wdGlvbnNfc2hhcmVkW3NoYXJlZC5zaGFyZWROYW1lXTtcbiAgICAgICAgICAgIGlmICghc2hhcmVJbmZvcykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIG5vIHZlcnNpb24sIHByZWxvYWQgYWxsIHNoYXJlZFxuICAgICAgICAgICAgdmFyIHNoYXJlZE9wdGlvbnMgPSBzaGFyZWQudmVyc2lvbiA/IHNoYXJlSW5mb3MuZmluZCgocyk9PnMudmVyc2lvbiA9PT0gc2hhcmVkLnZlcnNpb24pIDogc2hhcmVJbmZvcztcbiAgICAgICAgICAgIGlmICghc2hhcmVkT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhcnJheVNoYXJlSW5mbyA9IGFycmF5T3B0aW9ucyhzaGFyZWRPcHRpb25zKTtcbiAgICAgICAgICAgIGFycmF5U2hhcmVJbmZvLmZvckVhY2goKHMpPT57XG4gICAgICAgICAgICAgICAgY29sbGVjdFNoYXJlZEFzc2V0cyhzLCBzaGFyZWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB2YXIgbmVlZFByZWxvYWRKc0Fzc2V0cyA9IGpzQXNzZXRzLmZpbHRlcigoYXNzZXQpPT4hbG9hZGVkU2hhcmVkSnNBc3NldHMuaGFzKGFzc2V0KSk7XG4gICAgdmFyIG5lZWRQcmVsb2FkQ3NzQXNzZXRzID0gY3NzQXNzZXRzLmZpbHRlcigoYXNzZXQpPT4hbG9hZGVkU2hhcmVkQ3NzQXNzZXRzLmhhcyhhc3NldCkpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNzc0Fzc2V0czogbmVlZFByZWxvYWRDc3NBc3NldHMsXG4gICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5OiBuZWVkUHJlbG9hZEpzQXNzZXRzLFxuICAgICAgICBlbnRyeUFzc2V0c1xuICAgIH07XG59XG52YXIgZ2VuZXJhdGVQcmVsb2FkQXNzZXRzUGx1Z2luID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogJ2dlbmVyYXRlLXByZWxvYWQtYXNzZXRzLXBsdWdpbicsXG4gICAgICAgIGdlbmVyYXRlUHJlbG9hZEFzc2V0cyAoYXJncykge1xuICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9yaWdpbiA9IGFyZ3Mub3JpZ2luLCBwcmVsb2FkT3B0aW9ucyA9IGFyZ3MucHJlbG9hZE9wdGlvbnMsIHJlbW90ZUluZm8gPSBhcmdzLnJlbW90ZUluZm8sIHJlbW90ZSA9IGFyZ3MucmVtb3RlLCBnbG9iYWxTbmFwc2hvdCA9IGFyZ3MuZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90ID0gYXJncy5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICBpZiAoaXNSZW1vdGVJbmZvV2l0aEVudHJ5KHJlbW90ZSkgJiYgaXNQdXJlUmVtb3RlRW50cnkocmVtb3RlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3NzQXNzZXRzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5OiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5QXNzZXRzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiByZW1vdGUuZW50cnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm86IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5OiByZW1vdGUuZW50cnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiByZW1vdGVJbmZvLnR5cGUgfHwgJ2dsb2JhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeUdsb2JhbE5hbWU6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZTogJydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXNzaWduUmVtb3RlSW5mbyhyZW1vdGVJbmZvLCByZW1vdGVTbmFwc2hvdCk7XG4gICAgICAgICAgICAgICAgdmFyIGFzc2V0cyA9IGdlbmVyYXRlUHJlbG9hZEFzc2V0cyhvcmlnaW4sIHByZWxvYWRPcHRpb25zLCByZW1vdGVJbmZvLCBnbG9iYWxTbmFwc2hvdCwgcmVtb3RlU25hcHNob3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhc3NldHM7XG4gICAgICAgICAgICB9KSgpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG5mdW5jdGlvbiBnZXRHbG9iYWxSZW1vdGVJbmZvKG1vZHVsZUluZm8sIG9yaWdpbikge1xuICAgIHZhciBob3N0R2xvYmFsU25hcHNob3QgPSBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICBuYW1lOiBvcmlnaW4ub3B0aW9ucy5uYW1lLFxuICAgICAgICB2ZXJzaW9uOiBvcmlnaW4ub3B0aW9ucy52ZXJzaW9uXG4gICAgfSk7XG4gICAgLy8gZ2V0IHJlbW90ZSBkZXRhaWwgaW5mbyBmcm9tIGdsb2JhbFxuICAgIHZhciBnbG9iYWxSZW1vdGVJbmZvID0gaG9zdEdsb2JhbFNuYXBzaG90ICYmICdyZW1vdGVzSW5mbycgaW4gaG9zdEdsb2JhbFNuYXBzaG90ICYmIGhvc3RHbG9iYWxTbmFwc2hvdC5yZW1vdGVzSW5mbyAmJiBnZXRJbmZvV2l0aG91dFR5cGUoaG9zdEdsb2JhbFNuYXBzaG90LnJlbW90ZXNJbmZvLCBtb2R1bGVJbmZvLm5hbWUpLnZhbHVlO1xuICAgIGlmIChnbG9iYWxSZW1vdGVJbmZvICYmIGdsb2JhbFJlbW90ZUluZm8ubWF0Y2hlZFZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGhvc3RHbG9iYWxTbmFwc2hvdCxcbiAgICAgICAgICAgIGdsb2JhbFNuYXBzaG90OiBnZXRHbG9iYWxTbmFwc2hvdCgpLFxuICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyh7XG4gICAgICAgICAgICAgICAgbmFtZTogbW9kdWxlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IGdsb2JhbFJlbW90ZUluZm8ubWF0Y2hlZFZlcnNpb25cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGhvc3RHbG9iYWxTbmFwc2hvdDogdW5kZWZpbmVkLFxuICAgICAgICBnbG9iYWxTbmFwc2hvdDogZ2V0R2xvYmFsU25hcHNob3QoKSxcbiAgICAgICAgcmVtb3RlU25hcHNob3Q6IGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyh7XG4gICAgICAgICAgICBuYW1lOiBtb2R1bGVJbmZvLm5hbWUsXG4gICAgICAgICAgICB2ZXJzaW9uOiAndmVyc2lvbicgaW4gbW9kdWxlSW5mbyA/IG1vZHVsZUluZm8udmVyc2lvbiA6IHVuZGVmaW5lZFxuICAgICAgICB9KVxuICAgIH07XG59XG52YXIgU25hcHNob3RIYW5kbGVyID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBTbmFwc2hvdEhhbmRsZXIoSG9zdEluc3RhbmNlKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU25hcHNob3RIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5sb2FkaW5nSG9zdFNuYXBzaG90ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tYW5pZmVzdENhY2hlID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmhvb2tzID0gbmV3IFBsdWdpblN5c3RlbSh7XG4gICAgICAgICAgICBiZWZvcmVMb2FkUmVtb3RlU25hcHNob3Q6IG5ldyBBc3luY0hvb2soJ2JlZm9yZUxvYWRSZW1vdGVTbmFwc2hvdCcpLFxuICAgICAgICAgICAgbG9hZFNuYXBzaG90OiBuZXcgQXN5bmNXYXRlcmZhbGxIb29rKCdsb2FkR2xvYmFsU25hcHNob3QnKSxcbiAgICAgICAgICAgIGxvYWRSZW1vdGVTbmFwc2hvdDogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnbG9hZFJlbW90ZVNuYXBzaG90JyksXG4gICAgICAgICAgICBhZnRlckxvYWRTbmFwc2hvdDogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYWZ0ZXJMb2FkU25hcHNob3QnKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5tYW5pZmVzdExvYWRpbmcgPSBHbG9iYWwuX19GRURFUkFUSU9OX18uX19NQU5JRkVTVF9MT0FESU5HX187XG4gICAgICAgIHRoaXMuSG9zdEluc3RhbmNlID0gSG9zdEluc3RhbmNlO1xuICAgICAgICB0aGlzLmxvYWRlckhvb2sgPSBIb3N0SW5zdGFuY2UubG9hZGVySG9vaztcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFNuYXBzaG90SGFuZGxlciwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNuYXBzaG90XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFNuYXBzaG90KG1vZHVsZUluZm8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mbyA9IHRoaXMuZ2V0R2xvYmFsUmVtb3RlSW5mbyhtb2R1bGVJbmZvKSwgaG9zdEdsb2JhbFNuYXBzaG90ID0gX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mby5ob3N0R2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90ID0gX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mby5yZW1vdGVTbmFwc2hvdCwgZ2xvYmFsU25hcHNob3QgPSBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvLmdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmxvYWRTbmFwc2hvdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdEdsb2JhbFNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdFxuICAgICAgICAgICAgICAgICAgICB9KSwgZ2xvYmFsUmVtb3RlU25hcHNob3QgPSBfcmVmLnJlbW90ZVNuYXBzaG90LCBnbG9iYWxTbmFwc2hvdFJlcyA9IF9yZWYuZ2xvYmFsU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdDogZ2xvYmFsUmVtb3RlU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdDogZ2xvYmFsU25hcHNob3RSZXNcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFJlbW90ZVNuYXBzaG90SW5mb1wiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGluZXMtcGVyLWZ1bmN0aW9uXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2FkUmVtb3RlU25hcHNob3RJbmZvKG1vZHVsZUluZm8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVMb2FkUmVtb3RlU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3RTbmFwc2hvdCA9IGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLnZlcnNpb25cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaG9zdFNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0U25hcHNob3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucy52ZXJzaW9uIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5OiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVzSW5mbzoge31cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRHbG9iYWxTbmFwc2hvdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW3RoaXMuSG9zdEluc3RhbmNlLm9wdGlvbnMubmFtZV06IGhvc3RTbmFwc2hvdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gSW4gZHluYW1pYyBsb2FkUmVtb3RlIHNjZW5hcmlvcywgaW5jb21wbGV0ZSByZW1vdGVzSW5mbyBkZWxpdmVyeSBtYXkgb2NjdXIuIEluIHN1Y2ggY2FzZXMsIHRoZSByZW1vdGVzSW5mbyBpbiB0aGUgaG9zdCBuZWVkcyB0byBiZSBjb21wbGV0ZWQgaW4gdGhlIHNuYXBzaG90IGF0IHJ1bnRpbWUuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZW5zdXJlcyB0aGUgc25hcHNob3QncyBpbnRlZ3JpdHkgYW5kIGhlbHBzIHRoZSBjaHJvbWUgcGx1Z2luIGNvcnJlY3RseSBpZGVudGlmeSBhbGwgcHJvZHVjZXIgbW9kdWxlcywgZW5zdXJpbmcgdGhhdCBwcm94eWFibGUgcHJvZHVjZXIgbW9kdWxlcyB3aWxsIG5vdCBiZSBtaXNzaW5nLlxuICAgICAgICAgICAgICAgICAgICBpZiAoaG9zdFNuYXBzaG90ICYmICdyZW1vdGVzSW5mbycgaW4gaG9zdFNuYXBzaG90ICYmICFnZXRJbmZvV2l0aG91dFR5cGUoaG9zdFNuYXBzaG90LnJlbW90ZXNJbmZvLCBtb2R1bGVJbmZvLm5hbWUpLnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ3ZlcnNpb24nIGluIG1vZHVsZUluZm8gfHwgJ2VudHJ5JyBpbiBtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFNuYXBzaG90LnJlbW90ZXNJbmZvID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBob3N0U25hcHNob3QgPT0gbnVsbCA/IHZvaWQgMCA6IGhvc3RTbmFwc2hvdC5yZW1vdGVzSW5mbywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbW9kdWxlSW5mby5uYW1lXToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZFZlcnNpb246ICd2ZXJzaW9uJyBpbiBtb2R1bGVJbmZvID8gbW9kdWxlSW5mby52ZXJzaW9uIDogbW9kdWxlSW5mby5lbnRyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8gPSB0aGlzLmdldEdsb2JhbFJlbW90ZUluZm8obW9kdWxlSW5mbyksIGhvc3RHbG9iYWxTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8uaG9zdEdsb2JhbFNuYXBzaG90LCByZW1vdGVTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8ucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90ID0gX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mby5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5sb2FkU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RHbG9iYWxTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfSksIGdsb2JhbFJlbW90ZVNuYXBzaG90ID0gX3JlZi5yZW1vdGVTbmFwc2hvdCwgZ2xvYmFsU25hcHNob3RSZXMgPSBfcmVmLmdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICB2YXIgbVNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ1NuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAvLyBnbG9iYWwgc25hcHNob3QgaW5jbHVkZXMgbWFuaWZlc3Qgb3IgbW9kdWxlIGluZm8gaW5jbHVkZXMgbWFuaWZlc3RcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdsb2JhbFJlbW90ZVNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2RrLmlzTWFuaWZlc3RQcm92aWRlcihnbG9iYWxSZW1vdGVTbmFwc2hvdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnkgPSBzZGsuaXNCcm93c2VyRW52KCkgPyBnbG9iYWxSZW1vdGVTbmFwc2hvdC5yZW1vdGVFbnRyeSA6IGdsb2JhbFJlbW90ZVNuYXBzaG90LnNzclJlbW90ZUVudHJ5IHx8IGdsb2JhbFJlbW90ZVNuYXBzaG90LnJlbW90ZUVudHJ5IHx8ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2R1bGVTbmFwc2hvdCA9IHlpZWxkIHRoaXMuZ2V0TWFuaWZlc3RKc29uKHJlbW90ZUVudHJ5LCBtb2R1bGVJbmZvLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1zaGFkb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2xvYmFsU25hcHNob3RSZXMxID0gc2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvKHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgbW9kdWxlSW5mbywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZ2xvYmFsIHJlbW90ZSBtYXkgYmUgb3ZlcnJpZGRlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZWZvcmUsIHNldCB0aGUgc25hcHNob3Qga2V5IHRvIHRoZSBnbG9iYWwgYWRkcmVzcyBvZiB0aGUgYWN0dWFsIHJlcXVlc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnk6IHJlbW90ZUVudHJ5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksIG1vZHVsZVNuYXBzaG90KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtU25hcHNob3QgPSBtb2R1bGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU25hcHNob3QgPSBnbG9iYWxTbmFwc2hvdFJlczE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMSA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmxvYWRSZW1vdGVTbmFwc2hvdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IGdsb2JhbFJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAnZ2xvYmFsJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCByZW1vdGVTbmFwc2hvdFJlcyA9IF9yZWYxLnJlbW90ZVNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1TbmFwc2hvdCA9IHJlbW90ZVNuYXBzaG90UmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdTbmFwc2hvdCA9IGdsb2JhbFNuYXBzaG90UmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzUmVtb3RlSW5mb1dpdGhFbnRyeShtb2R1bGVJbmZvKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBmcm9tIG1hbmlmZXN0Lmpzb24gYW5kIG1lcmdlIHJlbW90ZSBpbmZvIGZyb20gcmVtb3RlIHNlcnZlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2R1bGVTbmFwc2hvdDEgPSB5aWVsZCB0aGlzLmdldE1hbmlmZXN0SnNvbihtb2R1bGVJbmZvLmVudHJ5LCBtb2R1bGVJbmZvLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1zaGFkb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2xvYmFsU25hcHNob3RSZXMyID0gc2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvKG1vZHVsZUluZm8sIG1vZHVsZVNuYXBzaG90MSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYyID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUubG9hZFJlbW90ZVNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdDogbW9kdWxlU25hcHNob3QxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAnZ2xvYmFsJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCByZW1vdGVTbmFwc2hvdFJlczEgPSBfcmVmMi5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtU25hcHNob3QgPSByZW1vdGVTbmFwc2hvdFJlczE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NuYXBzaG90ID0gZ2xvYmFsU25hcHNob3RSZXMyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcihlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwNywgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogbW9kdWxlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0VmVyc2lvbjogbW9kdWxlSW5mby52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdDogSlNPTi5zdHJpbmdpZnkoZ2xvYmFsU25hcHNob3RSZXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmFmdGVyTG9hZFNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdDogbVNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IG1TbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNuYXBzaG90OiBnU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZ2V0R2xvYmFsUmVtb3RlSW5mb1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEdsb2JhbFJlbW90ZUluZm8xKG1vZHVsZUluZm8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0R2xvYmFsUmVtb3RlSW5mbyhtb2R1bGVJbmZvLCB0aGlzLkhvc3RJbnN0YW5jZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRNYW5pZmVzdEpzb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRNYW5pZmVzdEpzb24obWFuaWZlc3RVcmwsIG1vZHVsZUluZm8sIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0TWFuaWZlc3QgPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFuaWZlc3RKc29uID0gdGhpcy5tYW5pZmVzdENhY2hlLmdldChtYW5pZmVzdFVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hbmlmZXN0SnNvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWFuaWZlc3RKc29uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0geWllbGQgdGhpcy5sb2FkZXJIb29rLmxpZmVjeWNsZS5mZXRjaC5lbWl0KG1hbmlmZXN0VXJsLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzIHx8ICEocmVzIGluc3RhbmNlb2YgUmVzcG9uc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMgPSB5aWVsZCBmZXRjaChtYW5pZmVzdFVybCwge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0SnNvbiA9IHlpZWxkIHJlcy5qc29uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0SnNvbiA9IHlpZWxkIHRoaXMuSG9zdEluc3RhbmNlLnJlbW90ZUhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLmVycm9yTG9hZFJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBtYW5pZmVzdFVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ3J1bnRpbWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlmZWN5Y2xlOiAnYWZ0ZXJSZXNvbHZlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogdGhpcy5Ib3N0SW5zdGFuY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWFuaWZlc3RKc29uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5tYW5pZmVzdExvYWRpbmdbbWFuaWZlc3RVcmxdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDMsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdFVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVOYW1lOiBtb2R1bGVJbmZvLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGAke2Vycn1gKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1hbmlmZXN0SnNvbi5tZXRhRGF0YSAmJiBtYW5pZmVzdEpzb24uZXhwb3NlcyAmJiBtYW5pZmVzdEpzb24uc2hhcmVkLCBgJHttYW5pZmVzdFVybH0gaXMgbm90IGEgZmVkZXJhdGlvbiBtYW5pZmVzdGApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFuaWZlc3RDYWNoZS5zZXQobWFuaWZlc3RVcmwsIG1hbmlmZXN0SnNvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hbmlmZXN0SnNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhc3luY0xvYWRQcm9jZXNzID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hbmlmZXN0SnNvbiA9IHlpZWxkIGdldE1hbmlmZXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZVNuYXBzaG90ID0gc2RrLmdlbmVyYXRlU25hcHNob3RGcm9tTWFuaWZlc3QobWFuaWZlc3RKc29uLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IG1hbmlmZXN0VXJsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5sb2FkUmVtb3RlU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuSG9zdEluc3RhbmNlLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0SnNvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0VXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAnbWFuaWZlc3QnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksIHJlbW90ZVNuYXBzaG90UmVzID0gX3JlZi5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3RlU25hcHNob3RSZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubWFuaWZlc3RMb2FkaW5nW21hbmlmZXN0VXJsXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdExvYWRpbmdbbWFuaWZlc3RVcmxdID0gYXN5bmNMb2FkUHJvY2VzcygpLnRoZW4oKHJlcyk9PnJlcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWFuaWZlc3RMb2FkaW5nW21hbmlmZXN0VXJsXTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFNuYXBzaG90SGFuZGxlcjtcbn0oKTtcbnZhciBTaGFyZWRIYW5kbGVyID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBTaGFyZWRIYW5kbGVyKGhvc3QpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBTaGFyZWRIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5ob29rcyA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYWZ0ZXJSZXNvbHZlOiBuZXcgQXN5bmNXYXRlcmZhbGxIb29rKCdhZnRlclJlc29sdmUnKSxcbiAgICAgICAgICAgIGJlZm9yZUxvYWRTaGFyZTogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYmVmb3JlTG9hZFNoYXJlJyksXG4gICAgICAgICAgICAvLyBub3QgdXNlZCB5ZXRcbiAgICAgICAgICAgIGxvYWRTaGFyZTogbmV3IEFzeW5jSG9vaygpLFxuICAgICAgICAgICAgcmVzb2x2ZVNoYXJlOiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ3Jlc29sdmVTaGFyZScpLFxuICAgICAgICAgICAgLy8gbWF5YmUgd2lsbCBjaGFuZ2UsIHRlbXBvcmFyaWx5IGZvciBpbnRlcm5hbCB1c2Ugb25seVxuICAgICAgICAgICAgaW5pdENvbnRhaW5lclNoYXJlU2NvcGVNYXA6IG5ldyBTeW5jV2F0ZXJmYWxsSG9vaygnaW5pdENvbnRhaW5lclNoYXJlU2NvcGVNYXAnKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDtcbiAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwID0ge307XG4gICAgICAgIHRoaXMuaW5pdFRva2VucyA9IHt9O1xuICAgICAgICB0aGlzLl9zZXRHbG9iYWxTaGFyZVNjb3BlTWFwKGhvc3Qub3B0aW9ucyk7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTaGFyZWRIYW5kbGVyLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIHJlZ2lzdGVyIHNoYXJlZCBpbiBzaGFyZVNjb3BlTWFwXG4gICAgICAgICAgICBrZXk6IFwicmVnaXN0ZXJTaGFyZWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlclNoYXJlZChnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBfZm9ybWF0U2hhcmVDb25maWdzID0gZm9ybWF0U2hhcmVDb25maWdzKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKSwgc2hhcmVJbmZvcyA9IF9mb3JtYXRTaGFyZUNvbmZpZ3Muc2hhcmVJbmZvcywgc2hhcmVkID0gX2Zvcm1hdFNoYXJlQ29uZmlncy5zaGFyZWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlZEtleXMgPSBPYmplY3Qua2V5cyhzaGFyZUluZm9zKTtcbiAgICAgICAgICAgICAgICBzaGFyZWRLZXlzLmZvckVhY2goKHNoYXJlZEtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlZFZhbHMgPSBzaGFyZUluZm9zW3NoYXJlZEtleV07XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZFZhbHMuZm9yRWFjaCgoc2hhcmVkVmFsKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUodGhpcy5zaGFyZVNjb3BlTWFwLCBzaGFyZWRLZXksIHNoYXJlZFZhbCwgdGhpcy5ob29rcy5saWZlY3ljbGUucmVzb2x2ZVNoYXJlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVnaXN0ZXJlZFNoYXJlZCAmJiBzaGFyZWRWYWwgJiYgc2hhcmVkVmFsLmxpYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2hhcmVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZTogc2hhcmVkS2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWI6IHNoYXJlZFZhbC5saWIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldDogc2hhcmVkVmFsLmdldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHNoYXJlZFZhbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogdXNlck9wdGlvbnMubmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9zLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZWRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNoYXJlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFNoYXJlKHBrZ05hbWUsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBmdW5jdGlvbiBwZXJmb3JtcyB0aGUgZm9sbG93aW5nIHN0ZXBzOlxuICAgICAgICAgICAgICAgICAgICAvLyAxLiBDaGVja3MgaWYgdGhlIGN1cnJlbnRseSBsb2FkZWQgc2hhcmUgYWxyZWFkeSBleGlzdHMsIGlmIG5vdCwgaXQgdGhyb3dzIGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgIC8vIDIuIFNlYXJjaGVzIGdsb2JhbGx5IGZvciBhIG1hdGNoaW5nIHNoYXJlLCBpZiBmb3VuZCwgaXQgdXNlcyBpdCBkaXJlY3RseVxuICAgICAgICAgICAgICAgICAgICAvLyAzLiBJZiBub3QgZm91bmQsIGl0IHJldHJpZXZlcyBpdCBmcm9tIHRoZSBjdXJyZW50IHNoYXJlIGFuZCBzdG9yZXMgdGhlIG9idGFpbmVkIHNoYXJlIGdsb2JhbGx5LlxuICAgICAgICAgICAgICAgICAgICB2YXIgc2hhcmVJbmZvID0gZ2V0VGFyZ2V0U2hhcmVkT3B0aW9ucyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvczogaG9zdC5vcHRpb25zLnNoYXJlZFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mbyA9PSBudWxsID8gdm9pZCAwIDogc2hhcmVJbmZvLnNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBQcm9taXNlLmFsbChzaGFyZUluZm8uc2NvcGUubWFwKChzaGFyZVNjb3BlKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgUHJvbWlzZS5hbGwodGhpcy5pbml0aWFsaXplU2hhcmluZyhzaGFyZVNjb3BlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJhdGVneTogc2hhcmVJbmZvLnN0cmF0ZWd5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcykpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFNoYXJlUmVzID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlTG9hZFNoYXJlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogaG9zdC5vcHRpb25zLnNoYXJlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlSW5mb1JlcyA9IGxvYWRTaGFyZVJlcy5zaGFyZUluZm87XG4gICAgICAgICAgICAgICAgICAgIC8vIEFzc2VydCB0aGF0IHNoYXJlSW5mb1JlcyBleGlzdHMsIGlmIG5vdCwgdGhyb3cgYW4gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHNoYXJlSW5mb1JlcywgYENhbm5vdCBmaW5kICR7cGtnTmFtZX0gU2hhcmUgaW4gdGhlICR7aG9zdC5vcHRpb25zLm5hbWV9LiBQbGVhc2UgZW5zdXJlIHRoYXQgdGhlICR7cGtnTmFtZX0gU2hhcmUgcGFyYW1ldGVycyBoYXZlIGJlZW4gaW5qZWN0ZWRgKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmV0cmlldmUgZnJvbSBjYWNoZVxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVnaXN0ZXJlZFNoYXJlZCA9IGdldFJlZ2lzdGVyZWRTaGFyZSh0aGlzLnNoYXJlU2NvcGVNYXAsIHBrZ05hbWUsIHNoYXJlSW5mb1JlcywgdGhpcy5ob29rcy5saWZlY3ljbGUucmVzb2x2ZVNoYXJlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFkZFVzZUluID0gKHNoYXJlZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2hhcmVkLnVzZUluKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkLnVzZUluID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRVbmlxdWVJdGVtKHNoYXJlZC51c2VJbiwgaG9zdC5vcHRpb25zLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVnaXN0ZXJlZFNoYXJlZCAmJiByZWdpc3RlcmVkU2hhcmVkLmxpYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4ocmVnaXN0ZXJlZFNoYXJlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnaXN0ZXJlZFNoYXJlZC5saWI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVnaXN0ZXJlZFNoYXJlZCAmJiByZWdpc3RlcmVkU2hhcmVkLmxvYWRpbmcgJiYgIXJlZ2lzdGVyZWRTaGFyZWQubG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFjdG9yeSA9IHlpZWxkIHJlZ2lzdGVyZWRTaGFyZWQubG9hZGluZztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyZWRTaGFyZWQubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVnaXN0ZXJlZFNoYXJlZC5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWdpc3RlcmVkU2hhcmVkLmxpYiA9IGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRVc2VJbihyZWdpc3RlcmVkU2hhcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlZ2lzdGVyZWRTaGFyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3luY0xvYWRQcm9jZXNzID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWN0b3J5ID0geWllbGQgcmVnaXN0ZXJlZFNoYXJlZC5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvUmVzLmxpYiA9IGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb1Jlcy5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRVc2VJbihzaGFyZUluZm9SZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ1NoYXJlZCA9IGdldFJlZ2lzdGVyZWRTaGFyZSh0aGlzLnNoYXJlU2NvcGVNYXAsIHBrZ05hbWUsIHNoYXJlSW5mb1JlcywgdGhpcy5ob29rcy5saWZlY3ljbGUucmVzb2x2ZVNoYXJlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdTaGFyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdTaGFyZWQubGliID0gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdTaGFyZWQubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRpbmcgPSBhc3luY0xvYWRQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNoYXJlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogcmVnaXN0ZXJlZFNoYXJlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWI6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9hZGluZztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5jdXN0b21TaGFyZUluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXN5bmNMb2FkUHJvY2VzczEgPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhY3RvcnkgPSB5aWVsZCBzaGFyZUluZm9SZXMuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb1Jlcy5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9SZXMubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4oc2hhcmVJbmZvUmVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUodGhpcy5zaGFyZVNjb3BlTWFwLCBwa2dOYW1lLCBzaGFyZUluZm9SZXMsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU2hhcmVkLmxpYiA9IGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU2hhcmVkLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2FkaW5nMSA9IGFzeW5jTG9hZFByb2Nlc3MxKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNoYXJlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogc2hhcmVJbmZvUmVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IGhvc3Qub3B0aW9ucy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nOiBsb2FkaW5nMVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9hZGluZzE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogVGhpcyBmdW5jdGlvbiBpbml0aWFsaXplcyB0aGUgc2hhcmluZyBzZXF1ZW5jZSAoZXhlY3V0ZWQgb25seSBvbmNlIHBlciBzaGFyZSBzY29wZSkuXG4gICAqIEl0IGFjY2VwdHMgb25lIGFyZ3VtZW50LCB0aGUgbmFtZSBvZiB0aGUgc2hhcmUgc2NvcGUuXG4gICAqIElmIHRoZSBzaGFyZSBzY29wZSBkb2VzIG5vdCBleGlzdCwgaXQgY3JlYXRlcyBvbmUuXG4gICAqLyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAga2V5OiBcImluaXRpYWxpemVTaGFyaW5nXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZVNoYXJpbmcocmVmLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2hhcmVTY29wZU5hbWUgPSByZWYgPT09IHZvaWQgMCA/IERFRkFVTFRfU0NPUEUgOiByZWY7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgdmFyIGZyb20gPSBleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5mcm9tO1xuICAgICAgICAgICAgICAgIHZhciBzdHJhdGVneSA9IGV4dHJhT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZXh0cmFPcHRpb25zLnN0cmF0ZWd5O1xuICAgICAgICAgICAgICAgIHZhciBpbml0U2NvcGUgPSBleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5pbml0U2NvcGU7XG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2VzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGZyb20gIT09ICdidWlsZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRUb2tlbnMgPSB0aGlzLmluaXRUb2tlbnM7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaW5pdFNjb3BlKSBpbml0U2NvcGUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRUb2tlbiA9IGluaXRUb2tlbnNbc2hhcmVTY29wZU5hbWVdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWluaXRUb2tlbikgaW5pdFRva2VuID0gaW5pdFRva2Vuc1tzaGFyZVNjb3BlTmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiB0aGlzLmhvc3QubmFtZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5pdFNjb3BlLmluZGV4T2YoaW5pdFRva2VuKSA+PSAwKSByZXR1cm4gcHJvbWlzZXM7XG4gICAgICAgICAgICAgICAgICAgIGluaXRTY29wZS5wdXNoKGluaXRUb2tlbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlID0gdGhpcy5zaGFyZVNjb3BlTWFwO1xuICAgICAgICAgICAgICAgIHZhciBob3N0TmFtZSA9IGhvc3Qub3B0aW9ucy5uYW1lO1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZXMgYSBuZXcgc2hhcmUgc2NvcGUgaWYgbmVjZXNzYXJ5XG4gICAgICAgICAgICAgICAgaWYgKCFzaGFyZVNjb3BlW3NoYXJlU2NvcGVOYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICBzaGFyZVNjb3BlW3NoYXJlU2NvcGVOYW1lXSA9IHt9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBFeGVjdXRlcyBhbGwgaW5pdGlhbGl6YXRpb24gc25pcHBldHMgZnJvbSBhbGwgYWNjZXNzaWJsZSBtb2R1bGVzXG4gICAgICAgICAgICAgICAgdmFyIHNjb3BlID0gc2hhcmVTY29wZVtzaGFyZVNjb3BlTmFtZV07XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyID0gKG5hbWUxLCBzaGFyZWQpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYWN0aXZlVmVyc2lvbl9zaGFyZUNvbmZpZztcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZlcnNpb24gPSBzaGFyZWQudmVyc2lvbiwgZWFnZXIgPSBzaGFyZWQuZWFnZXI7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlW25hbWUxXSA9IHNjb3BlW25hbWUxXSB8fCB7fTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZlcnNpb25zID0gc2NvcGVbbmFtZTFdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlVmVyc2lvbiA9IHZlcnNpb25zW3ZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlVmVyc2lvbkVhZ2VyID0gQm9vbGVhbihhY3RpdmVWZXJzaW9uICYmIChhY3RpdmVWZXJzaW9uLmVhZ2VyIHx8ICgoX2FjdGl2ZVZlcnNpb25fc2hhcmVDb25maWcgPSBhY3RpdmVWZXJzaW9uLnNoYXJlQ29uZmlnKSA9PSBudWxsID8gdm9pZCAwIDogX2FjdGl2ZVZlcnNpb25fc2hhcmVDb25maWcuZWFnZXIpKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYWN0aXZlVmVyc2lvbiB8fCBhY3RpdmVWZXJzaW9uLnN0cmF0ZWd5ICE9PSAnbG9hZGVkLWZpcnN0JyAmJiAhYWN0aXZlVmVyc2lvbi5sb2FkZWQgJiYgKEJvb2xlYW4oIWVhZ2VyKSAhPT0gIWFjdGl2ZVZlcnNpb25FYWdlciA/IGVhZ2VyIDogaG9zdE5hbWUgPiBhY3RpdmVWZXJzaW9uLmZyb20pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uc1t2ZXJzaW9uXSA9IHNoYXJlZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGluaXRGbiA9IChtb2QpPT5tb2QgJiYgbW9kLmluaXQgJiYgbW9kLmluaXQoc2hhcmVTY29wZVtzaGFyZVNjb3BlTmFtZV0sIGluaXRTY29wZSk7XG4gICAgICAgICAgICAgICAgdmFyIGluaXRSZW1vdGVNb2R1bGUgPSAoa2V5KT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2R1bGUgPSAoeWllbGQgaG9zdC5yZW1vdGVIYW5kbGVyLmdldFJlbW90ZU1vZHVsZUFuZE9wdGlvbnMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBrZXlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKS5tb2R1bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kdWxlLmdldEVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHMgPSB5aWVsZCBtb2R1bGUuZ2V0RW50cnkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHMgPSB5aWVsZCBob3N0LnJlbW90ZUhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLmVycm9yTG9hZFJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBrZXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJ2JlZm9yZUxvYWRTaGFyZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbW9kdWxlLmluaXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBpbml0Rm4ocmVtb3RlRW50cnlFeHBvcnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlLmluaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KSgpO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGhvc3Qub3B0aW9ucy5zaGFyZWQpLmZvckVhY2goKHNoYXJlTmFtZSk9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlZEFyciA9IGhvc3Qub3B0aW9ucy5zaGFyZWRbc2hhcmVOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkQXJyLmZvckVhY2goKHNoYXJlZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWQuc2NvcGUuaW5jbHVkZXMoc2hhcmVTY29wZU5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXIoc2hhcmVOYW1lLCBzaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBzdHJhdGVneT09PSd2ZXJzaW9uLWZpcnN0JyBuZWVkIHRvIGJlIHJlbW92ZWQgaW4gdGhlIGZ1dHVyZVxuICAgICAgICAgICAgICAgIGlmIChob3N0Lm9wdGlvbnMuc2hhcmVTdHJhdGVneSA9PT0gJ3ZlcnNpb24tZmlyc3QnIHx8IHN0cmF0ZWd5ID09PSAndmVyc2lvbi1maXJzdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaG9zdC5vcHRpb25zLnJlbW90ZXMuZm9yRWFjaCgocmVtb3RlKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZS5zaGFyZVNjb3BlID09PSBzaGFyZVNjb3BlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goaW5pdFJlbW90ZU1vZHVsZShyZW1vdGUubmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBUaGUgbGliIGZ1bmN0aW9uIHdpbGwgb25seSBiZSBhdmFpbGFibGUgaWYgdGhlIHNoYXJlZCBzZXQgYnkgZWFnZXIgb3IgcnVudGltZSBpbml0IGlzIHNldCBvciB0aGUgc2hhcmVkIGlzIHN1Y2Nlc3NmdWxseSBsb2FkZWQuXG4gICAgICAgICAgICAvLyAxLiBJZiB0aGUgbG9hZGVkIHNoYXJlZCBhbHJlYWR5IGV4aXN0cyBnbG9iYWxseSwgdGhlbiBpdCB3aWxsIGJlIHJldXNlZFxuICAgICAgICAgICAgLy8gMi4gSWYgbGliIGV4aXN0cyBpbiBsb2NhbCBzaGFyZWQsIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseVxuICAgICAgICAgICAgLy8gMy4gSWYgdGhlIGxvY2FsIGdldCByZXR1cm5zIHNvbWV0aGluZyBvdGhlciB0aGFuIFByb21pc2UsIHRoZW4gaXQgd2lsbCBiZSB1c2VkIGRpcmVjdGx5XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNoYXJlU3luY1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTaGFyZVN5bmMocGtnTmFtZSwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlSW5mbyA9IGdldFRhcmdldFNoYXJlZE9wdGlvbnMoe1xuICAgICAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgICAgICBleHRyYU9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb3M6IGhvc3Qub3B0aW9ucy5zaGFyZWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoc2hhcmVJbmZvID09IG51bGwgPyB2b2lkIDAgOiBzaGFyZUluZm8uc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvLnNjb3BlLmZvckVhY2goKHNoYXJlU2NvcGUpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVTaGFyaW5nKHNoYXJlU2NvcGUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJhdGVneTogc2hhcmVJbmZvLnN0cmF0ZWd5XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZWdpc3RlcmVkU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKHRoaXMuc2hhcmVTY29wZU1hcCwgcGtnTmFtZSwgc2hhcmVJbmZvLCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5yZXNvbHZlU2hhcmUpO1xuICAgICAgICAgICAgICAgIHZhciBhZGRVc2VJbiA9IChzaGFyZWQpPT57XG4gICAgICAgICAgICAgICAgICAgIGlmICghc2hhcmVkLnVzZUluKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQudXNlSW4gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhZGRVbmlxdWVJdGVtKHNoYXJlZC51c2VJbiwgaG9zdC5vcHRpb25zLm5hbWUpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2lzdGVyZWRTaGFyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZWdpc3RlcmVkU2hhcmVkLmxpYiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4ocmVnaXN0ZXJlZFNoYXJlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlZ2lzdGVyZWRTaGFyZWQubG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJlZFNoYXJlZC5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWdpc3RlcmVkU2hhcmVkLmZyb20gPT09IGhvc3Qub3B0aW9ucy5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mby5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdpc3RlcmVkU2hhcmVkLmxpYjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlZ2lzdGVyZWRTaGFyZWQuZ2V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gcmVnaXN0ZXJlZFNoYXJlZC5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG1vZHVsZSBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4ocmVnaXN0ZXJlZFNoYXJlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTaGFyZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IGhvc3Qub3B0aW9ucy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWI6IG1vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkOiByZWdpc3RlcmVkU2hhcmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2hhcmVJbmZvLmxpYikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNoYXJlSW5mby5sb2FkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mby5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzaGFyZUluZm8ubGliO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2hhcmVJbmZvLmdldCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlMSA9IHNoYXJlSW5mby5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vZHVsZTEgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3JDb2RlID0gKGV4dHJhT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZXh0cmFPcHRpb25zLmZyb20pID09PSAnYnVpbGQnID8gZXJyb3JDb2Rlcy5SVU5USU1FXzAwNSA6IGVycm9yQ29kZXMuUlVOVElNRV8wMDY7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZSwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3ROYW1lOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWRQa2dOYW1lOiBwa2dOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvLmxpYiA9IG1vZHVsZTE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2hhcmVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpYjogc2hhcmVJbmZvLmxpYixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogc2hhcmVJbmZvXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hhcmVJbmZvLmxpYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDA2LCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgICAgIGhvc3ROYW1lOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkUGtnTmFtZTogcGtnTmFtZVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImluaXRTaGFyZVNjb3BlTWFwXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFNoYXJlU2NvcGVNYXAoc2NvcGVOYW1lLCBzaGFyZVNjb3BlLCByZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXh0cmFPcHRpb25zID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NvcGVOYW1lXSA9IHNoYXJlU2NvcGU7XG4gICAgICAgICAgICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuaW5pdENvbnRhaW5lclNoYXJlU2NvcGVNYXAuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IGhvc3Qub3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0LFxuICAgICAgICAgICAgICAgICAgICBzY29wZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGhvc3RTaGFyZVNjb3BlTWFwOiBleHRyYU9wdGlvbnMuaG9zdFNoYXJlU2NvcGVNYXBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInNldFNoYXJlZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFNoYXJlZChyZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGtnTmFtZSA9IHJlZi5wa2dOYW1lLCBzaGFyZWQgPSByZWYuc2hhcmVkLCBmcm9tID0gcmVmLmZyb20sIGxpYiA9IHJlZi5saWIsIGxvYWRpbmcgPSByZWYubG9hZGluZywgbG9hZGVkID0gcmVmLmxvYWRlZCwgZ2V0ID0gcmVmLmdldDtcbiAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbiA9IHNoYXJlZC52ZXJzaW9uLCBfc2hhcmVkX3Njb3BlID0gc2hhcmVkLnNjb3BlLCBzY29wZSA9IF9zaGFyZWRfc2NvcGUgPT09IHZvaWQgMCA/ICdkZWZhdWx0JyA6IF9zaGFyZWRfc2NvcGUsIHNoYXJlSW5mbyA9IHBvbHlmaWxscy5fb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllc19sb29zZShzaGFyZWQsIFtcbiAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic2NvcGVcIlxuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIHZhciBzY29wZXMgPSBBcnJheS5pc0FycmF5KHNjb3BlKSA/IHNjb3BlIDogW1xuICAgICAgICAgICAgICAgICAgICBzY29wZVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgc2NvcGVzLmZvckVhY2goKHNjKT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2hhcmVTY29wZU1hcFtzY10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVTY29wZU1hcFtzY10gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV0gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV1bdmVyc2lvbl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV1bdmVyc2lvbl0gPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RlZmF1bHQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgc2hhcmVJbmZvLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dLmdldCA9IGdldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVnaXN0ZXJlZFNoYXJlZCA9IHRoaXMuc2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV1bdmVyc2lvbl07XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nICYmICFyZWdpc3RlcmVkU2hhcmVkLmxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyZWRTaGFyZWQubG9hZGluZyA9IGxvYWRpbmc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcIl9zZXRHbG9iYWxTaGFyZVNjb3BlTWFwXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NldEdsb2JhbFNoYXJlU2NvcGVNYXAoaG9zdE9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZ2xvYmFsU2hhcmVTY29wZU1hcCA9IGdldEdsb2JhbFNoYXJlU2NvcGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgaWRlbnRpZmllciA9IGhvc3RPcHRpb25zLmlkIHx8IGhvc3RPcHRpb25zLm5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKGlkZW50aWZpZXIgJiYgIWdsb2JhbFNoYXJlU2NvcGVNYXBbaWRlbnRpZmllcl0pIHtcbiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU2hhcmVTY29wZU1hcFtpZGVudGlmaWVyXSA9IHRoaXMuc2hhcmVTY29wZU1hcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gU2hhcmVkSGFuZGxlcjtcbn0oKTtcbnZhciBSZW1vdGVIYW5kbGVyID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBSZW1vdGVIYW5kbGVyKGhvc3QpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBSZW1vdGVIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5ob29rcyA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYmVmb3JlUmVnaXN0ZXJSZW1vdGU6IG5ldyBTeW5jV2F0ZXJmYWxsSG9vaygnYmVmb3JlUmVnaXN0ZXJSZW1vdGUnKSxcbiAgICAgICAgICAgIHJlZ2lzdGVyUmVtb3RlOiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ3JlZ2lzdGVyUmVtb3RlJyksXG4gICAgICAgICAgICBiZWZvcmVSZXF1ZXN0OiBuZXcgQXN5bmNXYXRlcmZhbGxIb29rKCdiZWZvcmVSZXF1ZXN0JyksXG4gICAgICAgICAgICBvbkxvYWQ6IG5ldyBBc3luY0hvb2soJ29uTG9hZCcpLFxuICAgICAgICAgICAgaGFuZGxlUHJlbG9hZE1vZHVsZTogbmV3IFN5bmNIb29rKCdoYW5kbGVQcmVsb2FkTW9kdWxlJyksXG4gICAgICAgICAgICBlcnJvckxvYWRSZW1vdGU6IG5ldyBBc3luY0hvb2soJ2Vycm9yTG9hZFJlbW90ZScpLFxuICAgICAgICAgICAgYmVmb3JlUHJlbG9hZFJlbW90ZTogbmV3IEFzeW5jSG9vaygnYmVmb3JlUHJlbG9hZFJlbW90ZScpLFxuICAgICAgICAgICAgZ2VuZXJhdGVQcmVsb2FkQXNzZXRzOiBuZXcgQXN5bmNIb29rKCdnZW5lcmF0ZVByZWxvYWRBc3NldHMnKSxcbiAgICAgICAgICAgIC8vIG5vdCB1c2VkIHlldFxuICAgICAgICAgICAgYWZ0ZXJQcmVsb2FkUmVtb3RlOiBuZXcgQXN5bmNIb29rKCksXG4gICAgICAgICAgICBsb2FkRW50cnk6IG5ldyBBc3luY0hvb2soKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDtcbiAgICAgICAgdGhpcy5pZFRvUmVtb3RlTWFwID0ge307XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhSZW1vdGVIYW5kbGVyLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJmb3JtYXRBbmRSZWdpc3RlclJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZvcm1hdEFuZFJlZ2lzdGVyUmVtb3RlKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVzZXJSZW1vdGVzID0gdXNlck9wdGlvbnMucmVtb3RlcyB8fCBbXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlclJlbW90ZXMucmVkdWNlKChyZXMsIHJlbW90ZSk9PntcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlclJlbW90ZShyZW1vdGUsIHJlcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2U6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgIH0sIGdsb2JhbE9wdGlvbnMucmVtb3Rlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJzZXRJZFRvUmVtb3RlTWFwXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0SWRUb1JlbW90ZU1hcChpZCwgcmVtb3RlTWF0Y2hJbmZvKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZSA9IHJlbW90ZU1hdGNoSW5mby5yZW1vdGUsIGV4cG9zZSA9IHJlbW90ZU1hdGNoSW5mby5leHBvc2U7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUxID0gcmVtb3RlLm5hbWUsIGFsaWFzID0gcmVtb3RlLmFsaWFzO1xuICAgICAgICAgICAgICAgIHRoaXMuaWRUb1JlbW90ZU1hcFtpZF0gPSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBleHBvc2VcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChhbGlhcyAmJiBpZC5zdGFydHNXaXRoKG5hbWUxKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWRXaXRoQWxpYXMgPSBpZC5yZXBsYWNlKG5hbWUxLCBhbGlhcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaWRUb1JlbW90ZU1hcFtpZFdpdGhBbGlhc10gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhbGlhcyAmJiBpZC5zdGFydHNXaXRoKGFsaWFzKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWRXaXRoTmFtZSA9IGlkLnJlcGxhY2UoYWxpYXMsIG5hbWUxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pZFRvUmVtb3RlTWFwW2lkV2l0aE5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2FkUmVtb3RlXCIsXG4gICAgICAgICAgICB2YWx1ZTogLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1saW5lcy1wZXItZnVuY3Rpb25cbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbWVtYmVyLW9yZGVyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2FkUmVtb3RlKGlkLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBvcHRpb25zIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkRmFjdG9yeTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgX3JlZl9sb2FkRmFjdG9yeSA9IF9yZWYubG9hZEZhY3RvcnksIGxvYWRGYWN0b3J5ID0gX3JlZl9sb2FkRmFjdG9yeSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWZfbG9hZEZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAxLiBWYWxpZGF0ZSB0aGUgcGFyYW1ldGVycyBvZiB0aGUgcmV0cmlldmVkIG1vZHVsZS4gVGhlcmUgYXJlIHR3byBtb2R1bGUgcmVxdWVzdCBtZXRob2RzOiBwa2dOYW1lICsgZXhwb3NlIGFuZCBhbGlhcyArIGV4cG9zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDIuIFJlcXVlc3QgdGhlIHNuYXBzaG90IGluZm9ybWF0aW9uIG9mIHRoZSBjdXJyZW50IGhvc3QgYW5kIGdsb2JhbGx5IHN0b3JlIHRoZSBvYnRhaW5lZCBzbmFwc2hvdCBpbmZvcm1hdGlvbi4gVGhlIHJldHJpZXZlZCBtb2R1bGUgaW5mb3JtYXRpb24gaXMgcGFydGlhbGx5IG9mZmxpbmUgYW5kIHBhcnRpYWxseSBvbmxpbmUuIFRoZSBvbmxpbmUgbW9kdWxlIGluZm9ybWF0aW9uIHdpbGwgcmV0cmlldmUgdGhlIG1vZHVsZXMgdXNlZCBvbmxpbmUuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAzLiBSZXRyaWV2ZSB0aGUgZGV0YWlsZWQgaW5mb3JtYXRpb24gb2YgdGhlIGN1cnJlbnQgbW9kdWxlIGZyb20gZ2xvYmFsIChyZW1vdGVFbnRyeSBhZGRyZXNzLCBleHBvc2UgcmVzb3VyY2UgYWRkcmVzcylcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDQuIEFmdGVyIHJldHJpZXZpbmcgcmVtb3RlRW50cnksIGNhbGwgdGhlIGluaXQgb2YgdGhlIG1vZHVsZSwgYW5kIHRoZW4gcmV0cmlldmUgdGhlIGV4cG9ydGVkIGNvbnRlbnQgb2YgdGhlIG1vZHVsZSB0aHJvdWdoIGdldFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWQ6IHBrZ05hbWUoQGZlZGVyYXRpb24vYXBwMSkgKyBleHBvc2UoYnV0dG9uKSA9IEBmZWRlcmF0aW9uL2FwcDEvYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZDogYWxpYXMoYXBwMSkgKyBleHBvc2UoYnV0dG9uKSA9IGFwcDEvYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZDogYWxpYXMoYXBwMS91dGlscykgKyBleHBvc2UobG9hZGFzaC9zb3J0KSA9IGFwcDEvdXRpbHMvbG9hZGFzaC9zb3J0XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjEgPSB5aWVsZCB0aGlzLmdldFJlbW90ZU1vZHVsZUFuZE9wdGlvbnMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSwgbW9kdWxlID0gX3JlZjEubW9kdWxlLCBtb2R1bGVPcHRpb25zID0gX3JlZjEubW9kdWxlT3B0aW9ucywgcmVtb3RlTWF0Y2hJbmZvID0gX3JlZjEucmVtb3RlTWF0Y2hJbmZvO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBrZ05hbWVPckFsaWFzID0gcmVtb3RlTWF0Y2hJbmZvLnBrZ05hbWVPckFsaWFzLCByZW1vdGUgPSByZW1vdGVNYXRjaEluZm8ucmVtb3RlLCBleHBvc2UgPSByZW1vdGVNYXRjaEluZm8uZXhwb3NlLCBpZFJlcyA9IHJlbW90ZU1hdGNoSW5mby5pZCwgcmVtb3RlU25hcHNob3QgPSByZW1vdGVNYXRjaEluZm8ucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlT3JGYWN0b3J5ID0geWllbGQgbW9kdWxlLmdldChpZFJlcywgZXhwb3NlLCBvcHRpb25zLCByZW1vdGVTbmFwc2hvdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlV3JhcHBlciA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLm9uTG9hZC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaWRSZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZU9yQWxpYXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZU1vZHVsZTogbG9hZEZhY3RvcnkgPyBtb2R1bGVPckZhY3RvcnkgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlTW9kdWxlRmFjdG9yeTogbG9hZEZhY3RvcnkgPyB1bmRlZmluZWQgOiBtb2R1bGVPckZhY3RvcnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IG1vZHVsZU9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5zdGFuY2U6IG1vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRJZFRvUmVtb3RlTWFwKGlkLCByZW1vdGVNYXRjaEluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtb2R1bGVXcmFwcGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVdyYXBwZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kdWxlT3JGYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYyID0gb3B0aW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ3J1bnRpbWUnXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBfcmVmX2Zyb20gPSBfcmVmMi5mcm9tLCBmcm9tID0gX3JlZl9mcm9tID09PSB2b2lkIDAgPyAncnVudGltZScgOiBfcmVmX2Zyb207XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbE92ZXIgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5lcnJvckxvYWRSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZlY3ljbGU6ICdvbkxvYWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZhaWxPdmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFpbE92ZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicHJlbG9hZFJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbWVtYmVyLW9yZGVyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBwcmVsb2FkUmVtb3RlKHByZWxvYWRPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVQcmVsb2FkUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJlbG9hZE9wczogcHJlbG9hZE9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmVsb2FkT3BzID0gZm9ybWF0UHJlbG9hZEFyZ3MoaG9zdC5vcHRpb25zLnJlbW90ZXMsIHByZWxvYWRPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgUHJvbWlzZS5hbGwocHJlbG9hZE9wcy5tYXAoKG9wcyk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZSA9IG9wcy5yZW1vdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBnZXRSZW1vdGVJbmZvKHJlbW90ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSB5aWVsZCBob3N0LnNuYXBzaG90SGFuZGxlci5sb2FkUmVtb3RlU25hcHNob3RJbmZvKHJlbW90ZSksIGdsb2JhbFNuYXBzaG90ID0gX3JlZi5nbG9iYWxTbmFwc2hvdCwgcmVtb3RlU25hcHNob3QgPSBfcmVmLnJlbW90ZVNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NldHMgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5nZW5lcmF0ZVByZWxvYWRBc3NldHMuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlbG9hZE9wdGlvbnM6IG9wcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFzc2V0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRBc3NldHMocmVtb3RlSW5mbywgaG9zdCwgYXNzZXRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcykpKTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVnaXN0ZXJSZW1vdGVzXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJSZW1vdGVzKHJlbW90ZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICByZW1vdGVzLmZvckVhY2goKHJlbW90ZSk9PntcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlclJlbW90ZShyZW1vdGUsIGhvc3Qub3B0aW9ucy5yZW1vdGVzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JjZTogb3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5mb3JjZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldFJlbW90ZU1vZHVsZUFuZE9wdGlvbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zKG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IG9wdGlvbnMuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkUmVtb3RlQXJncztcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRSZW1vdGVBcmdzID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlUmVxdWVzdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRSZW1vdGVBcmdzID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuZXJyb3JMb2FkUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IGhvc3Qub3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ3J1bnRpbWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJ2JlZm9yZVJlcXVlc3QnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbG9hZFJlbW90ZUFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRSZXMgPSBsb2FkUmVtb3RlQXJncy5pZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZVNwbGl0SW5mbyA9IG1hdGNoUmVtb3RlV2l0aE5hbWVBbmRFeHBvc2UoaG9zdC5vcHRpb25zLnJlbW90ZXMsIGlkUmVzKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHJlbW90ZVNwbGl0SW5mbywgZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDQsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3ROYW1lOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RJZDogaWRSZXNcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmF3UmVtb3RlID0gcmVtb3RlU3BsaXRJbmZvLnJlbW90ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBnZXRSZW1vdGVJbmZvKHJhd1JlbW90ZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaEluZm8gPSB5aWVsZCBob3N0LnNoYXJlZEhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLmFmdGVyUmVzb2x2ZS5lbWl0KHBvbHlmaWxscy5fZXh0ZW5kcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogaWRSZXNcbiAgICAgICAgICAgICAgICAgICAgfSwgcmVtb3RlU3BsaXRJbmZvLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZSA9IG1hdGNoSW5mby5yZW1vdGUsIGV4cG9zZSA9IG1hdGNoSW5mby5leHBvc2U7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChyZW1vdGUgJiYgZXhwb3NlLCBgVGhlICdiZWZvcmVSZXF1ZXN0JyBob29rIHdhcyBleGVjdXRlZCwgYnV0IGl0IGZhaWxlZCB0byByZXR1cm4gdGhlIGNvcnJlY3QgJ3JlbW90ZScgYW5kICdleHBvc2UnIHZhbHVlcyB3aGlsZSBsb2FkaW5nICR7aWRSZXN9LmApO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gaG9zdC5tb2R1bGVDYWNoZS5nZXQocmVtb3RlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3Q6IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmICghbW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGUgPSBuZXcgTW9kdWxlKG1vZHVsZU9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5tb2R1bGVDYWNoZS5zZXQocmVtb3RlLm5hbWUsIG1vZHVsZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZU9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVNYXRjaEluZm86IG1hdGNoSW5mb1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZWdpc3RlclJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyUmVtb3RlKHJlbW90ZSwgdGFyZ2V0UmVtb3Rlcywgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgIHZhciBub3JtYWxpemVSZW1vdGUgPSAoKT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3RlLmFsaWFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBWYWxpZGF0ZSBpZiBhbGlhcyBlcXVhbHMgdGhlIHByZWZpeCBvZiByZW1vdGUubmFtZSBhbmQgcmVtb3RlLmFsaWFzLCBpZiBzbywgdGhyb3cgYW4gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFzIG11bHRpLWxldmVsIHBhdGggcmVmZXJlbmNlcyBjYW5ub3QgZ3VhcmFudGVlIHVuaXF1ZSBuYW1lcywgYWxpYXMgYmVpbmcgYSBwcmVmaXggb2YgcmVtb3RlLm5hbWUgaXMgbm90IHN1cHBvcnRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmRFcXVhbCA9IHRhcmdldFJlbW90ZXMuZmluZCgoaXRlbSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2l0ZW1fYWxpYXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbW90ZS5hbGlhcyAmJiAoaXRlbS5uYW1lLnN0YXJ0c1dpdGgocmVtb3RlLmFsaWFzKSB8fCAoKF9pdGVtX2FsaWFzID0gaXRlbS5hbGlhcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9pdGVtX2FsaWFzLnN0YXJ0c1dpdGgocmVtb3RlLmFsaWFzKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoIWZpbmRFcXVhbCwgYFRoZSBhbGlhcyAke3JlbW90ZS5hbGlhc30gb2YgcmVtb3RlICR7cmVtb3RlLm5hbWV9IGlzIG5vdCBhbGxvd2VkIHRvIGJlIHRoZSBwcmVmaXggb2YgJHtmaW5kRXF1YWwgJiYgZmluZEVxdWFsLm5hbWV9IG5hbWUgb3IgYWxpYXNgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHJlbW90ZSBlbnRyeSB0byBhIGNvbXBsZXRlIHBhdGhcbiAgICAgICAgICAgICAgICAgICAgaWYgKCdlbnRyeScgaW4gcmVtb3RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2RrLmlzQnJvd3NlckVudigpICYmICFyZW1vdGUuZW50cnkuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlLmVudHJ5ID0gbmV3IFVSTChyZW1vdGUuZW50cnksIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pLmhyZWY7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZW1vdGUuc2hhcmVTY29wZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlLnNoYXJlU2NvcGUgPSBERUZBVUxUX1NDT1BFO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVtb3RlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZS50eXBlID0gREVGQVVMVF9SRU1PVEVfVFlQRTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlUmVnaXN0ZXJSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRSZW1vdGUgPSB0YXJnZXRSZW1vdGVzLmZpbmQoKGl0ZW0pPT5pdGVtLm5hbWUgPT09IHJlbW90ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlZ2lzdGVyZWRSZW1vdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplUmVtb3RlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFJlbW90ZXMucHVzaChyZW1vdGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5yZWdpc3RlclJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZXMgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICBgVGhlIHJlbW90ZSBcIiR7cmVtb3RlLm5hbWV9XCIgaXMgYWxyZWFkeSByZWdpc3RlcmVkLmAsXG4gICAgICAgICAgICAgICAgICAgICAgICAnUGxlYXNlIG5vdGUgdGhhdCBvdmVycmlkaW5nIGl0IG1heSBjYXVzZSB1bmV4cGVjdGVkIGVycm9ycy4nXG4gICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBvcHRpb25zLmZvcmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgcmVnaXN0ZXJlZCByZW1vdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlUmVtb3RlKHJlZ2lzdGVyZWRSZW1vdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplUmVtb3RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRSZW1vdGVzLnB1c2gocmVtb3RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlZ2lzdGVyUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2RrLndhcm4obWVzc2FnZXMuam9pbignICcpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlbW92ZVJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVJlbW90ZShyZW1vdGUpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUxID0gcmVtb3RlLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmRleCA9IGhvc3Qub3B0aW9ucy5yZW1vdGVzLmZpbmRJbmRleCgoaXRlbSk9Pml0ZW0ubmFtZSA9PT0gbmFtZTEpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3RlSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0Lm9wdGlvbnMucmVtb3Rlcy5zcGxpY2UocmVtb3RlSW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkZWRNb2R1bGUgPSBob3N0Lm1vZHVsZUNhY2hlLmdldChyZW1vdGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2FkZWRNb2R1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gbG9hZGVkTW9kdWxlLnJlbW90ZUluZm87XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoQ3VycmVudEdsb2JhbFtrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9PYmplY3RfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoX09iamVjdF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEN1cnJlbnRHbG9iYWwsIGtleSkpID09IG51bGwgPyB2b2lkIDAgOiBfT2JqZWN0X2dldE93blByb3BlcnR5RGVzY3JpcHRvci5jb25maWd1cmFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIEN1cnJlbnRHbG9iYWxba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEN1cnJlbnRHbG9iYWxba2V5XSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnlVbmlxdWVLZXkgPSBnZXRSZW1vdGVFbnRyeVVuaXF1ZUtleShsb2FkZWRNb2R1bGUucmVtb3RlSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2xvYmFsTG9hZGluZ1tyZW1vdGVFbnRyeVVuaXF1ZUtleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgZ2xvYmFsTG9hZGluZ1tyZW1vdGVFbnRyeVVuaXF1ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0LnNuYXBzaG90SGFuZGxlci5tYW5pZmVzdENhY2hlLmRlbGV0ZShyZW1vdGVJbmZvLmVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRlbGV0ZSB1bmxvYWRlZCBzaGFyZWQgYW5kIGluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5zSWQgPSByZW1vdGVJbmZvLmJ1aWxkVmVyc2lvbiA/IHNkay5jb21wb3NlS2V5V2l0aFNlcGFyYXRvcihyZW1vdGVJbmZvLm5hbWUsIHJlbW90ZUluZm8uYnVpbGRWZXJzaW9uKSA6IHJlbW90ZUluZm8ubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbnNJbmRleCA9IEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19JTlNUQU5DRVNfXy5maW5kSW5kZXgoKGlucyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3RlSW5mby5idWlsZFZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlucy5vcHRpb25zLmlkID09PSByZW1vdGVJbnNJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5zLm5hbWUgPT09IHJlbW90ZUluc0lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUluc0luZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbnMgPSBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX19bcmVtb3RlSW5zSW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluc0lkID0gcmVtb3RlSW5zLm9wdGlvbnMuaWQgfHwgcmVtb3RlSW5zSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNoYXJlU2NvcGVNYXAgPSBnZXRHbG9iYWxTaGFyZVNjb3BlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQWxsU2hhcmVkTm90VXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5lZWREZWxldGVLZXlzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoZ2xvYmFsU2hhcmVTY29wZU1hcCkuZm9yRWFjaCgoaW5zdElkKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2hhcmVTY29wZU1hcCA9IGdsb2JhbFNoYXJlU2NvcGVNYXBbaW5zdElkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZU1hcCAmJiBPYmplY3Qua2V5cyhzaGFyZVNjb3BlTWFwKS5mb3JFYWNoKChzaGFyZVNjb3BlKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGVWYWwgPSBzaGFyZVNjb3BlTWFwW3NoYXJlU2NvcGVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZVZhbCAmJiBPYmplY3Qua2V5cyhzaGFyZVNjb3BlVmFsKS5mb3JFYWNoKChzaGFyZU5hbWUpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlZFBrZ3MgPSBzaGFyZVNjb3BlVmFsW3NoYXJlTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkUGtncyAmJiBPYmplY3Qua2V5cyhzaGFyZWRQa2dzKS5mb3JFYWNoKChzaGFyZVZlcnNpb24pPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWQgPSBzaGFyZWRQa2dzW3NoYXJlVmVyc2lvbl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWQgJiYgdHlwZW9mIHNoYXJlZCA9PT0gJ29iamVjdCcgJiYgc2hhcmVkLmZyb20gPT09IHJlbW90ZUluZm8ubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoYXJlZC5sb2FkZWQgfHwgc2hhcmVkLmxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQudXNlSW4gPSBzaGFyZWQudXNlSW4uZmlsdGVyKCh1c2VkSG9zdE5hbWUpPT51c2VkSG9zdE5hbWUgIT09IHJlbW90ZUluZm8ubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoYXJlZC51c2VJbi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBbGxTaGFyZWROb3RVc2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZERlbGV0ZUtleXMucHVzaChbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZVNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVWZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZERlbGV0ZUtleXMucHVzaChbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZVZlcnNpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FsbFNoYXJlZE5vdFVzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5zLnNoYXJlU2NvcGVNYXAgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGdsb2JhbFNoYXJlU2NvcGVNYXBbcmVtb3RlSW5zSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZWVkRGVsZXRlS2V5cy5mb3JFYWNoKChyZWYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgNCksIGluc0lkID0gX3JlZlswXSwgc2hhcmVTY29wZSA9IF9yZWZbMV0sIHNoYXJlTmFtZSA9IF9yZWZbMl0sIHNoYXJlVmVyc2lvbiA9IF9yZWZbM107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZF9zaGFyZVNjb3BlX3NoYXJlTmFtZSwgX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZSwgX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZCA9IGdsb2JhbFNoYXJlU2NvcGVNYXBbaW5zSWRdKSA9PSBudWxsID8gdHJ1ZSA6IChfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZF9zaGFyZVNjb3BlID0gX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRbc2hhcmVTY29wZV0pID09IG51bGwgPyB0cnVlIDogKF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkX3NoYXJlU2NvcGVfc2hhcmVOYW1lID0gX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZVtzaGFyZU5hbWVdKSA9PSBudWxsID8gdHJ1ZSA6IGRlbGV0ZSBfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZF9zaGFyZVNjb3BlX3NoYXJlTmFtZVtzaGFyZVZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19JTlNUQU5DRVNfXy5zcGxpY2UocmVtb3RlSW5zSW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3RHbG9iYWxTbmFwc2hvdCA9IGdldEdsb2JhbFJlbW90ZUluZm8ocmVtb3RlLCBob3N0KS5ob3N0R2xvYmFsU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaG9zdEdsb2JhbFNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUtleSA9IGhvc3RHbG9iYWxTbmFwc2hvdCAmJiAncmVtb3Rlc0luZm8nIGluIGhvc3RHbG9iYWxTbmFwc2hvdCAmJiBob3N0R2xvYmFsU25hcHNob3QucmVtb3Rlc0luZm8gJiYgZ2V0SW5mb1dpdGhvdXRUeXBlKGhvc3RHbG9iYWxTbmFwc2hvdC5yZW1vdGVzSW5mbywgcmVtb3RlLm5hbWUpLmtleTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3RlS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBob3N0R2xvYmFsU25hcHNob3QucmVtb3Rlc0luZm9bcmVtb3RlS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oR2xvYmFsLl9fRkVERVJBVElPTl9fLl9fTUFOSUZFU1RfTE9BRElOR19fW3JlbW90ZUtleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgR2xvYmFsLl9fRkVERVJBVElPTl9fLl9fTUFOSUZFU1RfTE9BRElOR19fW3JlbW90ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0Lm1vZHVsZUNhY2hlLmRlbGV0ZShyZW1vdGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmxvZygncmVtb3ZlUmVtb3RlIGZhaWw6ICcsIGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFJlbW90ZUhhbmRsZXI7XG59KCk7XG52YXIgRmVkZXJhdGlvbkhvc3QgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIEZlZGVyYXRpb25Ib3N0KHVzZXJPcHRpb25zKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgRmVkZXJhdGlvbkhvc3QpO1xuICAgICAgICB0aGlzLmhvb2tzID0gbmV3IFBsdWdpblN5c3RlbSh7XG4gICAgICAgICAgICBiZWZvcmVJbml0OiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZUluaXQnKSxcbiAgICAgICAgICAgIGluaXQ6IG5ldyBTeW5jSG9vaygpLFxuICAgICAgICAgICAgLy8gbWF5YmUgd2lsbCBjaGFuZ2UsIHRlbXBvcmFyaWx5IGZvciBpbnRlcm5hbCB1c2Ugb25seVxuICAgICAgICAgICAgYmVmb3JlSW5pdENvbnRhaW5lcjogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYmVmb3JlSW5pdENvbnRhaW5lcicpLFxuICAgICAgICAgICAgLy8gbWF5YmUgd2lsbCBjaGFuZ2UsIHRlbXBvcmFyaWx5IGZvciBpbnRlcm5hbCB1c2Ugb25seVxuICAgICAgICAgICAgaW5pdENvbnRhaW5lcjogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnaW5pdENvbnRhaW5lcicpXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBcIjAuMTAuMFwiO1xuICAgICAgICB0aGlzLm1vZHVsZUNhY2hlID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmxvYWRlckhvb2sgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIC8vIEZJWE1FOiBtYXkgbm90IGJlIHN1aXRhYmxlICwgbm90IG9wZW4gdG8gdGhlIHB1YmxpYyB5ZXRcbiAgICAgICAgICAgIGdldE1vZHVsZUluZm86IG5ldyBTeW5jSG9vaygpLFxuICAgICAgICAgICAgY3JlYXRlU2NyaXB0OiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGNyZWF0ZUxpbms6IG5ldyBTeW5jSG9vaygpLFxuICAgICAgICAgICAgZmV0Y2g6IG5ldyBBc3luY0hvb2soKSxcbiAgICAgICAgICAgIGxvYWRFbnRyeUVycm9yOiBuZXcgQXN5bmNIb29rKCksXG4gICAgICAgICAgICBnZXRNb2R1bGVGYWN0b3J5OiBuZXcgQXN5bmNIb29rKClcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYnJpZGdlSG9vayA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYmVmb3JlQnJpZGdlUmVuZGVyOiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGFmdGVyQnJpZGdlUmVuZGVyOiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGJlZm9yZUJyaWRnZURlc3Ryb3k6IG5ldyBTeW5jSG9vaygpLFxuICAgICAgICAgICAgYWZ0ZXJCcmlkZ2VEZXN0cm95OiBuZXcgU3luY0hvb2soKVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gVE9ETzogVmFsaWRhdGUgdGhlIGRldGFpbHMgb2YgdGhlIG9wdGlvbnNcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBvcHRpb25zIHdpdGggZGVmYXVsdCB2YWx1ZXNcbiAgICAgICAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgICAgICAgaWQ6IGdldEJ1aWxkZXJJZCgpLFxuICAgICAgICAgICAgbmFtZTogdXNlck9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgIHBsdWdpbnM6IFtcbiAgICAgICAgICAgICAgICBzbmFwc2hvdFBsdWdpbigpLFxuICAgICAgICAgICAgICAgIGdlbmVyYXRlUHJlbG9hZEFzc2V0c1BsdWdpbigpXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgcmVtb3RlczogW10sXG4gICAgICAgICAgICBzaGFyZWQ6IHt9LFxuICAgICAgICAgICAgaW5Ccm93c2VyOiBzZGsuaXNCcm93c2VyRW52KClcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5uYW1lID0gdXNlck9wdGlvbnMubmFtZTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgIHRoaXMuc25hcHNob3RIYW5kbGVyID0gbmV3IFNuYXBzaG90SGFuZGxlcih0aGlzKTtcbiAgICAgICAgdGhpcy5zaGFyZWRIYW5kbGVyID0gbmV3IFNoYXJlZEhhbmRsZXIodGhpcyk7XG4gICAgICAgIHRoaXMucmVtb3RlSGFuZGxlciA9IG5ldyBSZW1vdGVIYW5kbGVyKHRoaXMpO1xuICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXAgPSB0aGlzLnNoYXJlZEhhbmRsZXIuc2hhcmVTY29wZU1hcDtcbiAgICAgICAgdGhpcy5yZWdpc3RlclBsdWdpbnMoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhkZWZhdWx0T3B0aW9ucy5wbHVnaW5zKS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyh1c2VyT3B0aW9ucy5wbHVnaW5zIHx8IFtdKSkpO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSB0aGlzLmZvcm1hdE9wdGlvbnMoZGVmYXVsdE9wdGlvbnMsIHVzZXJPcHRpb25zKTtcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKEZlZGVyYXRpb25Ib3N0LCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0T3B0aW9uc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRPcHRpb25zKHVzZXJPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlclBsdWdpbnModXNlck9wdGlvbnMucGx1Z2lucyk7XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLmZvcm1hdE9wdGlvbnModGhpcy5vcHRpb25zLCB1c2VyT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9ucztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTaGFyZShwa2dOYW1lLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2hhcmVkSGFuZGxlci5sb2FkU2hhcmUocGtnTmFtZSwgZXh0cmFPcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBUaGUgbGliIGZ1bmN0aW9uIHdpbGwgb25seSBiZSBhdmFpbGFibGUgaWYgdGhlIHNoYXJlZCBzZXQgYnkgZWFnZXIgb3IgcnVudGltZSBpbml0IGlzIHNldCBvciB0aGUgc2hhcmVkIGlzIHN1Y2Nlc3NmdWxseSBsb2FkZWQuXG4gICAgICAgICAgICAvLyAxLiBJZiB0aGUgbG9hZGVkIHNoYXJlZCBhbHJlYWR5IGV4aXN0cyBnbG9iYWxseSwgdGhlbiBpdCB3aWxsIGJlIHJldXNlZFxuICAgICAgICAgICAgLy8gMi4gSWYgbGliIGV4aXN0cyBpbiBsb2NhbCBzaGFyZWQsIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseVxuICAgICAgICAgICAgLy8gMy4gSWYgdGhlIGxvY2FsIGdldCByZXR1cm5zIHNvbWV0aGluZyBvdGhlciB0aGFuIFByb21pc2UsIHRoZW4gaXQgd2lsbCBiZSB1c2VkIGRpcmVjdGx5XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNoYXJlU3luY1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTaGFyZVN5bmMocGtnTmFtZSwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2hhcmVkSGFuZGxlci5sb2FkU2hhcmVTeW5jKHBrZ05hbWUsIGV4dHJhT3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0aWFsaXplU2hhcmluZ1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemVTaGFyaW5nKHJlZiwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGVOYW1lID0gcmVmID09PSB2b2lkIDAgPyBERUZBVUxUX1NDT1BFIDogcmVmO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNoYXJlZEhhbmRsZXIuaW5pdGlhbGl6ZVNoYXJpbmcoc2hhcmVTY29wZU5hbWUsIGV4dHJhT3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0UmF3Q29udGFpbmVyXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFJhd0NvbnRhaW5lcihuYW1lMSwgdXJsLCBjb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IGdldFJlbW90ZUluZm8oe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICAgICAgZW50cnk6IHVybFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBtb2R1bGUgPSBuZXcgTW9kdWxlKHtcbiAgICAgICAgICAgICAgICAgICAgaG9zdDogdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIG1vZHVsZS5yZW1vdGVFbnRyeUV4cG9ydHMgPSBjb250YWluZXI7XG4gICAgICAgICAgICAgICAgdGhpcy5tb2R1bGVDYWNoZS5zZXQobmFtZTEsIG1vZHVsZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvblxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9tZW1iZXItb3JkZXJpbmdcbiAgICAgICAgICAgIGZ1bmN0aW9uIGxvYWRSZW1vdGUoaWQsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlSGFuZGxlci5sb2FkUmVtb3RlKGlkLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicHJlbG9hZFJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbWVtYmVyLW9yZGVyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBwcmVsb2FkUmVtb3RlKHByZWxvYWRPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZUhhbmRsZXIucHJlbG9hZFJlbW90ZShwcmVsb2FkT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImluaXRTaGFyZVNjb3BlTWFwXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFNoYXJlU2NvcGVNYXAoc2NvcGVOYW1lLCBzaGFyZVNjb3BlLCByZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXh0cmFPcHRpb25zID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZEhhbmRsZXIuaW5pdFNoYXJlU2NvcGVNYXAoc2NvcGVOYW1lLCBzaGFyZVNjb3BlLCBleHRyYU9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZm9ybWF0T3B0aW9uc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZvcm1hdE9wdGlvbnMoZ2xvYmFsT3B0aW9ucywgdXNlck9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2hhcmVkID0gZm9ybWF0U2hhcmVDb25maWdzKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKS5zaGFyZWQ7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzX2hvb2tzX2xpZmVjeWNsZV9iZWZvcmVJbml0X2VtaXQgPSB0aGlzLmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVJbml0LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBnbG9iYWxPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm86IHNoYXJlZFxuICAgICAgICAgICAgICAgIH0pLCB1c2VyT3B0aW9uc1JlcyA9IF90aGlzX2hvb2tzX2xpZmVjeWNsZV9iZWZvcmVJbml0X2VtaXQudXNlck9wdGlvbnMsIGdsb2JhbE9wdGlvbnNSZXMgPSBfdGhpc19ob29rc19saWZlY3ljbGVfYmVmb3JlSW5pdF9lbWl0Lm9wdGlvbnM7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZXMgPSB0aGlzLnJlbW90ZUhhbmRsZXIuZm9ybWF0QW5kUmVnaXN0ZXJSZW1vdGUoZ2xvYmFsT3B0aW9uc1JlcywgdXNlck9wdGlvbnNSZXMpO1xuICAgICAgICAgICAgICAgIHZhciBfdGhpc19zaGFyZWRIYW5kbGVyX3JlZ2lzdGVyU2hhcmVkID0gdGhpcy5zaGFyZWRIYW5kbGVyLnJlZ2lzdGVyU2hhcmVkKGdsb2JhbE9wdGlvbnNSZXMsIHVzZXJPcHRpb25zUmVzKSwgaGFuZGxlZFNoYXJlZCA9IF90aGlzX3NoYXJlZEhhbmRsZXJfcmVnaXN0ZXJTaGFyZWQuc2hhcmVkO1xuICAgICAgICAgICAgICAgIHZhciBwbHVnaW5zID0gX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhnbG9iYWxPcHRpb25zUmVzLnBsdWdpbnMpO1xuICAgICAgICAgICAgICAgIGlmICh1c2VyT3B0aW9uc1Jlcy5wbHVnaW5zKSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJPcHRpb25zUmVzLnBsdWdpbnMuZm9yRWFjaCgocGx1Z2luKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwbHVnaW5zLmluY2x1ZGVzKHBsdWdpbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW5zLnB1c2gocGx1Z2luKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zUmVzID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucywge1xuICAgICAgICAgICAgICAgICAgICBwbHVnaW5zLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVzLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IGhhbmRsZWRTaGFyZWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5pbml0LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnNSZXNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9uc1JlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlZ2lzdGVyUGx1Z2luc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyUGx1Z2luczEocGx1Z2lucykge1xuICAgICAgICAgICAgICAgIHZhciBwbHVnaW5SZXMgPSByZWdpc3RlclBsdWdpbnMocGx1Z2lucywgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhvb2tzLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW90ZUhhbmRsZXIuaG9va3MsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkSGFuZGxlci5ob29rcyxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zbmFwc2hvdEhhbmRsZXIuaG9va3MsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGVySG9vayxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5icmlkZ2VIb29rXG4gICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgLy8gTWVyZ2UgcGx1Z2luXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnBsdWdpbnMgPSB0aGlzLm9wdGlvbnMucGx1Z2lucy5yZWR1Y2UoKHJlcywgcGx1Z2luKT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXBsdWdpbikgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyAmJiAhcmVzLmZpbmQoKGl0ZW0pPT5pdGVtLm5hbWUgPT09IHBsdWdpbi5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2gocGx1Z2luKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgIH0sIHBsdWdpblJlcyB8fCBbXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZWdpc3RlclJlbW90ZXNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlclJlbW90ZXMocmVtb3Rlcywgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZUhhbmRsZXIucmVnaXN0ZXJSZW1vdGVzKHJlbW90ZXMsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIEZlZGVyYXRpb25Ib3N0O1xufSgpO1xudmFyIGluZGV4ID0gLyojX19QVVJFX18qLyBPYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGxcbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwibG9hZFNjcmlwdFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHNkay5sb2FkU2NyaXB0O1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImxvYWRTY3JpcHROb2RlXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gc2RrLmxvYWRTY3JpcHROb2RlO1xuICAgIH1cbn0pKTtcbmV4cG9ydHMuQ3VycmVudEdsb2JhbCA9IEN1cnJlbnRHbG9iYWw7XG5leHBvcnRzLkZlZGVyYXRpb25Ib3N0ID0gRmVkZXJhdGlvbkhvc3Q7XG5leHBvcnRzLkdsb2JhbCA9IEdsb2JhbDtcbmV4cG9ydHMuTW9kdWxlID0gTW9kdWxlO1xuZXhwb3J0cy5hZGRHbG9iYWxTbmFwc2hvdCA9IGFkZEdsb2JhbFNuYXBzaG90O1xuZXhwb3J0cy5hc3NlcnQgPSBhc3NlcnQ7XG5leHBvcnRzLmdldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvciA9IGdldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcjtcbmV4cG9ydHMuZ2V0R2xvYmFsU25hcHNob3QgPSBnZXRHbG9iYWxTbmFwc2hvdDtcbmV4cG9ydHMuZ2V0SW5mb1dpdGhvdXRUeXBlID0gZ2V0SW5mb1dpdGhvdXRUeXBlO1xuZXhwb3J0cy5nZXRSZWdpc3RlcmVkU2hhcmUgPSBnZXRSZWdpc3RlcmVkU2hhcmU7XG5leHBvcnRzLmdldFJlbW90ZUVudHJ5ID0gZ2V0UmVtb3RlRW50cnk7XG5leHBvcnRzLmdldFJlbW90ZUluZm8gPSBnZXRSZW1vdGVJbmZvO1xuZXhwb3J0cy5oZWxwZXJzID0gaGVscGVycztcbmV4cG9ydHMuaXNTdGF0aWNSZXNvdXJjZXNFcXVhbCA9IGlzU3RhdGljUmVzb3VyY2VzRXF1YWw7XG5leHBvcnRzLm1hdGNoUmVtb3RlV2l0aE5hbWVBbmRFeHBvc2UgPSBtYXRjaFJlbW90ZVdpdGhOYW1lQW5kRXhwb3NlO1xuZXhwb3J0cy5yZWdpc3Rlckdsb2JhbFBsdWdpbnMgPSByZWdpc3Rlckdsb2JhbFBsdWdpbnM7XG5leHBvcnRzLnJlc2V0RmVkZXJhdGlvbkdsb2JhbEluZm8gPSByZXNldEZlZGVyYXRpb25HbG9iYWxJbmZvO1xuZXhwb3J0cy5zYWZlV3JhcHBlciA9IHNhZmVXcmFwcGVyO1xuZXhwb3J0cy5zYXRpc2Z5ID0gc2F0aXNmeTtcbmV4cG9ydHMuc2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yID0gc2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yO1xuZXhwb3J0cy5zZXRHbG9iYWxGZWRlcmF0aW9uSW5zdGFuY2UgPSBzZXRHbG9iYWxGZWRlcmF0aW9uSW5zdGFuY2U7XG5leHBvcnRzLnR5cGVzID0gaW5kZXg7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lLWNvcmUvZGlzdC9wb2x5ZmlsbHMuY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvcG9seWZpbGxzLmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfZXh0ZW5kcygpIHtcbiAgICBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gYXNzaWduKHRhcmdldCkge1xuICAgICAgICBmb3IodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBmb3IodmFyIGtleSBpbiBzb3VyY2UpaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9O1xuICAgIHJldHVybiBfZXh0ZW5kcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2Uoc291cmNlLCBleGNsdWRlZCkge1xuICAgIGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9O1xuICAgIHZhciB0YXJnZXQgPSB7fTtcbiAgICB2YXIgc291cmNlS2V5cyA9IE9iamVjdC5rZXlzKHNvdXJjZSk7XG4gICAgdmFyIGtleSwgaTtcbiAgICBmb3IoaSA9IDA7IGkgPCBzb3VyY2VLZXlzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAga2V5ID0gc291cmNlS2V5c1tpXTtcbiAgICAgICAgaWYgKGV4Y2x1ZGVkLmluZGV4T2Yoa2V5KSA+PSAwKSBjb250aW51ZTtcbiAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbn1cbmV4cG9ydHMuX2V4dGVuZHMgPSBfZXh0ZW5kcztcbmV4cG9ydHMuX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2UgPSBfb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllc19sb29zZTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvZGlzdC9pbmRleC5janMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBydW50aW1lQ29yZSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBtb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lLWNvcmUgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvaW5kZXguY2pzLmpzXCIpO1xudmFyIHV0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi91dGlscy5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L3V0aWxzLmNqcy5qc1wiKTtcbnZhciBGZWRlcmF0aW9uSW5zdGFuY2UgPSBudWxsO1xuZnVuY3Rpb24gaW5pdChvcHRpb25zKSB7XG4gICAgLy8gUmV0cmlldmUgdGhlIHNhbWUgaW5zdGFuY2Ugd2l0aCB0aGUgc2FtZSBuYW1lXG4gICAgdmFyIGluc3RhbmNlID0gdXRpbHMuZ2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlKG9wdGlvbnMubmFtZSwgb3B0aW9ucy52ZXJzaW9uKTtcbiAgICBpZiAoIWluc3RhbmNlKSB7XG4gICAgICAgIC8vIFJldHJpZXZlIGRlYnVnIGNvbnN0cnVjdG9yXG4gICAgICAgIHZhciBGZWRlcmF0aW9uQ29uc3RydWN0b3IgPSBydW50aW1lQ29yZS5nZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IoKSB8fCBydW50aW1lQ29yZS5GZWRlcmF0aW9uSG9zdDtcbiAgICAgICAgRmVkZXJhdGlvbkluc3RhbmNlID0gbmV3IEZlZGVyYXRpb25Db25zdHJ1Y3RvcihvcHRpb25zKTtcbiAgICAgICAgcnVudGltZUNvcmUuc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlKEZlZGVyYXRpb25JbnN0YW5jZSk7XG4gICAgICAgIHJldHVybiBGZWRlcmF0aW9uSW5zdGFuY2U7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gTWVyZ2Ugb3B0aW9uc1xuICAgICAgICBpbnN0YW5jZS5pbml0T3B0aW9ucyhvcHRpb25zKTtcbiAgICAgICAgaWYgKCFGZWRlcmF0aW9uSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIEZlZGVyYXRpb25JbnN0YW5jZSA9IGluc3RhbmNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9XG59XG5mdW5jdGlvbiBsb2FkUmVtb3RlKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIHZhciBsb2FkUmVtb3RlMSA9IEZlZGVyYXRpb25JbnN0YW5jZS5sb2FkUmVtb3RlO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIGxvYWRSZW1vdGUxLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiBsb2FkU2hhcmUoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICB2YXIgbG9hZFNoYXJlMSA9IEZlZGVyYXRpb25JbnN0YW5jZS5sb2FkU2hhcmU7XG4gICAgcmV0dXJuIGxvYWRTaGFyZTEuYXBwbHkoRmVkZXJhdGlvbkluc3RhbmNlLCBhcmdzKTtcbn1cbmZ1bmN0aW9uIGxvYWRTaGFyZVN5bmMoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgdmFyIGxvYWRTaGFyZVN5bmMxID0gRmVkZXJhdGlvbkluc3RhbmNlLmxvYWRTaGFyZVN5bmM7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICByZXR1cm4gbG9hZFNoYXJlU3luYzEuYXBwbHkoRmVkZXJhdGlvbkluc3RhbmNlLCBhcmdzKTtcbn1cbmZ1bmN0aW9uIHByZWxvYWRSZW1vdGUoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICByZXR1cm4gRmVkZXJhdGlvbkluc3RhbmNlLnByZWxvYWRSZW1vdGUuYXBwbHkoRmVkZXJhdGlvbkluc3RhbmNlLCBhcmdzKTtcbn1cbmZ1bmN0aW9uIHJlZ2lzdGVyUmVtb3RlcyguLi5hcmdzKSB7XG4gICAgcnVudGltZUNvcmUuYXNzZXJ0KEZlZGVyYXRpb25JbnN0YW5jZSwgJ1BsZWFzZSBjYWxsIGluaXQgZmlyc3QnKTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLXNwcmVhZFxuICAgIHJldHVybiBGZWRlcmF0aW9uSW5zdGFuY2UucmVnaXN0ZXJSZW1vdGVzLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiByZWdpc3RlclBsdWdpbnMoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICByZXR1cm4gRmVkZXJhdGlvbkluc3RhbmNlLnJlZ2lzdGVyUGx1Z2lucy5hcHBseShGZWRlcmF0aW9uSW5zdGFuY2UsIGFyZ3MpO1xufVxuZnVuY3Rpb24gZ2V0SW5zdGFuY2UoKSB7XG4gICAgcmV0dXJuIEZlZGVyYXRpb25JbnN0YW5jZTtcbn1cbi8vIEluamVjdCBmb3IgZGVidWdcbnJ1bnRpbWVDb3JlLnNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcihydW50aW1lQ29yZS5GZWRlcmF0aW9uSG9zdCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJGZWRlcmF0aW9uSG9zdFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLkZlZGVyYXRpb25Ib3N0O1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIk1vZHVsZVwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLk1vZHVsZTtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJnZXRSZW1vdGVFbnRyeVwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLmdldFJlbW90ZUVudHJ5O1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImdldFJlbW90ZUluZm9cIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5nZXRSZW1vdGVJbmZvO1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImxvYWRTY3JpcHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5sb2FkU2NyaXB0O1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImxvYWRTY3JpcHROb2RlXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcnVudGltZUNvcmUubG9hZFNjcmlwdE5vZGU7XG4gICAgfVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwicmVnaXN0ZXJHbG9iYWxQbHVnaW5zXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcnVudGltZUNvcmUucmVnaXN0ZXJHbG9iYWxQbHVnaW5zO1xuICAgIH1cbn0pKTtcbmV4cG9ydHMuZ2V0SW5zdGFuY2UgPSBnZXRJbnN0YW5jZTtcbmV4cG9ydHMuaW5pdCA9IGluaXQ7XG5leHBvcnRzLmxvYWRSZW1vdGUgPSBsb2FkUmVtb3RlO1xuZXhwb3J0cy5sb2FkU2hhcmUgPSBsb2FkU2hhcmU7XG5leHBvcnRzLmxvYWRTaGFyZVN5bmMgPSBsb2FkU2hhcmVTeW5jO1xuZXhwb3J0cy5wcmVsb2FkUmVtb3RlID0gcHJlbG9hZFJlbW90ZTtcbmV4cG9ydHMucmVnaXN0ZXJQbHVnaW5zID0gcmVnaXN0ZXJQbHVnaW5zO1xuZXhwb3J0cy5yZWdpc3RlclJlbW90ZXMgPSByZWdpc3RlclJlbW90ZXM7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL2Rpc3QvdXRpbHMuY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L3V0aWxzLmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgcnVudGltZUNvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbi8vIGluamVjdGVkIGJ5IGJ1bmRsZXIsIHNvIGl0IGNhbiBub3QgdXNlIHJ1bnRpbWUtY29yZSBzdHVmZlxuZnVuY3Rpb24gZ2V0QnVpbGRlcklkKCkge1xuICAgIC8vQHRzLWlnbm9yZVxuICAgIHJldHVybiAgdHJ1ZSA/IFwic3BvcnRzOjEuMC4wXCIgOiAwO1xufVxuZnVuY3Rpb24gZ2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlKG5hbWUsIHZlcnNpb24pIHtcbiAgICB2YXIgYnVpbGRJZCA9IGdldEJ1aWxkZXJJZCgpO1xuICAgIHJldHVybiBydW50aW1lQ29yZS5DdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX18uZmluZCgoR01JbnN0YW5jZSk9PntcbiAgICAgICAgaWYgKGJ1aWxkSWQgJiYgR01JbnN0YW5jZS5vcHRpb25zLmlkID09PSBnZXRCdWlsZGVySWQoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEdNSW5zdGFuY2Uub3B0aW9ucy5uYW1lID09PSBuYW1lICYmICFHTUluc3RhbmNlLm9wdGlvbnMudmVyc2lvbiAmJiAhdmVyc2lvbikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEdNSW5zdGFuY2Uub3B0aW9ucy5uYW1lID09PSBuYW1lICYmIHZlcnNpb24gJiYgR01JbnN0YW5jZS5vcHRpb25zLnZlcnNpb24gPT09IHZlcnNpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuZ2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlID0gZ2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vc2RrL2Rpc3QvaW5kZXguY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9zZGsvZGlzdC9pbmRleC5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbnZhciBfYXN5bmNfdG9fZ2VuZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2FzeW5jX3RvX2dlbmVyYXRvciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FzeW5jX3RvX2dlbmVyYXRvci5janNcIik7XG52YXIgX2NsYXNzX2NhbGxfY2hlY2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY2xhc3NfY2FsbF9jaGVjayAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NsYXNzX2NhbGxfY2hlY2suY2pzXCIpO1xudmFyIF9jcmVhdGVfY2xhc3MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY3JlYXRlX2NsYXNzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY3JlYXRlX2NsYXNzLmNqc1wiKTtcbnZhciBfc2xpY2VkX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3NsaWNlZF90b19hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janNcIik7XG52YXIgX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2FycmF5ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19jb25zdW1hYmxlX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2NvbnN1bWFibGVfYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqc1wiKTtcbnZhciBwb2x5ZmlsbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3BvbHlmaWxscy5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vc2RrL2Rpc3QvcG9seWZpbGxzLmNqcy5qc1wiKTtcbnZhciBGZWRlcmF0aW9uTW9kdWxlTWFuaWZlc3QgPSAnZmVkZXJhdGlvbi1tYW5pZmVzdC5qc29uJztcbnZhciBNQU5JRkVTVF9FWFQgPSAnLmpzb24nO1xudmFyIEJST1dTRVJfTE9HX0tFWSA9ICdGRURFUkFUSU9OX0RFQlVHJztcbnZhciBCUk9XU0VSX0xPR19WQUxVRSA9ICcxJztcbnZhciBOYW1lVHJhbnNmb3JtU3ltYm9sID0ge1xuICAgIEFUOiAnQCcsXG4gICAgSFlQSEVOOiAnLScsXG4gICAgU0xBU0g6ICcvJ1xufTtcbnZhciBOYW1lVHJhbnNmb3JtTWFwID0ge1xuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXTogJ3Njb3BlXycsXG4gICAgW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXTogJ18nLFxuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXTogJ19fJ1xufTtcbnZhciBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcCA9IHtcbiAgICBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXV06IE5hbWVUcmFuc2Zvcm1TeW1ib2wuQVQsXG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dXTogTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU4sXG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF1dOiBOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXG59O1xudmFyIFNFUEFSQVRPUiA9ICc6JztcbnZhciBNYW5pZmVzdEZpbGVOYW1lID0gJ21mLW1hbmlmZXN0Lmpzb24nO1xudmFyIFN0YXRzRmlsZU5hbWUgPSAnbWYtc3RhdHMuanNvbic7XG52YXIgTUZNb2R1bGVUeXBlID0ge1xuICAgIE5QTTogJ25wbScsXG4gICAgQVBQOiAnYXBwJ1xufTtcbnZhciBNT0RVTEVfREVWVE9PTF9JREVOVElGSUVSID0gJ19fTUZfREVWVE9PTFNfTU9EVUxFX0lORk9fXyc7XG52YXIgRU5DT0RFX05BTUVfUFJFRklYID0gJ0VOQ09ERV9OQU1FX1BSRUZJWCc7XG52YXIgVEVNUF9ESVIgPSAnLmZlZGVyYXRpb24nO1xudmFyIE1GUHJlZmV0Y2hDb21tb24gPSB7XG4gICAgaWRlbnRpZmllcjogJ01GRGF0YVByZWZldGNoJyxcbiAgICBnbG9iYWxLZXk6ICdfX1BSRUZFVENIX18nLFxuICAgIGxpYnJhcnk6ICdtZi1kYXRhLXByZWZldGNoJyxcbiAgICBleHBvcnRzS2V5OiAnX19QUkVGRVRDSF9FWFBPUlRTX18nLFxuICAgIGZpbGVOYW1lOiAnYm9vdHN0cmFwLmpzJ1xufTtcbnZhciBDb250YWluZXJQbHVnaW4gPSAvKiNfX1BVUkVfXyovIE9iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbFxufSk7XG52YXIgQ29udGFpbmVyUmVmZXJlbmNlUGx1Z2luID0gLyojX19QVVJFX18qLyBPYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGxcbn0pO1xudmFyIE1vZHVsZUZlZGVyYXRpb25QbHVnaW4gPSAvKiNfX1BVUkVfXyovIE9iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbFxufSk7XG52YXIgU2hhcmVQbHVnaW4gPSAvKiNfX1BVUkVfXyovIE9iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbFxufSk7XG5mdW5jdGlvbiBpc0Jyb3dzZXJFbnYoKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnO1xufVxuZnVuY3Rpb24gaXNCcm93c2VyRGVidWcoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKGlzQnJvd3NlckVudigpICYmIHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShCUk9XU0VSX0xPR19LRVkpID09PSBCUk9XU0VSX0xPR19WQUxVRTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yMSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGlzRGVidWdNb2RlKCkge1xuICAgIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnZbJ0ZFREVSQVRJT05fREVCVUcnXSkge1xuICAgICAgICByZXR1cm4gQm9vbGVhbihwcm9jZXNzLmVudlsnRkVERVJBVElPTl9ERUJVRyddKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBGRURFUkFUSU9OX0RFQlVHICE9PSAndW5kZWZpbmVkJyAmJiBCb29sZWFuKEZFREVSQVRJT05fREVCVUcpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gaXNCcm93c2VyRGVidWcoKTtcbn1cbnZhciBnZXRQcm9jZXNzRW52ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwcm9jZXNzLmVudiA/IHByb2Nlc3MuZW52IDoge307XG59O1xudmFyIExPR19DQVRFR09SWSA9ICdbIEZlZGVyYXRpb24gUnVudGltZSBdJztcbi8vIGVudHJ5OiBuYW1lOnZlcnNpb24gICB2ZXJzaW9uIDogMS4wLjAgfCBeMS4yLjNcbi8vIGVudHJ5OiBuYW1lOmVudHJ5ICBlbnRyeTogIGh0dHBzOi8vbG9jYWxob3N0OjkwMDAvZmVkZXJhdGlvbi1tYW5pZmVzdC5qc29uXG52YXIgcGFyc2VFbnRyeSA9IChzdHIsIGRldlZlck9yVXJsLCByZWYpPT57XG4gICAgdmFyIHNlcGFyYXRvciA9IHJlZiA9PT0gdm9pZCAwID8gU0VQQVJBVE9SIDogcmVmO1xuICAgIHZhciBzdHJTcGxpdCA9IHN0ci5zcGxpdChzZXBhcmF0b3IpO1xuICAgIHZhciBkZXZWZXJzaW9uT3JVcmwgPSBnZXRQcm9jZXNzRW52KClbJ05PREVfRU5WJ10gPT09ICdkZXZlbG9wbWVudCcgJiYgZGV2VmVyT3JVcmw7XG4gICAgdmFyIGRlZmF1bHRWZXJzaW9uID0gJyonO1xuICAgIHZhciBpc0VudHJ5ID0gKHMpPT5zLnN0YXJ0c1dpdGgoJ2h0dHAnKSB8fCBzLmluY2x1ZGVzKE1BTklGRVNUX0VYVCk7XG4gICAgLy8gQ2hlY2sgaWYgdGhlIHN0cmluZyBzdGFydHMgd2l0aCBhIHR5cGVcbiAgICBpZiAoc3RyU3BsaXQubGVuZ3RoID49IDIpIHtcbiAgICAgICAgdmFyIF9zdHJTcGxpdCA9IF90b19hcnJheS5fKHN0clNwbGl0KSwgbmFtZSA9IF9zdHJTcGxpdFswXSwgdmVyc2lvbk9yRW50cnlBcnIgPSBfc3RyU3BsaXQuc2xpY2UoMSk7XG4gICAgICAgIC8vIEBuYW1lQG1hbmlmZXN0LXVybC5qc29uXG4gICAgICAgIGlmIChzdHIuc3RhcnRzV2l0aChzZXBhcmF0b3IpKSB7XG4gICAgICAgICAgICBuYW1lID0gc3RyU3BsaXQuc2xpY2UoMCwgMikuam9pbihzZXBhcmF0b3IpO1xuICAgICAgICAgICAgdmVyc2lvbk9yRW50cnlBcnIgPSBbXG4gICAgICAgICAgICAgICAgZGV2VmVyc2lvbk9yVXJsIHx8IHN0clNwbGl0LnNsaWNlKDIpLmpvaW4oc2VwYXJhdG9yKVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmVyc2lvbk9yRW50cnkgPSBkZXZWZXJzaW9uT3JVcmwgfHwgdmVyc2lvbk9yRW50cnlBcnIuam9pbihzZXBhcmF0b3IpO1xuICAgICAgICBpZiAoaXNFbnRyeSh2ZXJzaW9uT3JFbnRyeSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICBlbnRyeTogdmVyc2lvbk9yRW50cnlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBBcHBseSB2ZXJzaW9uIHJ1bGVcbiAgICAgICAgICAgIC8vIGRldlZlcnNpb25PclVybCA9PiBpbnB1dFZlcnNpb24gPT4gZGVmYXVsdFZlcnNpb25cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiB2ZXJzaW9uT3JFbnRyeSB8fCBkZWZhdWx0VmVyc2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoc3RyU3BsaXQubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHZhciBfc3RyU3BsaXQxID0gX3NsaWNlZF90b19hcnJheS5fKHN0clNwbGl0LCAxKSwgbmFtZTEgPSBfc3RyU3BsaXQxWzBdO1xuICAgICAgICBpZiAoZGV2VmVyc2lvbk9yVXJsICYmIGlzRW50cnkoZGV2VmVyc2lvbk9yVXJsKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICBlbnRyeTogZGV2VmVyc2lvbk9yVXJsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBuYW1lMSxcbiAgICAgICAgICAgIHZlcnNpb246IGRldlZlcnNpb25PclVybCB8fCBkZWZhdWx0VmVyc2lvblxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IGBJbnZhbGlkIGVudHJ5IHZhbHVlOiAke3N0cn1gO1xuICAgIH1cbn07XG52YXIgY29tcG9zZUtleVdpdGhTZXBhcmF0b3IgPSBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgaWYgKCFhcmdzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIHJldHVybiBhcmdzLnJlZHVjZSgoc3VtLCBjdXIpPT57XG4gICAgICAgIGlmICghY3VyKSB7XG4gICAgICAgICAgICByZXR1cm4gc3VtO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc3VtKSB7XG4gICAgICAgICAgICByZXR1cm4gY3VyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgJHtzdW19JHtTRVBBUkFUT1J9JHtjdXJ9YDtcbiAgICB9LCAnJyk7XG59O1xudmFyIGVuY29kZU5hbWUgPSBmdW5jdGlvbihuYW1lLCByZWYsIHJlZjEpIHtcbiAgICB2YXIgcHJlZml4ID0gcmVmID09PSB2b2lkIDAgPyAnJyA6IHJlZiwgd2l0aEV4dCA9IHJlZjEgPT09IHZvaWQgMCA/IGZhbHNlIDogcmVmMTtcbiAgICB0cnkge1xuICAgICAgICB2YXIgZXh0ID0gd2l0aEV4dCA/ICcuanMnIDogJyc7XG4gICAgICAgIHJldHVybiBgJHtwcmVmaXh9JHtuYW1lLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUfWAsICdnJyksIE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTn1gLCAnZycpLCBOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXSkucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0h9YCwgJ2cnKSwgTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXSl9JHtleHR9YDtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbn07XG52YXIgZGVjb2RlTmFtZSA9IGZ1bmN0aW9uKG5hbWUsIHByZWZpeCwgd2l0aEV4dCkge1xuICAgIHRyeSB7XG4gICAgICAgIHZhciBkZWNvZGVkTmFtZSA9IG5hbWU7XG4gICAgICAgIGlmIChwcmVmaXgpIHtcbiAgICAgICAgICAgIGlmICghZGVjb2RlZE5hbWUuc3RhcnRzV2l0aChwcmVmaXgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlY29kZWROYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVjb2RlZE5hbWUgPSBkZWNvZGVkTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAocHJlZml4LCAnZycpLCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVjb2RlZE5hbWUgPSBkZWNvZGVkTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXX1gLCAnZycpLCBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdXSkucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXV0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXX1gLCAnZycpLCBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXV0pO1xuICAgICAgICBpZiAod2l0aEV4dCkge1xuICAgICAgICAgICAgZGVjb2RlZE5hbWUgPSBkZWNvZGVkTmFtZS5yZXBsYWNlKCcuanMnLCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlY29kZWROYW1lO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgfVxufTtcbnZhciBnZW5lcmF0ZUV4cG9zZUZpbGVuYW1lID0gKGV4cG9zZU5hbWUsIHdpdGhFeHQpPT57XG4gICAgaWYgKCFleHBvc2VOYW1lKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgdmFyIGV4cG9zZSA9IGV4cG9zZU5hbWU7XG4gICAgaWYgKGV4cG9zZSA9PT0gJy4nKSB7XG4gICAgICAgIGV4cG9zZSA9ICdkZWZhdWx0X2V4cG9ydCc7XG4gICAgfVxuICAgIGlmIChleHBvc2Uuc3RhcnRzV2l0aCgnLi8nKSkge1xuICAgICAgICBleHBvc2UgPSBleHBvc2UucmVwbGFjZSgnLi8nLCAnJyk7XG4gICAgfVxuICAgIHJldHVybiBlbmNvZGVOYW1lKGV4cG9zZSwgJ19fZmVkZXJhdGlvbl9leHBvc2VfJywgd2l0aEV4dCk7XG59O1xudmFyIGdlbmVyYXRlU2hhcmVGaWxlbmFtZSA9IChwa2dOYW1lLCB3aXRoRXh0KT0+e1xuICAgIGlmICghcGtnTmFtZSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIHJldHVybiBlbmNvZGVOYW1lKHBrZ05hbWUsICdfX2ZlZGVyYXRpb25fc2hhcmVkXycsIHdpdGhFeHQpO1xufTtcbnZhciBnZXRSZXNvdXJjZVVybCA9IChtb2R1bGUsIHNvdXJjZVVybCk9PntcbiAgICBpZiAoJ2dldFB1YmxpY1BhdGgnIGluIG1vZHVsZSkge1xuICAgICAgICB2YXIgcHVibGljUGF0aDtcbiAgICAgICAgaWYgKCFtb2R1bGUuZ2V0UHVibGljUGF0aC5zdGFydHNXaXRoKCdmdW5jdGlvbicpKSB7XG4gICAgICAgICAgICBwdWJsaWNQYXRoID0gbmV3IEZ1bmN0aW9uKG1vZHVsZS5nZXRQdWJsaWNQYXRoKSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHVibGljUGF0aCA9IG5ldyBGdW5jdGlvbigncmV0dXJuICcgKyBtb2R1bGUuZ2V0UHVibGljUGF0aCkoKSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgJHtwdWJsaWNQYXRofSR7c291cmNlVXJsfWA7XG4gICAgfSBlbHNlIGlmICgncHVibGljUGF0aCcgaW4gbW9kdWxlKSB7XG4gICAgICAgIHJldHVybiBgJHttb2R1bGUucHVibGljUGF0aH0ke3NvdXJjZVVybH1gO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUud2FybignQ2Fubm90IGdldCByZXNvdXJjZSBVUkwuIElmIGluIGRlYnVnIG1vZGUsIHBsZWFzZSBpZ25vcmUuJywgbW9kdWxlLCBzb3VyY2VVcmwpO1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufTtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvZXhwbGljaXQtbW9kdWxlLWJvdW5kYXJ5LXR5cGVzXG52YXIgYXNzZXJ0ID0gKGNvbmRpdGlvbiwgbXNnKT0+e1xuICAgIGlmICghY29uZGl0aW9uKSB7XG4gICAgICAgIGVycm9yKG1zZyk7XG4gICAgfVxufTtcbnZhciBlcnJvciA9IChtc2cpPT57XG4gICAgdGhyb3cgbmV3IEVycm9yKGAke0xPR19DQVRFR09SWX06ICR7bXNnfWApO1xufTtcbnZhciB3YXJuID0gKG1zZyk9PntcbiAgICBjb25zb2xlLndhcm4oYCR7TE9HX0NBVEVHT1JZfTogJHttc2d9YCk7XG59O1xuZnVuY3Rpb24gc2FmZVRvU3RyaW5nKGluZm8pIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoaW5mbywgbnVsbCwgMik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufVxuLy8gUmVnRXhwIGZvciB2ZXJzaW9uIHN0cmluZ1xudmFyIFZFUlNJT05fUEFUVEVSTl9SRUdFWFAgPSAvXihbXFxkXj12PD5+XXxbKnhYXSQpLztcbmZ1bmN0aW9uIGlzUmVxdWlyZWRWZXJzaW9uKHN0cikge1xuICAgIHJldHVybiBWRVJTSU9OX1BBVFRFUk5fUkVHRVhQLnRlc3Qoc3RyKTtcbn1cbnZhciBzaW1wbGVKb2luUmVtb3RlRW50cnkgPSAoclBhdGgsIHJOYW1lKT0+e1xuICAgIGlmICghclBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHJOYW1lO1xuICAgIH1cbiAgICB2YXIgdHJhbnNmb3JtUGF0aCA9IChzdHIpPT57XG4gICAgICAgIGlmIChzdHIgPT09ICcuJykge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdHIuc3RhcnRzV2l0aCgnLi8nKSkge1xuICAgICAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKCcuLycsICcnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgdmFyIHN0cldpdGhvdXRTbGFzaCA9IHN0ci5zbGljZSgxKTtcbiAgICAgICAgICAgIGlmIChzdHJXaXRob3V0U2xhc2guZW5kc1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdHJXaXRob3V0U2xhc2guc2xpY2UoMCwgLTEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHN0cldpdGhvdXRTbGFzaDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH07XG4gICAgdmFyIHRyYW5zZm9ybWVkUGF0aCA9IHRyYW5zZm9ybVBhdGgoclBhdGgpO1xuICAgIGlmICghdHJhbnNmb3JtZWRQYXRoKSB7XG4gICAgICAgIHJldHVybiByTmFtZTtcbiAgICB9XG4gICAgaWYgKHRyYW5zZm9ybWVkUGF0aC5lbmRzV2l0aCgnLycpKSB7XG4gICAgICAgIHJldHVybiBgJHt0cmFuc2Zvcm1lZFBhdGh9JHtyTmFtZX1gO1xuICAgIH1cbiAgICByZXR1cm4gYCR7dHJhbnNmb3JtZWRQYXRofS8ke3JOYW1lfWA7XG59O1xuZnVuY3Rpb24gaW5mZXJBdXRvUHVibGljUGF0aCh1cmwpIHtcbiAgICByZXR1cm4gdXJsLnJlcGxhY2UoLyMuKiQvLCAnJykucmVwbGFjZSgvXFw/LiokLywgJycpLnJlcGxhY2UoL1xcL1teXFwvXSskLywgJy8nKTtcbn1cbi8vIFByaW9yaXR5OiBvdmVycmlkZXMgPiByZW1vdGVzXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvblxuZnVuY3Rpb24gZ2VuZXJhdGVTbmFwc2hvdEZyb21NYW5pZmVzdChtYW5pZmVzdCwgcmVmKSB7XG4gICAgdmFyIG9wdGlvbnMgPSByZWYgPT09IHZvaWQgMCA/IHt9IDogcmVmO1xuICAgIHZhciBfbWFuaWZlc3RfbWV0YURhdGEsIF9tYW5pZmVzdF9tZXRhRGF0YTE7XG4gICAgdmFyIF9vcHRpb25zX3JlbW90ZXMgPSBvcHRpb25zLnJlbW90ZXMsIHJlbW90ZXMgPSBfb3B0aW9uc19yZW1vdGVzID09PSB2b2lkIDAgPyB7fSA6IF9vcHRpb25zX3JlbW90ZXMsIF9vcHRpb25zX292ZXJyaWRlcyA9IG9wdGlvbnMub3ZlcnJpZGVzLCBvdmVycmlkZXMgPSBfb3B0aW9uc19vdmVycmlkZXMgPT09IHZvaWQgMCA/IHt9IDogX29wdGlvbnNfb3ZlcnJpZGVzLCB2ZXJzaW9uID0gb3B0aW9ucy52ZXJzaW9uO1xuICAgIHZhciByZW1vdGVTbmFwc2hvdDtcbiAgICB2YXIgZ2V0UHVibGljUGF0aCA9ICgpPT57XG4gICAgICAgIGlmICgncHVibGljUGF0aCcgaW4gbWFuaWZlc3QubWV0YURhdGEpIHtcbiAgICAgICAgICAgIGlmIChtYW5pZmVzdC5tZXRhRGF0YS5wdWJsaWNQYXRoID09PSAnYXV0bycgJiYgdmVyc2lvbikge1xuICAgICAgICAgICAgICAgIC8vIHVzZSBzYW1lIGltcGxlbWVudGF0aW9uIGFzIHB1YmxpY1BhdGggYXV0byBydW50aW1lIG1vZHVsZSBpbXBsZW1lbnRzXG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZmVyQXV0b1B1YmxpY1BhdGgodmVyc2lvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWFuaWZlc3QubWV0YURhdGEucHVibGljUGF0aDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBtYW5pZmVzdC5tZXRhRGF0YS5nZXRQdWJsaWNQYXRoO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgb3ZlcnJpZGVzS2V5cyA9IE9iamVjdC5rZXlzKG92ZXJyaWRlcyk7XG4gICAgdmFyIHJlbW90ZXNJbmZvID0ge307XG4gICAgLy8gSWYgcmVtb3RlcyBhcmUgbm90IHByb3ZpZGVkLCBvbmx5IHRoZSByZW1vdGVzIGluIHRoZSBtYW5pZmVzdCB3aWxsIGJlIHJlYWRcbiAgICBpZiAoIU9iamVjdC5rZXlzKHJlbW90ZXMpLmxlbmd0aCkge1xuICAgICAgICB2YXIgX21hbmlmZXN0X3JlbW90ZXM7XG4gICAgICAgIHJlbW90ZXNJbmZvID0gKChfbWFuaWZlc3RfcmVtb3RlcyA9IG1hbmlmZXN0LnJlbW90ZXMpID09IG51bGwgPyB2b2lkIDAgOiBfbWFuaWZlc3RfcmVtb3Rlcy5yZWR1Y2UoKHJlcywgbmV4dCk9PntcbiAgICAgICAgICAgIHZhciBtYXRjaGVkVmVyc2lvbjtcbiAgICAgICAgICAgIHZhciBuYW1lID0gbmV4dC5mZWRlcmF0aW9uQ29udGFpbmVyTmFtZTtcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlcyBoYXZlIGhpZ2hlciBwcmlvcml0eVxuICAgICAgICAgICAgaWYgKG92ZXJyaWRlc0tleXMuaW5jbHVkZXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICBtYXRjaGVkVmVyc2lvbiA9IG92ZXJyaWRlc1tuYW1lXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCd2ZXJzaW9uJyBpbiBuZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uID0gbmV4dC52ZXJzaW9uO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uID0gbmV4dC5lbnRyeTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNbbmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgbWF0Y2hlZFZlcnNpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9LCB7fSkpIHx8IHt9O1xuICAgIH1cbiAgICAvLyBJZiByZW1vdGVzIChkZXBsb3kgc2NlbmFyaW8pIGFyZSBzcGVjaWZpZWQsIHRoZXkgbmVlZCB0byBiZSB0cmF2ZXJzZWQgYWdhaW5cbiAgICBPYmplY3Qua2V5cyhyZW1vdGVzKS5mb3JFYWNoKChrZXkpPT5yZW1vdGVzSW5mb1trZXldID0ge1xuICAgICAgICAgICAgLy8gb3ZlcnJpZGVzIHdpbGwgb3ZlcnJpZGUgZGVwZW5kZW5jaWVzXG4gICAgICAgICAgICBtYXRjaGVkVmVyc2lvbjogb3ZlcnJpZGVzS2V5cy5pbmNsdWRlcyhrZXkpID8gb3ZlcnJpZGVzW2tleV0gOiByZW1vdGVzW2tleV1cbiAgICAgICAgfSk7XG4gICAgdmFyIF9tYW5pZmVzdF9tZXRhRGF0YTIgPSBtYW5pZmVzdC5tZXRhRGF0YSwgX21hbmlmZXN0X21ldGFEYXRhX3JlbW90ZUVudHJ5ID0gX21hbmlmZXN0X21ldGFEYXRhMi5yZW1vdGVFbnRyeSwgcmVtb3RlRW50cnlQYXRoID0gX21hbmlmZXN0X21ldGFEYXRhX3JlbW90ZUVudHJ5LnBhdGgsIHJlbW90ZUVudHJ5TmFtZSA9IF9tYW5pZmVzdF9tZXRhRGF0YV9yZW1vdGVFbnRyeS5uYW1lLCByZW1vdGVFbnRyeVR5cGUgPSBfbWFuaWZlc3RfbWV0YURhdGFfcmVtb3RlRW50cnkudHlwZSwgcmVtb3RlVHlwZXMgPSBfbWFuaWZlc3RfbWV0YURhdGEyLnR5cGVzLCBidWlsZFZlcnNpb24gPSBfbWFuaWZlc3RfbWV0YURhdGEyLmJ1aWxkSW5mby5idWlsZFZlcnNpb24sIGdsb2JhbE5hbWUgPSBfbWFuaWZlc3RfbWV0YURhdGEyLmdsb2JhbE5hbWUsIHNzclJlbW90ZUVudHJ5ID0gX21hbmlmZXN0X21ldGFEYXRhMi5zc3JSZW1vdGVFbnRyeTtcbiAgICB2YXIgZXhwb3NlcyA9IG1hbmlmZXN0LmV4cG9zZXM7XG4gICAgdmFyIGJhc2ljUmVtb3RlU25hcHNob3QgPSB7XG4gICAgICAgIHZlcnNpb246IHZlcnNpb24gPyB2ZXJzaW9uIDogJycsXG4gICAgICAgIGJ1aWxkVmVyc2lvbixcbiAgICAgICAgZ2xvYmFsTmFtZSxcbiAgICAgICAgcmVtb3RlRW50cnk6IHNpbXBsZUpvaW5SZW1vdGVFbnRyeShyZW1vdGVFbnRyeVBhdGgsIHJlbW90ZUVudHJ5TmFtZSksXG4gICAgICAgIHJlbW90ZUVudHJ5VHlwZSxcbiAgICAgICAgcmVtb3RlVHlwZXM6IHNpbXBsZUpvaW5SZW1vdGVFbnRyeShyZW1vdGVUeXBlcy5wYXRoLCByZW1vdGVUeXBlcy5uYW1lKSxcbiAgICAgICAgcmVtb3RlVHlwZXNaaXA6IHJlbW90ZVR5cGVzLnppcCB8fCAnJyxcbiAgICAgICAgcmVtb3RlVHlwZXNBUEk6IHJlbW90ZVR5cGVzLmFwaSB8fCAnJyxcbiAgICAgICAgcmVtb3Rlc0luZm8sXG4gICAgICAgIHNoYXJlZDogbWFuaWZlc3QgPT0gbnVsbCA/IHZvaWQgMCA6IG1hbmlmZXN0LnNoYXJlZC5tYXAoKGl0ZW0pPT4oe1xuICAgICAgICAgICAgICAgIGFzc2V0czogaXRlbS5hc3NldHMsXG4gICAgICAgICAgICAgICAgc2hhcmVkTmFtZTogaXRlbS5uYW1lLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IGl0ZW0udmVyc2lvblxuICAgICAgICAgICAgfSkpLFxuICAgICAgICBtb2R1bGVzOiBleHBvc2VzID09IG51bGwgPyB2b2lkIDAgOiBleHBvc2VzLm1hcCgoZXhwb3NlKT0+KHtcbiAgICAgICAgICAgICAgICBtb2R1bGVOYW1lOiBleHBvc2UubmFtZSxcbiAgICAgICAgICAgICAgICBtb2R1bGVQYXRoOiBleHBvc2UucGF0aCxcbiAgICAgICAgICAgICAgICBhc3NldHM6IGV4cG9zZS5hc3NldHNcbiAgICAgICAgICAgIH0pKVxuICAgIH07XG4gICAgaWYgKChfbWFuaWZlc3RfbWV0YURhdGEgPSBtYW5pZmVzdC5tZXRhRGF0YSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9tYW5pZmVzdF9tZXRhRGF0YS5wcmVmZXRjaEludGVyZmFjZSkge1xuICAgICAgICB2YXIgcHJlZmV0Y2hJbnRlcmZhY2UgPSBtYW5pZmVzdC5tZXRhRGF0YS5wcmVmZXRjaEludGVyZmFjZTtcbiAgICAgICAgYmFzaWNSZW1vdGVTbmFwc2hvdCA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgYmFzaWNSZW1vdGVTbmFwc2hvdCwge1xuICAgICAgICAgICAgcHJlZmV0Y2hJbnRlcmZhY2VcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmICgoX21hbmlmZXN0X21ldGFEYXRhMSA9IG1hbmlmZXN0Lm1ldGFEYXRhKSA9PSBudWxsID8gdm9pZCAwIDogX21hbmlmZXN0X21ldGFEYXRhMS5wcmVmZXRjaEVudHJ5KSB7XG4gICAgICAgIHZhciBfbWFuaWZlc3RfbWV0YURhdGFfcHJlZmV0Y2hFbnRyeSA9IG1hbmlmZXN0Lm1ldGFEYXRhLnByZWZldGNoRW50cnksIHBhdGggPSBfbWFuaWZlc3RfbWV0YURhdGFfcHJlZmV0Y2hFbnRyeS5wYXRoLCBuYW1lID0gX21hbmlmZXN0X21ldGFEYXRhX3ByZWZldGNoRW50cnkubmFtZSwgdHlwZSA9IF9tYW5pZmVzdF9tZXRhRGF0YV9wcmVmZXRjaEVudHJ5LnR5cGU7XG4gICAgICAgIGJhc2ljUmVtb3RlU25hcHNob3QgPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGJhc2ljUmVtb3RlU25hcHNob3QsIHtcbiAgICAgICAgICAgIHByZWZldGNoRW50cnk6IHNpbXBsZUpvaW5SZW1vdGVFbnRyeShwYXRoLCBuYW1lKSxcbiAgICAgICAgICAgIHByZWZldGNoRW50cnlUeXBlOiB0eXBlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoJ3B1YmxpY1BhdGgnIGluIG1hbmlmZXN0Lm1ldGFEYXRhKSB7XG4gICAgICAgIHJlbW90ZVNuYXBzaG90ID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBiYXNpY1JlbW90ZVNuYXBzaG90LCB7XG4gICAgICAgICAgICBwdWJsaWNQYXRoOiBnZXRQdWJsaWNQYXRoKClcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVtb3RlU25hcHNob3QgPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGJhc2ljUmVtb3RlU25hcHNob3QsIHtcbiAgICAgICAgICAgIGdldFB1YmxpY1BhdGg6IGdldFB1YmxpY1BhdGgoKVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHNzclJlbW90ZUVudHJ5KSB7XG4gICAgICAgIHZhciBmdWxsU1NSUmVtb3RlRW50cnkgPSBzaW1wbGVKb2luUmVtb3RlRW50cnkoc3NyUmVtb3RlRW50cnkucGF0aCwgc3NyUmVtb3RlRW50cnkubmFtZSk7XG4gICAgICAgIHJlbW90ZVNuYXBzaG90LnNzclJlbW90ZUVudHJ5ID0gZnVsbFNTUlJlbW90ZUVudHJ5O1xuICAgICAgICByZW1vdGVTbmFwc2hvdC5zc3JSZW1vdGVFbnRyeVR5cGUgPSBzc3JSZW1vdGVFbnRyeS50eXBlIHx8ICdjb21tb25qcy1tb2R1bGUnO1xuICAgIH1cbiAgICByZXR1cm4gcmVtb3RlU25hcHNob3Q7XG59XG5mdW5jdGlvbiBpc01hbmlmZXN0UHJvdmlkZXIobW9kdWxlSW5mbykge1xuICAgIGlmICgncmVtb3RlRW50cnknIGluIG1vZHVsZUluZm8gJiYgbW9kdWxlSW5mby5yZW1vdGVFbnRyeS5pbmNsdWRlcyhNQU5JRkVTVF9FWFQpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG52YXIgUFJFRklYID0gJ1sgTW9kdWxlIEZlZGVyYXRpb24gXSc7XG52YXIgTG9nZ2VyID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBMb2dnZXIxKHByZWZpeCkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIExvZ2dlcjEpO1xuICAgICAgICB0aGlzLnByZWZpeCA9IHByZWZpeDtcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKExvZ2dlcjEsIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvZ1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvZyguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcIndhcm5cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB3YXJuMSguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImVycm9yXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZXJyb3IxKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic3VjY2Vzc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN1Y2Nlc3MoLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbmZvXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5mbyguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlYWR5XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZHkoLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJkZWJ1Z1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlYnVnKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNEZWJ1Z01vZGUoKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBMb2dnZXIxO1xufSgpO1xuZnVuY3Rpb24gY3JlYXRlTG9nZ2VyKHByZWZpeCkge1xuICAgIHJldHVybiBuZXcgTG9nZ2VyKHByZWZpeCk7XG59XG52YXIgbG9nZ2VyID0gY3JlYXRlTG9nZ2VyKFBSRUZJWCk7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZnVuY3Rpb24gc2FmZVdyYXBwZXIoY2FsbGJhY2ssIGRpc2FibGVXYXJuKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgcmVzID0geWllbGQgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICFkaXNhYmxlV2FybiAmJiB3YXJuKGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSkoKTtcbn1cbmZ1bmN0aW9uIGlzU3RhdGljUmVzb3VyY2VzRXF1YWwodXJsMSwgdXJsMikge1xuICAgIHZhciBSRUdfRVhQID0gL14oaHR0cHM/Oik/XFwvXFwvL2k7XG4gICAgLy8gVHJhbnNmb3JtIHVybDEgYW5kIHVybDIgaW50byByZWxhdGl2ZSBwYXRoc1xuICAgIHZhciByZWxhdGl2ZVVybDEgPSB1cmwxLnJlcGxhY2UoUkVHX0VYUCwgJycpLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gICAgdmFyIHJlbGF0aXZlVXJsMiA9IHVybDIucmVwbGFjZShSRUdfRVhQLCAnJykucmVwbGFjZSgvXFwvJC8sICcnKTtcbiAgICAvLyBDaGVjayBpZiB0aGUgcmVsYXRpdmUgcGF0aHMgYXJlIGlkZW50aWNhbFxuICAgIHJldHVybiByZWxhdGl2ZVVybDEgPT09IHJlbGF0aXZlVXJsMjtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVNjcmlwdChpbmZvKSB7XG4gICAgLy8gUmV0cmlldmUgdGhlIGV4aXN0aW5nIHNjcmlwdCBlbGVtZW50IGJ5IGl0cyBzcmMgYXR0cmlidXRlXG4gICAgdmFyIHNjcmlwdCA9IG51bGw7XG4gICAgdmFyIG5lZWRBdHRhY2ggPSB0cnVlO1xuICAgIHZhciB0aW1lb3V0ID0gMjAwMDA7XG4gICAgdmFyIHRpbWVvdXRJZDtcbiAgICB2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgc2NyaXB0cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIHZhciBzID0gc2NyaXB0c1tpXTtcbiAgICAgICAgdmFyIHNjcmlwdFNyYyA9IHMuZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICAgICAgaWYgKHNjcmlwdFNyYyAmJiBpc1N0YXRpY1Jlc291cmNlc0VxdWFsKHNjcmlwdFNyYywgaW5mby51cmwpKSB7XG4gICAgICAgICAgICBzY3JpcHQgPSBzO1xuICAgICAgICAgICAgbmVlZEF0dGFjaCA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFzY3JpcHQpIHtcbiAgICAgICAgdmFyIGF0dHJzID0gaW5mby5hdHRycztcbiAgICAgICAgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICAgIHNjcmlwdC50eXBlID0gKGF0dHJzID09IG51bGwgPyB2b2lkIDAgOiBhdHRyc1sndHlwZSddKSA9PT0gJ21vZHVsZScgPyAnbW9kdWxlJyA6ICd0ZXh0L2phdmFzY3JpcHQnO1xuICAgICAgICB2YXIgY3JlYXRlU2NyaXB0UmVzID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoaW5mby5jcmVhdGVTY3JpcHRIb29rKSB7XG4gICAgICAgICAgICBjcmVhdGVTY3JpcHRSZXMgPSBpbmZvLmNyZWF0ZVNjcmlwdEhvb2soaW5mby51cmwsIGluZm8uYXR0cnMpO1xuICAgICAgICAgICAgaWYgKGNyZWF0ZVNjcmlwdFJlcyBpbnN0YW5jZW9mIEhUTUxTY3JpcHRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgc2NyaXB0ID0gY3JlYXRlU2NyaXB0UmVzO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY3JlYXRlU2NyaXB0UmVzID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIGlmICgnc2NyaXB0JyBpbiBjcmVhdGVTY3JpcHRSZXMgJiYgY3JlYXRlU2NyaXB0UmVzLnNjcmlwdCkge1xuICAgICAgICAgICAgICAgICAgICBzY3JpcHQgPSBjcmVhdGVTY3JpcHRSZXMuc2NyaXB0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJ3RpbWVvdXQnIGluIGNyZWF0ZVNjcmlwdFJlcyAmJiBjcmVhdGVTY3JpcHRSZXMudGltZW91dCkge1xuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0ID0gY3JlYXRlU2NyaXB0UmVzLnRpbWVvdXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghc2NyaXB0LnNyYykge1xuICAgICAgICAgICAgc2NyaXB0LnNyYyA9IGluZm8udXJsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhdHRycyAmJiAhY3JlYXRlU2NyaXB0UmVzKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhhdHRycykuZm9yRWFjaCgobmFtZSk9PntcbiAgICAgICAgICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAnYXN5bmMnIHx8IG5hbWUgPT09ICdkZWZlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdFtuYW1lXSA9IGF0dHJzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRyaWJ1dGVzIHRoYXQgZG8gbm90IGV4aXN0IGFyZSBjb25zaWRlcmVkIG92ZXJyaWRkZW5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghc2NyaXB0LmdldEF0dHJpYnV0ZShuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NyaXB0LnNldEF0dHJpYnV0ZShuYW1lLCBhdHRyc1tuYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgb25TY3JpcHRDb21wbGV0ZSA9IChwcmV2LCBldmVudCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgICAgIHZhciBvblNjcmlwdENvbXBsZXRlQ2FsbGJhY2sgPSAoKT0+e1xuICAgICAgICAgICAgICAgIGlmICgoZXZlbnQgPT0gbnVsbCA/IHZvaWQgMCA6IGV2ZW50LnR5cGUpID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgICAgICAgICAgIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLm9uRXJyb3JDYWxsYmFjaykgJiYgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8ub25FcnJvckNhbGxiYWNrKGV2ZW50KSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8uY2IpICYmIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLmNiKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvLyBQcmV2ZW50IG1lbW9yeSBsZWFrcyBpbiBJRS5cbiAgICAgICAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgICAgICAgICBzY3JpcHQub25lcnJvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgc2NyaXB0Lm9ubG9hZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc2FmZVdyYXBwZXIoKCk9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9pbmZvX25lZWREZWxldGVTY3JpcHQgPSBpbmZvLm5lZWREZWxldGVTY3JpcHQsIG5lZWREZWxldGVTY3JpcHQgPSBfaW5mb19uZWVkRGVsZXRlU2NyaXB0ID09PSB2b2lkIDAgPyB0cnVlIDogX2luZm9fbmVlZERlbGV0ZVNjcmlwdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5lZWREZWxldGVTY3JpcHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIChzY3JpcHQgPT0gbnVsbCA/IHZvaWQgMCA6IHNjcmlwdC5wYXJlbnROb2RlKSAmJiBzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHByZXYgJiYgdHlwZW9mIHByZXYgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHByZXYoZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uU2NyaXB0Q29tcGxldGVDYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBvblNjcmlwdENvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvblNjcmlwdENvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICAgICAgfSkoKTtcbiAgICBzY3JpcHQub25lcnJvciA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25lcnJvcik7XG4gICAgc2NyaXB0Lm9ubG9hZCA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25sb2FkKTtcbiAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpPT57XG4gICAgICAgIG9uU2NyaXB0Q29tcGxldGUobnVsbCwgbmV3IEVycm9yKGBSZW1vdGUgc2NyaXB0IFwiJHtpbmZvLnVybH1cIiB0aW1lLW91dGVkLmApKTtcbiAgICB9LCB0aW1lb3V0KTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzY3JpcHQsXG4gICAgICAgIG5lZWRBdHRhY2hcbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlTGluayhpbmZvKSB7XG4gICAgLy8gPGxpbmsgcmVsPVwicHJlbG9hZFwiIGhyZWY9XCJzY3JpcHQuanNcIiBhcz1cInNjcmlwdFwiPlxuICAgIC8vIFJldHJpZXZlIHRoZSBleGlzdGluZyBzY3JpcHQgZWxlbWVudCBieSBpdHMgc3JjIGF0dHJpYnV0ZVxuICAgIHZhciBsaW5rID0gbnVsbDtcbiAgICB2YXIgbmVlZEF0dGFjaCA9IHRydWU7XG4gICAgdmFyIGxpbmtzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2xpbmsnKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgbCA9IGxpbmtzW2ldO1xuICAgICAgICB2YXIgbGlua0hyZWYgPSBsLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuICAgICAgICB2YXIgbGlua1JlbCA9IGwuZ2V0QXR0cmlidXRlKCdyZWwnKTtcbiAgICAgICAgaWYgKGxpbmtIcmVmICYmIGlzU3RhdGljUmVzb3VyY2VzRXF1YWwobGlua0hyZWYsIGluZm8udXJsKSAmJiBsaW5rUmVsID09PSBpbmZvLmF0dHJzWydyZWwnXSkge1xuICAgICAgICAgICAgbGluayA9IGw7XG4gICAgICAgICAgICBuZWVkQXR0YWNoID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWxpbmspIHtcbiAgICAgICAgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBpbmZvLnVybCk7XG4gICAgICAgIHZhciBjcmVhdGVMaW5rUmVzID0gdW5kZWZpbmVkO1xuICAgICAgICB2YXIgYXR0cnMgPSBpbmZvLmF0dHJzO1xuICAgICAgICBpZiAoaW5mby5jcmVhdGVMaW5rSG9vaykge1xuICAgICAgICAgICAgY3JlYXRlTGlua1JlcyA9IGluZm8uY3JlYXRlTGlua0hvb2soaW5mby51cmwsIGF0dHJzKTtcbiAgICAgICAgICAgIGlmIChjcmVhdGVMaW5rUmVzIGluc3RhbmNlb2YgSFRNTExpbmtFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgbGluayA9IGNyZWF0ZUxpbmtSZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGF0dHJzICYmICFjcmVhdGVMaW5rUmVzKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhhdHRycykuZm9yRWFjaCgobmFtZSk9PntcbiAgICAgICAgICAgICAgICBpZiAobGluayAmJiAhbGluay5nZXRBdHRyaWJ1dGUobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUobmFtZSwgYXR0cnNbbmFtZV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBvbkxpbmtDb21wbGV0ZSA9IChwcmV2LCBldmVudCk9PntcbiAgICAgICAgdmFyIG9uTGlua0NvbXBsZXRlQ2FsbGJhY2sgPSAoKT0+e1xuICAgICAgICAgICAgaWYgKChldmVudCA9PSBudWxsID8gdm9pZCAwIDogZXZlbnQudHlwZSkgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgICAgICAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5vbkVycm9yQ2FsbGJhY2spICYmIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLm9uRXJyb3JDYWxsYmFjayhldmVudCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5jYikgJiYgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8uY2IoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIFByZXZlbnQgbWVtb3J5IGxlYWtzIGluIElFLlxuICAgICAgICBpZiAobGluaykge1xuICAgICAgICAgICAgbGluay5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgIGxpbmsub25sb2FkID0gbnVsbDtcbiAgICAgICAgICAgIHNhZmVXcmFwcGVyKCgpPT57XG4gICAgICAgICAgICAgICAgdmFyIF9pbmZvX25lZWREZWxldGVMaW5rID0gaW5mby5uZWVkRGVsZXRlTGluaywgbmVlZERlbGV0ZUxpbmsgPSBfaW5mb19uZWVkRGVsZXRlTGluayA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9pbmZvX25lZWREZWxldGVMaW5rO1xuICAgICAgICAgICAgICAgIGlmIChuZWVkRGVsZXRlTGluaykge1xuICAgICAgICAgICAgICAgICAgICAobGluayA9PSBudWxsID8gdm9pZCAwIDogbGluay5wYXJlbnROb2RlKSAmJiBsaW5rLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGluayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocHJldikge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IHByZXYoZXZlbnQpO1xuICAgICAgICAgICAgICAgIG9uTGlua0NvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG9uTGlua0NvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICB9O1xuICAgIGxpbmsub25lcnJvciA9IG9uTGlua0NvbXBsZXRlLmJpbmQobnVsbCwgbGluay5vbmVycm9yKTtcbiAgICBsaW5rLm9ubG9hZCA9IG9uTGlua0NvbXBsZXRlLmJpbmQobnVsbCwgbGluay5vbmxvYWQpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGxpbmssXG4gICAgICAgIG5lZWRBdHRhY2hcbiAgICB9O1xufVxuZnVuY3Rpb24gbG9hZFNjcmlwdCh1cmwsIGluZm8pIHtcbiAgICB2YXIgX2luZm9fYXR0cnMgPSBpbmZvLmF0dHJzLCBhdHRycyA9IF9pbmZvX2F0dHJzID09PSB2b2lkIDAgPyB7fSA6IF9pbmZvX2F0dHJzLCBjcmVhdGVTY3JpcHRIb29rID0gaW5mby5jcmVhdGVTY3JpcHRIb29rO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+e1xuICAgICAgICB2YXIgX2NyZWF0ZVNjcmlwdCA9IGNyZWF0ZVNjcmlwdCh7XG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICBjYjogcmVzb2x2ZSxcbiAgICAgICAgICAgIG9uRXJyb3JDYWxsYmFjazogcmVqZWN0LFxuICAgICAgICAgICAgYXR0cnM6IHBvbHlmaWxscy5fZXh0ZW5kcyh7XG4gICAgICAgICAgICAgICAgZmV0Y2hwcmlvcml0eTogJ2hpZ2gnXG4gICAgICAgICAgICB9LCBhdHRycyksXG4gICAgICAgICAgICBjcmVhdGVTY3JpcHRIb29rLFxuICAgICAgICAgICAgbmVlZERlbGV0ZVNjcmlwdDogdHJ1ZVxuICAgICAgICB9KSwgc2NyaXB0ID0gX2NyZWF0ZVNjcmlwdC5zY3JpcHQsIG5lZWRBdHRhY2ggPSBfY3JlYXRlU2NyaXB0Lm5lZWRBdHRhY2g7XG4gICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gaW1wb3J0Tm9kZU1vZHVsZShuYW1lKSB7XG4gICAgaWYgKCFuYW1lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignaW1wb3J0IHNwZWNpZmllciBpcyByZXF1aXJlZCcpO1xuICAgIH1cbiAgICB2YXIgaW1wb3J0TW9kdWxlID0gbmV3IEZ1bmN0aW9uKCduYW1lJywgYHJldHVybiBpbXBvcnQobmFtZSlgKTtcbiAgICByZXR1cm4gaW1wb3J0TW9kdWxlKG5hbWUpLnRoZW4oKHJlcyk9PnJlcykuY2F0Y2goKGVycm9yMSk9PntcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgaW1wb3J0aW5nIG1vZHVsZSAke25hbWV9OmAsIGVycm9yMSk7XG4gICAgICAgIHRocm93IGVycm9yMTtcbiAgICB9KTtcbn1cbnZhciBsb2FkTm9kZUZldGNoID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHZhciBmZXRjaE1vZHVsZSA9IHlpZWxkIGltcG9ydE5vZGVNb2R1bGUoJ25vZGUtZmV0Y2gnKTtcbiAgICAgICAgcmV0dXJuIGZldGNoTW9kdWxlLmRlZmF1bHQgfHwgZmV0Y2hNb2R1bGU7XG4gICAgfSkoKTtcbnZhciBsYXp5TG9hZGVySG9va0ZldGNoID0gKGlucHV0LCBpbml0LCBsb2FkZXJIb29rKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgdmFyIGhvb2sgPSAodXJsLCBpbml0KT0+e1xuICAgICAgICAgICAgcmV0dXJuIGxvYWRlckhvb2subGlmZWN5Y2xlLmZldGNoLmVtaXQodXJsLCBpbml0KTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHJlcyA9IHlpZWxkIGhvb2soaW5wdXQsIGluaXQgfHwge30pO1xuICAgICAgICBpZiAoIXJlcyB8fCAhKHJlcyBpbnN0YW5jZW9mIFJlc3BvbnNlKSkge1xuICAgICAgICAgICAgdmFyIGZldGNoRnVuY3Rpb24gPSB0eXBlb2YgZmV0Y2ggPT09ICd1bmRlZmluZWQnID8geWllbGQgbG9hZE5vZGVGZXRjaCgpIDogZmV0Y2g7XG4gICAgICAgICAgICByZXR1cm4gZmV0Y2hGdW5jdGlvbihpbnB1dCwgaW5pdCB8fCB7fSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9KSgpO1xuZnVuY3Rpb24gY3JlYXRlU2NyaXB0Tm9kZSh1cmwsIGNiLCBhdHRycywgbG9hZGVySG9vaykge1xuICAgIGlmIChsb2FkZXJIb29rID09IG51bGwgPyB2b2lkIDAgOiBsb2FkZXJIb29rLmNyZWF0ZVNjcmlwdEhvb2spIHtcbiAgICAgICAgdmFyIGhvb2tSZXN1bHQgPSBsb2FkZXJIb29rLmNyZWF0ZVNjcmlwdEhvb2sodXJsKTtcbiAgICAgICAgaWYgKGhvb2tSZXN1bHQgJiYgdHlwZW9mIGhvb2tSZXN1bHQgPT09ICdvYmplY3QnICYmICd1cmwnIGluIGhvb2tSZXN1bHQpIHtcbiAgICAgICAgICAgIHVybCA9IGhvb2tSZXN1bHQudXJsO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciB1cmxPYmo7XG4gICAgdHJ5IHtcbiAgICAgICAgdXJsT2JqID0gbmV3IFVSTCh1cmwpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY29uc3RydWN0aW5nIFVSTDonLCBlKTtcbiAgICAgICAgY2IobmV3IEVycm9yKGBJbnZhbGlkIFVSTDogJHtlfWApKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgZ2V0RmV0Y2ggPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgIGlmIChsb2FkZXJIb29rID09IG51bGwgPyB2b2lkIDAgOiBsb2FkZXJIb29rLmZldGNoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChpbnB1dCwgaW5pdCk9PmxhenlMb2FkZXJIb29rRmV0Y2goaW5wdXQsIGluaXQsIGxvYWRlckhvb2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBmZXRjaCA9PT0gJ3VuZGVmaW5lZCcgPyBsb2FkTm9kZUZldGNoKCkgOiBmZXRjaDtcbiAgICAgICAgfSkoKTtcbiAgICB2YXIgaGFuZGxlU2NyaXB0RmV0Y2ggPSAoZiwgdXJsT2JqKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIF92bV9jb25zdGFudHM7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIGYodXJsT2JqLmhyZWYpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0geWllbGQgcmVzLnRleHQoKTtcbiAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXygoeWllbGQgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgICAgICAgICBpbXBvcnROb2RlTW9kdWxlKCdwYXRoJyksXG4gICAgICAgICAgICAgICAgICAgIGltcG9ydE5vZGVNb2R1bGUoJ3ZtJylcbiAgICAgICAgICAgICAgICBdKSksIDIpLCBwYXRoID0gX3JlZlswXSwgdm0gPSBfcmVmWzFdO1xuICAgICAgICAgICAgICAgIHZhciBzY3JpcHRDb250ZXh0ID0ge1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRzOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBvcnRzOiB7fVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgdXJsRGlybmFtZSA9IHVybE9iai5wYXRobmFtZS5zcGxpdCgnLycpLnNsaWNlKDAsIC0xKS5qb2luKCcvJyk7XG4gICAgICAgICAgICAgICAgdmFyIGZpbGVuYW1lID0gcGF0aC5iYXNlbmFtZSh1cmxPYmoucGF0aG5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBfdm1fY29uc3RhbnRzX1VTRV9NQUlOX0NPTlRFWFRfREVGQVVMVF9MT0FERVI7XG4gICAgICAgICAgICAgICAgdmFyIHNjcmlwdCA9IG5ldyB2bS5TY3JpcHQoYChmdW5jdGlvbihleHBvcnRzLCBtb2R1bGUsIHJlcXVpcmUsIF9fZGlybmFtZSwgX19maWxlbmFtZSkgeyR7ZGF0YX1cXG59KWAsIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGltcG9ydE1vZHVsZUR5bmFtaWNhbGx5OiAoX3ZtX2NvbnN0YW50c19VU0VfTUFJTl9DT05URVhUX0RFRkFVTFRfTE9BREVSID0gKF92bV9jb25zdGFudHMgPSB2bS5jb25zdGFudHMpID09IG51bGwgPyB2b2lkIDAgOiBfdm1fY29uc3RhbnRzLlVTRV9NQUlOX0NPTlRFWFRfREVGQVVMVF9MT0FERVIpICE9IG51bGwgPyBfdm1fY29uc3RhbnRzX1VTRV9NQUlOX0NPTlRFWFRfREVGQVVMVF9MT0FERVIgOiBpbXBvcnROb2RlTW9kdWxlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgc2NyaXB0LnJ1bkluVGhpc0NvbnRleHQoKShzY3JpcHRDb250ZXh0LmV4cG9ydHMsIHNjcmlwdENvbnRleHQubW9kdWxlLCBldmFsKCdyZXF1aXJlJyksIHVybERpcm5hbWUsIGZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgZXhwb3J0ZWRJbnRlcmZhY2UgPSBzY3JpcHRDb250ZXh0Lm1vZHVsZS5leHBvcnRzIHx8IHNjcmlwdENvbnRleHQuZXhwb3J0cztcbiAgICAgICAgICAgICAgICBpZiAoYXR0cnMgJiYgZXhwb3J0ZWRJbnRlcmZhY2UgJiYgYXR0cnNbJ2dsb2JhbE5hbWUnXSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyID0gZXhwb3J0ZWRJbnRlcmZhY2VbYXR0cnNbJ2dsb2JhbE5hbWUnXV0gfHwgZXhwb3J0ZWRJbnRlcmZhY2U7XG4gICAgICAgICAgICAgICAgICAgIGNiKHVuZGVmaW5lZCwgY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYih1bmRlZmluZWQsIGV4cG9ydGVkSW50ZXJmYWNlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjYihlIGluc3RhbmNlb2YgRXJyb3IgPyBlIDogbmV3IEVycm9yKGBTY3JpcHQgZXhlY3V0aW9uIGVycm9yOiAke2V9YCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSgpO1xuICAgIGdldEZldGNoKCkudGhlbigoZik9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICBpZiAoKGF0dHJzID09IG51bGwgPyB2b2lkIDAgOiBhdHRyc1sndHlwZSddKSA9PT0gJ2VzbScgfHwgKGF0dHJzID09IG51bGwgPyB2b2lkIDAgOiBhdHRyc1sndHlwZSddKSA9PT0gJ21vZHVsZScpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZE1vZHVsZSh1cmxPYmouaHJlZiwge1xuICAgICAgICAgICAgICAgICAgICBmZXRjaDogZixcbiAgICAgICAgICAgICAgICAgICAgdm06IHlpZWxkIGltcG9ydE5vZGVNb2R1bGUoJ3ZtJylcbiAgICAgICAgICAgICAgICB9KS50aGVuKChtb2R1bGUpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgbW9kdWxlLmV2YWx1YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYih1bmRlZmluZWQsIG1vZHVsZS5uYW1lc3BhY2UpO1xuICAgICAgICAgICAgICAgICAgICB9KSgpKS5jYXRjaCgoZSk9PntcbiAgICAgICAgICAgICAgICAgICAgY2IoZSBpbnN0YW5jZW9mIEVycm9yID8gZSA6IG5ldyBFcnJvcihgU2NyaXB0IGV4ZWN1dGlvbiBlcnJvcjogJHtlfWApKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhhbmRsZVNjcmlwdEZldGNoKGYsIHVybE9iaik7XG4gICAgICAgIH0pKCkpLmNhdGNoKChlcnIpPT57XG4gICAgICAgIGNiKGVycik7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBsb2FkU2NyaXB0Tm9kZSh1cmwsIGluZm8pIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCk9PntcbiAgICAgICAgY3JlYXRlU2NyaXB0Tm9kZSh1cmwsIChlcnJvcjEsIHNjcmlwdENvbnRleHQpPT57XG4gICAgICAgICAgICBpZiAoZXJyb3IxKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yMSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBfaW5mb19hdHRycywgX2luZm9fYXR0cnMxO1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVFbnRyeUtleSA9IChpbmZvID09IG51bGwgPyB2b2lkIDAgOiAoX2luZm9fYXR0cnMgPSBpbmZvLmF0dHJzKSA9PSBudWxsID8gdm9pZCAwIDogX2luZm9fYXR0cnNbJ2dsb2JhbE5hbWUnXSkgfHwgYF9fRkVERVJBVElPTl8ke2luZm8gPT0gbnVsbCA/IHZvaWQgMCA6IChfaW5mb19hdHRyczEgPSBpbmZvLmF0dHJzKSA9PSBudWxsID8gdm9pZCAwIDogX2luZm9fYXR0cnMxWyduYW1lJ119OmN1c3RvbV9fYDtcbiAgICAgICAgICAgICAgICB2YXIgZW50cnlFeHBvcnRzID0gZ2xvYmFsVGhpc1tyZW1vdGVFbnRyeUtleV0gPSBzY3JpcHRDb250ZXh0O1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZW50cnlFeHBvcnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgaW5mby5hdHRycywgaW5mby5sb2FkZXJIb29rKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGxvYWRNb2R1bGUodXJsLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHZhciBmZXRjaDEgPSBvcHRpb25zLmZldGNoLCB2bSA9IG9wdGlvbnMudm07XG4gICAgICAgIHZhciByZXNwb25zZSA9IHlpZWxkIGZldGNoMSh1cmwpO1xuICAgICAgICB2YXIgY29kZSA9IHlpZWxkIHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgdmFyIG1vZHVsZSA9IG5ldyB2bS5Tb3VyY2VUZXh0TW9kdWxlKGNvZGUsIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGltcG9ydE1vZHVsZUR5bmFtaWNhbGx5OiAoc3BlY2lmaWVyLCBzY3JpcHQpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzb2x2ZWRVcmwgPSBuZXcgVVJMKHNwZWNpZmllciwgdXJsKS5ocmVmO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9hZE1vZHVsZShyZXNvbHZlZFVybCwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSkoKVxuICAgICAgICB9KTtcbiAgICAgICAgeWllbGQgbW9kdWxlLmxpbmsoKHNwZWNpZmllcik9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc29sdmVkVXJsID0gbmV3IFVSTChzcGVjaWZpZXIsIHVybCkuaHJlZjtcbiAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0geWllbGQgbG9hZE1vZHVsZShyZXNvbHZlZFVybCwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICAgICAgICAgIH0pKCkpO1xuICAgICAgICByZXR1cm4gbW9kdWxlO1xuICAgIH0pKCk7XG59XG5mdW5jdGlvbiBub3JtYWxpemVPcHRpb25zKGVuYWJsZURlZmF1bHQsIGRlZmF1bHRPcHRpb25zLCBrZXkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBpZiAoZW5hYmxlRGVmYXVsdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0T3B0aW9ucztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zID09PSB0cnVlKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIHR5cGUgZm9yIFxcYCR7a2V5fVxcYCwgZXhwZWN0IGJvb2xlYW4vdW5kZWZpbmVkL29iamVjdCwgZ290OiAke3R5cGVvZiBvcHRpb25zfWApO1xuICAgIH07XG59XG5leHBvcnRzLkJST1dTRVJfTE9HX0tFWSA9IEJST1dTRVJfTE9HX0tFWTtcbmV4cG9ydHMuQlJPV1NFUl9MT0dfVkFMVUUgPSBCUk9XU0VSX0xPR19WQUxVRTtcbmV4cG9ydHMuRU5DT0RFX05BTUVfUFJFRklYID0gRU5DT0RFX05BTUVfUFJFRklYO1xuZXhwb3J0cy5FbmNvZGVkTmFtZVRyYW5zZm9ybU1hcCA9IEVuY29kZWROYW1lVHJhbnNmb3JtTWFwO1xuZXhwb3J0cy5GZWRlcmF0aW9uTW9kdWxlTWFuaWZlc3QgPSBGZWRlcmF0aW9uTW9kdWxlTWFuaWZlc3Q7XG5leHBvcnRzLk1BTklGRVNUX0VYVCA9IE1BTklGRVNUX0VYVDtcbmV4cG9ydHMuTUZNb2R1bGVUeXBlID0gTUZNb2R1bGVUeXBlO1xuZXhwb3J0cy5NRlByZWZldGNoQ29tbW9uID0gTUZQcmVmZXRjaENvbW1vbjtcbmV4cG9ydHMuTU9EVUxFX0RFVlRPT0xfSURFTlRJRklFUiA9IE1PRFVMRV9ERVZUT09MX0lERU5USUZJRVI7XG5leHBvcnRzLk1hbmlmZXN0RmlsZU5hbWUgPSBNYW5pZmVzdEZpbGVOYW1lO1xuZXhwb3J0cy5OYW1lVHJhbnNmb3JtTWFwID0gTmFtZVRyYW5zZm9ybU1hcDtcbmV4cG9ydHMuTmFtZVRyYW5zZm9ybVN5bWJvbCA9IE5hbWVUcmFuc2Zvcm1TeW1ib2w7XG5leHBvcnRzLlNFUEFSQVRPUiA9IFNFUEFSQVRPUjtcbmV4cG9ydHMuU3RhdHNGaWxlTmFtZSA9IFN0YXRzRmlsZU5hbWU7XG5leHBvcnRzLlRFTVBfRElSID0gVEVNUF9ESVI7XG5leHBvcnRzLmFzc2VydCA9IGFzc2VydDtcbmV4cG9ydHMuY29tcG9zZUtleVdpdGhTZXBhcmF0b3IgPSBjb21wb3NlS2V5V2l0aFNlcGFyYXRvcjtcbmV4cG9ydHMuY29udGFpbmVyUGx1Z2luID0gQ29udGFpbmVyUGx1Z2luO1xuZXhwb3J0cy5jb250YWluZXJSZWZlcmVuY2VQbHVnaW4gPSBDb250YWluZXJSZWZlcmVuY2VQbHVnaW47XG5leHBvcnRzLmNyZWF0ZUxpbmsgPSBjcmVhdGVMaW5rO1xuZXhwb3J0cy5jcmVhdGVMb2dnZXIgPSBjcmVhdGVMb2dnZXI7XG5leHBvcnRzLmNyZWF0ZVNjcmlwdCA9IGNyZWF0ZVNjcmlwdDtcbmV4cG9ydHMuY3JlYXRlU2NyaXB0Tm9kZSA9IGNyZWF0ZVNjcmlwdE5vZGU7XG5leHBvcnRzLmRlY29kZU5hbWUgPSBkZWNvZGVOYW1lO1xuZXhwb3J0cy5lbmNvZGVOYW1lID0gZW5jb2RlTmFtZTtcbmV4cG9ydHMuZXJyb3IgPSBlcnJvcjtcbmV4cG9ydHMuZ2VuZXJhdGVFeHBvc2VGaWxlbmFtZSA9IGdlbmVyYXRlRXhwb3NlRmlsZW5hbWU7XG5leHBvcnRzLmdlbmVyYXRlU2hhcmVGaWxlbmFtZSA9IGdlbmVyYXRlU2hhcmVGaWxlbmFtZTtcbmV4cG9ydHMuZ2VuZXJhdGVTbmFwc2hvdEZyb21NYW5pZmVzdCA9IGdlbmVyYXRlU25hcHNob3RGcm9tTWFuaWZlc3Q7XG5leHBvcnRzLmdldFByb2Nlc3NFbnYgPSBnZXRQcm9jZXNzRW52O1xuZXhwb3J0cy5nZXRSZXNvdXJjZVVybCA9IGdldFJlc291cmNlVXJsO1xuZXhwb3J0cy5pbmZlckF1dG9QdWJsaWNQYXRoID0gaW5mZXJBdXRvUHVibGljUGF0aDtcbmV4cG9ydHMuaXNCcm93c2VyRW52ID0gaXNCcm93c2VyRW52O1xuZXhwb3J0cy5pc0RlYnVnTW9kZSA9IGlzRGVidWdNb2RlO1xuZXhwb3J0cy5pc01hbmlmZXN0UHJvdmlkZXIgPSBpc01hbmlmZXN0UHJvdmlkZXI7XG5leHBvcnRzLmlzUmVxdWlyZWRWZXJzaW9uID0gaXNSZXF1aXJlZFZlcnNpb247XG5leHBvcnRzLmlzU3RhdGljUmVzb3VyY2VzRXF1YWwgPSBpc1N0YXRpY1Jlc291cmNlc0VxdWFsO1xuZXhwb3J0cy5sb2FkU2NyaXB0ID0gbG9hZFNjcmlwdDtcbmV4cG9ydHMubG9hZFNjcmlwdE5vZGUgPSBsb2FkU2NyaXB0Tm9kZTtcbmV4cG9ydHMubG9nZ2VyID0gbG9nZ2VyO1xuZXhwb3J0cy5tb2R1bGVGZWRlcmF0aW9uUGx1Z2luID0gTW9kdWxlRmVkZXJhdGlvblBsdWdpbjtcbmV4cG9ydHMubm9ybWFsaXplT3B0aW9ucyA9IG5vcm1hbGl6ZU9wdGlvbnM7XG5leHBvcnRzLnBhcnNlRW50cnkgPSBwYXJzZUVudHJ5O1xuZXhwb3J0cy5zYWZlVG9TdHJpbmcgPSBzYWZlVG9TdHJpbmc7XG5leHBvcnRzLnNhZmVXcmFwcGVyID0gc2FmZVdyYXBwZXI7XG5leHBvcnRzLnNoYXJlUGx1Z2luID0gU2hhcmVQbHVnaW47XG5leHBvcnRzLnNpbXBsZUpvaW5SZW1vdGVFbnRyeSA9IHNpbXBsZUpvaW5SZW1vdGVFbnRyeTtcbmV4cG9ydHMud2FybiA9IHdhcm47XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9zZGsvZGlzdC9wb2x5ZmlsbHMuY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vc2RrL2Rpc3QvcG9seWZpbGxzLmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfZXh0ZW5kcygpIHtcbiAgICBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gYXNzaWduKHRhcmdldCkge1xuICAgICAgICBmb3IodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBmb3IodmFyIGtleSBpbiBzb3VyY2UpaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9O1xuICAgIHJldHVybiBfZXh0ZW5kcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZXhwb3J0cy5fZXh0ZW5kcyA9IF9leHRlbmRzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9jb25zdGFudC5janMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9jb25zdGFudC5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBGRURFUkFUSU9OX1NVUFBPUlRFRF9UWVBFUyA9IFtcbiAgICAnc2NyaXB0J1xuXTtcbmV4cG9ydHMuRkVERVJBVElPTl9TVVBQT1JURURfVFlQRVMgPSBGRURFUkFUSU9OX1NVUFBPUlRFRF9UWVBFUztcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG52YXIgX29iamVjdF9zcHJlYWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fb2JqZWN0X3NwcmVhZCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX29iamVjdF9zcHJlYWQuY2pzXCIpO1xudmFyIHJ1bnRpbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzXCIpO1xudmFyIGNvbnN0YW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9jb25zdGFudC5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9jb25zdGFudC5janMuanNcIik7XG5mdW5jdGlvbiBfaW50ZXJvcE5hbWVzcGFjZURlZmF1bHQoZSkge1xuICAgIHZhciBuID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICBpZiAoZSkge1xuICAgICAgICBPYmplY3Qua2V5cyhlKS5mb3JFYWNoKGZ1bmN0aW9uKGspIHtcbiAgICAgICAgICAgIGlmIChrICE9PSAnZGVmYXVsdCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgayk7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sIGssIGQuZ2V0ID8gZCA6IHtcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlW2tdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBuLmRlZmF1bHQgPSBlO1xuICAgIHJldHVybiBPYmplY3QuZnJlZXplKG4pO1xufVxudmFyIHJ1bnRpbWVfX25hbWVzcGFjZSA9IC8qI19fUFVSRV9fKi8gX2ludGVyb3BOYW1lc3BhY2VEZWZhdWx0KHJ1bnRpbWUpO1xuZnVuY3Rpb24gYXR0YWNoU2hhcmVTY29wZU1hcCh3ZWJwYWNrUmVxdWlyZSkge1xuICAgIGlmICghd2VicGFja1JlcXVpcmUuUyB8fCB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmhhc0F0dGFjaFNoYXJlU2NvcGVNYXAgfHwgIXdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2UgfHwgIXdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2Uuc2hhcmVTY29wZU1hcCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHdlYnBhY2tSZXF1aXJlLlMgPSB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlLnNoYXJlU2NvcGVNYXA7XG4gICAgd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5oYXNBdHRhY2hTaGFyZVNjb3BlTWFwID0gdHJ1ZTtcbn1cbnZhciBOYW1lVHJhbnNmb3JtU3ltYm9sID0ge1xuICAgIEFUOiAnQCcsXG4gICAgSFlQSEVOOiAnLScsXG4gICAgU0xBU0g6ICcvJ1xufTtcbnZhciBOYW1lVHJhbnNmb3JtTWFwID0ge1xuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXTogJ3Njb3BlXycsXG4gICAgW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXTogJ18nLFxuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXTogJ19fJ1xufTtcbnZhciBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcCA9IHtcbiAgICBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXV06IE5hbWVUcmFuc2Zvcm1TeW1ib2wuQVQsXG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dXTogTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU4sXG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF1dOiBOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXG59O1xudmFyIEVOQ09ERV9OQU1FX1BSRUZJWCA9ICdFTkNPREVfTkFNRV9QUkVGSVgnO1xudmFyIGRlY29kZU5hbWUgPSBmdW5jdGlvbihuYW1lLCBwcmVmaXgsIHdpdGhFeHQpIHtcbiAgICB0cnkge1xuICAgICAgICB2YXIgZGVjb2RlZE5hbWUgPSBuYW1lO1xuICAgICAgICBpZiAocHJlZml4KSB7XG4gICAgICAgICAgICBpZiAoIWRlY29kZWROYW1lLnN0YXJ0c1dpdGgocHJlZml4KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWNvZGVkTmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlY29kZWROYW1lID0gZGVjb2RlZE5hbWUucmVwbGFjZShuZXcgUmVnRXhwKHByZWZpeCwgJ2cnKSwgJycpO1xuICAgICAgICB9XG4gICAgICAgIGRlY29kZWROYW1lID0gZGVjb2RlZE5hbWUucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXV0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdfWAsICdnJyksIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF1dKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl1dKTtcbiAgICAgICAgaWYgKHdpdGhFeHQpIDtcbiAgICAgICAgcmV0dXJuIGRlY29kZWROYW1lO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgfVxufTtcbmZ1bmN0aW9uIHJlbW90ZXMob3B0aW9ucykge1xuICAgIHZhciBjaHVua0lkID0gb3B0aW9ucy5jaHVua0lkLCBwcm9taXNlcyA9IG9wdGlvbnMucHJvbWlzZXMsIGNodW5rTWFwcGluZyA9IG9wdGlvbnMuY2h1bmtNYXBwaW5nLCBpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZyA9IG9wdGlvbnMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsIHdlYnBhY2tSZXF1aXJlID0gb3B0aW9ucy53ZWJwYWNrUmVxdWlyZSwgaWRUb1JlbW90ZU1hcCA9IG9wdGlvbnMuaWRUb1JlbW90ZU1hcDtcbiAgICBhdHRhY2hTaGFyZVNjb3BlTWFwKHdlYnBhY2tSZXF1aXJlKTtcbiAgICBpZiAod2VicGFja1JlcXVpcmUubyhjaHVua01hcHBpbmcsIGNodW5rSWQpKSB7XG4gICAgICAgIGNodW5rTWFwcGluZ1tjaHVua0lkXS5mb3JFYWNoKChpZCk9PntcbiAgICAgICAgICAgIHZhciBnZXRTY29wZSA9IHdlYnBhY2tSZXF1aXJlLlI7XG4gICAgICAgICAgICBpZiAoIWdldFNjb3BlKSB7XG4gICAgICAgICAgICAgICAgZ2V0U2NvcGUgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkYXRhID0gaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdbaWRdO1xuICAgICAgICAgICAgdmFyIHJlbW90ZUluZm9zID0gaWRUb1JlbW90ZU1hcFtpZF07XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIHNlZW1zIG5vdCB3b3JrXG4gICAgICAgICAgICBpZiAoZ2V0U2NvcGUuaW5kZXhPZihkYXRhKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSBzZWVtcyBub3Qgd29ya1xuICAgICAgICAgICAgZ2V0U2NvcGUucHVzaChkYXRhKTtcbiAgICAgICAgICAgIGlmIChkYXRhLnApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZXMucHVzaChkYXRhLnApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9uRXJyb3IgPSAoZXJyb3IpPT57XG4gICAgICAgICAgICAgICAgaWYgKCFlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBlcnJvciA9IG5ldyBFcnJvcignQ29udGFpbmVyIG1pc3NpbmcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnJvci5tZXNzYWdlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBlcnJvci5tZXNzYWdlICs9IGBcXG53aGlsZSBsb2FkaW5nIFwiJHtkYXRhWzFdfVwiIGZyb20gJHtkYXRhWzJdfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlLm1baWRdID0gKCk9PntcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkYXRhLnAgPSAwO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBoYW5kbGVGdW5jdGlvbiA9IChmbiwgYXJnMSwgYXJnMiwgZCwgbmV4dCwgZmlyc3QpPT57XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSBmbihhcmcxLCBhcmcyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb21pc2UgJiYgcHJvbWlzZS50aGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IHByb21pc2UudGhlbigocmVzdWx0KT0+bmV4dChyZXN1bHQsIGQpLCBvbkVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goZGF0YS5wID0gcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQocHJvbWlzZSwgZCwgZmlyc3QpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBvbkV4dGVybmFsID0gKGV4dGVybmFsLCBfLCBmaXJzdCk9PmV4dGVybmFsID8gaGFuZGxlRnVuY3Rpb24od2VicGFja1JlcXVpcmUuSSwgZGF0YVswXSwgMCwgZXh0ZXJuYWwsIG9uSW5pdGlhbGl6ZWQsIGZpcnN0KSA6IG9uRXJyb3IoKTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgICAgICAgICAgIHZhciBvbkluaXRpYWxpemVkID0gKF8sIGV4dGVybmFsLCBmaXJzdCk9PmhhbmRsZUZ1bmN0aW9uKGV4dGVybmFsLmdldCwgZGF0YVsxXSwgZ2V0U2NvcGUsIDAsIG9uRmFjdG9yeSwgZmlyc3QpO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXZhclxuICAgICAgICAgICAgdmFyIG9uRmFjdG9yeSA9IChmYWN0b3J5KT0+e1xuICAgICAgICAgICAgICAgIGRhdGEucCA9IDE7XG4gICAgICAgICAgICAgICAgd2VicGFja1JlcXVpcmUubVtpZF0gPSAobW9kdWxlMSk9PntcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlMS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIG9uUmVtb3RlTG9hZGVkID0gKCk9PntcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlTmFtZSA9IGRlY29kZU5hbWUocmVtb3RlSW5mb3NbMF0ubmFtZSwgRU5DT0RFX05BTUVfUFJFRklYKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZU1vZHVsZU5hbWUgPSByZW1vdGVOYW1lICsgZGF0YVsxXS5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRSZW1vdGUgPSAoKT0+d2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZS5sb2FkUmVtb3RlKHJlbW90ZU1vZHVsZU5hbWUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkRmFjdG9yeTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ2J1aWxkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5vcHRpb25zLnNoYXJlU3RyYXRlZ3kgPT09ICd2ZXJzaW9uLWZpcnN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGluc3RhbmNlLnNoYXJlZEhhbmRsZXIuaW5pdGlhbGl6ZVNoYXJpbmcoZGF0YVswXSkpLnRoZW4oKCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9hZFJlbW90ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRSZW1vdGUoKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHVzZVJ1bnRpbWVMb2FkID0gcmVtb3RlSW5mb3MubGVuZ3RoID09PSAxICYmIGNvbnN0YW50LkZFREVSQVRJT05fU1VQUE9SVEVEX1RZUEVTLmluY2x1ZGVzKHJlbW90ZUluZm9zWzBdLmV4dGVybmFsVHlwZSkgJiYgcmVtb3RlSW5mb3NbMF0ubmFtZTtcbiAgICAgICAgICAgIGlmICh1c2VSdW50aW1lTG9hZCkge1xuICAgICAgICAgICAgICAgIGhhbmRsZUZ1bmN0aW9uKG9uUmVtb3RlTG9hZGVkLCBkYXRhWzJdLCAwLCAwLCBvbkZhY3RvcnksIDEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVGdW5jdGlvbih3ZWJwYWNrUmVxdWlyZSwgZGF0YVsyXSwgMCwgMCwgb25FeHRlcm5hbCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNvbnN1bWVzKG9wdGlvbnMpIHtcbiAgICB2YXIgY2h1bmtJZCA9IG9wdGlvbnMuY2h1bmtJZCwgcHJvbWlzZXMgPSBvcHRpb25zLnByb21pc2VzLCBjaHVua01hcHBpbmcgPSBvcHRpb25zLmNodW5rTWFwcGluZywgaW5zdGFsbGVkTW9kdWxlcyA9IG9wdGlvbnMuaW5zdGFsbGVkTW9kdWxlcywgbW9kdWxlVG9IYW5kbGVyTWFwcGluZyA9IG9wdGlvbnMubW9kdWxlVG9IYW5kbGVyTWFwcGluZywgd2VicGFja1JlcXVpcmUgPSBvcHRpb25zLndlYnBhY2tSZXF1aXJlO1xuICAgIGF0dGFjaFNoYXJlU2NvcGVNYXAod2VicGFja1JlcXVpcmUpO1xuICAgIGlmICh3ZWJwYWNrUmVxdWlyZS5vKGNodW5rTWFwcGluZywgY2h1bmtJZCkpIHtcbiAgICAgICAgY2h1bmtNYXBwaW5nW2NodW5rSWRdLmZvckVhY2goKGlkKT0+e1xuICAgICAgICAgICAgaWYgKHdlYnBhY2tSZXF1aXJlLm8oaW5zdGFsbGVkTW9kdWxlcywgaWQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzLnB1c2goaW5zdGFsbGVkTW9kdWxlc1tpZF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9uRmFjdG9yeSA9IChmYWN0b3J5KT0+e1xuICAgICAgICAgICAgICAgIGluc3RhbGxlZE1vZHVsZXNbaWRdID0gMDtcbiAgICAgICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZS5tW2lkXSA9IChtb2R1bGUxKT0+e1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2VicGFja1JlcXVpcmUuY1tpZF07XG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZTEuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBvbkVycm9yID0gKGVycm9yKT0+e1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBpbnN0YWxsZWRNb2R1bGVzW2lkXTtcbiAgICAgICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZS5tW2lkXSA9IChtb2R1bGUxKT0+e1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2VicGFja1JlcXVpcmUuY1tpZF07XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgZmVkZXJhdGlvbkluc3RhbmNlID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZTtcbiAgICAgICAgICAgICAgICBpZiAoIWZlZGVyYXRpb25JbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZlZGVyYXRpb24gaW5zdGFuY2Ugbm90IGZvdW5kIScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfaWQgPSBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nW2lkXSwgc2hhcmVLZXkgPSBfbW9kdWxlVG9IYW5kbGVyTWFwcGluZ19pZC5zaGFyZUtleSwgZ2V0dGVyID0gX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfaWQuZ2V0dGVyLCBzaGFyZUluZm8gPSBfbW9kdWxlVG9IYW5kbGVyTWFwcGluZ19pZC5zaGFyZUluZm87XG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSBmZWRlcmF0aW9uSW5zdGFuY2UubG9hZFNoYXJlKHNoYXJlS2V5LCB7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbVNoYXJlSW5mbzogc2hhcmVJbmZvXG4gICAgICAgICAgICAgICAgfSkudGhlbigoZmFjdG9yeSk9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZhY3RvcnkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0dGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHByb21pc2UudGhlbikge1xuICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGluc3RhbGxlZE1vZHVsZXNbaWRdID0gcHJvbWlzZS50aGVuKG9uRmFjdG9yeSkuY2F0Y2gob25FcnJvcikpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgbWFpbnRhaW4gcHJldmlvdXMgbG9naWNcbiAgICAgICAgICAgICAgICAgICAgb25GYWN0b3J5KHByb21pc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBpbml0aWFsaXplU2hhcmluZyhyZWYpIHtcbiAgICB2YXIgc2hhcmVTY29wZU5hbWUgPSByZWYuc2hhcmVTY29wZU5hbWUsIHdlYnBhY2tSZXF1aXJlID0gcmVmLndlYnBhY2tSZXF1aXJlLCBpbml0UHJvbWlzZXMgPSByZWYuaW5pdFByb21pc2VzLCBpbml0VG9rZW5zID0gcmVmLmluaXRUb2tlbnMsIGluaXRTY29wZSA9IHJlZi5pbml0U2NvcGU7XG4gICAgaWYgKCFpbml0U2NvcGUpIGluaXRTY29wZSA9IFtdO1xuICAgIHZhciBtZkluc3RhbmNlID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZTtcbiAgICAvLyBoYW5kbGluZyBjaXJjdWxhciBpbml0IGNhbGxzXG4gICAgdmFyIGluaXRUb2tlbiA9IGluaXRUb2tlbnNbc2hhcmVTY29wZU5hbWVdO1xuICAgIGlmICghaW5pdFRva2VuKSBpbml0VG9rZW4gPSBpbml0VG9rZW5zW3NoYXJlU2NvcGVOYW1lXSA9IHtcbiAgICAgICAgZnJvbTogbWZJbnN0YW5jZS5uYW1lXG4gICAgfTtcbiAgICBpZiAoaW5pdFNjb3BlLmluZGV4T2YoaW5pdFRva2VuKSA+PSAwKSByZXR1cm47XG4gICAgaW5pdFNjb3BlLnB1c2goaW5pdFRva2VuKTtcbiAgICB2YXIgcHJvbWlzZSA9IGluaXRQcm9taXNlc1tzaGFyZVNjb3BlTmFtZV07XG4gICAgaWYgKHByb21pc2UpIHJldHVybiBwcm9taXNlO1xuICAgIHZhciB3YXJuID0gKG1zZyk9PnR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLndhcm4gJiYgY29uc29sZS53YXJuKG1zZyk7XG4gICAgdmFyIGluaXRFeHRlcm5hbCA9IChpZCk9PntcbiAgICAgICAgdmFyIGhhbmRsZUVycm9yID0gKGVycik9Pndhcm4oJ0luaXRpYWxpemF0aW9uIG9mIHNoYXJpbmcgZXh0ZXJuYWwgZmFpbGVkOiAnICsgZXJyKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBfJG1vZHVsZSA9IHdlYnBhY2tSZXF1aXJlKGlkKTtcbiAgICAgICAgICAgIGlmICghXyRtb2R1bGUpIHJldHVybjtcbiAgICAgICAgICAgIHZhciBpbml0Rm4gPSAobW9kdWxlMSk9Pm1vZHVsZTEgJiYgbW9kdWxlMS5pbml0ICYmIC8vIEB0cy1pZ25vcmUgY29tcGF0IGxlZ2FjeSBtZiBzaGFyZWQgYmVoYXZpb3JcbiAgICAgICAgICAgICAgICBtb2R1bGUxLmluaXQod2VicGFja1JlcXVpcmUuU1tzaGFyZVNjb3BlTmFtZV0sIGluaXRTY29wZSk7XG4gICAgICAgICAgICBpZiAoXyRtb2R1bGUudGhlbikgcmV0dXJuIHByb21pc2VzLnB1c2goXyRtb2R1bGUudGhlbihpbml0Rm4sIGhhbmRsZUVycm9yKSk7XG4gICAgICAgICAgICB2YXIgaW5pdFJlc3VsdCA9IGluaXRGbihfJG1vZHVsZSk7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBpZiAoaW5pdFJlc3VsdCAmJiB0eXBlb2YgaW5pdFJlc3VsdCAhPT0gJ2Jvb2xlYW4nICYmIGluaXRSZXN1bHQudGhlbikgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzLnB1c2goaW5pdFJlc3VsdFsnY2F0Y2gnXShoYW5kbGVFcnJvcikpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGhhbmRsZUVycm9yKGVycik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBwcm9taXNlcyA9IG1mSW5zdGFuY2UuaW5pdGlhbGl6ZVNoYXJpbmcoc2hhcmVTY29wZU5hbWUsIHtcbiAgICAgICAgc3RyYXRlZ3k6IG1mSW5zdGFuY2Uub3B0aW9ucy5zaGFyZVN0cmF0ZWd5LFxuICAgICAgICBpbml0U2NvcGUsXG4gICAgICAgIGZyb206ICdidWlsZCdcbiAgICB9KTtcbiAgICBhdHRhY2hTaGFyZVNjb3BlTWFwKHdlYnBhY2tSZXF1aXJlKTtcbiAgICB2YXIgYnVuZGxlclJ1bnRpbWVSZW1vdGVzT3B0aW9ucyA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXM7XG4gICAgaWYgKGJ1bmRsZXJSdW50aW1lUmVtb3Rlc09wdGlvbnMpIHtcbiAgICAgICAgT2JqZWN0LmtleXMoYnVuZGxlclJ1bnRpbWVSZW1vdGVzT3B0aW9ucy5pZFRvUmVtb3RlTWFwKS5mb3JFYWNoKChtb2R1bGVJZCk9PntcbiAgICAgICAgICAgIHZhciBpbmZvID0gYnVuZGxlclJ1bnRpbWVSZW1vdGVzT3B0aW9ucy5pZFRvUmVtb3RlTWFwW21vZHVsZUlkXTtcbiAgICAgICAgICAgIHZhciBleHRlcm5hbE1vZHVsZUlkID0gYnVuZGxlclJ1bnRpbWVSZW1vdGVzT3B0aW9ucy5pZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1ttb2R1bGVJZF1bMl07XG4gICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgaW5pdEV4dGVybmFsKGV4dGVybmFsTW9kdWxlSWQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gaW5mb1swXTtcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnN0YW50LkZFREVSQVRJT05fU1VQUE9SVEVEX1RZUEVTLmluY2x1ZGVzKHJlbW90ZUluZm8uZXh0ZXJuYWxUeXBlKSkge1xuICAgICAgICAgICAgICAgICAgICBpbml0RXh0ZXJuYWwoZXh0ZXJuYWxNb2R1bGVJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFwcm9taXNlcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGluaXRQcm9taXNlc1tzaGFyZVNjb3BlTmFtZV0gPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gaW5pdFByb21pc2VzW3NoYXJlU2NvcGVOYW1lXSA9IFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKCgpPT5pbml0UHJvbWlzZXNbc2hhcmVTY29wZU5hbWVdID0gdHJ1ZSk7XG59XG5mdW5jdGlvbiBoYW5kbGVJbml0aWFsQ29uc3VtZXMob3B0aW9ucykge1xuICAgIHZhciBtb2R1bGVJZCA9IG9wdGlvbnMubW9kdWxlSWQsIG1vZHVsZVRvSGFuZGxlck1hcHBpbmcgPSBvcHRpb25zLm1vZHVsZVRvSGFuZGxlck1hcHBpbmcsIHdlYnBhY2tSZXF1aXJlID0gb3B0aW9ucy53ZWJwYWNrUmVxdWlyZTtcbiAgICB2YXIgZmVkZXJhdGlvbkluc3RhbmNlID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZTtcbiAgICBpZiAoIWZlZGVyYXRpb25JbnN0YW5jZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZlZGVyYXRpb24gaW5zdGFuY2Ugbm90IGZvdW5kIScpO1xuICAgIH1cbiAgICB2YXIgX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfbW9kdWxlSWQgPSBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nW21vZHVsZUlkXSwgc2hhcmVLZXkgPSBfbW9kdWxlVG9IYW5kbGVyTWFwcGluZ19tb2R1bGVJZC5zaGFyZUtleSwgc2hhcmVJbmZvID0gX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfbW9kdWxlSWQuc2hhcmVJbmZvO1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBmZWRlcmF0aW9uSW5zdGFuY2UubG9hZFNoYXJlU3luYyhzaGFyZUtleSwge1xuICAgICAgICAgICAgY3VzdG9tU2hhcmVJbmZvOiBzaGFyZUluZm9cbiAgICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2xvYWRTaGFyZVN5bmMgZmFpbGVkISBUaGUgZnVuY3Rpb24gc2hvdWxkIG5vdCBiZSBjYWxsZWQgdW5sZXNzIHlvdSBzZXQgXCJlYWdlcjp0cnVlXCIuIElmIHlvdSBkbyBub3Qgc2V0IGl0LCBhbmQgZW5jb3VudGVyIHRoaXMgaXNzdWUsIHlvdSBjYW4gY2hlY2sgd2hldGhlciBhbiBhc3luYyBib3VuZGFyeSBpcyBpbXBsZW1lbnRlZC4nKTtcbiAgICAgICAgY29uc29sZS5lcnJvcignVGhlIG9yaWdpbmFsIGVycm9yIG1lc3NhZ2UgaXMgYXMgZm9sbG93czogJyk7XG4gICAgICAgIHRocm93IGVycjtcbiAgICB9XG59XG5mdW5jdGlvbiBpbnN0YWxsSW5pdGlhbENvbnN1bWVzKG9wdGlvbnMpIHtcbiAgICB2YXIgbW9kdWxlVG9IYW5kbGVyTWFwcGluZyA9IG9wdGlvbnMubW9kdWxlVG9IYW5kbGVyTWFwcGluZywgd2VicGFja1JlcXVpcmUgPSBvcHRpb25zLndlYnBhY2tSZXF1aXJlLCBpbnN0YWxsZWRNb2R1bGVzID0gb3B0aW9ucy5pbnN0YWxsZWRNb2R1bGVzLCBpbml0aWFsQ29uc3VtZXMgPSBvcHRpb25zLmluaXRpYWxDb25zdW1lcztcbiAgICBpbml0aWFsQ29uc3VtZXMuZm9yRWFjaCgoaWQpPT57XG4gICAgICAgIHdlYnBhY2tSZXF1aXJlLm1baWRdID0gKG1vZHVsZTEpPT57XG4gICAgICAgICAgICAvLyBIYW5kbGUgc2NlbmFyaW8gd2hlbiBtb2R1bGUgaXMgdXNlZCBzeW5jaHJvbm91c2x5XG4gICAgICAgICAgICBpbnN0YWxsZWRNb2R1bGVzW2lkXSA9IDA7XG4gICAgICAgICAgICBkZWxldGUgd2VicGFja1JlcXVpcmUuY1tpZF07XG4gICAgICAgICAgICB2YXIgZmFjdG9yeSA9IGhhbmRsZUluaXRpYWxDb25zdW1lcyh7XG4gICAgICAgICAgICAgICAgbW9kdWxlSWQ6IGlkLFxuICAgICAgICAgICAgICAgIG1vZHVsZVRvSGFuZGxlck1hcHBpbmcsXG4gICAgICAgICAgICAgICAgd2VicGFja1JlcXVpcmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmYWN0b3J5ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTaGFyZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUgZm9yIGVhZ2VyIGNvbnN1bXB0aW9uOiAke2lkfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbW9kdWxlMS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICAgICAgICB9O1xuICAgIH0pO1xufVxuZnVuY3Rpb24gaW5pdENvbnRhaW5lckVudHJ5KG9wdGlvbnMpIHtcbiAgICB2YXIgd2VicGFja1JlcXVpcmUgPSBvcHRpb25zLndlYnBhY2tSZXF1aXJlLCBzaGFyZVNjb3BlID0gb3B0aW9ucy5zaGFyZVNjb3BlLCBpbml0U2NvcGUgPSBvcHRpb25zLmluaXRTY29wZSwgc2hhcmVTY29wZUtleSA9IG9wdGlvbnMuc2hhcmVTY29wZUtleSwgcmVtb3RlRW50cnlJbml0T3B0aW9ucyA9IG9wdGlvbnMucmVtb3RlRW50cnlJbml0T3B0aW9ucztcbiAgICBpZiAoIXdlYnBhY2tSZXF1aXJlLlMpIHJldHVybjtcbiAgICBpZiAoIXdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24gfHwgIXdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2UgfHwgIXdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpIHJldHVybjtcbiAgICB2YXIgZmVkZXJhdGlvbkluc3RhbmNlID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZTtcbiAgICB2YXIgbmFtZSA9IHNoYXJlU2NvcGVLZXkgfHwgJ2RlZmF1bHQnO1xuICAgIGZlZGVyYXRpb25JbnN0YW5jZS5pbml0T3B0aW9ucyhfb2JqZWN0X3NwcmVhZC5fKHtcbiAgICAgICAgbmFtZTogd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbml0T3B0aW9ucy5uYW1lLFxuICAgICAgICByZW1vdGVzOiBbXVxuICAgIH0sIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMpKTtcbiAgICBmZWRlcmF0aW9uSW5zdGFuY2UuaW5pdFNoYXJlU2NvcGVNYXAobmFtZSwgc2hhcmVTY29wZSwge1xuICAgICAgICBob3N0U2hhcmVTY29wZU1hcDogKHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMgPT09IG51bGwgfHwgcmVtb3RlRW50cnlJbml0T3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcmVtb3RlRW50cnlJbml0T3B0aW9ucy5zaGFyZVNjb3BlTWFwKSB8fCB7fVxuICAgIH0pO1xuICAgIGlmICh3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApIHtcbiAgICAgICAgd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKHdlYnBhY2tSZXF1aXJlKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLnByZWZldGNoID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24ucHJlZmV0Y2goKTtcbiAgICB9XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHJldHVybiB3ZWJwYWNrUmVxdWlyZS5JKG5hbWUsIGluaXRTY29wZSk7XG59XG52YXIgZmVkZXJhdGlvbiA9IHtcbiAgICBydW50aW1lOiBydW50aW1lX19uYW1lc3BhY2UsXG4gICAgaW5zdGFuY2U6IHVuZGVmaW5lZCxcbiAgICBpbml0T3B0aW9uczogdW5kZWZpbmVkLFxuICAgIGJ1bmRsZXJSdW50aW1lOiB7XG4gICAgICAgIHJlbW90ZXMsXG4gICAgICAgIGNvbnN1bWVzLFxuICAgICAgICBJOiBpbml0aWFsaXplU2hhcmluZyxcbiAgICAgICAgUzoge30sXG4gICAgICAgIGluc3RhbGxJbml0aWFsQ29uc3VtZXMsXG4gICAgICAgIGluaXRDb250YWluZXJFbnRyeVxuICAgIH0sXG4gICAgYXR0YWNoU2hhcmVTY29wZU1hcCxcbiAgICBidW5kbGVyUnVudGltZU9wdGlvbnM6IHt9XG59O1xubW9kdWxlLmV4cG9ydHMgPSBmZWRlcmF0aW9uO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV9saWtlX3RvX2FycmF5LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfbGlrZV90b19hcnJheS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2FycmF5X2xpa2VfdG9fYXJyYXkoYXJyLCBsZW4pIHtcbiAgICBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDtcbiAgICBmb3IodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKylhcnIyW2ldID0gYXJyW2ldO1xuICAgIHJldHVybiBhcnIyO1xufVxuZXhwb3J0cy5fID0gX2FycmF5X2xpa2VfdG9fYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhfaG9sZXMuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRoX2hvbGVzLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfYXJyYXlfd2l0aF9ob2xlcyhhcnIpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyO1xufVxuZXhwb3J0cy5fID0gX2FycmF5X3dpdGhfaG9sZXM7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhvdXRfaG9sZXMuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRob3V0X2hvbGVzLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2FycmF5X2xpa2VfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hcnJheV9saWtlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X2xpa2VfdG9fYXJyYXkuY2pzXCIpO1xuZnVuY3Rpb24gX2FycmF5X3dpdGhvdXRfaG9sZXMoYXJyKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheV9saWtlX3RvX2FycmF5Ll8oYXJyKTtcbn1cbmV4cG9ydHMuXyA9IF9hcnJheV93aXRob3V0X2hvbGVzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3NlcnRfdGhpc19pbml0aWFsaXplZC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3NlcnRfdGhpc19pbml0aWFsaXplZC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9hc3NlcnRfdGhpc19pbml0aWFsaXplZChzZWxmKSB7XG4gICAgaWYgKHNlbGYgPT09IHZvaWQgMCkgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpO1xuICAgIHJldHVybiBzZWxmO1xufVxuZXhwb3J0cy5fID0gX2Fzc2VydF90aGlzX2luaXRpYWxpemVkO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FzeW5jX3RvX2dlbmVyYXRvci5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpO1xuICAgICAgICB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGluZm8uZG9uZSkgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgZWxzZSBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7XG59XG5mdW5jdGlvbiBfYXN5bmNfdG9fZ2VuZXJhdG9yKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBcIm5leHRcIiwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikge1xuICAgICAgICAgICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgXCJ0aHJvd1wiLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX25leHQodW5kZWZpbmVkKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbmV4cG9ydHMuXyA9IF9hc3luY190b19nZW5lcmF0b3I7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NhbGxfc3VwZXIuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jYWxsX3N1cGVyLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2dldF9wcm90b3R5cGVfb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19nZXRfcHJvdG90eXBlX29mLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2dldF9wcm90b3R5cGVfb2YuY2pzXCIpO1xudmFyIF9pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0LmNqc1wiKTtcbnZhciBfcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybi5janNcIik7XG5mdW5jdGlvbiBfY2FsbF9zdXBlcihfdGhpcywgZGVyaXZlZCwgYXJncykge1xuICAgIC8vIFN1cGVyXG4gICAgZGVyaXZlZCA9IF9nZXRfcHJvdG90eXBlX29mLl8oZGVyaXZlZCk7XG4gICAgcmV0dXJuIF9wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4uXyhfdGhpcywgX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdC5fKCkgPyBSZWZsZWN0LmNvbnN0cnVjdChkZXJpdmVkLCBhcmdzIHx8IFtdLCBfZ2V0X3Byb3RvdHlwZV9vZi5fKF90aGlzKS5jb25zdHJ1Y3RvcikgOiBkZXJpdmVkLmFwcGx5KF90aGlzLCBhcmdzKSk7XG59XG5leHBvcnRzLl8gPSBfY2FsbF9zdXBlcjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NsYXNzX2NhbGxfY2hlY2suY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9jbGFzc19jYWxsX2NoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3Rvcikge1xuICAgIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xufVxuZXhwb3J0cy5fID0gX2NsYXNzX2NhbGxfY2hlY2s7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY3JlYXRlX2NsYXNzLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7XG4gICAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTtcbiAgICAgICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIF9jcmVhdGVfY2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gICAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7XG4gICAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpO1xuICAgIHJldHVybiBDb25zdHJ1Y3Rvcjtcbn1cbmV4cG9ydHMuXyA9IF9jcmVhdGVfY2xhc3M7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2RlZmluZV9wcm9wZXJ0eS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZGVmaW5lX3Byb3BlcnR5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9kZWZpbmVfcHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7XG4gICAgaWYgKGtleSBpbiBvYmopIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIG9ialtrZXldID0gdmFsdWU7XG4gICAgcmV0dXJuIG9iajtcbn1cbmV4cG9ydHMuXyA9IF9kZWZpbmVfcHJvcGVydHk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2V4cG9ydF9zdGFyLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2V4cG9ydF9zdGFyLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2V4cG9ydF9zdGFyKGZyb20sIHRvKSB7XG4gICAgT2JqZWN0LmtleXMoZnJvbSkuZm9yRWFjaChmdW5jdGlvbihrKSB7XG4gICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRvLCBrKSkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRvLCBrLCB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnJvbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBmcm9tO1xufVxuZXhwb3J0cy5fID0gX2V4cG9ydF9zdGFyO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19nZXRfcHJvdG90eXBlX29mLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZ2V0X3Byb3RvdHlwZV9vZi5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2dldF9wcm90b3R5cGVfb2Yobykge1xuICAgIGV4cG9ydHMuXyA9IF9nZXRfcHJvdG90eXBlX29mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gZ2V0UHJvdG90eXBlT2Yobykge1xuICAgICAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pO1xuICAgIH07XG4gICAgcmV0dXJuIF9nZXRfcHJvdG90eXBlX29mKG8pO1xufVxuZXhwb3J0cy5fID0gX2dldF9wcm90b3R5cGVfb2Y7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2luaGVyaXRzLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2luaGVyaXRzLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9zZXRfcHJvdG90eXBlX29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fc2V0X3Byb3RvdHlwZV9vZi5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zZXRfcHJvdG90eXBlX29mLmNqc1wiKTtcbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICAgIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHtcbiAgICAgICAgY29uc3RydWN0b3I6IHtcbiAgICAgICAgICAgIHZhbHVlOiBzdWJDbGFzcyxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoc3VwZXJDbGFzcykgX3NldF9wcm90b3R5cGVfb2YuXyhzdWJDbGFzcywgc3VwZXJDbGFzcyk7XG59XG5leHBvcnRzLl8gPSBfaW5oZXJpdHM7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0KG9iaikge1xuICAgIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7XG4gICAgICAgIGRlZmF1bHQ6IG9ialxuICAgIH07XG59XG5leHBvcnRzLl8gPSBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQ7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QoKSB7XG4gICAgLy8gU2luY2UgUmVmbGVjdC5jb25zdHJ1Y3QgY2FuJ3QgYmUgcHJvcGVybHkgcG9seWZpbGxlZCwgc29tZVxuICAgIC8vIGltcGxlbWVudGF0aW9ucyAoZS5nLiBjb3JlLWpzQDIpIGRvbid0IHNldCB0aGUgY29ycmVjdCBpbnRlcm5hbCBzbG90cy5cbiAgICAvLyBUaG9zZSBwb2x5ZmlsbHMgZG9uJ3QgYWxsb3cgdXMgdG8gc3ViY2xhc3MgYnVpbHQtaW5zLCBzbyB3ZSBuZWVkIHRvXG4gICAgLy8gdXNlIG91ciBmYWxsYmFjayBpbXBsZW1lbnRhdGlvbi5cbiAgICB0cnkge1xuICAgICAgICAvLyBJZiB0aGUgaW50ZXJuYWwgc2xvdHMgYXJlbid0IHNldCwgdGhpcyB0aHJvd3MgYW4gZXJyb3Igc2ltaWxhciB0b1xuICAgICAgICAvLyAgIFR5cGVFcnJvcjogdGhpcyBpcyBub3QgYSBCb29sZWFuIG9iamVjdC5cbiAgICAgICAgdmFyIHJlc3VsdCA9ICFCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uKCkge30pKTtcbiAgICB9IGNhdGNoIChfKSB7fVxuICAgIHJldHVybiAoZXhwb3J0cy5fID0gX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gISFyZXN1bHQ7XG4gICAgfSkoKTtcbn1cbmV4cG9ydHMuXyA9IF9pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3Q7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2l0ZXJhYmxlX3RvX2FycmF5KGl0ZXIpIHtcbiAgICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBpdGVyW1N5bWJvbC5pdGVyYXRvcl0gIT0gbnVsbCB8fCBpdGVyW1wiQEBpdGVyYXRvclwiXSAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpO1xuICAgIH1cbn1cbmV4cG9ydHMuXyA9IF9pdGVyYWJsZV90b19hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXlfbGltaXQuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXlfbGltaXQuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfaXRlcmFibGVfdG9fYXJyYXlfbGltaXQoYXJyLCBpKSB7XG4gICAgdmFyIF9pID0gYXJyID09IG51bGwgPyBudWxsIDogdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBhcnJbU3ltYm9sLml0ZXJhdG9yXSB8fCBhcnJbXCJAQGl0ZXJhdG9yXCJdO1xuICAgIGlmIChfaSA9PSBudWxsKSByZXR1cm47XG4gICAgdmFyIF9hcnIgPSBbXTtcbiAgICB2YXIgX24gPSB0cnVlO1xuICAgIHZhciBfZCA9IGZhbHNlO1xuICAgIHZhciBfcywgX2U7XG4gICAgdHJ5IHtcbiAgICAgICAgZm9yKF9pID0gX2kuY2FsbChhcnIpOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKXtcbiAgICAgICAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7XG4gICAgICAgICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgX2QgPSB0cnVlO1xuICAgICAgICBfZSA9IGVycjtcbiAgICB9IGZpbmFsbHl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIV9uICYmIF9pW1wicmV0dXJuXCJdICE9IG51bGwpIF9pW1wicmV0dXJuXCJdKCk7XG4gICAgICAgIH0gZmluYWxseXtcbiAgICAgICAgICAgIGlmIChfZCkgdGhyb3cgX2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIF9hcnI7XG59XG5leHBvcnRzLl8gPSBfaXRlcmFibGVfdG9fYXJyYXlfbGltaXQ7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9yZXN0LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9yZXN0LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX25vbl9pdGVyYWJsZV9yZXN0KCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7XG59XG5leHBvcnRzLl8gPSBfbm9uX2l0ZXJhYmxlX3Jlc3Q7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9zcHJlYWQuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfc3ByZWFkLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfbm9uX2l0ZXJhYmxlX3NwcmVhZCgpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcbn1cbmV4cG9ydHMuXyA9IF9ub25faXRlcmFibGVfc3ByZWFkO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19vYmplY3Rfc3ByZWFkLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fb2JqZWN0X3NwcmVhZC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9kZWZpbmVfcHJvcGVydHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19kZWZpbmVfcHJvcGVydHkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZGVmaW5lX3Byb3BlcnR5LmNqc1wiKTtcbmZ1bmN0aW9uIF9vYmplY3Rfc3ByZWFkKHRhcmdldCkge1xuICAgIGZvcih2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTtcbiAgICAgICAgdmFyIG93bktleXMgPSBPYmplY3Qua2V5cyhzb3VyY2UpO1xuICAgICAgICBpZiAodHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgb3duS2V5cyA9IG93bktleXMuY29uY2F0KE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc291cmNlKS5maWx0ZXIoZnVuY3Rpb24oc3ltKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBzeW0pLmVudW1lcmFibGU7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3duS2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgX2RlZmluZV9wcm9wZXJ0eS5fKHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuZXhwb3J0cy5fID0gX29iamVjdF9zcHJlYWQ7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybi5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hc3NlcnRfdGhpc19pbml0aWFsaXplZC5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3NlcnRfdGhpc19pbml0aWFsaXplZC5janNcIik7XG52YXIgX3R5cGVfb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL190eXBlX29mLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3R5cGVfb2YuY2pzXCIpO1xuZnVuY3Rpb24gX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybihzZWxmLCBjYWxsKSB7XG4gICAgaWYgKGNhbGwgJiYgKF90eXBlX29mLl8oY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHJldHVybiBjYWxsO1xuICAgIHJldHVybiBfYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQuXyhzZWxmKTtcbn1cbmV4cG9ydHMuXyA9IF9wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm47XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NldF9wcm90b3R5cGVfb2YuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zZXRfcHJvdG90eXBlX29mLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfc2V0X3Byb3RvdHlwZV9vZihvLCBwKSB7XG4gICAgZXhwb3J0cy5fID0gX3NldF9wcm90b3R5cGVfb2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gc2V0UHJvdG90eXBlT2YobywgcCkge1xuICAgICAgICBvLl9fcHJvdG9fXyA9IHA7XG4gICAgICAgIHJldHVybiBvO1xuICAgIH07XG4gICAgcmV0dXJuIF9zZXRfcHJvdG90eXBlX29mKG8sIHApO1xufVxuZXhwb3J0cy5fID0gX3NldF9wcm90b3R5cGVfb2Y7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2xpY2VkX3RvX2FycmF5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfYXJyYXlfd2l0aF9ob2xlcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2FycmF5X3dpdGhfaG9sZXMuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aF9ob2xlcy5janNcIik7XG52YXIgX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9faXRlcmFibGVfdG9fYXJyYXlfbGltaXQuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXlfbGltaXQuY2pzXCIpO1xudmFyIF9ub25faXRlcmFibGVfcmVzdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX25vbl9pdGVyYWJsZV9yZXN0LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9yZXN0LmNqc1wiKTtcbnZhciBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janNcIik7XG5mdW5jdGlvbiBfc2xpY2VkX3RvX2FycmF5KGFyciwgaSkge1xuICAgIHJldHVybiBfYXJyYXlfd2l0aF9ob2xlcy5fKGFycikgfHwgX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0Ll8oYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuXyhhcnIsIGkpIHx8IF9ub25faXRlcmFibGVfcmVzdC5fKCk7XG59XG5leHBvcnRzLl8gPSBfc2xpY2VkX3RvX2FycmF5O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19hcnJheS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfYXJyYXlfd2l0aF9ob2xlcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2FycmF5X3dpdGhfaG9sZXMuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aF9ob2xlcy5janNcIik7XG52YXIgX2l0ZXJhYmxlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9faXRlcmFibGVfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF9ub25faXRlcmFibGVfcmVzdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX25vbl9pdGVyYWJsZV9yZXN0LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9yZXN0LmNqc1wiKTtcbnZhciBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janNcIik7XG5mdW5jdGlvbiBfdG9fYXJyYXkoYXJyKSB7XG4gICAgcmV0dXJuIF9hcnJheV93aXRoX2hvbGVzLl8oYXJyKSB8fCBfaXRlcmFibGVfdG9fYXJyYXkuXyhhcnIpIHx8IF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5fKGFycikgfHwgX25vbl9pdGVyYWJsZV9yZXN0Ll8oKTtcbn1cbmV4cG9ydHMuXyA9IF90b19hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fY29uc3VtYWJsZV9hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfYXJyYXlfd2l0aG91dF9ob2xlcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2FycmF5X3dpdGhvdXRfaG9sZXMuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aG91dF9ob2xlcy5janNcIik7XG52YXIgX2l0ZXJhYmxlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9faXRlcmFibGVfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF9ub25faXRlcmFibGVfc3ByZWFkID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fbm9uX2l0ZXJhYmxlX3NwcmVhZC5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfc3ByZWFkLmNqc1wiKTtcbnZhciBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janNcIik7XG5mdW5jdGlvbiBfdG9fY29uc3VtYWJsZV9hcnJheShhcnIpIHtcbiAgICByZXR1cm4gX2FycmF5X3dpdGhvdXRfaG9sZXMuXyhhcnIpIHx8IF9pdGVyYWJsZV90b19hcnJheS5fKGFycikgfHwgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5Ll8oYXJyKSB8fCBfbm9uX2l0ZXJhYmxlX3NwcmVhZC5fKCk7XG59XG5leHBvcnRzLl8gPSBfdG9fY29uc3VtYWJsZV9hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdHlwZV9vZi5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3R5cGVfb2YuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF90eXBlX29mKG9iaikge1xuICAgIFwiQHN3Yy9oZWxwZXJzIC0gdHlwZW9mXCI7XG4gICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7XG59XG5leHBvcnRzLl8gPSBfdHlwZV9vZjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2FycmF5X2xpa2VfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hcnJheV9saWtlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X2xpa2VfdG9fYXJyYXkuY2pzXCIpO1xuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5KG8sIG1pbkxlbikge1xuICAgIGlmICghbykgcmV0dXJuO1xuICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheV9saWtlX3RvX2FycmF5Ll8obywgbWluTGVuKTtcbiAgICB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7XG4gICAgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTtcbiAgICBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShuKTtcbiAgICBpZiAobiA9PT0gXCJBcmd1bWVudHNcIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheV9saWtlX3RvX2FycmF5Ll8obywgbWluTGVuKTtcbn1cbmV4cG9ydHMuXyA9IF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvTmF0aXZlU2NyaXB0TWFuYWdlci5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbmZ1bmN0aW9uIF9leHBvcnQodGFyZ2V0LCBhbGwpIHtcbiAgICBmb3IodmFyIG5hbWUgaW4gYWxsKU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIG5hbWUsIHtcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgZ2V0OiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGFsbCwgbmFtZSkuZ2V0XG4gICAgfSk7XG59XG5fZXhwb3J0KGV4cG9ydHMsIHtcbiAgICBnZXQgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kICgpIHtcbiAgICAgICAgcmV0dXJuIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZDtcbiAgICB9LFxuICAgIGdldCBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGUgKCkge1xuICAgICAgICByZXR1cm4gTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlO1xuICAgIH0sXG4gICAgZ2V0IGRlZmF1bHQgKCkge1xuICAgICAgICByZXR1cm4gX2RlZmF1bHQ7XG4gICAgfVxufSk7XG52YXIgX3JlYWN0bmF0aXZlID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlICovIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlPzFhZmVcIik7XG52YXIgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kID0gZnVuY3Rpb24oTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kKSB7XG4gICAgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kW1wiR0VUXCJdID0gXCJHRVRcIjtcbiAgICBOb3JtYWxpemVkU2NyaXB0TG9jYXRvckhUVFBNZXRob2RbXCJQT1NUXCJdID0gXCJQT1NUXCI7XG4gICAgcmV0dXJuIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZDtcbn0oe30pO1xudmFyIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZSA9IGZ1bmN0aW9uKE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZSkge1xuICAgIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZVtcIlNUUklDVFwiXSA9IFwic3RyaWN0XCI7XG4gICAgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlW1wiTEFYXCJdID0gXCJsYXhcIjtcbiAgICBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGVbXCJPRkZcIl0gPSBcIm9mZlwiO1xuICAgIHJldHVybiBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGU7XG59KHt9KTtcbnZhciBfZGVmYXVsdCA9IF9yZWFjdG5hdGl2ZS5UdXJib01vZHVsZVJlZ2lzdHJ5LmdldCgnU2NyaXB0TWFuYWdlcicpO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9ldmVudHMvZXZlbnRzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAobW9kdWxlKSB7XG5cInVzZSBzdHJpY3RcIjtcbi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgUiA9IHR5cGVvZiBSZWZsZWN0ID09PSAnb2JqZWN0JyA/IFJlZmxlY3QgOiBudWxsO1xudmFyIFJlZmxlY3RBcHBseSA9IFIgJiYgdHlwZW9mIFIuYXBwbHkgPT09ICdmdW5jdGlvbicgPyBSLmFwcGx5IDogZnVuY3Rpb24gUmVmbGVjdEFwcGx5KHRhcmdldCwgcmVjZWl2ZXIsIGFyZ3MpIHtcbiAgICByZXR1cm4gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5LmNhbGwodGFyZ2V0LCByZWNlaXZlciwgYXJncyk7XG59O1xudmFyIFJlZmxlY3RPd25LZXlzO1xuaWYgKFIgJiYgdHlwZW9mIFIub3duS2V5cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIFJlZmxlY3RPd25LZXlzID0gUi5vd25LZXlzO1xufSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7XG4gICAgUmVmbGVjdE93bktleXMgPSBmdW5jdGlvbiBSZWZsZWN0T3duS2V5cyh0YXJnZXQpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRhcmdldCkuY29uY2F0KE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHModGFyZ2V0KSk7XG4gICAgfTtcbn0gZWxzZSB7XG4gICAgUmVmbGVjdE93bktleXMgPSBmdW5jdGlvbiBSZWZsZWN0T3duS2V5cyh0YXJnZXQpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRhcmdldCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIFByb2Nlc3NFbWl0V2FybmluZyh3YXJuaW5nKSB7XG4gICAgaWYgKGNvbnNvbGUgJiYgY29uc29sZS53YXJuKSBjb25zb2xlLndhcm4od2FybmluZyk7XG59XG52YXIgTnVtYmVySXNOYU4gPSBOdW1iZXIuaXNOYU4gfHwgZnVuY3Rpb24gTnVtYmVySXNOYU4odmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgIT09IHZhbHVlO1xufTtcbmZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHtcbiAgICBFdmVudEVtaXR0ZXIuaW5pdC5jYWxsKHRoaXMpO1xufVxubW9kdWxlLmV4cG9ydHMgPSBFdmVudEVtaXR0ZXI7XG5tb2R1bGUuZXhwb3J0cy5vbmNlID0gb25jZTtcbi8vIEJhY2t3YXJkcy1jb21wYXQgd2l0aCBub2RlIDAuMTAueFxuRXZlbnRFbWl0dGVyLkV2ZW50RW1pdHRlciA9IEV2ZW50RW1pdHRlcjtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50cyA9IHVuZGVmaW5lZDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50c0NvdW50ID0gMDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDtcbi8vIEJ5IGRlZmF1bHQgRXZlbnRFbWl0dGVycyB3aWxsIHByaW50IGEgd2FybmluZyBpZiBtb3JlIHRoYW4gMTAgbGlzdGVuZXJzIGFyZVxuLy8gYWRkZWQgdG8gaXQuIFRoaXMgaXMgYSB1c2VmdWwgZGVmYXVsdCB3aGljaCBoZWxwcyBmaW5kaW5nIG1lbW9yeSBsZWFrcy5cbnZhciBkZWZhdWx0TWF4TGlzdGVuZXJzID0gMTA7XG5mdW5jdGlvbiBjaGVja0xpc3RlbmVyKGxpc3RlbmVyKSB7XG4gICAgaWYgKHR5cGVvZiBsaXN0ZW5lciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJsaXN0ZW5lclwiIGFyZ3VtZW50IG11c3QgYmUgb2YgdHlwZSBGdW5jdGlvbi4gUmVjZWl2ZWQgdHlwZSAnICsgdHlwZW9mIGxpc3RlbmVyKTtcbiAgICB9XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoRXZlbnRFbWl0dGVyLCAnZGVmYXVsdE1heExpc3RlbmVycycsIHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0TWF4TGlzdGVuZXJzO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhcmcgIT09ICdudW1iZXInIHx8IGFyZyA8IDAgfHwgTnVtYmVySXNOYU4oYXJnKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSB2YWx1ZSBvZiBcImRlZmF1bHRNYXhMaXN0ZW5lcnNcIiBpcyBvdXQgb2YgcmFuZ2UuIEl0IG11c3QgYmUgYSBub24tbmVnYXRpdmUgbnVtYmVyLiBSZWNlaXZlZCAnICsgYXJnICsgJy4nKTtcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0TWF4TGlzdGVuZXJzID0gYXJnO1xuICAgIH1cbn0pO1xuRXZlbnRFbWl0dGVyLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5fZXZlbnRzID09PSB1bmRlZmluZWQgfHwgdGhpcy5fZXZlbnRzID09PSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcykuX2V2ZW50cykge1xuICAgICAgICB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICB0aGlzLl9ldmVudHNDb3VudCA9IDA7XG4gICAgfVxuICAgIHRoaXMuX21heExpc3RlbmVycyA9IHRoaXMuX21heExpc3RlbmVycyB8fCB1bmRlZmluZWQ7XG59O1xuLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzXG4vLyB0aGF0IHRvIGJlIGluY3JlYXNlZC4gU2V0IHRvIHplcm8gZm9yIHVubGltaXRlZC5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuc2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24gc2V0TWF4TGlzdGVuZXJzKG4pIHtcbiAgICBpZiAodHlwZW9mIG4gIT09ICdudW1iZXInIHx8IG4gPCAwIHx8IE51bWJlcklzTmFOKG4pKSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdUaGUgdmFsdWUgb2YgXCJuXCIgaXMgb3V0IG9mIHJhbmdlLiBJdCBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlci4gUmVjZWl2ZWQgJyArIG4gKyAnLicpO1xuICAgIH1cbiAgICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSBuO1xuICAgIHJldHVybiB0aGlzO1xufTtcbmZ1bmN0aW9uIF9nZXRNYXhMaXN0ZW5lcnModGhhdCkge1xuICAgIGlmICh0aGF0Ll9tYXhMaXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIEV2ZW50RW1pdHRlci5kZWZhdWx0TWF4TGlzdGVuZXJzO1xuICAgIHJldHVybiB0aGF0Ll9tYXhMaXN0ZW5lcnM7XG59XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmdldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uIGdldE1heExpc3RlbmVycygpIHtcbiAgICByZXR1cm4gX2dldE1heExpc3RlbmVycyh0aGlzKTtcbn07XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiBlbWl0KHR5cGUpIHtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvcih2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7XG4gICAgdmFyIGRvRXJyb3IgPSB0eXBlID09PSAnZXJyb3InO1xuICAgIHZhciBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyAhPT0gdW5kZWZpbmVkKSBkb0Vycm9yID0gZG9FcnJvciAmJiBldmVudHMuZXJyb3IgPT09IHVuZGVmaW5lZDtcbiAgICBlbHNlIGlmICghZG9FcnJvcikgcmV0dXJuIGZhbHNlO1xuICAgIC8vIElmIHRoZXJlIGlzIG5vICdlcnJvcicgZXZlbnQgbGlzdGVuZXIgdGhlbiB0aHJvdy5cbiAgICBpZiAoZG9FcnJvcikge1xuICAgICAgICB2YXIgZXI7XG4gICAgICAgIGlmIChhcmdzLmxlbmd0aCA+IDApIGVyID0gYXJnc1swXTtcbiAgICAgICAgaWYgKGVyIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgIC8vIE5vdGU6IFRoZSBjb21tZW50cyBvbiB0aGUgYHRocm93YCBsaW5lcyBhcmUgaW50ZW50aW9uYWwsIHRoZXkgc2hvd1xuICAgICAgICAgICAgLy8gdXAgaW4gTm9kZSdzIG91dHB1dCBpZiB0aGlzIHJlc3VsdHMgaW4gYW4gdW5oYW5kbGVkIGV4Y2VwdGlvbi5cbiAgICAgICAgICAgIHRocm93IGVyOyAvLyBVbmhhbmRsZWQgJ2Vycm9yJyBldmVudFxuICAgICAgICB9XG4gICAgICAgIC8vIEF0IGxlYXN0IGdpdmUgc29tZSBraW5kIG9mIGNvbnRleHQgdG8gdGhlIHVzZXJcbiAgICAgICAgdmFyIGVyciA9IG5ldyBFcnJvcignVW5oYW5kbGVkIGVycm9yLicgKyAoZXIgPyAnICgnICsgZXIubWVzc2FnZSArICcpJyA6ICcnKSk7XG4gICAgICAgIGVyci5jb250ZXh0ID0gZXI7XG4gICAgICAgIHRocm93IGVycjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICB9XG4gICAgdmFyIGhhbmRsZXIgPSBldmVudHNbdHlwZV07XG4gICAgaWYgKGhhbmRsZXIgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBSZWZsZWN0QXBwbHkoaGFuZGxlciwgdGhpcywgYXJncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGxlbiA9IGhhbmRsZXIubGVuZ3RoO1xuICAgICAgICB2YXIgbGlzdGVuZXJzID0gYXJyYXlDbG9uZShoYW5kbGVyLCBsZW4pO1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpUmVmbGVjdEFwcGx5KGxpc3RlbmVyc1tpXSwgdGhpcywgYXJncyk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcbmZ1bmN0aW9uIF9hZGRMaXN0ZW5lcih0YXJnZXQsIHR5cGUsIGxpc3RlbmVyLCBwcmVwZW5kKSB7XG4gICAgdmFyIG07XG4gICAgdmFyIGV2ZW50cztcbiAgICB2YXIgZXhpc3Rpbmc7XG4gICAgY2hlY2tMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgZXZlbnRzID0gdGFyZ2V0Ll9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGV2ZW50cyA9IHRhcmdldC5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgdGFyZ2V0Ll9ldmVudHNDb3VudCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gVG8gYXZvaWQgcmVjdXJzaW9uIGluIHRoZSBjYXNlIHRoYXQgdHlwZSA9PT0gXCJuZXdMaXN0ZW5lclwiISBCZWZvcmVcbiAgICAgICAgLy8gYWRkaW5nIGl0IHRvIHRoZSBsaXN0ZW5lcnMsIGZpcnN0IGVtaXQgXCJuZXdMaXN0ZW5lclwiLlxuICAgICAgICBpZiAoZXZlbnRzLm5ld0xpc3RlbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRhcmdldC5lbWl0KCduZXdMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyLmxpc3RlbmVyID8gbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7XG4gICAgICAgICAgICAvLyBSZS1hc3NpZ24gYGV2ZW50c2AgYmVjYXVzZSBhIG5ld0xpc3RlbmVyIGhhbmRsZXIgY291bGQgaGF2ZSBjYXVzZWQgdGhlXG4gICAgICAgICAgICAvLyB0aGlzLl9ldmVudHMgdG8gYmUgYXNzaWduZWQgdG8gYSBuZXcgb2JqZWN0XG4gICAgICAgICAgICBldmVudHMgPSB0YXJnZXQuX2V2ZW50cztcbiAgICAgICAgfVxuICAgICAgICBleGlzdGluZyA9IGV2ZW50c1t0eXBlXTtcbiAgICB9XG4gICAgaWYgKGV4aXN0aW5nID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuXG4gICAgICAgIGV4aXN0aW5nID0gZXZlbnRzW3R5cGVdID0gbGlzdGVuZXI7XG4gICAgICAgICsrdGFyZ2V0Ll9ldmVudHNDb3VudDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodHlwZW9mIGV4aXN0aW5nID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAvLyBBZGRpbmcgdGhlIHNlY29uZCBlbGVtZW50LCBuZWVkIHRvIGNoYW5nZSB0byBhcnJheS5cbiAgICAgICAgICAgIGV4aXN0aW5nID0gZXZlbnRzW3R5cGVdID0gcHJlcGVuZCA/IFtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcixcbiAgICAgICAgICAgICAgICBleGlzdGluZ1xuICAgICAgICAgICAgXSA6IFtcbiAgICAgICAgICAgICAgICBleGlzdGluZyxcbiAgICAgICAgICAgICAgICBsaXN0ZW5lclxuICAgICAgICAgICAgXTtcbiAgICAgICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYXBwZW5kLlxuICAgICAgICB9IGVsc2UgaWYgKHByZXBlbmQpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nLnVuc2hpZnQobGlzdGVuZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhpc3RpbmcucHVzaChsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2hlY2sgZm9yIGxpc3RlbmVyIGxlYWtcbiAgICAgICAgbSA9IF9nZXRNYXhMaXN0ZW5lcnModGFyZ2V0KTtcbiAgICAgICAgaWYgKG0gPiAwICYmIGV4aXN0aW5nLmxlbmd0aCA+IG0gJiYgIWV4aXN0aW5nLndhcm5lZCkge1xuICAgICAgICAgICAgZXhpc3Rpbmcud2FybmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vIE5vIGVycm9yIGNvZGUgZm9yIHRoaXMgc2luY2UgaXQgaXMgYSBXYXJuaW5nXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1zeW50YXhcbiAgICAgICAgICAgIHZhciB3ID0gbmV3IEVycm9yKCdQb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5IGxlYWsgZGV0ZWN0ZWQuICcgKyBleGlzdGluZy5sZW5ndGggKyAnICcgKyBTdHJpbmcodHlwZSkgKyAnIGxpc3RlbmVycyAnICsgJ2FkZGVkLiBVc2UgZW1pdHRlci5zZXRNYXhMaXN0ZW5lcnMoKSB0byAnICsgJ2luY3JlYXNlIGxpbWl0Jyk7XG4gICAgICAgICAgICB3Lm5hbWUgPSAnTWF4TGlzdGVuZXJzRXhjZWVkZWRXYXJuaW5nJztcbiAgICAgICAgICAgIHcuZW1pdHRlciA9IHRhcmdldDtcbiAgICAgICAgICAgIHcudHlwZSA9IHR5cGU7XG4gICAgICAgICAgICB3LmNvdW50ID0gZXhpc3RpbmcubGVuZ3RoO1xuICAgICAgICAgICAgUHJvY2Vzc0VtaXRXYXJuaW5nKHcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyID0gZnVuY3Rpb24gYWRkTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICByZXR1cm4gX2FkZExpc3RlbmVyKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCBmYWxzZSk7XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXI7XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnByZXBlbmRMaXN0ZW5lciA9IGZ1bmN0aW9uIHByZXBlbmRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikge1xuICAgIHJldHVybiBfYWRkTGlzdGVuZXIodGhpcywgdHlwZSwgbGlzdGVuZXIsIHRydWUpO1xufTtcbmZ1bmN0aW9uIG9uY2VXcmFwcGVyKCkge1xuICAgIGlmICghdGhpcy5maXJlZCkge1xuICAgICAgICB0aGlzLnRhcmdldC5yZW1vdmVMaXN0ZW5lcih0aGlzLnR5cGUsIHRoaXMud3JhcEZuKTtcbiAgICAgICAgdGhpcy5maXJlZCA9IHRydWU7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdGhpcy5saXN0ZW5lci5jYWxsKHRoaXMudGFyZ2V0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIuYXBwbHkodGhpcy50YXJnZXQsIGFyZ3VtZW50cyk7XG4gICAgfVxufVxuZnVuY3Rpb24gX29uY2VXcmFwKHRhcmdldCwgdHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgc3RhdGUgPSB7XG4gICAgICAgIGZpcmVkOiBmYWxzZSxcbiAgICAgICAgd3JhcEZuOiB1bmRlZmluZWQsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0LFxuICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICBsaXN0ZW5lcjogbGlzdGVuZXJcbiAgICB9O1xuICAgIHZhciB3cmFwcGVkID0gb25jZVdyYXBwZXIuYmluZChzdGF0ZSk7XG4gICAgd3JhcHBlZC5saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgIHN0YXRlLndyYXBGbiA9IHdyYXBwZWQ7XG4gICAgcmV0dXJuIHdyYXBwZWQ7XG59XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiBvbmNlKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgY2hlY2tMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgdGhpcy5vbih0eXBlLCBfb25jZVdyYXAodGhpcywgdHlwZSwgbGlzdGVuZXIpKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBmdW5jdGlvbiBwcmVwZW5kT25jZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgY2hlY2tMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgdGhpcy5wcmVwZW5kTGlzdGVuZXIodHlwZSwgX29uY2VXcmFwKHRoaXMsIHR5cGUsIGxpc3RlbmVyKSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuLy8gRW1pdHMgYSAncmVtb3ZlTGlzdGVuZXInIGV2ZW50IGlmIGFuZCBvbmx5IGlmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZC5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbiByZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBsaXN0LCBldmVudHMsIHBvc2l0aW9uLCBpLCBvcmlnaW5hbExpc3RlbmVyO1xuICAgIGNoZWNrTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIGV2ZW50cyA9IHRoaXMuX2V2ZW50cztcbiAgICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpIHJldHVybiB0aGlzO1xuICAgIGxpc3QgPSBldmVudHNbdHlwZV07XG4gICAgaWYgKGxpc3QgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXM7XG4gICAgaWYgKGxpc3QgPT09IGxpc3RlbmVyIHx8IGxpc3QubGlzdGVuZXIgPT09IGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICgtLXRoaXMuX2V2ZW50c0NvdW50ID09PSAwKSB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRlbGV0ZSBldmVudHNbdHlwZV07XG4gICAgICAgICAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyKSB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgbGlzdC5saXN0ZW5lciB8fCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBsaXN0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHBvc2l0aW9uID0gLTE7XG4gICAgICAgIGZvcihpID0gbGlzdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XG4gICAgICAgICAgICBpZiAobGlzdFtpXSA9PT0gbGlzdGVuZXIgfHwgbGlzdFtpXS5saXN0ZW5lciA9PT0gbGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbExpc3RlbmVyID0gbGlzdFtpXS5saXN0ZW5lcjtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IGk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgcmV0dXJuIHRoaXM7XG4gICAgICAgIGlmIChwb3NpdGlvbiA9PT0gMCkgbGlzdC5zaGlmdCgpO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNwbGljZU9uZShsaXN0LCBwb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09PSAxKSBldmVudHNbdHlwZV0gPSBsaXN0WzBdO1xuICAgICAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyICE9PSB1bmRlZmluZWQpIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBvcmlnaW5hbExpc3RlbmVyIHx8IGxpc3RlbmVyKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vZmYgPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyO1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbiByZW1vdmVBbGxMaXN0ZW5lcnModHlwZSkge1xuICAgIHZhciBsaXN0ZW5lcnMsIGV2ZW50cywgaTtcbiAgICBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdGhpcztcbiAgICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0XG4gICAgaWYgKGV2ZW50cy5yZW1vdmVMaXN0ZW5lciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICAgICAgdGhpcy5fZXZlbnRzQ291bnQgPSAwO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50c1t0eXBlXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAoLS10aGlzLl9ldmVudHNDb3VudCA9PT0gMCkgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgICAgIGVsc2UgZGVsZXRlIGV2ZW50c1t0eXBlXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLy8gZW1pdCByZW1vdmVMaXN0ZW5lciBmb3IgYWxsIGxpc3RlbmVycyBvbiBhbGwgZXZlbnRzXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhldmVudHMpO1xuICAgICAgICB2YXIga2V5O1xuICAgICAgICBmb3IoaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgIGtleSA9IGtleXNbaV07XG4gICAgICAgICAgICBpZiAoa2V5ID09PSAncmVtb3ZlTGlzdGVuZXInKSBjb250aW51ZTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3JlbW92ZUxpc3RlbmVyJyk7XG4gICAgICAgIHRoaXMuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIHRoaXMuX2V2ZW50c0NvdW50ID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGxpc3RlbmVycyA9IGV2ZW50c1t0eXBlXTtcbiAgICBpZiAodHlwZW9mIGxpc3RlbmVycyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVycyk7XG4gICAgfSBlbHNlIGlmIChsaXN0ZW5lcnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBMSUZPIG9yZGVyXG4gICAgICAgIGZvcihpID0gbGlzdGVuZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKXtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5mdW5jdGlvbiBfbGlzdGVuZXJzKHRhcmdldCwgdHlwZSwgdW53cmFwKSB7XG4gICAgdmFyIGV2ZW50cyA9IHRhcmdldC5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIFtdO1xuICAgIHZhciBldmxpc3RlbmVyID0gZXZlbnRzW3R5cGVdO1xuICAgIGlmIChldmxpc3RlbmVyID09PSB1bmRlZmluZWQpIHJldHVybiBbXTtcbiAgICBpZiAodHlwZW9mIGV2bGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHJldHVybiB1bndyYXAgPyBbXG4gICAgICAgIGV2bGlzdGVuZXIubGlzdGVuZXIgfHwgZXZsaXN0ZW5lclxuICAgIF0gOiBbXG4gICAgICAgIGV2bGlzdGVuZXJcbiAgICBdO1xuICAgIHJldHVybiB1bndyYXAgPyB1bndyYXBMaXN0ZW5lcnMoZXZsaXN0ZW5lcikgOiBhcnJheUNsb25lKGV2bGlzdGVuZXIsIGV2bGlzdGVuZXIubGVuZ3RoKTtcbn1cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24gbGlzdGVuZXJzKHR5cGUpIHtcbiAgICByZXR1cm4gX2xpc3RlbmVycyh0aGlzLCB0eXBlLCB0cnVlKTtcbn07XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnJhd0xpc3RlbmVycyA9IGZ1bmN0aW9uIHJhd0xpc3RlbmVycyh0eXBlKSB7XG4gICAgcmV0dXJuIF9saXN0ZW5lcnModGhpcywgdHlwZSwgZmFsc2UpO1xufTtcbkV2ZW50RW1pdHRlci5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24oZW1pdHRlciwgdHlwZSkge1xuICAgIGlmICh0eXBlb2YgZW1pdHRlci5saXN0ZW5lckNvdW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBlbWl0dGVyLmxpc3RlbmVyQ291bnQodHlwZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGxpc3RlbmVyQ291bnQuY2FsbChlbWl0dGVyLCB0eXBlKTtcbiAgICB9XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lckNvdW50ID0gbGlzdGVuZXJDb3VudDtcbmZ1bmN0aW9uIGxpc3RlbmVyQ291bnQodHlwZSkge1xuICAgIHZhciBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhciBldmxpc3RlbmVyID0gZXZlbnRzW3R5cGVdO1xuICAgICAgICBpZiAodHlwZW9mIGV2bGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9IGVsc2UgaWYgKGV2bGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGV2bGlzdGVuZXIubGVuZ3RoO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5ldmVudE5hbWVzID0gZnVuY3Rpb24gZXZlbnROYW1lcygpIHtcbiAgICByZXR1cm4gdGhpcy5fZXZlbnRzQ291bnQgPiAwID8gUmVmbGVjdE93bktleXModGhpcy5fZXZlbnRzKSA6IFtdO1xufTtcbmZ1bmN0aW9uIGFycmF5Q2xvbmUoYXJyLCBuKSB7XG4gICAgdmFyIGNvcHkgPSBuZXcgQXJyYXkobik7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IG47ICsraSljb3B5W2ldID0gYXJyW2ldO1xuICAgIHJldHVybiBjb3B5O1xufVxuZnVuY3Rpb24gc3BsaWNlT25lKGxpc3QsIGluZGV4KSB7XG4gICAgZm9yKDsgaW5kZXggKyAxIDwgbGlzdC5sZW5ndGg7IGluZGV4KyspbGlzdFtpbmRleF0gPSBsaXN0W2luZGV4ICsgMV07XG4gICAgbGlzdC5wb3AoKTtcbn1cbmZ1bmN0aW9uIHVud3JhcExpc3RlbmVycyhhcnIpIHtcbiAgICB2YXIgcmV0ID0gbmV3IEFycmF5KGFyci5sZW5ndGgpO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCByZXQubGVuZ3RoOyArK2kpe1xuICAgICAgICByZXRbaV0gPSBhcnJbaV0ubGlzdGVuZXIgfHwgYXJyW2ldO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufVxuZnVuY3Rpb24gb25jZShlbWl0dGVyLCBuYW1lKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBlcnJvckxpc3RlbmVyKGVycikge1xuICAgICAgICAgICAgZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihuYW1lLCByZXNvbHZlcik7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNvbHZlcigpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZW1pdHRlci5yZW1vdmVMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgZXJyb3JMaXN0ZW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNvbHZlKFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKSk7XG4gICAgICAgIH1cbiAgICAgICAgO1xuICAgICAgICBldmVudFRhcmdldEFnbm9zdGljQWRkTGlzdGVuZXIoZW1pdHRlciwgbmFtZSwgcmVzb2x2ZXIsIHtcbiAgICAgICAgICAgIG9uY2U6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChuYW1lICE9PSAnZXJyb3InKSB7XG4gICAgICAgICAgICBhZGRFcnJvckhhbmRsZXJJZkV2ZW50RW1pdHRlcihlbWl0dGVyLCBlcnJvckxpc3RlbmVyLCB7XG4gICAgICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGFkZEVycm9ySGFuZGxlcklmRXZlbnRFbWl0dGVyKGVtaXR0ZXIsIGhhbmRsZXIsIGZsYWdzKSB7XG4gICAgaWYgKHR5cGVvZiBlbWl0dGVyLm9uID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGV2ZW50VGFyZ2V0QWdub3N0aWNBZGRMaXN0ZW5lcihlbWl0dGVyLCAnZXJyb3InLCBoYW5kbGVyLCBmbGFncyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXZlbnRUYXJnZXRBZ25vc3RpY0FkZExpc3RlbmVyKGVtaXR0ZXIsIG5hbWUsIGxpc3RlbmVyLCBmbGFncykge1xuICAgIGlmICh0eXBlb2YgZW1pdHRlci5vbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBpZiAoZmxhZ3Mub25jZSkge1xuICAgICAgICAgICAgZW1pdHRlci5vbmNlKG5hbWUsIGxpc3RlbmVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVtaXR0ZXIub24obmFtZSwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZW1pdHRlci5hZGRFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIEV2ZW50VGFyZ2V0IGRvZXMgbm90IGhhdmUgYGVycm9yYCBldmVudCBzZW1hbnRpY3MgbGlrZSBOb2RlXG4gICAgICAgIC8vIEV2ZW50RW1pdHRlcnMsIHdlIGRvIG5vdCBsaXN0ZW4gZm9yIGBlcnJvcmAgZXZlbnRzIGhlcmUuXG4gICAgICAgIGVtaXR0ZXIuYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBmdW5jdGlvbiB3cmFwTGlzdGVuZXIoYXJnKSB7XG4gICAgICAgICAgICAvLyBJRSBkb2VzIG5vdCBoYXZlIGJ1aWx0aW4gYHsgb25jZTogdHJ1ZSB9YCBzdXBwb3J0IHNvIHdlXG4gICAgICAgICAgICAvLyBoYXZlIHRvIGRvIGl0IG1hbnVhbGx5LlxuICAgICAgICAgICAgaWYgKGZsYWdzLm9uY2UpIHtcbiAgICAgICAgICAgICAgICBlbWl0dGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIobmFtZSwgd3JhcExpc3RlbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxpc3RlbmVyKGFyZyk7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBcImVtaXR0ZXJcIiBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGUgRXZlbnRFbWl0dGVyLiBSZWNlaXZlZCB0eXBlICcgKyB0eXBlb2YgZW1pdHRlcik7XG4gICAgfVxufVxuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9zaGFsbG93ZXF1YWwvaW5kZXguanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9zaGFsbG93ZXF1YWwvaW5kZXguanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChtb2R1bGUpIHtcbi8vXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNoYWxsb3dFcXVhbChvYmpBLCBvYmpCLCBjb21wYXJlLCBjb21wYXJlQ29udGV4dCkge1xuICAgIHZhciByZXQgPSBjb21wYXJlID8gY29tcGFyZS5jYWxsKGNvbXBhcmVDb250ZXh0LCBvYmpBLCBvYmpCKSA6IHZvaWQgMDtcbiAgICBpZiAocmV0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgcmV0dXJuICEhcmV0O1xuICAgIH1cbiAgICBpZiAob2JqQSA9PT0gb2JqQikge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvYmpBICE9PSBcIm9iamVjdFwiIHx8ICFvYmpBIHx8IHR5cGVvZiBvYmpCICE9PSBcIm9iamVjdFwiIHx8ICFvYmpCKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGtleXNBID0gT2JqZWN0LmtleXMob2JqQSk7XG4gICAgdmFyIGtleXNCID0gT2JqZWN0LmtleXMob2JqQik7XG4gICAgaWYgKGtleXNBLmxlbmd0aCAhPT0ga2V5c0IubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGJIYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuYmluZChvYmpCKTtcbiAgICAvLyBUZXN0IGZvciBBJ3Mga2V5cyBkaWZmZXJlbnQgZnJvbSBCLlxuICAgIGZvcih2YXIgaWR4ID0gMDsgaWR4IDwga2V5c0EubGVuZ3RoOyBpZHgrKyl7XG4gICAgICAgIHZhciBrZXkgPSBrZXlzQVtpZHhdO1xuICAgICAgICBpZiAoIWJIYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZhbHVlQSA9IG9iakFba2V5XTtcbiAgICAgICAgdmFyIHZhbHVlQiA9IG9iakJba2V5XTtcbiAgICAgICAgcmV0ID0gY29tcGFyZSA/IGNvbXBhcmUuY2FsbChjb21wYXJlQ29udGV4dCwgdmFsdWVBLCB2YWx1ZUIsIGtleSkgOiB2b2lkIDA7XG4gICAgICAgIGlmIChyZXQgPT09IGZhbHNlIHx8IHJldCA9PT0gdm9pZCAwICYmIHZhbHVlQSAhPT0gdmFsdWVCKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5cbn0pLFxuXCJAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9yc3BhY2suanMhPSFkYXRhOnRleHQvamF2YXNjcmlwdCxpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyBmcm9tIFxcXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9zcG9ydHMvbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3Nwb3J0cy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzXFxcIjtpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18gZnJvbSBcXFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvc3BvcnRzL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qc1xcXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyA9IFtfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXygpLCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzFfXygpXTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fID0ge307Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fID0gXFxcInNwb3J0c1xcXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fID0gXFxcImxvYWRlZC1maXJzdFxcXCI7aWYoKF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhfHxfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkmJl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbil7dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyO2NvbnN0IG92ZXJyaWRlPShvYmosa2V5LHZhbHVlKT0+e2lmKCFvYmopcmV0dXJuO2lmKG9ialtrZXldKW9ialtrZXldPXZhbHVlfTtjb25zdCBtZXJnZT0ob2JqLGtleSxmbik9Pntjb25zdCB2YWx1ZT1mbigpO2lmKEFycmF5LmlzQXJyYXkodmFsdWUpKXt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPVtdO29ialtrZXldLnB1c2goLi4udmFsdWUpfWVsc2UgaWYodHlwZW9mIHZhbHVlPT09XFxcIm9iamVjdFxcXCImJnZhbHVlIT09bnVsbCl7dmFyIF9vYmoxLF9rZXkxO3ZhciBfMTsoXzE9KF9vYmoxPW9iailbX2tleTE9a2V5XSkhPT1udWxsJiZfMSE9PXZvaWQgMD9fMTpfb2JqMVtfa2V5MV09e307T2JqZWN0LmFzc2lnbihvYmpba2V5XSx2YWx1ZSl9fTtjb25zdCBlYXJseT0ob2JqLGtleSxpbml0aWFsKT0+e3ZhciBfb2JqLF9rZXk7dmFyIF87KF89KF9vYmo9b2JqKVtfa2V5PWtleV0pIT09bnVsbCYmXyE9PXZvaWQgMD9fOl9vYmpbX2tleV09aW5pdGlhbCgpfTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZztjb25zdCBpbml0aWFsaXplU2hhcmluZ1Njb3BlVG9Jbml0RGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCBjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc6e307Y29uc3QgY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcz17fTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcz1bXTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRUb2tlbnM9e307Y29uc3QgY29udGFpbmVyU2hhcmVTY29wZT0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLnNoYXJlU2NvcGU7Zm9yKGNvbnN0IGtleSBpbiBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fKXtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb25ba2V5XT1fX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fW2tleV19ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nXFxcIiwoKT0+e2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nKSl7Y29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1ttb2R1bGVJZF09e2dldHRlcjpkYXRhLmZhbGxiYWNrLHNoYXJlSW5mbzp7c2hhcmVDb25maWc6e2ZpeGVkRGVwZW5kZW5jaWVzOmZhbHNlLHJlcXVpcmVkVmVyc2lvbjpkYXRhLnJlcXVpcmVkVmVyc2lvbixzdHJpY3RWZXJzaW9uOmRhdGEuc3RyaWN0VmVyc2lvbixzaW5nbGV0b246ZGF0YS5zaW5nbGV0b24sZWFnZXI6ZGF0YS5lYWdlcn0sc2NvcGU6W2RhdGEuc2hhcmVTY29wZV19LHNoYXJlS2V5OmRhdGEuc2hhcmVLZXl9fXJldHVybiBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJpbml0T3B0aW9uc1xcXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwibmFtZVxcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJzaGFyZVN0cmF0ZWd5XFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXFxcInNoYXJlZFxcXCIsKCk9Pntjb25zdCBzaGFyZWQ9e307Zm9yKGxldFtzY29wZSxzdGFnZXNdb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nKSl7Zm9yKGxldCBzdGFnZSBvZiBzdGFnZXMpe2lmKHR5cGVvZiBzdGFnZT09PVxcXCJvYmplY3RcXFwiJiZzdGFnZSE9PW51bGwpe2NvbnN0e25hbWUsdmVyc2lvbixmYWN0b3J5LGVhZ2VyLHNpbmdsZXRvbixyZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbn09c3RhZ2U7Y29uc3Qgc2hhcmVDb25maWc9e307Y29uc3QgaXNWYWxpZFZhbHVlPWZ1bmN0aW9uKHZhbCl7cmV0dXJuIHR5cGVvZiB2YWwhPT1cXFwidW5kZWZpbmVkXFxcIn07aWYoaXNWYWxpZFZhbHVlKHNpbmdsZXRvbikpe3NoYXJlQ29uZmlnLnNpbmdsZXRvbj1zaW5nbGV0b259aWYoaXNWYWxpZFZhbHVlKHJlcXVpcmVkVmVyc2lvbikpe3NoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbj1yZXF1aXJlZFZlcnNpb259aWYoaXNWYWxpZFZhbHVlKGVhZ2VyKSl7c2hhcmVDb25maWcuZWFnZXI9ZWFnZXJ9aWYoaXNWYWxpZFZhbHVlKHN0cmljdFZlcnNpb24pKXtzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uPXN0cmljdFZlcnNpb259Y29uc3Qgb3B0aW9ucz17dmVyc2lvbixzY29wZTpbc2NvcGVdLHNoYXJlQ29uZmlnLGdldDpmYWN0b3J5fTtpZihzaGFyZWRbbmFtZV0pe3NoYXJlZFtuYW1lXS5wdXNoKG9wdGlvbnMpfWVsc2V7c2hhcmVkW25hbWVdPVtvcHRpb25zXX19fX1yZXR1cm4gc2hhcmVkfSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKHJlbW90ZT0+cmVtb3RlLmV4dGVybmFsVHlwZT09PVxcXCJzY3JpcHRcXFwiKSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJwbHVnaW5zXFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJidW5kbGVyUnVudGltZU9wdGlvbnNcXFwiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJjaHVua01hcHBpbmdcXFwiLCgpPT5yZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1xcXCIsKCk9Pntjb25zdCByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZz17fTtmb3IobGV0W21vZHVsZUlkLGRhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtyZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ1ttb2R1bGVJZF09W2RhdGEuc2hhcmVTY29wZSxkYXRhLm5hbWUsZGF0YS5leHRlcm5hbE1vZHVsZUlkLGRhdGEucmVtb3RlTmFtZV19cmV0dXJuIHJlbW90ZXNMb2FkaW5nSWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJ3ZWJwYWNrUmVxdWlyZVxcXCIsKCk9Pl9fd2VicGFja19yZXF1aXJlX18pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiaWRUb1JlbW90ZU1hcFxcXCIsKCk9Pntjb25zdCBpZFRvUmVtb3RlTWFwPXt9O2ZvcihsZXRbaWQscmVtb3RlRGF0YV1vZiBPYmplY3QuZW50cmllcyhyZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykpe2NvbnN0IGluZm89X19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfX1tyZW1vdGVEYXRhLnJlbW90ZU5hbWVdO2lmKGluZm8paWRUb1JlbW90ZU1hcFtpZF09aW5mb31yZXR1cm4gaWRUb1JlbW90ZU1hcH0pO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcIlNcXFwiLF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtpZihfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyl9b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLFxcXCJyZW1vdGVzXFxcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpyZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyxpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsaWRUb1JlbW90ZU1hcDpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb1JlbW90ZU1hcCx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcXFwiY29uc3VtZXNcXFwiLChjaHVua0lkLHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmNvbnN1bWVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmcsbW9kdWxlVG9IYW5kbGVyTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZyxpbnN0YWxsZWRNb2R1bGVzOmNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJJXFxcIiwobmFtZSxpbml0U2NvcGUpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuSSh7c2hhcmVTY29wZU5hbWU6bmFtZSxpbml0U2NvcGUsaW5pdFByb21pc2VzOmluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzLGluaXRUb2tlbnM6aW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcXFwiaW5pdENvbnRhaW5lclxcXCIsKHNoYXJlU2NvcGUsaW5pdFNjb3BlLHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5pdENvbnRhaW5lckVudHJ5KHtzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zLHNoYXJlU2NvcGVLZXk6Y29udGFpbmVyU2hhcmVTY29wZSx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcImdldENvbnRhaW5lclxcXCIsKG1vZHVsZTEsZ2V0U2NvcGUpPT57dmFyIG1vZHVsZU1hcD1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YS5tb2R1bGVNYXA7X193ZWJwYWNrX3JlcXVpcmVfXy5SPWdldFNjb3BlO2dldFNjb3BlPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2R1bGVNYXAsbW9kdWxlMSk/bW9kdWxlTWFwW21vZHVsZTFdKCk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKT0+e3Rocm93IG5ldyBFcnJvcignTW9kdWxlIFxcXCInK21vZHVsZTErJ1xcXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5SPXVuZGVmaW5lZDtyZXR1cm4gZ2V0U2NvcGV9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5zdGFuY2U9X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyLmluaXRpYWxDb25zdW1lcyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe3dlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX18saW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLGluaXRpYWxDb25zdW1lczpfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmd9KX19XCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIEBtb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL3JzcGFjay5qcyE9IWRhdGE6dGV4dC9qYXZhc2NyaXB0LGltcG9ydCBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fIGZyb20gXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9zcG9ydHMvbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1wiO2ltcG9ydCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXyBmcm9tIFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvc3BvcnRzL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanNcIjtpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18gZnJvbSBcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3Nwb3J0cy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanNcIjtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luc19fID0gW19fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fKCksIF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fKCldO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX18gPSB7fTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18gPSBcInNwb3J0c1wiO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyA9IFwibG9hZGVkLWZpcnN0XCI7aWYoKF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhfHxfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkmJl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbil7dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyO2NvbnN0IG92ZXJyaWRlPShvYmosa2V5LHZhbHVlKT0+e2lmKCFvYmopcmV0dXJuO2lmKG9ialtrZXldKW9ialtrZXldPXZhbHVlfTtjb25zdCBtZXJnZT0ob2JqLGtleSxmbik9Pntjb25zdCB2YWx1ZT1mbigpO2lmKEFycmF5LmlzQXJyYXkodmFsdWUpKXt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPVtdO29ialtrZXldLnB1c2goLi4udmFsdWUpfWVsc2UgaWYodHlwZW9mIHZhbHVlPT09XCJvYmplY3RcIiYmdmFsdWUhPT1udWxsKXt2YXIgX29iajEsX2tleTE7dmFyIF8xOyhfMT0oX29iajE9b2JqKVtfa2V5MT1rZXldKSE9PW51bGwmJl8xIT09dm9pZCAwP18xOl9vYmoxW19rZXkxXT17fTtPYmplY3QuYXNzaWduKG9ialtrZXldLHZhbHVlKX19O2NvbnN0IGVhcmx5PShvYmosa2V5LGluaXRpYWwpPT57dmFyIF9vYmosX2tleTt2YXIgXzsoXz0oX29iaj1vYmopW19rZXk9a2V5XSkhPT1udWxsJiZfIT09dm9pZCAwP186X29ialtfa2V5XT1pbml0aWFsKCl9O3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc7Y29uc3QgcmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLmNodW5rTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nOnt9O3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc7Y29uc3QgcmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExPV9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nOnt9O3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nO2NvbnN0IGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhLnNjb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nOnt9O3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO2NvbnN0IGNvbnN1bWVzTG9hZGluZ0NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nOnt9O3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZztjb25zdCBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTE9X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEubW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZzp7fTtjb25zdCBjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzPXt9O2NvbnN0IGluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzPVtdO2NvbnN0IGluaXRpYWxpemVTaGFyaW5nSW5pdFRva2Vucz17fTtjb25zdCBjb250YWluZXJTaGFyZVNjb3BlPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEuc2hhcmVTY29wZTtmb3IoY29uc3Qga2V5IGluIF9fbW9kdWxlX2ZlZGVyYXRpb25fYnVuZGxlcl9ydW50aW1lX18pe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbltrZXldPV9fbW9kdWxlX2ZlZGVyYXRpb25fYnVuZGxlcl9ydW50aW1lX19ba2V5XX1lYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sXCJjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nXCIsKCk9Pntjb25zdCBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nPXt9O2ZvcihsZXRbbW9kdWxlSWQsZGF0YV1vZiBPYmplY3QuZW50cmllcyhjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZykpe2NvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdbbW9kdWxlSWRdPXtnZXR0ZXI6ZGF0YS5mYWxsYmFjayxzaGFyZUluZm86e3NoYXJlQ29uZmlnOntmaXhlZERlcGVuZGVuY2llczpmYWxzZSxyZXF1aXJlZFZlcnNpb246ZGF0YS5yZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbjpkYXRhLnN0cmljdFZlcnNpb24sc2luZ2xldG9uOmRhdGEuc2luZ2xldG9uLGVhZ2VyOmRhdGEuZWFnZXJ9LHNjb3BlOltkYXRhLnNoYXJlU2NvcGVdfSxzaGFyZUtleTpkYXRhLnNoYXJlS2V5fX1yZXR1cm4gY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcImluaXRPcHRpb25zXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcIm5hbWVcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXCJzaGFyZVN0cmF0ZWd5XCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFwic2hhcmVkXCIsKCk9Pntjb25zdCBzaGFyZWQ9e307Zm9yKGxldFtzY29wZSxzdGFnZXNdb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nKSl7Zm9yKGxldCBzdGFnZSBvZiBzdGFnZXMpe2lmKHR5cGVvZiBzdGFnZT09PVwib2JqZWN0XCImJnN0YWdlIT09bnVsbCl7Y29uc3R7bmFtZSx2ZXJzaW9uLGZhY3RvcnksZWFnZXIsc2luZ2xldG9uLHJlcXVpcmVkVmVyc2lvbixzdHJpY3RWZXJzaW9ufT1zdGFnZTtjb25zdCBzaGFyZUNvbmZpZz17fTtjb25zdCBpc1ZhbGlkVmFsdWU9ZnVuY3Rpb24odmFsKXtyZXR1cm4gdHlwZW9mIHZhbCE9PVwidW5kZWZpbmVkXCJ9O2lmKGlzVmFsaWRWYWx1ZShzaW5nbGV0b24pKXtzaGFyZUNvbmZpZy5zaW5nbGV0b249c2luZ2xldG9ufWlmKGlzVmFsaWRWYWx1ZShyZXF1aXJlZFZlcnNpb24pKXtzaGFyZUNvbmZpZy5yZXF1aXJlZFZlcnNpb249cmVxdWlyZWRWZXJzaW9ufWlmKGlzVmFsaWRWYWx1ZShlYWdlcikpe3NoYXJlQ29uZmlnLmVhZ2VyPWVhZ2VyfWlmKGlzVmFsaWRWYWx1ZShzdHJpY3RWZXJzaW9uKSl7c2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbj1zdHJpY3RWZXJzaW9ufWNvbnN0IG9wdGlvbnM9e3ZlcnNpb24sc2NvcGU6W3Njb3BlXSxzaGFyZUNvbmZpZyxnZXQ6ZmFjdG9yeX07aWYoc2hhcmVkW25hbWVdKXtzaGFyZWRbbmFtZV0ucHVzaChvcHRpb25zKX1lbHNle3NoYXJlZFtuYW1lXT1bb3B0aW9uc119fX19cmV0dXJuIHNoYXJlZH0pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcInJlbW90ZXNcIiwoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKHJlbW90ZT0+cmVtb3RlLmV4dGVybmFsVHlwZT09PVwic2NyaXB0XCIpKTttZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXCJwbHVnaW5zXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcImJ1bmRsZXJSdW50aW1lT3B0aW9uc1wiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLFwicmVtb3Rlc1wiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsXCJjaHVua01hcHBpbmdcIiwoKT0+cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcImlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nXCIsKCk9Pntjb25zdCByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZz17fTtmb3IobGV0W21vZHVsZUlkLGRhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtyZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ1ttb2R1bGVJZF09W2RhdGEuc2hhcmVTY29wZSxkYXRhLm5hbWUsZGF0YS5leHRlcm5hbE1vZHVsZUlkLGRhdGEucmVtb3RlTmFtZV19cmV0dXJuIHJlbW90ZXNMb2FkaW5nSWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFwid2VicGFja1JlcXVpcmVcIiwoKT0+X193ZWJwYWNrX3JlcXVpcmVfXyk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFwiaWRUb1JlbW90ZU1hcFwiLCgpPT57Y29uc3QgaWRUb1JlbW90ZU1hcD17fTtmb3IobGV0W2lkLHJlbW90ZURhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtjb25zdCBpbmZvPV9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX19bcmVtb3RlRGF0YS5yZW1vdGVOYW1lXTtpZihpbmZvKWlkVG9SZW1vdGVNYXBbaWRdPWluZm99cmV0dXJuIGlkVG9SZW1vdGVNYXB9KTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFwiU1wiLF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtpZihfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyl9b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLFwicmVtb3Rlc1wiLChjaHVua0lkLHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLnJlbW90ZXMoe2NodW5rSWQscHJvbWlzZXMsY2h1bmtNYXBwaW5nOnJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nLGlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3Rlcy5pZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZyxpZFRvUmVtb3RlTWFwOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3Rlcy5pZFRvUmVtb3RlTWFwLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLFwiY29uc3VtZXNcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5jb25zdW1lcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6Y29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmcsaW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcIklcIiwobmFtZSxpbml0U2NvcGUpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuSSh7c2hhcmVTY29wZU5hbWU6bmFtZSxpbml0U2NvcGUsaW5pdFByb21pc2VzOmluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzLGluaXRUb2tlbnM6aW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcImluaXRDb250YWluZXJcIiwoc2hhcmVTY29wZSxpbml0U2NvcGUscmVtb3RlRW50cnlJbml0T3B0aW9ucyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbml0Q29udGFpbmVyRW50cnkoe3NoYXJlU2NvcGUsaW5pdFNjb3BlLHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsc2hhcmVTY29wZUtleTpjb250YWluZXJTaGFyZVNjb3BlLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcImdldENvbnRhaW5lclwiLChtb2R1bGUxLGdldFNjb3BlKT0+e3ZhciBtb2R1bGVNYXA9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEubW9kdWxlTWFwO19fd2VicGFja19yZXF1aXJlX18uUj1nZXRTY29wZTtnZXRTY29wZT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kdWxlTWFwLG1vZHVsZTEpP21vZHVsZU1hcFttb2R1bGUxXSgpOlByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCk9Pnt0aHJvdyBuZXcgRXJyb3IoJ01vZHVsZSBcIicrbW9kdWxlMSsnXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5SPXVuZGVmaW5lZDtyZXR1cm4gZ2V0U2NvcGV9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5zdGFuY2U9X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyLmluaXRpYWxDb25zdW1lcyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe3dlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX18saW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLGluaXRpYWxDb25zdW1lczpfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmd9KX19ICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbnZhciBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janNcIik7XG52YXIgX3NsaWNlZF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19zbGljZWRfdG9fYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19jb25zdW1hYmxlX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2NvbnN1bWFibGVfYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqc1wiKTtcbnZhciBfaW5kZXhjanMgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1wiKSk7XG52YXIgX3Jlc29sdmVycGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanNcIikpO1xudmFyIF9jb3JlcGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzXCIpKTtcbnZhciBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luc19fID0gW1xuICAgICgwLCBfcmVzb2x2ZXJwbHVnaW4uZGVmYXVsdCkoKSxcbiAgICAoMCwgX2NvcmVwbHVnaW4uZGVmYXVsdCkoKVxuXTtcbnZhciBfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fID0ge307XG52YXIgX19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fID0gXCJzcG9ydHNcIjtcbnZhciBfX21vZHVsZV9mZWRlcmF0aW9uX3NoYXJlX3N0cmF0ZWd5X18gPSBcImxvYWRlZC1maXJzdFwiO1xuaWYgKChfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YSB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkgJiYgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uKSB7XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLCBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEsIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEsIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEsIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyO1xuICAgIHZhciBvdmVycmlkZSA9IChvYmosIGtleSwgdmFsdWUpPT57XG4gICAgICAgIGlmICghb2JqKSByZXR1cm47XG4gICAgICAgIGlmIChvYmpba2V5XSkgb2JqW2tleV0gPSB2YWx1ZTtcbiAgICB9O1xuICAgIHZhciBtZXJnZSA9IChvYmosIGtleSwgZm4pPT57XG4gICAgICAgIHZhciB2YWx1ZSA9IGZuKCk7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgdmFyIF9vYmpfa2V5O1xuICAgICAgICAgICAgdmFyIF9vYmosIF9rZXk7XG4gICAgICAgICAgICB2YXIgXztcbiAgICAgICAgICAgIChfID0gKF9vYmogPSBvYmopW19rZXkgPSBrZXldKSAhPT0gbnVsbCAmJiBfICE9PSB2b2lkIDAgPyBfIDogX29ialtfa2V5XSA9IFtdO1xuICAgICAgICAgICAgKF9vYmpfa2V5ID0gb2JqW2tleV0pLnB1c2guYXBwbHkoX29ial9rZXksIF90b19jb25zdW1hYmxlX2FycmF5Ll8odmFsdWUpKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBfb2JqMSwgX2tleTE7XG4gICAgICAgICAgICB2YXIgXzE7XG4gICAgICAgICAgICAoXzEgPSAoX29iajEgPSBvYmopW19rZXkxID0ga2V5XSkgIT09IG51bGwgJiYgXzEgIT09IHZvaWQgMCA/IF8xIDogX29iajFbX2tleTFdID0ge307XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKG9ialtrZXldLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBlYXJseSA9IChvYmosIGtleSwgaW5pdGlhbCk9PntcbiAgICAgICAgdmFyIF9vYmosIF9rZXk7XG4gICAgICAgIHZhciBfO1xuICAgICAgICAoXyA9IChfb2JqID0gb2JqKVtfa2V5ID0ga2V5XSkgIT09IG51bGwgJiYgXyAhPT0gdm9pZCAwID8gXyA6IF9vYmpbX2tleV0gPSBpbml0aWFsKCk7XG4gICAgfTtcbiAgICB2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO1xuICAgIHZhciByZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLmNodW5rTWFwcGluZykgIT09IG51bGwgJiYgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmcgOiB7fTtcbiAgICB2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nO1xuICAgIHZhciByZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExID0gX193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykgIT09IG51bGwgJiYgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcgOiB7fTtcbiAgICB2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZztcbiAgICB2YXIgaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhLnNjb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmcgIT09IHZvaWQgMCA/IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmcgOiB7fTtcbiAgICB2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztcbiAgICB2YXIgY29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmcgIT09IHZvaWQgMCA/IF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmcgOiB7fTtcbiAgICB2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc7XG4gICAgdmFyIGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEubW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZykgIT09IG51bGwgJiYgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcgIT09IHZvaWQgMCA/IF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nIDoge307XG4gICAgdmFyIGNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMgPSB7fTtcbiAgICB2YXIgaW5pdGlhbGl6ZVNoYXJpbmdJbml0UHJvbWlzZXMgPSBbXTtcbiAgICB2YXIgaW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zID0ge307XG4gICAgdmFyIGNvbnRhaW5lclNoYXJlU2NvcGUgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLnNoYXJlU2NvcGU7XG4gICAgZm9yKHZhciBrZXkgaW4gX2luZGV4Y2pzLmRlZmF1bHQpe1xuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb25ba2V5XSA9IF9pbmRleGNqcy5kZWZhdWx0W2tleV07XG4gICAgfVxuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbiwgXCJjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nXCIsICgpPT57XG4gICAgICAgIHZhciBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nID0ge307XG4gICAgICAgIGZvciAodmFyIHJlZiBvZiBPYmplY3QuZW50cmllcyhjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZykpe1xuICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgbW9kdWxlSWQgPSBfcmVmWzBdLCBkYXRhID0gX3JlZlsxXTtcbiAgICAgICAgICAgIGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdbbW9kdWxlSWRdID0ge1xuICAgICAgICAgICAgICAgIGdldHRlcjogZGF0YS5mYWxsYmFjayxcbiAgICAgICAgICAgICAgICBzaGFyZUluZm86IHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVDb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpeGVkRGVwZW5kZW5jaWVzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkVmVyc2lvbjogZGF0YS5yZXF1aXJlZFZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpY3RWZXJzaW9uOiBkYXRhLnN0cmljdFZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBzaW5nbGV0b246IGRhdGEuc2luZ2xldG9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWFnZXI6IGRhdGEuZWFnZXJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc2hhcmVTY29wZVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzaGFyZUtleTogZGF0YS5zaGFyZUtleVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZztcbiAgICB9KTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sIFwiaW5pdE9wdGlvbnNcIiwgKCk9Pih7fSkpO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucywgXCJuYW1lXCIsICgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18pO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucywgXCJzaGFyZVN0cmF0ZWd5XCIsICgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX3NoYXJlX3N0cmF0ZWd5X18pO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucywgXCJzaGFyZWRcIiwgKCk9PntcbiAgICAgICAgdmFyIHNoYXJlZCA9IHt9O1xuICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nKSl7XG4gICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDIpLCBzY29wZSA9IF9yZWZbMF0sIHN0YWdlcyA9IF9yZWZbMV07XG4gICAgICAgICAgICBmb3IgKHZhciBzdGFnZSBvZiBzdGFnZXMpe1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhZ2UgPT09IFwib2JqZWN0XCIgJiYgc3RhZ2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBzdGFnZS5uYW1lLCB2ZXJzaW9uID0gc3RhZ2UudmVyc2lvbiwgZmFjdG9yeSA9IHN0YWdlLmZhY3RvcnksIGVhZ2VyID0gc3RhZ2UuZWFnZXIsIHNpbmdsZXRvbiA9IHN0YWdlLnNpbmdsZXRvbiwgcmVxdWlyZWRWZXJzaW9uID0gc3RhZ2UucmVxdWlyZWRWZXJzaW9uLCBzdHJpY3RWZXJzaW9uID0gc3RhZ2Uuc3RyaWN0VmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlQ29uZmlnID0ge307XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc1ZhbGlkVmFsdWUgPSBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsICE9PSBcInVuZGVmaW5lZFwiO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFZhbHVlKHNpbmdsZXRvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnLnNpbmdsZXRvbiA9IHNpbmdsZXRvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFZhbHVlKHJlcXVpcmVkVmVyc2lvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbiA9IHJlcXVpcmVkVmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFZhbHVlKGVhZ2VyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVDb25maWcuZWFnZXIgPSBlYWdlcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFZhbHVlKHN0cmljdFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uID0gc3RyaWN0VmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVDb25maWcsXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXQ6IGZhY3RvcnlcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNoYXJlZFtuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkW25hbWVdLnB1c2gob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWRbbmFtZV0gPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hhcmVkO1xuICAgIH0pO1xuICAgIG1lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucywgXCJyZW1vdGVzXCIsICgpPT5PYmplY3QudmFsdWVzKF9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX18pLmZsYXQoKS5maWx0ZXIoKHJlbW90ZSk9PnJlbW90ZS5leHRlcm5hbFR5cGUgPT09IFwic2NyaXB0XCIpKTtcbiAgICBtZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwicGx1Z2luc1wiLCAoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLCBcImJ1bmRsZXJSdW50aW1lT3B0aW9uc1wiLCAoKT0+KHt9KSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucywgXCJyZW1vdGVzXCIsICgpPT4oe30pKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsIFwiY2h1bmtNYXBwaW5nXCIsICgpPT5yZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLCBcImlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nXCIsICgpPT57XG4gICAgICAgIHZhciByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZyA9IHt9O1xuICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtcbiAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMiksIG1vZHVsZUlkID0gX3JlZlswXSwgZGF0YSA9IF9yZWZbMV07XG4gICAgICAgICAgICByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ1ttb2R1bGVJZF0gPSBbXG4gICAgICAgICAgICAgICAgZGF0YS5zaGFyZVNjb3BlLFxuICAgICAgICAgICAgICAgIGRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICBkYXRhLmV4dGVybmFsTW9kdWxlSWQsXG4gICAgICAgICAgICAgICAgZGF0YS5yZW1vdGVOYW1lXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZztcbiAgICB9KTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsIFwid2VicGFja1JlcXVpcmVcIiwgKCk9Pl9fd2VicGFja19yZXF1aXJlX18pO1xuICAgIG1lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcywgXCJpZFRvUmVtb3RlTWFwXCIsICgpPT57XG4gICAgICAgIHZhciBpZFRvUmVtb3RlTWFwID0ge307XG4gICAgICAgIGZvciAodmFyIHJlZiBvZiBPYmplY3QuZW50cmllcyhyZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykpe1xuICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgaWQgPSBfcmVmWzBdLCByZW1vdGVEYXRhID0gX3JlZlsxXTtcbiAgICAgICAgICAgIHZhciBpbmZvID0gX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfX1tyZW1vdGVEYXRhLnJlbW90ZU5hbWVdO1xuICAgICAgICAgICAgaWYgKGluZm8pIGlkVG9SZW1vdGVNYXBbaWRdID0gaW5mbztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaWRUb1JlbW90ZU1hcDtcbiAgICB9KTtcbiAgICBvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLCBcIlNcIiwgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLlMpO1xuICAgIGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCkge1xuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcChfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbiAgICB9XG4gICAgb3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLCBcInJlbW90ZXNcIiwgKGNodW5rSWQsIHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLnJlbW90ZXMoe1xuICAgICAgICAgICAgY2h1bmtJZCxcbiAgICAgICAgICAgIHByb21pc2VzLFxuICAgICAgICAgICAgY2h1bmtNYXBwaW5nOiByZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyxcbiAgICAgICAgICAgIGlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsXG4gICAgICAgICAgICBpZFRvUmVtb3RlTWFwOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb1JlbW90ZU1hcCxcbiAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlOiBfX3dlYnBhY2tfcmVxdWlyZV9fXG4gICAgICAgIH0pKTtcbiAgICBvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLmYsIFwiY29uc3VtZXNcIiwgKGNodW5rSWQsIHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmNvbnN1bWVzKHtcbiAgICAgICAgICAgIGNodW5rSWQsXG4gICAgICAgICAgICBwcm9taXNlcyxcbiAgICAgICAgICAgIGNodW5rTWFwcGluZzogY29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nLFxuICAgICAgICAgICAgbW9kdWxlVG9IYW5kbGVyTWFwcGluZzogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmcsXG4gICAgICAgICAgICBpbnN0YWxsZWRNb2R1bGVzOiBjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLFxuICAgICAgICAgICAgd2VicGFja1JlcXVpcmU6IF9fd2VicGFja19yZXF1aXJlX19cbiAgICAgICAgfSkpO1xuICAgIG92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sIFwiSVwiLCAobmFtZSwgaW5pdFNjb3BlKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLkkoe1xuICAgICAgICAgICAgc2hhcmVTY29wZU5hbWU6IG5hbWUsXG4gICAgICAgICAgICBpbml0U2NvcGUsXG4gICAgICAgICAgICBpbml0UHJvbWlzZXM6IGluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzLFxuICAgICAgICAgICAgaW5pdFRva2VuczogaW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zLFxuICAgICAgICAgICAgd2VicGFja1JlcXVpcmU6IF9fd2VicGFja19yZXF1aXJlX19cbiAgICAgICAgfSkpO1xuICAgIG92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sIFwiaW5pdENvbnRhaW5lclwiLCAoc2hhcmVTY29wZSwgaW5pdFNjb3BlLCByZW1vdGVFbnRyeUluaXRPcHRpb25zKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluaXRDb250YWluZXJFbnRyeSh7XG4gICAgICAgICAgICBzaGFyZVNjb3BlLFxuICAgICAgICAgICAgaW5pdFNjb3BlLFxuICAgICAgICAgICAgcmVtb3RlRW50cnlJbml0T3B0aW9ucyxcbiAgICAgICAgICAgIHNoYXJlU2NvcGVLZXk6IGNvbnRhaW5lclNoYXJlU2NvcGUsXG4gICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZTogX193ZWJwYWNrX3JlcXVpcmVfX1xuICAgICAgICB9KSk7XG4gICAgb3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXywgXCJnZXRDb250YWluZXJcIiwgKG1vZHVsZTEsIGdldFNjb3BlKT0+e1xuICAgICAgICB2YXIgbW9kdWxlTWFwID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEubW9kdWxlTWFwO1xuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLlIgPSBnZXRTY29wZTtcbiAgICAgICAgZ2V0U2NvcGUgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kdWxlTWFwLCBtb2R1bGUxKSA/IG1vZHVsZU1hcFttb2R1bGUxXSgpIDogUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKT0+e1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNb2R1bGUgXCInICsgbW9kdWxlMSArICdcIiBkb2VzIG5vdCBleGlzdCBpbiBjb250YWluZXIuJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLlIgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiBnZXRTY29wZTtcbiAgICB9KTtcbiAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5zdGFuY2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24ucnVudGltZS5pbml0KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyk7XG4gICAgaWYgKChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyID0gX193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyLmluaXRpYWxDb25zdW1lcykge1xuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5zdGFsbEluaXRpYWxDb25zdW1lcyh7XG4gICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZTogX193ZWJwYWNrX3JlcXVpcmVfXyxcbiAgICAgICAgICAgIGluc3RhbGxlZE1vZHVsZXM6IGNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMsXG4gICAgICAgICAgICBpbml0aWFsQ29uc3VtZXM6IF9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YS5pbml0aWFsQ29uc3VtZXMsXG4gICAgICAgICAgICBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cblxufSksXG5cIndlYnBhY2svY29udGFpbmVyL2VudHJ5L3Nwb3J0c1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIGNvbnRhaW5lciBlbnRyeSAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5kKGV4cG9ydHMsIHtcblx0Z2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZ2V0Q29udGFpbmVyOyB9LFxuXHRpbml0OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uaW5pdENvbnRhaW5lcjsgfVxufSk7XG5cbn0pLFxuXG59KTtcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbi8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxudmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5pZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcbnJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcbn1cbi8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG52YXIgbW9kdWxlID0gKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5pZDogbW9kdWxlSWQsXG5sb2FkZWQ6IGZhbHNlLFxuZXhwb3J0czoge31cbn0pO1xuLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5fX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxubW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxucmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuXG59XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBfX3dlYnBhY2tfbW9kdWxlc19fO1xuXG4vLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuX193ZWJwYWNrX3JlcXVpcmVfXy5jID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fO1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLy8gbW9kdWxlX2ZlZGVyYXRpb24vcnVudGltZVxuIWZ1bmN0aW9uKCkge1xuXG5pZighX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uKXtcbiAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24gPSB7XG4gICAgICAgIFxuY2h1bmtNYXRjaGVyOiBmdW5jdGlvbihjaHVua0lkKSB7XG4gICAgcmV0dXJuICEvXihcXC13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0XFwtXyg2NjBjfDdjMjQpfHdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RcXC1uYXRpdmVfKGFzc2V0c1xcLXJlZ2lzdHJ5XyhwYXRoXFwtc3VwcG9ydF9yZWFjdFxcLW5hdGl2ZV9hc3NldHNcXC0zNWYxNTR8cmVnaXN0cnlfcmVhY3RcXC1uYXRpdmVfYXNzZXRzXFwtcmVnXFwtNWQxZWFlKXxMaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxcXC05NmE2OTZ8bm9ybWFsaXplXFwtY29sb3JzX3JlYWN0XFwtbmF0aXZlX25vcm1hbGl6ZVxcLWNvbG9yc3xyZWFjdFxcLW5hdGl2ZXxzcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcXC1mZDMwOTB8dmlydHVhbGl6ZWRcXC1saXN0c19yZWFjdFxcLW5hdGl2ZV92aXJ0dWFsaXplZFxcLWxpc3RzXFwtZjYxMzc5KSkkLy50ZXN0KGNodW5rSWQpO1xufSxcbnJvb3RPdXRwdXREaXI6IFwiXCIsXG5cbiAgICB9O1xufVxuXG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvZGVmaW5lX3Byb3BlcnR5X2dldHRlcnNcbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuICAgICAgICBpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2Vuc3VyZV9jaHVua1xuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5mID0ge307XG4vLyBUaGlzIGZpbGUgY29udGFpbnMgb25seSB0aGUgZW50cnkgY2h1bmsuXG4vLyBUaGUgY2h1bmsgbG9hZGluZyBmdW5jdGlvbiBmb3IgYWRkaXRpb25hbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uZSA9IGZ1bmN0aW9uKGNodW5rSWQpIHtcblx0cmV0dXJuIFByb21pc2UuYWxsKFxuXHRcdE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uZikucmVkdWNlKGZ1bmN0aW9uKHByb21pc2VzLCBrZXkpIHtcblx0XHRcdF9fd2VicGFja19yZXF1aXJlX18uZltrZXldKGNodW5rSWQsIHByb21pc2VzKTtcblx0XHRcdHJldHVybiBwcm9taXNlcztcblx0XHR9LCBbXSlcblx0KTtcbn07XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvZ2V0IGphdmFzY3JpcHQgY2h1bmsgZmlsZW5hbWVcbiFmdW5jdGlvbigpIHtcbi8vIFRoaXMgZnVuY3Rpb24gYWxsb3cgdG8gcmVmZXJlbmNlIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy51ID0gZnVuY3Rpb24oY2h1bmtJZCkge1xuICAvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgbm90IGJhc2VkIG9uIHRlbXBsYXRlXG4gIFxuICAvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgYmFzZWQgb24gdGVtcGxhdGVcbiAgcmV0dXJuIFwiXCIgKyBjaHVua0lkICsgXCIuY2h1bmsuYnVuZGxlXCJcbn1cbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9nbG9iYWxcbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvaGFzX293bl9wcm9wZXJ0eVxuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfVxufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2xvYWRfc2NyaXB0XG4hZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIGxvYWRTY3JpcHRIYW5kbGVyKG5hbWUsIGNhbGxlciwgZG9uZSwgcmVmZXJlbmNlVXJsKSB7XG4gICAgaWYgKF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyKSB7XG4gICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlci5sb2FkU2NyaXB0KG5hbWUsIGNhbGxlciwgX193ZWJwYWNrX3JlcXVpcmVfXywgcmVmZXJlbmNlVXJsKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZXBhY2tSdW50aW1lXSBMb2FkaW5nIHNjcmlwdCBmYWlsZWQ6JywgcmVhc29uKTtcbiAgICAgICAgZG9uZSh7XG4gICAgICAgICAgdHlwZTogJ2V4ZWMnLFxuICAgICAgICAgIHRhcmdldDoge1xuICAgICAgICAgICAgc3JjOiBuYW1lXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbUmVwYWNrUnVudGltZV0gU2NyaXB0IG1hbmFnZXIgd2FzIG5vdCBwcm92aWRlZCcpO1xuICAgICAgZG9uZSh7XG4gICAgICAgIHR5cGU6ICdleGVjJyxcbiAgICAgICAgdGFyZ2V0OiB7XG4gICAgICAgICAgc3JjOiBuYW1lXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBsb2FkSG90VXBkYXRlSGFuZGxlcih1cmwsIGRvbmUpIHtcbiAgICBpZiAoIWZhbHNlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbUmVwYWNrUnVudGltZV0gTG9hZGluZyBITVIgdXBkYXRlIGNodW5rcyBpcyBkaXNhYmxlZCcpO1xuICAgICAgZG9uZSh7XG4gICAgICAgIHR5cGU6ICdkaXNhYmxlZCcsXG4gICAgICAgIHRhcmdldDoge1xuICAgICAgICAgIHNyYzogdXJsXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmZXRjaCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZXBhY2tSdW50aW1lXSBMb2FkaW5nIEhNUiB1cGRhdGUgZmFpbGVkOicsIHJlc3BvbnNlLnN0YXR1c1RleHQpO1xuICAgICAgICBkb25lKHtcbiAgICAgICAgICB0eXBlOiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICAgIHRhcmdldDoge1xuICAgICAgICAgICAgc3JjOiB1cmxcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpO1xuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHNjcmlwdCkge1xuICAgICAgaWYgKHNjcmlwdCkge1xuICAgICAgICBpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIpIHtcbiAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlci51bnN0YWJsZV9ldmFsdWF0ZVNjcmlwdChzY3JpcHQsIHVybCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZXZhbChzY3JpcHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgY29uc29sZS5lcnJvcignW1JlcGFja1J1bnRpbWVdIExvYWRpbmcgSE1SIHVwZGF0ZSBjaHVuayBmYWlsZWQ6JywgcmVhc29uKTtcbiAgICAgIGRvbmUoe1xuICAgICAgICB0eXBlOiAnZXhlYycsXG4gICAgICAgIHRhcmdldDoge1xuICAgICAgICAgIHNyYzogdXJsXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIF9fd2VicGFja19yZXF1aXJlX18ubCA9IGZ1bmN0aW9uIGxvYWRTY3JpcHQodXJsLCBkb25lLCBrZXksIGNodW5rSWQpIHtcbiAgICBpZiAoa2V5ICYmIGNodW5rSWQpIHtcbiAgICAgIGxvYWRTY3JpcHRIYW5kbGVyKGNodW5rSWQsICdzcG9ydHMnLCBkb25lLCB1cmwpO1xuICAgIH0gZWxzZSBpZiAoa2V5KSB7XG4gICAgICBsb2FkU2NyaXB0SGFuZGxlcihrZXksIHVuZGVmaW5lZCwgZG9uZSwgdXJsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9hZEhvdFVwZGF0ZUhhbmRsZXIodXJsLCBkb25lKTtcbiAgICB9XG4gIH07XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvbm9kZV9tb2R1bGVfZGVjb3JhdG9yXG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLm5tZCA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuICBtb2R1bGUucGF0aHMgPSBbXTtcbiAgaWYgKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xuICByZXR1cm4gbW9kdWxlO1xufTtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9wdWJsaWNfcGF0aFxuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJub29wOi8vL1wiO1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL3JlcGFjay9ndWFyZGVkIHJlcXVpcmVcbiFmdW5jdGlvbigpIHtcbiAgdmFyIGluR3VhcmQgPSBmYWxzZTtcbiAgdmFyIG9yaWdpbmFsV2VicGFja1JlcXVpcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fO1xuICBmdW5jdGlvbiBndWFyZGVkV2VicGFja1JlcXVpcmUobW9kdWxlSWQpIHtcbiAgICBpZiAoIWluR3VhcmQgJiYgc2VsZi5FcnJvclV0aWxzKSB7XG4gICAgICBpbkd1YXJkID0gdHJ1ZTtcbiAgICAgIGxldCBleHBvcnRzO1xuICAgICAgdHJ5IHtcbiAgICAgICAgZXhwb3J0cyA9IG9yaWdpbmFsV2VicGFja1JlcXVpcmUobW9kdWxlSWQpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBzZWxmLkVycm9yVXRpbHMucmVwb3J0RmF0YWxFcnJvcihlKTtcbiAgICAgIH1cbiAgICAgIGluR3VhcmQgPSBmYWxzZTtcbiAgICAgIHJldHVybiBleHBvcnRzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gb3JpZ2luYWxXZWJwYWNrUmVxdWlyZShtb2R1bGVJZCk7XG4gICAgfVxuICB9XG4gIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9yaWdpbmFsV2VicGFja1JlcXVpcmUpLmZvckVhY2goa2V5ID0+IHtcbiAgICBndWFyZGVkV2VicGFja1JlcXVpcmVba2V5XSA9IG9yaWdpbmFsV2VicGFja1JlcXVpcmVba2V5XTtcbiAgfSk7XG4gIF9fd2VicGFja19yZXF1aXJlX18gPSBndWFyZGVkV2VicGFja1JlcXVpcmU7XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvcmVwYWNrL2luaXRcbiFmdW5jdGlvbigpIHtcbiAgdmFyIHJlcGFja1J1bnRpbWUgPSB7XG4gICAgc2hhcmVkOiBzZWxmLl9fcmVwYWNrX18gJiYgc2VsZi5fX3JlcGFja19fLnNoYXJlZCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjayAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQgfHwge1xuICAgICAgc2NyaXB0TWFuYWdlcjogdW5kZWZpbmVkXG4gICAgfVxuICB9O1xuICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjayA9IHNlbGYuX19yZXBhY2tfXyA9IHJlcGFja1J1bnRpbWU7XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvcnNwYWNrX3ZlcnNpb25cbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18ucnYgPSBmdW5jdGlvbigpIHsgcmV0dXJuIFwiMS4zLjE1XCI7IH1cbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9zaGFyaW5nXG4hZnVuY3Rpb24oKSB7XG5cbl9fd2VicGFja19yZXF1aXJlX18uUyA9IHt9O1xuX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEgPSB7IHNjb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc6IHsgXCJkZWZhdWx0XCI6IFt7IG5hbWU6IFwiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9yc1wiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHNcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzY2MGNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3JlYWN0LW5hdGl2ZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLWZkMzA5MFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fZ2V0X2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfLWRkMjU3ZVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzL2luZGV4LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUxXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5LmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzdjMjRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2NsYXNzX3ByaXZhdGVfZmllbGRfbG9vc2VfYmFzZV9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqcy0zMTIyN2JcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGFcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlLmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV83YzI0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fNjYwY1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlXCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX2NhbGxzdGFja19yZXBhY2tfZGlzdF9tb2R1bGVzX0VtcHR5TW9kdWxlX2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9FbXB0eU1vZHVsZS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9FbXB0eU1vZHVsZS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV83YzI0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fNjYwY1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanNcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yLmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvci5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTZcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkX2Nqcy1ub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanNcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV83YzI0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fNjYwY1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzLWY2MTM3OVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEgfSwgeyBuYW1lOiBcInJlYWN0XCIsIHZlcnNpb246IFwiMTkuMC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEgfV0gfSwgdW5pcXVlTmFtZTogXCJzcG9ydHNcIiB9O1xuX193ZWJwYWNrX3JlcXVpcmVfXy5JID0gX193ZWJwYWNrX3JlcXVpcmVfXy5JIHx8IGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJzaG91bGQgaGF2ZSBfX3dlYnBhY2tfcmVxdWlyZV9fLklcIikgfVxuXG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvY29uc3VtZXNfbG9hZGluZ1xuIWZ1bmN0aW9uKCkge1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEgPSB7IGNodW5rTWFwcGluZzoge1wic3BvcnRzXCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlPzFhZmVcIl0sXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMvQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzXCJdLFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzdjMjRcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0PzdjMjRcIl0sXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeS9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeVwiXSxcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV82NjBjXCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD82NjBjXCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZVwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZVwiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3JlYWN0LW5hdGl2ZVwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT81YThhXCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLWZkMzA5MFwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydFwiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5XCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0c1wiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5XCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnlcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvci9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yXCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5XCJdLFwiX19mZWRlcmF0aW9uX2V4cG9zZV9BcHBcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0PzI1YWNcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT9jZjViXCJdfSwgbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZzogeyBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvclwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvclwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvciAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3IuanNcIik7IH07IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MThcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZS5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0PzdjMjRcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3RcIiwgaW1wb3J0OiBcInJlYWN0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCJeMTkuMC4wXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5XCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeS5qc1wiKTsgfTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnlcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUwXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeS5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/Y2Y1YlwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmVcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZVwiLCByZXF1aXJlZFZlcnNpb246IFwiMC43OC4wXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fN2MyNFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzLWY2MTM3OVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnRcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0XCIsIGltcG9ydDogXCJAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnRcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0ICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9yc1wiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnNcIiwgaW1wb3J0OiBcIkByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9yc1wiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIEByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycyAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0PzY2MGNcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3RcIiwgaW1wb3J0OiBcInJlYWN0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5XCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheS5qc1wiKTsgfTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT81YThhXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fN2MyNFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzLWY2MTM3OVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/MWFmZVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmVcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZVwiLCByZXF1aXJlZFZlcnNpb246IFwiPj0wLjc0XCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MThcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzdjMjRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV82NjBjXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X3JlYWN0LW5hdGl2ZV9hc3NldHMtMzVmMTU0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWwtOTZhNjk2XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHMtZjYxMzc5XCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL2luZGV4LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0cy9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcIkByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHNcIiwgaW1wb3J0OiBcIkByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHNcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9yZWFjdC1uYXRpdmVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy1mZDMwOTBcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0cy9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlLmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHlcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5ICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5LmpzXCIpOyB9OyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD8yNWFjXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0XCIsIGltcG9ydDogXCJyZWFjdFwiLCByZXF1aXJlZFZlcnNpb246IFwiMTkuMC4wXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZS5qc1wiKTsgfTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnlcIiwgaW1wb3J0OiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeS5qc1wiKTsgfTsgfSk7IH0gfSB9LCBpbml0aWFsQ29uc3VtZXM6IFtcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT8xYWZlXCJdIH07XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmYuY29uc3VtZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmYuY29uc3VtZXMgfHwgZnVuY3Rpb24oKSB7IHRocm93IG5ldyBFcnJvcihcInNob3VsZCBoYXZlIF9fd2VicGFja19yZXF1aXJlX18uZi5jb25zdW1lc1wiKSB9XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvaW5pdGlhbGl6ZV9leHBvc2VzXG4hZnVuY3Rpb24oKSB7XG5cbl9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhID0ge1xuICBtb2R1bGVNYXA6IHtcbiAgXCIuL0FwcFwiOiBmdW5jdGlvbigpIHtcbnJldHVybiBQcm9taXNlLmFsbCgvKiEgIHwgX19mZWRlcmF0aW9uX2V4cG9zZV9BcHAgKi8gW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19zaG9waWZ5X3JlYWN0LW5hdGl2ZS1wZXJmb3JtYW5jZV9kaXN0X2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fNjYwY1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfcmVhY3QtbmF0aXZlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJfX2ZlZGVyYXRpb25fZXhwb3NlX0FwcFwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vQXBwLmpzICovIFwiLi9BcHAuanNcIik7IH07IH0pO1xufSxcbn0sXG4gIHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLFxufTtcbl9fd2VicGFja19yZXF1aXJlX18uZ2V0Q29udGFpbmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nZXRDb250YWluZXIgfHwgZnVuY3Rpb24oKSB7IHRocm93IG5ldyBFcnJvcihcInNob3VsZCBoYXZlIF9fd2VicGFja19yZXF1aXJlX18uZ2V0Q29udGFpbmVyXCIpIH07X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0Q29udGFpbmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0Q29udGFpbmVyIHx8IGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJzaG91bGQgaGF2ZSBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRDb250YWluZXJcIikgfTtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9qc29ucF9jaHVua19sb2FkaW5nXG4hZnVuY3Rpb24oKSB7XG5cbiAgICAgIC8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4gICAgICAvLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbiAgICAgIC8vIFtyZXNvbHZlLCByZWplY3QsIFByb21pc2VdID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxuICAgICAgdmFyIGluc3RhbGxlZENodW5rcyA9IHtcInNwb3J0c1wiOiAwLH07XG4gICAgICBcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mLmogPSBmdW5jdGlvbiAoY2h1bmtJZCwgcHJvbWlzZXMpIHtcbiAgICAgICAgICAvLyBKU09OUCBjaHVuayBsb2FkaW5nIGZvciBqYXZhc2NyaXB0XG52YXIgaW5zdGFsbGVkQ2h1bmtEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZClcblx0PyBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1cblx0OiB1bmRlZmluZWQ7XG5pZiAoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSB7XG5cdC8vIDAgbWVhbnMgXCJhbHJlYWR5IGluc3RhbGxlZFwiLlxuXG5cdC8vIGEgUHJvbWlzZSBtZWFucyBcImN1cnJlbnRseSBsb2FkaW5nXCIuXG5cdGlmIChpbnN0YWxsZWRDaHVua0RhdGEpIHtcblx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSk7XG5cdH0gZWxzZSB7XG5cdFx0aWYgKCEvXihcXC13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0XFwtXyg2NjBjfDdjMjQpfHdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RcXC1uYXRpdmVfKGFzc2V0c1xcLXJlZ2lzdHJ5XyhwYXRoXFwtc3VwcG9ydF9yZWFjdFxcLW5hdGl2ZV9hc3NldHNcXC0zNWYxNTR8cmVnaXN0cnlfcmVhY3RcXC1uYXRpdmVfYXNzZXRzXFwtcmVnXFwtNWQxZWFlKXxMaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxcXC05NmE2OTZ8bm9ybWFsaXplXFwtY29sb3JzX3JlYWN0XFwtbmF0aXZlX25vcm1hbGl6ZVxcLWNvbG9yc3xyZWFjdFxcLW5hdGl2ZXxzcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcXC1mZDMwOTB8dmlydHVhbGl6ZWRcXC1saXN0c19yZWFjdFxcLW5hdGl2ZV92aXJ0dWFsaXplZFxcLWxpc3RzXFwtZjYxMzc5KSkkLy50ZXN0KGNodW5rSWQpKSB7XG5cdFx0XHQvLyBzZXR1cCBQcm9taXNlIGluIGNodW5rIGNhY2hlXG5cdFx0XHR2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgeyBpbnN0YWxsZWRDaHVua0RhdGEgPSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSBbcmVzb2x2ZSwgcmVqZWN0XTsgfSk7XG5cdFx0XHRwcm9taXNlcy5wdXNoKChpbnN0YWxsZWRDaHVua0RhdGFbMl0gPSBwcm9taXNlKSk7XG5cblx0XHRcdC8vIHN0YXJ0IGNodW5rIGxvYWRpbmdcblx0XHRcdHZhciB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCk7XG5cdFx0XHQvLyBjcmVhdGUgZXJyb3IgYmVmb3JlIHN0YWNrIHVud291bmQgdG8gZ2V0IHVzZWZ1bCBzdGFja3RyYWNlIGxhdGVyXG5cdFx0XHR2YXIgZXJyb3IgPSBuZXcgRXJyb3IoKTtcblx0XHRcdHZhciBsb2FkaW5nRW5kZWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpKSB7XG5cdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdO1xuXHRcdFx0XHRcdGlmIChpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRpZiAoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdFx0XHR2YXIgZXJyb3JUeXBlID1cblx0XHRcdFx0XHRcdFx0ZXZlbnQgJiYgKGV2ZW50LnR5cGUgPT09ICdsb2FkJyA/ICdtaXNzaW5nJyA6IGV2ZW50LnR5cGUpO1xuXHRcdFx0XHRcdFx0dmFyIHJlYWxTcmMgPSBldmVudCAmJiBldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LnNyYztcblx0XHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UgPVxuXHRcdFx0XHRcdFx0XHQnTG9hZGluZyBjaHVuayAnICtcblx0XHRcdFx0XHRcdFx0Y2h1bmtJZCArXG5cdFx0XHRcdFx0XHRcdCcgZmFpbGVkLlxcbignICtcblx0XHRcdFx0XHRcdFx0ZXJyb3JUeXBlICtcblx0XHRcdFx0XHRcdFx0JzogJyArXG5cdFx0XHRcdFx0XHRcdHJlYWxTcmMgK1xuXHRcdFx0XHRcdFx0XHQnKSc7XG5cdFx0XHRcdFx0XHRlcnJvci5uYW1lID0gJ0NodW5rTG9hZEVycm9yJztcblx0XHRcdFx0XHRcdGVycm9yLnR5cGUgPSBlcnJvclR5cGU7XG5cdFx0XHRcdFx0XHRlcnJvci5yZXF1ZXN0ID0gcmVhbFNyYztcblx0XHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YVsxXShlcnJvcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5sKHVybCwgbG9hZGluZ0VuZGVkLCBcImNodW5rLVwiICsgY2h1bmtJZCwgY2h1bmtJZCk7XG5cdFx0fSBlbHNlIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG5cblx0fVxufVxuXG4gICAgICAgIH1cbiAgICAgICAgLy8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG52YXIgd2VicGFja0pzb25wQ2FsbGJhY2sgPSBmdW5jdGlvbihwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiwgZGF0YSkge1xuXHR2YXIgY2h1bmtJZHMgPSBkYXRhWzBdO1xudmFyIG1vcmVNb2R1bGVzID0gZGF0YVsxXTtcbnZhciBydW50aW1lID0gZGF0YVsyXTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRpZiAoY2h1bmtJZHMuc29tZShmdW5jdGlvbihpZCkgeyByZXR1cm4gaW5zdGFsbGVkQ2h1bmtzW2lkXSAhPT0gMDsgfSkpIHtcblx0XHRmb3IgKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG5cdFx0XHRpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcblx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHJ1bnRpbWUpIHZhciByZXN1bHQgPSBydW50aW1lKF9fd2VicGFja19yZXF1aXJlX18pO1xuXHR9XG5cdGlmIChwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbikgcGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24oZGF0YSk7XG5cdGZvciAoOyBpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG5cdFx0aWYgKFxuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiZcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVxuXHRcdCkge1xuXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKCk7XG5cdFx0fVxuXHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG5cdH1cblx0XG59O1xuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua3Nwb3J0c1wiXSA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmtzcG9ydHNcIl0gfHwgW107XG5jaHVua0xvYWRpbmdHbG9iYWwuZm9yRWFjaCh3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIDApKTtcbmNodW5rTG9hZGluZ0dsb2JhbC5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCkpO1xuXG59KCk7XG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLy8gbW9kdWxlIGNhY2hlIGFyZSB1c2VkIHNvIGVudHJ5IGlubGluaW5nIGlzIGRpc2FibGVkXG4vLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18oXCJAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9yc3BhY2suanMhPSFkYXRhOnRleHQvamF2YXNjcmlwdCxpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyBmcm9tIFxcXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9zcG9ydHMvbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3Nwb3J0cy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzXFxcIjtpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18gZnJvbSBcXFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvc3BvcnRzL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qc1xcXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyA9IFtfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXygpLCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzFfXygpXTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fID0ge307Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fID0gXFxcInNwb3J0c1xcXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fID0gXFxcImxvYWRlZC1maXJzdFxcXCI7aWYoKF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhfHxfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkmJl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbil7dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyO2NvbnN0IG92ZXJyaWRlPShvYmosa2V5LHZhbHVlKT0+e2lmKCFvYmopcmV0dXJuO2lmKG9ialtrZXldKW9ialtrZXldPXZhbHVlfTtjb25zdCBtZXJnZT0ob2JqLGtleSxmbik9Pntjb25zdCB2YWx1ZT1mbigpO2lmKEFycmF5LmlzQXJyYXkodmFsdWUpKXt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPVtdO29ialtrZXldLnB1c2goLi4udmFsdWUpfWVsc2UgaWYodHlwZW9mIHZhbHVlPT09XFxcIm9iamVjdFxcXCImJnZhbHVlIT09bnVsbCl7dmFyIF9vYmoxLF9rZXkxO3ZhciBfMTsoXzE9KF9vYmoxPW9iailbX2tleTE9a2V5XSkhPT1udWxsJiZfMSE9PXZvaWQgMD9fMTpfb2JqMVtfa2V5MV09e307T2JqZWN0LmFzc2lnbihvYmpba2V5XSx2YWx1ZSl9fTtjb25zdCBlYXJseT0ob2JqLGtleSxpbml0aWFsKT0+e3ZhciBfb2JqLF9rZXk7dmFyIF87KF89KF9vYmo9b2JqKVtfa2V5PWtleV0pIT09bnVsbCYmXyE9PXZvaWQgMD9fOl9vYmpbX2tleV09aW5pdGlhbCgpfTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZztjb25zdCBpbml0aWFsaXplU2hhcmluZ1Njb3BlVG9Jbml0RGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCBjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc6e307Y29uc3QgY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcz17fTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcz1bXTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRUb2tlbnM9e307Y29uc3QgY29udGFpbmVyU2hhcmVTY29wZT0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLnNoYXJlU2NvcGU7Zm9yKGNvbnN0IGtleSBpbiBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fKXtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb25ba2V5XT1fX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fW2tleV19ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nXFxcIiwoKT0+e2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nKSl7Y29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1ttb2R1bGVJZF09e2dldHRlcjpkYXRhLmZhbGxiYWNrLHNoYXJlSW5mbzp7c2hhcmVDb25maWc6e2ZpeGVkRGVwZW5kZW5jaWVzOmZhbHNlLHJlcXVpcmVkVmVyc2lvbjpkYXRhLnJlcXVpcmVkVmVyc2lvbixzdHJpY3RWZXJzaW9uOmRhdGEuc3RyaWN0VmVyc2lvbixzaW5nbGV0b246ZGF0YS5zaW5nbGV0b24sZWFnZXI6ZGF0YS5lYWdlcn0sc2NvcGU6W2RhdGEuc2hhcmVTY29wZV19LHNoYXJlS2V5OmRhdGEuc2hhcmVLZXl9fXJldHVybiBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJpbml0T3B0aW9uc1xcXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwibmFtZVxcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJzaGFyZVN0cmF0ZWd5XFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXFxcInNoYXJlZFxcXCIsKCk9Pntjb25zdCBzaGFyZWQ9e307Zm9yKGxldFtzY29wZSxzdGFnZXNdb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nKSl7Zm9yKGxldCBzdGFnZSBvZiBzdGFnZXMpe2lmKHR5cGVvZiBzdGFnZT09PVxcXCJvYmplY3RcXFwiJiZzdGFnZSE9PW51bGwpe2NvbnN0e25hbWUsdmVyc2lvbixmYWN0b3J5LGVhZ2VyLHNpbmdsZXRvbixyZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbn09c3RhZ2U7Y29uc3Qgc2hhcmVDb25maWc9e307Y29uc3QgaXNWYWxpZFZhbHVlPWZ1bmN0aW9uKHZhbCl7cmV0dXJuIHR5cGVvZiB2YWwhPT1cXFwidW5kZWZpbmVkXFxcIn07aWYoaXNWYWxpZFZhbHVlKHNpbmdsZXRvbikpe3NoYXJlQ29uZmlnLnNpbmdsZXRvbj1zaW5nbGV0b259aWYoaXNWYWxpZFZhbHVlKHJlcXVpcmVkVmVyc2lvbikpe3NoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbj1yZXF1aXJlZFZlcnNpb259aWYoaXNWYWxpZFZhbHVlKGVhZ2VyKSl7c2hhcmVDb25maWcuZWFnZXI9ZWFnZXJ9aWYoaXNWYWxpZFZhbHVlKHN0cmljdFZlcnNpb24pKXtzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uPXN0cmljdFZlcnNpb259Y29uc3Qgb3B0aW9ucz17dmVyc2lvbixzY29wZTpbc2NvcGVdLHNoYXJlQ29uZmlnLGdldDpmYWN0b3J5fTtpZihzaGFyZWRbbmFtZV0pe3NoYXJlZFtuYW1lXS5wdXNoKG9wdGlvbnMpfWVsc2V7c2hhcmVkW25hbWVdPVtvcHRpb25zXX19fX1yZXR1cm4gc2hhcmVkfSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKHJlbW90ZT0+cmVtb3RlLmV4dGVybmFsVHlwZT09PVxcXCJzY3JpcHRcXFwiKSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJwbHVnaW5zXFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJidW5kbGVyUnVudGltZU9wdGlvbnNcXFwiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJjaHVua01hcHBpbmdcXFwiLCgpPT5yZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1xcXCIsKCk9Pntjb25zdCByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZz17fTtmb3IobGV0W21vZHVsZUlkLGRhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtyZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ1ttb2R1bGVJZF09W2RhdGEuc2hhcmVTY29wZSxkYXRhLm5hbWUsZGF0YS5leHRlcm5hbE1vZHVsZUlkLGRhdGEucmVtb3RlTmFtZV19cmV0dXJuIHJlbW90ZXNMb2FkaW5nSWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJ3ZWJwYWNrUmVxdWlyZVxcXCIsKCk9Pl9fd2VicGFja19yZXF1aXJlX18pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiaWRUb1JlbW90ZU1hcFxcXCIsKCk9Pntjb25zdCBpZFRvUmVtb3RlTWFwPXt9O2ZvcihsZXRbaWQscmVtb3RlRGF0YV1vZiBPYmplY3QuZW50cmllcyhyZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykpe2NvbnN0IGluZm89X19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfX1tyZW1vdGVEYXRhLnJlbW90ZU5hbWVdO2lmKGluZm8paWRUb1JlbW90ZU1hcFtpZF09aW5mb31yZXR1cm4gaWRUb1JlbW90ZU1hcH0pO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcIlNcXFwiLF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtpZihfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyl9b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLFxcXCJyZW1vdGVzXFxcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpyZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyxpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsaWRUb1JlbW90ZU1hcDpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb1JlbW90ZU1hcCx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcXFwiY29uc3VtZXNcXFwiLChjaHVua0lkLHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmNvbnN1bWVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmcsbW9kdWxlVG9IYW5kbGVyTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZyxpbnN0YWxsZWRNb2R1bGVzOmNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJJXFxcIiwobmFtZSxpbml0U2NvcGUpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuSSh7c2hhcmVTY29wZU5hbWU6bmFtZSxpbml0U2NvcGUsaW5pdFByb21pc2VzOmluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzLGluaXRUb2tlbnM6aW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcXFwiaW5pdENvbnRhaW5lclxcXCIsKHNoYXJlU2NvcGUsaW5pdFNjb3BlLHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5pdENvbnRhaW5lckVudHJ5KHtzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zLHNoYXJlU2NvcGVLZXk6Y29udGFpbmVyU2hhcmVTY29wZSx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcImdldENvbnRhaW5lclxcXCIsKG1vZHVsZTEsZ2V0U2NvcGUpPT57dmFyIG1vZHVsZU1hcD1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YS5tb2R1bGVNYXA7X193ZWJwYWNrX3JlcXVpcmVfXy5SPWdldFNjb3BlO2dldFNjb3BlPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2R1bGVNYXAsbW9kdWxlMSk/bW9kdWxlTWFwW21vZHVsZTFdKCk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKT0+e3Rocm93IG5ldyBFcnJvcignTW9kdWxlIFxcXCInK21vZHVsZTErJ1xcXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5SPXVuZGVmaW5lZDtyZXR1cm4gZ2V0U2NvcGV9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5zdGFuY2U9X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyLmluaXRpYWxDb25zdW1lcyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe3dlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX18saW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLGluaXRpYWxDb25zdW1lczpfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmd9KX19XCIpO1xudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFwid2VicGFjay9jb250YWluZXIvZW50cnkvc3BvcnRzXCIpO1xuc3BvcnRzID0gX193ZWJwYWNrX2V4cG9ydHNfXztcbn0pKClcbjsvLyMgc291cmNlTWFwcGluZ1VSTD1zcG9ydHMuY29udGFpbmVyLmJ1bmRsZS5tYXA/cGxhdGZvcm09YW5kcm9pZCIsInJlc3BvbnNlVGltZSI6NTA2NiwiaXNIdG1sIjpmYWxzZX0sImVycm9yIjpudWxsLCJzdGF0dXMiOiJwYXNzIiwiYXNzZXJ0aW9uUmVzdWx0cyI6W10sInRlc3RSZXN1bHRzIjpbXSwicHJlUmVxdWVzdFRlc3RSZXN1bHRzIjpbXSwicG9zdFJlc3BvbnNlVGVzdFJlc3VsdHMiOltdLCJzaG91bGRTdG9wUnVubmVyRXhlY3V0aW9uIjpmYWxzZSwicnVuRHVyYXRpb24iOjYuMDczOTMxOTg1LCJuYW1lIjoiL3Nwb3J0cy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L3Nwb3J0cy5jb250YWluZXIuYnVuZGxlIiwicGF0aCI6InNwb3J0cy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LXNwb3J0cy5jb250YWluZXIuYnVuZGxlIiwiaXRlcmF0aW9uSW5kZXgiOjB9LHsidGVzdCI6eyJmaWxlbmFtZSI6InRyYXZlbHMtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC1tZi1tYW5pZmVzdC5qc29uLmJydSJ9LCJyZXF1ZXN0Ijp7Im1ldGhvZCI6IkdFVCIsInVybCI6Imh0dHBzOi8vcmVhY3QtbmF0aXZlLWFydGlmYWN0cy5uZXRsaWZ5LmFwcC9hcnRpZmFjdHMvdHJhdmVscy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L21mLW1hbmlmZXN0Lmpzb24iLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJDbGllbnQgbmV0d29yayBzb2NrZXQgZGlzY29ubmVjdGVkIGJlZm9yZSBzZWN1cmUgVExTIGNvbm5lY3Rpb24gd2FzIGVzdGFibGlzaGVkIiwic3RhdHVzIjoiZXJyb3IiLCJhc3NlcnRpb25SZXN1bHRzIjpbXSwidGVzdFJlc3VsdHMiOltdLCJwcmVSZXF1ZXN0VGVzdFJlc3VsdHMiOltdLCJwb3N0UmVzcG9uc2VUZXN0UmVzdWx0cyI6W10sInNob3VsZFN0b3BSdW5uZXJFeGVjdXRpb24iOmZhbHNlLCJydW5EdXJhdGlvbiI6Ni45NTMzODQ0NSwibmFtZSI6Ii90cmF2ZWxzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvbWYtbWFuaWZlc3QuanNvbiIsInBhdGgiOiJ0cmF2ZWxzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbWYtbWFuaWZlc3QuanNvbiIsIml0ZXJhdGlvbkluZGV4IjowfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJ0cmF2ZWxzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtdHJhdmVscy5jb250YWluZXIuYnVuZGxlLmJydSJ9LCJyZXF1ZXN0Ijp7Im1ldGhvZCI6IkdFVCIsInVybCI6Imh0dHBzOi8vcmVhY3QtbmF0aXZlLWFydGlmYWN0cy5uZXRsaWZ5LmFwcC9hcnRpZmFjdHMvdHJhdmVscy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L3RyYXZlbHMuY29udGFpbmVyLmJ1bmRsZSIsImhlYWRlcnMiOnsiVXNlci1BZ2VudCI6Imluc29tbmlhLzExLjIuMCJ9LCJpc0h0bWwiOmZhbHNlfSwicmVzcG9uc2UiOnsic3RhdHVzIjoiZXJyb3IiLCJzdGF0dXNUZXh0IjpudWxsLCJoZWFkZXJzIjpudWxsLCJkYXRhIjpudWxsLCJyZXNwb25zZVRpbWUiOjAsImlzSHRtbCI6ZmFsc2V9LCJlcnJvciI6InNvY2tldCBoYW5nIHVwIiwic3RhdHVzIjoiZXJyb3IiLCJhc3NlcnRpb25SZXN1bHRzIjpbXSwidGVzdFJlc3VsdHMiOltdLCJwcmVSZXF1ZXN0VGVzdFJlc3VsdHMiOltdLCJwb3N0UmVzcG9uc2VUZXN0UmVzdWx0cyI6W10sInNob3VsZFN0b3BSdW5uZXJFeGVjdXRpb24iOmZhbHNlLCJydW5EdXJhdGlvbiI6MTEuMzE1Njk2ODU3LCJuYW1lIjoiL3RyYXZlbHMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC90cmF2ZWxzLmNvbnRhaW5lci5idW5kbGUiLCJwYXRoIjoidHJhdmVscy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LXRyYXZlbHMuY29udGFpbmVyLmJ1bmRsZSIsIml0ZXJhdGlvbkluZGV4IjowfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJtb3ZpZXMuanBlZy5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvbW92aWVzLmpwZWciLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6MjAwLCJzdGF0dXNUZXh0IjoiT0siLCJoZWFkZXJzIjp7ImFjY2VwdC1yYW5nZXMiOiJieXRlcyIsImFnZSI6IjAiLCJjYWNoZS1jb250cm9sIjoicHVibGljLG1heC1hZ2U9MCxtdXN0LXJldmFsaWRhdGUiLCJjYWNoZS1zdGF0dXMiOiJcIk5ldGxpZnkgRWRnZVwiOyBmd2Q9bWlzcyIsImNvbnRlbnQtbGVuZ3RoIjoiMTMzMTA0IiwiY29udGVudC10eXBlIjoiaW1hZ2UvanBlZyIsImRhdGUiOiJUaHUsIDE3IEp1bCAyMDI1IDE2OjE2OjE3IEdNVCIsImV0YWciOiJcImUyYmZhYTFhMmE2ZmUxZjVjYjliYzZhZTU3NTNiODFmLXNzbFwiIiwic2VydmVyIjoiTmV0bGlmeSIsInN0cmljdC10cmFuc3BvcnQtc2VjdXJpdHkiOiJtYXgtYWdlPTMxNTM2MDAwOyBpbmNsdWRlU3ViRG9tYWluczsgcHJlbG9hZCIsIngtbmYtcmVxdWVzdC1pZCI6IjAxSzBDSlI2VkM1UkZDTldaUTROQjVUNTBTIiwiY29ubmVjdGlvbiI6ImNsb3NlIn0sImRhdGEiOiJSZXNwb25zZSBjb250ZW50IHJlZGFjdGVkIChpbWFnZSBkYXRhKSIsInJlc3BvbnNlVGltZSI6MjM2NywiaXNIdG1sIjpmYWxzZX0sImVycm9yIjpudWxsLCJzdGF0dXMiOiJwYXNzIiwiYXNzZXJ0aW9uUmVzdWx0cyI6W10sInRlc3RSZXN1bHRzIjpbXSwicHJlUmVxdWVzdFRlc3RSZXN1bHRzIjpbXSwicG9zdFJlc3BvbnNlVGVzdFJlc3VsdHMiOltdLCJzaG91bGRTdG9wUnVubmVyRXhlY3V0aW9uIjpmYWxzZSwicnVuRHVyYXRpb24iOjMuMzcyMzIzNTg5LCJuYW1lIjoibW92aWVzLmpwZWciLCJwYXRoIjoibW92aWVzLmpwZWciLCJpdGVyYXRpb25JbmRleCI6MH0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoibXVzaWNzLmpwZWcuYnJ1In0sInJlcXVlc3QiOnsibWV0aG9kIjoiR0VUIiwidXJsIjoiaHR0cHM6Ly9yZWFjdC1uYXRpdmUtYXJ0aWZhY3RzLm5ldGxpZnkuYXBwL211c2ljcy5qcGVnIiwiaGVhZGVycyI6eyJVc2VyLUFnZW50IjoiaW5zb21uaWEvMTEuMi4wIn0sImlzSHRtbCI6ZmFsc2V9LCJyZXNwb25zZSI6eyJzdGF0dXMiOjIwMCwic3RhdHVzVGV4dCI6Ik9LIiwiaGVhZGVycyI6eyJhY2NlcHQtcmFuZ2VzIjoiYnl0ZXMiLCJhZ2UiOiIxIiwiY2FjaGUtY29udHJvbCI6InB1YmxpYyxtYXgtYWdlPTAsbXVzdC1yZXZhbGlkYXRlIiwiY2FjaGUtc3RhdHVzIjoiXCJOZXRsaWZ5IEVkZ2VcIjsgZndkPW1pc3MiLCJjb250ZW50LWxlbmd0aCI6IjE1NDM1NyIsImNvbnRlbnQtdHlwZSI6ImltYWdlL2pwZWciLCJkYXRlIjoiVGh1LCAxNyBKdWwgMjAyNSAxNjoxNjozOSBHTVQiLCJldGFnIjoiXCI1NDNiYTBkN2FiNGYwMDIwZjVlNTM2M2Q5ZGNhOTVkNC1zc2xcIiIsInNlcnZlciI6Ik5ldGxpZnkiLCJzdHJpY3QtdHJhbnNwb3J0LXNlY3VyaXR5IjoibWF4LWFnZT0zMTUzNjAwMDsgaW5jbHVkZVN1YkRvbWFpbnM7IHByZWxvYWQiLCJ4LW5mLXJlcXVlc3QtaWQiOiIwMUswQ0pSVjRWRldQNk5TMTFHRzM4NjE5QiIsImNvbm5lY3Rpb24iOiJjbG9zZSJ9LCJkYXRhIjoiUmVzcG9uc2UgY29udGVudCByZWRhY3RlZCAoaW1hZ2UgZGF0YSkiLCJyZXNwb25zZVRpbWUiOjE5NTM5NiwiaXNIdG1sIjpmYWxzZX0sImVycm9yIjpudWxsLCJzdGF0dXMiOiJwYXNzIiwiYXNzZXJ0aW9uUmVzdWx0cyI6W10sInRlc3RSZXN1bHRzIjpbXSwicHJlUmVxdWVzdFRlc3RSZXN1bHRzIjpbXSwicG9zdFJlc3BvbnNlVGVzdFJlc3VsdHMiOltdLCJzaG91bGRTdG9wUnVubmVyRXhlY3V0aW9uIjpmYWxzZSwicnVuRHVyYXRpb24iOjE5Ni40MDE3NzMzNTMsIm5hbWUiOiJtdXNpY3MuanBlZyIsInBhdGgiOiJtdXNpY3MuanBlZyIsIml0ZXJhdGlvbkluZGV4IjowfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJvdXRkb29ycy5qcGVnLmJydSJ9LCJyZXF1ZXN0Ijp7Im1ldGhvZCI6IkdFVCIsInVybCI6Imh0dHBzOi8vcmVhY3QtbmF0aXZlLWFydGlmYWN0cy5uZXRsaWZ5LmFwcC9vdXRkb29ycy5qcGVnIiwiaGVhZGVycyI6eyJVc2VyLUFnZW50IjoiaW5zb21uaWEvMTEuMi4wIn0sImlzSHRtbCI6ZmFsc2V9LCJyZXNwb25zZSI6eyJzdGF0dXMiOjIwMCwic3RhdHVzVGV4dCI6Ik9LIiwiaGVhZGVycyI6eyJhY2NlcHQtcmFuZ2VzIjoiYnl0ZXMiLCJhZ2UiOiIxIiwiY2FjaGUtY29udHJvbCI6InB1YmxpYyxtYXgtYWdlPTAsbXVzdC1yZXZhbGlkYXRlIiwiY2FjaGUtc3RhdHVzIjoiXCJOZXRsaWZ5IEVkZ2VcIjsgZndkPW1pc3MiLCJjb250ZW50LWxlbmd0aCI6IjE2MTI5MSIsImNvbnRlbnQtdHlwZSI6ImltYWdlL2pwZWciLCJkYXRlIjoiVGh1LCAxNyBKdWwgMjAyNSAxNjoxOTozNyBHTVQiLCJldGFnIjoiXCJiYzYzM2U0N2JlN2RiOTZhMDJlZTlmY2Y1YTM5YzA4Yy1zc2xcIiIsInNlcnZlciI6Ik5ldGxpZnkiLCJzdHJpY3QtdHJhbnNwb3J0LXNlY3VyaXR5IjoibWF4LWFnZT0zMTUzNjAwMDsgaW5jbHVkZVN1YkRvbWFpbnM7IHByZWxvYWQiLCJ4LW5mLXJlcXVlc3QtaWQiOiIwMUswQ0pZOTk0M0NBRlJON0pXWUJaV0FUUCIsImNvbm5lY3Rpb24iOiJjbG9zZSJ9LCJkYXRhIjoiUmVzcG9uc2UgY29udGVudCByZWRhY3RlZCAoaW1hZ2UgZGF0YSkiLCJyZXNwb25zZVRpbWUiOjY5ODcsImlzSHRtbCI6ZmFsc2V9LCJlcnJvciI6bnVsbCwic3RhdHVzIjoicGFzcyIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjo3Ljk5MjQ1MDQ3MywibmFtZSI6Im91dGRvb3JzLmpwZWciLCJwYXRoIjoib3V0ZG9vcnMuanBlZyIsIml0ZXJhdGlvbkluZGV4IjowfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJzcG9ydHMuanBnLmJydSJ9LCJyZXF1ZXN0Ijp7Im1ldGhvZCI6IkdFVCIsInVybCI6Imh0dHBzOi8vcmVhY3QtbmF0aXZlLWFydGlmYWN0cy5uZXRsaWZ5LmFwcC9zcG9ydHMuanBnIiwiaGVhZGVycyI6eyJVc2VyLUFnZW50IjoiaW5zb21uaWEvMTEuMi4wIn0sImlzSHRtbCI6ZmFsc2V9LCJyZXNwb25zZSI6eyJzdGF0dXMiOjIwMCwic3RhdHVzVGV4dCI6Ik9LIiwiaGVhZGVycyI6eyJhY2NlcHQtcmFuZ2VzIjoiYnl0ZXMiLCJhZ2UiOiIwIiwiY2FjaGUtY29udHJvbCI6InB1YmxpYyxtYXgtYWdlPTAsbXVzdC1yZXZhbGlkYXRlIiwiY2FjaGUtc3RhdHVzIjoiXCJOZXRsaWZ5IEVkZ2VcIjsgZndkPW1pc3MiLCJjb250ZW50LWxlbmd0aCI6IjEyNDcwNiIsImNvbnRlbnQtdHlwZSI6ImltYWdlL2pwZWciLCJkYXRlIjoiVGh1LCAxNyBKdWwgMjAyNSAxNjoxOTo0NSBHTVQiLCJldGFnIjoiXCJlNGQwMWQxOGY4NDI2OTAyNDA2NTYzOGY4MTk0M2ZjZC1zc2xcIiIsInNlcnZlciI6Ik5ldGxpZnkiLCJzdHJpY3QtdHJhbnNwb3J0LXNlY3VyaXR5IjoibWF4LWFnZT0zMTUzNjAwMDsgaW5jbHVkZVN1YkRvbWFpbnM7IHByZWxvYWQiLCJ4LW5mLXJlcXVlc3QtaWQiOiIwMUswQ0pZSFZEV1JOVllTM1NDWU1XVktEWSIsImNvbm5lY3Rpb24iOiJjbG9zZSJ9LCJkYXRhIjoiUmVzcG9uc2UgY29udGVudCByZWRhY3RlZCAoaW1hZ2UgZGF0YSkiLCJyZXNwb25zZVRpbWUiOjI5NjUsImlzSHRtbCI6ZmFsc2V9LCJlcnJvciI6bnVsbCwic3RhdHVzIjoicGFzcyIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjozLjk3MTA0MjgyMywibmFtZSI6InNwb3J0cy5qcGciLCJwYXRoIjoic3BvcnRzLmpwZyIsIml0ZXJhdGlvbkluZGV4IjowfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJ0cmF2ZWxzLmpwZy5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvdHJhdmVscy5qcGciLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJjb25uZWN0IEVUSU1FRE9VVCAxMy4yMTUuMjM5LjIxOTo0NDMiLCJzdGF0dXMiOiJlcnJvciIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjowLjUwNzEzNTQyOSwibmFtZSI6InRyYXZlbHMuanBnIiwicGF0aCI6InRyYXZlbHMuanBnIiwiaXRlcmF0aW9uSW5kZXgiOjB9XSwic3VtbWFyeSI6eyJ0b3RhbFJlcXVlc3RzIjoxNiwicGFzc2VkUmVxdWVzdHMiOjUsImZhaWxlZFJlcXVlc3RzIjowLCJza2lwcGVkUmVxdWVzdHMiOjAsImVycm9yUmVxdWVzdHMiOjExLCJ0b3RhbEFzc2VydGlvbnMiOjAsInBhc3NlZEFzc2VydGlvbnMiOjAsImZhaWxlZEFzc2VydGlvbnMiOjAsInRvdGFsVGVzdHMiOjAsInBhc3NlZFRlc3RzIjowLCJmYWlsZWRUZXN0cyI6MCwidG90YWxQcmVSZXF1ZXN0VGVzdHMiOjAsInBhc3NlZFByZVJlcXVlc3RUZXN0cyI6MCwiZmFpbGVkUHJlUmVxdWVzdFRlc3RzIjowLCJ0b3RhbFBvc3RSZXNwb25zZVRlc3RzIjowLCJwYXNzZWRQb3N0UmVzcG9uc2VUZXN0cyI6MCwiZmFpbGVkUG9zdFJlc3BvbnNlVGVzdHMiOjB9fSx7Iml0ZXJhdGlvbkluZGV4IjoxLCJyZXN1bHRzIjpbeyJ0ZXN0Ijp7ImZpbGVuYW1lIjoiZmlsZXMudHh0LmJydSJ9LCJyZXF1ZXN0Ijp7Im1ldGhvZCI6IkdFVCIsInVybCI6Imh0dHBzOi8vcmVhY3QtbmF0aXZlLWFydGlmYWN0cy5uZXRsaWZ5LmFwcC9maWxlcy50eHQiLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJjb25uZWN0IEVUSU1FRE9VVCAxMy4yMTUuMjM5LjIxOTo0NDMiLCJzdGF0dXMiOiJlcnJvciIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjoxLjUwNzgzODc1MSwibmFtZSI6ImZpbGVzLnR4dCIsInBhdGgiOiJmaWxlcy50eHQiLCJpdGVyYXRpb25JbmRleCI6MX0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoibW92aWVzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbW92aWVzLmNvbnRhaW5lci5idW5kbGUuYnJ1In0sInJlcXVlc3QiOnsibWV0aG9kIjoiR0VUIiwidXJsIjoiaHR0cHM6Ly9yZWFjdC1uYXRpdmUtYXJ0aWZhY3RzLm5ldGxpZnkuYXBwL2FydGlmYWN0cy9tb3ZpZXMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9tb3ZpZXMuY29udGFpbmVyLmJ1bmRsZSIsImhlYWRlcnMiOnsiVXNlci1BZ2VudCI6Imluc29tbmlhLzExLjIuMCJ9LCJpc0h0bWwiOmZhbHNlfSwicmVzcG9uc2UiOnsic3RhdHVzIjoyMDAsInN0YXR1c1RleHQiOiJPSyIsImhlYWRlcnMiOnsiYWNjZXB0LXJhbmdlcyI6ImJ5dGVzIiwiYWdlIjoiMCIsImNhY2hlLWNvbnRyb2wiOiJwdWJsaWMsbWF4LWFnZT0wLG11c3QtcmV2YWxpZGF0ZSIsImNhY2hlLXN0YXR1cyI6IlwiTmV0bGlmeSBFZGdlXCI7IGZ3ZD1taXNzIiwiY29udGVudC10eXBlIjoidGV4dC9qYXZhc2NyaXB0IiwiZGF0ZSI6IlRodSwgMTcgSnVsIDIwMjUgMTY6MTk6NTIgR01UIiwiZXRhZyI6IlwiYTdmNjhlOGYyMTI1MTYwYWExZDgxZTdkODJmMGY0ZTAtc3NsLWRmXCIiLCJzZXJ2ZXIiOiJOZXRsaWZ5Iiwic3RyaWN0LXRyYW5zcG9ydC1zZWN1cml0eSI6Im1heC1hZ2U9MzE1MzYwMDA7IGluY2x1ZGVTdWJEb21haW5zOyBwcmVsb2FkIiwidmFyeSI6IkFjY2VwdC1FbmNvZGluZyIsIngtbmYtcmVxdWVzdC1pZCI6IjAxSzBDSllSN1FCMTJUQTc5N1Y2VFJYN0UxIiwiY29ubmVjdGlvbiI6ImNsb3NlIiwidHJhbnNmZXItZW5jb2RpbmciOiJjaHVua2VkIn0sImRhdGEiOiIvKioqKioqLyB2YXIgc2VsZiA9IHNlbGYgfHwgdGhpcyB8fCBuZXcgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpIHx8ICh7fSk7IC8vIHJlcGFja0dsb2JhbCdcbi8qKioqKiovXG52YXIgbW92aWVzO1xuKGZ1bmN0aW9uKCkgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG52YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7XG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvQ29yZVBsdWdpbi5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvQ29yZVBsdWdpbi5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImRlZmF1bHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBfZGVmYXVsdDtcbiAgICB9XG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIFJlcGFja0NvcmVQbHVnaW4gPSAoKT0+KHtcbiAgICAgICAgbmFtZTogJ3JlcGFjay1jb3JlLXBsdWdpbicsXG4gICAgICAgIGxvYWRFbnRyeTogKHJlZik9PntcbiAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gcmVmLnJlbW90ZUluZm87XG4gICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2xpZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vU2NyaXB0TWFuYWdlci9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzXCIpO1xuICAgICAgICAgICAgICAgIHZhciBTY3JpcHRNYW5hZ2VyID0gY2xpZW50LlNjcmlwdE1hbmFnZXIsIGdldFdlYnBhY2tDb250ZXh0ID0gY2xpZW50LmdldFdlYnBhY2tDb250ZXh0O1xuICAgICAgICAgICAgICAgIHZhciBlbnRyeSA9IHJlbW90ZUluZm8uZW50cnksIGVudHJ5R2xvYmFsTmFtZSA9IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIFNjcmlwdE1hbmFnZXIuc2hhcmVkLmxvYWRTY3JpcHQoZW50cnlHbG9iYWxOYW1lLCB1bmRlZmluZWQsIGdldFdlYnBhY2tDb250ZXh0KCksIGVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBpZiAoIWdsb2JhbFRoaXNbZW50cnlHbG9iYWxOYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2xvYmFsVGhpc1tlbnRyeUdsb2JhbE5hbWVdO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGxvYWQgcmVtb3RlIGVudHJ5OiAke2VudHJ5R2xvYmFsTmFtZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSgpO1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZVByZWxvYWRBc3NldHM6ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIC8vIG5vb3AgZm9yIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgY3NzQXNzZXRzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAganNBc3NldHNXaXRob3V0RW50cnk6IFtdLFxuICAgICAgICAgICAgICAgICAgICBlbnRyeUFzc2V0czogW11cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pKClcbiAgICB9KTtcbnZhciBfZGVmYXVsdCA9IFJlcGFja0NvcmVQbHVnaW47XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvUmVzb2x2ZXJQbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL0ZlZGVyYXRpb25SdW50aW1lUGx1Z2lucy9SZXNvbHZlclBsdWdpbi5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX2RlZmF1bHQ7XG4gICAgfVxufSkpO1xudmFyIF9hc3luY190b19nZW5lcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fYXN5bmNfdG9fZ2VuZXJhdG9yICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiKTtcbnZhciBfb2JqZWN0X3NwcmVhZCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19vYmplY3Rfc3ByZWFkICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fb2JqZWN0X3NwcmVhZC5janNcIik7XG52YXIgY3JlYXRlU2NyaXB0TG9jYXRvciA9IChlbnRyeVVybCwgY29uZmlnKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHZhciBsb2NhdG9yID0geWllbGQgY29uZmlnKGVudHJ5VXJsKTtcbiAgICAgICAgICAgIHJldHVybiBsb2NhdG9yO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIF9vYmplY3Rfc3ByZWFkLl8oe1xuICAgICAgICAgICAgICAgIHVybDogZW50cnlVcmxcbiAgICAgICAgICAgIH0sIGNvbmZpZyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVybDogZW50cnlVcmxcbiAgICAgICAgfTtcbiAgICB9KSgpO1xudmFyIFJlcGFja1Jlc29sdmVyUGx1Z2luID0gKGNvbmZpZyk9Pih7XG4gICAgICAgIG5hbWU6ICdyZXBhY2stcmVzb2x2ZXItcGx1Z2luJyxcbiAgICAgICAgYWZ0ZXJSZXNvbHZlIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgU2NyaXB0TWFuYWdlciA9IChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvaW5kZXguanNcIikvKiAuU2NyaXB0TWFuYWdlciAqLy5TY3JpcHRNYW5hZ2VyKTtcbiAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gYXJncy5yZW1vdGVJbmZvO1xuICAgICAgICAgICAgU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoKHNjcmlwdElkLCBjYWxsZXIsIHJlZmVyZW5jZVVybCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVudHJ5IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NyaXB0SWQgPT09IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRvciA9IHlpZWxkIGNyZWF0ZVNjcmlwdExvY2F0b3IocmVtb3RlSW5mby5lbnRyeSwgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhdG9yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGVudHJ5IGNodW5rc1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVmZXJlbmNlVXJsICYmIGNhbGxlciA9PT0gcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwdWJsaWNQYXRoID0gcmVtb3RlSW5mby5lbnRyeS5zcGxpdCgnLycpLnNsaWNlKDAsIC0xKS5qb2luKCcvJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnVuZGxlUGF0aCA9IHNjcmlwdElkICsgcmVmZXJlbmNlVXJsLnNwbGl0KHNjcmlwdElkKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBwdWJsaWNQYXRoICsgJy8nICsgYnVuZGxlUGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdG9yMSA9IHlpZWxkIGNyZWF0ZVNjcmlwdExvY2F0b3IodXJsLCBjb25maWcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvY2F0b3IxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkoKSwge1xuICAgICAgICAgICAgICAgIGtleTogcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgICAgIH1cbiAgICB9KTtcbnZhciBfZGVmYXVsdCA9IFJlcGFja1Jlc29sdmVyUGx1Z2luO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJTY3JpcHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBTY3JpcHQ7XG4gICAgfVxufSkpO1xudmFyIF9jbGFzc19jYWxsX2NoZWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NsYXNzX2NhbGxfY2hlY2sgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqc1wiKTtcbnZhciBfY3JlYXRlX2NsYXNzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NyZWF0ZV9jbGFzcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janNcIik7XG52YXIgX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuY2pzXCIpO1xudmFyIF9zaGFsbG93ZXF1YWwgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIHNoYWxsb3dlcXVhbCAqLyBcIi4vbm9kZV9tb2R1bGVzL3NoYWxsb3dlcXVhbC9pbmRleC5qc1wiKSk7XG52YXIgX05hdGl2ZVNjcmlwdE1hbmFnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL05hdGl2ZVNjcmlwdE1hbmFnZXIuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzXCIpO1xudmFyIFNjcmlwdCA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgZnVuY3Rpb24gU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIGxvY2F0b3IsIHJlZikge1xuICAgICAgICB2YXIgY2FjaGUgPSByZWYgPT09IHZvaWQgMCA/IHRydWUgOiByZWY7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU2NyaXB0KTtcbiAgICAgICAgdGhpcy5zY3JpcHRJZCA9IHNjcmlwdElkO1xuICAgICAgICB0aGlzLmNhbGxlciA9IGNhbGxlcjtcbiAgICAgICAgdGhpcy5sb2NhdG9yID0gbG9jYXRvcjtcbiAgICAgICAgdGhpcy5jYWNoZSA9IGNhY2hlO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oU2NyaXB0LCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBDaGVjayBpZiB0aGUgc2NyaXB0IHdhcyBhbHJlYWR5IGNhY2hlZCBhbmQgY2FjaGUgc2hvdWxkIGJlIHVwZGF0ZWQgd2l0aCBuZXcgZGF0YS5cbiAgICpcbiAgICogQHBhcmFtIGNhY2hlZERhdGEgQ2FjaGVkIGRhdGEgZm9yIHRoZSBzYW1lIHNjcmlwdC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwic2hvdWxkVXBkYXRlQ2FjaGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzaG91bGRVcGRhdGVDYWNoZShjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhY2hlIHx8ICFjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkKGNhY2hlZERhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIHNjcmlwdCBzaG91bGQgYmUgZmV0Y2hlZCBhZ2FpbiBvciByZXVzZWQsXG4gICAqIGJhc2VkIG9uIHByZXZpb3VzIGNhY2hlZCBkYXRhLlxuICAgKlxuICAgKiBAcGFyYW0gY2FjaGVkRGF0YSBDYWNoZWQgZGF0YSBmb3IgdGhlIHNhbWUgc2NyaXB0LlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICovIGtleTogXCJzaG91bGRSZWZldGNoXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdWxkUmVmZXRjaChjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhY2hlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jaGVja0lmQ2FjaGVEYXRhT3V0ZGF0ZWQoY2FjaGVkRGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBDaGVjayBpZiBwcmV2aW91cyBjYWNoZWQgZGF0YSBpcyB0aGUgc2FtZSBhcyB0aGUgbmV3IG9uZS5cbiAgICpcbiAgICogQHBhcmFtIGNhY2hlZERhdGEgQ2FjaGVkIGRhdGEgZm9yIHRoZSBzYW1lIHNjcmlwdC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwiY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkKGNhY2hlZERhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVkRGF0YS5tZXRob2QgIT09IHRoaXMubG9jYXRvci5tZXRob2QgfHwgY2FjaGVkRGF0YS51cmwgIT09IHRoaXMubG9jYXRvci51cmwgfHwgY2FjaGVkRGF0YS5xdWVyeSAhPT0gdGhpcy5sb2NhdG9yLnF1ZXJ5IHx8ICEoMCwgX3NoYWxsb3dlcXVhbC5kZWZhdWx0KShjYWNoZWREYXRhLmhlYWRlcnMsIHRoaXMubG9jYXRvci5oZWFkZXJzKSB8fCBjYWNoZWREYXRhLmJvZHkgIT09IHRoaXMubG9jYXRvci5ib2R5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogR2V0IG9iamVjdCB0byBzdG9yZSBpbiBjYWNoZS5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwiZ2V0Q2FjaGVEYXRhXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2FjaGVEYXRhKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogdGhpcy5sb2NhdG9yLm1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLmxvY2F0b3IudXJsLFxuICAgICAgICAgICAgICAgICAgICBxdWVyeTogdGhpcy5sb2NhdG9yLnF1ZXJ5LFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmxvY2F0b3IuaGVhZGVycyxcbiAgICAgICAgICAgICAgICAgICAgYm9keTogdGhpcy5sb2NhdG9yLmJvZHlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwidG9PYmplY3RcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b09iamVjdCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzY3JpcHRJZDogdGhpcy5zY3JpcHRJZCxcbiAgICAgICAgICAgICAgICAgICAgY2FsbGVyOiB0aGlzLmNhbGxlcixcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRvcjogdGhpcy5sb2NhdG9yLFxuICAgICAgICAgICAgICAgICAgICBjYWNoZTogdGhpcy5jYWNoZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXREZXZTZXJ2ZXJVUkxcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogR2V0IFVSTCBvZiBhIHNjcmlwdCBob3N0ZWQgb24gZGV2ZWxvcG1lbnQgc2VydmVyLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdC5cbiAgICovIGZ1bmN0aW9uIGdldERldlNlcnZlclVSTChzY3JpcHRJZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT5gJHt3ZWJwYWNrQ29udGV4dC5wfSR7d2VicGFja0NvbnRleHQudShzY3JpcHRJZCl9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldEZpbGVTeXN0ZW1VUkxcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogR2V0IFVSTCBvZiBhIHNjcmlwdCBzdG9yZWQgb24gZmlsZXN5c3RlbSBvbiB0aGUgdGFyZ2V0IG1vYmlsZSBkZXZpY2UuXG4gICAqXG4gICAqIEBwYXJhbSBzY3JpcHRJZCBJZCBvZiB0aGUgc2NyaXB0LlxuICAgKi8gZnVuY3Rpb24gZ2V0RmlsZVN5c3RlbVVSTChzY3JpcHRJZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT53ZWJwYWNrQ29udGV4dC51KGBmaWxlOi8vLyR7c2NyaXB0SWR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRSZW1vdGVVUkxcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogR2V0IFVSTCBvZiBhIHNjcmlwdCBob3N0ZWQgb24gYSByZW1vdGUgc2VydmVyLlxuICAgKlxuICAgKiBCeSBkZWZhdWx0IGAuY2h1bmsuYnVuZGxlYCBleHRlbnNpb24gd2lsbCBiZSBhZGRlZCB0byB0aGUgVVJMLlxuICAgKiBJZiB5b3VyIHNjcmlwdCBoYXMgZGlmZmVyZW50IGV4dGVuc2lvbiwgeW91IHNob3VsZCBwYXNzIGB7IGV4Y2x1ZGVFeHRlbnNpb246IHRydWUgfWAgYXMgMm5kIGFyZ3VtZW50LlxuICAgKlxuICAgKiBAcGFyYW0gdXJsIEEgVVJMIHRvIHJlbW90ZSBsb2NhdGlvbiB3aGVyZSB0aGUgc2NyaXB0IGlzIHN0b3JlZC5cbiAgICogQHBhcmFtIG9wdGlvbnMgQWRkaXRpb25hbCBvcHRpb25zLlxuICAgKi8gZnVuY3Rpb24gZ2V0UmVtb3RlVVJMKHVybCwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSByZWYgPT09IHZvaWQgMCA/IHt9IDogcmVmO1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmV4Y2x1ZGVFeHRlbnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICh3ZWJwYWNrQ29udGV4dCk9PndlYnBhY2tDb250ZXh0LnUodXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldFNjcmlwdFVuaXF1ZUlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIEdldCB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHNjcmlwdC5cbiAgICpcbiAgICogVXNlZCB0byBjcmVhdGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBzY3JpcHQsIHdoaWNoIHNlcnZlcyBhcyBpdHMga2V5IGluIHRoZSBjYWNoZS5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQuXG4gICAqIEBwYXJhbSBjYWxsZXIgT3B0aW9uYWwgY2FsbGVyIG5hbWUgdG8gcHJlZml4IHRoZSBzY3JpcHQgaWQuXG4gICAqLyBmdW5jdGlvbiBnZXRTY3JpcHRVbmlxdWVJZChzY3JpcHRJZCwgY2FsbGVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByZWZpeCA9IGNhbGxlciA/IGNhbGxlciArICdfJyA6ICcnO1xuICAgICAgICAgICAgICAgIHJldHVybiBwcmVmaXggKyBzY3JpcHRJZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImZyb21cIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogQ3JlYXRlIG5ldyBpbnN0YW5jZSBvZiBgU2NyaXB0YCBmcm9tIG5vbi1ub3JtYWxpemVkIHNjcmlwdCBsb2NhdG9yIGRhdGEuXG4gICAqXG4gICAqIEBwYXJhbSBsb2NhdG9yIE5vbi1ub3JtYWxpemVkIGxvY2F0b3IgZGF0YS5cbiAgICogQHBhcmFtIGZldGNoIEluaXRpYWwgZmxhZyBmb3Igd2hldGhlciBzY3JpcHQgc2hvdWxkIGJlIGZldGNoZWQgb3Igbm90LlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICovIGZ1bmN0aW9uIGZyb20oa2V5LCBsb2NhdG9yLCBmZXRjaCkge1xuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0ge307XG4gICAgICAgICAgICAgICAgbmV3IEhlYWRlcnMobG9jYXRvci5oZWFkZXJzKS5mb3JFYWNoKCh2YWx1ZSwga2V5KT0+e1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW2tleS50b0xvd2VyQ2FzZSgpXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciB1bmlxdWVJZCA9IFNjcmlwdC5nZXRTY3JpcHRVbmlxdWVJZChrZXkuc2NyaXB0SWQsIGtleS5jYWxsZXIpO1xuICAgICAgICAgICAgICAgIHZhciBib2R5O1xuICAgICAgICAgICAgICAgIGlmIChsb2NhdG9yLmJvZHkgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm9keU9iamVjdCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBsb2NhdG9yLmJvZHkuZm9yRWFjaCgodmFsdWUsIGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keU9iamVjdFtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignU2NyaXB0IGRvZXMgbm90IHN1cHBvcnQgRmlsZSBhcyBGb3JtRGF0YSBrZXkgaW4gYm9keScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KGJvZHlPYmplY3QpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobG9jYXRvci5ib2R5IGluc3RhbmNlb2YgVVJMU2VhcmNoUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBib2R5T2JqZWN0MSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBsb2NhdG9yLmJvZHkuZm9yRWFjaCgodmFsdWUsIGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHlPYmplY3QxW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJvZHkgPSBKU09OLnN0cmluZ2lmeShib2R5T2JqZWN0MSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYm9keSA9IGxvY2F0b3IuYm9keSA/PyB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbG9jYXRvci51cmwgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQcm9wZXJ0eSB1cmwgYXMgYSBmdW5jdGlvbiBpcyBub3Qgc3VwcG9ydCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdChrZXkuc2NyaXB0SWQsIGtleS5jYWxsZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlSWQsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogbG9jYXRvci5tZXRob2QgPz8gX05hdGl2ZVNjcmlwdE1hbmFnZXIuTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kLkdFVCxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBsb2NhdG9yLnVybCxcbiAgICAgICAgICAgICAgICAgICAgYWJzb2x1dGU6IGxvY2F0b3IuYWJzb2x1dGUgPz8gZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IGxvY2F0b3IudGltZW91dCA/PyBTY3JpcHQuREVGQVVMVF9USU1FT1VULFxuICAgICAgICAgICAgICAgICAgICByZXRyeTogbG9jYXRvci5yZXRyeSxcbiAgICAgICAgICAgICAgICAgICAgcmV0cnlEZWxheTogbG9jYXRvci5yZXRyeURlbGF5LFxuICAgICAgICAgICAgICAgICAgICBxdWVyeTogbmV3IFVSTFNlYXJjaFBhcmFtcyhsb2NhdG9yLnF1ZXJ5KS50b1N0cmluZygpIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgYm9keSxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogT2JqZWN0LmtleXMoaGVhZGVycykubGVuZ3RoID8gaGVhZGVycyA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgZmV0Y2g6IGxvY2F0b3IuY2FjaGUgPT09IGZhbHNlID8gdHJ1ZSA6IGZldGNoLFxuICAgICAgICAgICAgICAgICAgICB2ZXJpZnlTY3JpcHRTaWduYXR1cmU6IGxvY2F0b3IudmVyaWZ5U2NyaXB0U2lnbmF0dXJlID8/IF9OYXRpdmVTY3JpcHRNYW5hZ2VyLk5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZS5PRkZcbiAgICAgICAgICAgICAgICB9LCBsb2NhdG9yLmNhY2hlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBTY3JpcHQ7XG59IC8vIyBzb3VyY2VNYXBwaW5nVVJMPVNjcmlwdC5qcy5tYXBcbigpO1xuU2NyaXB0LkRFRkFVTFRfVElNRU9VVCA9IDMwMDAwIC8vIDMwc1xuO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHRNYW5hZ2VyLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL1NjcmlwdE1hbmFnZXIuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbi8vIGJpb21lLWlnbm9yZSBsaW50L3N0eWxlL3VzZU5vZGVqc0ltcG9ydFByb3RvY29sOiB1c2UgJ2V2ZW50cycgbW9kdWxlIGluc3RlYWQgb2Ygbm9kZSBidWlsdGluXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIlNjcmlwdE1hbmFnZXJcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBTY3JpcHRNYW5hZ2VyO1xuICAgIH1cbn0pKTtcbnZhciBfYXN5bmNfdG9fZ2VuZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2FzeW5jX3RvX2dlbmVyYXRvciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FzeW5jX3RvX2dlbmVyYXRvci5janNcIik7XG52YXIgX2NhbGxfc3VwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY2FsbF9zdXBlciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NhbGxfc3VwZXIuY2pzXCIpO1xudmFyIF9jbGFzc19jYWxsX2NoZWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NsYXNzX2NhbGxfY2hlY2sgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqc1wiKTtcbnZhciBfY3JlYXRlX2NsYXNzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NyZWF0ZV9jbGFzcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janNcIik7XG52YXIgX2luaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2luaGVyaXRzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW5oZXJpdHMuY2pzXCIpO1xudmFyIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiKTtcbnZhciBfc2xpY2VkX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3NsaWNlZF90b19hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janNcIik7XG52YXIgX3RvX2NvbnN1bWFibGVfYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fdG9fY29uc3VtYWJsZV9hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzXCIpO1xudmFyIF9ldmVudHMgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIGV2ZW50cyAqLyBcIi4vbm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanNcIikpO1xudmFyIF9OYXRpdmVTY3JpcHRNYW5hZ2VyID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL05hdGl2ZVNjcmlwdE1hbmFnZXIuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzXCIpKTtcbnZhciBfU2NyaXB0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9TY3JpcHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanNcIik7XG52YXIgX2dldFdlYnBhY2tDb250ZXh0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9nZXRXZWJwYWNrQ29udGV4dC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2dldFdlYnBhY2tDb250ZXh0LmpzXCIpO1xudmFyIERFRkFVTFRfUkVTT0xWRVJfUFJJT1JJVFkgPSAyO1xudmFyIERFRkFVTFRfUkVTT0xWRVJfS0VZID0gJ19fZGVmYXVsdF9fJztcbnZhciBDQUNIRV9OQU1FID0gJ1JlcGFjay5TY3JpcHRNYW5hZ2VyLkNhY2hlJztcbnZhciBDQUNIRV9WRVJTSU9OID0gJ3Y0JztcbnZhciBDQUNIRV9FTlYgPSAgdHJ1ZSA/ICdkZWJ1ZycgOiAwO1xudmFyIENBQ0hFX0tFWSA9IFtcbiAgICBDQUNIRV9OQU1FLFxuICAgIENBQ0hFX1ZFUlNJT04sXG4gICAgQ0FDSEVfRU5WXG5dLmpvaW4oJy4nKTtcbnZhciBMT0FESU5HX0VSUk9SX0NPREVTID0gW1xuICAgIC8vIGFuZHJvaWRcbiAgICAnTmV0d29ya0ZhaWx1cmUnLFxuICAgICdSZXF1ZXN0RmFpbHVyZScsXG4gICAgLy8gaW9zXG4gICAgJ1NjcmlwdERvd25sb2FkRmFpbHVyZSdcbl07XG52YXIgU2NyaXB0TWFuYWdlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oRXZlbnRFbWl0dGVyKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgX2luaGVyaXRzLl8oU2NyaXB0TWFuYWdlciwgRXZlbnRFbWl0dGVyKTtcbiAgICBmdW5jdGlvbiBTY3JpcHRNYW5hZ2VyKHJlZikge1xuICAgICAgICB2YXIgbmF0aXZlU2NyaXB0TWFuYWdlciA9IHJlZiA9PT0gdm9pZCAwID8gX05hdGl2ZVNjcmlwdE1hbmFnZXIuZGVmYXVsdCA6IHJlZjtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBTY3JpcHRNYW5hZ2VyKTtcbiAgICAgICAgdmFyIF90aGlzO1xuICAgICAgICBfdGhpcyA9IF9jYWxsX3N1cGVyLl8odGhpcywgU2NyaXB0TWFuYWdlciksIF90aGlzLmNhY2hlID0ge30sIF90aGlzLnNjcmlwdHNQcm9taXNlcyA9IHt9LCBfdGhpcy5jYWNoZUluaXRpYWxpemVkID0gZmFsc2UsIF90aGlzLnJlc29sdmVycyA9IFtdO1xuICAgICAgICBfdGhpcy5uYXRpdmVTY3JpcHRNYW5hZ2VyID0gbmF0aXZlU2NyaXB0TWFuYWdlcjtcbiAgICAgICAgaWYgKCFuYXRpdmVTY3JpcHRNYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3JlcGFjayByZWFjdC1uYXRpdmUgbW9kdWxlIHdhcyBub3QgZm91bmQuJyArICggdHJ1ZSA/ICcgRGlkIHlvdSBmb3JnZXQgdG8gdXBkYXRlIG5hdGl2ZSBkZXBlbmRlbmNpZXM/JyA6IDApKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2NyaXB0TWFuYWdlciB3YXMgYWxyZWFkeSBpbnN0YW50aWF0ZWQuIFVzZSBTY3JpcHRNYW5hZ2VyLnNoYXJlZCBpbnN0ZWFkLicpO1xuICAgICAgICB9XG4gICAgICAgIF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyID0gX3RoaXM7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFNjcmlwdE1hbmFnZXIsIFtcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIFNldHMgYSBzdG9yYWdlIGJhY2tlbmQgdG8gY2FjaGUgcmVzb2x2ZWQgc2NyaXB0cyBsb2NhdG9yIGRhdGEuXG4gICAqXG4gICAqIFRoZSBzdG9yZWQgZGF0YSBpcyB1c2VkIHRvIGRldGVjdCBpZiBzY3JpcHRzIGxvY2F0b3IgZGF0YSBvZiBwcmV2aW91c2x5IGRvd25sb2FkZWRcbiAgICogc2NyaXB0IGhhc24ndCBjaGFuZ2VkIHRvIGF2b2lkIG92ZXItZmV0Y2hpbmcgdGhlIHNjcmlwdC5cbiAgICpcbiAgICogQHBhcmFtIHN0b3JhZ2UgSW1wbGVtZW50YXRpb24gb2Ygc3RvcmFnZSBmdW5jdGlvbnMuXG4gICAqLyBrZXk6IFwic2V0U3RvcmFnZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFN0b3JhZ2Uoc3RvcmFnZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBBZGRzIG5ldyBzY3JpcHQgbG9jYXRvciByZXNvbHZlci5cbiAgICpcbiAgICogUmVzb2x2ZXIgaXMgYW4gYXN5bmMgZnVuY3Rpb24gdG8gcmVzb2x2ZSBzY3JpcHQgbG9jYXRvciBkYXRhIC0gaW4gb3RoZXIgd29yZHMsIGl0J3MgYSBmdW5jdGlvbiB0b1xuICAgKiB0ZWxsIHRoZSB7QGxpbmsgU2NyaXB0TWFuYWdlcn0gaG93IHRvIGZldGNoIHRoZSBzY3JpcHQuXG4gICAqXG4gICAqIFRoZXJlJ3Mgbm8gbGltaXRhdGlvbiBvbiB3aGF0IGxvZ2ljIHlvdSBjYW4gcnVuIGluc2lkZSB0aGlzIGZ1bmN0aW9uIC0gaXQgY2FuIGluY2x1ZGU6XG4gICAqIC0gZmV0Y2hpbmcvbG9hZGluZyByZW1vdGUgY29uZmlnXG4gICAqIC0gZmV0Y2hpbmcvbG9hZGluZyBmZWF0dXJlIGZsYWdzXG4gICAqIC0gZmV0Y2hpbmcvbG9hZGluZyBBL0IgdGVzdGluZyBkYXRhXG4gICAqIC0gY2FsbGluZyBuYXRpdmUgbW9kdWxlc1xuICAgKiAtIHJ1bm5pbmcgYXJiaXRyYXJ5IGxvZ2ljXG4gICAqXG4gICAqIEBwYXJhbSByZXNvbHZlciBSZXNvbHZlciBmdW5jdGlvbiB0byBhZGQuXG4gICAqIEBwYXJhbSBvcHRpb25zIFJlc29sdmVyIG9wdGlvbnMuXG4gICAqLyBrZXk6IFwiYWRkUmVzb2x2ZXJcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRSZXNvbHZlcihyZXNvbHZlciwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSByZWYgPT09IHZvaWQgMCA/IHt9IDogcmVmO1xuICAgICAgICAgICAgICAgIHZhciBwcmlvcml0eSA9IG9wdGlvbnMucHJpb3JpdHkgPz8gREVGQVVMVF9SRVNPTFZFUl9QUklPUklUWTtcbiAgICAgICAgICAgICAgICB2YXIgdW5pcXVlS2V5ID0gb3B0aW9ucy5rZXk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlcnMgPSB0aGlzLnJlc29sdmVycy5maWx0ZXIoKHJlZik9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAxKSwga2V5ID0gX3JlZlswXTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleSAhPT0gdW5pcXVlS2V5O1xuICAgICAgICAgICAgICAgIH0pLmNvbmNhdChbXG4gICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXF1ZUtleSA/PyBERUZBVUxUX1JFU09MVkVSX0tFWSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW9yaXR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZXJcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIF0pLnNvcnQoKHJlZiwgcmVmMSk9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgYSA9IF9yZWZbMV0sIF9yZWYxID0gX3NsaWNlZF90b19hcnJheS5fKHJlZjEsIDIpLCBiID0gX3JlZjFbMV07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiIC0gYTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIFJlbW92ZXMgcHJldmlvdXNseSBhZGRlZCByZXNvbHZlci5cbiAgICpcbiAgICogQHBhcmFtIHJlc29sdmVyIFJlc29sdmVyIGZ1bmN0aW9uIG9yIHJlc29sdmVyJ3MgYHVuaXF1ZUtleWAgdG8gcmVtb3ZlLlxuICAgKiBAcmV0dXJucyBgdHJ1ZWAgaWYgcmVzb2x2ZXIgd2FzIGZvdW5kIGFuZCByZW1vdmVkLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICovIGtleTogXCJyZW1vdmVSZXNvbHZlclwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVJlc29sdmVyKHJlc29sdmVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4O1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzb2x2ZXIgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5yZXNvbHZlcnMuZmluZEluZGV4KChyZWYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDEpLCBrZXkgPSBfcmVmWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleSA9PT0gcmVzb2x2ZXI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5yZXNvbHZlcnMuZmluZEluZGV4KChyZWYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDMpLCBpdGVtID0gX3JlZlsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtID09PSByZXNvbHZlcjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBSZW1vdmVzIGFsbCBwcmV2aW91c2x5IGFkZGVkIHJlc29sdmVycy5cbiAgICovIGtleTogXCJyZW1vdmVBbGxSZXNvbHZlcnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVBbGxSZXNvbHZlcnMoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlcnMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImluaXRDYWNoZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRDYWNoZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhY2hlSW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfdGhpc19zdG9yYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlRW50cnkgPSB5aWVsZCAoX3RoaXNfc3RvcmFnZSA9IHRoaXMuc3RvcmFnZSkgPT09IG51bGwgfHwgX3RoaXNfc3RvcmFnZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXNfc3RvcmFnZS5nZXRJdGVtKENBQ0hFX0tFWSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlID0gY2FjaGVFbnRyeSA/IEpTT04ucGFyc2UoY2FjaGVFbnRyeSkgOiB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic2F2ZUNhY2hlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2F2ZUNhY2hlKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXNfc3RvcmFnZTtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgKF90aGlzX3N0b3JhZ2UgPSB0aGlzLnN0b3JhZ2UpID09PSBudWxsIHx8IF90aGlzX3N0b3JhZ2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzX3N0b3JhZ2Uuc2V0SXRlbShDQUNIRV9LRVksIEpTT04uc3RyaW5naWZ5KHRoaXMuY2FjaGUpKTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaGFuZGxlRXJyb3JcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSwgLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5lcnJvci5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlXG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSwgW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEVycm9yOiBlcnJvclxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXSkpO1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgIGFyZ3MsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsRXJyb3I6IGVycm9yXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZXNvbHZlU2NyaXB0XCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIFJlc29sdmVzIGEge0BsaW5rIFNjcmlwdH0gaW5zdGFuY2Ugd2l0aCBub3JtYWxpemVkIGxvY2F0b3IgZGF0YS5cbiAgICpcbiAgICogUmVzb2x1dGlvbiB3aWxsIHVzZSBwcmV2aW91c2x5IGFkZGVkICh2aWEgYFNjcmlwdE1hbmFnZXIuc2hhcmVkLmFkZFJlc29sdmVyKC4uLilgKSByZXNvbHZlcnNcbiAgICogaW4gc2VyaWVzLCB1dGlsIG9uZSByZXR1cm5zIGEgbG9jYXRvciBkYXRhIG9yIHdpbGwgdGhyb3cgaWYgbm8gcmVzb2x2ZXIgaGFuZGxlZCB0aGUgcmVxdWVzdC5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbigncmVzb2x2aW5nJywgKHsgc2NyaXB0SWQsIGNhbGxlciB9KSA9PiB7IH0pYCB0byBsaXN0ZW4gZm9yIHdoZW5cbiAgICogdGhlIHNjcmlwdCByZXNvbHV0aW9uIGJlZ2lucy5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbigncmVzb2x2ZWQnLCAoc2NyaXB0KSA9PiB7IH0pYCB0byBsaXN0ZW4gZm9yIHdoZW5cbiAgICogdGhlIHNjcmlwdCdzIGxvY2F0b3IgZGF0YSBpcyByZXNvbHZlZC5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQgdG8gcmVzb2x2ZS5cbiAgICogQHBhcmFtIGNhbGxlciBOYW1lIG9mIHRoZSBjYWxsaW5nIHNjcmlwdCAtIGl0IGNhbiBiZSBmb3IgZXhhbXBsZTogbmFtZSBvZiB0aGUgYnVuZGxlLCBjaHVuayBvciBjb250YWluZXIuXG4gICAqLyBmdW5jdGlvbiByZXNvbHZlU2NyaXB0KF8wLCBfMSwgXzIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihzY3JpcHRJZCwgY2FsbGVyLCByZWYsIHJlZmVyZW5jZVVybCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgd2VicGFja0NvbnRleHQgPSByZWYgPT09IHZvaWQgMCA/ICgwLCBfZ2V0V2VicGFja0NvbnRleHQuZ2V0V2VicGFja0NvbnRleHQpKCkgOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaW5pdENhY2hlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmVzb2x2ZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc2NyaXB0IHJlc29sdmVycyB3ZXJlIGFkZGVkLiBEaWQgeW91IGZvcmdldCB0byBjYWxsIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlciguLi4pYD8nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgncmVzb2x2aW5nJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF8kcmVmIG9mIHRoaXMucmVzb2x2ZXJzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhfJHJlZiwgMyksIHJlc29sdmUgPSBfcmVmWzJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0b3IgPSB5aWVsZCByZXNvbHZlKHNjcmlwdElkLCBjYWxsZXIsIHJlZmVyZW5jZVVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsb2NhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyByZXNvbHZlciB3YXMgYWJsZSB0byByZXNvbHZlIHNjcmlwdCAke3NjcmlwdElkfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBsb2NhdG9yLnVybCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0b3IudXJsID0gbG9jYXRvci51cmwod2VicGFja0NvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdCA9IF9TY3JpcHQuU2NyaXB0LmZyb20oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgbG9jYXRvciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gc2NyaXB0LmxvY2F0b3IudW5pcXVlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB1c2VyIHByb3ZpZGVkIGEgY3VzdG9tIHNob3VsZFVwZGF0ZVNjcmlwdCBmdW5jdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0b3Iuc2hvdWxkVXBkYXRlU2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgc28sIHdlIG5lZWQgdG8gd2FpdCBmb3IgaXQgdG8gcmVzb2x2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmZXRjaCA9IHlpZWxkIGxvY2F0b3Iuc2hvdWxkVXBkYXRlU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIHNjcmlwdC5zaG91bGRVcGRhdGVDYWNoZSh0aGlzLmNhY2hlW2NhY2hlS2V5XSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGl0IHJldHVybnMgdHJ1ZSwgd2UgbmVlZCB0byBmZXRjaCB0aGUgc2NyaXB0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZldGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdC5sb2NhdG9yLmZldGNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdyZXNvbHZlZCcsIHNjcmlwdC50b09iamVjdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCByZXR1cm5zIGZhbHNlLCB3ZSBkb24ndCBuZWVkIHRvIGZldGNoIHRoZSBzY3JpcHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NyaXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgbm8gY3VzdG9tIHNob3VsZFVwZGF0ZVNjcmlwdCBmdW5jdGlvbiB3YXMgcHJvdmlkZWQsIHdlIHVzZSB0aGUgZGVmYXVsdCBiZWhhdmlvdXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZVtjYWNoZUtleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHQubG9jYXRvci5mZXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNjcmlwdC5zaG91bGRSZWZldGNoKHRoaXMuY2FjaGVbY2FjaGVLZXldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdC5sb2NhdG9yLmZldGNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgncmVzb2x2ZWQnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NyaXB0O1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1tTY3JpcHRNYW5hZ2VyXSBGYWlsZWQgd2hpbGUgcmVzb2x2aW5nIHNjcmlwdCBsb2NhdG9yOicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInVwZGF0ZUNhY2hlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQ2FjaGUoc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY3JpcHQubG9jYXRvci5mZXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gc2NyaXB0LmxvY2F0b3IudW5pcXVlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlW2NhY2hlS2V5XSA9IHNjcmlwdC5nZXRDYWNoZURhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2F2ZUNhY2hlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNjcmlwdFwiLFxuICAgICAgICAgICAgdmFsdWU6IC8qKlxuICAgKiBSZXNvbHZlcyBnaXZlbiBzY3JpcHQncyBsb2NhdGlvbiwgZG93bmxvYWRzIGFuZCBleGVjdXRlcyBpdC5cbiAgICogVGhlIGV4ZWN1dGlvbiBvZiB0aGUgY29kZSBpcyBoYW5kbGVkIGludGVybmFsbHkgYnkgdGhyZWFkaW5nIGluIFJlYWN0IE5hdGl2ZS5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbignbG9hZGluZycsIChzY3JpcHQpID0+IHsgfSlgIHRvIGxpc3RlbiBmb3Igd2hlblxuICAgKiB0aGUgc2NyaXB0IGlzIGFib3V0IHRvIGJlIGxvYWRlZC5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbignbG9hZGVkJywgKHNjcmlwdCkgPT4geyB9KWAgdG8gbGlzdGVuIGZvciB3aGVuXG4gICAqIHRoZSBzY3JpcHQgaXMgbG9hZGVkLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdCB0byBsb2FkLlxuICAgKiBAcGFyYW0gY2FsbGVyIE5hbWUgb2YgdGhlIGNhbGxpbmcgc2NyaXB0IC0gaXQgY2FuIGJlIGZvciBleGFtcGxlOiBuYW1lIG9mIHRoZSBidW5kbGUsIGNodW5rIG9yIGNvbnRhaW5lci5cbiAgICovIGZ1bmN0aW9uIGxvYWRTY3JpcHQoXzAsIF8xLCBfMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKHNjcmlwdElkLCBjYWxsZXIsIHJlZiwgcmVmZXJlbmNlVXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB3ZWJwYWNrQ29udGV4dCA9IHJlZiA9PT0gdm9pZCAwID8gKDAsIF9nZXRXZWJwYWNrQ29udGV4dC5nZXRXZWJwYWNrQ29udGV4dCkoKSA6IHJlZjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVuaXF1ZUlkID0gX1NjcmlwdC5TY3JpcHQuZ2V0U2NyaXB0VW5pcXVlSWQoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1ByZWZldGNoID0gdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdLmlzUHJlZmV0Y2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmVmZXRjaCBpcyBub3QgZXhlY3V0ZSB0aGUgc2NyaXB0IHNvIHdlIG5lZWQgdG8gcnVuIGxvYWRTY3JpcHQgaWYgcHJvbWlzZSBpcyBmb3IgcHJlZmV0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1ByZWZldGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkUHJvY2VzcyA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzY3JpcHQgPSB5aWVsZCB0aGlzLnJlc29sdmVTY3JpcHQoc2NyaXB0SWQsIGNhbGxlciwgd2VicGFja0NvbnRleHQsIHJlZmVyZW5jZVVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdsb2FkaW5nJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmxvYWRTY3JpcHRXaXRoUmV0cnkoc2NyaXB0SWQsIHNjcmlwdC5sb2NhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdsb2FkZWQnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMudXBkYXRlQ2FjaGUoc2NyaXB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29kZSA9IGVycm9yLmNvZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdbU2NyaXB0TWFuYWdlcl0gRmFpbGVkIHRvIGxvYWQgc2NyaXB0OicsIGNvZGUgPyBgWyR7Y29kZX1dYCA6ICcnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgZGVsZXRlIHNjcmlwdCBwcm9taXNlIGV2ZW4gc2NyaXB0IGZhaWxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXSA9IGxvYWRQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF07XG4gICAgICAgICAgICAgICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTY3JpcHRXaXRoUmV0cnlcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogTG9hZHMgYSBzY3JpcHQgd2l0aCByZXRyeSBsb2dpYy5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbiBhdHRlbXB0cyB0byBsb2FkIGEgc2NyaXB0IHVzaW5nIHRoZSBuYXRpdmVTY3JpcHRNYW5hZ2VyLlxuICAgKiBJZiB0aGUgaW5pdGlhbCBhdHRlbXB0IGZhaWxzLCBpdCByZXRyaWVzIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzXG4gICAqIHdpdGggYW4gb3B0aW9uYWwgZGVsYXkgYmV0d2VlbiByZXRyaWVzLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2NyaXB0SWQgLSBUaGUgSUQgb2YgdGhlIHNjcmlwdCB0byBsb2FkLlxuICAgKiBAcGFyYW0ge05vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yfSBsb2NhdG9yIC0gQW4gTm9ybWFsaXplZFNjcmlwdExvY2F0b3IgY29udGFpbmluZyByZXRyeSBjb25maWd1cmF0aW9uLlxuICAgKiBAcGFyYW0ge251bWJlcn0gW2xvY2F0b3IucmV0cnk9MF0gLSBUaGUgbnVtYmVyIG9mIHJldHJ5IGF0dGVtcHRzLlxuICAgKiBAcGFyYW0ge251bWJlcn0gW2xvY2F0b3IucmV0cnlEZWxheT0wXSAtIFRoZSBkZWxheSBpbiBtaWxsaXNlY29uZHMgYmV0d2VlbiByZXRyaWVzLlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3dzIGFuIGVycm9yIGlmIGFsbCByZXRyeSBhdHRlbXB0cyBmYWlsLlxuICAgKi8gZnVuY3Rpb24gbG9hZFNjcmlwdFdpdGhSZXRyeShzY3JpcHRJZCwgbG9jYXRvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2xvY2F0b3JfcmV0cnkgPSBsb2NhdG9yLnJldHJ5LCByZXRyeSA9IF9sb2NhdG9yX3JldHJ5ID09PSB2b2lkIDAgPyAwIDogX2xvY2F0b3JfcmV0cnksIF9sb2NhdG9yX3JldHJ5RGVsYXkgPSBsb2NhdG9yLnJldHJ5RGVsYXksIHJldHJ5RGVsYXkgPSBfbG9jYXRvcl9yZXRyeURlbGF5ID09PSB2b2lkIDAgPyAwIDogX2xvY2F0b3JfcmV0cnlEZWxheTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0dGVtcHRzID0gcmV0cnkgKyAxOyAvLyBJbmNsdWRlIHRoZSBpbml0aWFsIGF0dGVtcHRcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUoYXR0ZW1wdHMgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5uYXRpdmVTY3JpcHRNYW5hZ2VyLmxvYWRTY3JpcHQoc2NyaXB0SWQsIGxvY2F0b3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gU3VjY2Vzc2Z1bGx5IGxvYWRlZCB0aGUgc2NyaXB0LCBleGl0IHRoZSBsb29wXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGVtcHRzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBlcnJvci5jb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRlbXB0cyA+IDAgJiYgTE9BRElOR19FUlJPUl9DT0RFUy5pbmNsdWRlcyhjb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0cnlEZWxheSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKT0+c2V0VGltZW91dChyZXNvbHZlLCByZXRyeURlbGF5KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjsgLy8gTm8gbW9yZSByZXRyaWVzLCB0aHJvdyB0aGUgZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicHJlZmV0Y2hTY3JpcHRcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogUmVzb2x2ZXMgZ2l2ZW4gc2NyaXB0J3MgbG9jYXRpb24gYW5kIGRvd25sb2FkcyBpdCB3aXRob3V0IGV4ZWN1dGluZy5cbiAgICogVGhpcyBmdW5jdGlvbiBjYW4gYmUgYXdhaXRlZCB0byBkZXRlY3QgaWYgdGhlIHNjcmlwdCB3YXMgZG93bmxvYWRlZCBhbmQgZm9yIGVycm9yIGhhbmRsaW5nLlxuICAgKlxuICAgKiBVc2UgYFNjcmlwdE1hbmFnZXIuc2hhcmVkLm9uKCdwcmVmZXRjaGluZycsIChzY3JpcHQpID0+IHsgfSlgIHRvIGxpc3RlbiBmb3Igd2hlblxuICAgKiB0aGUgc2NyaXB0J3MgcHJlZmV0Y2ggYmVpbmdzLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdCB0byBwcmVmZXRjaC5cbiAgICogQHBhcmFtIGNhbGxlciBOYW1lIG9mIHRoZSBjYWxsaW5nIHNjcmlwdCAtIGl0IGNhbiBiZSBmb3IgZXhhbXBsZTogbmFtZSBvZiB0aGUgYnVuZGxlLCBjaHVuayBvciBjb250YWluZXIuXG4gICAqLyBmdW5jdGlvbiBwcmVmZXRjaFNjcmlwdChfMCwgXzEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihzY3JpcHRJZCwgY2FsbGVyLCByZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdlYnBhY2tDb250ZXh0ID0gcmVmID09PSB2b2lkIDAgPyAoMCwgX2dldFdlYnBhY2tDb250ZXh0LmdldFdlYnBhY2tDb250ZXh0KSgpIDogcmVmO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdW5pcXVlSWQgPSBfU2NyaXB0LlNjcmlwdC5nZXRTY3JpcHRVbmlxdWVJZChzY3JpcHRJZCwgY2FsbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFByb2Nlc3MgPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2NyaXB0ID0geWllbGQgdGhpcy5yZXNvbHZlU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIHdlYnBhY2tDb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ3ByZWZldGNoaW5nJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLm5hdGl2ZVNjcmlwdE1hbmFnZXIucHJlZmV0Y2hTY3JpcHQoc2NyaXB0SWQsIHNjcmlwdC5sb2NhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy51cGRhdGVDYWNoZShzY3JpcHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZXJyb3IuY29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1tTY3JpcHRNYW5hZ2VyXSBGYWlsZWQgdG8gcHJlZmV0Y2ggc2NyaXB0OicsIGNvZGUgPyBgWyR7Y29kZX1dYCA6ICcnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgZGVsZXRlIHNjcmlwdCBwcm9taXNlIGV2ZW4gc2NyaXB0IGZhaWxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXSA9IGxvYWRQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXS5pc1ByZWZldGNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW52YWxpZGF0ZVNjcmlwdHNcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogQ2xlYXJzIHRoZSBjYWNoZSAoaWYgY29uZmlndXJlZCBpbiB7QGxpbmsgU2NyaXB0TWFuYWdlci5zZXRTdG9yYWdlfSkgYW5kIHJlbW92ZXMgZG93bmxvYWRlZFxuICAgKiBmaWxlcyBmb3IgZ2l2ZW4gc2NyaXB0cyBmcm9tIHRoZSBmaWxlc3lzdGVtLiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBhd2FpdGVkIHRvIGRldGVjdCBpZiB0aGVcbiAgICogc2NyaXB0cyB3ZXJlIGludmFsaWRhdGVkIGFuZCBmb3IgZXJyb3IgaGFuZGxpbmcuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ2ludmFsaWRhdGVkJywgKHNjcmlwdElkcykgPT4geyB9KWAgdG8gbGlzdGVuIGZvciB3aGVuXG4gICAqIHRoZSBpbnZhbGlkYXRpb24gY29tcGxldGVzLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWRzIEFycmF5IG9mIHNjcmlwdCBpZHMgdG8gY2xlYXIgZnJvbSBjYWNoZSBhbmQgcmVtb3ZlIGZyb20gZmlsZXN5c3RlbS5cbiAgICogQHJldHVybnMgQXJyYXkgb2Ygc2NyaXB0IGlkcyB0aGF0IHdlcmUgaW52YWxpZGF0ZWQuXG4gICAqLyBmdW5jdGlvbiBpbnZhbGlkYXRlU2NyaXB0cygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdElkcyA9IHJlZiA9PT0gdm9pZCAwID8gW10gOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmluaXRDYWNoZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkcyA9IHNjcmlwdElkcy5sZW5ndGggPyBzY3JpcHRJZHMgOiBPYmplY3Qua2V5cyh0aGlzLmNhY2hlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkcy5mb3JFYWNoKChzY3JpcHRJZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5jYWNoZVtzY3JpcHRJZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2NyaXB0c1Byb21pc2VzW3NjcmlwdElkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zYXZlQ2FjaGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMubmF0aXZlU2NyaXB0TWFuYWdlci5pbnZhbGlkYXRlU2NyaXB0cyhzY3JpcHRJZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdpbnZhbGlkYXRlZCcsIGlkcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaWRzO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBlcnJvci5jb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1tTY3JpcHRNYW5hZ2VyXSBGYWlsZWQgdG8gaW52YWxpZGF0ZSBzY3JpcHRzOicsIGNvZGUgPyBgWyR7Y29kZX1dYCA6ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBFdmFsdWF0ZXMgYSBzY3JpcHQgc3luY2hyb25vdXNseS5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbiBzZW5kcyB0aGUgc2NyaXB0IHNvdXJjZSBhbmQgaXRzIFVSTCB0byB0aGUgbmF0aXZlIHNjcmlwdCBtYW5hZ2VyIGZvciBldmFsdWF0aW9uLlxuICAgKiBJdCBpcyBmdW5jdGlvbmFsbHkgaWRlbnRpY2FsIHRvIGBnbG9iYWxFdmFsV2l0aFNvdXJjZVVybGAuXG4gICAqXG4gICAqIEBwYXJhbSBzY3JpcHRTb3VyY2UgVGhlIHNvdXJjZSBjb2RlIG9mIHRoZSBzY3JpcHQgdG8gZXZhbHVhdGUuXG4gICAqIEBwYXJhbSBzY3JpcHRTb3VyY2VVcmwgVGhlIFVSTCBvZiB0aGUgc2NyaXB0IHNvdXJjZSwgdXNlZCBmb3IgZGVidWdnaW5nIHB1cnBvc2VzLlxuICAgKi8ga2V5OiBcInVuc3RhYmxlX2V2YWx1YXRlU2NyaXB0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdGFibGVfZXZhbHVhdGVTY3JpcHQoc2NyaXB0U291cmNlLCBzY3JpcHRTb3VyY2VVcmwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVNjcmlwdE1hbmFnZXIudW5zdGFibGVfZXZhbHVhdGVTY3JpcHQoc2NyaXB0U291cmNlLCBzY3JpcHRTb3VyY2VVcmwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlcikge1xuICAgICAgICAgICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlciA9IG5ldyBTY3JpcHRNYW5hZ2VyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic2hhcmVkXCIsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBTY3JpcHRNYW5hZ2VyO1xufSAvLyMgc291cmNlTWFwcGluZ1VSTD1TY3JpcHRNYW5hZ2VyLmpzLm1hcFxuKF9ldmVudHMuZGVmYXVsdCk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2ZlZGVyYXRlZC5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2ZlZGVyYXRlZC5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkZlZGVyYXRlZFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEZlZGVyYXRlZDtcbiAgICB9XG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIF9TY3JpcHRNYW5hZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9TY3JpcHRNYW5hZ2VyLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0TWFuYWdlci5qc1wiKTtcbnZhciBGZWRlcmF0ZWQ7XG4oZnVuY3Rpb24oX0ZlZGVyYXRlZCkge1xuICAgIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKlxuICAgKiBSZXNvbHZlcyBVUkwgdG8gYSBjb250YWluZXIgb3IgYSBjaHVuayB3aGVuIHVzaW5nIE1vZHVsZSBGZWRlcmF0aW9uLFxuICAgKiBiYXNlZCBvbiBnaXZlbiBgc2NyaXB0SWRgIGFuZCBgY2FsbGVyYC5cbiAgICovIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKlxuICAgKiBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHtAbGluayBjcmVhdGVVUkxSZXNvbHZlcn0gZm9yIE1vZHVsZSBGZWRlcmF0aW9uLlxuICAgKiBBbGxvd3MgdG8gY29uZmlndXJlIGhvdyBjcmVhdGVkIHtAbGluayBVUkxSZXNvbHZlcn0gd2lsbCBiZWhhdmUuXG4gICAqLyAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICpcbiAgICogQ3JlYXRlcyBVUkwgcmVzb2x2ZXIgZm9yIE1vZHVsZSBGZWRlcmF0aW9uIGZyb20gcHJvdmlkZWQgY29uZmlnLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgeyBTY3JpcHRNYW5hZ2VyLCBTY3JpcHQsIEZlZGVyYXRlZCB9IGZyb20gJ0BjYWxsc3RhY2svcmVwYWNrL2NsaWVudCc7XG4gICAqXG4gICAqIGNvbnN0IHJlc29sdmVVUkwgPSBGZWRlcmF0ZWQuY3JlYXRlVVJMUmVzb2x2ZXIoe1xuICAgKiAgIGNvbnRhaW5lcnM6IHtcbiAgICogICAgIGFwcDE6ICdodHRwOi8vbG9jYWxob3N0OjkwMDEvW25hbWVdW2V4dF0nLFxuICAgKiAgICAgYXBwMjogJ2h0dHA6Ly9sb2NhbGhvc3Q6OTAwMi9bbmFtZV0uY29udGFpbmVyLmpzJyxcbiAgICogICB9LFxuICAgKiAgIGNodW5rczoge1xuICAgKiAgICAgYXBwMjogJ2h0dHA6Ly9sb2NhbGhvc3Q6OTAwMi9jaHVua3MvW25hbWVdW2V4dF0nLFxuICAgKiAgIH0sXG4gICAqIH0pO1xuICAgKlxuICAgKiBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlcihhc3luYyAoc2NyaXB0SWQsIGNhbGxlcikgPT4ge1xuICAgKiAgIGxldCB1cmw7XG4gICAqICAgaWYgKGNhbGxlciA9PT0gJ21haW4nKSB7XG4gICAqICAgICB1cmwgPSBfX0RFVl9fXG4gICAqICAgICAgID8gU2NyaXB0LmdldERldlNlcnZlclVSTChzY3JpcHRJZClcbiAgICogICAgICAgOiBTY3JpcHQuZ2V0UmVtb3RlVVJMKGBodHRwOi8vbG9jYWxob3N0OjkwMDAvJHtzY3JpcHRJZH1gKTtcbiAgICogICB9IGVsc2Uge1xuICAgKiAgICAgdXJsID0gcmVzb2x2ZVVSTChzY3JpcHRJZCwgY2FsbGVyKTtcbiAgICogICB9XG4gICAqXG4gICAqICAgaWYgKCF1cmwpIHtcbiAgICogICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAqICAgfVxuICAgKlxuICAgKiAgIHJldHVybiB7XG4gICAqICAgICB1cmwsXG4gICAqICAgICBxdWVyeToge1xuICAgKiAgICAgICBwbGF0Zm9ybTogUGxhdGZvcm0uT1MsXG4gICAqICAgICB9LFxuICAgKiAgIH07XG4gICAqIH0pO1xuICAgKiBgYGBcbiAgICpcbiAgICogYGNyZWF0ZVVSTFJlc29sdmVyYCBpcyBhIGFic3RyYWN0aW9uIG92ZXIge0BsaW5rIFNjcmlwdC5nZXRSZW1vdGVVUkx9LFxuICAgKiBmb3IgZXhhbXBsZTpcbiAgICogYGBgdHNcbiAgICogaW1wb3J0IHsgU2NyaXB0TWFuYWdlciwgRmVkZXJhdGVkIH0gZnJvbSAnQGNhbGxzdGFjay9yZXBhY2svY2xpZW50JztcbiAgICpcbiAgICogU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoKHNjcmlwdElkLCBjYWxsZXIpID0+IHtcbiAgICogICBjb25zdCByZXNvbHZlVVJMID0gRmVkZXJhdGVkLmNyZWF0ZVVSTFJlc29sdmVyKHtcbiAgICogICAgIGNvbnRhaW5lcnM6IHtcbiAgICogICAgICAgYXBwMTogJ2h0dHA6Ly9sb2NhbGhvc3Q6OTAwMC9bbmFtZV1bZXh0XScsXG4gICAqICAgICB9LFxuICAgKiAgIH0pO1xuICAgKlxuICAgKiAgIHJldHVybiB7XG4gICAqICAgICB1cmw6IHJlc29sdmVVUkwoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAqICAgfTtcbiAgICogfSk7XG4gICAqIGBgYFxuICAgKiBpcyBlcXVpdmFsZW50IHRvOlxuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgeyBTY3JpcHRNYW5hZ2VyLCBTY3JpcHQgfSBmcm9tICdAY2FsbHN0YWNrL3JlcGFjay9jbGllbnQnO1xuICAgKlxuICAgKiBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlcihhc3luYyAoc2NyaXB0SWQsIGNhbGxlcikgPT4ge1xuICAgKiAgIGlmIChzY3JpcHRJZCA9PT0gJ2FwcDEnKSB7XG4gICAqICAgICByZXR1cm4ge1xuICAgKiAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjkwMDAvYXBwMS5jb250YWluZXIuYnVuZGxlJyxcbiAgICogICAgIH07XG4gICAqICAgfVxuICAgKlxuICAgKiAgIGlmIChjYWxsZXIgPT09ICdhcHAxJykge1xuICAgKiAgICAgcmV0dXJuIHtcbiAgICogICAgICAgdXJsOiBTY3JpcHQuZ2V0UmVtb3RlVVJMKGBodHRwOi8vbG9jYWxob3N0OjkwMDAvJHtzY3JpcHRJZH1gKSxcbiAgICogICAgIH07XG4gICAqICAgfVxuICAgKiB9KTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSBjb25maWcgQ29uZmlndXJhdGlvbiBmb3IgdGhlIHJlc29sdmVyLlxuICAgKiBAcGFyYW0gY29udGFpbmVyRXh0IEV4dGVuc2lvbiBvZiBjb250YWluZXIgYnVuZGxlcy4gRGVmYXVsdHMgdG8gYC5jb250YWluZXIuYnVuZGxlYC5cbiAgICogQHJldHVybnMgQSByZXNvbHZlciBmdW5jdGlvbiB3aGljaCB3aWxsIHRyeSB0byByZXNvbHZlIFVSTCBiYXNlZCBvbiBnaXZlbiBgc2NyaXB0SWRgIGFuZCBgY2FsbGVyYC5cbiAgICovIGZ1bmN0aW9uIGNyZWF0ZVVSTFJlc29sdmVyKGNvbmZpZywgcmVmKSB7XG4gICAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgcmVzb2x2ZXJzW2tleV0gPSAoc2NyaXB0SWQsIGNhbGxlcik9PntcbiAgICAgICAgICAgICAgICBpZiAoc2NyaXB0SWQgPT09IGtleSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gY29uZmlnLmNvbnRhaW5lcnNba2V5XS5yZXBsYWNlKC9cXFtuYW1lXFxdL2csIHNjcmlwdElkKS5yZXBsYWNlKC9cXFtleHRcXF0vZywgY29udGFpbmVyRXh0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxlciA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY29uZmlnX2NodW5rcztcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybDEgPSAoKChfY29uZmlnX2NodW5rcyA9IGNvbmZpZy5jaHVua3MpID09PSBudWxsIHx8IF9jb25maWdfY2h1bmtzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY29uZmlnX2NodW5rc1trZXldKSA/PyBjb25maWcuY29udGFpbmVyc1trZXldKS5yZXBsYWNlKC9cXFtuYW1lXFxdL2csIHNjcmlwdElkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVybDEuaW5jbHVkZXMoJ1tleHRdJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT53ZWJwYWNrQ29udGV4dC51KHVybDEucmVwbGFjZSgvXFxbZXh0XFxdL2csICcnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICB2YXIgY29udGFpbmVyRXh0ID0gcmVmID09PSB2b2lkIDAgPyAnLmNvbnRhaW5lci5idW5kbGUnIDogcmVmO1xuICAgICAgICB2YXIgcmVzb2x2ZXJzID0ge307XG4gICAgICAgIGZvcih2YXIga2V5IGluIGNvbmZpZy5jb250YWluZXJzKV9sb29wKGtleSk7XG4gICAgICAgIHJldHVybiAoc2NyaXB0SWQsIGNhbGxlcik9PntcbiAgICAgICAgICAgIHZhciByZXNvbHZlciA9IChjYWxsZXIgPyByZXNvbHZlcnNbY2FsbGVyXSA6IHVuZGVmaW5lZCkgPz8gcmVzb2x2ZXJzW3NjcmlwdElkXTtcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlcihzY3JpcHRJZCwgY2FsbGVyKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgX0ZlZGVyYXRlZC5jcmVhdGVVUkxSZXNvbHZlciA9IGNyZWF0ZVVSTFJlc29sdmVyO1xuICAgIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKlxuICAgKiBEeW5hbWljYWxseSBpbXBvcnRzIG1vZHVsZSBmcm9tIGEgTW9kdWxlIEZlZGVyYXRpb24gY29udGFpbmVyLiBTaW1pbGFyIHRvIGBpbXBvcnQoJ2ZpbGUnKWAsIGJ1dFxuICAgKiBzcGVjaWZpYyB0byBNb2R1bGUgRmVkZXJhdGlvbi4gQ2FsbGluZyBgaW1wb3J0TW9kdWxlYCB3aWxsIGNyZWF0ZSBhbiBhc3luYyBib3VuZGFyeS5cbiAgICpcbiAgICogQ29udGFpbmVyIHdpbGwgYmUgZXZhbHVhdGVkIG9ubHkgb25jZS4gSWYgeW91IHVzZSBgaW1wb3J0TW9kdWxlYCBmb3IgdGhlIHNhbWUgY29udGFpbmVyIHR3aWNlLFxuICAgKiB0aGUgY29udGFpbmVyIHdpbGwgYmUgbG9hZGVkIGFuZCBldmFsdWF0ZWQgb25seSBvbiB0aGUgZmlyc3QgaW1wb3J0LlxuICAgKlxuICAgKiBVbmRlciB0aGUgaG9vZCwgYGltcG9ydE1vZHVsZWAgd2lsbCBjYWxsIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5sb2FkU2NyaXB0KGNvbnRhaW5lck5hbWUpYC5cbiAgICogVGhpcyBtZWFucywgYSByZXNvbHZlciBtdXN0IGJlIGFkZGVkIHdpdGggYFNjcmlwdE1hbmFnZXIuc2hhcmVkLmFkZFJlc29sdmVyKC4uLilgIGJlZm9yZWhhbmQgYW5kIHByb3ZpZGVkIHByb3BlclxuICAgKiByZXNvbHV0aW9uIGxvZ2ljIHRvIHJlc29sdmUgVVJMIGJhc2VkIG9uIHRoZSBgY29udGFpbmVyTmFtZWAuXG4gICAqXG4gICAqIEBwYXJhbSBjb250YWluZXJOYW1lIE5hbWUgb2YgdGhlIGNvbnRhaW5lciAtIHNob3VsZCBiZSB0aGUgc2FtZSBuYW1lIHByb3ZpZGVkIHRvXG4gICAqIGB3ZWJwYWNrLmNvbnRhaW5lci5Nb2R1bGVGZWRlcmF0aW9uUGx1Z2luYCBpbiBgbGlicmFyeS5uYW1lYC5cbiAgICogQHBhcmFtIG1vZHVsZSBGdWxsIG5hbWUgd2l0aCBleHRlbnNpb24gb2YgdGhlIG1vZHVsZSB0byBpbXBvcnQgZnJvbSB0aGUgY29udGFpbmVyIC0gb25seSBtb2R1bGVzXG4gICAqIGV4cG9zZWQgaW4gYGV4cG9zZXNgIGluIGB3ZWJwYWNrLmNvbnRhaW5lci5Nb2R1bGVGZWRlcmF0aW9uUGx1Z2luYCBjYW4gYmUgdXNlZC5cbiAgICogQHBhcmFtIHNjb3BlIE9wdGlvbmFsLCBzY29wZSBmb3Igc2hhcmluZyBtb2R1bGVzIGJldHdlZW4gY29udGFpbmVycy4gRGVmYXVsdHMgdG8gYCdkZWZhdWx0J2AuXG4gICAqIEByZXR1cm5zIEV4cG9ydHMgb2YgZ2l2ZW4gYG1vZHVsZWAgZnJvbSBnaXZlbiBjb250YWluZXIuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHRzXG4gICAqIGltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbiAgICogaW1wb3J0IHsgRmVkZXJhdGVkIH0gZnJvbSAnQGNhbGxzdGFjay9yZXBhY2svY2xpZW50JztcbiAgICpcbiAgICogY29uc3QgQnV0dG9uID0gUmVhY3QubGF6eSgoKSA9PiBGZWRlcmF0ZWQuaW1wb3J0TW9kdWxlKCdteS1jb21wb25lbnRzJywgJy4vQnV0dG9uLmpzJykpO1xuICAgKlxuICAgKiBjb25zdCBteVV0aWwgPSBhd2FpdCBGZWRlcmF0ZWQuaW1wb3J0TW9kdWxlKCdteS1saWInLCAnLi9teVV0aWwuanMnKTtcbiAgICogYGBgXG4gICAqLyBmdW5jdGlvbiBpbXBvcnRNb2R1bGUoY29udGFpbmVyTmFtZSwgbW9kdWxlLCByZWYpIHtcbiAgICAgICAgdmFyIHNjb3BlID0gcmVmID09PSB2b2lkIDAgPyAnZGVmYXVsdCcgOiByZWY7XG4gICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgdmFyIF9fd2VicGFja19zaGFyZV9zY29wZXNfX19zY29wZTtcbiAgICAgICAgICAgIGlmICghKChfX3dlYnBhY2tfc2hhcmVfc2NvcGVzX19fc2NvcGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLlNbc2NvcGVdKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfc2hhcmVfc2NvcGVzX19fc2NvcGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19zaGFyZV9zY29wZXNfX19zY29wZS5fX2lzSW5pdGlhbGl6ZWQpKSB7XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZXMgdGhlIHNoYXJlIHNjb3BlLlxuICAgICAgICAgICAgICAgIC8vIFRoaXMgZmlsbHMgaXQgd2l0aCBrbm93biBwcm92aWRlZCBtb2R1bGVzIGZyb20gdGhpcyBidWlsZCBhbmQgYWxsIHJlbW90ZXMuXG4gICAgICAgICAgICAgICAgeWllbGQgX193ZWJwYWNrX3JlcXVpcmVfXy5JKHNjb3BlKTtcbiAgICAgICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLlNbc2NvcGVdLl9faXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBEbyBub3QgdXNlIGBjb25zdCBjb250YWluZXIgPSBzZWxmW2NvbnRhaW5lck5hbWVdO2AgaGVyZS4gT25jZSBjb250YWluZXIgaXMgbG9hZGVkXG4gICAgICAgICAgICAvLyBgY29udGFpbmVyYCByZWZlcmVuY2UgaXMgbm90IHVwZGF0ZWQsIHNvIGBjb250YWluZXIuX19pc0luaXRpYWxpemVkYFxuICAgICAgICAgICAgLy8gd2lsbCBjcmFzaCB0aGUgYXBwbGljYXRpb24sIGJlY2F1c2Ugb2YgcmVhZGluZyBwcm9wZXJ0eSBmcm9tIGB1bmRlZmluZWRgLlxuICAgICAgICAgICAgaWYgKCFzZWxmW2NvbnRhaW5lck5hbWVdKSB7XG4gICAgICAgICAgICAgICAgLy8gRG93bmxvYWQgYW5kIGV4ZWN1dGUgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgeWllbGQgX1NjcmlwdE1hbmFnZXIuU2NyaXB0TWFuYWdlci5zaGFyZWQubG9hZFNjcmlwdChjb250YWluZXJOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBzZWxmW2NvbnRhaW5lck5hbWVdO1xuICAgICAgICAgICAgaWYgKCFjb250YWluZXIuX19pc0luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLl9faXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgY29udGFpbmVyLCBpdCBtYXkgcHJvdmlkZSBzaGFyZWQgbW9kdWxlc1xuICAgICAgICAgICAgICAgIHlpZWxkIGNvbnRhaW5lci5pbml0KF9fd2VicGFja19yZXF1aXJlX18uU1tzY29wZV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZhY3RvcnkgPSB5aWVsZCBjb250YWluZXIuZ2V0KG1vZHVsZSk7XG4gICAgICAgICAgICB2YXIgZXhwb3J0czEgPSBmYWN0b3J5KCk7XG4gICAgICAgICAgICByZXR1cm4gZXhwb3J0czE7XG4gICAgICAgIH0pKCk7XG4gICAgfVxuICAgIF9GZWRlcmF0ZWQuaW1wb3J0TW9kdWxlID0gaW1wb3J0TW9kdWxlO1xufSkoRmVkZXJhdGVkIHx8IChGZWRlcmF0ZWQgPSB7fSkpOyAvLyMgc291cmNlTWFwcGluZ1VSTD1mZWRlcmF0ZWQuanMubWFwXG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2dldFdlYnBhY2tDb250ZXh0LmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9nZXRXZWJwYWNrQ29udGV4dC5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbi8qKlxuICogR2V0IFdlYnBhY2sgcnVudGltZSBjb250ZXh0IGZvcm0gY3VycmVudCBKYXZhU2NyaXB0IHNjb3BlLlxuICpcbiAqIF9fWW91IGxpa2VseSBkb24ndCBuZWVkIHRvIHVzZSBpdC5fX1xuICovIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZ2V0V2VicGFja0NvbnRleHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBnZXRXZWJwYWNrQ29udGV4dDtcbiAgICB9XG59KSk7XG5mdW5jdGlvbiBnZXRXZWJwYWNrQ29udGV4dCgpIHtcbiAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXztcbn0gLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2V0V2VicGFja0NvbnRleHQuanMubWFwXG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9pbmRleC5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiRmVkZXJhdGVkXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX2ZlZGVyYXRlZC5GZWRlcmF0ZWQ7XG4gICAgfVxufSkpO1xudmFyIF9leHBvcnRfc3RhciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19leHBvcnRfc3RhciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2V4cG9ydF9zdGFyLmNqc1wiKTtcbl9leHBvcnRfc3Rhci5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vU2NyaXB0TWFuYWdlci5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL1NjcmlwdE1hbmFnZXIuanNcIiksIGV4cG9ydHMpO1xuX2V4cG9ydF9zdGFyLl8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9TY3JpcHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanNcIiksIGV4cG9ydHMpO1xuX2V4cG9ydF9zdGFyLl8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi90eXBlcy5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL3R5cGVzLmpzXCIpLCBleHBvcnRzKTtcbl9leHBvcnRfc3Rhci5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZ2V0V2VicGFja0NvbnRleHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9nZXRXZWJwYWNrQ29udGV4dC5qc1wiKSwgZXhwb3J0cyk7XG52YXIgX2ZlZGVyYXRlZCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZmVkZXJhdGVkLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvZmVkZXJhdGVkLmpzXCIpO1xuIC8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci90eXBlcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvdHlwZXMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbiAvLyMgc291cmNlTWFwcGluZ1VSTD10eXBlcy5qcy5tYXBcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX0NvcmVQbHVnaW4uZGVmYXVsdDtcbiAgICB9XG59KSk7XG52YXIgX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuY2pzXCIpO1xudmFyIF9Db3JlUGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL0NvcmVQbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL0NvcmVQbHVnaW4uanNcIikpO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX1Jlc29sdmVyUGx1Z2luLmRlZmF1bHQ7XG4gICAgfVxufSkpO1xudmFyIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiKTtcbnZhciBfUmVzb2x2ZXJQbHVnaW4gPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvUmVzb2x2ZXJQbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL1Jlc29sdmVyUGx1Z2luLmpzXCIpKTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzL2Rpc3QvaW5kZXguY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgUlVOVElNRV8wMDEgPSAnUlVOVElNRS0wMDEnO1xudmFyIFJVTlRJTUVfMDAyID0gJ1JVTlRJTUUtMDAyJztcbnZhciBSVU5USU1FXzAwMyA9ICdSVU5USU1FLTAwMyc7XG52YXIgUlVOVElNRV8wMDQgPSAnUlVOVElNRS0wMDQnO1xudmFyIFJVTlRJTUVfMDA1ID0gJ1JVTlRJTUUtMDA1JztcbnZhciBSVU5USU1FXzAwNiA9ICdSVU5USU1FLTAwNic7XG52YXIgUlVOVElNRV8wMDcgPSAnUlVOVElNRS0wMDcnO1xudmFyIFJVTlRJTUVfMDA4ID0gJ1JVTlRJTUUtMDA4JztcbnZhciBUWVBFXzAwMSA9ICdUWVBFLTAwMSc7XG52YXIgQlVJTERfMDAxID0gJ0JVSUxELTAwMSc7XG52YXIgZ2V0RG9jc1VybCA9IChlcnJvckNvZGUpPT57XG4gICAgdmFyIHR5cGUgPSBlcnJvckNvZGUuc3BsaXQoJy0nKVswXS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBgaHR0cHM6Ly9tb2R1bGUtZmVkZXJhdGlvbi5pby9ndWlkZS90cm91Ymxlc2hvb3RpbmcvJHt0eXBlfS8ke2Vycm9yQ29kZX1gO1xufTtcbnZhciBnZXRTaG9ydEVycm9yTXNnID0gKGVycm9yQ29kZSwgZXJyb3JEZXNjTWFwLCBhcmdzLCBvcmlnaW5hbEVycm9yTXNnKT0+e1xuICAgIHZhciBtc2cgPSBbXG4gICAgICAgIGAke1tcbiAgICAgICAgICAgIGVycm9yRGVzY01hcFtlcnJvckNvZGVdXG4gICAgICAgIF19ICMke2Vycm9yQ29kZX1gXG4gICAgXTtcbiAgICBhcmdzICYmIG1zZy5wdXNoKGBhcmdzOiAke0pTT04uc3RyaW5naWZ5KGFyZ3MpfWApO1xuICAgIG1zZy5wdXNoKGdldERvY3NVcmwoZXJyb3JDb2RlKSk7XG4gICAgb3JpZ2luYWxFcnJvck1zZyAmJiBtc2cucHVzaChgT3JpZ2luYWwgRXJyb3IgTWVzc2FnZTpcXG4gJHtvcmlnaW5hbEVycm9yTXNnfWApO1xuICAgIHJldHVybiBtc2cuam9pbignXFxuJyk7XG59O1xuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gICAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQpIHtcbiAgICAgICAgZm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gc291cmNlKWlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbiAgICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbnZhciBydW50aW1lRGVzY01hcCA9IHtcbiAgICBbUlVOVElNRV8wMDFdOiAnRmFpbGVkIHRvIGdldCByZW1vdGVFbnRyeSBleHBvcnRzLicsXG4gICAgW1JVTlRJTUVfMDAyXTogJ1RoZSByZW1vdGUgZW50cnkgaW50ZXJmYWNlIGRvZXMgbm90IGNvbnRhaW4gXCJpbml0XCInLFxuICAgIFtSVU5USU1FXzAwM106ICdGYWlsZWQgdG8gZ2V0IG1hbmlmZXN0LicsXG4gICAgW1JVTlRJTUVfMDA0XTogJ0ZhaWxlZCB0byBsb2NhdGUgcmVtb3RlLicsXG4gICAgW1JVTlRJTUVfMDA1XTogJ0ludmFsaWQgbG9hZFNoYXJlU3luYyBmdW5jdGlvbiBjYWxsIGZyb20gYnVuZGxlciBydW50aW1lJyxcbiAgICBbUlVOVElNRV8wMDZdOiAnSW52YWxpZCBsb2FkU2hhcmVTeW5jIGZ1bmN0aW9uIGNhbGwgZnJvbSBydW50aW1lJyxcbiAgICBbUlVOVElNRV8wMDddOiAnRmFpbGVkIHRvIGdldCByZW1vdGUgc25hcHNob3QuJyxcbiAgICBbUlVOVElNRV8wMDhdOiAnRmFpbGVkIHRvIGxvYWQgc2NyaXB0IHJlc291cmNlcy4nXG59O1xudmFyIHR5cGVEZXNjTWFwID0ge1xuICAgIFtUWVBFXzAwMV06ICdGYWlsZWQgdG8gZ2VuZXJhdGUgdHlwZSBkZWNsYXJhdGlvbi4nXG59O1xudmFyIGJ1aWxkRGVzY01hcCA9IHtcbiAgICBbQlVJTERfMDAxXTogJ0ZhaWxlZCB0byBmaW5kIGV4cG9zZSBtb2R1bGUuJ1xufTtcbnZhciBlcnJvckRlc2NNYXAgPSBfZXh0ZW5kcyh7fSwgcnVudGltZURlc2NNYXAsIHR5cGVEZXNjTWFwLCBidWlsZERlc2NNYXApO1xuZXhwb3J0cy5CVUlMRF8wMDEgPSBCVUlMRF8wMDE7XG5leHBvcnRzLlJVTlRJTUVfMDAxID0gUlVOVElNRV8wMDE7XG5leHBvcnRzLlJVTlRJTUVfMDAyID0gUlVOVElNRV8wMDI7XG5leHBvcnRzLlJVTlRJTUVfMDAzID0gUlVOVElNRV8wMDM7XG5leHBvcnRzLlJVTlRJTUVfMDA0ID0gUlVOVElNRV8wMDQ7XG5leHBvcnRzLlJVTlRJTUVfMDA1ID0gUlVOVElNRV8wMDU7XG5leHBvcnRzLlJVTlRJTUVfMDA2ID0gUlVOVElNRV8wMDY7XG5leHBvcnRzLlJVTlRJTUVfMDA3ID0gUlVOVElNRV8wMDc7XG5leHBvcnRzLlJVTlRJTUVfMDA4ID0gUlVOVElNRV8wMDg7XG5leHBvcnRzLlRZUEVfMDAxID0gVFlQRV8wMDE7XG5leHBvcnRzLmJ1aWxkRGVzY01hcCA9IGJ1aWxkRGVzY01hcDtcbmV4cG9ydHMuZXJyb3JEZXNjTWFwID0gZXJyb3JEZXNjTWFwO1xuZXhwb3J0cy5nZXRTaG9ydEVycm9yTXNnID0gZ2V0U2hvcnRFcnJvck1zZztcbmV4cG9ydHMucnVudGltZURlc2NNYXAgPSBydW50aW1lRGVzY01hcDtcbmV4cG9ydHMudHlwZURlc2NNYXAgPSB0eXBlRGVzY01hcDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L2luZGV4LmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIF9jYWxsX3N1cGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NhbGxfc3VwZXIgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jYWxsX3N1cGVyLmNqc1wiKTtcbnZhciBfY2xhc3NfY2FsbF9jaGVjayA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jbGFzc19jYWxsX2NoZWNrICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janNcIik7XG52YXIgX2NyZWF0ZV9jbGFzcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jcmVhdGVfY2xhc3MgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzXCIpO1xudmFyIF9pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbmhlcml0cyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2luaGVyaXRzLmNqc1wiKTtcbnZhciBfc2xpY2VkX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3NsaWNlZF90b19hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janNcIik7XG52YXIgX3RvX2NvbnN1bWFibGVfYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fdG9fY29uc3VtYWJsZV9hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzXCIpO1xudmFyIF90eXBlX29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3R5cGVfb2YgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190eXBlX29mLmNqc1wiKTtcbnZhciBwb2x5ZmlsbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3BvbHlmaWxscy5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvcG9seWZpbGxzLmNqcy5qc1wiKTtcbnZhciBzZGsgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAbW9kdWxlLWZlZGVyYXRpb24vc2RrICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbnZhciBlcnJvckNvZGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzL2Rpc3QvaW5kZXguY2pzLmpzXCIpO1xudmFyIExPR19DQVRFR09SWSA9ICdbIEZlZGVyYXRpb24gUnVudGltZSBdJztcbi8vIEZJWE1FOiBwcmUtYnVuZGxlID9cbnZhciBsb2dnZXIgPSBzZGsuY3JlYXRlTG9nZ2VyKExPR19DQVRFR09SWSk7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xuZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgbXNnKSB7XG4gICAgaWYgKCFjb25kaXRpb24pIHtcbiAgICAgICAgZXJyb3IobXNnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBlcnJvcihtc2cpIHtcbiAgICBpZiAobXNnIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgbXNnLm1lc3NhZ2UgPSBgJHtMT0dfQ0FURUdPUll9OiAke21zZy5tZXNzYWdlfWA7XG4gICAgICAgIHRocm93IG1zZztcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGAke0xPR19DQVRFR09SWX06ICR7bXNnfWApO1xufVxuZnVuY3Rpb24gd2Fybihtc2cpIHtcbiAgICBpZiAobXNnIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgbXNnLm1lc3NhZ2UgPSBgJHtMT0dfQ0FURUdPUll9OiAke21zZy5tZXNzYWdlfWA7XG4gICAgICAgIGxvZ2dlci53YXJuKG1zZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbG9nZ2VyLndhcm4obXNnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhZGRVbmlxdWVJdGVtKGFyciwgaXRlbSkge1xuICAgIGlmIChhcnIuZmluZEluZGV4KChuYW1lMSk9Pm5hbWUxID09PSBpdGVtKSA9PT0gLTEpIHtcbiAgICAgICAgYXJyLnB1c2goaXRlbSk7XG4gICAgfVxuICAgIHJldHVybiBhcnI7XG59XG5mdW5jdGlvbiBnZXRGTUlkKHJlbW90ZUluZm8pIHtcbiAgICBpZiAoJ3ZlcnNpb24nIGluIHJlbW90ZUluZm8gJiYgcmVtb3RlSW5mby52ZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiBgJHtyZW1vdGVJbmZvLm5hbWV9OiR7cmVtb3RlSW5mby52ZXJzaW9ufWA7XG4gICAgfSBlbHNlIGlmICgnZW50cnknIGluIHJlbW90ZUluZm8gJiYgcmVtb3RlSW5mby5lbnRyeSkge1xuICAgICAgICByZXR1cm4gYCR7cmVtb3RlSW5mby5uYW1lfToke3JlbW90ZUluZm8uZW50cnl9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYCR7cmVtb3RlSW5mby5uYW1lfWA7XG4gICAgfVxufVxuZnVuY3Rpb24gaXNSZW1vdGVJbmZvV2l0aEVudHJ5KHJlbW90ZSkge1xuICAgIHJldHVybiB0eXBlb2YgcmVtb3RlLmVudHJ5ICE9PSAndW5kZWZpbmVkJztcbn1cbmZ1bmN0aW9uIGlzUHVyZVJlbW90ZUVudHJ5KHJlbW90ZSkge1xuICAgIHJldHVybiAhcmVtb3RlLmVudHJ5LmluY2x1ZGVzKCcuanNvbicpICYmIHJlbW90ZS5lbnRyeS5pbmNsdWRlcygnLmpzJyk7XG59XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZnVuY3Rpb24gc2FmZVdyYXBwZXIoY2FsbGJhY2ssIGRpc2FibGVXYXJuKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgcmVzID0geWllbGQgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICFkaXNhYmxlV2FybiAmJiB3YXJuKGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSkoKTtcbn1cbmZ1bmN0aW9uIGlzT2JqZWN0KHZhbCkge1xuICAgIHJldHVybiB2YWwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCc7XG59XG52YXIgb2JqZWN0VG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcbmZ1bmN0aW9uIGlzUGxhaW5PYmplY3QodmFsKSB7XG4gICAgcmV0dXJuIG9iamVjdFRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgT2JqZWN0XSc7XG59XG5mdW5jdGlvbiBpc1N0YXRpY1Jlc291cmNlc0VxdWFsKHVybDEsIHVybDIpIHtcbiAgICB2YXIgUkVHX0VYUCA9IC9eKGh0dHBzPzopP1xcL1xcLy9pO1xuICAgIC8vIFRyYW5zZm9ybSB1cmwxIGFuZCB1cmwyIGludG8gcmVsYXRpdmUgcGF0aHNcbiAgICB2YXIgcmVsYXRpdmVVcmwxID0gdXJsMS5yZXBsYWNlKFJFR19FWFAsICcnKS5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgIHZhciByZWxhdGl2ZVVybDIgPSB1cmwyLnJlcGxhY2UoUkVHX0VYUCwgJycpLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gICAgLy8gQ2hlY2sgaWYgdGhlIHJlbGF0aXZlIHBhdGhzIGFyZSBpZGVudGljYWxcbiAgICByZXR1cm4gcmVsYXRpdmVVcmwxID09PSByZWxhdGl2ZVVybDI7XG59XG5mdW5jdGlvbiBhcnJheU9wdGlvbnMob3B0aW9ucykge1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KG9wdGlvbnMpID8gb3B0aW9ucyA6IFtcbiAgICAgICAgb3B0aW9uc1xuICAgIF07XG59XG5mdW5jdGlvbiBnZXRSZW1vdGVFbnRyeUluZm9Gcm9tU25hcHNob3Qoc25hcHNob3QpIHtcbiAgICB2YXIgZGVmYXVsdFJlbW90ZUVudHJ5SW5mbyA9IHtcbiAgICAgICAgdXJsOiAnJyxcbiAgICAgICAgdHlwZTogJ2dsb2JhbCcsXG4gICAgICAgIGdsb2JhbE5hbWU6ICcnXG4gICAgfTtcbiAgICBpZiAoc2RrLmlzQnJvd3NlckVudigpKSB7XG4gICAgICAgIHJldHVybiAncmVtb3RlRW50cnknIGluIHNuYXBzaG90ID8ge1xuICAgICAgICAgICAgdXJsOiBzbmFwc2hvdC5yZW1vdGVFbnRyeSxcbiAgICAgICAgICAgIHR5cGU6IHNuYXBzaG90LnJlbW90ZUVudHJ5VHlwZSxcbiAgICAgICAgICAgIGdsb2JhbE5hbWU6IHNuYXBzaG90Lmdsb2JhbE5hbWVcbiAgICAgICAgfSA6IGRlZmF1bHRSZW1vdGVFbnRyeUluZm87XG4gICAgfVxuICAgIGlmICgnc3NyUmVtb3RlRW50cnknIGluIHNuYXBzaG90KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cmw6IHNuYXBzaG90LnNzclJlbW90ZUVudHJ5IHx8IGRlZmF1bHRSZW1vdGVFbnRyeUluZm8udXJsLFxuICAgICAgICAgICAgdHlwZTogc25hcHNob3Quc3NyUmVtb3RlRW50cnlUeXBlIHx8IGRlZmF1bHRSZW1vdGVFbnRyeUluZm8udHlwZSxcbiAgICAgICAgICAgIGdsb2JhbE5hbWU6IHNuYXBzaG90Lmdsb2JhbE5hbWVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmF1bHRSZW1vdGVFbnRyeUluZm87XG59XG52YXIgcHJvY2Vzc01vZHVsZUFsaWFzID0gKG5hbWUxLCBzdWJQYXRoKT0+e1xuICAgIC8vIEBob3N0LyAuL2J1dHRvbiAtPiBAaG9zdC9idXR0b25cbiAgICB2YXIgbW9kdWxlTmFtZTtcbiAgICBpZiAobmFtZTEuZW5kc1dpdGgoJy8nKSkge1xuICAgICAgICBtb2R1bGVOYW1lID0gbmFtZTEuc2xpY2UoMCwgLTEpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZHVsZU5hbWUgPSBuYW1lMTtcbiAgICB9XG4gICAgaWYgKHN1YlBhdGguc3RhcnRzV2l0aCgnLicpKSB7XG4gICAgICAgIHN1YlBhdGggPSBzdWJQYXRoLnNsaWNlKDEpO1xuICAgIH1cbiAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZSArIHN1YlBhdGg7XG4gICAgcmV0dXJuIG1vZHVsZU5hbWU7XG59O1xudmFyIEN1cnJlbnRHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcgPyBnbG9iYWxUaGlzIDogd2luZG93O1xudmFyIG5hdGl2ZUdsb2JhbCA9ICgoKT0+e1xuICAgIHRyeSB7XG4gICAgICAgIC8vIGdldCByZWFsIHdpbmRvdyAoaW5jYXNlIG9mIHNhbmRib3gpXG4gICAgICAgIHJldHVybiBkb2N1bWVudC5kZWZhdWx0VmlldztcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIG5vZGUgZW52XG4gICAgICAgIHJldHVybiBDdXJyZW50R2xvYmFsO1xuICAgIH1cbn0pKCk7XG52YXIgR2xvYmFsID0gbmF0aXZlR2xvYmFsO1xuZnVuY3Rpb24gZGVmaW5lUHJvcGVydHlHbG9iYWxWYWwodGFyZ2V0LCBrZXksIHZhbCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwge1xuICAgICAgICB2YWx1ZTogdmFsLFxuICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xufVxuZnVuY3Rpb24gaW5jbHVkZU93blByb3BlcnR5KHRhcmdldCwga2V5KSB7XG4gICAgcmV0dXJuIE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRhcmdldCwga2V5KTtcbn1cbi8vIFRoaXMgc2VjdGlvbiBpcyB0byBwcmV2ZW50IGVuY2Fwc3VsYXRpb24gYnkgY2VydGFpbiBtaWNyb2Zyb250ZW5kIGZyYW1ld29ya3MuIER1ZSB0byByZXVzZSBwb2xpY2llcywgc2FuZGJveCBlc2NhcGVzLlxuLy8gVGhlIHNhbmRib3ggaW4gdGhlIG1pY3JvZnJvbnRlbmQgZG9lcyBub3QgcmVwbGljYXRlIHRoZSB2YWx1ZSBvZiAnY29uZmlndXJhYmxlJy5cbi8vIElmIHRoZXJlIGlzIG5vIGxvYWRpbmcgY29udGVudCBvbiB0aGUgZ2xvYmFsIG9iamVjdCwgdGhpcyBzZWN0aW9uIGRlZmluZXMgdGhlIGxvYWRpbmcgb2JqZWN0LlxuaWYgKCFpbmNsdWRlT3duUHJvcGVydHkoQ3VycmVudEdsb2JhbCwgJ19fR0xPQkFMX0xPQURJTkdfUkVNT1RFX0VOVFJZX18nKSkge1xuICAgIGRlZmluZVByb3BlcnR5R2xvYmFsVmFsKEN1cnJlbnRHbG9iYWwsICdfX0dMT0JBTF9MT0FESU5HX1JFTU9URV9FTlRSWV9fJywge30pO1xufVxudmFyIGdsb2JhbExvYWRpbmcgPSBDdXJyZW50R2xvYmFsLl9fR0xPQkFMX0xPQURJTkdfUkVNT1RFX0VOVFJZX187XG5mdW5jdGlvbiBzZXRHbG9iYWxEZWZhdWx0VmFsKHRhcmdldCkge1xuICAgIHZhciBfdGFyZ2V0X19fRkVERVJBVElPTl9fLCBfdGFyZ2V0X19fRkVERVJBVElPTl9fMSwgX3RhcmdldF9fX0ZFREVSQVRJT05fXzIsIF90YXJnZXRfX19GRURFUkFUSU9OX18zLCBfdGFyZ2V0X19fRkVERVJBVElPTl9fNCwgX3RhcmdldF9fX0ZFREVSQVRJT05fXzU7XG4gICAgaWYgKGluY2x1ZGVPd25Qcm9wZXJ0eSh0YXJnZXQsICdfX1ZNT0tfXycpICYmICFpbmNsdWRlT3duUHJvcGVydHkodGFyZ2V0LCAnX19GRURFUkFUSU9OX18nKSkge1xuICAgICAgICBkZWZpbmVQcm9wZXJ0eUdsb2JhbFZhbCh0YXJnZXQsICdfX0ZFREVSQVRJT05fXycsIHRhcmdldC5fX1ZNT0tfXyk7XG4gICAgfVxuICAgIGlmICghaW5jbHVkZU93blByb3BlcnR5KHRhcmdldCwgJ19fRkVERVJBVElPTl9fJykpIHtcbiAgICAgICAgZGVmaW5lUHJvcGVydHlHbG9iYWxWYWwodGFyZ2V0LCAnX19GRURFUkFUSU9OX18nLCB7XG4gICAgICAgICAgICBfX0dMT0JBTF9QTFVHSU5fXzogW10sXG4gICAgICAgICAgICBfX0lOU1RBTkNFU19fOiBbXSxcbiAgICAgICAgICAgIG1vZHVsZUluZm86IHt9LFxuICAgICAgICAgICAgX19TSEFSRV9fOiB7fSxcbiAgICAgICAgICAgIF9fTUFOSUZFU1RfTE9BRElOR19fOiB7fSxcbiAgICAgICAgICAgIF9fUFJFTE9BREVEX01BUF9fOiBuZXcgTWFwKClcbiAgICAgICAgfSk7XG4gICAgICAgIGRlZmluZVByb3BlcnR5R2xvYmFsVmFsKHRhcmdldCwgJ19fVk1PS19fJywgdGFyZ2V0Ll9fRkVERVJBVElPTl9fKTtcbiAgICB9XG4gICAgdmFyIF9fX0dMT0JBTF9QTFVHSU5fXztcbiAgICAoX19fR0xPQkFMX1BMVUdJTl9fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX18gPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fR0xPQkFMX1BMVUdJTl9fKSAhPSBudWxsID8gX19fR0xPQkFMX1BMVUdJTl9fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXyA9IFtdO1xuICAgIHZhciBfX19JTlNUQU5DRVNfXztcbiAgICAoX19fSU5TVEFOQ0VTX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzEgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fSU5TVEFOQ0VTX18pICE9IG51bGwgPyBfX19JTlNUQU5DRVNfXyA6IF90YXJnZXRfX19GRURFUkFUSU9OX18xLl9fSU5TVEFOQ0VTX18gPSBbXTtcbiAgICB2YXIgX21vZHVsZUluZm87XG4gICAgKF9tb2R1bGVJbmZvID0gKF90YXJnZXRfX19GRURFUkFUSU9OX18yID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5tb2R1bGVJbmZvKSAhPSBudWxsID8gX21vZHVsZUluZm8gOiBfdGFyZ2V0X19fRkVERVJBVElPTl9fMi5tb2R1bGVJbmZvID0ge307XG4gICAgdmFyIF9fX1NIQVJFX187XG4gICAgKF9fX1NIQVJFX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzMgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fU0hBUkVfXykgIT0gbnVsbCA/IF9fX1NIQVJFX18gOiBfdGFyZ2V0X19fRkVERVJBVElPTl9fMy5fX1NIQVJFX18gPSB7fTtcbiAgICB2YXIgX19fTUFOSUZFU1RfTE9BRElOR19fO1xuICAgIChfX19NQU5JRkVTVF9MT0FESU5HX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzQgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fTUFOSUZFU1RfTE9BRElOR19fKSAhPSBudWxsID8gX19fTUFOSUZFU1RfTE9BRElOR19fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXzQuX19NQU5JRkVTVF9MT0FESU5HX18gPSB7fTtcbiAgICB2YXIgX19fUFJFTE9BREVEX01BUF9fO1xuICAgIChfX19QUkVMT0FERURfTUFQX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzUgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fUFJFTE9BREVEX01BUF9fKSAhPSBudWxsID8gX19fUFJFTE9BREVEX01BUF9fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXzUuX19QUkVMT0FERURfTUFQX18gPSBuZXcgTWFwKCk7XG59XG5zZXRHbG9iYWxEZWZhdWx0VmFsKEN1cnJlbnRHbG9iYWwpO1xuc2V0R2xvYmFsRGVmYXVsdFZhbChuYXRpdmVHbG9iYWwpO1xuZnVuY3Rpb24gcmVzZXRGZWRlcmF0aW9uR2xvYmFsSW5mbygpIHtcbiAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fR0xPQkFMX1BMVUdJTl9fID0gW107XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0lOU1RBTkNFU19fID0gW107XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvID0ge307XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1NIQVJFX18gPSB7fTtcbiAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fTUFOSUZFU1RfTE9BRElOR19fID0ge307XG4gICAgT2JqZWN0LmtleXMoZ2xvYmFsTG9hZGluZykuZm9yRWFjaCgoa2V5KT0+e1xuICAgICAgICBkZWxldGUgZ2xvYmFsTG9hZGluZ1trZXldO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlKEZlZGVyYXRpb25JbnN0YW5jZSkge1xuICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19JTlNUQU5DRVNfXy5wdXNoKEZlZGVyYXRpb25JbnN0YW5jZSk7XG59XG5mdW5jdGlvbiBnZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IoKSB7XG4gICAgcmV0dXJuIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19ERUJVR19DT05TVFJVQ1RPUl9fO1xufVxuZnVuY3Rpb24gc2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yKEZlZGVyYXRpb25Db25zdHJ1Y3RvciwgcmVmKSB7XG4gICAgdmFyIGlzRGVidWcgPSByZWYgPT09IHZvaWQgMCA/IHNkay5pc0RlYnVnTW9kZSgpIDogcmVmO1xuICAgIGlmIChpc0RlYnVnKSB7XG4gICAgICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19ERUJVR19DT05TVFJVQ1RPUl9fID0gRmVkZXJhdGlvbkNvbnN0cnVjdG9yO1xuICAgICAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fREVCVUdfQ09OU1RSVUNUT1JfVkVSU0lPTl9fID0gXCIwLjEwLjBcIjtcbiAgICB9XG59XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xuZnVuY3Rpb24gZ2V0SW5mb1dpdGhvdXRUeXBlKHRhcmdldCwga2V5KSB7XG4gICAgaWYgKHR5cGVvZiBrZXkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHZhciBrZXlSZXMgPSB0YXJnZXRba2V5XTtcbiAgICAgICAgaWYgKGtleVJlcykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGFyZ2V0W2tleV0sXG4gICAgICAgICAgICAgICAga2V5OiBrZXlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0S2V5cyA9IE9iamVjdC5rZXlzKHRhcmdldCk7XG4gICAgICAgICAgICBmb3IgKHZhciB0YXJnZXRLZXkgb2YgdGFyZ2V0S2V5cyl7XG4gICAgICAgICAgICAgICAgdmFyIF90YXJnZXRLZXlfc3BsaXQgPSBfc2xpY2VkX3RvX2FycmF5Ll8odGFyZ2V0S2V5LnNwbGl0KCc6JyksIDIpLCB0YXJnZXRUeXBlT3JOYW1lID0gX3RhcmdldEtleV9zcGxpdFswXSwgXyA9IF90YXJnZXRLZXlfc3BsaXRbMV07XG4gICAgICAgICAgICAgICAgdmFyIG5LZXkgPSBgJHt0YXJnZXRUeXBlT3JOYW1lfToke2tleX1gO1xuICAgICAgICAgICAgICAgIHZhciB0eXBlV2l0aEtleVJlcyA9IHRhcmdldFtuS2V5XTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZVdpdGhLZXlSZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0eXBlV2l0aEtleVJlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTogbktleVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBrZXk6IGtleVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigna2V5IG11c3QgYmUgc3RyaW5nJyk7XG4gICAgfVxufVxudmFyIGdldEdsb2JhbFNuYXBzaG90ID0gKCk9Pm5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvO1xudmFyIGdldFRhcmdldFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyA9IChtb2R1bGVJbmZvLCBzbmFwc2hvdCk9PntcbiAgICAvLyBDaGVjayBpZiB0aGUgcmVtb3RlIGlzIGluY2x1ZGVkIGluIHRoZSBob3N0U25hcHNob3RcbiAgICB2YXIgbW9kdWxlS2V5ID0gZ2V0Rk1JZChtb2R1bGVJbmZvKTtcbiAgICB2YXIgZ2V0TW9kdWxlSW5mbyA9IGdldEluZm9XaXRob3V0VHlwZShzbmFwc2hvdCwgbW9kdWxlS2V5KS52YWx1ZTtcbiAgICAvLyBUaGUgcmVtb3RlU25hcHNob3QgbWlnaHQgbm90IGluY2x1ZGUgYSB2ZXJzaW9uXG4gICAgaWYgKGdldE1vZHVsZUluZm8gJiYgIWdldE1vZHVsZUluZm8udmVyc2lvbiAmJiAndmVyc2lvbicgaW4gbW9kdWxlSW5mbyAmJiBtb2R1bGVJbmZvWyd2ZXJzaW9uJ10pIHtcbiAgICAgICAgZ2V0TW9kdWxlSW5mby52ZXJzaW9uID0gbW9kdWxlSW5mb1sndmVyc2lvbiddO1xuICAgIH1cbiAgICBpZiAoZ2V0TW9kdWxlSW5mbykge1xuICAgICAgICByZXR1cm4gZ2V0TW9kdWxlSW5mbztcbiAgICB9XG4gICAgLy8gSWYgdGhlIHJlbW90ZSBpcyBub3QgaW5jbHVkZWQgaW4gdGhlIGhvc3RTbmFwc2hvdCwgZGVwbG95IGEgbWljcm8gYXBwIHNuYXBzaG90XG4gICAgaWYgKCd2ZXJzaW9uJyBpbiBtb2R1bGVJbmZvICYmIG1vZHVsZUluZm9bJ3ZlcnNpb24nXSkge1xuICAgICAgICB2YXIgdmVyc2lvbiA9IG1vZHVsZUluZm8udmVyc2lvbiwgcmVzTW9kdWxlSW5mbyA9IHBvbHlmaWxscy5fb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllc19sb29zZShtb2R1bGVJbmZvLCBbXG4gICAgICAgICAgICBcInZlcnNpb25cIlxuICAgICAgICBdKTtcbiAgICAgICAgdmFyIG1vZHVsZUtleVdpdGhvdXRWZXJzaW9uID0gZ2V0Rk1JZChyZXNNb2R1bGVJbmZvKTtcbiAgICAgICAgdmFyIGdldE1vZHVsZUluZm9XaXRob3V0VmVyc2lvbiA9IGdldEluZm9XaXRob3V0VHlwZShuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbywgbW9kdWxlS2V5V2l0aG91dFZlcnNpb24pLnZhbHVlO1xuICAgICAgICBpZiAoKGdldE1vZHVsZUluZm9XaXRob3V0VmVyc2lvbiA9PSBudWxsID8gdm9pZCAwIDogZ2V0TW9kdWxlSW5mb1dpdGhvdXRWZXJzaW9uLnZlcnNpb24pID09PSB2ZXJzaW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0TW9kdWxlSW5mb1dpdGhvdXRWZXJzaW9uO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybjtcbn07XG52YXIgZ2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvID0gKG1vZHVsZUluZm8pPT5nZXRUYXJnZXRTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8obW9kdWxlSW5mbywgbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm8pO1xudmFyIHNldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyA9IChyZW1vdGVJbmZvLCBtb2R1bGVEZXRhaWxJbmZvKT0+e1xuICAgIHZhciBtb2R1bGVLZXkgPSBnZXRGTUlkKHJlbW90ZUluZm8pO1xuICAgIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvW21vZHVsZUtleV0gPSBtb2R1bGVEZXRhaWxJbmZvO1xuICAgIHJldHVybiBuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbztcbn07XG52YXIgYWRkR2xvYmFsU25hcHNob3QgPSAobW9kdWxlSW5mb3MpPT57XG4gICAgbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm8gPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvLCBtb2R1bGVJbmZvcyk7XG4gICAgcmV0dXJuICgpPT57XG4gICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMobW9kdWxlSW5mb3MpO1xuICAgICAgICBmb3IgKHZhciBrZXkgb2Yga2V5cyl7XG4gICAgICAgICAgICBkZWxldGUgbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm9ba2V5XTtcbiAgICAgICAgfVxuICAgIH07XG59O1xudmFyIGdldFJlbW90ZUVudHJ5RXhwb3J0cyA9IChuYW1lMSwgZ2xvYmFsTmFtZSk9PntcbiAgICB2YXIgcmVtb3RlRW50cnlLZXkgPSBnbG9iYWxOYW1lIHx8IGBfX0ZFREVSQVRJT05fJHtuYW1lMX06Y3VzdG9tX19gO1xuICAgIHZhciBlbnRyeUV4cG9ydHMgPSBDdXJyZW50R2xvYmFsW3JlbW90ZUVudHJ5S2V5XTtcbiAgICByZXR1cm4ge1xuICAgICAgICByZW1vdGVFbnRyeUtleSxcbiAgICAgICAgZW50cnlFeHBvcnRzXG4gICAgfTtcbn07XG4vLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVnaXN0ZXIgZ2xvYmFsIHBsdWdpbnMuXG4vLyBJdCBpdGVyYXRlcyBvdmVyIHRoZSBwcm92aWRlZCBwbHVnaW5zIGFuZCBjaGVja3MgaWYgdGhleSBhcmUgYWxyZWFkeSByZWdpc3RlcmVkLlxuLy8gSWYgYSBwbHVnaW4gaXMgbm90IHJlZ2lzdGVyZWQsIGl0IGlzIGFkZGVkIHRvIHRoZSBnbG9iYWwgcGx1Z2lucy5cbi8vIElmIGEgcGx1Z2luIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCwgYSB3YXJuaW5nIG1lc3NhZ2UgaXMgbG9nZ2VkLlxudmFyIHJlZ2lzdGVyR2xvYmFsUGx1Z2lucyA9IChwbHVnaW5zKT0+e1xuICAgIHZhciBfX0dMT0JBTF9QTFVHSU5fXyA9IG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXztcbiAgICBwbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgaWYgKF9fR0xPQkFMX1BMVUdJTl9fLmZpbmRJbmRleCgocCk9PnAubmFtZSA9PT0gcGx1Z2luLm5hbWUpID09PSAtMSkge1xuICAgICAgICAgICAgX19HTE9CQUxfUExVR0lOX18ucHVzaChwbHVnaW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgd2FybihgVGhlIHBsdWdpbiAke3BsdWdpbi5uYW1lfSBoYXMgYmVlbiByZWdpc3RlcmVkLmApO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xudmFyIGdldEdsb2JhbEhvc3RQbHVnaW5zID0gKCk9Pm5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXztcbnZhciBnZXRQcmVsb2FkZWQgPSAoaWQpPT5DdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fUFJFTE9BREVEX01BUF9fLmdldChpZCk7XG52YXIgc2V0UHJlbG9hZGVkID0gKGlkKT0+Q3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1BSRUxPQURFRF9NQVBfXy5zZXQoaWQsIHRydWUpO1xudmFyIERFRkFVTFRfU0NPUEUgPSAnZGVmYXVsdCc7XG52YXIgREVGQVVMVF9SRU1PVEVfVFlQRSA9ICdnbG9iYWwnO1xuLy8gZm9yayBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9vcmlnaW5qcy92aXRlLXBsdWdpbi1mZWRlcmF0aW9uL2Jsb2IvdjEuMS4xMi9wYWNrYWdlcy9saWIvc3JjL3V0aWxzL3NlbXZlci9pbmRleC50c1xuLy8gdGhvc2UgY29uc3RhbnRzIGFyZSBiYXNlZCBvbiBodHRwczovL3d3dy5ydWJ5ZG9jLmluZm8vZ2Vtcy9zZW1hbnRpY19yYW5nZS8zLjAuMC9TZW1hbnRpY1JhbmdlI0JVSUxESURFTlRJRklFUi1jb25zdGFudFxuLy8gQ29weXJpZ2h0IChjKVxuLy8gdml0ZS1wbHVnaW4tZmVkZXJhdGlvbiBpcyBsaWNlbnNlZCB1bmRlciBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgY2FuIHVzZSB0aGlzIHNvZnR3YXJlIGFjY29yZGluZyB0byB0aGUgdGVybXMgYW5kIGNvbmRpdGlvbnMgb2YgdGhlIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiBNdWxhbiBQU0wgdjIgYXQ6XG4vLyAgICAgIGh0dHA6Ly9saWNlbnNlLmNvc2NsLm9yZy5jbi9NdWxhblBTTDJcbi8vIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgT04gQU4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT0YgQU5ZIEtJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gTk9OLUlORlJJTkdFTUVOVCwgTUVSQ0hBTlRBQklMSVRZIE9SIEZJVCBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuXG4vLyBTZWUgdGhlIE11bGFuIFBTTCB2MiBmb3IgbW9yZSBkZXRhaWxzLlxudmFyIGJ1aWxkSWRlbnRpZmllciA9ICdbMC05QS1aYS16LV0rJztcbnZhciBidWlsZCA9IGAoPzpcXFxcKygke2J1aWxkSWRlbnRpZmllcn0oPzpcXFxcLiR7YnVpbGRJZGVudGlmaWVyfSkqKSlgO1xudmFyIG51bWVyaWNJZGVudGlmaWVyID0gJzB8WzEtOV1cXFxcZConO1xudmFyIG51bWVyaWNJZGVudGlmaWVyTG9vc2UgPSAnWzAtOV0rJztcbnZhciBub25OdW1lcmljSWRlbnRpZmllciA9ICdcXFxcZCpbYS16QS1aLV1bYS16QS1aMC05LV0qJztcbnZhciBwcmVSZWxlYXNlSWRlbnRpZmllckxvb3NlID0gYCg/OiR7bnVtZXJpY0lkZW50aWZpZXJMb29zZX18JHtub25OdW1lcmljSWRlbnRpZmllcn0pYDtcbnZhciBwcmVSZWxlYXNlTG9vc2UgPSBgKD86LT8oJHtwcmVSZWxlYXNlSWRlbnRpZmllckxvb3NlfSg/OlxcXFwuJHtwcmVSZWxlYXNlSWRlbnRpZmllckxvb3NlfSkqKSlgO1xudmFyIHByZVJlbGVhc2VJZGVudGlmaWVyID0gYCg/OiR7bnVtZXJpY0lkZW50aWZpZXJ9fCR7bm9uTnVtZXJpY0lkZW50aWZpZXJ9KWA7XG52YXIgcHJlUmVsZWFzZSA9IGAoPzotKCR7cHJlUmVsZWFzZUlkZW50aWZpZXJ9KD86XFxcXC4ke3ByZVJlbGVhc2VJZGVudGlmaWVyfSkqKSlgO1xudmFyIHhSYW5nZUlkZW50aWZpZXIgPSBgJHtudW1lcmljSWRlbnRpZmllcn18eHxYfFxcXFwqYDtcbnZhciB4UmFuZ2VQbGFpbiA9IGBbdj1cXFxcc10qKCR7eFJhbmdlSWRlbnRpZmllcn0pKD86XFxcXC4oJHt4UmFuZ2VJZGVudGlmaWVyfSkoPzpcXFxcLigke3hSYW5nZUlkZW50aWZpZXJ9KSg/OiR7cHJlUmVsZWFzZX0pPyR7YnVpbGR9Pyk/KT9gO1xudmFyIGh5cGhlblJhbmdlID0gYF5cXFxccyooJHt4UmFuZ2VQbGFpbn0pXFxcXHMrLVxcXFxzKygke3hSYW5nZVBsYWlufSlcXFxccyokYDtcbnZhciBtYWluVmVyc2lvbkxvb3NlID0gYCgke251bWVyaWNJZGVudGlmaWVyTG9vc2V9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJMb29zZX0pXFxcXC4oJHtudW1lcmljSWRlbnRpZmllckxvb3NlfSlgO1xudmFyIGxvb3NlUGxhaW4gPSBgW3Y9XFxcXHNdKiR7bWFpblZlcnNpb25Mb29zZX0ke3ByZVJlbGVhc2VMb29zZX0/JHtidWlsZH0/YDtcbnZhciBndGx0ID0gJygoPzo8fD4pPz0/KSc7XG52YXIgY29tcGFyYXRvclRyaW0gPSBgKFxcXFxzKikke2d0bHR9XFxcXHMqKCR7bG9vc2VQbGFpbn18JHt4UmFuZ2VQbGFpbn0pYDtcbnZhciBsb25lVGlsZGUgPSAnKD86fj4/KSc7XG52YXIgdGlsZGVUcmltID0gYChcXFxccyopJHtsb25lVGlsZGV9XFxcXHMrYDtcbnZhciBsb25lQ2FyZXQgPSAnKD86XFxcXF4pJztcbnZhciBjYXJldFRyaW0gPSBgKFxcXFxzKikke2xvbmVDYXJldH1cXFxccytgO1xudmFyIHN0YXIgPSAnKDx8Pik/PT9cXFxccypcXFxcKic7XG52YXIgY2FyZXQgPSBgXiR7bG9uZUNhcmV0fSR7eFJhbmdlUGxhaW59JGA7XG52YXIgbWFpblZlcnNpb24gPSBgKCR7bnVtZXJpY0lkZW50aWZpZXJ9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJ9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJ9KWA7XG52YXIgZnVsbFBsYWluID0gYHY/JHttYWluVmVyc2lvbn0ke3ByZVJlbGVhc2V9PyR7YnVpbGR9P2A7XG52YXIgdGlsZGUgPSBgXiR7bG9uZVRpbGRlfSR7eFJhbmdlUGxhaW59JGA7XG52YXIgeFJhbmdlID0gYF4ke2d0bHR9XFxcXHMqJHt4UmFuZ2VQbGFpbn0kYDtcbnZhciBjb21wYXJhdG9yID0gYF4ke2d0bHR9XFxcXHMqKCR7ZnVsbFBsYWlufSkkfF4kYDtcbi8vIGNvcHkgZnJvbSBzZW12ZXIgcGFja2FnZVxudmFyIGd0ZTAgPSAnXlxcXFxzKj49XFxcXHMqMC4wLjBcXFxccyokJztcbi8vIGZvcmsgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vb3JpZ2luanMvdml0ZS1wbHVnaW4tZmVkZXJhdGlvbi9ibG9iL3YxLjEuMTIvcGFja2FnZXMvbGliL3NyYy91dGlscy9zZW12ZXIvaW5kZXgudHNcbi8vIENvcHlyaWdodCAoYylcbi8vIHZpdGUtcGx1Z2luLWZlZGVyYXRpb24gaXMgbGljZW5zZWQgdW5kZXIgTXVsYW4gUFNMIHYyLlxuLy8gWW91IGNhbiB1c2UgdGhpcyBzb2Z0d2FyZSBhY2NvcmRpbmcgdG8gdGhlIHRlcm1zIGFuZCBjb25kaXRpb25zIG9mIHRoZSBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgTXVsYW4gUFNMIHYyIGF0OlxuLy8gICAgICBodHRwOi8vbGljZW5zZS5jb3NjbC5vcmcuY24vTXVsYW5QU0wyXG4vLyBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIE9OIEFOIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9GIEFOWSBLSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIE5PTi1JTkZSSU5HRU1FTlQsIE1FUkNIQU5UQUJJTElUWSBPUiBGSVQgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLlxuLy8gU2VlIHRoZSBNdWxhbiBQU0wgdjIgZm9yIG1vcmUgZGV0YWlscy5cbmZ1bmN0aW9uIHBhcnNlUmVnZXgoc291cmNlKSB7XG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoc291cmNlKTtcbn1cbmZ1bmN0aW9uIGlzWFZlcnNpb24odmVyc2lvbikge1xuICAgIHJldHVybiAhdmVyc2lvbiB8fCB2ZXJzaW9uLnRvTG93ZXJDYXNlKCkgPT09ICd4JyB8fCB2ZXJzaW9uID09PSAnKic7XG59XG5mdW5jdGlvbiBwaXBlKC4uLmZucykge1xuICAgIHJldHVybiAoeCk9PmZucy5yZWR1Y2UoKHYsIGYpPT5mKHYpLCB4KTtcbn1cbmZ1bmN0aW9uIGV4dHJhY3RDb21wYXJhdG9yKGNvbXBhcmF0b3JTdHJpbmcpIHtcbiAgICByZXR1cm4gY29tcGFyYXRvclN0cmluZy5tYXRjaChwYXJzZVJlZ2V4KGNvbXBhcmF0b3IpKTtcbn1cbmZ1bmN0aW9uIGNvbWJpbmVWZXJzaW9uKG1ham9yLCBtaW5vciwgcGF0Y2gsIHByZVJlbGVhc2UpIHtcbiAgICB2YXIgbWFpblZlcnNpb24gPSBgJHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH1gO1xuICAgIGlmIChwcmVSZWxlYXNlKSB7XG4gICAgICAgIHJldHVybiBgJHttYWluVmVyc2lvbn0tJHtwcmVSZWxlYXNlfWA7XG4gICAgfVxuICAgIHJldHVybiBtYWluVmVyc2lvbjtcbn1cbi8vIGZvcmsgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vb3JpZ2luanMvdml0ZS1wbHVnaW4tZmVkZXJhdGlvbi9ibG9iL3YxLjEuMTIvcGFja2FnZXMvbGliL3NyYy91dGlscy9zZW12ZXIvaW5kZXgudHNcbi8vIENvcHlyaWdodCAoYylcbi8vIHZpdGUtcGx1Z2luLWZlZGVyYXRpb24gaXMgbGljZW5zZWQgdW5kZXIgTXVsYW4gUFNMIHYyLlxuLy8gWW91IGNhbiB1c2UgdGhpcyBzb2Z0d2FyZSBhY2NvcmRpbmcgdG8gdGhlIHRlcm1zIGFuZCBjb25kaXRpb25zIG9mIHRoZSBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgTXVsYW4gUFNMIHYyIGF0OlxuLy8gICAgICBodHRwOi8vbGljZW5zZS5jb3NjbC5vcmcuY24vTXVsYW5QU0wyXG4vLyBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIE9OIEFOIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9GIEFOWSBLSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIE5PTi1JTkZSSU5HRU1FTlQsIE1FUkNIQU5UQUJJTElUWSBPUiBGSVQgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLlxuLy8gU2VlIHRoZSBNdWxhbiBQU0wgdjIgZm9yIG1vcmUgZGV0YWlscy5cbmZ1bmN0aW9uIHBhcnNlSHlwaGVuKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnJlcGxhY2UocGFyc2VSZWdleChoeXBoZW5SYW5nZSksIChfcmFuZ2UsIGZyb20sIGZyb21NYWpvciwgZnJvbU1pbm9yLCBmcm9tUGF0Y2gsIF9mcm9tUHJlUmVsZWFzZSwgX2Zyb21CdWlsZCwgdG8sIHRvTWFqb3IsIHRvTWlub3IsIHRvUGF0Y2gsIHRvUHJlUmVsZWFzZSk9PntcbiAgICAgICAgaWYgKGlzWFZlcnNpb24oZnJvbU1ham9yKSkge1xuICAgICAgICAgICAgZnJvbSA9ICcnO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24oZnJvbU1pbm9yKSkge1xuICAgICAgICAgICAgZnJvbSA9IGA+PSR7ZnJvbU1ham9yfS4wLjBgO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24oZnJvbVBhdGNoKSkge1xuICAgICAgICAgICAgZnJvbSA9IGA+PSR7ZnJvbU1ham9yfS4ke2Zyb21NaW5vcn0uMGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmcm9tID0gYD49JHtmcm9tfWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzWFZlcnNpb24odG9NYWpvcikpIHtcbiAgICAgICAgICAgIHRvID0gJyc7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbih0b01pbm9yKSkge1xuICAgICAgICAgICAgdG8gPSBgPCR7TnVtYmVyKHRvTWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24odG9QYXRjaCkpIHtcbiAgICAgICAgICAgIHRvID0gYDwke3RvTWFqb3J9LiR7TnVtYmVyKHRvTWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgfSBlbHNlIGlmICh0b1ByZVJlbGVhc2UpIHtcbiAgICAgICAgICAgIHRvID0gYDw9JHt0b01ham9yfS4ke3RvTWlub3J9LiR7dG9QYXRjaH0tJHt0b1ByZVJlbGVhc2V9YDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRvID0gYDw9JHt0b31gO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgJHtmcm9tfSAke3RvfWAudHJpbSgpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VDb21wYXJhdG9yVHJpbShyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS5yZXBsYWNlKHBhcnNlUmVnZXgoY29tcGFyYXRvclRyaW0pLCAnJDEkMiQzJyk7XG59XG5mdW5jdGlvbiBwYXJzZVRpbGRlVHJpbShyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS5yZXBsYWNlKHBhcnNlUmVnZXgodGlsZGVUcmltKSwgJyQxficpO1xufVxuZnVuY3Rpb24gcGFyc2VDYXJldFRyaW0ocmFuZ2UpIHtcbiAgICByZXR1cm4gcmFuZ2UucmVwbGFjZShwYXJzZVJlZ2V4KGNhcmV0VHJpbSksICckMV4nKTtcbn1cbmZ1bmN0aW9uIHBhcnNlQ2FyZXRzKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnRyaW0oKS5zcGxpdCgvXFxzKy8pLm1hcCgocmFuZ2VWZXJzaW9uKT0+cmFuZ2VWZXJzaW9uLnJlcGxhY2UocGFyc2VSZWdleChjYXJldCksIChfLCBtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKT0+e1xuICAgICAgICAgICAgaWYgKGlzWFZlcnNpb24obWFqb3IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKG1pbm9yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4wLjAgPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbihwYXRjaCkpIHtcbiAgICAgICAgICAgICAgICBpZiAobWFqb3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCA8JHtOdW1iZXIobWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlUmVsZWFzZSkge1xuICAgICAgICAgICAgICAgIGlmIChtYWpvciA9PT0gJzAnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtaW5vciA9PT0gJzAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0tJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHttaW5vcn0uJHtOdW1iZXIocGF0Y2gpICsgMX0tMGA7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0tJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofS0ke3ByZVJlbGVhc2V9IDwke051bWJlcihtYWpvcikgKyAxfS4wLjAtMGA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAobWFqb3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWlub3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9IDwke21ham9yfS4ke21pbm9yfS4ke051bWJlcihwYXRjaCkgKyAxfS0wYDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0gPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLmpvaW4oJyAnKTtcbn1cbmZ1bmN0aW9uIHBhcnNlVGlsZGVzKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnRyaW0oKS5zcGxpdCgvXFxzKy8pLm1hcCgocmFuZ2VWZXJzaW9uKT0+cmFuZ2VWZXJzaW9uLnJlcGxhY2UocGFyc2VSZWdleCh0aWxkZSksIChfLCBtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKT0+e1xuICAgICAgICAgICAgaWYgKGlzWFZlcnNpb24obWFqb3IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKG1pbm9yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4wLjAgPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbihwYXRjaCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlUmVsZWFzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofS0ke3ByZVJlbGVhc2V9IDwke21ham9yfS4ke051bWJlcihtaW5vcikgKyAxfS4wLTBgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9IDwke21ham9yfS4ke051bWJlcihtaW5vcikgKyAxfS4wLTBgO1xuICAgICAgICB9KSkuam9pbignICcpO1xufVxuZnVuY3Rpb24gcGFyc2VYUmFuZ2VzKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnNwbGl0KC9cXHMrLykubWFwKChyYW5nZVZlcnNpb24pPT5yYW5nZVZlcnNpb24udHJpbSgpLnJlcGxhY2UocGFyc2VSZWdleCh4UmFuZ2UpLCAocmV0LCBndGx0LCBtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKT0+e1xuICAgICAgICAgICAgdmFyIGlzWE1ham9yID0gaXNYVmVyc2lvbihtYWpvcik7XG4gICAgICAgICAgICB2YXIgaXNYTWlub3IgPSBpc1hNYWpvciB8fCBpc1hWZXJzaW9uKG1pbm9yKTtcbiAgICAgICAgICAgIHZhciBpc1hQYXRjaCA9IGlzWE1pbm9yIHx8IGlzWFZlcnNpb24ocGF0Y2gpO1xuICAgICAgICAgICAgaWYgKGd0bHQgPT09ICc9JyAmJiBpc1hQYXRjaCkge1xuICAgICAgICAgICAgICAgIGd0bHQgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByZVJlbGVhc2UgPSAnJztcbiAgICAgICAgICAgIGlmIChpc1hNYWpvcikge1xuICAgICAgICAgICAgICAgIGlmIChndGx0ID09PSAnPicgfHwgZ3RsdCA9PT0gJzwnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdGhpbmcgaXMgYWxsb3dlZFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzwwLjAuMC0wJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBub3RoaW5nIGlzIGZvcmJpZGRlblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyonO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3RsdCAmJiBpc1hQYXRjaCkge1xuICAgICAgICAgICAgICAgIC8vIHJlcGxhY2UgWCB3aXRoIDBcbiAgICAgICAgICAgICAgICBpZiAoaXNYTWlub3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbWlub3IgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwYXRjaCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKGd0bHQgPT09ICc+Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyA+MSA9PiA+PTIuMC4wXG4gICAgICAgICAgICAgICAgICAgIC8vID4xLjIgPT4gPj0xLjMuMFxuICAgICAgICAgICAgICAgICAgICBndGx0ID0gJz49JztcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzWE1pbm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWpvciA9IE51bWJlcihtYWpvcikgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWlub3IgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0Y2ggPSAwO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWlub3IgPSBOdW1iZXIobWlub3IpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3RsdCA9PT0gJzw9Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyA8PTAuNy54IGlzIGFjdHVhbGx5IDwwLjguMCwgc2luY2UgYW55IDAuNy54IHNob3VsZCBwYXNzXG4gICAgICAgICAgICAgICAgICAgIC8vIFNpbWlsYXJseSwgPD03LnggaXMgYWN0dWFsbHkgPDguMC4wLCBldGMuXG4gICAgICAgICAgICAgICAgICAgIGd0bHQgPSAnPCc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1hNaW5vcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFqb3IgPSBOdW1iZXIobWFqb3IpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbm9yID0gTnVtYmVyKG1pbm9yKSArIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGd0bHQgPT09ICc8Jykge1xuICAgICAgICAgICAgICAgICAgICBwcmVSZWxlYXNlID0gJy0wJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke2d0bHQgKyBtYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0ke3ByZVJlbGVhc2V9YDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYTWlub3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uMC4wJHtwcmVSZWxlYXNlfSA8JHtOdW1iZXIobWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1hQYXRjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4wJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH0pKS5qb2luKCcgJyk7XG59XG5mdW5jdGlvbiBwYXJzZVN0YXIocmFuZ2UpIHtcbiAgICByZXR1cm4gcmFuZ2UudHJpbSgpLnJlcGxhY2UocGFyc2VSZWdleChzdGFyKSwgJycpO1xufVxuZnVuY3Rpb24gcGFyc2VHVEUwKGNvbXBhcmF0b3JTdHJpbmcpIHtcbiAgICByZXR1cm4gY29tcGFyYXRvclN0cmluZy50cmltKCkucmVwbGFjZShwYXJzZVJlZ2V4KGd0ZTApLCAnJyk7XG59XG4vLyBmb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL29yaWdpbmpzL3ZpdGUtcGx1Z2luLWZlZGVyYXRpb24vYmxvYi92MS4xLjEyL3BhY2thZ2VzL2xpYi9zcmMvdXRpbHMvc2VtdmVyL2luZGV4LnRzXG4vLyBDb3B5cmlnaHQgKGMpXG4vLyB2aXRlLXBsdWdpbi1mZWRlcmF0aW9uIGlzIGxpY2Vuc2VkIHVuZGVyIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBjYW4gdXNlIHRoaXMgc29mdHdhcmUgYWNjb3JkaW5nIHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgTXVsYW4gUFNMIHYyLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIE11bGFuIFBTTCB2MiBhdDpcbi8vICAgICAgaHR0cDovL2xpY2Vuc2UuY29zY2wub3JnLmNuL011bGFuUFNMMlxuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBOT04tSU5GUklOR0VNRU5ULCBNRVJDSEFOVEFCSUxJVFkgT1IgRklUIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cbi8vIFNlZSB0aGUgTXVsYW4gUFNMIHYyIGZvciBtb3JlIGRldGFpbHMuXG5mdW5jdGlvbiBjb21wYXJlQXRvbShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB7XG4gICAgcmFuZ2VBdG9tID0gTnVtYmVyKHJhbmdlQXRvbSkgfHwgcmFuZ2VBdG9tO1xuICAgIHZlcnNpb25BdG9tID0gTnVtYmVyKHZlcnNpb25BdG9tKSB8fCB2ZXJzaW9uQXRvbTtcbiAgICBpZiAocmFuZ2VBdG9tID4gdmVyc2lvbkF0b20pIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGlmIChyYW5nZUF0b20gPT09IHZlcnNpb25BdG9tKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gLTE7XG59XG5mdW5jdGlvbiBjb21wYXJlUHJlUmVsZWFzZShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB7XG4gICAgdmFyIHJhbmdlUHJlUmVsZWFzZSA9IHJhbmdlQXRvbS5wcmVSZWxlYXNlO1xuICAgIHZhciB2ZXJzaW9uUHJlUmVsZWFzZSA9IHZlcnNpb25BdG9tLnByZVJlbGVhc2U7XG4gICAgaWYgKHJhbmdlUHJlUmVsZWFzZSA9PT0gdW5kZWZpbmVkICYmIEJvb2xlYW4odmVyc2lvblByZVJlbGVhc2UpKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBpZiAoQm9vbGVhbihyYW5nZVByZVJlbGVhc2UpICYmIHZlcnNpb25QcmVSZWxlYXNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpZiAocmFuZ2VQcmVSZWxlYXNlID09PSB1bmRlZmluZWQgJiYgdmVyc2lvblByZVJlbGVhc2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgZm9yKHZhciBpID0gMCwgbiA9IHJhbmdlUHJlUmVsZWFzZS5sZW5ndGg7IGkgPD0gbjsgaSsrKXtcbiAgICAgICAgdmFyIHJhbmdlRWxlbWVudCA9IHJhbmdlUHJlUmVsZWFzZVtpXTtcbiAgICAgICAgdmFyIHZlcnNpb25FbGVtZW50ID0gdmVyc2lvblByZVJlbGVhc2VbaV07XG4gICAgICAgIGlmIChyYW5nZUVsZW1lbnQgPT09IHZlcnNpb25FbGVtZW50KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmFuZ2VFbGVtZW50ID09PSB1bmRlZmluZWQgJiYgdmVyc2lvbkVsZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyYW5nZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmVyc2lvbkVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29tcGFyZUF0b20ocmFuZ2VFbGVtZW50LCB2ZXJzaW9uRWxlbWVudCk7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuZnVuY3Rpb24gY29tcGFyZVZlcnNpb24ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkge1xuICAgIHJldHVybiBjb21wYXJlQXRvbShyYW5nZUF0b20ubWFqb3IsIHZlcnNpb25BdG9tLm1ham9yKSB8fCBjb21wYXJlQXRvbShyYW5nZUF0b20ubWlub3IsIHZlcnNpb25BdG9tLm1pbm9yKSB8fCBjb21wYXJlQXRvbShyYW5nZUF0b20ucGF0Y2gsIHZlcnNpb25BdG9tLnBhdGNoKSB8fCBjb21wYXJlUHJlUmVsZWFzZShyYW5nZUF0b20sIHZlcnNpb25BdG9tKTtcbn1cbmZ1bmN0aW9uIGVxKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHtcbiAgICByZXR1cm4gcmFuZ2VBdG9tLnZlcnNpb24gPT09IHZlcnNpb25BdG9tLnZlcnNpb247XG59XG5mdW5jdGlvbiBjb21wYXJlKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHtcbiAgICBzd2l0Y2gocmFuZ2VBdG9tLm9wZXJhdG9yKXtcbiAgICAgICAgY2FzZSAnJzpcbiAgICAgICAgY2FzZSAnPSc6XG4gICAgICAgICAgICByZXR1cm4gZXEocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSk7XG4gICAgICAgIGNhc2UgJz4nOlxuICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIDwgMDtcbiAgICAgICAgY2FzZSAnPj0nOlxuICAgICAgICAgICAgcmV0dXJuIGVxKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHx8IGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIDwgMDtcbiAgICAgICAgY2FzZSAnPCc6XG4gICAgICAgICAgICByZXR1cm4gY29tcGFyZVZlcnNpb24ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkgPiAwO1xuICAgICAgICBjYXNlICc8PSc6XG4gICAgICAgICAgICByZXR1cm4gZXEocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkgfHwgY29tcGFyZVZlcnNpb24ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkgPiAwO1xuICAgICAgICBjYXNlIHVuZGVmaW5lZDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBtZWFuICogb3IgeCAtPiBhbGwgdmVyc2lvbnNcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG4vLyBmb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL29yaWdpbmpzL3ZpdGUtcGx1Z2luLWZlZGVyYXRpb24vYmxvYi92MS4xLjEyL3BhY2thZ2VzL2xpYi9zcmMvdXRpbHMvc2VtdmVyL2luZGV4LnRzXG4vLyBDb3B5cmlnaHQgKGMpXG4vLyB2aXRlLXBsdWdpbi1mZWRlcmF0aW9uIGlzIGxpY2Vuc2VkIHVuZGVyIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBjYW4gdXNlIHRoaXMgc29mdHdhcmUgYWNjb3JkaW5nIHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgTXVsYW4gUFNMIHYyLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIE11bGFuIFBTTCB2MiBhdDpcbi8vICAgICAgaHR0cDovL2xpY2Vuc2UuY29zY2wub3JnLmNuL011bGFuUFNMMlxuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBOT04tSU5GUklOR0VNRU5ULCBNRVJDSEFOVEFCSUxJVFkgT1IgRklUIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cbi8vIFNlZSB0aGUgTXVsYW4gUFNMIHYyIGZvciBtb3JlIGRldGFpbHMuXG5mdW5jdGlvbiBwYXJzZUNvbXBhcmF0b3JTdHJpbmcocmFuZ2UpIHtcbiAgICByZXR1cm4gcGlwZSgvLyBeIC0tPiAqIChhbnksIGtpbmRhIHNpbGx5KVxuICAgIC8vIF4yLCBeMi54LCBeMi54LnggLS0+ID49Mi4wLjAgPDMuMC4wLTBcbiAgICAvLyBeMi4wLCBeMi4wLnggLS0+ID49Mi4wLjAgPDMuMC4wLTBcbiAgICAvLyBeMS4yLCBeMS4yLnggLS0+ID49MS4yLjAgPDIuMC4wLTBcbiAgICAvLyBeMS4yLjMgLS0+ID49MS4yLjMgPDIuMC4wLTBcbiAgICAvLyBeMS4yLjAgLS0+ID49MS4yLjAgPDIuMC4wLTBcbiAgICBwYXJzZUNhcmV0cywgLy8gfiwgfj4gLS0+ICogKGFueSwga2luZGEgc2lsbHkpXG4gICAgLy8gfjIsIH4yLngsIH4yLngueCwgfj4yLCB+PjIueCB+PjIueC54IC0tPiA+PTIuMC4wIDwzLjAuMC0wXG4gICAgLy8gfjIuMCwgfjIuMC54LCB+PjIuMCwgfj4yLjAueCAtLT4gPj0yLjAuMCA8Mi4xLjAtMFxuICAgIC8vIH4xLjIsIH4xLjIueCwgfj4xLjIsIH4+MS4yLnggLS0+ID49MS4yLjAgPDEuMy4wLTBcbiAgICAvLyB+MS4yLjMsIH4+MS4yLjMgLS0+ID49MS4yLjMgPDEuMy4wLTBcbiAgICAvLyB+MS4yLjAsIH4+MS4yLjAgLS0+ID49MS4yLjAgPDEuMy4wLTBcbiAgICBwYXJzZVRpbGRlcywgcGFyc2VYUmFuZ2VzLCBwYXJzZVN0YXIpKHJhbmdlKTtcbn1cbmZ1bmN0aW9uIHBhcnNlUmFuZ2UocmFuZ2UpIHtcbiAgICByZXR1cm4gcGlwZSgvLyBgMS4yLjMgLSAxLjIuNGAgPT4gYD49MS4yLjMgPD0xLjIuNGBcbiAgICBwYXJzZUh5cGhlbiwgLy8gYD4gMS4yLjMgPCAxLjIuNWAgPT4gYD4xLjIuMyA8MS4yLjVgXG4gICAgcGFyc2VDb21wYXJhdG9yVHJpbSwgLy8gYH4gMS4yLjNgID0+IGB+MS4yLjNgXG4gICAgcGFyc2VUaWxkZVRyaW0sIC8vIGBeIDEuMi4zYCA9PiBgXjEuMi4zYFxuICAgIHBhcnNlQ2FyZXRUcmltKShyYW5nZS50cmltKCkpLnNwbGl0KC9cXHMrLykuam9pbignICcpO1xufVxuZnVuY3Rpb24gc2F0aXNmeSh2ZXJzaW9uLCByYW5nZSkge1xuICAgIGlmICghdmVyc2lvbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBwYXJzZWRSYW5nZSA9IHBhcnNlUmFuZ2UocmFuZ2UpO1xuICAgIHZhciBwYXJzZWRDb21wYXJhdG9yID0gcGFyc2VkUmFuZ2Uuc3BsaXQoJyAnKS5tYXAoKHJhbmdlVmVyc2lvbik9PnBhcnNlQ29tcGFyYXRvclN0cmluZyhyYW5nZVZlcnNpb24pKS5qb2luKCcgJyk7XG4gICAgdmFyIGNvbXBhcmF0b3JzID0gcGFyc2VkQ29tcGFyYXRvci5zcGxpdCgvXFxzKy8pLm1hcCgoY29tcGFyYXRvcik9PnBhcnNlR1RFMChjb21wYXJhdG9yKSk7XG4gICAgdmFyIGV4dHJhY3RlZFZlcnNpb24gPSBleHRyYWN0Q29tcGFyYXRvcih2ZXJzaW9uKTtcbiAgICBpZiAoIWV4dHJhY3RlZFZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgX2V4dHJhY3RlZFZlcnNpb24gPSBfc2xpY2VkX3RvX2FycmF5Ll8oZXh0cmFjdGVkVmVyc2lvbiwgNyksIHZlcnNpb25PcGVyYXRvciA9IF9leHRyYWN0ZWRWZXJzaW9uWzFdLCB2ZXJzaW9uTWFqb3IgPSBfZXh0cmFjdGVkVmVyc2lvblszXSwgdmVyc2lvbk1pbm9yID0gX2V4dHJhY3RlZFZlcnNpb25bNF0sIHZlcnNpb25QYXRjaCA9IF9leHRyYWN0ZWRWZXJzaW9uWzVdLCB2ZXJzaW9uUHJlUmVsZWFzZSA9IF9leHRyYWN0ZWRWZXJzaW9uWzZdO1xuICAgIHZhciB2ZXJzaW9uQXRvbSA9IHtcbiAgICAgICAgb3BlcmF0b3I6IHZlcnNpb25PcGVyYXRvcixcbiAgICAgICAgdmVyc2lvbjogY29tYmluZVZlcnNpb24odmVyc2lvbk1ham9yLCB2ZXJzaW9uTWlub3IsIHZlcnNpb25QYXRjaCwgdmVyc2lvblByZVJlbGVhc2UpLFxuICAgICAgICBtYWpvcjogdmVyc2lvbk1ham9yLFxuICAgICAgICBtaW5vcjogdmVyc2lvbk1pbm9yLFxuICAgICAgICBwYXRjaDogdmVyc2lvblBhdGNoLFxuICAgICAgICBwcmVSZWxlYXNlOiB2ZXJzaW9uUHJlUmVsZWFzZSA9PSBudWxsID8gdm9pZCAwIDogdmVyc2lvblByZVJlbGVhc2Uuc3BsaXQoJy4nKVxuICAgIH07XG4gICAgZm9yICh2YXIgY29tcGFyYXRvciBvZiBjb21wYXJhdG9ycyl7XG4gICAgICAgIHZhciBleHRyYWN0ZWRDb21wYXJhdG9yID0gZXh0cmFjdENvbXBhcmF0b3IoY29tcGFyYXRvcik7XG4gICAgICAgIGlmICghZXh0cmFjdGVkQ29tcGFyYXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBfZXh0cmFjdGVkQ29tcGFyYXRvciA9IF9zbGljZWRfdG9fYXJyYXkuXyhleHRyYWN0ZWRDb21wYXJhdG9yLCA3KSwgcmFuZ2VPcGVyYXRvciA9IF9leHRyYWN0ZWRDb21wYXJhdG9yWzFdLCByYW5nZU1ham9yID0gX2V4dHJhY3RlZENvbXBhcmF0b3JbM10sIHJhbmdlTWlub3IgPSBfZXh0cmFjdGVkQ29tcGFyYXRvcls0XSwgcmFuZ2VQYXRjaCA9IF9leHRyYWN0ZWRDb21wYXJhdG9yWzVdLCByYW5nZVByZVJlbGVhc2UgPSBfZXh0cmFjdGVkQ29tcGFyYXRvcls2XTtcbiAgICAgICAgdmFyIHJhbmdlQXRvbSA9IHtcbiAgICAgICAgICAgIG9wZXJhdG9yOiByYW5nZU9wZXJhdG9yLFxuICAgICAgICAgICAgdmVyc2lvbjogY29tYmluZVZlcnNpb24ocmFuZ2VNYWpvciwgcmFuZ2VNaW5vciwgcmFuZ2VQYXRjaCwgcmFuZ2VQcmVSZWxlYXNlKSxcbiAgICAgICAgICAgIG1ham9yOiByYW5nZU1ham9yLFxuICAgICAgICAgICAgbWlub3I6IHJhbmdlTWlub3IsXG4gICAgICAgICAgICBwYXRjaDogcmFuZ2VQYXRjaCxcbiAgICAgICAgICAgIHByZVJlbGVhc2U6IHJhbmdlUHJlUmVsZWFzZSA9PSBudWxsID8gdm9pZCAwIDogcmFuZ2VQcmVSZWxlYXNlLnNwbGl0KCcuJylcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCFjb21wYXJlKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIGVhcmx5IHJldHVyblxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gZm9ybWF0U2hhcmUoc2hhcmVBcmdzLCBmcm9tLCBuYW1lMSwgc2hhcmVTdHJhdGVneSkge1xuICAgIHZhciBnZXQ7XG4gICAgaWYgKCdnZXQnIGluIHNoYXJlQXJncykge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWRlc3RydWN0dXJpbmdcbiAgICAgICAgZ2V0ID0gc2hhcmVBcmdzLmdldDtcbiAgICB9IGVsc2UgaWYgKCdsaWInIGluIHNoYXJlQXJncykge1xuICAgICAgICBnZXQgPSAoKT0+UHJvbWlzZS5yZXNvbHZlKHNoYXJlQXJncy5saWIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGdldCA9ICgpPT5Qcm9taXNlLnJlc29sdmUoKCk9PntcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbiBub3QgZ2V0IHNoYXJlZCAnJHtuYW1lMX0nIWApO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChzaGFyZUFyZ3Muc3RyYXRlZ3kpIHtcbiAgICAgICAgd2FybihgXCJzaGFyZWQuc3RyYXRlZ3kgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHNldCBpbiBpbml0T3B0aW9ucy5zaGFyZVN0cmF0ZWd5IGluc3RlYWQhXCJgKTtcbiAgICB9XG4gICAgdmFyIF9zaGFyZUFyZ3NfdmVyc2lvbiwgX3NoYXJlQXJnc19zY29wZSwgX3NoYXJlQXJnc19zdHJhdGVneTtcbiAgICByZXR1cm4gcG9seWZpbGxzLl9leHRlbmRzKHtcbiAgICAgICAgZGVwczogW10sXG4gICAgICAgIHVzZUluOiBbXSxcbiAgICAgICAgZnJvbSxcbiAgICAgICAgbG9hZGluZzogbnVsbFxuICAgIH0sIHNoYXJlQXJncywge1xuICAgICAgICBzaGFyZUNvbmZpZzogcG9seWZpbGxzLl9leHRlbmRzKHtcbiAgICAgICAgICAgIHJlcXVpcmVkVmVyc2lvbjogYF4ke3NoYXJlQXJncy52ZXJzaW9ufWAsXG4gICAgICAgICAgICBzaW5nbGV0b246IGZhbHNlLFxuICAgICAgICAgICAgZWFnZXI6IGZhbHNlLFxuICAgICAgICAgICAgc3RyaWN0VmVyc2lvbjogZmFsc2VcbiAgICAgICAgfSwgc2hhcmVBcmdzLnNoYXJlQ29uZmlnKSxcbiAgICAgICAgZ2V0LFxuICAgICAgICBsb2FkZWQ6IChzaGFyZUFyZ3MgPT0gbnVsbCA/IHZvaWQgMCA6IHNoYXJlQXJncy5sb2FkZWQpIHx8ICdsaWInIGluIHNoYXJlQXJncyA/IHRydWUgOiB1bmRlZmluZWQsXG4gICAgICAgIHZlcnNpb246IChfc2hhcmVBcmdzX3ZlcnNpb24gPSBzaGFyZUFyZ3MudmVyc2lvbikgIT0gbnVsbCA/IF9zaGFyZUFyZ3NfdmVyc2lvbiA6ICcwJyxcbiAgICAgICAgc2NvcGU6IEFycmF5LmlzQXJyYXkoc2hhcmVBcmdzLnNjb3BlKSA/IHNoYXJlQXJncy5zY29wZSA6IFtcbiAgICAgICAgICAgIChfc2hhcmVBcmdzX3Njb3BlID0gc2hhcmVBcmdzLnNjb3BlKSAhPSBudWxsID8gX3NoYXJlQXJnc19zY29wZSA6ICdkZWZhdWx0J1xuICAgICAgICBdLFxuICAgICAgICBzdHJhdGVneTogKChfc2hhcmVBcmdzX3N0cmF0ZWd5ID0gc2hhcmVBcmdzLnN0cmF0ZWd5KSAhPSBudWxsID8gX3NoYXJlQXJnc19zdHJhdGVneSA6IHNoYXJlU3RyYXRlZ3kpIHx8ICd2ZXJzaW9uLWZpcnN0J1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZm9ybWF0U2hhcmVDb25maWdzKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKSB7XG4gICAgdmFyIHNoYXJlQXJncyA9IHVzZXJPcHRpb25zLnNoYXJlZCB8fCB7fTtcbiAgICB2YXIgZnJvbSA9IHVzZXJPcHRpb25zLm5hbWU7XG4gICAgdmFyIHNoYXJlSW5mb3MgPSBPYmplY3Qua2V5cyhzaGFyZUFyZ3MpLnJlZHVjZSgocmVzLCBwa2dOYW1lKT0+e1xuICAgICAgICB2YXIgYXJyYXlTaGFyZUFyZ3MgPSBhcnJheU9wdGlvbnMoc2hhcmVBcmdzW3BrZ05hbWVdKTtcbiAgICAgICAgcmVzW3BrZ05hbWVdID0gcmVzW3BrZ05hbWVdIHx8IFtdO1xuICAgICAgICBhcnJheVNoYXJlQXJncy5mb3JFYWNoKChzaGFyZUNvbmZpZyk9PntcbiAgICAgICAgICAgIHJlc1twa2dOYW1lXS5wdXNoKGZvcm1hdFNoYXJlKHNoYXJlQ29uZmlnLCBmcm9tLCBwa2dOYW1lLCB1c2VyT3B0aW9ucy5zaGFyZVN0cmF0ZWd5KSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH0sIHt9KTtcbiAgICB2YXIgc2hhcmVkID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBnbG9iYWxPcHRpb25zLnNoYXJlZCk7XG4gICAgT2JqZWN0LmtleXMoc2hhcmVJbmZvcykuZm9yRWFjaCgoc2hhcmVLZXkpPT57XG4gICAgICAgIGlmICghc2hhcmVkW3NoYXJlS2V5XSkge1xuICAgICAgICAgICAgc2hhcmVkW3NoYXJlS2V5XSA9IHNoYXJlSW5mb3Nbc2hhcmVLZXldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2hhcmVJbmZvc1tzaGFyZUtleV0uZm9yRWFjaCgobmV3VXNlclNoYXJlZE9wdGlvbnMpPT57XG4gICAgICAgICAgICAgICAgdmFyIGlzU2FtZVZlcnNpb24gPSBzaGFyZWRbc2hhcmVLZXldLmZpbmQoKHNoYXJlZFZhbCk9PnNoYXJlZFZhbC52ZXJzaW9uID09PSBuZXdVc2VyU2hhcmVkT3B0aW9ucy52ZXJzaW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzU2FtZVZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkW3NoYXJlS2V5XS5wdXNoKG5ld1VzZXJTaGFyZWRPcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIHNoYXJlZCxcbiAgICAgICAgc2hhcmVJbmZvc1xuICAgIH07XG59XG5mdW5jdGlvbiB2ZXJzaW9uTHQoYSwgYikge1xuICAgIHZhciB0cmFuc2Zvcm1JbnZhbGlkVmVyc2lvbiA9ICh2ZXJzaW9uKT0+e1xuICAgICAgICB2YXIgaXNOdW1iZXJWZXJzaW9uID0gIU51bWJlci5pc05hTihOdW1iZXIodmVyc2lvbikpO1xuICAgICAgICBpZiAoaXNOdW1iZXJWZXJzaW9uKSB7XG4gICAgICAgICAgICB2YXIgc3BsaXRBcnIgPSB2ZXJzaW9uLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICB2YXIgdmFsaWRWZXJzaW9uID0gdmVyc2lvbjtcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCAzIC0gc3BsaXRBcnIubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgIHZhbGlkVmVyc2lvbiArPSAnLjAnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbGlkVmVyc2lvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmVyc2lvbjtcbiAgICB9O1xuICAgIGlmIChzYXRpc2Z5KHRyYW5zZm9ybUludmFsaWRWZXJzaW9uKGEpLCBgPD0ke3RyYW5zZm9ybUludmFsaWRWZXJzaW9uKGIpfWApKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG52YXIgZmluZFZlcnNpb24gPSAoc2hhcmVWZXJzaW9uTWFwLCBjYik9PntcbiAgICB2YXIgY2FsbGJhY2sgPSBjYiB8fCBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgcmV0dXJuIHZlcnNpb25MdChwcmV2LCBjdXIpO1xuICAgIH07XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHNoYXJlVmVyc2lvbk1hcCkucmVkdWNlKChwcmV2LCBjdXIpPT57XG4gICAgICAgIGlmICghcHJldikge1xuICAgICAgICAgICAgcmV0dXJuIGN1cjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FsbGJhY2socHJldiwgY3VyKSkge1xuICAgICAgICAgICAgcmV0dXJuIGN1cjtcbiAgICAgICAgfVxuICAgICAgICAvLyBkZWZhdWx0IHZlcnNpb24gaXMgJzAnIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJwYWNrL3dlYnBhY2svYmxvYi9tYWluL2xpYi9zaGFyaW5nL1Byb3ZpZGVTaGFyZWRNb2R1bGUuanMjTDEzNlxuICAgICAgICBpZiAocHJldiA9PT0gJzAnKSB7XG4gICAgICAgICAgICByZXR1cm4gY3VyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmV2O1xuICAgIH0sIDApO1xufTtcbnZhciBpc0xvYWRlZCA9IChzaGFyZWQpPT57XG4gICAgcmV0dXJuIEJvb2xlYW4oc2hhcmVkLmxvYWRlZCkgfHwgdHlwZW9mIHNoYXJlZC5saWIgPT09ICdmdW5jdGlvbic7XG59O1xudmFyIGlzTG9hZGluZyA9IChzaGFyZWQpPT57XG4gICAgcmV0dXJuIEJvb2xlYW4oc2hhcmVkLmxvYWRpbmcpO1xufTtcbmZ1bmN0aW9uIGZpbmRTaW5nbGV0b25WZXJzaW9uT3JkZXJCeVZlcnNpb24oc2hhcmVTY29wZU1hcCwgc2NvcGUsIHBrZ05hbWUpIHtcbiAgICB2YXIgdmVyc2lvbnMgPSBzaGFyZVNjb3BlTWFwW3Njb3BlXVtwa2dOYW1lXTtcbiAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgcmV0dXJuICFpc0xvYWRlZCh2ZXJzaW9uc1twcmV2XSkgJiYgdmVyc2lvbkx0KHByZXYsIGN1cik7XG4gICAgfTtcbiAgICByZXR1cm4gZmluZFZlcnNpb24oc2hhcmVTY29wZU1hcFtzY29wZV1bcGtnTmFtZV0sIGNhbGxiYWNrKTtcbn1cbmZ1bmN0aW9uIGZpbmRTaW5nbGV0b25WZXJzaW9uT3JkZXJCeUxvYWRlZChzaGFyZVNjb3BlTWFwLCBzY29wZSwgcGtnTmFtZSkge1xuICAgIHZhciB2ZXJzaW9ucyA9IHNoYXJlU2NvcGVNYXBbc2NvcGVdW3BrZ05hbWVdO1xuICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKHByZXYsIGN1cikge1xuICAgICAgICB2YXIgaXNMb2FkaW5nT3JMb2FkZWQgPSAoc2hhcmVkKT0+e1xuICAgICAgICAgICAgcmV0dXJuIGlzTG9hZGVkKHNoYXJlZCkgfHwgaXNMb2FkaW5nKHNoYXJlZCk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChpc0xvYWRpbmdPckxvYWRlZCh2ZXJzaW9uc1tjdXJdKSkge1xuICAgICAgICAgICAgaWYgKGlzTG9hZGluZ09yTG9hZGVkKHZlcnNpb25zW3ByZXZdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBCb29sZWFuKHZlcnNpb25MdChwcmV2LCBjdXIpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTG9hZGluZ09yTG9hZGVkKHZlcnNpb25zW3ByZXZdKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2ZXJzaW9uTHQocHJldiwgY3VyKTtcbiAgICB9O1xuICAgIHJldHVybiBmaW5kVmVyc2lvbihzaGFyZVNjb3BlTWFwW3Njb3BlXVtwa2dOYW1lXSwgY2FsbGJhY2spO1xufVxuZnVuY3Rpb24gZ2V0RmluZFNoYXJlRnVuY3Rpb24oc3RyYXRlZ3kpIHtcbiAgICBpZiAoc3RyYXRlZ3kgPT09ICdsb2FkZWQtZmlyc3QnKSB7XG4gICAgICAgIHJldHVybiBmaW5kU2luZ2xldG9uVmVyc2lvbk9yZGVyQnlMb2FkZWQ7XG4gICAgfVxuICAgIHJldHVybiBmaW5kU2luZ2xldG9uVmVyc2lvbk9yZGVyQnlWZXJzaW9uO1xufVxuZnVuY3Rpb24gZ2V0UmVnaXN0ZXJlZFNoYXJlKGxvY2FsU2hhcmVTY29wZU1hcCwgcGtnTmFtZSwgc2hhcmVJbmZvLCByZXNvbHZlU2hhcmUpIHtcbiAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbihzYykge1xuICAgICAgICBpZiAoc2hhcmVDb25maWcgJiYgbG9jYWxTaGFyZVNjb3BlTWFwW3NjXSAmJiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdKSB7XG4gICAgICAgICAgICB2YXIgcmVxdWlyZWRWZXJzaW9uID0gc2hhcmVDb25maWcucmVxdWlyZWRWZXJzaW9uO1xuICAgICAgICAgICAgdmFyIGZpbmRTaGFyZUZ1bmN0aW9uID0gZ2V0RmluZFNoYXJlRnVuY3Rpb24oc3RyYXRlZ3kpO1xuICAgICAgICAgICAgdmFyIG1heE9yU2luZ2xldG9uVmVyc2lvbiA9IGZpbmRTaGFyZUZ1bmN0aW9uKGxvY2FsU2hhcmVTY29wZU1hcCwgc2MsIHBrZ05hbWUpO1xuICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICB2YXIgZGVmYXVsdFJlc29sdmVyID0gKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoc2hhcmVDb25maWcuc2luZ2xldG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVxdWlyZWRWZXJzaW9uID09PSAnc3RyaW5nJyAmJiAhc2F0aXNmeShtYXhPclNpbmdsZXRvblZlcnNpb24sIHJlcXVpcmVkVmVyc2lvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtc2cgPSBgVmVyc2lvbiAke21heE9yU2luZ2xldG9uVmVyc2lvbn0gZnJvbSAke21heE9yU2luZ2xldG9uVmVyc2lvbiAmJiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW21heE9yU2luZ2xldG9uVmVyc2lvbl0uZnJvbX0gb2Ygc2hhcmVkIHNpbmdsZXRvbiBtb2R1bGUgJHtwa2dOYW1lfSBkb2VzIG5vdCBzYXRpc2Z5IHRoZSByZXF1aXJlbWVudCBvZiAke3NoYXJlSW5mby5mcm9tfSB3aGljaCBuZWVkcyAke3JlcXVpcmVkVmVyc2lvbn0pYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IobXNnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2Fybihtc2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW21heE9yU2luZ2xldG9uVmVyc2lvbl07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVpcmVkVmVyc2lvbiA9PT0gZmFsc2UgfHwgcmVxdWlyZWRWZXJzaW9uID09PSAnKicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW21heE9yU2luZ2xldG9uVmVyc2lvbl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNhdGlzZnkobWF4T3JTaW5nbGV0b25WZXJzaW9uLCByZXF1aXJlZFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVttYXhPclNpbmdsZXRvblZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHJlZiBvZiBPYmplY3QuZW50cmllcyhsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDIpLCB2ZXJzaW9uS2V5ID0gX3JlZlswXSwgdmVyc2lvblZhbHVlID0gX3JlZlsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzYXRpc2Z5KHZlcnNpb25LZXksIHJlcXVpcmVkVmVyc2lvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmVyc2lvblZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgc2hhcmVTY29wZU1hcDogbG9jYWxTaGFyZVNjb3BlTWFwLFxuICAgICAgICAgICAgICAgIHNjb3BlOiBzYyxcbiAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IG1heE9yU2luZ2xldG9uVmVyc2lvbixcbiAgICAgICAgICAgICAgICBHbG9iYWxGZWRlcmF0aW9uOiBHbG9iYWwuX19GRURFUkFUSU9OX18sXG4gICAgICAgICAgICAgICAgcmVzb2x2ZXI6IGRlZmF1bHRSZXNvbHZlclxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciByZXNvbHZlU2hhcmVkID0gcmVzb2x2ZVNoYXJlLmVtaXQocGFyYW1zKSB8fCBwYXJhbXM7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHY6IHJlc29sdmVTaGFyZWQucmVzb2x2ZXIoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgaWYgKCFsb2NhbFNoYXJlU2NvcGVNYXApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgc2hhcmVDb25maWcgPSBzaGFyZUluZm8uc2hhcmVDb25maWcsIF9zaGFyZUluZm9fc2NvcGUgPSBzaGFyZUluZm8uc2NvcGUsIHNjb3BlID0gX3NoYXJlSW5mb19zY29wZSA9PT0gdm9pZCAwID8gREVGQVVMVF9TQ09QRSA6IF9zaGFyZUluZm9fc2NvcGUsIHN0cmF0ZWd5ID0gc2hhcmVJbmZvLnN0cmF0ZWd5O1xuICAgIHZhciBzY29wZXMgPSBBcnJheS5pc0FycmF5KHNjb3BlKSA/IHNjb3BlIDogW1xuICAgICAgICBzY29wZVxuICAgIF07XG4gICAgZm9yICh2YXIgc2Mgb2Ygc2NvcGVzKXtcbiAgICAgICAgdmFyIF9yZXQgPSBfbG9vcChzYyk7XG4gICAgICAgIGlmIChfdHlwZV9vZi5fKF9yZXQpID09PSBcIm9iamVjdFwiKSByZXR1cm4gX3JldC52O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldEdsb2JhbFNoYXJlU2NvcGUoKSB7XG4gICAgcmV0dXJuIEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1NIQVJFX187XG59XG5mdW5jdGlvbiBnZXRUYXJnZXRTaGFyZWRPcHRpb25zKG9wdGlvbnMpIHtcbiAgICB2YXIgcGtnTmFtZSA9IG9wdGlvbnMucGtnTmFtZSwgZXh0cmFPcHRpb25zID0gb3B0aW9ucy5leHRyYU9wdGlvbnMsIHNoYXJlSW5mb3MgPSBvcHRpb25zLnNoYXJlSW5mb3M7XG4gICAgdmFyIGRlZmF1bHRSZXNvbHZlciA9IChzaGFyZWRPcHRpb25zKT0+e1xuICAgICAgICBpZiAoIXNoYXJlZE9wdGlvbnMpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNoYXJlVmVyc2lvbk1hcCA9IHt9O1xuICAgICAgICBzaGFyZWRPcHRpb25zLmZvckVhY2goKHNoYXJlZCk9PntcbiAgICAgICAgICAgIHNoYXJlVmVyc2lvbk1hcFtzaGFyZWQudmVyc2lvbl0gPSBzaGFyZWQ7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgICAgIHJldHVybiAhaXNMb2FkZWQoc2hhcmVWZXJzaW9uTWFwW3ByZXZdKSAmJiB2ZXJzaW9uTHQocHJldiwgY3VyKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG1heFZlcnNpb24gPSBmaW5kVmVyc2lvbihzaGFyZVZlcnNpb25NYXAsIGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuIHNoYXJlVmVyc2lvbk1hcFttYXhWZXJzaW9uXTtcbiAgICB9O1xuICAgIHZhciBfZXh0cmFPcHRpb25zX3Jlc29sdmVyO1xuICAgIHZhciByZXNvbHZlciA9IChfZXh0cmFPcHRpb25zX3Jlc29sdmVyID0gZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMucmVzb2x2ZXIpICE9IG51bGwgPyBfZXh0cmFPcHRpb25zX3Jlc29sdmVyIDogZGVmYXVsdFJlc29sdmVyO1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCByZXNvbHZlcihzaGFyZUluZm9zW3BrZ05hbWVdKSwgZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuY3VzdG9tU2hhcmVJbmZvKTtcbn1cbnZhciBTaGFyZVV0aWxzID0ge1xuICAgIGdldFJlZ2lzdGVyZWRTaGFyZSxcbiAgICBnZXRHbG9iYWxTaGFyZVNjb3BlXG59O1xudmFyIEdsb2JhbFV0aWxzID0ge1xuICAgIEdsb2JhbCxcbiAgICBuYXRpdmVHbG9iYWwsXG4gICAgcmVzZXRGZWRlcmF0aW9uR2xvYmFsSW5mbyxcbiAgICBzZXRHbG9iYWxGZWRlcmF0aW9uSW5zdGFuY2UsXG4gICAgZ2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yLFxuICAgIHNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcixcbiAgICBnZXRJbmZvV2l0aG91dFR5cGUsXG4gICAgZ2V0R2xvYmFsU25hcHNob3QsXG4gICAgZ2V0VGFyZ2V0U25hcHNob3RJbmZvQnlNb2R1bGVJbmZvLFxuICAgIGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyxcbiAgICBzZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8sXG4gICAgYWRkR2xvYmFsU25hcHNob3QsXG4gICAgZ2V0UmVtb3RlRW50cnlFeHBvcnRzLFxuICAgIHJlZ2lzdGVyR2xvYmFsUGx1Z2lucyxcbiAgICBnZXRHbG9iYWxIb3N0UGx1Z2lucyxcbiAgICBnZXRQcmVsb2FkZWQsXG4gICAgc2V0UHJlbG9hZGVkXG59O1xudmFyIGhlbHBlcnMgPSB7XG4gICAgZ2xvYmFsOiBHbG9iYWxVdGlscyxcbiAgICBzaGFyZTogU2hhcmVVdGlsc1xufTtcbmZ1bmN0aW9uIGdldEJ1aWxkZXJJZCgpIHtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICByZXR1cm4gIHRydWUgPyBcIm1vdmllczoxLjAuMFwiIDogMDtcbn1cbi8vIEZ1bmN0aW9uIHRvIG1hdGNoIGEgcmVtb3RlIHdpdGggaXRzIG5hbWUgYW5kIGV4cG9zZVxuLy8gaWQ6IHBrZ05hbWUoQGZlZGVyYXRpb24vYXBwMSkgKyBleHBvc2UoYnV0dG9uKSA9IEBmZWRlcmF0aW9uL2FwcDEvYnV0dG9uXG4vLyBpZDogYWxpYXMoYXBwMSkgKyBleHBvc2UoYnV0dG9uKSA9IGFwcDEvYnV0dG9uXG4vLyBpZDogYWxpYXMoYXBwMS91dGlscykgKyBleHBvc2UobG9hZGFzaC9zb3J0KSA9IGFwcDEvdXRpbHMvbG9hZGFzaC9zb3J0XG5mdW5jdGlvbiBtYXRjaFJlbW90ZVdpdGhOYW1lQW5kRXhwb3NlKHJlbW90ZXMsIGlkKSB7XG4gICAgZm9yICh2YXIgcmVtb3RlIG9mIHJlbW90ZXMpe1xuICAgICAgICAvLyBtYXRjaCBwa2dOYW1lXG4gICAgICAgIHZhciBpc05hbWVNYXRjaGVkID0gaWQuc3RhcnRzV2l0aChyZW1vdGUubmFtZSk7XG4gICAgICAgIHZhciBleHBvc2UgPSBpZC5yZXBsYWNlKHJlbW90ZS5uYW1lLCAnJyk7XG4gICAgICAgIGlmIChpc05hbWVNYXRjaGVkKSB7XG4gICAgICAgICAgICBpZiAoZXhwb3NlLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgICAgIHZhciBwa2dOYW1lT3JBbGlhcyA9IHJlbW90ZS5uYW1lO1xuICAgICAgICAgICAgICAgIGV4cG9zZSA9IGAuJHtleHBvc2V9YDtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwa2dOYW1lT3JBbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChleHBvc2UgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcGtnTmFtZU9yQWxpYXM6IHJlbW90ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBleHBvc2U6ICcuJyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBtYXRjaCBhbGlhc1xuICAgICAgICB2YXIgaXNBbGlhc01hdGNoZWQgPSByZW1vdGUuYWxpYXMgJiYgaWQuc3RhcnRzV2l0aChyZW1vdGUuYWxpYXMpO1xuICAgICAgICB2YXIgZXhwb3NlV2l0aEFsaWFzID0gcmVtb3RlLmFsaWFzICYmIGlkLnJlcGxhY2UocmVtb3RlLmFsaWFzLCAnJyk7XG4gICAgICAgIGlmIChyZW1vdGUuYWxpYXMgJiYgaXNBbGlhc01hdGNoZWQpIHtcbiAgICAgICAgICAgIGlmIChleHBvc2VXaXRoQWxpYXMgJiYgZXhwb3NlV2l0aEFsaWFzLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgICAgIHZhciBwa2dOYW1lT3JBbGlhczEgPSByZW1vdGUuYWxpYXM7XG4gICAgICAgICAgICAgICAgZXhwb3NlV2l0aEFsaWFzID0gYC4ke2V4cG9zZVdpdGhBbGlhc31gO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzOiBwa2dOYW1lT3JBbGlhczEsXG4gICAgICAgICAgICAgICAgICAgIGV4cG9zZTogZXhwb3NlV2l0aEFsaWFzLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChleHBvc2VXaXRoQWxpYXMgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcGtnTmFtZU9yQWxpYXM6IHJlbW90ZS5hbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlOiAnLicsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuO1xufVxuLy8gRnVuY3Rpb24gdG8gbWF0Y2ggYSByZW1vdGUgd2l0aCBpdHMgbmFtZSBvciBhbGlhc1xuZnVuY3Rpb24gbWF0Y2hSZW1vdGUocmVtb3RlcywgbmFtZU9yQWxpYXMpIHtcbiAgICBmb3IgKHZhciByZW1vdGUgb2YgcmVtb3Rlcyl7XG4gICAgICAgIHZhciBpc05hbWVNYXRjaGVkID0gbmFtZU9yQWxpYXMgPT09IHJlbW90ZS5uYW1lO1xuICAgICAgICBpZiAoaXNOYW1lTWF0Y2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXNBbGlhc01hdGNoZWQgPSByZW1vdGUuYWxpYXMgJiYgbmFtZU9yQWxpYXMgPT09IHJlbW90ZS5hbGlhcztcbiAgICAgICAgaWYgKGlzQWxpYXNNYXRjaGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3RlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybjtcbn1cbmZ1bmN0aW9uIHJlZ2lzdGVyUGx1Z2lucyhwbHVnaW5zLCBob29rSW5zdGFuY2VzKSB7XG4gICAgdmFyIGdsb2JhbFBsdWdpbnMgPSBnZXRHbG9iYWxIb3N0UGx1Z2lucygpO1xuICAgIC8vIEluY29ycG9yYXRlIGdsb2JhbCBwbHVnaW5zXG4gICAgaWYgKGdsb2JhbFBsdWdpbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBnbG9iYWxQbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgICAgIGlmIChwbHVnaW5zID09IG51bGwgPyB2b2lkIDAgOiBwbHVnaW5zLmZpbmQoKGl0ZW0pPT5pdGVtLm5hbWUgIT09IHBsdWdpbi5uYW1lKSkge1xuICAgICAgICAgICAgICAgIHBsdWdpbnMucHVzaChwbHVnaW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHBsdWdpbnMgJiYgcGx1Z2lucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHBsdWdpbnMuZm9yRWFjaCgocGx1Z2luKT0+e1xuICAgICAgICAgICAgaG9va0luc3RhbmNlcy5mb3JFYWNoKChob29rSW5zdGFuY2UpPT57XG4gICAgICAgICAgICAgICAgaG9va0luc3RhbmNlLmFwcGx5UGx1Z2luKHBsdWdpbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBwbHVnaW5zO1xufVxuZnVuY3Rpb24gbG9hZEVzbUVudHJ5KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHJlZi5lbnRyeSwgcmVtb3RlRW50cnlFeHBvcnRzID0gcmVmLnJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpPT57XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghcmVtb3RlRW50cnlFeHBvcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRnVuY3Rpb24oJ2NhbGxiYWNrcycsIGBpbXBvcnQoXCIke2VudHJ5fVwiKS50aGVuKGNhbGxiYWNrc1swXSkuY2F0Y2goY2FsbGJhY2tzWzFdKWApKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7fVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVtb3RlRW50cnlFeHBvcnRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gbG9hZFN5c3RlbUpzRW50cnkoXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gcmVmLmVudHJ5LCByZW1vdGVFbnRyeUV4cG9ydHMgPSByZWYucmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCk9PntcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZW1vdGVFbnRyeUV4cG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWxzZSkge30gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRnVuY3Rpb24oJ2NhbGxiYWNrcycsIGBTeXN0ZW0uaW1wb3J0KFwiJHtlbnRyeX1cIikudGhlbihjYWxsYmFja3NbMF0pLmNhdGNoKGNhbGxiYWNrc1sxXSlgKShbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZW1vdGVFbnRyeUV4cG9ydHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBsb2FkRW50cnlTY3JpcHQoXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIG5hbWUxID0gcmVmLm5hbWUsIGdsb2JhbE5hbWUgPSByZWYuZ2xvYmFsTmFtZSwgZW50cnkgPSByZWYuZW50cnksIGxvYWRlckhvb2sgPSByZWYubG9hZGVySG9vaztcbiAgICAgICAgdmFyIF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMgPSBnZXRSZW1vdGVFbnRyeUV4cG9ydHMobmFtZTEsIGdsb2JhbE5hbWUpLCByZW1vdGVFbnRyeUV4cG9ydHMgPSBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzLmVudHJ5RXhwb3J0cztcbiAgICAgICAgaWYgKHJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2RrLmxvYWRTY3JpcHQoZW50cnksIHtcbiAgICAgICAgICAgIGF0dHJzOiB7fSxcbiAgICAgICAgICAgIGNyZWF0ZVNjcmlwdEhvb2s6ICh1cmwsIGF0dHJzKT0+e1xuICAgICAgICAgICAgICAgIHZhciByZXMgPSBsb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVTY3JpcHQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICAgICAgYXR0cnNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlcykgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MU2NyaXB0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJ3NjcmlwdCcgaW4gcmVzIHx8ICd0aW1lb3V0JyBpbiByZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS50aGVuKCgpPT57XG4gICAgICAgICAgICB2YXIgX2dldFJlbW90ZUVudHJ5RXhwb3J0cyA9IGdldFJlbW90ZUVudHJ5RXhwb3J0cyhuYW1lMSwgZ2xvYmFsTmFtZSksIHJlbW90ZUVudHJ5S2V5ID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5yZW1vdGVFbnRyeUtleSwgZW50cnlFeHBvcnRzID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5lbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICBhc3NlcnQoZW50cnlFeHBvcnRzLCBlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwMSwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgIHJlbW90ZU5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5VXJsOiBlbnRyeSxcbiAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUtleVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIGVudHJ5RXhwb3J0cztcbiAgICAgICAgfSkuY2F0Y2goKGUpPT57XG4gICAgICAgICAgICBhc3NlcnQodW5kZWZpbmVkLCBlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwOCwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgIHJlbW90ZU5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIHJlc291cmNlVXJsOiBlbnRyeVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfSk7XG4gICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIGxvYWRFbnRyeURvbShfMCkge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKHJlZikge1xuICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IHJlZi5yZW1vdGVJbmZvLCByZW1vdGVFbnRyeUV4cG9ydHMgPSByZWYucmVtb3RlRW50cnlFeHBvcnRzLCBsb2FkZXJIb29rID0gcmVmLmxvYWRlckhvb2s7XG4gICAgICAgIHZhciBlbnRyeSA9IHJlbW90ZUluZm8uZW50cnksIGdsb2JhbE5hbWUgPSByZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZSwgbmFtZTEgPSByZW1vdGVJbmZvLm5hbWUsIHR5cGUgPSByZW1vdGVJbmZvLnR5cGU7XG4gICAgICAgIHN3aXRjaCh0eXBlKXtcbiAgICAgICAgICAgIGNhc2UgJ2VzbSc6XG4gICAgICAgICAgICBjYXNlICdtb2R1bGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkRXNtRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICBlbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjYXNlICdzeXN0ZW0nOlxuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkU3lzdGVtSnNFbnRyeSh7XG4gICAgICAgICAgICAgICAgICAgIGVudHJ5LFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRFbnRyeVNjcmlwdCh7XG4gICAgICAgICAgICAgICAgICAgIGVudHJ5LFxuICAgICAgICAgICAgICAgICAgICBnbG9iYWxOYW1lLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVySG9va1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIGxvYWRFbnRyeU5vZGUoXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSByZWYucmVtb3RlSW5mbywgbG9hZGVySG9vayA9IHJlZi5sb2FkZXJIb29rO1xuICAgICAgICB2YXIgZW50cnkgPSByZW1vdGVJbmZvLmVudHJ5LCBnbG9iYWxOYW1lID0gcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUsIG5hbWUxID0gcmVtb3RlSW5mby5uYW1lLCB0eXBlID0gcmVtb3RlSW5mby50eXBlO1xuICAgICAgICB2YXIgX2dldFJlbW90ZUVudHJ5RXhwb3J0cyA9IGdldFJlbW90ZUVudHJ5RXhwb3J0cyhuYW1lMSwgZ2xvYmFsTmFtZSksIHJlbW90ZUVudHJ5RXhwb3J0cyA9IF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMuZW50cnlFeHBvcnRzO1xuICAgICAgICBpZiAocmVtb3RlRW50cnlFeHBvcnRzKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZGsubG9hZFNjcmlwdE5vZGUoZW50cnksIHtcbiAgICAgICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgZ2xvYmFsTmFtZSxcbiAgICAgICAgICAgICAgICB0eXBlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbG9hZGVySG9vazoge1xuICAgICAgICAgICAgICAgIGNyZWF0ZVNjcmlwdEhvb2s6ICh1cmwsIHJlZik9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJzID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IGxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZVNjcmlwdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlcykgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJ3VybCcgaW4gcmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLnRoZW4oKCk9PntcbiAgICAgICAgICAgIHZhciBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzID0gZ2V0UmVtb3RlRW50cnlFeHBvcnRzKG5hbWUxLCBnbG9iYWxOYW1lKSwgcmVtb3RlRW50cnlLZXkgPSBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzLnJlbW90ZUVudHJ5S2V5LCBlbnRyeUV4cG9ydHMgPSBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzLmVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgIGFzc2VydChlbnRyeUV4cG9ydHMsIGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDAxLCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgcmVtb3RlTmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgcmVtb3RlRW50cnlVcmw6IGVudHJ5LFxuICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5S2V5XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gZW50cnlFeHBvcnRzO1xuICAgICAgICB9KS5jYXRjaCgoZSk9PntcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgIH0pO1xuICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBnZXRSZW1vdGVFbnRyeVVuaXF1ZUtleShyZW1vdGVJbmZvKSB7XG4gICAgdmFyIGVudHJ5ID0gcmVtb3RlSW5mby5lbnRyeSwgbmFtZTEgPSByZW1vdGVJbmZvLm5hbWU7XG4gICAgcmV0dXJuIHNkay5jb21wb3NlS2V5V2l0aFNlcGFyYXRvcihuYW1lMSwgZW50cnkpO1xufVxuZnVuY3Rpb24gZ2V0UmVtb3RlRW50cnkoXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIG9yaWdpbiA9IHJlZi5vcmlnaW4sIHJlbW90ZUVudHJ5RXhwb3J0cyA9IHJlZi5yZW1vdGVFbnRyeUV4cG9ydHMsIHJlbW90ZUluZm8gPSByZWYucmVtb3RlSW5mbztcbiAgICAgICAgdmFyIHVuaXF1ZUtleSA9IGdldFJlbW90ZUVudHJ5VW5pcXVlS2V5KHJlbW90ZUluZm8pO1xuICAgICAgICBpZiAocmVtb3RlRW50cnlFeHBvcnRzKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZ2xvYmFsTG9hZGluZ1t1bmlxdWVLZXldKSB7XG4gICAgICAgICAgICB2YXIgbG9hZEVudHJ5SG9vayA9IG9yaWdpbi5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5sb2FkRW50cnk7XG4gICAgICAgICAgICB2YXIgbG9hZGVySG9vayA9IG9yaWdpbi5sb2FkZXJIb29rO1xuICAgICAgICAgICAgZ2xvYmFsTG9hZGluZ1t1bmlxdWVLZXldID0gbG9hZEVudHJ5SG9vay5lbWl0KHtcbiAgICAgICAgICAgICAgICBsb2FkZXJIb29rLFxuICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICB9KS50aGVuKChyZXMpPT57XG4gICAgICAgICAgICAgICAgaWYgKHJlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gc2RrLmlzQnJvd3NlckVudigpID8gbG9hZEVudHJ5RG9tKHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzLFxuICAgICAgICAgICAgICAgICAgICBsb2FkZXJIb29rXG4gICAgICAgICAgICAgICAgfSkgOiBsb2FkRW50cnlOb2RlKHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVySG9va1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGdsb2JhbExvYWRpbmdbdW5pcXVlS2V5XTtcbiAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gZ2V0UmVtb3RlSW5mbyhyZW1vdGUpIHtcbiAgICByZXR1cm4gcG9seWZpbGxzLl9leHRlbmRzKHt9LCByZW1vdGUsIHtcbiAgICAgICAgZW50cnk6ICdlbnRyeScgaW4gcmVtb3RlID8gcmVtb3RlLmVudHJ5IDogJycsXG4gICAgICAgIHR5cGU6IHJlbW90ZS50eXBlIHx8IERFRkFVTFRfUkVNT1RFX1RZUEUsXG4gICAgICAgIGVudHJ5R2xvYmFsTmFtZTogcmVtb3RlLmVudHJ5R2xvYmFsTmFtZSB8fCByZW1vdGUubmFtZSxcbiAgICAgICAgc2hhcmVTY29wZTogcmVtb3RlLnNoYXJlU2NvcGUgfHwgREVGQVVMVF9TQ09QRVxuICAgIH0pO1xufVxudmFyIE1vZHVsZSA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gTW9kdWxlKHJlZikge1xuICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IHJlZi5yZW1vdGVJbmZvLCBob3N0ID0gcmVmLmhvc3Q7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgTW9kdWxlKTtcbiAgICAgICAgdGhpcy5pbml0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5saWIgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucmVtb3RlSW5mbyA9IHJlbW90ZUluZm87XG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhNb2R1bGUsIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldEVudHJ5XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RW50cnkoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHMgPSB5aWVsZCBnZXRSZW1vdGVFbnRyeSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB0aGlzLmhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbzogdGhpcy5yZW1vdGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0czogdGhpcy5yZW1vdGVFbnRyeUV4cG9ydHNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1bmlxdWVLZXkgPSBnZXRSZW1vdGVFbnRyeVVuaXF1ZUtleSh0aGlzLnJlbW90ZUluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgdGhpcy5ob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmxvYWRFbnRyeUVycm9yLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFJlbW90ZUVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogdGhpcy5ob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IHRoaXMucmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHM6IHRoaXMucmVtb3RlRW50cnlFeHBvcnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbExvYWRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pcXVlS2V5XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQocmVtb3RlRW50cnlFeHBvcnRzLCBgcmVtb3RlRW50cnlFeHBvcnRzIGlzIHVuZGVmaW5lZCBcXG4gJHtzZGsuc2FmZVRvU3RyaW5nKHRoaXMucmVtb3RlSW5mbyl9YCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3RlRW50cnlFeHBvcnRzID0gcmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldFwiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvZXhwbGljaXQtbW9kdWxlLWJvdW5kYXJ5LXR5cGVzXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXQoaWQsIGV4cG9zZSwgb3B0aW9ucywgcmVtb3RlU25hcHNob3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBvcHRpb25zIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRGYWN0b3J5OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0sIF9yZWZfbG9hZEZhY3RvcnkgPSBfcmVmLmxvYWRGYWN0b3J5LCBsb2FkRmFjdG9yeSA9IF9yZWZfbG9hZEZhY3RvcnkgPT09IHZvaWQgMCA/IHRydWUgOiBfcmVmX2xvYWRGYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgcmVtb3RlRW50cnkuanNcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5RXhwb3J0cyA9IHlpZWxkIHRoaXMuZ2V0RW50cnkoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmluaXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsU2hhcmVTY29wZU1hcCA9IHRoaXMuaG9zdC5zaGFyZVNjb3BlTWFwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZVNoYXJlU2NvcGUgPSB0aGlzLnJlbW90ZUluZm8uc2hhcmVTY29wZSB8fCAnZGVmYXVsdCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxvY2FsU2hhcmVTY29wZU1hcFtyZW1vdGVTaGFyZVNjb3BlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU2hhcmVTY29wZU1hcFtyZW1vdGVTaGFyZVNjb3BlXSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGUgPSBsb2NhbFNoYXJlU2NvcGVNYXBbcmVtb3RlU2hhcmVTY29wZV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5pdFNjb3BlID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnlJbml0T3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnJlbW90ZUluZm8udmVyc2lvbiB8fCAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhlbHAgdG8gZmluZCBob3N0IGluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVtb3RlRW50cnlJbml0T3B0aW9ucywgJ3NoYXJlU2NvcGVNYXAnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGxvY2FsU2hhcmVTY29wZU1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZW1vdGVFbnRyeUluaXRPcHRpb25zIHdpbGwgYmUgdHJhdmVyc2VkIGFuZCBhc3NpZ25lZCBkdXJpbmcgY29udGFpbmVyIGluaXQsICxzbyB0aGlzIGF0dHJpYnV0ZSBpcyBub3QgYWxsb3dlZCB0byBiZSB0cmF2ZXJzZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5pdENvbnRhaW5lck9wdGlvbnMgPSB5aWVsZCB0aGlzLmhvc3QuaG9va3MubGlmZWN5Y2xlLmJlZm9yZUluaXRDb250YWluZXIuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIHNoYXJlU2NvcGVNYXAgd2lsbCBiZSBzZXQgYnkgT2JqZWN0LmRlZmluZVByb3BlcnR5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlJbml0T3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0U2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbzogdGhpcy5yZW1vdGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogdGhpcy5ob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKHJlbW90ZUVudHJ5RXhwb3J0cyA9PSBudWxsID8gdm9pZCAwIDogcmVtb3RlRW50cnlFeHBvcnRzLmluaXQpID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDAyLCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZU5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5VXJsOiB0aGlzLnJlbW90ZUluZm8uZW50cnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5S2V5OiB0aGlzLnJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgcmVtb3RlRW50cnlFeHBvcnRzLmluaXQoaW5pdENvbnRhaW5lck9wdGlvbnMuc2hhcmVTY29wZSwgaW5pdENvbnRhaW5lck9wdGlvbnMuaW5pdFNjb3BlLCBpbml0Q29udGFpbmVyT3B0aW9ucy5yZW1vdGVFbnRyeUluaXRPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaG9zdC5ob29rcy5saWZlY3ljbGUuaW5pdENvbnRhaW5lci5lbWl0KHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgaW5pdENvbnRhaW5lck9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpYiA9IHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlRmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlRmFjdG9yeSA9IHlpZWxkIHRoaXMuaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5nZXRNb2R1bGVGYWN0b3J5LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbzogdGhpcy5yZW1vdGVJbmZvXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZXhwb3NlR2V0dGVyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbW9kdWxlRmFjdG9yeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlRmFjdG9yeSA9IHlpZWxkIHJlbW90ZUVudHJ5RXhwb3J0cy5nZXQoZXhwb3NlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobW9kdWxlRmFjdG9yeSwgYCR7Z2V0Rk1JZCh0aGlzLnJlbW90ZUluZm8pfSByZW1vdGUgZG9uJ3QgZXhwb3J0ICR7ZXhwb3NlfS5gKTtcbiAgICAgICAgICAgICAgICAgICAgLy8ga2VlcCBzeW1ib2wgZm9yIG1vZHVsZSBuYW1lIGFsd2F5cyBvbmUgZm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIHZhciBzeW1ib2xOYW1lID0gcHJvY2Vzc01vZHVsZUFsaWFzKHRoaXMucmVtb3RlSW5mby5uYW1lLCBleHBvc2UpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgd3JhcE1vZHVsZUZhY3RvcnkgPSB0aGlzLndyYXBlckZhY3RvcnkobW9kdWxlRmFjdG9yeSwgc3ltYm9sTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghbG9hZEZhY3RvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3cmFwTW9kdWxlRmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhwb3NlQ29udGVudCA9IHlpZWxkIHdyYXBNb2R1bGVGYWN0b3J5KCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBleHBvc2VDb250ZW50O1xuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJ3cmFwZXJGYWN0b3J5XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd3JhcGVyRmFjdG9yeShtb2R1bGVGYWN0b3J5LCBpZCkge1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRlZmluZU1vZHVsZUlkKHJlcywgaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyAmJiB0eXBlb2YgcmVzID09PSAnb2JqZWN0JyAmJiBPYmplY3QuaXNFeHRlbnNpYmxlKHJlcykgJiYgIU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocmVzLCBTeW1ib2wuZm9yKCdtZl9tb2R1bGVfaWQnKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXMsIFN5bWJvbC5mb3IoJ21mX21vZHVsZV9pZCcpLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobW9kdWxlRmFjdG9yeSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB5aWVsZCBtb2R1bGVGYWN0b3J5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBwYXJhbWV0ZXIgaXMgdXNlZCBmb3IgYnJpZGdlIGRlYnVnZ2luZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmluZU1vZHVsZUlkKHJlcywgaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IG1vZHVsZUZhY3RvcnkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgcGFyYW1ldGVyIGlzIHVzZWQgZm9yIGJyaWRnZSBkZWJ1Z2dpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmluZU1vZHVsZUlkKHJlcywgaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gTW9kdWxlO1xufSgpO1xudmFyIFN5bmNIb29rID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBTeW5jSG9vayh0eXBlKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU3luY0hvb2spO1xuICAgICAgICB0aGlzLnR5cGUgPSAnJztcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSBuZXcgU2V0KCk7XG4gICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTeW5jSG9vaywgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwib25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbihmbikge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnMuYWRkKGZuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJvbmNlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb25jZShmbikge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhc1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzLm9uKGZ1bmN0aW9uIHdyYXBwZXIoLi4uYXJncykge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnJlbW92ZSh3cmFwcGVyKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZW1pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGVtaXQoLi4uZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLmZvckVhY2goKGZuKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZm4uYXBwbHkodm9pZCAwLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGRhdGEpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZW1vdmVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoZm4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5kZWxldGUoZm4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVtb3ZlQWxsXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlQWxsKCkge1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLmNsZWFyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gU3luY0hvb2s7XG59KCk7XG52YXIgQXN5bmNIb29rID0gLyojX19QVVJFX18qLyBmdW5jdGlvbihTeW5jSG9vaykge1xuICAgIF9pbmhlcml0cy5fKEFzeW5jSG9vaywgU3luY0hvb2spO1xuICAgIGZ1bmN0aW9uIEFzeW5jSG9vaygpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBBc3luY0hvb2spO1xuICAgICAgICByZXR1cm4gX2NhbGxfc3VwZXIuXyh0aGlzLCBBc3luY0hvb2ssIGFyZ3VtZW50cyk7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhBc3luY0hvb2ssIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImVtaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlbWl0KC4uLmRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgICAgIHZhciBscyA9IEFycmF5LmZyb20odGhpcy5saXN0ZW5lcnMpO1xuICAgICAgICAgICAgICAgIGlmIChscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGwgPSAocHJldik9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gQWJvcnQgcHJvY2Vzc1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpIDwgbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShsc1tpKytdLmFwcGx5KG51bGwsIGRhdGEpKS50aGVuKGNhbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJldjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gY2FsbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gQXN5bmNIb29rO1xufShTeW5jSG9vayk7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xuZnVuY3Rpb24gY2hlY2tSZXR1cm5EYXRhKG9yaWdpbmFsRGF0YSwgcmV0dXJuZWREYXRhKSB7XG4gICAgaWYgKCFpc09iamVjdChyZXR1cm5lZERhdGEpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKG9yaWdpbmFsRGF0YSAhPT0gcmV0dXJuZWREYXRhKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXN5bnRheFxuICAgICAgICBmb3IodmFyIGtleSBpbiBvcmlnaW5hbERhdGEpe1xuICAgICAgICAgICAgaWYgKCEoa2V5IGluIHJldHVybmVkRGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG52YXIgU3luY1dhdGVyZmFsbEhvb2sgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKFN5bmNIb29rKSB7XG4gICAgX2luaGVyaXRzLl8oU3luY1dhdGVyZmFsbEhvb2ssIFN5bmNIb29rKTtcbiAgICBmdW5jdGlvbiBTeW5jV2F0ZXJmYWxsSG9vayh0eXBlKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU3luY1dhdGVyZmFsbEhvb2spO1xuICAgICAgICB2YXIgX3RoaXM7XG4gICAgICAgIF90aGlzID0gX2NhbGxfc3VwZXIuXyh0aGlzLCBTeW5jV2F0ZXJmYWxsSG9vayksIF90aGlzLm9uZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgX3RoaXMudHlwZSA9IHR5cGU7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFN5bmNXYXRlcmZhbGxIb29rLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJlbWl0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZW1pdChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc09iamVjdChkYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcihgVGhlIGRhdGEgZm9yIHRoZSBcIiR7dGhpcy50eXBlfVwiIGhvb2sgc2hvdWxkIGJlIGFuIG9iamVjdC5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZm4gb2YgdGhpcy5saXN0ZW5lcnMpe1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBEYXRhID0gZm4oZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2tSZXR1cm5EYXRhKGRhdGEsIHRlbXBEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0ZW1wRGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGBBIHBsdWdpbiByZXR1cm5lZCBhbiB1bmFjY2VwdGFibGUgdmFsdWUgZm9yIHRoZSBcIiR7dGhpcy50eXBlfVwiIHR5cGUuYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gU3luY1dhdGVyZmFsbEhvb2s7XG59KFN5bmNIb29rKTtcbnZhciBBc3luY1dhdGVyZmFsbEhvb2sgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKFN5bmNIb29rKSB7XG4gICAgX2luaGVyaXRzLl8oQXN5bmNXYXRlcmZhbGxIb29rLCBTeW5jSG9vayk7XG4gICAgZnVuY3Rpb24gQXN5bmNXYXRlcmZhbGxIb29rKHR5cGUpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBBc3luY1dhdGVyZmFsbEhvb2spO1xuICAgICAgICB2YXIgX3RoaXM7XG4gICAgICAgIF90aGlzID0gX2NhbGxfc3VwZXIuXyh0aGlzLCBBc3luY1dhdGVyZmFsbEhvb2spLCBfdGhpcy5vbmVycm9yID0gZXJyb3I7XG4gICAgICAgIF90aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhBc3luY1dhdGVyZmFsbEhvb2ssIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImVtaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlbWl0KGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWlzT2JqZWN0KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yKGBUaGUgcmVzcG9uc2UgZGF0YSBmb3IgdGhlIFwiJHt0aGlzLnR5cGV9XCIgaG9vayBtdXN0IGJlIGFuIG9iamVjdC5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGxzID0gQXJyYXkuZnJvbSh0aGlzLmxpc3RlbmVycyk7XG4gICAgICAgICAgICAgICAgaWYgKGxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0Vycm9yID0gKGUpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBjYWxsID0gKHByZXZEYXRhKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrUmV0dXJuRGF0YShkYXRhLCBwcmV2RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gcHJldkRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCBscy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobHNbaSsrXShkYXRhKSkudGhlbihjYWxsLCBwcm9jZXNzRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvY2Vzc0Vycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uZXJyb3IoYEEgcGx1Z2luIHJldHVybmVkIGFuIGluY29ycmVjdCB2YWx1ZSBmb3IgdGhlIFwiJHt0aGlzLnR5cGV9XCIgdHlwZS5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNhbGwoZGF0YSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIEFzeW5jV2F0ZXJmYWxsSG9vaztcbn0oU3luY0hvb2spO1xudmFyIFBsdWdpblN5c3RlbSA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gUGx1Z2luU3lzdGVtKGxpZmVjeWNsZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFBsdWdpblN5c3RlbSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJQbHVnaW5zID0ge307XG4gICAgICAgIHRoaXMubGlmZWN5Y2xlID0gbGlmZWN5Y2xlO1xuICAgICAgICB0aGlzLmxpZmVjeWNsZUtleXMgPSBPYmplY3Qua2V5cyhsaWZlY3ljbGUpO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oUGx1Z2luU3lzdGVtLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJhcHBseVBsdWdpblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5UGx1Z2luKHBsdWdpbikge1xuICAgICAgICAgICAgICAgIGFzc2VydChpc1BsYWluT2JqZWN0KHBsdWdpbiksICdQbHVnaW4gY29uZmlndXJhdGlvbiBpcyBpbnZhbGlkLicpO1xuICAgICAgICAgICAgICAgIC8vIFRoZSBwbHVnaW4ncyBuYW1lIGlzIG1hbmRhdG9yeSBhbmQgbXVzdCBiZSB1bmlxdWVcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2luTmFtZSA9IHBsdWdpbi5uYW1lO1xuICAgICAgICAgICAgICAgIGFzc2VydChwbHVnaW5OYW1lLCAnQSBuYW1lIG11c3QgYmUgcHJvdmlkZWQgYnkgdGhlIHBsdWdpbi4nKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdID0gcGx1Z2luO1xuICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmxpZmVjeWNsZSkuZm9yRWFjaCgoa2V5KT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsdWdpbkxpZmUgPSBwbHVnaW5ba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbHVnaW5MaWZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saWZlY3ljbGVba2V5XS5vbihwbHVnaW5MaWZlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVtb3ZlUGx1Z2luXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlUGx1Z2luKHBsdWdpbk5hbWUpIHtcbiAgICAgICAgICAgICAgICBhc3NlcnQocGx1Z2luTmFtZSwgJ0EgbmFtZSBpcyByZXF1aXJlZC4nKTtcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2luID0gdGhpcy5yZWdpc3RlclBsdWdpbnNbcGx1Z2luTmFtZV07XG4gICAgICAgICAgICAgICAgYXNzZXJ0KHBsdWdpbiwgYFRoZSBwbHVnaW4gXCIke3BsdWdpbk5hbWV9XCIgaXMgbm90IHJlZ2lzdGVyZWQuYCk7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMocGx1Z2luKS5mb3JFYWNoKChrZXkpPT57XG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgIT09ICduYW1lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saWZlY3ljbGVba2V5XS5yZW1vdmUocGx1Z2luW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tc2hhZG93XG4gICAgICAgICAgICBrZXk6IFwiaW5oZXJpdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaGVyaXQocmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpZmVjeWNsZSA9IHJlZi5saWZlY3ljbGUsIHJlZ2lzdGVyUGx1Z2lucyA9IHJlZi5yZWdpc3RlclBsdWdpbnM7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMobGlmZWN5Y2xlKS5mb3JFYWNoKChob29rTmFtZSk9PntcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCF0aGlzLmxpZmVjeWNsZVtob29rTmFtZV0sIGBUaGUgaG9vayBcIiR7aG9va05hbWV9XCIgaGFzIGEgY29uZmxpY3QgYW5kIGNhbm5vdCBiZSBpbmhlcml0ZWQuYCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlmZWN5Y2xlW2hvb2tOYW1lXSA9IGxpZmVjeWNsZVtob29rTmFtZV07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMocmVnaXN0ZXJQbHVnaW5zKS5mb3JFYWNoKChwbHVnaW5OYW1lKT0+e1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoIXRoaXMucmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdLCBgVGhlIHBsdWdpbiBcIiR7cGx1Z2luTmFtZX1cIiBoYXMgYSBjb25mbGljdCBhbmQgY2Fubm90IGJlIGluaGVyaXRlZC5gKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseVBsdWdpbihyZWdpc3RlclBsdWdpbnNbcGx1Z2luTmFtZV0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFBsdWdpblN5c3RlbTtcbn0oKTtcbmZ1bmN0aW9uIGRlZmF1bHRQcmVsb2FkQXJncyhwcmVsb2FkQ29uZmlnKSB7XG4gICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7XG4gICAgICAgIHJlc291cmNlQ2F0ZWdvcnk6ICdzeW5jJyxcbiAgICAgICAgc2hhcmU6IHRydWUsXG4gICAgICAgIGRlcHNSZW1vdGU6IHRydWUsXG4gICAgICAgIHByZWZldGNoSW50ZXJmYWNlOiBmYWxzZVxuICAgIH0sIHByZWxvYWRDb25maWcpO1xufVxuZnVuY3Rpb24gZm9ybWF0UHJlbG9hZEFyZ3MocmVtb3RlcywgcHJlbG9hZEFyZ3MpIHtcbiAgICByZXR1cm4gcHJlbG9hZEFyZ3MubWFwKChhcmdzKT0+e1xuICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IG1hdGNoUmVtb3RlKHJlbW90ZXMsIGFyZ3MubmFtZU9yQWxpYXMpO1xuICAgICAgICBhc3NlcnQocmVtb3RlSW5mbywgYFVuYWJsZSB0byBwcmVsb2FkICR7YXJncy5uYW1lT3JBbGlhc30gYXMgaXQgaXMgbm90IGluY2x1ZGVkIGluICR7IXJlbW90ZUluZm8gJiYgc2RrLnNhZmVUb1N0cmluZyh7XG4gICAgICAgICAgICByZW1vdGVJbmZvLFxuICAgICAgICAgICAgcmVtb3Rlc1xuICAgICAgICB9KX1gKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlbW90ZTogcmVtb3RlSW5mbyxcbiAgICAgICAgICAgIHByZWxvYWRDb25maWc6IGRlZmF1bHRQcmVsb2FkQXJncyhhcmdzKVxuICAgICAgICB9O1xuICAgIH0pO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplUHJlbG9hZEV4cG9zZXMoZXhwb3Nlcykge1xuICAgIGlmICghZXhwb3Nlcykge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIHJldHVybiBleHBvc2VzLm1hcCgoZXhwb3NlKT0+e1xuICAgICAgICBpZiAoZXhwb3NlID09PSAnLicpIHtcbiAgICAgICAgICAgIHJldHVybiBleHBvc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4cG9zZS5zdGFydHNXaXRoKCcuLycpKSB7XG4gICAgICAgICAgICByZXR1cm4gZXhwb3NlLnJlcGxhY2UoJy4vJywgJycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHBvc2U7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBwcmVsb2FkQXNzZXRzKHJlbW90ZUluZm8sIGhvc3QsIGFzc2V0cywgcmVmKSB7XG4gICAgdmFyIHVzZUxpbmtQcmVsb2FkID0gcmVmID09PSB2b2lkIDAgPyB0cnVlIDogcmVmO1xuICAgIHZhciBjc3NBc3NldHMgPSBhc3NldHMuY3NzQXNzZXRzLCBqc0Fzc2V0c1dpdGhvdXRFbnRyeSA9IGFzc2V0cy5qc0Fzc2V0c1dpdGhvdXRFbnRyeSwgZW50cnlBc3NldHMgPSBhc3NldHMuZW50cnlBc3NldHM7XG4gICAgaWYgKGhvc3Qub3B0aW9ucy5pbkJyb3dzZXIpIHtcbiAgICAgICAgZW50cnlBc3NldHMuZm9yRWFjaCgoYXNzZXQpPT57XG4gICAgICAgICAgICB2YXIgbW9kdWxlSW5mbyA9IGFzc2V0Lm1vZHVsZUluZm87XG4gICAgICAgICAgICB2YXIgbW9kdWxlID0gaG9zdC5tb2R1bGVDYWNoZS5nZXQocmVtb3RlSW5mby5uYW1lKTtcbiAgICAgICAgICAgIGlmIChtb2R1bGUpIHtcbiAgICAgICAgICAgICAgICBnZXRSZW1vdGVFbnRyeSh7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbzogbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzOiBtb2R1bGUucmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdldFJlbW90ZUVudHJ5KHtcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0LFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvOiBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHM6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHVzZUxpbmtQcmVsb2FkKSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdEF0dHJzID0ge1xuICAgICAgICAgICAgICAgIHJlbDogJ3ByZWxvYWQnLFxuICAgICAgICAgICAgICAgIGFzOiAnc3R5bGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY3NzQXNzZXRzLmZvckVhY2goKGNzc1VybCk9PntcbiAgICAgICAgICAgICAgICB2YXIgX3Nka19jcmVhdGVMaW5rID0gc2RrLmNyZWF0ZUxpbmsoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGNzc1VybCxcbiAgICAgICAgICAgICAgICAgICAgY2I6ICgpPT57XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vb3BcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYXR0cnM6IGRlZmF1bHRBdHRycyxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlTGlua0hvb2s6ICh1cmwsIGF0dHJzKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IGhvc3QubG9hZGVySG9vay5saWZlY3ljbGUuY3JlYXRlTGluay5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyBpbnN0YW5jZW9mIEhUTUxMaW5rRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSwgY3NzRWwgPSBfc2RrX2NyZWF0ZUxpbmsubGluaywgbmVlZEF0dGFjaCA9IF9zZGtfY3JlYXRlTGluay5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjc3NFbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0QXR0cnMxID0ge1xuICAgICAgICAgICAgICAgIHJlbDogJ3N0eWxlc2hlZXQnLFxuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0L2NzcydcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjc3NBc3NldHMuZm9yRWFjaCgoY3NzVXJsKT0+e1xuICAgICAgICAgICAgICAgIHZhciBfc2RrX2NyZWF0ZUxpbmsgPSBzZGsuY3JlYXRlTGluayh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogY3NzVXJsLFxuICAgICAgICAgICAgICAgICAgICBjYjogKCk9PntcbiAgICAgICAgICAgICAgICAgICAgLy8gbm9vcFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhdHRyczogZGVmYXVsdEF0dHJzMSxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlTGlua0hvb2s6ICh1cmwsIGF0dHJzKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IGhvc3QubG9hZGVySG9vay5saWZlY3ljbGUuY3JlYXRlTGluay5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyBpbnN0YW5jZW9mIEhUTUxMaW5rRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVMaW5rOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pLCBjc3NFbCA9IF9zZGtfY3JlYXRlTGluay5saW5rLCBuZWVkQXR0YWNoID0gX3Nka19jcmVhdGVMaW5rLm5lZWRBdHRhY2g7XG4gICAgICAgICAgICAgICAgbmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGNzc0VsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1c2VMaW5rUHJlbG9hZCkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRBdHRyczIgPSB7XG4gICAgICAgICAgICAgICAgcmVsOiAncHJlbG9hZCcsXG4gICAgICAgICAgICAgICAgYXM6ICdzY3JpcHQnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAganNBc3NldHNXaXRob3V0RW50cnkuZm9yRWFjaCgoanNVcmwpPT57XG4gICAgICAgICAgICAgICAgdmFyIF9zZGtfY3JlYXRlTGluayA9IHNkay5jcmVhdGVMaW5rKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBqc1VybCxcbiAgICAgICAgICAgICAgICAgICAgY2I6ICgpPT57XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vb3BcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYXR0cnM6IGRlZmF1bHRBdHRyczIsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxpbmtIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZUxpbmsuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MTGlua0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksIGxpbmtFbCA9IF9zZGtfY3JlYXRlTGluay5saW5rLCBuZWVkQXR0YWNoID0gX3Nka19jcmVhdGVMaW5rLm5lZWRBdHRhY2g7XG4gICAgICAgICAgICAgICAgbmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGxpbmtFbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0QXR0cnMzID0ge1xuICAgICAgICAgICAgICAgIGZldGNocHJpb3JpdHk6ICdoaWdoJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAocmVtb3RlSW5mbyA9PSBudWxsID8gdm9pZCAwIDogcmVtb3RlSW5mby50eXBlKSA9PT0gJ21vZHVsZScgPyAnbW9kdWxlJyA6ICd0ZXh0L2phdmFzY3JpcHQnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAganNBc3NldHNXaXRob3V0RW50cnkuZm9yRWFjaCgoanNVcmwpPT57XG4gICAgICAgICAgICAgICAgdmFyIF9zZGtfY3JlYXRlU2NyaXB0ID0gc2RrLmNyZWF0ZVNjcmlwdCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDoganNVcmwsXG4gICAgICAgICAgICAgICAgICAgIGNiOiAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAvLyBub29wXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzOiBkZWZhdWx0QXR0cnMzLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVTY3JpcHRIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZVNjcmlwdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyBpbnN0YW5jZW9mIEhUTUxTY3JpcHRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbmVlZERlbGV0ZVNjcmlwdDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pLCBzY3JpcHRFbCA9IF9zZGtfY3JlYXRlU2NyaXB0LnNjcmlwdCwgbmVlZEF0dGFjaCA9IF9zZGtfY3JlYXRlU2NyaXB0Lm5lZWRBdHRhY2g7XG4gICAgICAgICAgICAgICAgbmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdEVsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gYXNzaWduUmVtb3RlSW5mbyhyZW1vdGVJbmZvLCByZW1vdGVTbmFwc2hvdCkge1xuICAgIHZhciByZW1vdGVFbnRyeUluZm8gPSBnZXRSZW1vdGVFbnRyeUluZm9Gcm9tU25hcHNob3QocmVtb3RlU25hcHNob3QpO1xuICAgIGlmICghcmVtb3RlRW50cnlJbmZvLnVybCkge1xuICAgICAgICBlcnJvcihgVGhlIGF0dHJpYnV0ZSByZW1vdGVFbnRyeSBvZiAke3JlbW90ZUluZm8ubmFtZX0gbXVzdCBub3QgYmUgdW5kZWZpbmVkLmApO1xuICAgIH1cbiAgICB2YXIgZW50cnlVcmwgPSBzZGsuZ2V0UmVzb3VyY2VVcmwocmVtb3RlU25hcHNob3QsIHJlbW90ZUVudHJ5SW5mby51cmwpO1xuICAgIGlmICghc2RrLmlzQnJvd3NlckVudigpICYmICFlbnRyeVVybC5zdGFydHNXaXRoKCdodHRwJykpIHtcbiAgICAgICAgZW50cnlVcmwgPSBgaHR0cHM6JHtlbnRyeVVybH1gO1xuICAgIH1cbiAgICByZW1vdGVJbmZvLnR5cGUgPSByZW1vdGVFbnRyeUluZm8udHlwZTtcbiAgICByZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZSA9IHJlbW90ZUVudHJ5SW5mby5nbG9iYWxOYW1lO1xuICAgIHJlbW90ZUluZm8uZW50cnkgPSBlbnRyeVVybDtcbiAgICByZW1vdGVJbmZvLnZlcnNpb24gPSByZW1vdGVTbmFwc2hvdC52ZXJzaW9uO1xuICAgIHJlbW90ZUluZm8uYnVpbGRWZXJzaW9uID0gcmVtb3RlU25hcHNob3QuYnVpbGRWZXJzaW9uO1xufVxuZnVuY3Rpb24gc25hcHNob3RQbHVnaW4oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogJ3NuYXBzaG90LXBsdWdpbicsXG4gICAgICAgIGFmdGVyUmVzb2x2ZSAoYXJncykge1xuICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZSA9IGFyZ3MucmVtb3RlLCBwa2dOYW1lT3JBbGlhcyA9IGFyZ3MucGtnTmFtZU9yQWxpYXMsIGV4cG9zZSA9IGFyZ3MuZXhwb3NlLCBvcmlnaW4gPSBhcmdzLm9yaWdpbiwgcmVtb3RlSW5mbyA9IGFyZ3MucmVtb3RlSW5mbztcbiAgICAgICAgICAgICAgICBpZiAoIWlzUmVtb3RlSW5mb1dpdGhFbnRyeShyZW1vdGUpIHx8ICFpc1B1cmVSZW1vdGVFbnRyeShyZW1vdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgb3JpZ2luLnNuYXBzaG90SGFuZGxlci5sb2FkUmVtb3RlU25hcHNob3RJbmZvKHJlbW90ZSksIHJlbW90ZVNuYXBzaG90ID0gX3JlZi5yZW1vdGVTbmFwc2hvdCwgZ2xvYmFsU25hcHNob3QgPSBfcmVmLmdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICBhc3NpZ25SZW1vdGVJbmZvKHJlbW90ZUluZm8sIHJlbW90ZVNuYXBzaG90KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gcHJlbG9hZGluZyBhc3NldHNcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZWxvYWRPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlbG9hZENvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVPckFsaWFzOiBwa2dOYW1lT3JBbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VDYXRlZ29yeTogJ3N5bmMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXBzUmVtb3RlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXNzZXRzID0geWllbGQgb3JpZ2luLnJlbW90ZUhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLmdlbmVyYXRlUHJlbG9hZEFzc2V0cy5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhc3NldHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRBc3NldHMocmVtb3RlSW5mbywgb3JpZ2luLCBhc3NldHMsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBhcmdzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgICAgICAgICB9KSgpO1xuICAgICAgICB9XG4gICAgfTtcbn1cbi8vIG5hbWVcbi8vIG5hbWU6dmVyc2lvblxuZnVuY3Rpb24gc3BsaXRJZChpZCkge1xuICAgIHZhciBzcGxpdEluZm8gPSBpZC5zcGxpdCgnOicpO1xuICAgIGlmIChzcGxpdEluZm8ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBzcGxpdEluZm9bMF0sXG4gICAgICAgICAgICB2ZXJzaW9uOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHNwbGl0SW5mby5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IHNwbGl0SW5mb1swXSxcbiAgICAgICAgICAgIHZlcnNpb246IHNwbGl0SW5mb1sxXVxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBzcGxpdEluZm9bMV0sXG4gICAgICAgICAgICB2ZXJzaW9uOiBzcGxpdEluZm9bMl1cbiAgICAgICAgfTtcbiAgICB9XG59XG4vLyBUcmF2ZXJzZSBhbGwgbm9kZXMgaW4gbW9kdWxlSW5mbyBhbmQgdHJhdmVyc2UgdGhlIGVudGlyZSBzbmFwc2hvdFxuZnVuY3Rpb24gdHJhdmVyc2VNb2R1bGVJbmZvKGdsb2JhbFNuYXBzaG90LCByZW1vdGVJbmZvLCB0cmF2ZXJzZSwgaXNSb290LCByZWYsIHJlbW90ZVNuYXBzaG90KSB7XG4gICAgdmFyIG1lbW8gPSByZWYgPT09IHZvaWQgMCA/IHt9IDogcmVmO1xuICAgIHZhciBpZCA9IGdldEZNSWQocmVtb3RlSW5mbyk7XG4gICAgdmFyIF9nZXRJbmZvV2l0aG91dFR5cGUgPSBnZXRJbmZvV2l0aG91dFR5cGUoZ2xvYmFsU25hcHNob3QsIGlkKSwgc25hcHNob3RWYWx1ZSA9IF9nZXRJbmZvV2l0aG91dFR5cGUudmFsdWU7XG4gICAgdmFyIGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90ID0gcmVtb3RlU25hcHNob3QgfHwgc25hcHNob3RWYWx1ZTtcbiAgICBpZiAoZWZmZWN0aXZlUmVtb3RlU25hcHNob3QgJiYgIXNkay5pc01hbmlmZXN0UHJvdmlkZXIoZWZmZWN0aXZlUmVtb3RlU25hcHNob3QpKSB7XG4gICAgICAgIHRyYXZlcnNlKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LCByZW1vdGVJbmZvLCBpc1Jvb3QpO1xuICAgICAgICBpZiAoZWZmZWN0aXZlUmVtb3RlU25hcHNob3QucmVtb3Rlc0luZm8pIHtcbiAgICAgICAgICAgIHZhciByZW1vdGVLZXlzID0gT2JqZWN0LmtleXMoZWZmZWN0aXZlUmVtb3RlU25hcHNob3QucmVtb3Rlc0luZm8pO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IG9mIHJlbW90ZUtleXMpe1xuICAgICAgICAgICAgICAgIGlmIChtZW1vW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1lbW9ba2V5XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIHN1YlJlbW90ZUluZm8gPSBzcGxpdElkKGtleSk7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZVZhbHVlID0gZWZmZWN0aXZlUmVtb3RlU25hcHNob3QucmVtb3Rlc0luZm9ba2V5XTtcbiAgICAgICAgICAgICAgICB0cmF2ZXJzZU1vZHVsZUluZm8oZ2xvYmFsU25hcHNob3QsIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogc3ViUmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiByZW1vdGVWYWx1ZS5tYXRjaGVkVmVyc2lvblxuICAgICAgICAgICAgICAgIH0sIHRyYXZlcnNlLCBmYWxzZSwgbWVtbywgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGluZXMtcGVyLWZ1bmN0aW9uXG5mdW5jdGlvbiBnZW5lcmF0ZVByZWxvYWRBc3NldHMob3JpZ2luLCBwcmVsb2FkT3B0aW9ucywgcmVtb3RlLCBnbG9iYWxTbmFwc2hvdCwgcmVtb3RlU25hcHNob3QpIHtcbiAgICB2YXIgY3NzQXNzZXRzID0gW107XG4gICAgdmFyIGpzQXNzZXRzID0gW107XG4gICAgdmFyIGVudHJ5QXNzZXRzID0gW107XG4gICAgdmFyIGxvYWRlZFNoYXJlZEpzQXNzZXRzID0gbmV3IFNldCgpO1xuICAgIHZhciBsb2FkZWRTaGFyZWRDc3NBc3NldHMgPSBuZXcgU2V0KCk7XG4gICAgdmFyIG9wdGlvbnMgPSBvcmlnaW4ub3B0aW9ucztcbiAgICB2YXIgcm9vdFByZWxvYWRDb25maWcgPSBwcmVsb2FkT3B0aW9ucy5wcmVsb2FkQ29uZmlnO1xuICAgIHZhciBkZXBzUmVtb3RlID0gcm9vdFByZWxvYWRDb25maWcuZGVwc1JlbW90ZTtcbiAgICB2YXIgbWVtbyA9IHt9O1xuICAgIHRyYXZlcnNlTW9kdWxlSW5mbyhnbG9iYWxTbmFwc2hvdCwgcmVtb3RlLCAobW9kdWxlSW5mb1NuYXBzaG90LCByZW1vdGVJbmZvLCBpc1Jvb3QpPT57XG4gICAgICAgIHZhciBwcmVsb2FkQ29uZmlnO1xuICAgICAgICBpZiAoaXNSb290KSB7XG4gICAgICAgICAgICBwcmVsb2FkQ29uZmlnID0gcm9vdFByZWxvYWRDb25maWc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkZXBzUmVtb3RlKSkge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBhcnJheS1jYWxsYmFjay1yZXR1cm5cbiAgICAgICAgICAgICAgICB2YXIgZmluZFByZWxvYWRDb25maWcgPSBkZXBzUmVtb3RlLmZpbmQoKHJlbW90ZUNvbmZpZyk9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUNvbmZpZy5uYW1lT3JBbGlhcyA9PT0gcmVtb3RlSW5mby5uYW1lIHx8IHJlbW90ZUNvbmZpZy5uYW1lT3JBbGlhcyA9PT0gcmVtb3RlSW5mby5hbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmICghZmluZFByZWxvYWRDb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcmVsb2FkQ29uZmlnID0gZGVmYXVsdFByZWxvYWRBcmdzKGZpbmRQcmVsb2FkQ29uZmlnKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVwc1JlbW90ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHByZWxvYWRDb25maWcgPSByb290UHJlbG9hZENvbmZpZztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciByZW1vdGVFbnRyeVVybCA9IHNkay5nZXRSZXNvdXJjZVVybChtb2R1bGVJbmZvU25hcHNob3QsIGdldFJlbW90ZUVudHJ5SW5mb0Zyb21TbmFwc2hvdChtb2R1bGVJbmZvU25hcHNob3QpLnVybCk7XG4gICAgICAgIGlmIChyZW1vdGVFbnRyeVVybCkge1xuICAgICAgICAgICAgZW50cnlBc3NldHMucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgIG1vZHVsZUluZm86IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBlbnRyeTogcmVtb3RlRW50cnlVcmwsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZW1vdGVFbnRyeVR5cGUnIGluIG1vZHVsZUluZm9TbmFwc2hvdCA/IG1vZHVsZUluZm9TbmFwc2hvdC5yZW1vdGVFbnRyeVR5cGUgOiAnZ2xvYmFsJyxcbiAgICAgICAgICAgICAgICAgICAgZW50cnlHbG9iYWxOYW1lOiAnZ2xvYmFsTmFtZScgaW4gbW9kdWxlSW5mb1NuYXBzaG90ID8gbW9kdWxlSW5mb1NuYXBzaG90Lmdsb2JhbE5hbWUgOiByZW1vdGVJbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGU6ICcnLFxuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAndmVyc2lvbicgaW4gbW9kdWxlSW5mb1NuYXBzaG90ID8gbW9kdWxlSW5mb1NuYXBzaG90LnZlcnNpb24gOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHVybDogcmVtb3RlRW50cnlVcmxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtb2R1bGVBc3NldHNJbmZvID0gJ21vZHVsZXMnIGluIG1vZHVsZUluZm9TbmFwc2hvdCA/IG1vZHVsZUluZm9TbmFwc2hvdC5tb2R1bGVzIDogW107XG4gICAgICAgIHZhciBub3JtYWxpemVkUHJlbG9hZEV4cG9zZXMgPSBub3JtYWxpemVQcmVsb2FkRXhwb3NlcyhwcmVsb2FkQ29uZmlnLmV4cG9zZXMpO1xuICAgICAgICBpZiAobm9ybWFsaXplZFByZWxvYWRFeHBvc2VzLmxlbmd0aCAmJiAnbW9kdWxlcycgaW4gbW9kdWxlSW5mb1NuYXBzaG90KSB7XG4gICAgICAgICAgICB2YXIgX21vZHVsZUluZm9TbmFwc2hvdF9tb2R1bGVzO1xuICAgICAgICAgICAgbW9kdWxlQXNzZXRzSW5mbyA9IG1vZHVsZUluZm9TbmFwc2hvdCA9PSBudWxsID8gdm9pZCAwIDogKF9tb2R1bGVJbmZvU25hcHNob3RfbW9kdWxlcyA9IG1vZHVsZUluZm9TbmFwc2hvdC5tb2R1bGVzKSA9PSBudWxsID8gdm9pZCAwIDogX21vZHVsZUluZm9TbmFwc2hvdF9tb2R1bGVzLnJlZHVjZSgoYXNzZXRzLCBtb2R1bGVBc3NldEluZm8pPT57XG4gICAgICAgICAgICAgICAgaWYgKChub3JtYWxpemVkUHJlbG9hZEV4cG9zZXMgPT0gbnVsbCA/IHZvaWQgMCA6IG5vcm1hbGl6ZWRQcmVsb2FkRXhwb3Nlcy5pbmRleE9mKG1vZHVsZUFzc2V0SW5mby5tb2R1bGVOYW1lKSkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0cy5wdXNoKG1vZHVsZUFzc2V0SW5mbyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhc3NldHM7XG4gICAgICAgICAgICB9LCBbXSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlQXNzZXRzKGFzc2V0cykge1xuICAgICAgICAgICAgdmFyIGFzc2V0c1JlcyA9IGFzc2V0cy5tYXAoKGFzc2V0KT0+c2RrLmdldFJlc291cmNlVXJsKG1vZHVsZUluZm9TbmFwc2hvdCwgYXNzZXQpKTtcbiAgICAgICAgICAgIGlmIChwcmVsb2FkQ29uZmlnLmZpbHRlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBhc3NldHNSZXMuZmlsdGVyKHByZWxvYWRDb25maWcuZmlsdGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhc3NldHNSZXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZHVsZUFzc2V0c0luZm8pIHtcbiAgICAgICAgICAgIHZhciBhc3NldHNMZW5ndGggPSBtb2R1bGVBc3NldHNJbmZvLmxlbmd0aDtcbiAgICAgICAgICAgIGZvcih2YXIgaW5kZXggPSAwOyBpbmRleCA8IGFzc2V0c0xlbmd0aDsgaW5kZXgrKyl7XG4gICAgICAgICAgICAgICAgdmFyIGFzc2V0c0luZm8gPSBtb2R1bGVBc3NldHNJbmZvW2luZGV4XTtcbiAgICAgICAgICAgICAgICB2YXIgZXhwb3NlRnVsbFBhdGggPSBgJHtyZW1vdGVJbmZvLm5hbWV9LyR7YXNzZXRzSW5mby5tb2R1bGVOYW1lfWA7XG4gICAgICAgICAgICAgICAgb3JpZ2luLnJlbW90ZUhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLmhhbmRsZVByZWxvYWRNb2R1bGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBhc3NldHNJbmZvLm1vZHVsZU5hbWUgPT09ICcuJyA/IHJlbW90ZUluZm8ubmFtZSA6IGV4cG9zZUZ1bGxQYXRoLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGVJbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBtb2R1bGVJbmZvU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgIHByZWxvYWRDb25maWcsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZTogcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHByZWxvYWRlZCA9IGdldFByZWxvYWRlZChleHBvc2VGdWxsUGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKHByZWxvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHByZWxvYWRDb25maWcucmVzb3VyY2VDYXRlZ29yeSA9PT0gJ2FsbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9jc3NBc3NldHMsIF9jc3NBc3NldHMxLCBfanNBc3NldHMsIF9qc0Fzc2V0czE7XG4gICAgICAgICAgICAgICAgICAgIChfY3NzQXNzZXRzID0gY3NzQXNzZXRzKS5wdXNoLmFwcGx5KF9jc3NBc3NldHMsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmNzcy5hc3luYykpKTtcbiAgICAgICAgICAgICAgICAgICAgKF9jc3NBc3NldHMxID0gY3NzQXNzZXRzKS5wdXNoLmFwcGx5KF9jc3NBc3NldHMxLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5jc3Muc3luYykpKTtcbiAgICAgICAgICAgICAgICAgICAgKF9qc0Fzc2V0cyA9IGpzQXNzZXRzKS5wdXNoLmFwcGx5KF9qc0Fzc2V0cywgX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhoYW5kbGVBc3NldHMoYXNzZXRzSW5mby5hc3NldHMuanMuYXN5bmMpKSk7XG4gICAgICAgICAgICAgICAgICAgIChfanNBc3NldHMxID0ganNBc3NldHMpLnB1c2guYXBwbHkoX2pzQXNzZXRzMSwgX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhoYW5kbGVBc3NldHMoYXNzZXRzSW5mby5hc3NldHMuanMuc3luYykpKTtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcmVsb2FkQ29uZmlnLnJlc291cmNlQ2F0ZWdvcnkgPSAnc3luYycpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9jc3NBc3NldHMyLCBfanNBc3NldHMyO1xuICAgICAgICAgICAgICAgICAgICAoX2Nzc0Fzc2V0czIgPSBjc3NBc3NldHMpLnB1c2guYXBwbHkoX2Nzc0Fzc2V0czIsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmNzcy5zeW5jKSkpO1xuICAgICAgICAgICAgICAgICAgICAoX2pzQXNzZXRzMiA9IGpzQXNzZXRzKS5wdXNoLmFwcGx5KF9qc0Fzc2V0czIsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmpzLnN5bmMpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNldFByZWxvYWRlZChleHBvc2VGdWxsUGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB0cnVlLCBtZW1vLCByZW1vdGVTbmFwc2hvdCk7XG4gICAgaWYgKHJlbW90ZVNuYXBzaG90LnNoYXJlZCkge1xuICAgICAgICB2YXIgY29sbGVjdFNoYXJlZEFzc2V0cyA9IChzaGFyZUluZm8sIHNuYXBzaG90U2hhcmVkKT0+e1xuICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUob3JpZ2luLnNoYXJlU2NvcGVNYXAsIHNuYXBzaG90U2hhcmVkLnNoYXJlZE5hbWUsIHNoYXJlSW5mbywgb3JpZ2luLnNoYXJlZEhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAvLyBJZiB0aGUgZ2xvYmFsIHNoYXJlIGRvZXMgbm90IGV4aXN0LCBvciB0aGUgbGliIGZ1bmN0aW9uIGRvZXMgbm90IGV4aXN0LCBpdCBtZWFucyB0aGF0IHRoZSBzaGFyZWQgaGFzIG5vdCBiZWVuIGxvYWRlZCB5ZXQgYW5kIGNhbiBiZSBwcmVsb2FkZWQuXG4gICAgICAgICAgICBpZiAocmVnaXN0ZXJlZFNoYXJlZCAmJiB0eXBlb2YgcmVnaXN0ZXJlZFNoYXJlZC5saWIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBzbmFwc2hvdFNoYXJlZC5hc3NldHMuanMuc3luYy5mb3JFYWNoKChhc3NldCk9PntcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVkU2hhcmVkSnNBc3NldHMuYWRkKGFzc2V0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBzbmFwc2hvdFNoYXJlZC5hc3NldHMuY3NzLnN5bmMuZm9yRWFjaCgoYXNzZXQpPT57XG4gICAgICAgICAgICAgICAgICAgIGxvYWRlZFNoYXJlZENzc0Fzc2V0cy5hZGQoYXNzZXQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZW1vdGVTbmFwc2hvdC5zaGFyZWQuZm9yRWFjaCgoc2hhcmVkKT0+e1xuICAgICAgICAgICAgdmFyIF9vcHRpb25zX3NoYXJlZDtcbiAgICAgICAgICAgIHZhciBzaGFyZUluZm9zID0gKF9vcHRpb25zX3NoYXJlZCA9IG9wdGlvbnMuc2hhcmVkKSA9PSBudWxsID8gdm9pZCAwIDogX29wdGlvbnNfc2hhcmVkW3NoYXJlZC5zaGFyZWROYW1lXTtcbiAgICAgICAgICAgIGlmICghc2hhcmVJbmZvcykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIG5vIHZlcnNpb24sIHByZWxvYWQgYWxsIHNoYXJlZFxuICAgICAgICAgICAgdmFyIHNoYXJlZE9wdGlvbnMgPSBzaGFyZWQudmVyc2lvbiA/IHNoYXJlSW5mb3MuZmluZCgocyk9PnMudmVyc2lvbiA9PT0gc2hhcmVkLnZlcnNpb24pIDogc2hhcmVJbmZvcztcbiAgICAgICAgICAgIGlmICghc2hhcmVkT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhcnJheVNoYXJlSW5mbyA9IGFycmF5T3B0aW9ucyhzaGFyZWRPcHRpb25zKTtcbiAgICAgICAgICAgIGFycmF5U2hhcmVJbmZvLmZvckVhY2goKHMpPT57XG4gICAgICAgICAgICAgICAgY29sbGVjdFNoYXJlZEFzc2V0cyhzLCBzaGFyZWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB2YXIgbmVlZFByZWxvYWRKc0Fzc2V0cyA9IGpzQXNzZXRzLmZpbHRlcigoYXNzZXQpPT4hbG9hZGVkU2hhcmVkSnNBc3NldHMuaGFzKGFzc2V0KSk7XG4gICAgdmFyIG5lZWRQcmVsb2FkQ3NzQXNzZXRzID0gY3NzQXNzZXRzLmZpbHRlcigoYXNzZXQpPT4hbG9hZGVkU2hhcmVkQ3NzQXNzZXRzLmhhcyhhc3NldCkpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNzc0Fzc2V0czogbmVlZFByZWxvYWRDc3NBc3NldHMsXG4gICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5OiBuZWVkUHJlbG9hZEpzQXNzZXRzLFxuICAgICAgICBlbnRyeUFzc2V0c1xuICAgIH07XG59XG52YXIgZ2VuZXJhdGVQcmVsb2FkQXNzZXRzUGx1Z2luID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogJ2dlbmVyYXRlLXByZWxvYWQtYXNzZXRzLXBsdWdpbicsXG4gICAgICAgIGdlbmVyYXRlUHJlbG9hZEFzc2V0cyAoYXJncykge1xuICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9yaWdpbiA9IGFyZ3Mub3JpZ2luLCBwcmVsb2FkT3B0aW9ucyA9IGFyZ3MucHJlbG9hZE9wdGlvbnMsIHJlbW90ZUluZm8gPSBhcmdzLnJlbW90ZUluZm8sIHJlbW90ZSA9IGFyZ3MucmVtb3RlLCBnbG9iYWxTbmFwc2hvdCA9IGFyZ3MuZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90ID0gYXJncy5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICBpZiAoaXNSZW1vdGVJbmZvV2l0aEVudHJ5KHJlbW90ZSkgJiYgaXNQdXJlUmVtb3RlRW50cnkocmVtb3RlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3NzQXNzZXRzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5OiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5QXNzZXRzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiByZW1vdGUuZW50cnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm86IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5OiByZW1vdGUuZW50cnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiByZW1vdGVJbmZvLnR5cGUgfHwgJ2dsb2JhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeUdsb2JhbE5hbWU6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZTogJydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXNzaWduUmVtb3RlSW5mbyhyZW1vdGVJbmZvLCByZW1vdGVTbmFwc2hvdCk7XG4gICAgICAgICAgICAgICAgdmFyIGFzc2V0cyA9IGdlbmVyYXRlUHJlbG9hZEFzc2V0cyhvcmlnaW4sIHByZWxvYWRPcHRpb25zLCByZW1vdGVJbmZvLCBnbG9iYWxTbmFwc2hvdCwgcmVtb3RlU25hcHNob3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhc3NldHM7XG4gICAgICAgICAgICB9KSgpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG5mdW5jdGlvbiBnZXRHbG9iYWxSZW1vdGVJbmZvKG1vZHVsZUluZm8sIG9yaWdpbikge1xuICAgIHZhciBob3N0R2xvYmFsU25hcHNob3QgPSBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICBuYW1lOiBvcmlnaW4ub3B0aW9ucy5uYW1lLFxuICAgICAgICB2ZXJzaW9uOiBvcmlnaW4ub3B0aW9ucy52ZXJzaW9uXG4gICAgfSk7XG4gICAgLy8gZ2V0IHJlbW90ZSBkZXRhaWwgaW5mbyBmcm9tIGdsb2JhbFxuICAgIHZhciBnbG9iYWxSZW1vdGVJbmZvID0gaG9zdEdsb2JhbFNuYXBzaG90ICYmICdyZW1vdGVzSW5mbycgaW4gaG9zdEdsb2JhbFNuYXBzaG90ICYmIGhvc3RHbG9iYWxTbmFwc2hvdC5yZW1vdGVzSW5mbyAmJiBnZXRJbmZvV2l0aG91dFR5cGUoaG9zdEdsb2JhbFNuYXBzaG90LnJlbW90ZXNJbmZvLCBtb2R1bGVJbmZvLm5hbWUpLnZhbHVlO1xuICAgIGlmIChnbG9iYWxSZW1vdGVJbmZvICYmIGdsb2JhbFJlbW90ZUluZm8ubWF0Y2hlZFZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGhvc3RHbG9iYWxTbmFwc2hvdCxcbiAgICAgICAgICAgIGdsb2JhbFNuYXBzaG90OiBnZXRHbG9iYWxTbmFwc2hvdCgpLFxuICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyh7XG4gICAgICAgICAgICAgICAgbmFtZTogbW9kdWxlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IGdsb2JhbFJlbW90ZUluZm8ubWF0Y2hlZFZlcnNpb25cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGhvc3RHbG9iYWxTbmFwc2hvdDogdW5kZWZpbmVkLFxuICAgICAgICBnbG9iYWxTbmFwc2hvdDogZ2V0R2xvYmFsU25hcHNob3QoKSxcbiAgICAgICAgcmVtb3RlU25hcHNob3Q6IGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyh7XG4gICAgICAgICAgICBuYW1lOiBtb2R1bGVJbmZvLm5hbWUsXG4gICAgICAgICAgICB2ZXJzaW9uOiAndmVyc2lvbicgaW4gbW9kdWxlSW5mbyA/IG1vZHVsZUluZm8udmVyc2lvbiA6IHVuZGVmaW5lZFxuICAgICAgICB9KVxuICAgIH07XG59XG52YXIgU25hcHNob3RIYW5kbGVyID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBTbmFwc2hvdEhhbmRsZXIoSG9zdEluc3RhbmNlKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU25hcHNob3RIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5sb2FkaW5nSG9zdFNuYXBzaG90ID0gbnVsbDtcbiAgICAgICAgdGhpcy5tYW5pZmVzdENhY2hlID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmhvb2tzID0gbmV3IFBsdWdpblN5c3RlbSh7XG4gICAgICAgICAgICBiZWZvcmVMb2FkUmVtb3RlU25hcHNob3Q6IG5ldyBBc3luY0hvb2soJ2JlZm9yZUxvYWRSZW1vdGVTbmFwc2hvdCcpLFxuICAgICAgICAgICAgbG9hZFNuYXBzaG90OiBuZXcgQXN5bmNXYXRlcmZhbGxIb29rKCdsb2FkR2xvYmFsU25hcHNob3QnKSxcbiAgICAgICAgICAgIGxvYWRSZW1vdGVTbmFwc2hvdDogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnbG9hZFJlbW90ZVNuYXBzaG90JyksXG4gICAgICAgICAgICBhZnRlckxvYWRTbmFwc2hvdDogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYWZ0ZXJMb2FkU25hcHNob3QnKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5tYW5pZmVzdExvYWRpbmcgPSBHbG9iYWwuX19GRURFUkFUSU9OX18uX19NQU5JRkVTVF9MT0FESU5HX187XG4gICAgICAgIHRoaXMuSG9zdEluc3RhbmNlID0gSG9zdEluc3RhbmNlO1xuICAgICAgICB0aGlzLmxvYWRlckhvb2sgPSBIb3N0SW5zdGFuY2UubG9hZGVySG9vaztcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFNuYXBzaG90SGFuZGxlciwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNuYXBzaG90XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFNuYXBzaG90KG1vZHVsZUluZm8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mbyA9IHRoaXMuZ2V0R2xvYmFsUmVtb3RlSW5mbyhtb2R1bGVJbmZvKSwgaG9zdEdsb2JhbFNuYXBzaG90ID0gX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mby5ob3N0R2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90ID0gX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mby5yZW1vdGVTbmFwc2hvdCwgZ2xvYmFsU25hcHNob3QgPSBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvLmdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmxvYWRTbmFwc2hvdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdEdsb2JhbFNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdFxuICAgICAgICAgICAgICAgICAgICB9KSwgZ2xvYmFsUmVtb3RlU25hcHNob3QgPSBfcmVmLnJlbW90ZVNuYXBzaG90LCBnbG9iYWxTbmFwc2hvdFJlcyA9IF9yZWYuZ2xvYmFsU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdDogZ2xvYmFsUmVtb3RlU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdDogZ2xvYmFsU25hcHNob3RSZXNcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFJlbW90ZVNuYXBzaG90SW5mb1wiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGluZXMtcGVyLWZ1bmN0aW9uXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2FkUmVtb3RlU25hcHNob3RJbmZvKG1vZHVsZUluZm8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVMb2FkUmVtb3RlU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3RTbmFwc2hvdCA9IGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLnZlcnNpb25cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaG9zdFNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0U25hcHNob3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucy52ZXJzaW9uIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5OiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVzSW5mbzoge31cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRHbG9iYWxTbmFwc2hvdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW3RoaXMuSG9zdEluc3RhbmNlLm9wdGlvbnMubmFtZV06IGhvc3RTbmFwc2hvdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gSW4gZHluYW1pYyBsb2FkUmVtb3RlIHNjZW5hcmlvcywgaW5jb21wbGV0ZSByZW1vdGVzSW5mbyBkZWxpdmVyeSBtYXkgb2NjdXIuIEluIHN1Y2ggY2FzZXMsIHRoZSByZW1vdGVzSW5mbyBpbiB0aGUgaG9zdCBuZWVkcyB0byBiZSBjb21wbGV0ZWQgaW4gdGhlIHNuYXBzaG90IGF0IHJ1bnRpbWUuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZW5zdXJlcyB0aGUgc25hcHNob3QncyBpbnRlZ3JpdHkgYW5kIGhlbHBzIHRoZSBjaHJvbWUgcGx1Z2luIGNvcnJlY3RseSBpZGVudGlmeSBhbGwgcHJvZHVjZXIgbW9kdWxlcywgZW5zdXJpbmcgdGhhdCBwcm94eWFibGUgcHJvZHVjZXIgbW9kdWxlcyB3aWxsIG5vdCBiZSBtaXNzaW5nLlxuICAgICAgICAgICAgICAgICAgICBpZiAoaG9zdFNuYXBzaG90ICYmICdyZW1vdGVzSW5mbycgaW4gaG9zdFNuYXBzaG90ICYmICFnZXRJbmZvV2l0aG91dFR5cGUoaG9zdFNuYXBzaG90LnJlbW90ZXNJbmZvLCBtb2R1bGVJbmZvLm5hbWUpLnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ3ZlcnNpb24nIGluIG1vZHVsZUluZm8gfHwgJ2VudHJ5JyBpbiBtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFNuYXBzaG90LnJlbW90ZXNJbmZvID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBob3N0U25hcHNob3QgPT0gbnVsbCA/IHZvaWQgMCA6IGhvc3RTbmFwc2hvdC5yZW1vdGVzSW5mbywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbW9kdWxlSW5mby5uYW1lXToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZFZlcnNpb246ICd2ZXJzaW9uJyBpbiBtb2R1bGVJbmZvID8gbW9kdWxlSW5mby52ZXJzaW9uIDogbW9kdWxlSW5mby5lbnRyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8gPSB0aGlzLmdldEdsb2JhbFJlbW90ZUluZm8obW9kdWxlSW5mbyksIGhvc3RHbG9iYWxTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8uaG9zdEdsb2JhbFNuYXBzaG90LCByZW1vdGVTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8ucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90ID0gX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mby5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5sb2FkU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RHbG9iYWxTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfSksIGdsb2JhbFJlbW90ZVNuYXBzaG90ID0gX3JlZi5yZW1vdGVTbmFwc2hvdCwgZ2xvYmFsU25hcHNob3RSZXMgPSBfcmVmLmdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICB2YXIgbVNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ1NuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAvLyBnbG9iYWwgc25hcHNob3QgaW5jbHVkZXMgbWFuaWZlc3Qgb3IgbW9kdWxlIGluZm8gaW5jbHVkZXMgbWFuaWZlc3RcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdsb2JhbFJlbW90ZVNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2RrLmlzTWFuaWZlc3RQcm92aWRlcihnbG9iYWxSZW1vdGVTbmFwc2hvdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnkgPSBzZGsuaXNCcm93c2VyRW52KCkgPyBnbG9iYWxSZW1vdGVTbmFwc2hvdC5yZW1vdGVFbnRyeSA6IGdsb2JhbFJlbW90ZVNuYXBzaG90LnNzclJlbW90ZUVudHJ5IHx8IGdsb2JhbFJlbW90ZVNuYXBzaG90LnJlbW90ZUVudHJ5IHx8ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2R1bGVTbmFwc2hvdCA9IHlpZWxkIHRoaXMuZ2V0TWFuaWZlc3RKc29uKHJlbW90ZUVudHJ5LCBtb2R1bGVJbmZvLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1zaGFkb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2xvYmFsU25hcHNob3RSZXMxID0gc2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvKHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgbW9kdWxlSW5mbywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZ2xvYmFsIHJlbW90ZSBtYXkgYmUgb3ZlcnJpZGRlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZWZvcmUsIHNldCB0aGUgc25hcHNob3Qga2V5IHRvIHRoZSBnbG9iYWwgYWRkcmVzcyBvZiB0aGUgYWN0dWFsIHJlcXVlc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnk6IHJlbW90ZUVudHJ5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksIG1vZHVsZVNuYXBzaG90KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtU25hcHNob3QgPSBtb2R1bGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU25hcHNob3QgPSBnbG9iYWxTbmFwc2hvdFJlczE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMSA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmxvYWRSZW1vdGVTbmFwc2hvdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IGdsb2JhbFJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAnZ2xvYmFsJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCByZW1vdGVTbmFwc2hvdFJlcyA9IF9yZWYxLnJlbW90ZVNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1TbmFwc2hvdCA9IHJlbW90ZVNuYXBzaG90UmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdTbmFwc2hvdCA9IGdsb2JhbFNuYXBzaG90UmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzUmVtb3RlSW5mb1dpdGhFbnRyeShtb2R1bGVJbmZvKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBmcm9tIG1hbmlmZXN0Lmpzb24gYW5kIG1lcmdlIHJlbW90ZSBpbmZvIGZyb20gcmVtb3RlIHNlcnZlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2R1bGVTbmFwc2hvdDEgPSB5aWVsZCB0aGlzLmdldE1hbmlmZXN0SnNvbihtb2R1bGVJbmZvLmVudHJ5LCBtb2R1bGVJbmZvLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1zaGFkb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2xvYmFsU25hcHNob3RSZXMyID0gc2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvKG1vZHVsZUluZm8sIG1vZHVsZVNuYXBzaG90MSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYyID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUubG9hZFJlbW90ZVNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdDogbW9kdWxlU25hcHNob3QxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAnZ2xvYmFsJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCByZW1vdGVTbmFwc2hvdFJlczEgPSBfcmVmMi5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtU25hcHNob3QgPSByZW1vdGVTbmFwc2hvdFJlczE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NuYXBzaG90ID0gZ2xvYmFsU25hcHNob3RSZXMyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcihlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwNywgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogbW9kdWxlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0VmVyc2lvbjogbW9kdWxlSW5mby52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdDogSlNPTi5zdHJpbmdpZnkoZ2xvYmFsU25hcHNob3RSZXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmFmdGVyTG9hZFNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdDogbVNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IG1TbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNuYXBzaG90OiBnU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZ2V0R2xvYmFsUmVtb3RlSW5mb1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEdsb2JhbFJlbW90ZUluZm8xKG1vZHVsZUluZm8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0R2xvYmFsUmVtb3RlSW5mbyhtb2R1bGVJbmZvLCB0aGlzLkhvc3RJbnN0YW5jZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRNYW5pZmVzdEpzb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRNYW5pZmVzdEpzb24obWFuaWZlc3RVcmwsIG1vZHVsZUluZm8sIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0TWFuaWZlc3QgPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFuaWZlc3RKc29uID0gdGhpcy5tYW5pZmVzdENhY2hlLmdldChtYW5pZmVzdFVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hbmlmZXN0SnNvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWFuaWZlc3RKc29uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0geWllbGQgdGhpcy5sb2FkZXJIb29rLmxpZmVjeWNsZS5mZXRjaC5lbWl0KG1hbmlmZXN0VXJsLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzIHx8ICEocmVzIGluc3RhbmNlb2YgUmVzcG9uc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMgPSB5aWVsZCBmZXRjaChtYW5pZmVzdFVybCwge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0SnNvbiA9IHlpZWxkIHJlcy5qc29uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0SnNvbiA9IHlpZWxkIHRoaXMuSG9zdEluc3RhbmNlLnJlbW90ZUhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLmVycm9yTG9hZFJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBtYW5pZmVzdFVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ3J1bnRpbWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlmZWN5Y2xlOiAnYWZ0ZXJSZXNvbHZlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogdGhpcy5Ib3N0SW5zdGFuY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWFuaWZlc3RKc29uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5tYW5pZmVzdExvYWRpbmdbbWFuaWZlc3RVcmxdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDMsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdFVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVOYW1lOiBtb2R1bGVJbmZvLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGAke2Vycn1gKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1hbmlmZXN0SnNvbi5tZXRhRGF0YSAmJiBtYW5pZmVzdEpzb24uZXhwb3NlcyAmJiBtYW5pZmVzdEpzb24uc2hhcmVkLCBgJHttYW5pZmVzdFVybH0gaXMgbm90IGEgZmVkZXJhdGlvbiBtYW5pZmVzdGApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFuaWZlc3RDYWNoZS5zZXQobWFuaWZlc3RVcmwsIG1hbmlmZXN0SnNvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hbmlmZXN0SnNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhc3luY0xvYWRQcm9jZXNzID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hbmlmZXN0SnNvbiA9IHlpZWxkIGdldE1hbmlmZXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZVNuYXBzaG90ID0gc2RrLmdlbmVyYXRlU25hcHNob3RGcm9tTWFuaWZlc3QobWFuaWZlc3RKc29uLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IG1hbmlmZXN0VXJsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5sb2FkUmVtb3RlU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuSG9zdEluc3RhbmNlLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0SnNvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0VXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAnbWFuaWZlc3QnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksIHJlbW90ZVNuYXBzaG90UmVzID0gX3JlZi5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3RlU25hcHNob3RSZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubWFuaWZlc3RMb2FkaW5nW21hbmlmZXN0VXJsXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdExvYWRpbmdbbWFuaWZlc3RVcmxdID0gYXN5bmNMb2FkUHJvY2VzcygpLnRoZW4oKHJlcyk9PnJlcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWFuaWZlc3RMb2FkaW5nW21hbmlmZXN0VXJsXTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFNuYXBzaG90SGFuZGxlcjtcbn0oKTtcbnZhciBTaGFyZWRIYW5kbGVyID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBTaGFyZWRIYW5kbGVyKGhvc3QpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBTaGFyZWRIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5ob29rcyA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYWZ0ZXJSZXNvbHZlOiBuZXcgQXN5bmNXYXRlcmZhbGxIb29rKCdhZnRlclJlc29sdmUnKSxcbiAgICAgICAgICAgIGJlZm9yZUxvYWRTaGFyZTogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYmVmb3JlTG9hZFNoYXJlJyksXG4gICAgICAgICAgICAvLyBub3QgdXNlZCB5ZXRcbiAgICAgICAgICAgIGxvYWRTaGFyZTogbmV3IEFzeW5jSG9vaygpLFxuICAgICAgICAgICAgcmVzb2x2ZVNoYXJlOiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ3Jlc29sdmVTaGFyZScpLFxuICAgICAgICAgICAgLy8gbWF5YmUgd2lsbCBjaGFuZ2UsIHRlbXBvcmFyaWx5IGZvciBpbnRlcm5hbCB1c2Ugb25seVxuICAgICAgICAgICAgaW5pdENvbnRhaW5lclNoYXJlU2NvcGVNYXA6IG5ldyBTeW5jV2F0ZXJmYWxsSG9vaygnaW5pdENvbnRhaW5lclNoYXJlU2NvcGVNYXAnKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDtcbiAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwID0ge307XG4gICAgICAgIHRoaXMuaW5pdFRva2VucyA9IHt9O1xuICAgICAgICB0aGlzLl9zZXRHbG9iYWxTaGFyZVNjb3BlTWFwKGhvc3Qub3B0aW9ucyk7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTaGFyZWRIYW5kbGVyLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIHJlZ2lzdGVyIHNoYXJlZCBpbiBzaGFyZVNjb3BlTWFwXG4gICAgICAgICAgICBrZXk6IFwicmVnaXN0ZXJTaGFyZWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlclNoYXJlZChnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBfZm9ybWF0U2hhcmVDb25maWdzID0gZm9ybWF0U2hhcmVDb25maWdzKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKSwgc2hhcmVJbmZvcyA9IF9mb3JtYXRTaGFyZUNvbmZpZ3Muc2hhcmVJbmZvcywgc2hhcmVkID0gX2Zvcm1hdFNoYXJlQ29uZmlncy5zaGFyZWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlZEtleXMgPSBPYmplY3Qua2V5cyhzaGFyZUluZm9zKTtcbiAgICAgICAgICAgICAgICBzaGFyZWRLZXlzLmZvckVhY2goKHNoYXJlZEtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlZFZhbHMgPSBzaGFyZUluZm9zW3NoYXJlZEtleV07XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZFZhbHMuZm9yRWFjaCgoc2hhcmVkVmFsKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUodGhpcy5zaGFyZVNjb3BlTWFwLCBzaGFyZWRLZXksIHNoYXJlZFZhbCwgdGhpcy5ob29rcy5saWZlY3ljbGUucmVzb2x2ZVNoYXJlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVnaXN0ZXJlZFNoYXJlZCAmJiBzaGFyZWRWYWwgJiYgc2hhcmVkVmFsLmxpYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2hhcmVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZTogc2hhcmVkS2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWI6IHNoYXJlZFZhbC5saWIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldDogc2hhcmVkVmFsLmdldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHNoYXJlZFZhbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogdXNlck9wdGlvbnMubmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9zLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZWRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNoYXJlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFNoYXJlKHBrZ05hbWUsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBmdW5jdGlvbiBwZXJmb3JtcyB0aGUgZm9sbG93aW5nIHN0ZXBzOlxuICAgICAgICAgICAgICAgICAgICAvLyAxLiBDaGVja3MgaWYgdGhlIGN1cnJlbnRseSBsb2FkZWQgc2hhcmUgYWxyZWFkeSBleGlzdHMsIGlmIG5vdCwgaXQgdGhyb3dzIGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgIC8vIDIuIFNlYXJjaGVzIGdsb2JhbGx5IGZvciBhIG1hdGNoaW5nIHNoYXJlLCBpZiBmb3VuZCwgaXQgdXNlcyBpdCBkaXJlY3RseVxuICAgICAgICAgICAgICAgICAgICAvLyAzLiBJZiBub3QgZm91bmQsIGl0IHJldHJpZXZlcyBpdCBmcm9tIHRoZSBjdXJyZW50IHNoYXJlIGFuZCBzdG9yZXMgdGhlIG9idGFpbmVkIHNoYXJlIGdsb2JhbGx5LlxuICAgICAgICAgICAgICAgICAgICB2YXIgc2hhcmVJbmZvID0gZ2V0VGFyZ2V0U2hhcmVkT3B0aW9ucyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvczogaG9zdC5vcHRpb25zLnNoYXJlZFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mbyA9PSBudWxsID8gdm9pZCAwIDogc2hhcmVJbmZvLnNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBQcm9taXNlLmFsbChzaGFyZUluZm8uc2NvcGUubWFwKChzaGFyZVNjb3BlKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgUHJvbWlzZS5hbGwodGhpcy5pbml0aWFsaXplU2hhcmluZyhzaGFyZVNjb3BlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJhdGVneTogc2hhcmVJbmZvLnN0cmF0ZWd5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcykpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFNoYXJlUmVzID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlTG9hZFNoYXJlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogaG9zdC5vcHRpb25zLnNoYXJlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlSW5mb1JlcyA9IGxvYWRTaGFyZVJlcy5zaGFyZUluZm87XG4gICAgICAgICAgICAgICAgICAgIC8vIEFzc2VydCB0aGF0IHNoYXJlSW5mb1JlcyBleGlzdHMsIGlmIG5vdCwgdGhyb3cgYW4gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHNoYXJlSW5mb1JlcywgYENhbm5vdCBmaW5kICR7cGtnTmFtZX0gU2hhcmUgaW4gdGhlICR7aG9zdC5vcHRpb25zLm5hbWV9LiBQbGVhc2UgZW5zdXJlIHRoYXQgdGhlICR7cGtnTmFtZX0gU2hhcmUgcGFyYW1ldGVycyBoYXZlIGJlZW4gaW5qZWN0ZWRgKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmV0cmlldmUgZnJvbSBjYWNoZVxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVnaXN0ZXJlZFNoYXJlZCA9IGdldFJlZ2lzdGVyZWRTaGFyZSh0aGlzLnNoYXJlU2NvcGVNYXAsIHBrZ05hbWUsIHNoYXJlSW5mb1JlcywgdGhpcy5ob29rcy5saWZlY3ljbGUucmVzb2x2ZVNoYXJlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFkZFVzZUluID0gKHNoYXJlZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2hhcmVkLnVzZUluKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkLnVzZUluID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRVbmlxdWVJdGVtKHNoYXJlZC51c2VJbiwgaG9zdC5vcHRpb25zLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVnaXN0ZXJlZFNoYXJlZCAmJiByZWdpc3RlcmVkU2hhcmVkLmxpYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4ocmVnaXN0ZXJlZFNoYXJlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnaXN0ZXJlZFNoYXJlZC5saWI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVnaXN0ZXJlZFNoYXJlZCAmJiByZWdpc3RlcmVkU2hhcmVkLmxvYWRpbmcgJiYgIXJlZ2lzdGVyZWRTaGFyZWQubG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFjdG9yeSA9IHlpZWxkIHJlZ2lzdGVyZWRTaGFyZWQubG9hZGluZztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyZWRTaGFyZWQubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVnaXN0ZXJlZFNoYXJlZC5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWdpc3RlcmVkU2hhcmVkLmxpYiA9IGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRVc2VJbihyZWdpc3RlcmVkU2hhcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlZ2lzdGVyZWRTaGFyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3luY0xvYWRQcm9jZXNzID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWN0b3J5ID0geWllbGQgcmVnaXN0ZXJlZFNoYXJlZC5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvUmVzLmxpYiA9IGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb1Jlcy5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRVc2VJbihzaGFyZUluZm9SZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ1NoYXJlZCA9IGdldFJlZ2lzdGVyZWRTaGFyZSh0aGlzLnNoYXJlU2NvcGVNYXAsIHBrZ05hbWUsIHNoYXJlSW5mb1JlcywgdGhpcy5ob29rcy5saWZlY3ljbGUucmVzb2x2ZVNoYXJlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdTaGFyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdTaGFyZWQubGliID0gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdTaGFyZWQubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRpbmcgPSBhc3luY0xvYWRQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNoYXJlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogcmVnaXN0ZXJlZFNoYXJlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWI6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9hZGluZztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5jdXN0b21TaGFyZUluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXN5bmNMb2FkUHJvY2VzczEgPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhY3RvcnkgPSB5aWVsZCBzaGFyZUluZm9SZXMuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb1Jlcy5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9SZXMubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4oc2hhcmVJbmZvUmVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUodGhpcy5zaGFyZVNjb3BlTWFwLCBwa2dOYW1lLCBzaGFyZUluZm9SZXMsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU2hhcmVkLmxpYiA9IGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU2hhcmVkLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2FkaW5nMSA9IGFzeW5jTG9hZFByb2Nlc3MxKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNoYXJlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogc2hhcmVJbmZvUmVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IGhvc3Qub3B0aW9ucy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nOiBsb2FkaW5nMVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9hZGluZzE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogVGhpcyBmdW5jdGlvbiBpbml0aWFsaXplcyB0aGUgc2hhcmluZyBzZXF1ZW5jZSAoZXhlY3V0ZWQgb25seSBvbmNlIHBlciBzaGFyZSBzY29wZSkuXG4gICAqIEl0IGFjY2VwdHMgb25lIGFyZ3VtZW50LCB0aGUgbmFtZSBvZiB0aGUgc2hhcmUgc2NvcGUuXG4gICAqIElmIHRoZSBzaGFyZSBzY29wZSBkb2VzIG5vdCBleGlzdCwgaXQgY3JlYXRlcyBvbmUuXG4gICAqLyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAga2V5OiBcImluaXRpYWxpemVTaGFyaW5nXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZVNoYXJpbmcocmVmLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2hhcmVTY29wZU5hbWUgPSByZWYgPT09IHZvaWQgMCA/IERFRkFVTFRfU0NPUEUgOiByZWY7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgdmFyIGZyb20gPSBleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5mcm9tO1xuICAgICAgICAgICAgICAgIHZhciBzdHJhdGVneSA9IGV4dHJhT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZXh0cmFPcHRpb25zLnN0cmF0ZWd5O1xuICAgICAgICAgICAgICAgIHZhciBpbml0U2NvcGUgPSBleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5pbml0U2NvcGU7XG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2VzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGZyb20gIT09ICdidWlsZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRUb2tlbnMgPSB0aGlzLmluaXRUb2tlbnM7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaW5pdFNjb3BlKSBpbml0U2NvcGUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRUb2tlbiA9IGluaXRUb2tlbnNbc2hhcmVTY29wZU5hbWVdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWluaXRUb2tlbikgaW5pdFRva2VuID0gaW5pdFRva2Vuc1tzaGFyZVNjb3BlTmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiB0aGlzLmhvc3QubmFtZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5pdFNjb3BlLmluZGV4T2YoaW5pdFRva2VuKSA+PSAwKSByZXR1cm4gcHJvbWlzZXM7XG4gICAgICAgICAgICAgICAgICAgIGluaXRTY29wZS5wdXNoKGluaXRUb2tlbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlID0gdGhpcy5zaGFyZVNjb3BlTWFwO1xuICAgICAgICAgICAgICAgIHZhciBob3N0TmFtZSA9IGhvc3Qub3B0aW9ucy5uYW1lO1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZXMgYSBuZXcgc2hhcmUgc2NvcGUgaWYgbmVjZXNzYXJ5XG4gICAgICAgICAgICAgICAgaWYgKCFzaGFyZVNjb3BlW3NoYXJlU2NvcGVOYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICBzaGFyZVNjb3BlW3NoYXJlU2NvcGVOYW1lXSA9IHt9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBFeGVjdXRlcyBhbGwgaW5pdGlhbGl6YXRpb24gc25pcHBldHMgZnJvbSBhbGwgYWNjZXNzaWJsZSBtb2R1bGVzXG4gICAgICAgICAgICAgICAgdmFyIHNjb3BlID0gc2hhcmVTY29wZVtzaGFyZVNjb3BlTmFtZV07XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyID0gKG5hbWUxLCBzaGFyZWQpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYWN0aXZlVmVyc2lvbl9zaGFyZUNvbmZpZztcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZlcnNpb24gPSBzaGFyZWQudmVyc2lvbiwgZWFnZXIgPSBzaGFyZWQuZWFnZXI7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlW25hbWUxXSA9IHNjb3BlW25hbWUxXSB8fCB7fTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZlcnNpb25zID0gc2NvcGVbbmFtZTFdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlVmVyc2lvbiA9IHZlcnNpb25zW3ZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlVmVyc2lvbkVhZ2VyID0gQm9vbGVhbihhY3RpdmVWZXJzaW9uICYmIChhY3RpdmVWZXJzaW9uLmVhZ2VyIHx8ICgoX2FjdGl2ZVZlcnNpb25fc2hhcmVDb25maWcgPSBhY3RpdmVWZXJzaW9uLnNoYXJlQ29uZmlnKSA9PSBudWxsID8gdm9pZCAwIDogX2FjdGl2ZVZlcnNpb25fc2hhcmVDb25maWcuZWFnZXIpKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYWN0aXZlVmVyc2lvbiB8fCBhY3RpdmVWZXJzaW9uLnN0cmF0ZWd5ICE9PSAnbG9hZGVkLWZpcnN0JyAmJiAhYWN0aXZlVmVyc2lvbi5sb2FkZWQgJiYgKEJvb2xlYW4oIWVhZ2VyKSAhPT0gIWFjdGl2ZVZlcnNpb25FYWdlciA/IGVhZ2VyIDogaG9zdE5hbWUgPiBhY3RpdmVWZXJzaW9uLmZyb20pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uc1t2ZXJzaW9uXSA9IHNoYXJlZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGluaXRGbiA9IChtb2QpPT5tb2QgJiYgbW9kLmluaXQgJiYgbW9kLmluaXQoc2hhcmVTY29wZVtzaGFyZVNjb3BlTmFtZV0sIGluaXRTY29wZSk7XG4gICAgICAgICAgICAgICAgdmFyIGluaXRSZW1vdGVNb2R1bGUgPSAoa2V5KT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2R1bGUgPSAoeWllbGQgaG9zdC5yZW1vdGVIYW5kbGVyLmdldFJlbW90ZU1vZHVsZUFuZE9wdGlvbnMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBrZXlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKS5tb2R1bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kdWxlLmdldEVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHMgPSB5aWVsZCBtb2R1bGUuZ2V0RW50cnkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHMgPSB5aWVsZCBob3N0LnJlbW90ZUhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLmVycm9yTG9hZFJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBrZXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJ2JlZm9yZUxvYWRTaGFyZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbW9kdWxlLmluaXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBpbml0Rm4ocmVtb3RlRW50cnlFeHBvcnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlLmluaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KSgpO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGhvc3Qub3B0aW9ucy5zaGFyZWQpLmZvckVhY2goKHNoYXJlTmFtZSk9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlZEFyciA9IGhvc3Qub3B0aW9ucy5zaGFyZWRbc2hhcmVOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkQXJyLmZvckVhY2goKHNoYXJlZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWQuc2NvcGUuaW5jbHVkZXMoc2hhcmVTY29wZU5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXIoc2hhcmVOYW1lLCBzaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBzdHJhdGVneT09PSd2ZXJzaW9uLWZpcnN0JyBuZWVkIHRvIGJlIHJlbW92ZWQgaW4gdGhlIGZ1dHVyZVxuICAgICAgICAgICAgICAgIGlmIChob3N0Lm9wdGlvbnMuc2hhcmVTdHJhdGVneSA9PT0gJ3ZlcnNpb24tZmlyc3QnIHx8IHN0cmF0ZWd5ID09PSAndmVyc2lvbi1maXJzdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaG9zdC5vcHRpb25zLnJlbW90ZXMuZm9yRWFjaCgocmVtb3RlKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZS5zaGFyZVNjb3BlID09PSBzaGFyZVNjb3BlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goaW5pdFJlbW90ZU1vZHVsZShyZW1vdGUubmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBUaGUgbGliIGZ1bmN0aW9uIHdpbGwgb25seSBiZSBhdmFpbGFibGUgaWYgdGhlIHNoYXJlZCBzZXQgYnkgZWFnZXIgb3IgcnVudGltZSBpbml0IGlzIHNldCBvciB0aGUgc2hhcmVkIGlzIHN1Y2Nlc3NmdWxseSBsb2FkZWQuXG4gICAgICAgICAgICAvLyAxLiBJZiB0aGUgbG9hZGVkIHNoYXJlZCBhbHJlYWR5IGV4aXN0cyBnbG9iYWxseSwgdGhlbiBpdCB3aWxsIGJlIHJldXNlZFxuICAgICAgICAgICAgLy8gMi4gSWYgbGliIGV4aXN0cyBpbiBsb2NhbCBzaGFyZWQsIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseVxuICAgICAgICAgICAgLy8gMy4gSWYgdGhlIGxvY2FsIGdldCByZXR1cm5zIHNvbWV0aGluZyBvdGhlciB0aGFuIFByb21pc2UsIHRoZW4gaXQgd2lsbCBiZSB1c2VkIGRpcmVjdGx5XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNoYXJlU3luY1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTaGFyZVN5bmMocGtnTmFtZSwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlSW5mbyA9IGdldFRhcmdldFNoYXJlZE9wdGlvbnMoe1xuICAgICAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgICAgICBleHRyYU9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb3M6IGhvc3Qub3B0aW9ucy5zaGFyZWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoc2hhcmVJbmZvID09IG51bGwgPyB2b2lkIDAgOiBzaGFyZUluZm8uc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvLnNjb3BlLmZvckVhY2goKHNoYXJlU2NvcGUpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemVTaGFyaW5nKHNoYXJlU2NvcGUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJhdGVneTogc2hhcmVJbmZvLnN0cmF0ZWd5XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZWdpc3RlcmVkU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKHRoaXMuc2hhcmVTY29wZU1hcCwgcGtnTmFtZSwgc2hhcmVJbmZvLCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5yZXNvbHZlU2hhcmUpO1xuICAgICAgICAgICAgICAgIHZhciBhZGRVc2VJbiA9IChzaGFyZWQpPT57XG4gICAgICAgICAgICAgICAgICAgIGlmICghc2hhcmVkLnVzZUluKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQudXNlSW4gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhZGRVbmlxdWVJdGVtKHNoYXJlZC51c2VJbiwgaG9zdC5vcHRpb25zLm5hbWUpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2lzdGVyZWRTaGFyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZWdpc3RlcmVkU2hhcmVkLmxpYiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4ocmVnaXN0ZXJlZFNoYXJlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlZ2lzdGVyZWRTaGFyZWQubG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJlZFNoYXJlZC5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWdpc3RlcmVkU2hhcmVkLmZyb20gPT09IGhvc3Qub3B0aW9ucy5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mby5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdpc3RlcmVkU2hhcmVkLmxpYjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlZ2lzdGVyZWRTaGFyZWQuZ2V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gcmVnaXN0ZXJlZFNoYXJlZC5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG1vZHVsZSBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4ocmVnaXN0ZXJlZFNoYXJlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTaGFyZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IGhvc3Qub3B0aW9ucy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWI6IG1vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkOiByZWdpc3RlcmVkU2hhcmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2hhcmVJbmZvLmxpYikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNoYXJlSW5mby5sb2FkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mby5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzaGFyZUluZm8ubGliO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2hhcmVJbmZvLmdldCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlMSA9IHNoYXJlSW5mby5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vZHVsZTEgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3JDb2RlID0gKGV4dHJhT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZXh0cmFPcHRpb25zLmZyb20pID09PSAnYnVpbGQnID8gZXJyb3JDb2Rlcy5SVU5USU1FXzAwNSA6IGVycm9yQ29kZXMuUlVOVElNRV8wMDY7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZSwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3ROYW1lOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWRQa2dOYW1lOiBwa2dOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvLmxpYiA9IG1vZHVsZTE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2hhcmVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpYjogc2hhcmVJbmZvLmxpYixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogc2hhcmVJbmZvXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hhcmVJbmZvLmxpYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDA2LCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgICAgIGhvc3ROYW1lOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkUGtnTmFtZTogcGtnTmFtZVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImluaXRTaGFyZVNjb3BlTWFwXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFNoYXJlU2NvcGVNYXAoc2NvcGVOYW1lLCBzaGFyZVNjb3BlLCByZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXh0cmFPcHRpb25zID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NvcGVOYW1lXSA9IHNoYXJlU2NvcGU7XG4gICAgICAgICAgICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuaW5pdENvbnRhaW5lclNoYXJlU2NvcGVNYXAuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IGhvc3Qub3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0LFxuICAgICAgICAgICAgICAgICAgICBzY29wZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGhvc3RTaGFyZVNjb3BlTWFwOiBleHRyYU9wdGlvbnMuaG9zdFNoYXJlU2NvcGVNYXBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInNldFNoYXJlZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFNoYXJlZChyZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGtnTmFtZSA9IHJlZi5wa2dOYW1lLCBzaGFyZWQgPSByZWYuc2hhcmVkLCBmcm9tID0gcmVmLmZyb20sIGxpYiA9IHJlZi5saWIsIGxvYWRpbmcgPSByZWYubG9hZGluZywgbG9hZGVkID0gcmVmLmxvYWRlZCwgZ2V0ID0gcmVmLmdldDtcbiAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbiA9IHNoYXJlZC52ZXJzaW9uLCBfc2hhcmVkX3Njb3BlID0gc2hhcmVkLnNjb3BlLCBzY29wZSA9IF9zaGFyZWRfc2NvcGUgPT09IHZvaWQgMCA/ICdkZWZhdWx0JyA6IF9zaGFyZWRfc2NvcGUsIHNoYXJlSW5mbyA9IHBvbHlmaWxscy5fb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllc19sb29zZShzaGFyZWQsIFtcbiAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic2NvcGVcIlxuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIHZhciBzY29wZXMgPSBBcnJheS5pc0FycmF5KHNjb3BlKSA/IHNjb3BlIDogW1xuICAgICAgICAgICAgICAgICAgICBzY29wZVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgc2NvcGVzLmZvckVhY2goKHNjKT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2hhcmVTY29wZU1hcFtzY10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVTY29wZU1hcFtzY10gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV0gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV1bdmVyc2lvbl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV1bdmVyc2lvbl0gPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RlZmF1bHQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgc2hhcmVJbmZvLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dLmdldCA9IGdldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVnaXN0ZXJlZFNoYXJlZCA9IHRoaXMuc2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV1bdmVyc2lvbl07XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nICYmICFyZWdpc3RlcmVkU2hhcmVkLmxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyZWRTaGFyZWQubG9hZGluZyA9IGxvYWRpbmc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcIl9zZXRHbG9iYWxTaGFyZVNjb3BlTWFwXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NldEdsb2JhbFNoYXJlU2NvcGVNYXAoaG9zdE9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZ2xvYmFsU2hhcmVTY29wZU1hcCA9IGdldEdsb2JhbFNoYXJlU2NvcGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgaWRlbnRpZmllciA9IGhvc3RPcHRpb25zLmlkIHx8IGhvc3RPcHRpb25zLm5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKGlkZW50aWZpZXIgJiYgIWdsb2JhbFNoYXJlU2NvcGVNYXBbaWRlbnRpZmllcl0pIHtcbiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU2hhcmVTY29wZU1hcFtpZGVudGlmaWVyXSA9IHRoaXMuc2hhcmVTY29wZU1hcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gU2hhcmVkSGFuZGxlcjtcbn0oKTtcbnZhciBSZW1vdGVIYW5kbGVyID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBSZW1vdGVIYW5kbGVyKGhvc3QpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBSZW1vdGVIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5ob29rcyA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYmVmb3JlUmVnaXN0ZXJSZW1vdGU6IG5ldyBTeW5jV2F0ZXJmYWxsSG9vaygnYmVmb3JlUmVnaXN0ZXJSZW1vdGUnKSxcbiAgICAgICAgICAgIHJlZ2lzdGVyUmVtb3RlOiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ3JlZ2lzdGVyUmVtb3RlJyksXG4gICAgICAgICAgICBiZWZvcmVSZXF1ZXN0OiBuZXcgQXN5bmNXYXRlcmZhbGxIb29rKCdiZWZvcmVSZXF1ZXN0JyksXG4gICAgICAgICAgICBvbkxvYWQ6IG5ldyBBc3luY0hvb2soJ29uTG9hZCcpLFxuICAgICAgICAgICAgaGFuZGxlUHJlbG9hZE1vZHVsZTogbmV3IFN5bmNIb29rKCdoYW5kbGVQcmVsb2FkTW9kdWxlJyksXG4gICAgICAgICAgICBlcnJvckxvYWRSZW1vdGU6IG5ldyBBc3luY0hvb2soJ2Vycm9yTG9hZFJlbW90ZScpLFxuICAgICAgICAgICAgYmVmb3JlUHJlbG9hZFJlbW90ZTogbmV3IEFzeW5jSG9vaygnYmVmb3JlUHJlbG9hZFJlbW90ZScpLFxuICAgICAgICAgICAgZ2VuZXJhdGVQcmVsb2FkQXNzZXRzOiBuZXcgQXN5bmNIb29rKCdnZW5lcmF0ZVByZWxvYWRBc3NldHMnKSxcbiAgICAgICAgICAgIC8vIG5vdCB1c2VkIHlldFxuICAgICAgICAgICAgYWZ0ZXJQcmVsb2FkUmVtb3RlOiBuZXcgQXN5bmNIb29rKCksXG4gICAgICAgICAgICBsb2FkRW50cnk6IG5ldyBBc3luY0hvb2soKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDtcbiAgICAgICAgdGhpcy5pZFRvUmVtb3RlTWFwID0ge307XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhSZW1vdGVIYW5kbGVyLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJmb3JtYXRBbmRSZWdpc3RlclJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZvcm1hdEFuZFJlZ2lzdGVyUmVtb3RlKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVzZXJSZW1vdGVzID0gdXNlck9wdGlvbnMucmVtb3RlcyB8fCBbXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlclJlbW90ZXMucmVkdWNlKChyZXMsIHJlbW90ZSk9PntcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlclJlbW90ZShyZW1vdGUsIHJlcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2U6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgIH0sIGdsb2JhbE9wdGlvbnMucmVtb3Rlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJzZXRJZFRvUmVtb3RlTWFwXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0SWRUb1JlbW90ZU1hcChpZCwgcmVtb3RlTWF0Y2hJbmZvKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZSA9IHJlbW90ZU1hdGNoSW5mby5yZW1vdGUsIGV4cG9zZSA9IHJlbW90ZU1hdGNoSW5mby5leHBvc2U7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUxID0gcmVtb3RlLm5hbWUsIGFsaWFzID0gcmVtb3RlLmFsaWFzO1xuICAgICAgICAgICAgICAgIHRoaXMuaWRUb1JlbW90ZU1hcFtpZF0gPSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBleHBvc2VcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChhbGlhcyAmJiBpZC5zdGFydHNXaXRoKG5hbWUxKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWRXaXRoQWxpYXMgPSBpZC5yZXBsYWNlKG5hbWUxLCBhbGlhcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaWRUb1JlbW90ZU1hcFtpZFdpdGhBbGlhc10gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhbGlhcyAmJiBpZC5zdGFydHNXaXRoKGFsaWFzKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWRXaXRoTmFtZSA9IGlkLnJlcGxhY2UoYWxpYXMsIG5hbWUxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pZFRvUmVtb3RlTWFwW2lkV2l0aE5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2FkUmVtb3RlXCIsXG4gICAgICAgICAgICB2YWx1ZTogLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1saW5lcy1wZXItZnVuY3Rpb25cbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbWVtYmVyLW9yZGVyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2FkUmVtb3RlKGlkLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBvcHRpb25zIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkRmFjdG9yeTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgX3JlZl9sb2FkRmFjdG9yeSA9IF9yZWYubG9hZEZhY3RvcnksIGxvYWRGYWN0b3J5ID0gX3JlZl9sb2FkRmFjdG9yeSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWZfbG9hZEZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAxLiBWYWxpZGF0ZSB0aGUgcGFyYW1ldGVycyBvZiB0aGUgcmV0cmlldmVkIG1vZHVsZS4gVGhlcmUgYXJlIHR3byBtb2R1bGUgcmVxdWVzdCBtZXRob2RzOiBwa2dOYW1lICsgZXhwb3NlIGFuZCBhbGlhcyArIGV4cG9zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDIuIFJlcXVlc3QgdGhlIHNuYXBzaG90IGluZm9ybWF0aW9uIG9mIHRoZSBjdXJyZW50IGhvc3QgYW5kIGdsb2JhbGx5IHN0b3JlIHRoZSBvYnRhaW5lZCBzbmFwc2hvdCBpbmZvcm1hdGlvbi4gVGhlIHJldHJpZXZlZCBtb2R1bGUgaW5mb3JtYXRpb24gaXMgcGFydGlhbGx5IG9mZmxpbmUgYW5kIHBhcnRpYWxseSBvbmxpbmUuIFRoZSBvbmxpbmUgbW9kdWxlIGluZm9ybWF0aW9uIHdpbGwgcmV0cmlldmUgdGhlIG1vZHVsZXMgdXNlZCBvbmxpbmUuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAzLiBSZXRyaWV2ZSB0aGUgZGV0YWlsZWQgaW5mb3JtYXRpb24gb2YgdGhlIGN1cnJlbnQgbW9kdWxlIGZyb20gZ2xvYmFsIChyZW1vdGVFbnRyeSBhZGRyZXNzLCBleHBvc2UgcmVzb3VyY2UgYWRkcmVzcylcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDQuIEFmdGVyIHJldHJpZXZpbmcgcmVtb3RlRW50cnksIGNhbGwgdGhlIGluaXQgb2YgdGhlIG1vZHVsZSwgYW5kIHRoZW4gcmV0cmlldmUgdGhlIGV4cG9ydGVkIGNvbnRlbnQgb2YgdGhlIG1vZHVsZSB0aHJvdWdoIGdldFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWQ6IHBrZ05hbWUoQGZlZGVyYXRpb24vYXBwMSkgKyBleHBvc2UoYnV0dG9uKSA9IEBmZWRlcmF0aW9uL2FwcDEvYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZDogYWxpYXMoYXBwMSkgKyBleHBvc2UoYnV0dG9uKSA9IGFwcDEvYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZDogYWxpYXMoYXBwMS91dGlscykgKyBleHBvc2UobG9hZGFzaC9zb3J0KSA9IGFwcDEvdXRpbHMvbG9hZGFzaC9zb3J0XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjEgPSB5aWVsZCB0aGlzLmdldFJlbW90ZU1vZHVsZUFuZE9wdGlvbnMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSwgbW9kdWxlID0gX3JlZjEubW9kdWxlLCBtb2R1bGVPcHRpb25zID0gX3JlZjEubW9kdWxlT3B0aW9ucywgcmVtb3RlTWF0Y2hJbmZvID0gX3JlZjEucmVtb3RlTWF0Y2hJbmZvO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBrZ05hbWVPckFsaWFzID0gcmVtb3RlTWF0Y2hJbmZvLnBrZ05hbWVPckFsaWFzLCByZW1vdGUgPSByZW1vdGVNYXRjaEluZm8ucmVtb3RlLCBleHBvc2UgPSByZW1vdGVNYXRjaEluZm8uZXhwb3NlLCBpZFJlcyA9IHJlbW90ZU1hdGNoSW5mby5pZCwgcmVtb3RlU25hcHNob3QgPSByZW1vdGVNYXRjaEluZm8ucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlT3JGYWN0b3J5ID0geWllbGQgbW9kdWxlLmdldChpZFJlcywgZXhwb3NlLCBvcHRpb25zLCByZW1vdGVTbmFwc2hvdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlV3JhcHBlciA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLm9uTG9hZC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaWRSZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZU9yQWxpYXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZU1vZHVsZTogbG9hZEZhY3RvcnkgPyBtb2R1bGVPckZhY3RvcnkgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlTW9kdWxlRmFjdG9yeTogbG9hZEZhY3RvcnkgPyB1bmRlZmluZWQgOiBtb2R1bGVPckZhY3RvcnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IG1vZHVsZU9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5zdGFuY2U6IG1vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRJZFRvUmVtb3RlTWFwKGlkLCByZW1vdGVNYXRjaEluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtb2R1bGVXcmFwcGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVdyYXBwZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kdWxlT3JGYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYyID0gb3B0aW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ3J1bnRpbWUnXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBfcmVmX2Zyb20gPSBfcmVmMi5mcm9tLCBmcm9tID0gX3JlZl9mcm9tID09PSB2b2lkIDAgPyAncnVudGltZScgOiBfcmVmX2Zyb207XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbE92ZXIgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5lcnJvckxvYWRSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZlY3ljbGU6ICdvbkxvYWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZhaWxPdmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFpbE92ZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicHJlbG9hZFJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbWVtYmVyLW9yZGVyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBwcmVsb2FkUmVtb3RlKHByZWxvYWRPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVQcmVsb2FkUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJlbG9hZE9wczogcHJlbG9hZE9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmVsb2FkT3BzID0gZm9ybWF0UHJlbG9hZEFyZ3MoaG9zdC5vcHRpb25zLnJlbW90ZXMsIHByZWxvYWRPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgUHJvbWlzZS5hbGwocHJlbG9hZE9wcy5tYXAoKG9wcyk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZSA9IG9wcy5yZW1vdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBnZXRSZW1vdGVJbmZvKHJlbW90ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSB5aWVsZCBob3N0LnNuYXBzaG90SGFuZGxlci5sb2FkUmVtb3RlU25hcHNob3RJbmZvKHJlbW90ZSksIGdsb2JhbFNuYXBzaG90ID0gX3JlZi5nbG9iYWxTbmFwc2hvdCwgcmVtb3RlU25hcHNob3QgPSBfcmVmLnJlbW90ZVNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NldHMgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5nZW5lcmF0ZVByZWxvYWRBc3NldHMuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlbG9hZE9wdGlvbnM6IG9wcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFzc2V0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRBc3NldHMocmVtb3RlSW5mbywgaG9zdCwgYXNzZXRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcykpKTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVnaXN0ZXJSZW1vdGVzXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJSZW1vdGVzKHJlbW90ZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICByZW1vdGVzLmZvckVhY2goKHJlbW90ZSk9PntcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlclJlbW90ZShyZW1vdGUsIGhvc3Qub3B0aW9ucy5yZW1vdGVzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JjZTogb3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5mb3JjZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldFJlbW90ZU1vZHVsZUFuZE9wdGlvbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zKG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IG9wdGlvbnMuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkUmVtb3RlQXJncztcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRSZW1vdGVBcmdzID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlUmVxdWVzdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRSZW1vdGVBcmdzID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuZXJyb3JMb2FkUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IGhvc3Qub3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ3J1bnRpbWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJ2JlZm9yZVJlcXVlc3QnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbG9hZFJlbW90ZUFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRSZXMgPSBsb2FkUmVtb3RlQXJncy5pZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZVNwbGl0SW5mbyA9IG1hdGNoUmVtb3RlV2l0aE5hbWVBbmRFeHBvc2UoaG9zdC5vcHRpb25zLnJlbW90ZXMsIGlkUmVzKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHJlbW90ZVNwbGl0SW5mbywgZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDQsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3ROYW1lOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RJZDogaWRSZXNcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmF3UmVtb3RlID0gcmVtb3RlU3BsaXRJbmZvLnJlbW90ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBnZXRSZW1vdGVJbmZvKHJhd1JlbW90ZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaEluZm8gPSB5aWVsZCBob3N0LnNoYXJlZEhhbmRsZXIuaG9va3MubGlmZWN5Y2xlLmFmdGVyUmVzb2x2ZS5lbWl0KHBvbHlmaWxscy5fZXh0ZW5kcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogaWRSZXNcbiAgICAgICAgICAgICAgICAgICAgfSwgcmVtb3RlU3BsaXRJbmZvLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZSA9IG1hdGNoSW5mby5yZW1vdGUsIGV4cG9zZSA9IG1hdGNoSW5mby5leHBvc2U7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChyZW1vdGUgJiYgZXhwb3NlLCBgVGhlICdiZWZvcmVSZXF1ZXN0JyBob29rIHdhcyBleGVjdXRlZCwgYnV0IGl0IGZhaWxlZCB0byByZXR1cm4gdGhlIGNvcnJlY3QgJ3JlbW90ZScgYW5kICdleHBvc2UnIHZhbHVlcyB3aGlsZSBsb2FkaW5nICR7aWRSZXN9LmApO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gaG9zdC5tb2R1bGVDYWNoZS5nZXQocmVtb3RlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3Q6IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmICghbW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGUgPSBuZXcgTW9kdWxlKG1vZHVsZU9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5tb2R1bGVDYWNoZS5zZXQocmVtb3RlLm5hbWUsIG1vZHVsZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZU9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVNYXRjaEluZm86IG1hdGNoSW5mb1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZWdpc3RlclJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyUmVtb3RlKHJlbW90ZSwgdGFyZ2V0UmVtb3Rlcywgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgIHZhciBub3JtYWxpemVSZW1vdGUgPSAoKT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3RlLmFsaWFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBWYWxpZGF0ZSBpZiBhbGlhcyBlcXVhbHMgdGhlIHByZWZpeCBvZiByZW1vdGUubmFtZSBhbmQgcmVtb3RlLmFsaWFzLCBpZiBzbywgdGhyb3cgYW4gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFzIG11bHRpLWxldmVsIHBhdGggcmVmZXJlbmNlcyBjYW5ub3QgZ3VhcmFudGVlIHVuaXF1ZSBuYW1lcywgYWxpYXMgYmVpbmcgYSBwcmVmaXggb2YgcmVtb3RlLm5hbWUgaXMgbm90IHN1cHBvcnRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmRFcXVhbCA9IHRhcmdldFJlbW90ZXMuZmluZCgoaXRlbSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2l0ZW1fYWxpYXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbW90ZS5hbGlhcyAmJiAoaXRlbS5uYW1lLnN0YXJ0c1dpdGgocmVtb3RlLmFsaWFzKSB8fCAoKF9pdGVtX2FsaWFzID0gaXRlbS5hbGlhcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9pdGVtX2FsaWFzLnN0YXJ0c1dpdGgocmVtb3RlLmFsaWFzKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoIWZpbmRFcXVhbCwgYFRoZSBhbGlhcyAke3JlbW90ZS5hbGlhc30gb2YgcmVtb3RlICR7cmVtb3RlLm5hbWV9IGlzIG5vdCBhbGxvd2VkIHRvIGJlIHRoZSBwcmVmaXggb2YgJHtmaW5kRXF1YWwgJiYgZmluZEVxdWFsLm5hbWV9IG5hbWUgb3IgYWxpYXNgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHJlbW90ZSBlbnRyeSB0byBhIGNvbXBsZXRlIHBhdGhcbiAgICAgICAgICAgICAgICAgICAgaWYgKCdlbnRyeScgaW4gcmVtb3RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2RrLmlzQnJvd3NlckVudigpICYmICFyZW1vdGUuZW50cnkuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlLmVudHJ5ID0gbmV3IFVSTChyZW1vdGUuZW50cnksIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pLmhyZWY7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZW1vdGUuc2hhcmVTY29wZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlLnNoYXJlU2NvcGUgPSBERUZBVUxUX1NDT1BFO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVtb3RlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZS50eXBlID0gREVGQVVMVF9SRU1PVEVfVFlQRTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlUmVnaXN0ZXJSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRSZW1vdGUgPSB0YXJnZXRSZW1vdGVzLmZpbmQoKGl0ZW0pPT5pdGVtLm5hbWUgPT09IHJlbW90ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlZ2lzdGVyZWRSZW1vdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplUmVtb3RlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFJlbW90ZXMucHVzaChyZW1vdGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5yZWdpc3RlclJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZXMgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICBgVGhlIHJlbW90ZSBcIiR7cmVtb3RlLm5hbWV9XCIgaXMgYWxyZWFkeSByZWdpc3RlcmVkLmAsXG4gICAgICAgICAgICAgICAgICAgICAgICAnUGxlYXNlIG5vdGUgdGhhdCBvdmVycmlkaW5nIGl0IG1heSBjYXVzZSB1bmV4cGVjdGVkIGVycm9ycy4nXG4gICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBvcHRpb25zLmZvcmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgcmVnaXN0ZXJlZCByZW1vdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlUmVtb3RlKHJlZ2lzdGVyZWRSZW1vdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplUmVtb3RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRSZW1vdGVzLnB1c2gocmVtb3RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlZ2lzdGVyUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2RrLndhcm4obWVzc2FnZXMuam9pbignICcpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlbW92ZVJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVJlbW90ZShyZW1vdGUpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUxID0gcmVtb3RlLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmRleCA9IGhvc3Qub3B0aW9ucy5yZW1vdGVzLmZpbmRJbmRleCgoaXRlbSk9Pml0ZW0ubmFtZSA9PT0gbmFtZTEpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3RlSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0Lm9wdGlvbnMucmVtb3Rlcy5zcGxpY2UocmVtb3RlSW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkZWRNb2R1bGUgPSBob3N0Lm1vZHVsZUNhY2hlLmdldChyZW1vdGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2FkZWRNb2R1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gbG9hZGVkTW9kdWxlLnJlbW90ZUluZm87XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoQ3VycmVudEdsb2JhbFtrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9PYmplY3RfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoX09iamVjdF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEN1cnJlbnRHbG9iYWwsIGtleSkpID09IG51bGwgPyB2b2lkIDAgOiBfT2JqZWN0X2dldE93blByb3BlcnR5RGVzY3JpcHRvci5jb25maWd1cmFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIEN1cnJlbnRHbG9iYWxba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEN1cnJlbnRHbG9iYWxba2V5XSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnlVbmlxdWVLZXkgPSBnZXRSZW1vdGVFbnRyeVVuaXF1ZUtleShsb2FkZWRNb2R1bGUucmVtb3RlSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2xvYmFsTG9hZGluZ1tyZW1vdGVFbnRyeVVuaXF1ZUtleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgZ2xvYmFsTG9hZGluZ1tyZW1vdGVFbnRyeVVuaXF1ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0LnNuYXBzaG90SGFuZGxlci5tYW5pZmVzdENhY2hlLmRlbGV0ZShyZW1vdGVJbmZvLmVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRlbGV0ZSB1bmxvYWRlZCBzaGFyZWQgYW5kIGluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5zSWQgPSByZW1vdGVJbmZvLmJ1aWxkVmVyc2lvbiA/IHNkay5jb21wb3NlS2V5V2l0aFNlcGFyYXRvcihyZW1vdGVJbmZvLm5hbWUsIHJlbW90ZUluZm8uYnVpbGRWZXJzaW9uKSA6IHJlbW90ZUluZm8ubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbnNJbmRleCA9IEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19JTlNUQU5DRVNfXy5maW5kSW5kZXgoKGlucyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3RlSW5mby5idWlsZFZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlucy5vcHRpb25zLmlkID09PSByZW1vdGVJbnNJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5zLm5hbWUgPT09IHJlbW90ZUluc0lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUluc0luZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbnMgPSBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX19bcmVtb3RlSW5zSW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluc0lkID0gcmVtb3RlSW5zLm9wdGlvbnMuaWQgfHwgcmVtb3RlSW5zSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNoYXJlU2NvcGVNYXAgPSBnZXRHbG9iYWxTaGFyZVNjb3BlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQWxsU2hhcmVkTm90VXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5lZWREZWxldGVLZXlzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoZ2xvYmFsU2hhcmVTY29wZU1hcCkuZm9yRWFjaCgoaW5zdElkKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2hhcmVTY29wZU1hcCA9IGdsb2JhbFNoYXJlU2NvcGVNYXBbaW5zdElkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZU1hcCAmJiBPYmplY3Qua2V5cyhzaGFyZVNjb3BlTWFwKS5mb3JFYWNoKChzaGFyZVNjb3BlKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGVWYWwgPSBzaGFyZVNjb3BlTWFwW3NoYXJlU2NvcGVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZVZhbCAmJiBPYmplY3Qua2V5cyhzaGFyZVNjb3BlVmFsKS5mb3JFYWNoKChzaGFyZU5hbWUpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlZFBrZ3MgPSBzaGFyZVNjb3BlVmFsW3NoYXJlTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkUGtncyAmJiBPYmplY3Qua2V5cyhzaGFyZWRQa2dzKS5mb3JFYWNoKChzaGFyZVZlcnNpb24pPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWQgPSBzaGFyZWRQa2dzW3NoYXJlVmVyc2lvbl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWQgJiYgdHlwZW9mIHNoYXJlZCA9PT0gJ29iamVjdCcgJiYgc2hhcmVkLmZyb20gPT09IHJlbW90ZUluZm8ubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoYXJlZC5sb2FkZWQgfHwgc2hhcmVkLmxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQudXNlSW4gPSBzaGFyZWQudXNlSW4uZmlsdGVyKCh1c2VkSG9zdE5hbWUpPT51c2VkSG9zdE5hbWUgIT09IHJlbW90ZUluZm8ubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoYXJlZC51c2VJbi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBbGxTaGFyZWROb3RVc2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZERlbGV0ZUtleXMucHVzaChbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZVNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVWZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZERlbGV0ZUtleXMucHVzaChbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZVZlcnNpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FsbFNoYXJlZE5vdFVzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5zLnNoYXJlU2NvcGVNYXAgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGdsb2JhbFNoYXJlU2NvcGVNYXBbcmVtb3RlSW5zSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZWVkRGVsZXRlS2V5cy5mb3JFYWNoKChyZWYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgNCksIGluc0lkID0gX3JlZlswXSwgc2hhcmVTY29wZSA9IF9yZWZbMV0sIHNoYXJlTmFtZSA9IF9yZWZbMl0sIHNoYXJlVmVyc2lvbiA9IF9yZWZbM107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZF9zaGFyZVNjb3BlX3NoYXJlTmFtZSwgX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZSwgX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZCA9IGdsb2JhbFNoYXJlU2NvcGVNYXBbaW5zSWRdKSA9PSBudWxsID8gdHJ1ZSA6IChfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZF9zaGFyZVNjb3BlID0gX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRbc2hhcmVTY29wZV0pID09IG51bGwgPyB0cnVlIDogKF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkX3NoYXJlU2NvcGVfc2hhcmVOYW1lID0gX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZVtzaGFyZU5hbWVdKSA9PSBudWxsID8gdHJ1ZSA6IGRlbGV0ZSBfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZF9zaGFyZVNjb3BlX3NoYXJlTmFtZVtzaGFyZVZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19JTlNUQU5DRVNfXy5zcGxpY2UocmVtb3RlSW5zSW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3RHbG9iYWxTbmFwc2hvdCA9IGdldEdsb2JhbFJlbW90ZUluZm8ocmVtb3RlLCBob3N0KS5ob3N0R2xvYmFsU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaG9zdEdsb2JhbFNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUtleSA9IGhvc3RHbG9iYWxTbmFwc2hvdCAmJiAncmVtb3Rlc0luZm8nIGluIGhvc3RHbG9iYWxTbmFwc2hvdCAmJiBob3N0R2xvYmFsU25hcHNob3QucmVtb3Rlc0luZm8gJiYgZ2V0SW5mb1dpdGhvdXRUeXBlKGhvc3RHbG9iYWxTbmFwc2hvdC5yZW1vdGVzSW5mbywgcmVtb3RlLm5hbWUpLmtleTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3RlS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBob3N0R2xvYmFsU25hcHNob3QucmVtb3Rlc0luZm9bcmVtb3RlS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oR2xvYmFsLl9fRkVERVJBVElPTl9fLl9fTUFOSUZFU1RfTE9BRElOR19fW3JlbW90ZUtleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgR2xvYmFsLl9fRkVERVJBVElPTl9fLl9fTUFOSUZFU1RfTE9BRElOR19fW3JlbW90ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0Lm1vZHVsZUNhY2hlLmRlbGV0ZShyZW1vdGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmxvZygncmVtb3ZlUmVtb3RlIGZhaWw6ICcsIGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFJlbW90ZUhhbmRsZXI7XG59KCk7XG52YXIgRmVkZXJhdGlvbkhvc3QgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIEZlZGVyYXRpb25Ib3N0KHVzZXJPcHRpb25zKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgRmVkZXJhdGlvbkhvc3QpO1xuICAgICAgICB0aGlzLmhvb2tzID0gbmV3IFBsdWdpblN5c3RlbSh7XG4gICAgICAgICAgICBiZWZvcmVJbml0OiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZUluaXQnKSxcbiAgICAgICAgICAgIGluaXQ6IG5ldyBTeW5jSG9vaygpLFxuICAgICAgICAgICAgLy8gbWF5YmUgd2lsbCBjaGFuZ2UsIHRlbXBvcmFyaWx5IGZvciBpbnRlcm5hbCB1c2Ugb25seVxuICAgICAgICAgICAgYmVmb3JlSW5pdENvbnRhaW5lcjogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYmVmb3JlSW5pdENvbnRhaW5lcicpLFxuICAgICAgICAgICAgLy8gbWF5YmUgd2lsbCBjaGFuZ2UsIHRlbXBvcmFyaWx5IGZvciBpbnRlcm5hbCB1c2Ugb25seVxuICAgICAgICAgICAgaW5pdENvbnRhaW5lcjogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnaW5pdENvbnRhaW5lcicpXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBcIjAuMTAuMFwiO1xuICAgICAgICB0aGlzLm1vZHVsZUNhY2hlID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmxvYWRlckhvb2sgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIC8vIEZJWE1FOiBtYXkgbm90IGJlIHN1aXRhYmxlICwgbm90IG9wZW4gdG8gdGhlIHB1YmxpYyB5ZXRcbiAgICAgICAgICAgIGdldE1vZHVsZUluZm86IG5ldyBTeW5jSG9vaygpLFxuICAgICAgICAgICAgY3JlYXRlU2NyaXB0OiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGNyZWF0ZUxpbms6IG5ldyBTeW5jSG9vaygpLFxuICAgICAgICAgICAgZmV0Y2g6IG5ldyBBc3luY0hvb2soKSxcbiAgICAgICAgICAgIGxvYWRFbnRyeUVycm9yOiBuZXcgQXN5bmNIb29rKCksXG4gICAgICAgICAgICBnZXRNb2R1bGVGYWN0b3J5OiBuZXcgQXN5bmNIb29rKClcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYnJpZGdlSG9vayA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYmVmb3JlQnJpZGdlUmVuZGVyOiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGFmdGVyQnJpZGdlUmVuZGVyOiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGJlZm9yZUJyaWRnZURlc3Ryb3k6IG5ldyBTeW5jSG9vaygpLFxuICAgICAgICAgICAgYWZ0ZXJCcmlkZ2VEZXN0cm95OiBuZXcgU3luY0hvb2soKVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gVE9ETzogVmFsaWRhdGUgdGhlIGRldGFpbHMgb2YgdGhlIG9wdGlvbnNcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBvcHRpb25zIHdpdGggZGVmYXVsdCB2YWx1ZXNcbiAgICAgICAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgICAgICAgaWQ6IGdldEJ1aWxkZXJJZCgpLFxuICAgICAgICAgICAgbmFtZTogdXNlck9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgIHBsdWdpbnM6IFtcbiAgICAgICAgICAgICAgICBzbmFwc2hvdFBsdWdpbigpLFxuICAgICAgICAgICAgICAgIGdlbmVyYXRlUHJlbG9hZEFzc2V0c1BsdWdpbigpXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgcmVtb3RlczogW10sXG4gICAgICAgICAgICBzaGFyZWQ6IHt9LFxuICAgICAgICAgICAgaW5Ccm93c2VyOiBzZGsuaXNCcm93c2VyRW52KClcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5uYW1lID0gdXNlck9wdGlvbnMubmFtZTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgIHRoaXMuc25hcHNob3RIYW5kbGVyID0gbmV3IFNuYXBzaG90SGFuZGxlcih0aGlzKTtcbiAgICAgICAgdGhpcy5zaGFyZWRIYW5kbGVyID0gbmV3IFNoYXJlZEhhbmRsZXIodGhpcyk7XG4gICAgICAgIHRoaXMucmVtb3RlSGFuZGxlciA9IG5ldyBSZW1vdGVIYW5kbGVyKHRoaXMpO1xuICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXAgPSB0aGlzLnNoYXJlZEhhbmRsZXIuc2hhcmVTY29wZU1hcDtcbiAgICAgICAgdGhpcy5yZWdpc3RlclBsdWdpbnMoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhkZWZhdWx0T3B0aW9ucy5wbHVnaW5zKS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyh1c2VyT3B0aW9ucy5wbHVnaW5zIHx8IFtdKSkpO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSB0aGlzLmZvcm1hdE9wdGlvbnMoZGVmYXVsdE9wdGlvbnMsIHVzZXJPcHRpb25zKTtcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKEZlZGVyYXRpb25Ib3N0LCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0T3B0aW9uc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRPcHRpb25zKHVzZXJPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlclBsdWdpbnModXNlck9wdGlvbnMucGx1Z2lucyk7XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLmZvcm1hdE9wdGlvbnModGhpcy5vcHRpb25zLCB1c2VyT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9ucztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTaGFyZShwa2dOYW1lLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2hhcmVkSGFuZGxlci5sb2FkU2hhcmUocGtnTmFtZSwgZXh0cmFPcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBUaGUgbGliIGZ1bmN0aW9uIHdpbGwgb25seSBiZSBhdmFpbGFibGUgaWYgdGhlIHNoYXJlZCBzZXQgYnkgZWFnZXIgb3IgcnVudGltZSBpbml0IGlzIHNldCBvciB0aGUgc2hhcmVkIGlzIHN1Y2Nlc3NmdWxseSBsb2FkZWQuXG4gICAgICAgICAgICAvLyAxLiBJZiB0aGUgbG9hZGVkIHNoYXJlZCBhbHJlYWR5IGV4aXN0cyBnbG9iYWxseSwgdGhlbiBpdCB3aWxsIGJlIHJldXNlZFxuICAgICAgICAgICAgLy8gMi4gSWYgbGliIGV4aXN0cyBpbiBsb2NhbCBzaGFyZWQsIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseVxuICAgICAgICAgICAgLy8gMy4gSWYgdGhlIGxvY2FsIGdldCByZXR1cm5zIHNvbWV0aGluZyBvdGhlciB0aGFuIFByb21pc2UsIHRoZW4gaXQgd2lsbCBiZSB1c2VkIGRpcmVjdGx5XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNoYXJlU3luY1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTaGFyZVN5bmMocGtnTmFtZSwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2hhcmVkSGFuZGxlci5sb2FkU2hhcmVTeW5jKHBrZ05hbWUsIGV4dHJhT3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0aWFsaXplU2hhcmluZ1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemVTaGFyaW5nKHJlZiwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGVOYW1lID0gcmVmID09PSB2b2lkIDAgPyBERUZBVUxUX1NDT1BFIDogcmVmO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNoYXJlZEhhbmRsZXIuaW5pdGlhbGl6ZVNoYXJpbmcoc2hhcmVTY29wZU5hbWUsIGV4dHJhT3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0UmF3Q29udGFpbmVyXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFJhd0NvbnRhaW5lcihuYW1lMSwgdXJsLCBjb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IGdldFJlbW90ZUluZm8oe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICAgICAgZW50cnk6IHVybFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBtb2R1bGUgPSBuZXcgTW9kdWxlKHtcbiAgICAgICAgICAgICAgICAgICAgaG9zdDogdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIG1vZHVsZS5yZW1vdGVFbnRyeUV4cG9ydHMgPSBjb250YWluZXI7XG4gICAgICAgICAgICAgICAgdGhpcy5tb2R1bGVDYWNoZS5zZXQobmFtZTEsIG1vZHVsZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvblxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9tZW1iZXItb3JkZXJpbmdcbiAgICAgICAgICAgIGZ1bmN0aW9uIGxvYWRSZW1vdGUoaWQsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlSGFuZGxlci5sb2FkUmVtb3RlKGlkLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicHJlbG9hZFJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbWVtYmVyLW9yZGVyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBwcmVsb2FkUmVtb3RlKHByZWxvYWRPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZUhhbmRsZXIucHJlbG9hZFJlbW90ZShwcmVsb2FkT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImluaXRTaGFyZVNjb3BlTWFwXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFNoYXJlU2NvcGVNYXAoc2NvcGVOYW1lLCBzaGFyZVNjb3BlLCByZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXh0cmFPcHRpb25zID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZEhhbmRsZXIuaW5pdFNoYXJlU2NvcGVNYXAoc2NvcGVOYW1lLCBzaGFyZVNjb3BlLCBleHRyYU9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZm9ybWF0T3B0aW9uc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZvcm1hdE9wdGlvbnMoZ2xvYmFsT3B0aW9ucywgdXNlck9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2hhcmVkID0gZm9ybWF0U2hhcmVDb25maWdzKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKS5zaGFyZWQ7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzX2hvb2tzX2xpZmVjeWNsZV9iZWZvcmVJbml0X2VtaXQgPSB0aGlzLmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVJbml0LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBnbG9iYWxPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm86IHNoYXJlZFxuICAgICAgICAgICAgICAgIH0pLCB1c2VyT3B0aW9uc1JlcyA9IF90aGlzX2hvb2tzX2xpZmVjeWNsZV9iZWZvcmVJbml0X2VtaXQudXNlck9wdGlvbnMsIGdsb2JhbE9wdGlvbnNSZXMgPSBfdGhpc19ob29rc19saWZlY3ljbGVfYmVmb3JlSW5pdF9lbWl0Lm9wdGlvbnM7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZXMgPSB0aGlzLnJlbW90ZUhhbmRsZXIuZm9ybWF0QW5kUmVnaXN0ZXJSZW1vdGUoZ2xvYmFsT3B0aW9uc1JlcywgdXNlck9wdGlvbnNSZXMpO1xuICAgICAgICAgICAgICAgIHZhciBfdGhpc19zaGFyZWRIYW5kbGVyX3JlZ2lzdGVyU2hhcmVkID0gdGhpcy5zaGFyZWRIYW5kbGVyLnJlZ2lzdGVyU2hhcmVkKGdsb2JhbE9wdGlvbnNSZXMsIHVzZXJPcHRpb25zUmVzKSwgaGFuZGxlZFNoYXJlZCA9IF90aGlzX3NoYXJlZEhhbmRsZXJfcmVnaXN0ZXJTaGFyZWQuc2hhcmVkO1xuICAgICAgICAgICAgICAgIHZhciBwbHVnaW5zID0gX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhnbG9iYWxPcHRpb25zUmVzLnBsdWdpbnMpO1xuICAgICAgICAgICAgICAgIGlmICh1c2VyT3B0aW9uc1Jlcy5wbHVnaW5zKSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJPcHRpb25zUmVzLnBsdWdpbnMuZm9yRWFjaCgocGx1Z2luKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwbHVnaW5zLmluY2x1ZGVzKHBsdWdpbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW5zLnB1c2gocGx1Z2luKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zUmVzID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucywge1xuICAgICAgICAgICAgICAgICAgICBwbHVnaW5zLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVzLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IGhhbmRsZWRTaGFyZWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5pbml0LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnNSZXNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9uc1JlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlZ2lzdGVyUGx1Z2luc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyUGx1Z2luczEocGx1Z2lucykge1xuICAgICAgICAgICAgICAgIHZhciBwbHVnaW5SZXMgPSByZWdpc3RlclBsdWdpbnMocGx1Z2lucywgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhvb2tzLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW90ZUhhbmRsZXIuaG9va3MsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkSGFuZGxlci5ob29rcyxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zbmFwc2hvdEhhbmRsZXIuaG9va3MsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGVySG9vayxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5icmlkZ2VIb29rXG4gICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgLy8gTWVyZ2UgcGx1Z2luXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnBsdWdpbnMgPSB0aGlzLm9wdGlvbnMucGx1Z2lucy5yZWR1Y2UoKHJlcywgcGx1Z2luKT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXBsdWdpbikgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcyAmJiAhcmVzLmZpbmQoKGl0ZW0pPT5pdGVtLm5hbWUgPT09IHBsdWdpbi5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2gocGx1Z2luKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgIH0sIHBsdWdpblJlcyB8fCBbXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZWdpc3RlclJlbW90ZXNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlclJlbW90ZXMocmVtb3Rlcywgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZUhhbmRsZXIucmVnaXN0ZXJSZW1vdGVzKHJlbW90ZXMsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIEZlZGVyYXRpb25Ib3N0O1xufSgpO1xudmFyIGluZGV4ID0gLyojX19QVVJFX18qLyBPYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGxcbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwibG9hZFNjcmlwdFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHNkay5sb2FkU2NyaXB0O1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImxvYWRTY3JpcHROb2RlXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gc2RrLmxvYWRTY3JpcHROb2RlO1xuICAgIH1cbn0pKTtcbmV4cG9ydHMuQ3VycmVudEdsb2JhbCA9IEN1cnJlbnRHbG9iYWw7XG5leHBvcnRzLkZlZGVyYXRpb25Ib3N0ID0gRmVkZXJhdGlvbkhvc3Q7XG5leHBvcnRzLkdsb2JhbCA9IEdsb2JhbDtcbmV4cG9ydHMuTW9kdWxlID0gTW9kdWxlO1xuZXhwb3J0cy5hZGRHbG9iYWxTbmFwc2hvdCA9IGFkZEdsb2JhbFNuYXBzaG90O1xuZXhwb3J0cy5hc3NlcnQgPSBhc3NlcnQ7XG5leHBvcnRzLmdldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvciA9IGdldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcjtcbmV4cG9ydHMuZ2V0R2xvYmFsU25hcHNob3QgPSBnZXRHbG9iYWxTbmFwc2hvdDtcbmV4cG9ydHMuZ2V0SW5mb1dpdGhvdXRUeXBlID0gZ2V0SW5mb1dpdGhvdXRUeXBlO1xuZXhwb3J0cy5nZXRSZWdpc3RlcmVkU2hhcmUgPSBnZXRSZWdpc3RlcmVkU2hhcmU7XG5leHBvcnRzLmdldFJlbW90ZUVudHJ5ID0gZ2V0UmVtb3RlRW50cnk7XG5leHBvcnRzLmdldFJlbW90ZUluZm8gPSBnZXRSZW1vdGVJbmZvO1xuZXhwb3J0cy5oZWxwZXJzID0gaGVscGVycztcbmV4cG9ydHMuaXNTdGF0aWNSZXNvdXJjZXNFcXVhbCA9IGlzU3RhdGljUmVzb3VyY2VzRXF1YWw7XG5leHBvcnRzLm1hdGNoUmVtb3RlV2l0aE5hbWVBbmRFeHBvc2UgPSBtYXRjaFJlbW90ZVdpdGhOYW1lQW5kRXhwb3NlO1xuZXhwb3J0cy5yZWdpc3Rlckdsb2JhbFBsdWdpbnMgPSByZWdpc3Rlckdsb2JhbFBsdWdpbnM7XG5leHBvcnRzLnJlc2V0RmVkZXJhdGlvbkdsb2JhbEluZm8gPSByZXNldEZlZGVyYXRpb25HbG9iYWxJbmZvO1xuZXhwb3J0cy5zYWZlV3JhcHBlciA9IHNhZmVXcmFwcGVyO1xuZXhwb3J0cy5zYXRpc2Z5ID0gc2F0aXNmeTtcbmV4cG9ydHMuc2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yID0gc2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yO1xuZXhwb3J0cy5zZXRHbG9iYWxGZWRlcmF0aW9uSW5zdGFuY2UgPSBzZXRHbG9iYWxGZWRlcmF0aW9uSW5zdGFuY2U7XG5leHBvcnRzLnR5cGVzID0gaW5kZXg7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lLWNvcmUvZGlzdC9wb2x5ZmlsbHMuY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvcG9seWZpbGxzLmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfZXh0ZW5kcygpIHtcbiAgICBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gYXNzaWduKHRhcmdldCkge1xuICAgICAgICBmb3IodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBmb3IodmFyIGtleSBpbiBzb3VyY2UpaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9O1xuICAgIHJldHVybiBfZXh0ZW5kcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2Uoc291cmNlLCBleGNsdWRlZCkge1xuICAgIGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9O1xuICAgIHZhciB0YXJnZXQgPSB7fTtcbiAgICB2YXIgc291cmNlS2V5cyA9IE9iamVjdC5rZXlzKHNvdXJjZSk7XG4gICAgdmFyIGtleSwgaTtcbiAgICBmb3IoaSA9IDA7IGkgPCBzb3VyY2VLZXlzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAga2V5ID0gc291cmNlS2V5c1tpXTtcbiAgICAgICAgaWYgKGV4Y2x1ZGVkLmluZGV4T2Yoa2V5KSA+PSAwKSBjb250aW51ZTtcbiAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbn1cbmV4cG9ydHMuX2V4dGVuZHMgPSBfZXh0ZW5kcztcbmV4cG9ydHMuX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2UgPSBfb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllc19sb29zZTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvZGlzdC9pbmRleC5janMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBydW50aW1lQ29yZSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBtb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lLWNvcmUgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvaW5kZXguY2pzLmpzXCIpO1xudmFyIHV0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi91dGlscy5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L3V0aWxzLmNqcy5qc1wiKTtcbnZhciBGZWRlcmF0aW9uSW5zdGFuY2UgPSBudWxsO1xuZnVuY3Rpb24gaW5pdChvcHRpb25zKSB7XG4gICAgLy8gUmV0cmlldmUgdGhlIHNhbWUgaW5zdGFuY2Ugd2l0aCB0aGUgc2FtZSBuYW1lXG4gICAgdmFyIGluc3RhbmNlID0gdXRpbHMuZ2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlKG9wdGlvbnMubmFtZSwgb3B0aW9ucy52ZXJzaW9uKTtcbiAgICBpZiAoIWluc3RhbmNlKSB7XG4gICAgICAgIC8vIFJldHJpZXZlIGRlYnVnIGNvbnN0cnVjdG9yXG4gICAgICAgIHZhciBGZWRlcmF0aW9uQ29uc3RydWN0b3IgPSBydW50aW1lQ29yZS5nZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IoKSB8fCBydW50aW1lQ29yZS5GZWRlcmF0aW9uSG9zdDtcbiAgICAgICAgRmVkZXJhdGlvbkluc3RhbmNlID0gbmV3IEZlZGVyYXRpb25Db25zdHJ1Y3RvcihvcHRpb25zKTtcbiAgICAgICAgcnVudGltZUNvcmUuc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlKEZlZGVyYXRpb25JbnN0YW5jZSk7XG4gICAgICAgIHJldHVybiBGZWRlcmF0aW9uSW5zdGFuY2U7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gTWVyZ2Ugb3B0aW9uc1xuICAgICAgICBpbnN0YW5jZS5pbml0T3B0aW9ucyhvcHRpb25zKTtcbiAgICAgICAgaWYgKCFGZWRlcmF0aW9uSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIEZlZGVyYXRpb25JbnN0YW5jZSA9IGluc3RhbmNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9XG59XG5mdW5jdGlvbiBsb2FkUmVtb3RlKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIHZhciBsb2FkUmVtb3RlMSA9IEZlZGVyYXRpb25JbnN0YW5jZS5sb2FkUmVtb3RlO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIGxvYWRSZW1vdGUxLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiBsb2FkU2hhcmUoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICB2YXIgbG9hZFNoYXJlMSA9IEZlZGVyYXRpb25JbnN0YW5jZS5sb2FkU2hhcmU7XG4gICAgcmV0dXJuIGxvYWRTaGFyZTEuYXBwbHkoRmVkZXJhdGlvbkluc3RhbmNlLCBhcmdzKTtcbn1cbmZ1bmN0aW9uIGxvYWRTaGFyZVN5bmMoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgdmFyIGxvYWRTaGFyZVN5bmMxID0gRmVkZXJhdGlvbkluc3RhbmNlLmxvYWRTaGFyZVN5bmM7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICByZXR1cm4gbG9hZFNoYXJlU3luYzEuYXBwbHkoRmVkZXJhdGlvbkluc3RhbmNlLCBhcmdzKTtcbn1cbmZ1bmN0aW9uIHByZWxvYWRSZW1vdGUoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICByZXR1cm4gRmVkZXJhdGlvbkluc3RhbmNlLnByZWxvYWRSZW1vdGUuYXBwbHkoRmVkZXJhdGlvbkluc3RhbmNlLCBhcmdzKTtcbn1cbmZ1bmN0aW9uIHJlZ2lzdGVyUmVtb3RlcyguLi5hcmdzKSB7XG4gICAgcnVudGltZUNvcmUuYXNzZXJ0KEZlZGVyYXRpb25JbnN0YW5jZSwgJ1BsZWFzZSBjYWxsIGluaXQgZmlyc3QnKTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLXNwcmVhZFxuICAgIHJldHVybiBGZWRlcmF0aW9uSW5zdGFuY2UucmVnaXN0ZXJSZW1vdGVzLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiByZWdpc3RlclBsdWdpbnMoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICByZXR1cm4gRmVkZXJhdGlvbkluc3RhbmNlLnJlZ2lzdGVyUGx1Z2lucy5hcHBseShGZWRlcmF0aW9uSW5zdGFuY2UsIGFyZ3MpO1xufVxuZnVuY3Rpb24gZ2V0SW5zdGFuY2UoKSB7XG4gICAgcmV0dXJuIEZlZGVyYXRpb25JbnN0YW5jZTtcbn1cbi8vIEluamVjdCBmb3IgZGVidWdcbnJ1bnRpbWVDb3JlLnNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcihydW50aW1lQ29yZS5GZWRlcmF0aW9uSG9zdCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJGZWRlcmF0aW9uSG9zdFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLkZlZGVyYXRpb25Ib3N0O1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIk1vZHVsZVwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLk1vZHVsZTtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJnZXRSZW1vdGVFbnRyeVwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLmdldFJlbW90ZUVudHJ5O1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImdldFJlbW90ZUluZm9cIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5nZXRSZW1vdGVJbmZvO1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImxvYWRTY3JpcHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5sb2FkU2NyaXB0O1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImxvYWRTY3JpcHROb2RlXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcnVudGltZUNvcmUubG9hZFNjcmlwdE5vZGU7XG4gICAgfVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwicmVnaXN0ZXJHbG9iYWxQbHVnaW5zXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcnVudGltZUNvcmUucmVnaXN0ZXJHbG9iYWxQbHVnaW5zO1xuICAgIH1cbn0pKTtcbmV4cG9ydHMuZ2V0SW5zdGFuY2UgPSBnZXRJbnN0YW5jZTtcbmV4cG9ydHMuaW5pdCA9IGluaXQ7XG5leHBvcnRzLmxvYWRSZW1vdGUgPSBsb2FkUmVtb3RlO1xuZXhwb3J0cy5sb2FkU2hhcmUgPSBsb2FkU2hhcmU7XG5leHBvcnRzLmxvYWRTaGFyZVN5bmMgPSBsb2FkU2hhcmVTeW5jO1xuZXhwb3J0cy5wcmVsb2FkUmVtb3RlID0gcHJlbG9hZFJlbW90ZTtcbmV4cG9ydHMucmVnaXN0ZXJQbHVnaW5zID0gcmVnaXN0ZXJQbHVnaW5zO1xuZXhwb3J0cy5yZWdpc3RlclJlbW90ZXMgPSByZWdpc3RlclJlbW90ZXM7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL2Rpc3QvdXRpbHMuY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L3V0aWxzLmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgcnVudGltZUNvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbi8vIGluamVjdGVkIGJ5IGJ1bmRsZXIsIHNvIGl0IGNhbiBub3QgdXNlIHJ1bnRpbWUtY29yZSBzdHVmZlxuZnVuY3Rpb24gZ2V0QnVpbGRlcklkKCkge1xuICAgIC8vQHRzLWlnbm9yZVxuICAgIHJldHVybiAgdHJ1ZSA/IFwibW92aWVzOjEuMC4wXCIgOiAwO1xufVxuZnVuY3Rpb24gZ2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlKG5hbWUsIHZlcnNpb24pIHtcbiAgICB2YXIgYnVpbGRJZCA9IGdldEJ1aWxkZXJJZCgpO1xuICAgIHJldHVybiBydW50aW1lQ29yZS5DdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX18uZmluZCgoR01JbnN0YW5jZSk9PntcbiAgICAgICAgaWYgKGJ1aWxkSWQgJiYgR01JbnN0YW5jZS5vcHRpb25zLmlkID09PSBnZXRCdWlsZGVySWQoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEdNSW5zdGFuY2Uub3B0aW9ucy5uYW1lID09PSBuYW1lICYmICFHTUluc3RhbmNlLm9wdGlvbnMudmVyc2lvbiAmJiAhdmVyc2lvbikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEdNSW5zdGFuY2Uub3B0aW9ucy5uYW1lID09PSBuYW1lICYmIHZlcnNpb24gJiYgR01JbnN0YW5jZS5vcHRpb25zLnZlcnNpb24gPT09IHZlcnNpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuZ2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlID0gZ2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vc2RrL2Rpc3QvaW5kZXguY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9zZGsvZGlzdC9pbmRleC5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbnZhciBfYXN5bmNfdG9fZ2VuZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2FzeW5jX3RvX2dlbmVyYXRvciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FzeW5jX3RvX2dlbmVyYXRvci5janNcIik7XG52YXIgX2NsYXNzX2NhbGxfY2hlY2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY2xhc3NfY2FsbF9jaGVjayAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NsYXNzX2NhbGxfY2hlY2suY2pzXCIpO1xudmFyIF9jcmVhdGVfY2xhc3MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY3JlYXRlX2NsYXNzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY3JlYXRlX2NsYXNzLmNqc1wiKTtcbnZhciBfc2xpY2VkX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3NsaWNlZF90b19hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janNcIik7XG52YXIgX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2FycmF5ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19jb25zdW1hYmxlX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2NvbnN1bWFibGVfYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqc1wiKTtcbnZhciBwb2x5ZmlsbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3BvbHlmaWxscy5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vc2RrL2Rpc3QvcG9seWZpbGxzLmNqcy5qc1wiKTtcbnZhciBGZWRlcmF0aW9uTW9kdWxlTWFuaWZlc3QgPSAnZmVkZXJhdGlvbi1tYW5pZmVzdC5qc29uJztcbnZhciBNQU5JRkVTVF9FWFQgPSAnLmpzb24nO1xudmFyIEJST1dTRVJfTE9HX0tFWSA9ICdGRURFUkFUSU9OX0RFQlVHJztcbnZhciBCUk9XU0VSX0xPR19WQUxVRSA9ICcxJztcbnZhciBOYW1lVHJhbnNmb3JtU3ltYm9sID0ge1xuICAgIEFUOiAnQCcsXG4gICAgSFlQSEVOOiAnLScsXG4gICAgU0xBU0g6ICcvJ1xufTtcbnZhciBOYW1lVHJhbnNmb3JtTWFwID0ge1xuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXTogJ3Njb3BlXycsXG4gICAgW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXTogJ18nLFxuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXTogJ19fJ1xufTtcbnZhciBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcCA9IHtcbiAgICBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXV06IE5hbWVUcmFuc2Zvcm1TeW1ib2wuQVQsXG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dXTogTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU4sXG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF1dOiBOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXG59O1xudmFyIFNFUEFSQVRPUiA9ICc6JztcbnZhciBNYW5pZmVzdEZpbGVOYW1lID0gJ21mLW1hbmlmZXN0Lmpzb24nO1xudmFyIFN0YXRzRmlsZU5hbWUgPSAnbWYtc3RhdHMuanNvbic7XG52YXIgTUZNb2R1bGVUeXBlID0ge1xuICAgIE5QTTogJ25wbScsXG4gICAgQVBQOiAnYXBwJ1xufTtcbnZhciBNT0RVTEVfREVWVE9PTF9JREVOVElGSUVSID0gJ19fTUZfREVWVE9PTFNfTU9EVUxFX0lORk9fXyc7XG52YXIgRU5DT0RFX05BTUVfUFJFRklYID0gJ0VOQ09ERV9OQU1FX1BSRUZJWCc7XG52YXIgVEVNUF9ESVIgPSAnLmZlZGVyYXRpb24nO1xudmFyIE1GUHJlZmV0Y2hDb21tb24gPSB7XG4gICAgaWRlbnRpZmllcjogJ01GRGF0YVByZWZldGNoJyxcbiAgICBnbG9iYWxLZXk6ICdfX1BSRUZFVENIX18nLFxuICAgIGxpYnJhcnk6ICdtZi1kYXRhLXByZWZldGNoJyxcbiAgICBleHBvcnRzS2V5OiAnX19QUkVGRVRDSF9FWFBPUlRTX18nLFxuICAgIGZpbGVOYW1lOiAnYm9vdHN0cmFwLmpzJ1xufTtcbnZhciBDb250YWluZXJQbHVnaW4gPSAvKiNfX1BVUkVfXyovIE9iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbFxufSk7XG52YXIgQ29udGFpbmVyUmVmZXJlbmNlUGx1Z2luID0gLyojX19QVVJFX18qLyBPYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGxcbn0pO1xudmFyIE1vZHVsZUZlZGVyYXRpb25QbHVnaW4gPSAvKiNfX1BVUkVfXyovIE9iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbFxufSk7XG52YXIgU2hhcmVQbHVnaW4gPSAvKiNfX1BVUkVfXyovIE9iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbFxufSk7XG5mdW5jdGlvbiBpc0Jyb3dzZXJFbnYoKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnO1xufVxuZnVuY3Rpb24gaXNCcm93c2VyRGVidWcoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKGlzQnJvd3NlckVudigpICYmIHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShCUk9XU0VSX0xPR19LRVkpID09PSBCUk9XU0VSX0xPR19WQUxVRTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yMSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGlzRGVidWdNb2RlKCkge1xuICAgIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnZbJ0ZFREVSQVRJT05fREVCVUcnXSkge1xuICAgICAgICByZXR1cm4gQm9vbGVhbihwcm9jZXNzLmVudlsnRkVERVJBVElPTl9ERUJVRyddKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBGRURFUkFUSU9OX0RFQlVHICE9PSAndW5kZWZpbmVkJyAmJiBCb29sZWFuKEZFREVSQVRJT05fREVCVUcpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gaXNCcm93c2VyRGVidWcoKTtcbn1cbnZhciBnZXRQcm9jZXNzRW52ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwcm9jZXNzLmVudiA/IHByb2Nlc3MuZW52IDoge307XG59O1xudmFyIExPR19DQVRFR09SWSA9ICdbIEZlZGVyYXRpb24gUnVudGltZSBdJztcbi8vIGVudHJ5OiBuYW1lOnZlcnNpb24gICB2ZXJzaW9uIDogMS4wLjAgfCBeMS4yLjNcbi8vIGVudHJ5OiBuYW1lOmVudHJ5ICBlbnRyeTogIGh0dHBzOi8vbG9jYWxob3N0OjkwMDAvZmVkZXJhdGlvbi1tYW5pZmVzdC5qc29uXG52YXIgcGFyc2VFbnRyeSA9IChzdHIsIGRldlZlck9yVXJsLCByZWYpPT57XG4gICAgdmFyIHNlcGFyYXRvciA9IHJlZiA9PT0gdm9pZCAwID8gU0VQQVJBVE9SIDogcmVmO1xuICAgIHZhciBzdHJTcGxpdCA9IHN0ci5zcGxpdChzZXBhcmF0b3IpO1xuICAgIHZhciBkZXZWZXJzaW9uT3JVcmwgPSBnZXRQcm9jZXNzRW52KClbJ05PREVfRU5WJ10gPT09ICdkZXZlbG9wbWVudCcgJiYgZGV2VmVyT3JVcmw7XG4gICAgdmFyIGRlZmF1bHRWZXJzaW9uID0gJyonO1xuICAgIHZhciBpc0VudHJ5ID0gKHMpPT5zLnN0YXJ0c1dpdGgoJ2h0dHAnKSB8fCBzLmluY2x1ZGVzKE1BTklGRVNUX0VYVCk7XG4gICAgLy8gQ2hlY2sgaWYgdGhlIHN0cmluZyBzdGFydHMgd2l0aCBhIHR5cGVcbiAgICBpZiAoc3RyU3BsaXQubGVuZ3RoID49IDIpIHtcbiAgICAgICAgdmFyIF9zdHJTcGxpdCA9IF90b19hcnJheS5fKHN0clNwbGl0KSwgbmFtZSA9IF9zdHJTcGxpdFswXSwgdmVyc2lvbk9yRW50cnlBcnIgPSBfc3RyU3BsaXQuc2xpY2UoMSk7XG4gICAgICAgIC8vIEBuYW1lQG1hbmlmZXN0LXVybC5qc29uXG4gICAgICAgIGlmIChzdHIuc3RhcnRzV2l0aChzZXBhcmF0b3IpKSB7XG4gICAgICAgICAgICBuYW1lID0gc3RyU3BsaXQuc2xpY2UoMCwgMikuam9pbihzZXBhcmF0b3IpO1xuICAgICAgICAgICAgdmVyc2lvbk9yRW50cnlBcnIgPSBbXG4gICAgICAgICAgICAgICAgZGV2VmVyc2lvbk9yVXJsIHx8IHN0clNwbGl0LnNsaWNlKDIpLmpvaW4oc2VwYXJhdG9yKVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmVyc2lvbk9yRW50cnkgPSBkZXZWZXJzaW9uT3JVcmwgfHwgdmVyc2lvbk9yRW50cnlBcnIuam9pbihzZXBhcmF0b3IpO1xuICAgICAgICBpZiAoaXNFbnRyeSh2ZXJzaW9uT3JFbnRyeSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICBlbnRyeTogdmVyc2lvbk9yRW50cnlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBBcHBseSB2ZXJzaW9uIHJ1bGVcbiAgICAgICAgICAgIC8vIGRldlZlcnNpb25PclVybCA9PiBpbnB1dFZlcnNpb24gPT4gZGVmYXVsdFZlcnNpb25cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiB2ZXJzaW9uT3JFbnRyeSB8fCBkZWZhdWx0VmVyc2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoc3RyU3BsaXQubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHZhciBfc3RyU3BsaXQxID0gX3NsaWNlZF90b19hcnJheS5fKHN0clNwbGl0LCAxKSwgbmFtZTEgPSBfc3RyU3BsaXQxWzBdO1xuICAgICAgICBpZiAoZGV2VmVyc2lvbk9yVXJsICYmIGlzRW50cnkoZGV2VmVyc2lvbk9yVXJsKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICBlbnRyeTogZGV2VmVyc2lvbk9yVXJsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBuYW1lMSxcbiAgICAgICAgICAgIHZlcnNpb246IGRldlZlcnNpb25PclVybCB8fCBkZWZhdWx0VmVyc2lvblxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IGBJbnZhbGlkIGVudHJ5IHZhbHVlOiAke3N0cn1gO1xuICAgIH1cbn07XG52YXIgY29tcG9zZUtleVdpdGhTZXBhcmF0b3IgPSBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgaWYgKCFhcmdzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIHJldHVybiBhcmdzLnJlZHVjZSgoc3VtLCBjdXIpPT57XG4gICAgICAgIGlmICghY3VyKSB7XG4gICAgICAgICAgICByZXR1cm4gc3VtO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc3VtKSB7XG4gICAgICAgICAgICByZXR1cm4gY3VyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgJHtzdW19JHtTRVBBUkFUT1J9JHtjdXJ9YDtcbiAgICB9LCAnJyk7XG59O1xudmFyIGVuY29kZU5hbWUgPSBmdW5jdGlvbihuYW1lLCByZWYsIHJlZjEpIHtcbiAgICB2YXIgcHJlZml4ID0gcmVmID09PSB2b2lkIDAgPyAnJyA6IHJlZiwgd2l0aEV4dCA9IHJlZjEgPT09IHZvaWQgMCA/IGZhbHNlIDogcmVmMTtcbiAgICB0cnkge1xuICAgICAgICB2YXIgZXh0ID0gd2l0aEV4dCA/ICcuanMnIDogJyc7XG4gICAgICAgIHJldHVybiBgJHtwcmVmaXh9JHtuYW1lLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUfWAsICdnJyksIE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTn1gLCAnZycpLCBOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXSkucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0h9YCwgJ2cnKSwgTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXSl9JHtleHR9YDtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbn07XG52YXIgZGVjb2RlTmFtZSA9IGZ1bmN0aW9uKG5hbWUsIHByZWZpeCwgd2l0aEV4dCkge1xuICAgIHRyeSB7XG4gICAgICAgIHZhciBkZWNvZGVkTmFtZSA9IG5hbWU7XG4gICAgICAgIGlmIChwcmVmaXgpIHtcbiAgICAgICAgICAgIGlmICghZGVjb2RlZE5hbWUuc3RhcnRzV2l0aChwcmVmaXgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlY29kZWROYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVjb2RlZE5hbWUgPSBkZWNvZGVkTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAocHJlZml4LCAnZycpLCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVjb2RlZE5hbWUgPSBkZWNvZGVkTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXX1gLCAnZycpLCBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdXSkucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXV0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXX1gLCAnZycpLCBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXV0pO1xuICAgICAgICBpZiAod2l0aEV4dCkge1xuICAgICAgICAgICAgZGVjb2RlZE5hbWUgPSBkZWNvZGVkTmFtZS5yZXBsYWNlKCcuanMnLCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlY29kZWROYW1lO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgfVxufTtcbnZhciBnZW5lcmF0ZUV4cG9zZUZpbGVuYW1lID0gKGV4cG9zZU5hbWUsIHdpdGhFeHQpPT57XG4gICAgaWYgKCFleHBvc2VOYW1lKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgdmFyIGV4cG9zZSA9IGV4cG9zZU5hbWU7XG4gICAgaWYgKGV4cG9zZSA9PT0gJy4nKSB7XG4gICAgICAgIGV4cG9zZSA9ICdkZWZhdWx0X2V4cG9ydCc7XG4gICAgfVxuICAgIGlmIChleHBvc2Uuc3RhcnRzV2l0aCgnLi8nKSkge1xuICAgICAgICBleHBvc2UgPSBleHBvc2UucmVwbGFjZSgnLi8nLCAnJyk7XG4gICAgfVxuICAgIHJldHVybiBlbmNvZGVOYW1lKGV4cG9zZSwgJ19fZmVkZXJhdGlvbl9leHBvc2VfJywgd2l0aEV4dCk7XG59O1xudmFyIGdlbmVyYXRlU2hhcmVGaWxlbmFtZSA9IChwa2dOYW1lLCB3aXRoRXh0KT0+e1xuICAgIGlmICghcGtnTmFtZSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIHJldHVybiBlbmNvZGVOYW1lKHBrZ05hbWUsICdfX2ZlZGVyYXRpb25fc2hhcmVkXycsIHdpdGhFeHQpO1xufTtcbnZhciBnZXRSZXNvdXJjZVVybCA9IChtb2R1bGUsIHNvdXJjZVVybCk9PntcbiAgICBpZiAoJ2dldFB1YmxpY1BhdGgnIGluIG1vZHVsZSkge1xuICAgICAgICB2YXIgcHVibGljUGF0aDtcbiAgICAgICAgaWYgKCFtb2R1bGUuZ2V0UHVibGljUGF0aC5zdGFydHNXaXRoKCdmdW5jdGlvbicpKSB7XG4gICAgICAgICAgICBwdWJsaWNQYXRoID0gbmV3IEZ1bmN0aW9uKG1vZHVsZS5nZXRQdWJsaWNQYXRoKSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHVibGljUGF0aCA9IG5ldyBGdW5jdGlvbigncmV0dXJuICcgKyBtb2R1bGUuZ2V0UHVibGljUGF0aCkoKSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgJHtwdWJsaWNQYXRofSR7c291cmNlVXJsfWA7XG4gICAgfSBlbHNlIGlmICgncHVibGljUGF0aCcgaW4gbW9kdWxlKSB7XG4gICAgICAgIHJldHVybiBgJHttb2R1bGUucHVibGljUGF0aH0ke3NvdXJjZVVybH1gO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUud2FybignQ2Fubm90IGdldCByZXNvdXJjZSBVUkwuIElmIGluIGRlYnVnIG1vZGUsIHBsZWFzZSBpZ25vcmUuJywgbW9kdWxlLCBzb3VyY2VVcmwpO1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufTtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvZXhwbGljaXQtbW9kdWxlLWJvdW5kYXJ5LXR5cGVzXG52YXIgYXNzZXJ0ID0gKGNvbmRpdGlvbiwgbXNnKT0+e1xuICAgIGlmICghY29uZGl0aW9uKSB7XG4gICAgICAgIGVycm9yKG1zZyk7XG4gICAgfVxufTtcbnZhciBlcnJvciA9IChtc2cpPT57XG4gICAgdGhyb3cgbmV3IEVycm9yKGAke0xPR19DQVRFR09SWX06ICR7bXNnfWApO1xufTtcbnZhciB3YXJuID0gKG1zZyk9PntcbiAgICBjb25zb2xlLndhcm4oYCR7TE9HX0NBVEVHT1JZfTogJHttc2d9YCk7XG59O1xuZnVuY3Rpb24gc2FmZVRvU3RyaW5nKGluZm8pIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoaW5mbywgbnVsbCwgMik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufVxuLy8gUmVnRXhwIGZvciB2ZXJzaW9uIHN0cmluZ1xudmFyIFZFUlNJT05fUEFUVEVSTl9SRUdFWFAgPSAvXihbXFxkXj12PD5+XXxbKnhYXSQpLztcbmZ1bmN0aW9uIGlzUmVxdWlyZWRWZXJzaW9uKHN0cikge1xuICAgIHJldHVybiBWRVJTSU9OX1BBVFRFUk5fUkVHRVhQLnRlc3Qoc3RyKTtcbn1cbnZhciBzaW1wbGVKb2luUmVtb3RlRW50cnkgPSAoclBhdGgsIHJOYW1lKT0+e1xuICAgIGlmICghclBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHJOYW1lO1xuICAgIH1cbiAgICB2YXIgdHJhbnNmb3JtUGF0aCA9IChzdHIpPT57XG4gICAgICAgIGlmIChzdHIgPT09ICcuJykge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdHIuc3RhcnRzV2l0aCgnLi8nKSkge1xuICAgICAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKCcuLycsICcnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgdmFyIHN0cldpdGhvdXRTbGFzaCA9IHN0ci5zbGljZSgxKTtcbiAgICAgICAgICAgIGlmIChzdHJXaXRob3V0U2xhc2guZW5kc1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdHJXaXRob3V0U2xhc2guc2xpY2UoMCwgLTEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHN0cldpdGhvdXRTbGFzaDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH07XG4gICAgdmFyIHRyYW5zZm9ybWVkUGF0aCA9IHRyYW5zZm9ybVBhdGgoclBhdGgpO1xuICAgIGlmICghdHJhbnNmb3JtZWRQYXRoKSB7XG4gICAgICAgIHJldHVybiByTmFtZTtcbiAgICB9XG4gICAgaWYgKHRyYW5zZm9ybWVkUGF0aC5lbmRzV2l0aCgnLycpKSB7XG4gICAgICAgIHJldHVybiBgJHt0cmFuc2Zvcm1lZFBhdGh9JHtyTmFtZX1gO1xuICAgIH1cbiAgICByZXR1cm4gYCR7dHJhbnNmb3JtZWRQYXRofS8ke3JOYW1lfWA7XG59O1xuZnVuY3Rpb24gaW5mZXJBdXRvUHVibGljUGF0aCh1cmwpIHtcbiAgICByZXR1cm4gdXJsLnJlcGxhY2UoLyMuKiQvLCAnJykucmVwbGFjZSgvXFw/LiokLywgJycpLnJlcGxhY2UoL1xcL1teXFwvXSskLywgJy8nKTtcbn1cbi8vIFByaW9yaXR5OiBvdmVycmlkZXMgPiByZW1vdGVzXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvblxuZnVuY3Rpb24gZ2VuZXJhdGVTbmFwc2hvdEZyb21NYW5pZmVzdChtYW5pZmVzdCwgcmVmKSB7XG4gICAgdmFyIG9wdGlvbnMgPSByZWYgPT09IHZvaWQgMCA/IHt9IDogcmVmO1xuICAgIHZhciBfbWFuaWZlc3RfbWV0YURhdGEsIF9tYW5pZmVzdF9tZXRhRGF0YTE7XG4gICAgdmFyIF9vcHRpb25zX3JlbW90ZXMgPSBvcHRpb25zLnJlbW90ZXMsIHJlbW90ZXMgPSBfb3B0aW9uc19yZW1vdGVzID09PSB2b2lkIDAgPyB7fSA6IF9vcHRpb25zX3JlbW90ZXMsIF9vcHRpb25zX292ZXJyaWRlcyA9IG9wdGlvbnMub3ZlcnJpZGVzLCBvdmVycmlkZXMgPSBfb3B0aW9uc19vdmVycmlkZXMgPT09IHZvaWQgMCA/IHt9IDogX29wdGlvbnNfb3ZlcnJpZGVzLCB2ZXJzaW9uID0gb3B0aW9ucy52ZXJzaW9uO1xuICAgIHZhciByZW1vdGVTbmFwc2hvdDtcbiAgICB2YXIgZ2V0UHVibGljUGF0aCA9ICgpPT57XG4gICAgICAgIGlmICgncHVibGljUGF0aCcgaW4gbWFuaWZlc3QubWV0YURhdGEpIHtcbiAgICAgICAgICAgIGlmIChtYW5pZmVzdC5tZXRhRGF0YS5wdWJsaWNQYXRoID09PSAnYXV0bycgJiYgdmVyc2lvbikge1xuICAgICAgICAgICAgICAgIC8vIHVzZSBzYW1lIGltcGxlbWVudGF0aW9uIGFzIHB1YmxpY1BhdGggYXV0byBydW50aW1lIG1vZHVsZSBpbXBsZW1lbnRzXG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZmVyQXV0b1B1YmxpY1BhdGgodmVyc2lvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWFuaWZlc3QubWV0YURhdGEucHVibGljUGF0aDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBtYW5pZmVzdC5tZXRhRGF0YS5nZXRQdWJsaWNQYXRoO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgb3ZlcnJpZGVzS2V5cyA9IE9iamVjdC5rZXlzKG92ZXJyaWRlcyk7XG4gICAgdmFyIHJlbW90ZXNJbmZvID0ge307XG4gICAgLy8gSWYgcmVtb3RlcyBhcmUgbm90IHByb3ZpZGVkLCBvbmx5IHRoZSByZW1vdGVzIGluIHRoZSBtYW5pZmVzdCB3aWxsIGJlIHJlYWRcbiAgICBpZiAoIU9iamVjdC5rZXlzKHJlbW90ZXMpLmxlbmd0aCkge1xuICAgICAgICB2YXIgX21hbmlmZXN0X3JlbW90ZXM7XG4gICAgICAgIHJlbW90ZXNJbmZvID0gKChfbWFuaWZlc3RfcmVtb3RlcyA9IG1hbmlmZXN0LnJlbW90ZXMpID09IG51bGwgPyB2b2lkIDAgOiBfbWFuaWZlc3RfcmVtb3Rlcy5yZWR1Y2UoKHJlcywgbmV4dCk9PntcbiAgICAgICAgICAgIHZhciBtYXRjaGVkVmVyc2lvbjtcbiAgICAgICAgICAgIHZhciBuYW1lID0gbmV4dC5mZWRlcmF0aW9uQ29udGFpbmVyTmFtZTtcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlcyBoYXZlIGhpZ2hlciBwcmlvcml0eVxuICAgICAgICAgICAgaWYgKG92ZXJyaWRlc0tleXMuaW5jbHVkZXMobmFtZSkpIHtcbiAgICAgICAgICAgICAgICBtYXRjaGVkVmVyc2lvbiA9IG92ZXJyaWRlc1tuYW1lXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCd2ZXJzaW9uJyBpbiBuZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uID0gbmV4dC52ZXJzaW9uO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uID0gbmV4dC5lbnRyeTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNbbmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgbWF0Y2hlZFZlcnNpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9LCB7fSkpIHx8IHt9O1xuICAgIH1cbiAgICAvLyBJZiByZW1vdGVzIChkZXBsb3kgc2NlbmFyaW8pIGFyZSBzcGVjaWZpZWQsIHRoZXkgbmVlZCB0byBiZSB0cmF2ZXJzZWQgYWdhaW5cbiAgICBPYmplY3Qua2V5cyhyZW1vdGVzKS5mb3JFYWNoKChrZXkpPT5yZW1vdGVzSW5mb1trZXldID0ge1xuICAgICAgICAgICAgLy8gb3ZlcnJpZGVzIHdpbGwgb3ZlcnJpZGUgZGVwZW5kZW5jaWVzXG4gICAgICAgICAgICBtYXRjaGVkVmVyc2lvbjogb3ZlcnJpZGVzS2V5cy5pbmNsdWRlcyhrZXkpID8gb3ZlcnJpZGVzW2tleV0gOiByZW1vdGVzW2tleV1cbiAgICAgICAgfSk7XG4gICAgdmFyIF9tYW5pZmVzdF9tZXRhRGF0YTIgPSBtYW5pZmVzdC5tZXRhRGF0YSwgX21hbmlmZXN0X21ldGFEYXRhX3JlbW90ZUVudHJ5ID0gX21hbmlmZXN0X21ldGFEYXRhMi5yZW1vdGVFbnRyeSwgcmVtb3RlRW50cnlQYXRoID0gX21hbmlmZXN0X21ldGFEYXRhX3JlbW90ZUVudHJ5LnBhdGgsIHJlbW90ZUVudHJ5TmFtZSA9IF9tYW5pZmVzdF9tZXRhRGF0YV9yZW1vdGVFbnRyeS5uYW1lLCByZW1vdGVFbnRyeVR5cGUgPSBfbWFuaWZlc3RfbWV0YURhdGFfcmVtb3RlRW50cnkudHlwZSwgcmVtb3RlVHlwZXMgPSBfbWFuaWZlc3RfbWV0YURhdGEyLnR5cGVzLCBidWlsZFZlcnNpb24gPSBfbWFuaWZlc3RfbWV0YURhdGEyLmJ1aWxkSW5mby5idWlsZFZlcnNpb24sIGdsb2JhbE5hbWUgPSBfbWFuaWZlc3RfbWV0YURhdGEyLmdsb2JhbE5hbWUsIHNzclJlbW90ZUVudHJ5ID0gX21hbmlmZXN0X21ldGFEYXRhMi5zc3JSZW1vdGVFbnRyeTtcbiAgICB2YXIgZXhwb3NlcyA9IG1hbmlmZXN0LmV4cG9zZXM7XG4gICAgdmFyIGJhc2ljUmVtb3RlU25hcHNob3QgPSB7XG4gICAgICAgIHZlcnNpb246IHZlcnNpb24gPyB2ZXJzaW9uIDogJycsXG4gICAgICAgIGJ1aWxkVmVyc2lvbixcbiAgICAgICAgZ2xvYmFsTmFtZSxcbiAgICAgICAgcmVtb3RlRW50cnk6IHNpbXBsZUpvaW5SZW1vdGVFbnRyeShyZW1vdGVFbnRyeVBhdGgsIHJlbW90ZUVudHJ5TmFtZSksXG4gICAgICAgIHJlbW90ZUVudHJ5VHlwZSxcbiAgICAgICAgcmVtb3RlVHlwZXM6IHNpbXBsZUpvaW5SZW1vdGVFbnRyeShyZW1vdGVUeXBlcy5wYXRoLCByZW1vdGVUeXBlcy5uYW1lKSxcbiAgICAgICAgcmVtb3RlVHlwZXNaaXA6IHJlbW90ZVR5cGVzLnppcCB8fCAnJyxcbiAgICAgICAgcmVtb3RlVHlwZXNBUEk6IHJlbW90ZVR5cGVzLmFwaSB8fCAnJyxcbiAgICAgICAgcmVtb3Rlc0luZm8sXG4gICAgICAgIHNoYXJlZDogbWFuaWZlc3QgPT0gbnVsbCA/IHZvaWQgMCA6IG1hbmlmZXN0LnNoYXJlZC5tYXAoKGl0ZW0pPT4oe1xuICAgICAgICAgICAgICAgIGFzc2V0czogaXRlbS5hc3NldHMsXG4gICAgICAgICAgICAgICAgc2hhcmVkTmFtZTogaXRlbS5uYW1lLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IGl0ZW0udmVyc2lvblxuICAgICAgICAgICAgfSkpLFxuICAgICAgICBtb2R1bGVzOiBleHBvc2VzID09IG51bGwgPyB2b2lkIDAgOiBleHBvc2VzLm1hcCgoZXhwb3NlKT0+KHtcbiAgICAgICAgICAgICAgICBtb2R1bGVOYW1lOiBleHBvc2UubmFtZSxcbiAgICAgICAgICAgICAgICBtb2R1bGVQYXRoOiBleHBvc2UucGF0aCxcbiAgICAgICAgICAgICAgICBhc3NldHM6IGV4cG9zZS5hc3NldHNcbiAgICAgICAgICAgIH0pKVxuICAgIH07XG4gICAgaWYgKChfbWFuaWZlc3RfbWV0YURhdGEgPSBtYW5pZmVzdC5tZXRhRGF0YSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9tYW5pZmVzdF9tZXRhRGF0YS5wcmVmZXRjaEludGVyZmFjZSkge1xuICAgICAgICB2YXIgcHJlZmV0Y2hJbnRlcmZhY2UgPSBtYW5pZmVzdC5tZXRhRGF0YS5wcmVmZXRjaEludGVyZmFjZTtcbiAgICAgICAgYmFzaWNSZW1vdGVTbmFwc2hvdCA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgYmFzaWNSZW1vdGVTbmFwc2hvdCwge1xuICAgICAgICAgICAgcHJlZmV0Y2hJbnRlcmZhY2VcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmICgoX21hbmlmZXN0X21ldGFEYXRhMSA9IG1hbmlmZXN0Lm1ldGFEYXRhKSA9PSBudWxsID8gdm9pZCAwIDogX21hbmlmZXN0X21ldGFEYXRhMS5wcmVmZXRjaEVudHJ5KSB7XG4gICAgICAgIHZhciBfbWFuaWZlc3RfbWV0YURhdGFfcHJlZmV0Y2hFbnRyeSA9IG1hbmlmZXN0Lm1ldGFEYXRhLnByZWZldGNoRW50cnksIHBhdGggPSBfbWFuaWZlc3RfbWV0YURhdGFfcHJlZmV0Y2hFbnRyeS5wYXRoLCBuYW1lID0gX21hbmlmZXN0X21ldGFEYXRhX3ByZWZldGNoRW50cnkubmFtZSwgdHlwZSA9IF9tYW5pZmVzdF9tZXRhRGF0YV9wcmVmZXRjaEVudHJ5LnR5cGU7XG4gICAgICAgIGJhc2ljUmVtb3RlU25hcHNob3QgPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGJhc2ljUmVtb3RlU25hcHNob3QsIHtcbiAgICAgICAgICAgIHByZWZldGNoRW50cnk6IHNpbXBsZUpvaW5SZW1vdGVFbnRyeShwYXRoLCBuYW1lKSxcbiAgICAgICAgICAgIHByZWZldGNoRW50cnlUeXBlOiB0eXBlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoJ3B1YmxpY1BhdGgnIGluIG1hbmlmZXN0Lm1ldGFEYXRhKSB7XG4gICAgICAgIHJlbW90ZVNuYXBzaG90ID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBiYXNpY1JlbW90ZVNuYXBzaG90LCB7XG4gICAgICAgICAgICBwdWJsaWNQYXRoOiBnZXRQdWJsaWNQYXRoKClcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVtb3RlU25hcHNob3QgPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGJhc2ljUmVtb3RlU25hcHNob3QsIHtcbiAgICAgICAgICAgIGdldFB1YmxpY1BhdGg6IGdldFB1YmxpY1BhdGgoKVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHNzclJlbW90ZUVudHJ5KSB7XG4gICAgICAgIHZhciBmdWxsU1NSUmVtb3RlRW50cnkgPSBzaW1wbGVKb2luUmVtb3RlRW50cnkoc3NyUmVtb3RlRW50cnkucGF0aCwgc3NyUmVtb3RlRW50cnkubmFtZSk7XG4gICAgICAgIHJlbW90ZVNuYXBzaG90LnNzclJlbW90ZUVudHJ5ID0gZnVsbFNTUlJlbW90ZUVudHJ5O1xuICAgICAgICByZW1vdGVTbmFwc2hvdC5zc3JSZW1vdGVFbnRyeVR5cGUgPSBzc3JSZW1vdGVFbnRyeS50eXBlIHx8ICdjb21tb25qcy1tb2R1bGUnO1xuICAgIH1cbiAgICByZXR1cm4gcmVtb3RlU25hcHNob3Q7XG59XG5mdW5jdGlvbiBpc01hbmlmZXN0UHJvdmlkZXIobW9kdWxlSW5mbykge1xuICAgIGlmICgncmVtb3RlRW50cnknIGluIG1vZHVsZUluZm8gJiYgbW9kdWxlSW5mby5yZW1vdGVFbnRyeS5pbmNsdWRlcyhNQU5JRkVTVF9FWFQpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG52YXIgUFJFRklYID0gJ1sgTW9kdWxlIEZlZGVyYXRpb24gXSc7XG52YXIgTG9nZ2VyID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBMb2dnZXIxKHByZWZpeCkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIExvZ2dlcjEpO1xuICAgICAgICB0aGlzLnByZWZpeCA9IHByZWZpeDtcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKExvZ2dlcjEsIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvZ1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvZyguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcIndhcm5cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB3YXJuMSguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImVycm9yXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZXJyb3IxKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic3VjY2Vzc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN1Y2Nlc3MoLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbmZvXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5mbyguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlYWR5XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZHkoLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJkZWJ1Z1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlYnVnKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNEZWJ1Z01vZGUoKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBMb2dnZXIxO1xufSgpO1xuZnVuY3Rpb24gY3JlYXRlTG9nZ2VyKHByZWZpeCkge1xuICAgIHJldHVybiBuZXcgTG9nZ2VyKHByZWZpeCk7XG59XG52YXIgbG9nZ2VyID0gY3JlYXRlTG9nZ2VyKFBSRUZJWCk7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZnVuY3Rpb24gc2FmZVdyYXBwZXIoY2FsbGJhY2ssIGRpc2FibGVXYXJuKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgcmVzID0geWllbGQgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICFkaXNhYmxlV2FybiAmJiB3YXJuKGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSkoKTtcbn1cbmZ1bmN0aW9uIGlzU3RhdGljUmVzb3VyY2VzRXF1YWwodXJsMSwgdXJsMikge1xuICAgIHZhciBSRUdfRVhQID0gL14oaHR0cHM/Oik/XFwvXFwvL2k7XG4gICAgLy8gVHJhbnNmb3JtIHVybDEgYW5kIHVybDIgaW50byByZWxhdGl2ZSBwYXRoc1xuICAgIHZhciByZWxhdGl2ZVVybDEgPSB1cmwxLnJlcGxhY2UoUkVHX0VYUCwgJycpLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gICAgdmFyIHJlbGF0aXZlVXJsMiA9IHVybDIucmVwbGFjZShSRUdfRVhQLCAnJykucmVwbGFjZSgvXFwvJC8sICcnKTtcbiAgICAvLyBDaGVjayBpZiB0aGUgcmVsYXRpdmUgcGF0aHMgYXJlIGlkZW50aWNhbFxuICAgIHJldHVybiByZWxhdGl2ZVVybDEgPT09IHJlbGF0aXZlVXJsMjtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVNjcmlwdChpbmZvKSB7XG4gICAgLy8gUmV0cmlldmUgdGhlIGV4aXN0aW5nIHNjcmlwdCBlbGVtZW50IGJ5IGl0cyBzcmMgYXR0cmlidXRlXG4gICAgdmFyIHNjcmlwdCA9IG51bGw7XG4gICAgdmFyIG5lZWRBdHRhY2ggPSB0cnVlO1xuICAgIHZhciB0aW1lb3V0ID0gMjAwMDA7XG4gICAgdmFyIHRpbWVvdXRJZDtcbiAgICB2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgc2NyaXB0cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIHZhciBzID0gc2NyaXB0c1tpXTtcbiAgICAgICAgdmFyIHNjcmlwdFNyYyA9IHMuZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICAgICAgaWYgKHNjcmlwdFNyYyAmJiBpc1N0YXRpY1Jlc291cmNlc0VxdWFsKHNjcmlwdFNyYywgaW5mby51cmwpKSB7XG4gICAgICAgICAgICBzY3JpcHQgPSBzO1xuICAgICAgICAgICAgbmVlZEF0dGFjaCA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFzY3JpcHQpIHtcbiAgICAgICAgdmFyIGF0dHJzID0gaW5mby5hdHRycztcbiAgICAgICAgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICAgIHNjcmlwdC50eXBlID0gKGF0dHJzID09IG51bGwgPyB2b2lkIDAgOiBhdHRyc1sndHlwZSddKSA9PT0gJ21vZHVsZScgPyAnbW9kdWxlJyA6ICd0ZXh0L2phdmFzY3JpcHQnO1xuICAgICAgICB2YXIgY3JlYXRlU2NyaXB0UmVzID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoaW5mby5jcmVhdGVTY3JpcHRIb29rKSB7XG4gICAgICAgICAgICBjcmVhdGVTY3JpcHRSZXMgPSBpbmZvLmNyZWF0ZVNjcmlwdEhvb2soaW5mby51cmwsIGluZm8uYXR0cnMpO1xuICAgICAgICAgICAgaWYgKGNyZWF0ZVNjcmlwdFJlcyBpbnN0YW5jZW9mIEhUTUxTY3JpcHRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgc2NyaXB0ID0gY3JlYXRlU2NyaXB0UmVzO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY3JlYXRlU2NyaXB0UmVzID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIGlmICgnc2NyaXB0JyBpbiBjcmVhdGVTY3JpcHRSZXMgJiYgY3JlYXRlU2NyaXB0UmVzLnNjcmlwdCkge1xuICAgICAgICAgICAgICAgICAgICBzY3JpcHQgPSBjcmVhdGVTY3JpcHRSZXMuc2NyaXB0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJ3RpbWVvdXQnIGluIGNyZWF0ZVNjcmlwdFJlcyAmJiBjcmVhdGVTY3JpcHRSZXMudGltZW91dCkge1xuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0ID0gY3JlYXRlU2NyaXB0UmVzLnRpbWVvdXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghc2NyaXB0LnNyYykge1xuICAgICAgICAgICAgc2NyaXB0LnNyYyA9IGluZm8udXJsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhdHRycyAmJiAhY3JlYXRlU2NyaXB0UmVzKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhhdHRycykuZm9yRWFjaCgobmFtZSk9PntcbiAgICAgICAgICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAnYXN5bmMnIHx8IG5hbWUgPT09ICdkZWZlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdFtuYW1lXSA9IGF0dHJzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRyaWJ1dGVzIHRoYXQgZG8gbm90IGV4aXN0IGFyZSBjb25zaWRlcmVkIG92ZXJyaWRkZW5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghc2NyaXB0LmdldEF0dHJpYnV0ZShuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NyaXB0LnNldEF0dHJpYnV0ZShuYW1lLCBhdHRyc1tuYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgb25TY3JpcHRDb21wbGV0ZSA9IChwcmV2LCBldmVudCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgICAgIHZhciBvblNjcmlwdENvbXBsZXRlQ2FsbGJhY2sgPSAoKT0+e1xuICAgICAgICAgICAgICAgIGlmICgoZXZlbnQgPT0gbnVsbCA/IHZvaWQgMCA6IGV2ZW50LnR5cGUpID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgICAgICAgICAgIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLm9uRXJyb3JDYWxsYmFjaykgJiYgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8ub25FcnJvckNhbGxiYWNrKGV2ZW50KSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8uY2IpICYmIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLmNiKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvLyBQcmV2ZW50IG1lbW9yeSBsZWFrcyBpbiBJRS5cbiAgICAgICAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgICAgICAgICBzY3JpcHQub25lcnJvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgc2NyaXB0Lm9ubG9hZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgc2FmZVdyYXBwZXIoKCk9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9pbmZvX25lZWREZWxldGVTY3JpcHQgPSBpbmZvLm5lZWREZWxldGVTY3JpcHQsIG5lZWREZWxldGVTY3JpcHQgPSBfaW5mb19uZWVkRGVsZXRlU2NyaXB0ID09PSB2b2lkIDAgPyB0cnVlIDogX2luZm9fbmVlZERlbGV0ZVNjcmlwdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5lZWREZWxldGVTY3JpcHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIChzY3JpcHQgPT0gbnVsbCA/IHZvaWQgMCA6IHNjcmlwdC5wYXJlbnROb2RlKSAmJiBzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHByZXYgJiYgdHlwZW9mIHByZXYgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHByZXYoZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uU2NyaXB0Q29tcGxldGVDYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBvblNjcmlwdENvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvblNjcmlwdENvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICAgICAgfSkoKTtcbiAgICBzY3JpcHQub25lcnJvciA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25lcnJvcik7XG4gICAgc2NyaXB0Lm9ubG9hZCA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25sb2FkKTtcbiAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpPT57XG4gICAgICAgIG9uU2NyaXB0Q29tcGxldGUobnVsbCwgbmV3IEVycm9yKGBSZW1vdGUgc2NyaXB0IFwiJHtpbmZvLnVybH1cIiB0aW1lLW91dGVkLmApKTtcbiAgICB9LCB0aW1lb3V0KTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzY3JpcHQsXG4gICAgICAgIG5lZWRBdHRhY2hcbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlTGluayhpbmZvKSB7XG4gICAgLy8gPGxpbmsgcmVsPVwicHJlbG9hZFwiIGhyZWY9XCJzY3JpcHQuanNcIiBhcz1cInNjcmlwdFwiPlxuICAgIC8vIFJldHJpZXZlIHRoZSBleGlzdGluZyBzY3JpcHQgZWxlbWVudCBieSBpdHMgc3JjIGF0dHJpYnV0ZVxuICAgIHZhciBsaW5rID0gbnVsbDtcbiAgICB2YXIgbmVlZEF0dGFjaCA9IHRydWU7XG4gICAgdmFyIGxpbmtzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2xpbmsnKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgbCA9IGxpbmtzW2ldO1xuICAgICAgICB2YXIgbGlua0hyZWYgPSBsLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuICAgICAgICB2YXIgbGlua1JlbCA9IGwuZ2V0QXR0cmlidXRlKCdyZWwnKTtcbiAgICAgICAgaWYgKGxpbmtIcmVmICYmIGlzU3RhdGljUmVzb3VyY2VzRXF1YWwobGlua0hyZWYsIGluZm8udXJsKSAmJiBsaW5rUmVsID09PSBpbmZvLmF0dHJzWydyZWwnXSkge1xuICAgICAgICAgICAgbGluayA9IGw7XG4gICAgICAgICAgICBuZWVkQXR0YWNoID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWxpbmspIHtcbiAgICAgICAgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBpbmZvLnVybCk7XG4gICAgICAgIHZhciBjcmVhdGVMaW5rUmVzID0gdW5kZWZpbmVkO1xuICAgICAgICB2YXIgYXR0cnMgPSBpbmZvLmF0dHJzO1xuICAgICAgICBpZiAoaW5mby5jcmVhdGVMaW5rSG9vaykge1xuICAgICAgICAgICAgY3JlYXRlTGlua1JlcyA9IGluZm8uY3JlYXRlTGlua0hvb2soaW5mby51cmwsIGF0dHJzKTtcbiAgICAgICAgICAgIGlmIChjcmVhdGVMaW5rUmVzIGluc3RhbmNlb2YgSFRNTExpbmtFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgbGluayA9IGNyZWF0ZUxpbmtSZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGF0dHJzICYmICFjcmVhdGVMaW5rUmVzKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhhdHRycykuZm9yRWFjaCgobmFtZSk9PntcbiAgICAgICAgICAgICAgICBpZiAobGluayAmJiAhbGluay5nZXRBdHRyaWJ1dGUobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUobmFtZSwgYXR0cnNbbmFtZV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBvbkxpbmtDb21wbGV0ZSA9IChwcmV2LCBldmVudCk9PntcbiAgICAgICAgdmFyIG9uTGlua0NvbXBsZXRlQ2FsbGJhY2sgPSAoKT0+e1xuICAgICAgICAgICAgaWYgKChldmVudCA9PSBudWxsID8gdm9pZCAwIDogZXZlbnQudHlwZSkgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgICAgICAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5vbkVycm9yQ2FsbGJhY2spICYmIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLm9uRXJyb3JDYWxsYmFjayhldmVudCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5jYikgJiYgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8uY2IoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIFByZXZlbnQgbWVtb3J5IGxlYWtzIGluIElFLlxuICAgICAgICBpZiAobGluaykge1xuICAgICAgICAgICAgbGluay5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgIGxpbmsub25sb2FkID0gbnVsbDtcbiAgICAgICAgICAgIHNhZmVXcmFwcGVyKCgpPT57XG4gICAgICAgICAgICAgICAgdmFyIF9pbmZvX25lZWREZWxldGVMaW5rID0gaW5mby5uZWVkRGVsZXRlTGluaywgbmVlZERlbGV0ZUxpbmsgPSBfaW5mb19uZWVkRGVsZXRlTGluayA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9pbmZvX25lZWREZWxldGVMaW5rO1xuICAgICAgICAgICAgICAgIGlmIChuZWVkRGVsZXRlTGluaykge1xuICAgICAgICAgICAgICAgICAgICAobGluayA9PSBudWxsID8gdm9pZCAwIDogbGluay5wYXJlbnROb2RlKSAmJiBsaW5rLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGluayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocHJldikge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IHByZXYoZXZlbnQpO1xuICAgICAgICAgICAgICAgIG9uTGlua0NvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG9uTGlua0NvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICB9O1xuICAgIGxpbmsub25lcnJvciA9IG9uTGlua0NvbXBsZXRlLmJpbmQobnVsbCwgbGluay5vbmVycm9yKTtcbiAgICBsaW5rLm9ubG9hZCA9IG9uTGlua0NvbXBsZXRlLmJpbmQobnVsbCwgbGluay5vbmxvYWQpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGxpbmssXG4gICAgICAgIG5lZWRBdHRhY2hcbiAgICB9O1xufVxuZnVuY3Rpb24gbG9hZFNjcmlwdCh1cmwsIGluZm8pIHtcbiAgICB2YXIgX2luZm9fYXR0cnMgPSBpbmZvLmF0dHJzLCBhdHRycyA9IF9pbmZvX2F0dHJzID09PSB2b2lkIDAgPyB7fSA6IF9pbmZvX2F0dHJzLCBjcmVhdGVTY3JpcHRIb29rID0gaW5mby5jcmVhdGVTY3JpcHRIb29rO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+e1xuICAgICAgICB2YXIgX2NyZWF0ZVNjcmlwdCA9IGNyZWF0ZVNjcmlwdCh7XG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICBjYjogcmVzb2x2ZSxcbiAgICAgICAgICAgIG9uRXJyb3JDYWxsYmFjazogcmVqZWN0LFxuICAgICAgICAgICAgYXR0cnM6IHBvbHlmaWxscy5fZXh0ZW5kcyh7XG4gICAgICAgICAgICAgICAgZmV0Y2hwcmlvcml0eTogJ2hpZ2gnXG4gICAgICAgICAgICB9LCBhdHRycyksXG4gICAgICAgICAgICBjcmVhdGVTY3JpcHRIb29rLFxuICAgICAgICAgICAgbmVlZERlbGV0ZVNjcmlwdDogdHJ1ZVxuICAgICAgICB9KSwgc2NyaXB0ID0gX2NyZWF0ZVNjcmlwdC5zY3JpcHQsIG5lZWRBdHRhY2ggPSBfY3JlYXRlU2NyaXB0Lm5lZWRBdHRhY2g7XG4gICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gaW1wb3J0Tm9kZU1vZHVsZShuYW1lKSB7XG4gICAgaWYgKCFuYW1lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignaW1wb3J0IHNwZWNpZmllciBpcyByZXF1aXJlZCcpO1xuICAgIH1cbiAgICB2YXIgaW1wb3J0TW9kdWxlID0gbmV3IEZ1bmN0aW9uKCduYW1lJywgYHJldHVybiBpbXBvcnQobmFtZSlgKTtcbiAgICByZXR1cm4gaW1wb3J0TW9kdWxlKG5hbWUpLnRoZW4oKHJlcyk9PnJlcykuY2F0Y2goKGVycm9yMSk9PntcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgaW1wb3J0aW5nIG1vZHVsZSAke25hbWV9OmAsIGVycm9yMSk7XG4gICAgICAgIHRocm93IGVycm9yMTtcbiAgICB9KTtcbn1cbnZhciBsb2FkTm9kZUZldGNoID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHZhciBmZXRjaE1vZHVsZSA9IHlpZWxkIGltcG9ydE5vZGVNb2R1bGUoJ25vZGUtZmV0Y2gnKTtcbiAgICAgICAgcmV0dXJuIGZldGNoTW9kdWxlLmRlZmF1bHQgfHwgZmV0Y2hNb2R1bGU7XG4gICAgfSkoKTtcbnZhciBsYXp5TG9hZGVySG9va0ZldGNoID0gKGlucHV0LCBpbml0LCBsb2FkZXJIb29rKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgdmFyIGhvb2sgPSAodXJsLCBpbml0KT0+e1xuICAgICAgICAgICAgcmV0dXJuIGxvYWRlckhvb2subGlmZWN5Y2xlLmZldGNoLmVtaXQodXJsLCBpbml0KTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHJlcyA9IHlpZWxkIGhvb2soaW5wdXQsIGluaXQgfHwge30pO1xuICAgICAgICBpZiAoIXJlcyB8fCAhKHJlcyBpbnN0YW5jZW9mIFJlc3BvbnNlKSkge1xuICAgICAgICAgICAgdmFyIGZldGNoRnVuY3Rpb24gPSB0eXBlb2YgZmV0Y2ggPT09ICd1bmRlZmluZWQnID8geWllbGQgbG9hZE5vZGVGZXRjaCgpIDogZmV0Y2g7XG4gICAgICAgICAgICByZXR1cm4gZmV0Y2hGdW5jdGlvbihpbnB1dCwgaW5pdCB8fCB7fSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9KSgpO1xuZnVuY3Rpb24gY3JlYXRlU2NyaXB0Tm9kZSh1cmwsIGNiLCBhdHRycywgbG9hZGVySG9vaykge1xuICAgIGlmIChsb2FkZXJIb29rID09IG51bGwgPyB2b2lkIDAgOiBsb2FkZXJIb29rLmNyZWF0ZVNjcmlwdEhvb2spIHtcbiAgICAgICAgdmFyIGhvb2tSZXN1bHQgPSBsb2FkZXJIb29rLmNyZWF0ZVNjcmlwdEhvb2sodXJsKTtcbiAgICAgICAgaWYgKGhvb2tSZXN1bHQgJiYgdHlwZW9mIGhvb2tSZXN1bHQgPT09ICdvYmplY3QnICYmICd1cmwnIGluIGhvb2tSZXN1bHQpIHtcbiAgICAgICAgICAgIHVybCA9IGhvb2tSZXN1bHQudXJsO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciB1cmxPYmo7XG4gICAgdHJ5IHtcbiAgICAgICAgdXJsT2JqID0gbmV3IFVSTCh1cmwpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY29uc3RydWN0aW5nIFVSTDonLCBlKTtcbiAgICAgICAgY2IobmV3IEVycm9yKGBJbnZhbGlkIFVSTDogJHtlfWApKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgZ2V0RmV0Y2ggPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgIGlmIChsb2FkZXJIb29rID09IG51bGwgPyB2b2lkIDAgOiBsb2FkZXJIb29rLmZldGNoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChpbnB1dCwgaW5pdCk9PmxhenlMb2FkZXJIb29rRmV0Y2goaW5wdXQsIGluaXQsIGxvYWRlckhvb2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBmZXRjaCA9PT0gJ3VuZGVmaW5lZCcgPyBsb2FkTm9kZUZldGNoKCkgOiBmZXRjaDtcbiAgICAgICAgfSkoKTtcbiAgICB2YXIgaGFuZGxlU2NyaXB0RmV0Y2ggPSAoZiwgdXJsT2JqKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIF92bV9jb25zdGFudHM7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIGYodXJsT2JqLmhyZWYpO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0geWllbGQgcmVzLnRleHQoKTtcbiAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXygoeWllbGQgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgICAgICAgICBpbXBvcnROb2RlTW9kdWxlKCdwYXRoJyksXG4gICAgICAgICAgICAgICAgICAgIGltcG9ydE5vZGVNb2R1bGUoJ3ZtJylcbiAgICAgICAgICAgICAgICBdKSksIDIpLCBwYXRoID0gX3JlZlswXSwgdm0gPSBfcmVmWzFdO1xuICAgICAgICAgICAgICAgIHZhciBzY3JpcHRDb250ZXh0ID0ge1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRzOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBvcnRzOiB7fVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgdXJsRGlybmFtZSA9IHVybE9iai5wYXRobmFtZS5zcGxpdCgnLycpLnNsaWNlKDAsIC0xKS5qb2luKCcvJyk7XG4gICAgICAgICAgICAgICAgdmFyIGZpbGVuYW1lID0gcGF0aC5iYXNlbmFtZSh1cmxPYmoucGF0aG5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBfdm1fY29uc3RhbnRzX1VTRV9NQUlOX0NPTlRFWFRfREVGQVVMVF9MT0FERVI7XG4gICAgICAgICAgICAgICAgdmFyIHNjcmlwdCA9IG5ldyB2bS5TY3JpcHQoYChmdW5jdGlvbihleHBvcnRzLCBtb2R1bGUsIHJlcXVpcmUsIF9fZGlybmFtZSwgX19maWxlbmFtZSkgeyR7ZGF0YX1cXG59KWAsIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGltcG9ydE1vZHVsZUR5bmFtaWNhbGx5OiAoX3ZtX2NvbnN0YW50c19VU0VfTUFJTl9DT05URVhUX0RFRkFVTFRfTE9BREVSID0gKF92bV9jb25zdGFudHMgPSB2bS5jb25zdGFudHMpID09IG51bGwgPyB2b2lkIDAgOiBfdm1fY29uc3RhbnRzLlVTRV9NQUlOX0NPTlRFWFRfREVGQVVMVF9MT0FERVIpICE9IG51bGwgPyBfdm1fY29uc3RhbnRzX1VTRV9NQUlOX0NPTlRFWFRfREVGQVVMVF9MT0FERVIgOiBpbXBvcnROb2RlTW9kdWxlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgc2NyaXB0LnJ1bkluVGhpc0NvbnRleHQoKShzY3JpcHRDb250ZXh0LmV4cG9ydHMsIHNjcmlwdENvbnRleHQubW9kdWxlLCBldmFsKCdyZXF1aXJlJyksIHVybERpcm5hbWUsIGZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgZXhwb3J0ZWRJbnRlcmZhY2UgPSBzY3JpcHRDb250ZXh0Lm1vZHVsZS5leHBvcnRzIHx8IHNjcmlwdENvbnRleHQuZXhwb3J0cztcbiAgICAgICAgICAgICAgICBpZiAoYXR0cnMgJiYgZXhwb3J0ZWRJbnRlcmZhY2UgJiYgYXR0cnNbJ2dsb2JhbE5hbWUnXSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyID0gZXhwb3J0ZWRJbnRlcmZhY2VbYXR0cnNbJ2dsb2JhbE5hbWUnXV0gfHwgZXhwb3J0ZWRJbnRlcmZhY2U7XG4gICAgICAgICAgICAgICAgICAgIGNiKHVuZGVmaW5lZCwgY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYih1bmRlZmluZWQsIGV4cG9ydGVkSW50ZXJmYWNlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjYihlIGluc3RhbmNlb2YgRXJyb3IgPyBlIDogbmV3IEVycm9yKGBTY3JpcHQgZXhlY3V0aW9uIGVycm9yOiAke2V9YCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSgpO1xuICAgIGdldEZldGNoKCkudGhlbigoZik9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICBpZiAoKGF0dHJzID09IG51bGwgPyB2b2lkIDAgOiBhdHRyc1sndHlwZSddKSA9PT0gJ2VzbScgfHwgKGF0dHJzID09IG51bGwgPyB2b2lkIDAgOiBhdHRyc1sndHlwZSddKSA9PT0gJ21vZHVsZScpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZE1vZHVsZSh1cmxPYmouaHJlZiwge1xuICAgICAgICAgICAgICAgICAgICBmZXRjaDogZixcbiAgICAgICAgICAgICAgICAgICAgdm06IHlpZWxkIGltcG9ydE5vZGVNb2R1bGUoJ3ZtJylcbiAgICAgICAgICAgICAgICB9KS50aGVuKChtb2R1bGUpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgbW9kdWxlLmV2YWx1YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYih1bmRlZmluZWQsIG1vZHVsZS5uYW1lc3BhY2UpO1xuICAgICAgICAgICAgICAgICAgICB9KSgpKS5jYXRjaCgoZSk9PntcbiAgICAgICAgICAgICAgICAgICAgY2IoZSBpbnN0YW5jZW9mIEVycm9yID8gZSA6IG5ldyBFcnJvcihgU2NyaXB0IGV4ZWN1dGlvbiBlcnJvcjogJHtlfWApKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhhbmRsZVNjcmlwdEZldGNoKGYsIHVybE9iaik7XG4gICAgICAgIH0pKCkpLmNhdGNoKChlcnIpPT57XG4gICAgICAgIGNiKGVycik7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBsb2FkU2NyaXB0Tm9kZSh1cmwsIGluZm8pIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCk9PntcbiAgICAgICAgY3JlYXRlU2NyaXB0Tm9kZSh1cmwsIChlcnJvcjEsIHNjcmlwdENvbnRleHQpPT57XG4gICAgICAgICAgICBpZiAoZXJyb3IxKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yMSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBfaW5mb19hdHRycywgX2luZm9fYXR0cnMxO1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVFbnRyeUtleSA9IChpbmZvID09IG51bGwgPyB2b2lkIDAgOiAoX2luZm9fYXR0cnMgPSBpbmZvLmF0dHJzKSA9PSBudWxsID8gdm9pZCAwIDogX2luZm9fYXR0cnNbJ2dsb2JhbE5hbWUnXSkgfHwgYF9fRkVERVJBVElPTl8ke2luZm8gPT0gbnVsbCA/IHZvaWQgMCA6IChfaW5mb19hdHRyczEgPSBpbmZvLmF0dHJzKSA9PSBudWxsID8gdm9pZCAwIDogX2luZm9fYXR0cnMxWyduYW1lJ119OmN1c3RvbV9fYDtcbiAgICAgICAgICAgICAgICB2YXIgZW50cnlFeHBvcnRzID0gZ2xvYmFsVGhpc1tyZW1vdGVFbnRyeUtleV0gPSBzY3JpcHRDb250ZXh0O1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZW50cnlFeHBvcnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgaW5mby5hdHRycywgaW5mby5sb2FkZXJIb29rKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGxvYWRNb2R1bGUodXJsLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHZhciBmZXRjaDEgPSBvcHRpb25zLmZldGNoLCB2bSA9IG9wdGlvbnMudm07XG4gICAgICAgIHZhciByZXNwb25zZSA9IHlpZWxkIGZldGNoMSh1cmwpO1xuICAgICAgICB2YXIgY29kZSA9IHlpZWxkIHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgdmFyIG1vZHVsZSA9IG5ldyB2bS5Tb3VyY2VUZXh0TW9kdWxlKGNvZGUsIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGltcG9ydE1vZHVsZUR5bmFtaWNhbGx5OiAoc3BlY2lmaWVyLCBzY3JpcHQpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzb2x2ZWRVcmwgPSBuZXcgVVJMKHNwZWNpZmllciwgdXJsKS5ocmVmO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9hZE1vZHVsZShyZXNvbHZlZFVybCwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSkoKVxuICAgICAgICB9KTtcbiAgICAgICAgeWllbGQgbW9kdWxlLmxpbmsoKHNwZWNpZmllcik9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc29sdmVkVXJsID0gbmV3IFVSTChzcGVjaWZpZXIsIHVybCkuaHJlZjtcbiAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0geWllbGQgbG9hZE1vZHVsZShyZXNvbHZlZFVybCwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICAgICAgICAgIH0pKCkpO1xuICAgICAgICByZXR1cm4gbW9kdWxlO1xuICAgIH0pKCk7XG59XG5mdW5jdGlvbiBub3JtYWxpemVPcHRpb25zKGVuYWJsZURlZmF1bHQsIGRlZmF1bHRPcHRpb25zLCBrZXkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBpZiAoZW5hYmxlRGVmYXVsdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0T3B0aW9ucztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zID09PSB0cnVlKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIHR5cGUgZm9yIFxcYCR7a2V5fVxcYCwgZXhwZWN0IGJvb2xlYW4vdW5kZWZpbmVkL29iamVjdCwgZ290OiAke3R5cGVvZiBvcHRpb25zfWApO1xuICAgIH07XG59XG5leHBvcnRzLkJST1dTRVJfTE9HX0tFWSA9IEJST1dTRVJfTE9HX0tFWTtcbmV4cG9ydHMuQlJPV1NFUl9MT0dfVkFMVUUgPSBCUk9XU0VSX0xPR19WQUxVRTtcbmV4cG9ydHMuRU5DT0RFX05BTUVfUFJFRklYID0gRU5DT0RFX05BTUVfUFJFRklYO1xuZXhwb3J0cy5FbmNvZGVkTmFtZVRyYW5zZm9ybU1hcCA9IEVuY29kZWROYW1lVHJhbnNmb3JtTWFwO1xuZXhwb3J0cy5GZWRlcmF0aW9uTW9kdWxlTWFuaWZlc3QgPSBGZWRlcmF0aW9uTW9kdWxlTWFuaWZlc3Q7XG5leHBvcnRzLk1BTklGRVNUX0VYVCA9IE1BTklGRVNUX0VYVDtcbmV4cG9ydHMuTUZNb2R1bGVUeXBlID0gTUZNb2R1bGVUeXBlO1xuZXhwb3J0cy5NRlByZWZldGNoQ29tbW9uID0gTUZQcmVmZXRjaENvbW1vbjtcbmV4cG9ydHMuTU9EVUxFX0RFVlRPT0xfSURFTlRJRklFUiA9IE1PRFVMRV9ERVZUT09MX0lERU5USUZJRVI7XG5leHBvcnRzLk1hbmlmZXN0RmlsZU5hbWUgPSBNYW5pZmVzdEZpbGVOYW1lO1xuZXhwb3J0cy5OYW1lVHJhbnNmb3JtTWFwID0gTmFtZVRyYW5zZm9ybU1hcDtcbmV4cG9ydHMuTmFtZVRyYW5zZm9ybVN5bWJvbCA9IE5hbWVUcmFuc2Zvcm1TeW1ib2w7XG5leHBvcnRzLlNFUEFSQVRPUiA9IFNFUEFSQVRPUjtcbmV4cG9ydHMuU3RhdHNGaWxlTmFtZSA9IFN0YXRzRmlsZU5hbWU7XG5leHBvcnRzLlRFTVBfRElSID0gVEVNUF9ESVI7XG5leHBvcnRzLmFzc2VydCA9IGFzc2VydDtcbmV4cG9ydHMuY29tcG9zZUtleVdpdGhTZXBhcmF0b3IgPSBjb21wb3NlS2V5V2l0aFNlcGFyYXRvcjtcbmV4cG9ydHMuY29udGFpbmVyUGx1Z2luID0gQ29udGFpbmVyUGx1Z2luO1xuZXhwb3J0cy5jb250YWluZXJSZWZlcmVuY2VQbHVnaW4gPSBDb250YWluZXJSZWZlcmVuY2VQbHVnaW47XG5leHBvcnRzLmNyZWF0ZUxpbmsgPSBjcmVhdGVMaW5rO1xuZXhwb3J0cy5jcmVhdGVMb2dnZXIgPSBjcmVhdGVMb2dnZXI7XG5leHBvcnRzLmNyZWF0ZVNjcmlwdCA9IGNyZWF0ZVNjcmlwdDtcbmV4cG9ydHMuY3JlYXRlU2NyaXB0Tm9kZSA9IGNyZWF0ZVNjcmlwdE5vZGU7XG5leHBvcnRzLmRlY29kZU5hbWUgPSBkZWNvZGVOYW1lO1xuZXhwb3J0cy5lbmNvZGVOYW1lID0gZW5jb2RlTmFtZTtcbmV4cG9ydHMuZXJyb3IgPSBlcnJvcjtcbmV4cG9ydHMuZ2VuZXJhdGVFeHBvc2VGaWxlbmFtZSA9IGdlbmVyYXRlRXhwb3NlRmlsZW5hbWU7XG5leHBvcnRzLmdlbmVyYXRlU2hhcmVGaWxlbmFtZSA9IGdlbmVyYXRlU2hhcmVGaWxlbmFtZTtcbmV4cG9ydHMuZ2VuZXJhdGVTbmFwc2hvdEZyb21NYW5pZmVzdCA9IGdlbmVyYXRlU25hcHNob3RGcm9tTWFuaWZlc3Q7XG5leHBvcnRzLmdldFByb2Nlc3NFbnYgPSBnZXRQcm9jZXNzRW52O1xuZXhwb3J0cy5nZXRSZXNvdXJjZVVybCA9IGdldFJlc291cmNlVXJsO1xuZXhwb3J0cy5pbmZlckF1dG9QdWJsaWNQYXRoID0gaW5mZXJBdXRvUHVibGljUGF0aDtcbmV4cG9ydHMuaXNCcm93c2VyRW52ID0gaXNCcm93c2VyRW52O1xuZXhwb3J0cy5pc0RlYnVnTW9kZSA9IGlzRGVidWdNb2RlO1xuZXhwb3J0cy5pc01hbmlmZXN0UHJvdmlkZXIgPSBpc01hbmlmZXN0UHJvdmlkZXI7XG5leHBvcnRzLmlzUmVxdWlyZWRWZXJzaW9uID0gaXNSZXF1aXJlZFZlcnNpb247XG5leHBvcnRzLmlzU3RhdGljUmVzb3VyY2VzRXF1YWwgPSBpc1N0YXRpY1Jlc291cmNlc0VxdWFsO1xuZXhwb3J0cy5sb2FkU2NyaXB0ID0gbG9hZFNjcmlwdDtcbmV4cG9ydHMubG9hZFNjcmlwdE5vZGUgPSBsb2FkU2NyaXB0Tm9kZTtcbmV4cG9ydHMubG9nZ2VyID0gbG9nZ2VyO1xuZXhwb3J0cy5tb2R1bGVGZWRlcmF0aW9uUGx1Z2luID0gTW9kdWxlRmVkZXJhdGlvblBsdWdpbjtcbmV4cG9ydHMubm9ybWFsaXplT3B0aW9ucyA9IG5vcm1hbGl6ZU9wdGlvbnM7XG5leHBvcnRzLnBhcnNlRW50cnkgPSBwYXJzZUVudHJ5O1xuZXhwb3J0cy5zYWZlVG9TdHJpbmcgPSBzYWZlVG9TdHJpbmc7XG5leHBvcnRzLnNhZmVXcmFwcGVyID0gc2FmZVdyYXBwZXI7XG5leHBvcnRzLnNoYXJlUGx1Z2luID0gU2hhcmVQbHVnaW47XG5leHBvcnRzLnNpbXBsZUpvaW5SZW1vdGVFbnRyeSA9IHNpbXBsZUpvaW5SZW1vdGVFbnRyeTtcbmV4cG9ydHMud2FybiA9IHdhcm47XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9zZGsvZGlzdC9wb2x5ZmlsbHMuY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vc2RrL2Rpc3QvcG9seWZpbGxzLmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfZXh0ZW5kcygpIHtcbiAgICBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gYXNzaWduKHRhcmdldCkge1xuICAgICAgICBmb3IodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBmb3IodmFyIGtleSBpbiBzb3VyY2UpaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9O1xuICAgIHJldHVybiBfZXh0ZW5kcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZXhwb3J0cy5fZXh0ZW5kcyA9IF9leHRlbmRzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9jb25zdGFudC5janMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9jb25zdGFudC5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBGRURFUkFUSU9OX1NVUFBPUlRFRF9UWVBFUyA9IFtcbiAgICAnc2NyaXB0J1xuXTtcbmV4cG9ydHMuRkVERVJBVElPTl9TVVBQT1JURURfVFlQRVMgPSBGRURFUkFUSU9OX1NVUFBPUlRFRF9UWVBFUztcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG52YXIgX29iamVjdF9zcHJlYWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fb2JqZWN0X3NwcmVhZCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX29iamVjdF9zcHJlYWQuY2pzXCIpO1xudmFyIHJ1bnRpbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzXCIpO1xudmFyIGNvbnN0YW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9jb25zdGFudC5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9jb25zdGFudC5janMuanNcIik7XG5mdW5jdGlvbiBfaW50ZXJvcE5hbWVzcGFjZURlZmF1bHQoZSkge1xuICAgIHZhciBuID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICBpZiAoZSkge1xuICAgICAgICBPYmplY3Qua2V5cyhlKS5mb3JFYWNoKGZ1bmN0aW9uKGspIHtcbiAgICAgICAgICAgIGlmIChrICE9PSAnZGVmYXVsdCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgayk7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sIGssIGQuZ2V0ID8gZCA6IHtcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlW2tdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBuLmRlZmF1bHQgPSBlO1xuICAgIHJldHVybiBPYmplY3QuZnJlZXplKG4pO1xufVxudmFyIHJ1bnRpbWVfX25hbWVzcGFjZSA9IC8qI19fUFVSRV9fKi8gX2ludGVyb3BOYW1lc3BhY2VEZWZhdWx0KHJ1bnRpbWUpO1xuZnVuY3Rpb24gYXR0YWNoU2hhcmVTY29wZU1hcCh3ZWJwYWNrUmVxdWlyZSkge1xuICAgIGlmICghd2VicGFja1JlcXVpcmUuUyB8fCB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmhhc0F0dGFjaFNoYXJlU2NvcGVNYXAgfHwgIXdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2UgfHwgIXdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2Uuc2hhcmVTY29wZU1hcCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHdlYnBhY2tSZXF1aXJlLlMgPSB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlLnNoYXJlU2NvcGVNYXA7XG4gICAgd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5oYXNBdHRhY2hTaGFyZVNjb3BlTWFwID0gdHJ1ZTtcbn1cbnZhciBOYW1lVHJhbnNmb3JtU3ltYm9sID0ge1xuICAgIEFUOiAnQCcsXG4gICAgSFlQSEVOOiAnLScsXG4gICAgU0xBU0g6ICcvJ1xufTtcbnZhciBOYW1lVHJhbnNmb3JtTWFwID0ge1xuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXTogJ3Njb3BlXycsXG4gICAgW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXTogJ18nLFxuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXTogJ19fJ1xufTtcbnZhciBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcCA9IHtcbiAgICBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXV06IE5hbWVUcmFuc2Zvcm1TeW1ib2wuQVQsXG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dXTogTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU4sXG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF1dOiBOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXG59O1xudmFyIEVOQ09ERV9OQU1FX1BSRUZJWCA9ICdFTkNPREVfTkFNRV9QUkVGSVgnO1xudmFyIGRlY29kZU5hbWUgPSBmdW5jdGlvbihuYW1lLCBwcmVmaXgsIHdpdGhFeHQpIHtcbiAgICB0cnkge1xuICAgICAgICB2YXIgZGVjb2RlZE5hbWUgPSBuYW1lO1xuICAgICAgICBpZiAocHJlZml4KSB7XG4gICAgICAgICAgICBpZiAoIWRlY29kZWROYW1lLnN0YXJ0c1dpdGgocHJlZml4KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWNvZGVkTmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlY29kZWROYW1lID0gZGVjb2RlZE5hbWUucmVwbGFjZShuZXcgUmVnRXhwKHByZWZpeCwgJ2cnKSwgJycpO1xuICAgICAgICB9XG4gICAgICAgIGRlY29kZWROYW1lID0gZGVjb2RlZE5hbWUucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXV0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdfWAsICdnJyksIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF1dKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl1dKTtcbiAgICAgICAgaWYgKHdpdGhFeHQpIDtcbiAgICAgICAgcmV0dXJuIGRlY29kZWROYW1lO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgfVxufTtcbmZ1bmN0aW9uIHJlbW90ZXMob3B0aW9ucykge1xuICAgIHZhciBjaHVua0lkID0gb3B0aW9ucy5jaHVua0lkLCBwcm9taXNlcyA9IG9wdGlvbnMucHJvbWlzZXMsIGNodW5rTWFwcGluZyA9IG9wdGlvbnMuY2h1bmtNYXBwaW5nLCBpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZyA9IG9wdGlvbnMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsIHdlYnBhY2tSZXF1aXJlID0gb3B0aW9ucy53ZWJwYWNrUmVxdWlyZSwgaWRUb1JlbW90ZU1hcCA9IG9wdGlvbnMuaWRUb1JlbW90ZU1hcDtcbiAgICBhdHRhY2hTaGFyZVNjb3BlTWFwKHdlYnBhY2tSZXF1aXJlKTtcbiAgICBpZiAod2VicGFja1JlcXVpcmUubyhjaHVua01hcHBpbmcsIGNodW5rSWQpKSB7XG4gICAgICAgIGNodW5rTWFwcGluZ1tjaHVua0lkXS5mb3JFYWNoKChpZCk9PntcbiAgICAgICAgICAgIHZhciBnZXRTY29wZSA9IHdlYnBhY2tSZXF1aXJlLlI7XG4gICAgICAgICAgICBpZiAoIWdldFNjb3BlKSB7XG4gICAgICAgICAgICAgICAgZ2V0U2NvcGUgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkYXRhID0gaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdbaWRdO1xuICAgICAgICAgICAgdmFyIHJlbW90ZUluZm9zID0gaWRUb1JlbW90ZU1hcFtpZF07XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIHNlZW1zIG5vdCB3b3JrXG4gICAgICAgICAgICBpZiAoZ2V0U2NvcGUuaW5kZXhPZihkYXRhKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSBzZWVtcyBub3Qgd29ya1xuICAgICAgICAgICAgZ2V0U2NvcGUucHVzaChkYXRhKTtcbiAgICAgICAgICAgIGlmIChkYXRhLnApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZXMucHVzaChkYXRhLnApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9uRXJyb3IgPSAoZXJyb3IpPT57XG4gICAgICAgICAgICAgICAgaWYgKCFlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBlcnJvciA9IG5ldyBFcnJvcignQ29udGFpbmVyIG1pc3NpbmcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnJvci5tZXNzYWdlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBlcnJvci5tZXNzYWdlICs9IGBcXG53aGlsZSBsb2FkaW5nIFwiJHtkYXRhWzFdfVwiIGZyb20gJHtkYXRhWzJdfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlLm1baWRdID0gKCk9PntcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkYXRhLnAgPSAwO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBoYW5kbGVGdW5jdGlvbiA9IChmbiwgYXJnMSwgYXJnMiwgZCwgbmV4dCwgZmlyc3QpPT57XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSBmbihhcmcxLCBhcmcyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb21pc2UgJiYgcHJvbWlzZS50aGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IHByb21pc2UudGhlbigocmVzdWx0KT0+bmV4dChyZXN1bHQsIGQpLCBvbkVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goZGF0YS5wID0gcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQocHJvbWlzZSwgZCwgZmlyc3QpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBvbkV4dGVybmFsID0gKGV4dGVybmFsLCBfLCBmaXJzdCk9PmV4dGVybmFsID8gaGFuZGxlRnVuY3Rpb24od2VicGFja1JlcXVpcmUuSSwgZGF0YVswXSwgMCwgZXh0ZXJuYWwsIG9uSW5pdGlhbGl6ZWQsIGZpcnN0KSA6IG9uRXJyb3IoKTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgICAgICAgICAgIHZhciBvbkluaXRpYWxpemVkID0gKF8sIGV4dGVybmFsLCBmaXJzdCk9PmhhbmRsZUZ1bmN0aW9uKGV4dGVybmFsLmdldCwgZGF0YVsxXSwgZ2V0U2NvcGUsIDAsIG9uRmFjdG9yeSwgZmlyc3QpO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXZhclxuICAgICAgICAgICAgdmFyIG9uRmFjdG9yeSA9IChmYWN0b3J5KT0+e1xuICAgICAgICAgICAgICAgIGRhdGEucCA9IDE7XG4gICAgICAgICAgICAgICAgd2VicGFja1JlcXVpcmUubVtpZF0gPSAobW9kdWxlMSk9PntcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlMS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIG9uUmVtb3RlTG9hZGVkID0gKCk9PntcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlTmFtZSA9IGRlY29kZU5hbWUocmVtb3RlSW5mb3NbMF0ubmFtZSwgRU5DT0RFX05BTUVfUFJFRklYKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZU1vZHVsZU5hbWUgPSByZW1vdGVOYW1lICsgZGF0YVsxXS5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRSZW1vdGUgPSAoKT0+d2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZS5sb2FkUmVtb3RlKHJlbW90ZU1vZHVsZU5hbWUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkRmFjdG9yeTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ2J1aWxkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5vcHRpb25zLnNoYXJlU3RyYXRlZ3kgPT09ICd2ZXJzaW9uLWZpcnN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGluc3RhbmNlLnNoYXJlZEhhbmRsZXIuaW5pdGlhbGl6ZVNoYXJpbmcoZGF0YVswXSkpLnRoZW4oKCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9hZFJlbW90ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRSZW1vdGUoKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHVzZVJ1bnRpbWVMb2FkID0gcmVtb3RlSW5mb3MubGVuZ3RoID09PSAxICYmIGNvbnN0YW50LkZFREVSQVRJT05fU1VQUE9SVEVEX1RZUEVTLmluY2x1ZGVzKHJlbW90ZUluZm9zWzBdLmV4dGVybmFsVHlwZSkgJiYgcmVtb3RlSW5mb3NbMF0ubmFtZTtcbiAgICAgICAgICAgIGlmICh1c2VSdW50aW1lTG9hZCkge1xuICAgICAgICAgICAgICAgIGhhbmRsZUZ1bmN0aW9uKG9uUmVtb3RlTG9hZGVkLCBkYXRhWzJdLCAwLCAwLCBvbkZhY3RvcnksIDEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVGdW5jdGlvbih3ZWJwYWNrUmVxdWlyZSwgZGF0YVsyXSwgMCwgMCwgb25FeHRlcm5hbCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNvbnN1bWVzKG9wdGlvbnMpIHtcbiAgICB2YXIgY2h1bmtJZCA9IG9wdGlvbnMuY2h1bmtJZCwgcHJvbWlzZXMgPSBvcHRpb25zLnByb21pc2VzLCBjaHVua01hcHBpbmcgPSBvcHRpb25zLmNodW5rTWFwcGluZywgaW5zdGFsbGVkTW9kdWxlcyA9IG9wdGlvbnMuaW5zdGFsbGVkTW9kdWxlcywgbW9kdWxlVG9IYW5kbGVyTWFwcGluZyA9IG9wdGlvbnMubW9kdWxlVG9IYW5kbGVyTWFwcGluZywgd2VicGFja1JlcXVpcmUgPSBvcHRpb25zLndlYnBhY2tSZXF1aXJlO1xuICAgIGF0dGFjaFNoYXJlU2NvcGVNYXAod2VicGFja1JlcXVpcmUpO1xuICAgIGlmICh3ZWJwYWNrUmVxdWlyZS5vKGNodW5rTWFwcGluZywgY2h1bmtJZCkpIHtcbiAgICAgICAgY2h1bmtNYXBwaW5nW2NodW5rSWRdLmZvckVhY2goKGlkKT0+e1xuICAgICAgICAgICAgaWYgKHdlYnBhY2tSZXF1aXJlLm8oaW5zdGFsbGVkTW9kdWxlcywgaWQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzLnB1c2goaW5zdGFsbGVkTW9kdWxlc1tpZF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9uRmFjdG9yeSA9IChmYWN0b3J5KT0+e1xuICAgICAgICAgICAgICAgIGluc3RhbGxlZE1vZHVsZXNbaWRdID0gMDtcbiAgICAgICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZS5tW2lkXSA9IChtb2R1bGUxKT0+e1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2VicGFja1JlcXVpcmUuY1tpZF07XG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZTEuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBvbkVycm9yID0gKGVycm9yKT0+e1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBpbnN0YWxsZWRNb2R1bGVzW2lkXTtcbiAgICAgICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZS5tW2lkXSA9IChtb2R1bGUxKT0+e1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2VicGFja1JlcXVpcmUuY1tpZF07XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgZmVkZXJhdGlvbkluc3RhbmNlID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZTtcbiAgICAgICAgICAgICAgICBpZiAoIWZlZGVyYXRpb25JbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZlZGVyYXRpb24gaW5zdGFuY2Ugbm90IGZvdW5kIScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfaWQgPSBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nW2lkXSwgc2hhcmVLZXkgPSBfbW9kdWxlVG9IYW5kbGVyTWFwcGluZ19pZC5zaGFyZUtleSwgZ2V0dGVyID0gX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfaWQuZ2V0dGVyLCBzaGFyZUluZm8gPSBfbW9kdWxlVG9IYW5kbGVyTWFwcGluZ19pZC5zaGFyZUluZm87XG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSBmZWRlcmF0aW9uSW5zdGFuY2UubG9hZFNoYXJlKHNoYXJlS2V5LCB7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbVNoYXJlSW5mbzogc2hhcmVJbmZvXG4gICAgICAgICAgICAgICAgfSkudGhlbigoZmFjdG9yeSk9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZhY3RvcnkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0dGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHByb21pc2UudGhlbikge1xuICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGluc3RhbGxlZE1vZHVsZXNbaWRdID0gcHJvbWlzZS50aGVuKG9uRmFjdG9yeSkuY2F0Y2gob25FcnJvcikpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgbWFpbnRhaW4gcHJldmlvdXMgbG9naWNcbiAgICAgICAgICAgICAgICAgICAgb25GYWN0b3J5KHByb21pc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBpbml0aWFsaXplU2hhcmluZyhyZWYpIHtcbiAgICB2YXIgc2hhcmVTY29wZU5hbWUgPSByZWYuc2hhcmVTY29wZU5hbWUsIHdlYnBhY2tSZXF1aXJlID0gcmVmLndlYnBhY2tSZXF1aXJlLCBpbml0UHJvbWlzZXMgPSByZWYuaW5pdFByb21pc2VzLCBpbml0VG9rZW5zID0gcmVmLmluaXRUb2tlbnMsIGluaXRTY29wZSA9IHJlZi5pbml0U2NvcGU7XG4gICAgaWYgKCFpbml0U2NvcGUpIGluaXRTY29wZSA9IFtdO1xuICAgIHZhciBtZkluc3RhbmNlID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZTtcbiAgICAvLyBoYW5kbGluZyBjaXJjdWxhciBpbml0IGNhbGxzXG4gICAgdmFyIGluaXRUb2tlbiA9IGluaXRUb2tlbnNbc2hhcmVTY29wZU5hbWVdO1xuICAgIGlmICghaW5pdFRva2VuKSBpbml0VG9rZW4gPSBpbml0VG9rZW5zW3NoYXJlU2NvcGVOYW1lXSA9IHtcbiAgICAgICAgZnJvbTogbWZJbnN0YW5jZS5uYW1lXG4gICAgfTtcbiAgICBpZiAoaW5pdFNjb3BlLmluZGV4T2YoaW5pdFRva2VuKSA+PSAwKSByZXR1cm47XG4gICAgaW5pdFNjb3BlLnB1c2goaW5pdFRva2VuKTtcbiAgICB2YXIgcHJvbWlzZSA9IGluaXRQcm9taXNlc1tzaGFyZVNjb3BlTmFtZV07XG4gICAgaWYgKHByb21pc2UpIHJldHVybiBwcm9taXNlO1xuICAgIHZhciB3YXJuID0gKG1zZyk9PnR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLndhcm4gJiYgY29uc29sZS53YXJuKG1zZyk7XG4gICAgdmFyIGluaXRFeHRlcm5hbCA9IChpZCk9PntcbiAgICAgICAgdmFyIGhhbmRsZUVycm9yID0gKGVycik9Pndhcm4oJ0luaXRpYWxpemF0aW9uIG9mIHNoYXJpbmcgZXh0ZXJuYWwgZmFpbGVkOiAnICsgZXJyKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBfJG1vZHVsZSA9IHdlYnBhY2tSZXF1aXJlKGlkKTtcbiAgICAgICAgICAgIGlmICghXyRtb2R1bGUpIHJldHVybjtcbiAgICAgICAgICAgIHZhciBpbml0Rm4gPSAobW9kdWxlMSk9Pm1vZHVsZTEgJiYgbW9kdWxlMS5pbml0ICYmIC8vIEB0cy1pZ25vcmUgY29tcGF0IGxlZ2FjeSBtZiBzaGFyZWQgYmVoYXZpb3JcbiAgICAgICAgICAgICAgICBtb2R1bGUxLmluaXQod2VicGFja1JlcXVpcmUuU1tzaGFyZVNjb3BlTmFtZV0sIGluaXRTY29wZSk7XG4gICAgICAgICAgICBpZiAoXyRtb2R1bGUudGhlbikgcmV0dXJuIHByb21pc2VzLnB1c2goXyRtb2R1bGUudGhlbihpbml0Rm4sIGhhbmRsZUVycm9yKSk7XG4gICAgICAgICAgICB2YXIgaW5pdFJlc3VsdCA9IGluaXRGbihfJG1vZHVsZSk7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBpZiAoaW5pdFJlc3VsdCAmJiB0eXBlb2YgaW5pdFJlc3VsdCAhPT0gJ2Jvb2xlYW4nICYmIGluaXRSZXN1bHQudGhlbikgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzLnB1c2goaW5pdFJlc3VsdFsnY2F0Y2gnXShoYW5kbGVFcnJvcikpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGhhbmRsZUVycm9yKGVycik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBwcm9taXNlcyA9IG1mSW5zdGFuY2UuaW5pdGlhbGl6ZVNoYXJpbmcoc2hhcmVTY29wZU5hbWUsIHtcbiAgICAgICAgc3RyYXRlZ3k6IG1mSW5zdGFuY2Uub3B0aW9ucy5zaGFyZVN0cmF0ZWd5LFxuICAgICAgICBpbml0U2NvcGUsXG4gICAgICAgIGZyb206ICdidWlsZCdcbiAgICB9KTtcbiAgICBhdHRhY2hTaGFyZVNjb3BlTWFwKHdlYnBhY2tSZXF1aXJlKTtcbiAgICB2YXIgYnVuZGxlclJ1bnRpbWVSZW1vdGVzT3B0aW9ucyA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXM7XG4gICAgaWYgKGJ1bmRsZXJSdW50aW1lUmVtb3Rlc09wdGlvbnMpIHtcbiAgICAgICAgT2JqZWN0LmtleXMoYnVuZGxlclJ1bnRpbWVSZW1vdGVzT3B0aW9ucy5pZFRvUmVtb3RlTWFwKS5mb3JFYWNoKChtb2R1bGVJZCk9PntcbiAgICAgICAgICAgIHZhciBpbmZvID0gYnVuZGxlclJ1bnRpbWVSZW1vdGVzT3B0aW9ucy5pZFRvUmVtb3RlTWFwW21vZHVsZUlkXTtcbiAgICAgICAgICAgIHZhciBleHRlcm5hbE1vZHVsZUlkID0gYnVuZGxlclJ1bnRpbWVSZW1vdGVzT3B0aW9ucy5pZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1ttb2R1bGVJZF1bMl07XG4gICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgaW5pdEV4dGVybmFsKGV4dGVybmFsTW9kdWxlSWQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gaW5mb1swXTtcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnN0YW50LkZFREVSQVRJT05fU1VQUE9SVEVEX1RZUEVTLmluY2x1ZGVzKHJlbW90ZUluZm8uZXh0ZXJuYWxUeXBlKSkge1xuICAgICAgICAgICAgICAgICAgICBpbml0RXh0ZXJuYWwoZXh0ZXJuYWxNb2R1bGVJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFwcm9taXNlcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGluaXRQcm9taXNlc1tzaGFyZVNjb3BlTmFtZV0gPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gaW5pdFByb21pc2VzW3NoYXJlU2NvcGVOYW1lXSA9IFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKCgpPT5pbml0UHJvbWlzZXNbc2hhcmVTY29wZU5hbWVdID0gdHJ1ZSk7XG59XG5mdW5jdGlvbiBoYW5kbGVJbml0aWFsQ29uc3VtZXMob3B0aW9ucykge1xuICAgIHZhciBtb2R1bGVJZCA9IG9wdGlvbnMubW9kdWxlSWQsIG1vZHVsZVRvSGFuZGxlck1hcHBpbmcgPSBvcHRpb25zLm1vZHVsZVRvSGFuZGxlck1hcHBpbmcsIHdlYnBhY2tSZXF1aXJlID0gb3B0aW9ucy53ZWJwYWNrUmVxdWlyZTtcbiAgICB2YXIgZmVkZXJhdGlvbkluc3RhbmNlID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZTtcbiAgICBpZiAoIWZlZGVyYXRpb25JbnN0YW5jZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZlZGVyYXRpb24gaW5zdGFuY2Ugbm90IGZvdW5kIScpO1xuICAgIH1cbiAgICB2YXIgX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfbW9kdWxlSWQgPSBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nW21vZHVsZUlkXSwgc2hhcmVLZXkgPSBfbW9kdWxlVG9IYW5kbGVyTWFwcGluZ19tb2R1bGVJZC5zaGFyZUtleSwgc2hhcmVJbmZvID0gX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfbW9kdWxlSWQuc2hhcmVJbmZvO1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBmZWRlcmF0aW9uSW5zdGFuY2UubG9hZFNoYXJlU3luYyhzaGFyZUtleSwge1xuICAgICAgICAgICAgY3VzdG9tU2hhcmVJbmZvOiBzaGFyZUluZm9cbiAgICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2xvYWRTaGFyZVN5bmMgZmFpbGVkISBUaGUgZnVuY3Rpb24gc2hvdWxkIG5vdCBiZSBjYWxsZWQgdW5sZXNzIHlvdSBzZXQgXCJlYWdlcjp0cnVlXCIuIElmIHlvdSBkbyBub3Qgc2V0IGl0LCBhbmQgZW5jb3VudGVyIHRoaXMgaXNzdWUsIHlvdSBjYW4gY2hlY2sgd2hldGhlciBhbiBhc3luYyBib3VuZGFyeSBpcyBpbXBsZW1lbnRlZC4nKTtcbiAgICAgICAgY29uc29sZS5lcnJvcignVGhlIG9yaWdpbmFsIGVycm9yIG1lc3NhZ2UgaXMgYXMgZm9sbG93czogJyk7XG4gICAgICAgIHRocm93IGVycjtcbiAgICB9XG59XG5mdW5jdGlvbiBpbnN0YWxsSW5pdGlhbENvbnN1bWVzKG9wdGlvbnMpIHtcbiAgICB2YXIgbW9kdWxlVG9IYW5kbGVyTWFwcGluZyA9IG9wdGlvbnMubW9kdWxlVG9IYW5kbGVyTWFwcGluZywgd2VicGFja1JlcXVpcmUgPSBvcHRpb25zLndlYnBhY2tSZXF1aXJlLCBpbnN0YWxsZWRNb2R1bGVzID0gb3B0aW9ucy5pbnN0YWxsZWRNb2R1bGVzLCBpbml0aWFsQ29uc3VtZXMgPSBvcHRpb25zLmluaXRpYWxDb25zdW1lcztcbiAgICBpbml0aWFsQ29uc3VtZXMuZm9yRWFjaCgoaWQpPT57XG4gICAgICAgIHdlYnBhY2tSZXF1aXJlLm1baWRdID0gKG1vZHVsZTEpPT57XG4gICAgICAgICAgICAvLyBIYW5kbGUgc2NlbmFyaW8gd2hlbiBtb2R1bGUgaXMgdXNlZCBzeW5jaHJvbm91c2x5XG4gICAgICAgICAgICBpbnN0YWxsZWRNb2R1bGVzW2lkXSA9IDA7XG4gICAgICAgICAgICBkZWxldGUgd2VicGFja1JlcXVpcmUuY1tpZF07XG4gICAgICAgICAgICB2YXIgZmFjdG9yeSA9IGhhbmRsZUluaXRpYWxDb25zdW1lcyh7XG4gICAgICAgICAgICAgICAgbW9kdWxlSWQ6IGlkLFxuICAgICAgICAgICAgICAgIG1vZHVsZVRvSGFuZGxlck1hcHBpbmcsXG4gICAgICAgICAgICAgICAgd2VicGFja1JlcXVpcmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmYWN0b3J5ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTaGFyZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUgZm9yIGVhZ2VyIGNvbnN1bXB0aW9uOiAke2lkfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbW9kdWxlMS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICAgICAgICB9O1xuICAgIH0pO1xufVxuZnVuY3Rpb24gaW5pdENvbnRhaW5lckVudHJ5KG9wdGlvbnMpIHtcbiAgICB2YXIgd2VicGFja1JlcXVpcmUgPSBvcHRpb25zLndlYnBhY2tSZXF1aXJlLCBzaGFyZVNjb3BlID0gb3B0aW9ucy5zaGFyZVNjb3BlLCBpbml0U2NvcGUgPSBvcHRpb25zLmluaXRTY29wZSwgc2hhcmVTY29wZUtleSA9IG9wdGlvbnMuc2hhcmVTY29wZUtleSwgcmVtb3RlRW50cnlJbml0T3B0aW9ucyA9IG9wdGlvbnMucmVtb3RlRW50cnlJbml0T3B0aW9ucztcbiAgICBpZiAoIXdlYnBhY2tSZXF1aXJlLlMpIHJldHVybjtcbiAgICBpZiAoIXdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24gfHwgIXdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2UgfHwgIXdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpIHJldHVybjtcbiAgICB2YXIgZmVkZXJhdGlvbkluc3RhbmNlID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZTtcbiAgICB2YXIgbmFtZSA9IHNoYXJlU2NvcGVLZXkgfHwgJ2RlZmF1bHQnO1xuICAgIGZlZGVyYXRpb25JbnN0YW5jZS5pbml0T3B0aW9ucyhfb2JqZWN0X3NwcmVhZC5fKHtcbiAgICAgICAgbmFtZTogd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbml0T3B0aW9ucy5uYW1lLFxuICAgICAgICByZW1vdGVzOiBbXVxuICAgIH0sIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMpKTtcbiAgICBmZWRlcmF0aW9uSW5zdGFuY2UuaW5pdFNoYXJlU2NvcGVNYXAobmFtZSwgc2hhcmVTY29wZSwge1xuICAgICAgICBob3N0U2hhcmVTY29wZU1hcDogKHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMgPT09IG51bGwgfHwgcmVtb3RlRW50cnlJbml0T3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcmVtb3RlRW50cnlJbml0T3B0aW9ucy5zaGFyZVNjb3BlTWFwKSB8fCB7fVxuICAgIH0pO1xuICAgIGlmICh3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApIHtcbiAgICAgICAgd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKHdlYnBhY2tSZXF1aXJlKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLnByZWZldGNoID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24ucHJlZmV0Y2goKTtcbiAgICB9XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHJldHVybiB3ZWJwYWNrUmVxdWlyZS5JKG5hbWUsIGluaXRTY29wZSk7XG59XG52YXIgZmVkZXJhdGlvbiA9IHtcbiAgICBydW50aW1lOiBydW50aW1lX19uYW1lc3BhY2UsXG4gICAgaW5zdGFuY2U6IHVuZGVmaW5lZCxcbiAgICBpbml0T3B0aW9uczogdW5kZWZpbmVkLFxuICAgIGJ1bmRsZXJSdW50aW1lOiB7XG4gICAgICAgIHJlbW90ZXMsXG4gICAgICAgIGNvbnN1bWVzLFxuICAgICAgICBJOiBpbml0aWFsaXplU2hhcmluZyxcbiAgICAgICAgUzoge30sXG4gICAgICAgIGluc3RhbGxJbml0aWFsQ29uc3VtZXMsXG4gICAgICAgIGluaXRDb250YWluZXJFbnRyeVxuICAgIH0sXG4gICAgYXR0YWNoU2hhcmVTY29wZU1hcCxcbiAgICBidW5kbGVyUnVudGltZU9wdGlvbnM6IHt9XG59O1xubW9kdWxlLmV4cG9ydHMgPSBmZWRlcmF0aW9uO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV9saWtlX3RvX2FycmF5LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfbGlrZV90b19hcnJheS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2FycmF5X2xpa2VfdG9fYXJyYXkoYXJyLCBsZW4pIHtcbiAgICBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDtcbiAgICBmb3IodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKylhcnIyW2ldID0gYXJyW2ldO1xuICAgIHJldHVybiBhcnIyO1xufVxuZXhwb3J0cy5fID0gX2FycmF5X2xpa2VfdG9fYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhfaG9sZXMuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRoX2hvbGVzLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfYXJyYXlfd2l0aF9ob2xlcyhhcnIpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyO1xufVxuZXhwb3J0cy5fID0gX2FycmF5X3dpdGhfaG9sZXM7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhvdXRfaG9sZXMuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRob3V0X2hvbGVzLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2FycmF5X2xpa2VfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hcnJheV9saWtlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X2xpa2VfdG9fYXJyYXkuY2pzXCIpO1xuZnVuY3Rpb24gX2FycmF5X3dpdGhvdXRfaG9sZXMoYXJyKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheV9saWtlX3RvX2FycmF5Ll8oYXJyKTtcbn1cbmV4cG9ydHMuXyA9IF9hcnJheV93aXRob3V0X2hvbGVzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3NlcnRfdGhpc19pbml0aWFsaXplZC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3NlcnRfdGhpc19pbml0aWFsaXplZC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9hc3NlcnRfdGhpc19pbml0aWFsaXplZChzZWxmKSB7XG4gICAgaWYgKHNlbGYgPT09IHZvaWQgMCkgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpO1xuICAgIHJldHVybiBzZWxmO1xufVxuZXhwb3J0cy5fID0gX2Fzc2VydF90aGlzX2luaXRpYWxpemVkO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FzeW5jX3RvX2dlbmVyYXRvci5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpO1xuICAgICAgICB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGluZm8uZG9uZSkgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgZWxzZSBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7XG59XG5mdW5jdGlvbiBfYXN5bmNfdG9fZ2VuZXJhdG9yKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBcIm5leHRcIiwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikge1xuICAgICAgICAgICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgXCJ0aHJvd1wiLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX25leHQodW5kZWZpbmVkKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbmV4cG9ydHMuXyA9IF9hc3luY190b19nZW5lcmF0b3I7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NhbGxfc3VwZXIuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jYWxsX3N1cGVyLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2dldF9wcm90b3R5cGVfb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19nZXRfcHJvdG90eXBlX29mLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2dldF9wcm90b3R5cGVfb2YuY2pzXCIpO1xudmFyIF9pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0LmNqc1wiKTtcbnZhciBfcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybi5janNcIik7XG5mdW5jdGlvbiBfY2FsbF9zdXBlcihfdGhpcywgZGVyaXZlZCwgYXJncykge1xuICAgIC8vIFN1cGVyXG4gICAgZGVyaXZlZCA9IF9nZXRfcHJvdG90eXBlX29mLl8oZGVyaXZlZCk7XG4gICAgcmV0dXJuIF9wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4uXyhfdGhpcywgX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdC5fKCkgPyBSZWZsZWN0LmNvbnN0cnVjdChkZXJpdmVkLCBhcmdzIHx8IFtdLCBfZ2V0X3Byb3RvdHlwZV9vZi5fKF90aGlzKS5jb25zdHJ1Y3RvcikgOiBkZXJpdmVkLmFwcGx5KF90aGlzLCBhcmdzKSk7XG59XG5leHBvcnRzLl8gPSBfY2FsbF9zdXBlcjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NsYXNzX2NhbGxfY2hlY2suY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9jbGFzc19jYWxsX2NoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3Rvcikge1xuICAgIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xufVxuZXhwb3J0cy5fID0gX2NsYXNzX2NhbGxfY2hlY2s7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY3JlYXRlX2NsYXNzLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7XG4gICAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTtcbiAgICAgICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIF9jcmVhdGVfY2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gICAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7XG4gICAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpO1xuICAgIHJldHVybiBDb25zdHJ1Y3Rvcjtcbn1cbmV4cG9ydHMuXyA9IF9jcmVhdGVfY2xhc3M7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2RlZmluZV9wcm9wZXJ0eS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZGVmaW5lX3Byb3BlcnR5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9kZWZpbmVfcHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7XG4gICAgaWYgKGtleSBpbiBvYmopIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIG9ialtrZXldID0gdmFsdWU7XG4gICAgcmV0dXJuIG9iajtcbn1cbmV4cG9ydHMuXyA9IF9kZWZpbmVfcHJvcGVydHk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2V4cG9ydF9zdGFyLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2V4cG9ydF9zdGFyLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2V4cG9ydF9zdGFyKGZyb20sIHRvKSB7XG4gICAgT2JqZWN0LmtleXMoZnJvbSkuZm9yRWFjaChmdW5jdGlvbihrKSB7XG4gICAgICAgIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRvLCBrKSkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRvLCBrLCB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnJvbVtrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBmcm9tO1xufVxuZXhwb3J0cy5fID0gX2V4cG9ydF9zdGFyO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19nZXRfcHJvdG90eXBlX29mLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZ2V0X3Byb3RvdHlwZV9vZi5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2dldF9wcm90b3R5cGVfb2Yobykge1xuICAgIGV4cG9ydHMuXyA9IF9nZXRfcHJvdG90eXBlX29mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gZ2V0UHJvdG90eXBlT2Yobykge1xuICAgICAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pO1xuICAgIH07XG4gICAgcmV0dXJuIF9nZXRfcHJvdG90eXBlX29mKG8pO1xufVxuZXhwb3J0cy5fID0gX2dldF9wcm90b3R5cGVfb2Y7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2luaGVyaXRzLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2luaGVyaXRzLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9zZXRfcHJvdG90eXBlX29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fc2V0X3Byb3RvdHlwZV9vZi5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zZXRfcHJvdG90eXBlX29mLmNqc1wiKTtcbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICAgIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHtcbiAgICAgICAgY29uc3RydWN0b3I6IHtcbiAgICAgICAgICAgIHZhbHVlOiBzdWJDbGFzcyxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoc3VwZXJDbGFzcykgX3NldF9wcm90b3R5cGVfb2YuXyhzdWJDbGFzcywgc3VwZXJDbGFzcyk7XG59XG5leHBvcnRzLl8gPSBfaW5oZXJpdHM7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0KG9iaikge1xuICAgIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7XG4gICAgICAgIGRlZmF1bHQ6IG9ialxuICAgIH07XG59XG5leHBvcnRzLl8gPSBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQ7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QoKSB7XG4gICAgLy8gU2luY2UgUmVmbGVjdC5jb25zdHJ1Y3QgY2FuJ3QgYmUgcHJvcGVybHkgcG9seWZpbGxlZCwgc29tZVxuICAgIC8vIGltcGxlbWVudGF0aW9ucyAoZS5nLiBjb3JlLWpzQDIpIGRvbid0IHNldCB0aGUgY29ycmVjdCBpbnRlcm5hbCBzbG90cy5cbiAgICAvLyBUaG9zZSBwb2x5ZmlsbHMgZG9uJ3QgYWxsb3cgdXMgdG8gc3ViY2xhc3MgYnVpbHQtaW5zLCBzbyB3ZSBuZWVkIHRvXG4gICAgLy8gdXNlIG91ciBmYWxsYmFjayBpbXBsZW1lbnRhdGlvbi5cbiAgICB0cnkge1xuICAgICAgICAvLyBJZiB0aGUgaW50ZXJuYWwgc2xvdHMgYXJlbid0IHNldCwgdGhpcyB0aHJvd3MgYW4gZXJyb3Igc2ltaWxhciB0b1xuICAgICAgICAvLyAgIFR5cGVFcnJvcjogdGhpcyBpcyBub3QgYSBCb29sZWFuIG9iamVjdC5cbiAgICAgICAgdmFyIHJlc3VsdCA9ICFCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uKCkge30pKTtcbiAgICB9IGNhdGNoIChfKSB7fVxuICAgIHJldHVybiAoZXhwb3J0cy5fID0gX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gISFyZXN1bHQ7XG4gICAgfSkoKTtcbn1cbmV4cG9ydHMuXyA9IF9pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3Q7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2l0ZXJhYmxlX3RvX2FycmF5KGl0ZXIpIHtcbiAgICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBpdGVyW1N5bWJvbC5pdGVyYXRvcl0gIT0gbnVsbCB8fCBpdGVyW1wiQEBpdGVyYXRvclwiXSAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpO1xuICAgIH1cbn1cbmV4cG9ydHMuXyA9IF9pdGVyYWJsZV90b19hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXlfbGltaXQuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXlfbGltaXQuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfaXRlcmFibGVfdG9fYXJyYXlfbGltaXQoYXJyLCBpKSB7XG4gICAgdmFyIF9pID0gYXJyID09IG51bGwgPyBudWxsIDogdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBhcnJbU3ltYm9sLml0ZXJhdG9yXSB8fCBhcnJbXCJAQGl0ZXJhdG9yXCJdO1xuICAgIGlmIChfaSA9PSBudWxsKSByZXR1cm47XG4gICAgdmFyIF9hcnIgPSBbXTtcbiAgICB2YXIgX24gPSB0cnVlO1xuICAgIHZhciBfZCA9IGZhbHNlO1xuICAgIHZhciBfcywgX2U7XG4gICAgdHJ5IHtcbiAgICAgICAgZm9yKF9pID0gX2kuY2FsbChhcnIpOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKXtcbiAgICAgICAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7XG4gICAgICAgICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgX2QgPSB0cnVlO1xuICAgICAgICBfZSA9IGVycjtcbiAgICB9IGZpbmFsbHl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIV9uICYmIF9pW1wicmV0dXJuXCJdICE9IG51bGwpIF9pW1wicmV0dXJuXCJdKCk7XG4gICAgICAgIH0gZmluYWxseXtcbiAgICAgICAgICAgIGlmIChfZCkgdGhyb3cgX2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIF9hcnI7XG59XG5leHBvcnRzLl8gPSBfaXRlcmFibGVfdG9fYXJyYXlfbGltaXQ7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9yZXN0LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9yZXN0LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX25vbl9pdGVyYWJsZV9yZXN0KCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7XG59XG5leHBvcnRzLl8gPSBfbm9uX2l0ZXJhYmxlX3Jlc3Q7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9zcHJlYWQuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfc3ByZWFkLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfbm9uX2l0ZXJhYmxlX3NwcmVhZCgpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcbn1cbmV4cG9ydHMuXyA9IF9ub25faXRlcmFibGVfc3ByZWFkO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19vYmplY3Rfc3ByZWFkLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fb2JqZWN0X3NwcmVhZC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9kZWZpbmVfcHJvcGVydHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19kZWZpbmVfcHJvcGVydHkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZGVmaW5lX3Byb3BlcnR5LmNqc1wiKTtcbmZ1bmN0aW9uIF9vYmplY3Rfc3ByZWFkKHRhcmdldCkge1xuICAgIGZvcih2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTtcbiAgICAgICAgdmFyIG93bktleXMgPSBPYmplY3Qua2V5cyhzb3VyY2UpO1xuICAgICAgICBpZiAodHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgb3duS2V5cyA9IG93bktleXMuY29uY2F0KE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc291cmNlKS5maWx0ZXIoZnVuY3Rpb24oc3ltKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBzeW0pLmVudW1lcmFibGU7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3duS2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgX2RlZmluZV9wcm9wZXJ0eS5fKHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuZXhwb3J0cy5fID0gX29iamVjdF9zcHJlYWQ7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybi5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hc3NlcnRfdGhpc19pbml0aWFsaXplZC5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3NlcnRfdGhpc19pbml0aWFsaXplZC5janNcIik7XG52YXIgX3R5cGVfb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL190eXBlX29mLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3R5cGVfb2YuY2pzXCIpO1xuZnVuY3Rpb24gX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybihzZWxmLCBjYWxsKSB7XG4gICAgaWYgKGNhbGwgJiYgKF90eXBlX29mLl8oY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHJldHVybiBjYWxsO1xuICAgIHJldHVybiBfYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQuXyhzZWxmKTtcbn1cbmV4cG9ydHMuXyA9IF9wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm47XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NldF9wcm90b3R5cGVfb2YuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zZXRfcHJvdG90eXBlX29mLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfc2V0X3Byb3RvdHlwZV9vZihvLCBwKSB7XG4gICAgZXhwb3J0cy5fID0gX3NldF9wcm90b3R5cGVfb2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gc2V0UHJvdG90eXBlT2YobywgcCkge1xuICAgICAgICBvLl9fcHJvdG9fXyA9IHA7XG4gICAgICAgIHJldHVybiBvO1xuICAgIH07XG4gICAgcmV0dXJuIF9zZXRfcHJvdG90eXBlX29mKG8sIHApO1xufVxuZXhwb3J0cy5fID0gX3NldF9wcm90b3R5cGVfb2Y7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2xpY2VkX3RvX2FycmF5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfYXJyYXlfd2l0aF9ob2xlcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2FycmF5X3dpdGhfaG9sZXMuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aF9ob2xlcy5janNcIik7XG52YXIgX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9faXRlcmFibGVfdG9fYXJyYXlfbGltaXQuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXlfbGltaXQuY2pzXCIpO1xudmFyIF9ub25faXRlcmFibGVfcmVzdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX25vbl9pdGVyYWJsZV9yZXN0LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9yZXN0LmNqc1wiKTtcbnZhciBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janNcIik7XG5mdW5jdGlvbiBfc2xpY2VkX3RvX2FycmF5KGFyciwgaSkge1xuICAgIHJldHVybiBfYXJyYXlfd2l0aF9ob2xlcy5fKGFycikgfHwgX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0Ll8oYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuXyhhcnIsIGkpIHx8IF9ub25faXRlcmFibGVfcmVzdC5fKCk7XG59XG5leHBvcnRzLl8gPSBfc2xpY2VkX3RvX2FycmF5O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19hcnJheS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfYXJyYXlfd2l0aF9ob2xlcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2FycmF5X3dpdGhfaG9sZXMuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aF9ob2xlcy5janNcIik7XG52YXIgX2l0ZXJhYmxlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9faXRlcmFibGVfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF9ub25faXRlcmFibGVfcmVzdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX25vbl9pdGVyYWJsZV9yZXN0LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9yZXN0LmNqc1wiKTtcbnZhciBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janNcIik7XG5mdW5jdGlvbiBfdG9fYXJyYXkoYXJyKSB7XG4gICAgcmV0dXJuIF9hcnJheV93aXRoX2hvbGVzLl8oYXJyKSB8fCBfaXRlcmFibGVfdG9fYXJyYXkuXyhhcnIpIHx8IF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5fKGFycikgfHwgX25vbl9pdGVyYWJsZV9yZXN0Ll8oKTtcbn1cbmV4cG9ydHMuXyA9IF90b19hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fY29uc3VtYWJsZV9hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfYXJyYXlfd2l0aG91dF9ob2xlcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2FycmF5X3dpdGhvdXRfaG9sZXMuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aG91dF9ob2xlcy5janNcIik7XG52YXIgX2l0ZXJhYmxlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9faXRlcmFibGVfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF9ub25faXRlcmFibGVfc3ByZWFkID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fbm9uX2l0ZXJhYmxlX3NwcmVhZC5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfc3ByZWFkLmNqc1wiKTtcbnZhciBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janNcIik7XG5mdW5jdGlvbiBfdG9fY29uc3VtYWJsZV9hcnJheShhcnIpIHtcbiAgICByZXR1cm4gX2FycmF5X3dpdGhvdXRfaG9sZXMuXyhhcnIpIHx8IF9pdGVyYWJsZV90b19hcnJheS5fKGFycikgfHwgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5Ll8oYXJyKSB8fCBfbm9uX2l0ZXJhYmxlX3NwcmVhZC5fKCk7XG59XG5leHBvcnRzLl8gPSBfdG9fY29uc3VtYWJsZV9hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdHlwZV9vZi5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3R5cGVfb2YuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF90eXBlX29mKG9iaikge1xuICAgIFwiQHN3Yy9oZWxwZXJzIC0gdHlwZW9mXCI7XG4gICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7XG59XG5leHBvcnRzLl8gPSBfdHlwZV9vZjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2FycmF5X2xpa2VfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hcnJheV9saWtlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X2xpa2VfdG9fYXJyYXkuY2pzXCIpO1xuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5KG8sIG1pbkxlbikge1xuICAgIGlmICghbykgcmV0dXJuO1xuICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheV9saWtlX3RvX2FycmF5Ll8obywgbWluTGVuKTtcbiAgICB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7XG4gICAgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTtcbiAgICBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShuKTtcbiAgICBpZiAobiA9PT0gXCJBcmd1bWVudHNcIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheV9saWtlX3RvX2FycmF5Ll8obywgbWluTGVuKTtcbn1cbmV4cG9ydHMuXyA9IF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvTmF0aXZlU2NyaXB0TWFuYWdlci5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbmZ1bmN0aW9uIF9leHBvcnQodGFyZ2V0LCBhbGwpIHtcbiAgICBmb3IodmFyIG5hbWUgaW4gYWxsKU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIG5hbWUsIHtcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgZ2V0OiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGFsbCwgbmFtZSkuZ2V0XG4gICAgfSk7XG59XG5fZXhwb3J0KGV4cG9ydHMsIHtcbiAgICBnZXQgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kICgpIHtcbiAgICAgICAgcmV0dXJuIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZDtcbiAgICB9LFxuICAgIGdldCBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGUgKCkge1xuICAgICAgICByZXR1cm4gTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlO1xuICAgIH0sXG4gICAgZ2V0IGRlZmF1bHQgKCkge1xuICAgICAgICByZXR1cm4gX2RlZmF1bHQ7XG4gICAgfVxufSk7XG52YXIgX3JlYWN0bmF0aXZlID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlICovIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlPzhkMTRcIik7XG52YXIgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kID0gZnVuY3Rpb24oTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kKSB7XG4gICAgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kW1wiR0VUXCJdID0gXCJHRVRcIjtcbiAgICBOb3JtYWxpemVkU2NyaXB0TG9jYXRvckhUVFBNZXRob2RbXCJQT1NUXCJdID0gXCJQT1NUXCI7XG4gICAgcmV0dXJuIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZDtcbn0oe30pO1xudmFyIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZSA9IGZ1bmN0aW9uKE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZSkge1xuICAgIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZVtcIlNUUklDVFwiXSA9IFwic3RyaWN0XCI7XG4gICAgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlW1wiTEFYXCJdID0gXCJsYXhcIjtcbiAgICBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGVbXCJPRkZcIl0gPSBcIm9mZlwiO1xuICAgIHJldHVybiBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGU7XG59KHt9KTtcbnZhciBfZGVmYXVsdCA9IF9yZWFjdG5hdGl2ZS5UdXJib01vZHVsZVJlZ2lzdHJ5LmdldCgnU2NyaXB0TWFuYWdlcicpO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9ldmVudHMvZXZlbnRzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAobW9kdWxlKSB7XG5cInVzZSBzdHJpY3RcIjtcbi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgUiA9IHR5cGVvZiBSZWZsZWN0ID09PSAnb2JqZWN0JyA/IFJlZmxlY3QgOiBudWxsO1xudmFyIFJlZmxlY3RBcHBseSA9IFIgJiYgdHlwZW9mIFIuYXBwbHkgPT09ICdmdW5jdGlvbicgPyBSLmFwcGx5IDogZnVuY3Rpb24gUmVmbGVjdEFwcGx5KHRhcmdldCwgcmVjZWl2ZXIsIGFyZ3MpIHtcbiAgICByZXR1cm4gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5LmNhbGwodGFyZ2V0LCByZWNlaXZlciwgYXJncyk7XG59O1xudmFyIFJlZmxlY3RPd25LZXlzO1xuaWYgKFIgJiYgdHlwZW9mIFIub3duS2V5cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIFJlZmxlY3RPd25LZXlzID0gUi5vd25LZXlzO1xufSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7XG4gICAgUmVmbGVjdE93bktleXMgPSBmdW5jdGlvbiBSZWZsZWN0T3duS2V5cyh0YXJnZXQpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRhcmdldCkuY29uY2F0KE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHModGFyZ2V0KSk7XG4gICAgfTtcbn0gZWxzZSB7XG4gICAgUmVmbGVjdE93bktleXMgPSBmdW5jdGlvbiBSZWZsZWN0T3duS2V5cyh0YXJnZXQpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRhcmdldCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIFByb2Nlc3NFbWl0V2FybmluZyh3YXJuaW5nKSB7XG4gICAgaWYgKGNvbnNvbGUgJiYgY29uc29sZS53YXJuKSBjb25zb2xlLndhcm4od2FybmluZyk7XG59XG52YXIgTnVtYmVySXNOYU4gPSBOdW1iZXIuaXNOYU4gfHwgZnVuY3Rpb24gTnVtYmVySXNOYU4odmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgIT09IHZhbHVlO1xufTtcbmZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHtcbiAgICBFdmVudEVtaXR0ZXIuaW5pdC5jYWxsKHRoaXMpO1xufVxubW9kdWxlLmV4cG9ydHMgPSBFdmVudEVtaXR0ZXI7XG5tb2R1bGUuZXhwb3J0cy5vbmNlID0gb25jZTtcbi8vIEJhY2t3YXJkcy1jb21wYXQgd2l0aCBub2RlIDAuMTAueFxuRXZlbnRFbWl0dGVyLkV2ZW50RW1pdHRlciA9IEV2ZW50RW1pdHRlcjtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50cyA9IHVuZGVmaW5lZDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50c0NvdW50ID0gMDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDtcbi8vIEJ5IGRlZmF1bHQgRXZlbnRFbWl0dGVycyB3aWxsIHByaW50IGEgd2FybmluZyBpZiBtb3JlIHRoYW4gMTAgbGlzdGVuZXJzIGFyZVxuLy8gYWRkZWQgdG8gaXQuIFRoaXMgaXMgYSB1c2VmdWwgZGVmYXVsdCB3aGljaCBoZWxwcyBmaW5kaW5nIG1lbW9yeSBsZWFrcy5cbnZhciBkZWZhdWx0TWF4TGlzdGVuZXJzID0gMTA7XG5mdW5jdGlvbiBjaGVja0xpc3RlbmVyKGxpc3RlbmVyKSB7XG4gICAgaWYgKHR5cGVvZiBsaXN0ZW5lciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJsaXN0ZW5lclwiIGFyZ3VtZW50IG11c3QgYmUgb2YgdHlwZSBGdW5jdGlvbi4gUmVjZWl2ZWQgdHlwZSAnICsgdHlwZW9mIGxpc3RlbmVyKTtcbiAgICB9XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoRXZlbnRFbWl0dGVyLCAnZGVmYXVsdE1heExpc3RlbmVycycsIHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0TWF4TGlzdGVuZXJzO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhcmcgIT09ICdudW1iZXInIHx8IGFyZyA8IDAgfHwgTnVtYmVySXNOYU4oYXJnKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSB2YWx1ZSBvZiBcImRlZmF1bHRNYXhMaXN0ZW5lcnNcIiBpcyBvdXQgb2YgcmFuZ2UuIEl0IG11c3QgYmUgYSBub24tbmVnYXRpdmUgbnVtYmVyLiBSZWNlaXZlZCAnICsgYXJnICsgJy4nKTtcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0TWF4TGlzdGVuZXJzID0gYXJnO1xuICAgIH1cbn0pO1xuRXZlbnRFbWl0dGVyLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5fZXZlbnRzID09PSB1bmRlZmluZWQgfHwgdGhpcy5fZXZlbnRzID09PSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcykuX2V2ZW50cykge1xuICAgICAgICB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICB0aGlzLl9ldmVudHNDb3VudCA9IDA7XG4gICAgfVxuICAgIHRoaXMuX21heExpc3RlbmVycyA9IHRoaXMuX21heExpc3RlbmVycyB8fCB1bmRlZmluZWQ7XG59O1xuLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzXG4vLyB0aGF0IHRvIGJlIGluY3JlYXNlZC4gU2V0IHRvIHplcm8gZm9yIHVubGltaXRlZC5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuc2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24gc2V0TWF4TGlzdGVuZXJzKG4pIHtcbiAgICBpZiAodHlwZW9mIG4gIT09ICdudW1iZXInIHx8IG4gPCAwIHx8IE51bWJlcklzTmFOKG4pKSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdUaGUgdmFsdWUgb2YgXCJuXCIgaXMgb3V0IG9mIHJhbmdlLiBJdCBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlci4gUmVjZWl2ZWQgJyArIG4gKyAnLicpO1xuICAgIH1cbiAgICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSBuO1xuICAgIHJldHVybiB0aGlzO1xufTtcbmZ1bmN0aW9uIF9nZXRNYXhMaXN0ZW5lcnModGhhdCkge1xuICAgIGlmICh0aGF0Ll9tYXhMaXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIEV2ZW50RW1pdHRlci5kZWZhdWx0TWF4TGlzdGVuZXJzO1xuICAgIHJldHVybiB0aGF0Ll9tYXhMaXN0ZW5lcnM7XG59XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmdldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uIGdldE1heExpc3RlbmVycygpIHtcbiAgICByZXR1cm4gX2dldE1heExpc3RlbmVycyh0aGlzKTtcbn07XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiBlbWl0KHR5cGUpIHtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvcih2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7XG4gICAgdmFyIGRvRXJyb3IgPSB0eXBlID09PSAnZXJyb3InO1xuICAgIHZhciBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyAhPT0gdW5kZWZpbmVkKSBkb0Vycm9yID0gZG9FcnJvciAmJiBldmVudHMuZXJyb3IgPT09IHVuZGVmaW5lZDtcbiAgICBlbHNlIGlmICghZG9FcnJvcikgcmV0dXJuIGZhbHNlO1xuICAgIC8vIElmIHRoZXJlIGlzIG5vICdlcnJvcicgZXZlbnQgbGlzdGVuZXIgdGhlbiB0aHJvdy5cbiAgICBpZiAoZG9FcnJvcikge1xuICAgICAgICB2YXIgZXI7XG4gICAgICAgIGlmIChhcmdzLmxlbmd0aCA+IDApIGVyID0gYXJnc1swXTtcbiAgICAgICAgaWYgKGVyIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgIC8vIE5vdGU6IFRoZSBjb21tZW50cyBvbiB0aGUgYHRocm93YCBsaW5lcyBhcmUgaW50ZW50aW9uYWwsIHRoZXkgc2hvd1xuICAgICAgICAgICAgLy8gdXAgaW4gTm9kZSdzIG91dHB1dCBpZiB0aGlzIHJlc3VsdHMgaW4gYW4gdW5oYW5kbGVkIGV4Y2VwdGlvbi5cbiAgICAgICAgICAgIHRocm93IGVyOyAvLyBVbmhhbmRsZWQgJ2Vycm9yJyBldmVudFxuICAgICAgICB9XG4gICAgICAgIC8vIEF0IGxlYXN0IGdpdmUgc29tZSBraW5kIG9mIGNvbnRleHQgdG8gdGhlIHVzZXJcbiAgICAgICAgdmFyIGVyciA9IG5ldyBFcnJvcignVW5oYW5kbGVkIGVycm9yLicgKyAoZXIgPyAnICgnICsgZXIubWVzc2FnZSArICcpJyA6ICcnKSk7XG4gICAgICAgIGVyci5jb250ZXh0ID0gZXI7XG4gICAgICAgIHRocm93IGVycjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICB9XG4gICAgdmFyIGhhbmRsZXIgPSBldmVudHNbdHlwZV07XG4gICAgaWYgKGhhbmRsZXIgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBSZWZsZWN0QXBwbHkoaGFuZGxlciwgdGhpcywgYXJncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGxlbiA9IGhhbmRsZXIubGVuZ3RoO1xuICAgICAgICB2YXIgbGlzdGVuZXJzID0gYXJyYXlDbG9uZShoYW5kbGVyLCBsZW4pO1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpUmVmbGVjdEFwcGx5KGxpc3RlbmVyc1tpXSwgdGhpcywgYXJncyk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcbmZ1bmN0aW9uIF9hZGRMaXN0ZW5lcih0YXJnZXQsIHR5cGUsIGxpc3RlbmVyLCBwcmVwZW5kKSB7XG4gICAgdmFyIG07XG4gICAgdmFyIGV2ZW50cztcbiAgICB2YXIgZXhpc3Rpbmc7XG4gICAgY2hlY2tMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgZXZlbnRzID0gdGFyZ2V0Ll9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGV2ZW50cyA9IHRhcmdldC5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgdGFyZ2V0Ll9ldmVudHNDb3VudCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gVG8gYXZvaWQgcmVjdXJzaW9uIGluIHRoZSBjYXNlIHRoYXQgdHlwZSA9PT0gXCJuZXdMaXN0ZW5lclwiISBCZWZvcmVcbiAgICAgICAgLy8gYWRkaW5nIGl0IHRvIHRoZSBsaXN0ZW5lcnMsIGZpcnN0IGVtaXQgXCJuZXdMaXN0ZW5lclwiLlxuICAgICAgICBpZiAoZXZlbnRzLm5ld0xpc3RlbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRhcmdldC5lbWl0KCduZXdMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyLmxpc3RlbmVyID8gbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7XG4gICAgICAgICAgICAvLyBSZS1hc3NpZ24gYGV2ZW50c2AgYmVjYXVzZSBhIG5ld0xpc3RlbmVyIGhhbmRsZXIgY291bGQgaGF2ZSBjYXVzZWQgdGhlXG4gICAgICAgICAgICAvLyB0aGlzLl9ldmVudHMgdG8gYmUgYXNzaWduZWQgdG8gYSBuZXcgb2JqZWN0XG4gICAgICAgICAgICBldmVudHMgPSB0YXJnZXQuX2V2ZW50cztcbiAgICAgICAgfVxuICAgICAgICBleGlzdGluZyA9IGV2ZW50c1t0eXBlXTtcbiAgICB9XG4gICAgaWYgKGV4aXN0aW5nID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuXG4gICAgICAgIGV4aXN0aW5nID0gZXZlbnRzW3R5cGVdID0gbGlzdGVuZXI7XG4gICAgICAgICsrdGFyZ2V0Ll9ldmVudHNDb3VudDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodHlwZW9mIGV4aXN0aW5nID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAvLyBBZGRpbmcgdGhlIHNlY29uZCBlbGVtZW50LCBuZWVkIHRvIGNoYW5nZSB0byBhcnJheS5cbiAgICAgICAgICAgIGV4aXN0aW5nID0gZXZlbnRzW3R5cGVdID0gcHJlcGVuZCA/IFtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcixcbiAgICAgICAgICAgICAgICBleGlzdGluZ1xuICAgICAgICAgICAgXSA6IFtcbiAgICAgICAgICAgICAgICBleGlzdGluZyxcbiAgICAgICAgICAgICAgICBsaXN0ZW5lclxuICAgICAgICAgICAgXTtcbiAgICAgICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYXBwZW5kLlxuICAgICAgICB9IGVsc2UgaWYgKHByZXBlbmQpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nLnVuc2hpZnQobGlzdGVuZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhpc3RpbmcucHVzaChsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2hlY2sgZm9yIGxpc3RlbmVyIGxlYWtcbiAgICAgICAgbSA9IF9nZXRNYXhMaXN0ZW5lcnModGFyZ2V0KTtcbiAgICAgICAgaWYgKG0gPiAwICYmIGV4aXN0aW5nLmxlbmd0aCA+IG0gJiYgIWV4aXN0aW5nLndhcm5lZCkge1xuICAgICAgICAgICAgZXhpc3Rpbmcud2FybmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vIE5vIGVycm9yIGNvZGUgZm9yIHRoaXMgc2luY2UgaXQgaXMgYSBXYXJuaW5nXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1zeW50YXhcbiAgICAgICAgICAgIHZhciB3ID0gbmV3IEVycm9yKCdQb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5IGxlYWsgZGV0ZWN0ZWQuICcgKyBleGlzdGluZy5sZW5ndGggKyAnICcgKyBTdHJpbmcodHlwZSkgKyAnIGxpc3RlbmVycyAnICsgJ2FkZGVkLiBVc2UgZW1pdHRlci5zZXRNYXhMaXN0ZW5lcnMoKSB0byAnICsgJ2luY3JlYXNlIGxpbWl0Jyk7XG4gICAgICAgICAgICB3Lm5hbWUgPSAnTWF4TGlzdGVuZXJzRXhjZWVkZWRXYXJuaW5nJztcbiAgICAgICAgICAgIHcuZW1pdHRlciA9IHRhcmdldDtcbiAgICAgICAgICAgIHcudHlwZSA9IHR5cGU7XG4gICAgICAgICAgICB3LmNvdW50ID0gZXhpc3RpbmcubGVuZ3RoO1xuICAgICAgICAgICAgUHJvY2Vzc0VtaXRXYXJuaW5nKHcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyID0gZnVuY3Rpb24gYWRkTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICByZXR1cm4gX2FkZExpc3RlbmVyKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCBmYWxzZSk7XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXI7XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnByZXBlbmRMaXN0ZW5lciA9IGZ1bmN0aW9uIHByZXBlbmRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikge1xuICAgIHJldHVybiBfYWRkTGlzdGVuZXIodGhpcywgdHlwZSwgbGlzdGVuZXIsIHRydWUpO1xufTtcbmZ1bmN0aW9uIG9uY2VXcmFwcGVyKCkge1xuICAgIGlmICghdGhpcy5maXJlZCkge1xuICAgICAgICB0aGlzLnRhcmdldC5yZW1vdmVMaXN0ZW5lcih0aGlzLnR5cGUsIHRoaXMud3JhcEZuKTtcbiAgICAgICAgdGhpcy5maXJlZCA9IHRydWU7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdGhpcy5saXN0ZW5lci5jYWxsKHRoaXMudGFyZ2V0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIuYXBwbHkodGhpcy50YXJnZXQsIGFyZ3VtZW50cyk7XG4gICAgfVxufVxuZnVuY3Rpb24gX29uY2VXcmFwKHRhcmdldCwgdHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgc3RhdGUgPSB7XG4gICAgICAgIGZpcmVkOiBmYWxzZSxcbiAgICAgICAgd3JhcEZuOiB1bmRlZmluZWQsXG4gICAgICAgIHRhcmdldDogdGFyZ2V0LFxuICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICBsaXN0ZW5lcjogbGlzdGVuZXJcbiAgICB9O1xuICAgIHZhciB3cmFwcGVkID0gb25jZVdyYXBwZXIuYmluZChzdGF0ZSk7XG4gICAgd3JhcHBlZC5saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgIHN0YXRlLndyYXBGbiA9IHdyYXBwZWQ7XG4gICAgcmV0dXJuIHdyYXBwZWQ7XG59XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiBvbmNlKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgY2hlY2tMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgdGhpcy5vbih0eXBlLCBfb25jZVdyYXAodGhpcywgdHlwZSwgbGlzdGVuZXIpKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBmdW5jdGlvbiBwcmVwZW5kT25jZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgY2hlY2tMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgdGhpcy5wcmVwZW5kTGlzdGVuZXIodHlwZSwgX29uY2VXcmFwKHRoaXMsIHR5cGUsIGxpc3RlbmVyKSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuLy8gRW1pdHMgYSAncmVtb3ZlTGlzdGVuZXInIGV2ZW50IGlmIGFuZCBvbmx5IGlmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZC5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbiByZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBsaXN0LCBldmVudHMsIHBvc2l0aW9uLCBpLCBvcmlnaW5hbExpc3RlbmVyO1xuICAgIGNoZWNrTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIGV2ZW50cyA9IHRoaXMuX2V2ZW50cztcbiAgICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpIHJldHVybiB0aGlzO1xuICAgIGxpc3QgPSBldmVudHNbdHlwZV07XG4gICAgaWYgKGxpc3QgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXM7XG4gICAgaWYgKGxpc3QgPT09IGxpc3RlbmVyIHx8IGxpc3QubGlzdGVuZXIgPT09IGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICgtLXRoaXMuX2V2ZW50c0NvdW50ID09PSAwKSB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRlbGV0ZSBldmVudHNbdHlwZV07XG4gICAgICAgICAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyKSB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgbGlzdC5saXN0ZW5lciB8fCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBsaXN0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHBvc2l0aW9uID0gLTE7XG4gICAgICAgIGZvcihpID0gbGlzdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XG4gICAgICAgICAgICBpZiAobGlzdFtpXSA9PT0gbGlzdGVuZXIgfHwgbGlzdFtpXS5saXN0ZW5lciA9PT0gbGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbExpc3RlbmVyID0gbGlzdFtpXS5saXN0ZW5lcjtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IGk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgcmV0dXJuIHRoaXM7XG4gICAgICAgIGlmIChwb3NpdGlvbiA9PT0gMCkgbGlzdC5zaGlmdCgpO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNwbGljZU9uZShsaXN0LCBwb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09PSAxKSBldmVudHNbdHlwZV0gPSBsaXN0WzBdO1xuICAgICAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyICE9PSB1bmRlZmluZWQpIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBvcmlnaW5hbExpc3RlbmVyIHx8IGxpc3RlbmVyKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vZmYgPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyO1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbiByZW1vdmVBbGxMaXN0ZW5lcnModHlwZSkge1xuICAgIHZhciBsaXN0ZW5lcnMsIGV2ZW50cywgaTtcbiAgICBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdGhpcztcbiAgICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0XG4gICAgaWYgKGV2ZW50cy5yZW1vdmVMaXN0ZW5lciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICAgICAgdGhpcy5fZXZlbnRzQ291bnQgPSAwO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50c1t0eXBlXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAoLS10aGlzLl9ldmVudHNDb3VudCA9PT0gMCkgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgICAgIGVsc2UgZGVsZXRlIGV2ZW50c1t0eXBlXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLy8gZW1pdCByZW1vdmVMaXN0ZW5lciBmb3IgYWxsIGxpc3RlbmVycyBvbiBhbGwgZXZlbnRzXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhldmVudHMpO1xuICAgICAgICB2YXIga2V5O1xuICAgICAgICBmb3IoaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgIGtleSA9IGtleXNbaV07XG4gICAgICAgICAgICBpZiAoa2V5ID09PSAncmVtb3ZlTGlzdGVuZXInKSBjb250aW51ZTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3JlbW92ZUxpc3RlbmVyJyk7XG4gICAgICAgIHRoaXMuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIHRoaXMuX2V2ZW50c0NvdW50ID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGxpc3RlbmVycyA9IGV2ZW50c1t0eXBlXTtcbiAgICBpZiAodHlwZW9mIGxpc3RlbmVycyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVycyk7XG4gICAgfSBlbHNlIGlmIChsaXN0ZW5lcnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBMSUZPIG9yZGVyXG4gICAgICAgIGZvcihpID0gbGlzdGVuZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKXtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5mdW5jdGlvbiBfbGlzdGVuZXJzKHRhcmdldCwgdHlwZSwgdW53cmFwKSB7XG4gICAgdmFyIGV2ZW50cyA9IHRhcmdldC5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIFtdO1xuICAgIHZhciBldmxpc3RlbmVyID0gZXZlbnRzW3R5cGVdO1xuICAgIGlmIChldmxpc3RlbmVyID09PSB1bmRlZmluZWQpIHJldHVybiBbXTtcbiAgICBpZiAodHlwZW9mIGV2bGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHJldHVybiB1bndyYXAgPyBbXG4gICAgICAgIGV2bGlzdGVuZXIubGlzdGVuZXIgfHwgZXZsaXN0ZW5lclxuICAgIF0gOiBbXG4gICAgICAgIGV2bGlzdGVuZXJcbiAgICBdO1xuICAgIHJldHVybiB1bndyYXAgPyB1bndyYXBMaXN0ZW5lcnMoZXZsaXN0ZW5lcikgOiBhcnJheUNsb25lKGV2bGlzdGVuZXIsIGV2bGlzdGVuZXIubGVuZ3RoKTtcbn1cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24gbGlzdGVuZXJzKHR5cGUpIHtcbiAgICByZXR1cm4gX2xpc3RlbmVycyh0aGlzLCB0eXBlLCB0cnVlKTtcbn07XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnJhd0xpc3RlbmVycyA9IGZ1bmN0aW9uIHJhd0xpc3RlbmVycyh0eXBlKSB7XG4gICAgcmV0dXJuIF9saXN0ZW5lcnModGhpcywgdHlwZSwgZmFsc2UpO1xufTtcbkV2ZW50RW1pdHRlci5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24oZW1pdHRlciwgdHlwZSkge1xuICAgIGlmICh0eXBlb2YgZW1pdHRlci5saXN0ZW5lckNvdW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBlbWl0dGVyLmxpc3RlbmVyQ291bnQodHlwZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGxpc3RlbmVyQ291bnQuY2FsbChlbWl0dGVyLCB0eXBlKTtcbiAgICB9XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lckNvdW50ID0gbGlzdGVuZXJDb3VudDtcbmZ1bmN0aW9uIGxpc3RlbmVyQ291bnQodHlwZSkge1xuICAgIHZhciBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhciBldmxpc3RlbmVyID0gZXZlbnRzW3R5cGVdO1xuICAgICAgICBpZiAodHlwZW9mIGV2bGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9IGVsc2UgaWYgKGV2bGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGV2bGlzdGVuZXIubGVuZ3RoO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5ldmVudE5hbWVzID0gZnVuY3Rpb24gZXZlbnROYW1lcygpIHtcbiAgICByZXR1cm4gdGhpcy5fZXZlbnRzQ291bnQgPiAwID8gUmVmbGVjdE93bktleXModGhpcy5fZXZlbnRzKSA6IFtdO1xufTtcbmZ1bmN0aW9uIGFycmF5Q2xvbmUoYXJyLCBuKSB7XG4gICAgdmFyIGNvcHkgPSBuZXcgQXJyYXkobik7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IG47ICsraSljb3B5W2ldID0gYXJyW2ldO1xuICAgIHJldHVybiBjb3B5O1xufVxuZnVuY3Rpb24gc3BsaWNlT25lKGxpc3QsIGluZGV4KSB7XG4gICAgZm9yKDsgaW5kZXggKyAxIDwgbGlzdC5sZW5ndGg7IGluZGV4KyspbGlzdFtpbmRleF0gPSBsaXN0W2luZGV4ICsgMV07XG4gICAgbGlzdC5wb3AoKTtcbn1cbmZ1bmN0aW9uIHVud3JhcExpc3RlbmVycyhhcnIpIHtcbiAgICB2YXIgcmV0ID0gbmV3IEFycmF5KGFyci5sZW5ndGgpO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCByZXQubGVuZ3RoOyArK2kpe1xuICAgICAgICByZXRbaV0gPSBhcnJbaV0ubGlzdGVuZXIgfHwgYXJyW2ldO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufVxuZnVuY3Rpb24gb25jZShlbWl0dGVyLCBuYW1lKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBlcnJvckxpc3RlbmVyKGVycikge1xuICAgICAgICAgICAgZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihuYW1lLCByZXNvbHZlcik7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZXNvbHZlcigpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZW1pdHRlci5yZW1vdmVMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgZXJyb3JMaXN0ZW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNvbHZlKFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKSk7XG4gICAgICAgIH1cbiAgICAgICAgO1xuICAgICAgICBldmVudFRhcmdldEFnbm9zdGljQWRkTGlzdGVuZXIoZW1pdHRlciwgbmFtZSwgcmVzb2x2ZXIsIHtcbiAgICAgICAgICAgIG9uY2U6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChuYW1lICE9PSAnZXJyb3InKSB7XG4gICAgICAgICAgICBhZGRFcnJvckhhbmRsZXJJZkV2ZW50RW1pdHRlcihlbWl0dGVyLCBlcnJvckxpc3RlbmVyLCB7XG4gICAgICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGFkZEVycm9ySGFuZGxlcklmRXZlbnRFbWl0dGVyKGVtaXR0ZXIsIGhhbmRsZXIsIGZsYWdzKSB7XG4gICAgaWYgKHR5cGVvZiBlbWl0dGVyLm9uID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGV2ZW50VGFyZ2V0QWdub3N0aWNBZGRMaXN0ZW5lcihlbWl0dGVyLCAnZXJyb3InLCBoYW5kbGVyLCBmbGFncyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXZlbnRUYXJnZXRBZ25vc3RpY0FkZExpc3RlbmVyKGVtaXR0ZXIsIG5hbWUsIGxpc3RlbmVyLCBmbGFncykge1xuICAgIGlmICh0eXBlb2YgZW1pdHRlci5vbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBpZiAoZmxhZ3Mub25jZSkge1xuICAgICAgICAgICAgZW1pdHRlci5vbmNlKG5hbWUsIGxpc3RlbmVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVtaXR0ZXIub24obmFtZSwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZW1pdHRlci5hZGRFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIEV2ZW50VGFyZ2V0IGRvZXMgbm90IGhhdmUgYGVycm9yYCBldmVudCBzZW1hbnRpY3MgbGlrZSBOb2RlXG4gICAgICAgIC8vIEV2ZW50RW1pdHRlcnMsIHdlIGRvIG5vdCBsaXN0ZW4gZm9yIGBlcnJvcmAgZXZlbnRzIGhlcmUuXG4gICAgICAgIGVtaXR0ZXIuYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBmdW5jdGlvbiB3cmFwTGlzdGVuZXIoYXJnKSB7XG4gICAgICAgICAgICAvLyBJRSBkb2VzIG5vdCBoYXZlIGJ1aWx0aW4gYHsgb25jZTogdHJ1ZSB9YCBzdXBwb3J0IHNvIHdlXG4gICAgICAgICAgICAvLyBoYXZlIHRvIGRvIGl0IG1hbnVhbGx5LlxuICAgICAgICAgICAgaWYgKGZsYWdzLm9uY2UpIHtcbiAgICAgICAgICAgICAgICBlbWl0dGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIobmFtZSwgd3JhcExpc3RlbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxpc3RlbmVyKGFyZyk7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBcImVtaXR0ZXJcIiBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGUgRXZlbnRFbWl0dGVyLiBSZWNlaXZlZCB0eXBlICcgKyB0eXBlb2YgZW1pdHRlcik7XG4gICAgfVxufVxuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9zaGFsbG93ZXF1YWwvaW5kZXguanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9zaGFsbG93ZXF1YWwvaW5kZXguanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChtb2R1bGUpIHtcbi8vXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNoYWxsb3dFcXVhbChvYmpBLCBvYmpCLCBjb21wYXJlLCBjb21wYXJlQ29udGV4dCkge1xuICAgIHZhciByZXQgPSBjb21wYXJlID8gY29tcGFyZS5jYWxsKGNvbXBhcmVDb250ZXh0LCBvYmpBLCBvYmpCKSA6IHZvaWQgMDtcbiAgICBpZiAocmV0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgcmV0dXJuICEhcmV0O1xuICAgIH1cbiAgICBpZiAob2JqQSA9PT0gb2JqQikge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvYmpBICE9PSBcIm9iamVjdFwiIHx8ICFvYmpBIHx8IHR5cGVvZiBvYmpCICE9PSBcIm9iamVjdFwiIHx8ICFvYmpCKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGtleXNBID0gT2JqZWN0LmtleXMob2JqQSk7XG4gICAgdmFyIGtleXNCID0gT2JqZWN0LmtleXMob2JqQik7XG4gICAgaWYgKGtleXNBLmxlbmd0aCAhPT0ga2V5c0IubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGJIYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuYmluZChvYmpCKTtcbiAgICAvLyBUZXN0IGZvciBBJ3Mga2V5cyBkaWZmZXJlbnQgZnJvbSBCLlxuICAgIGZvcih2YXIgaWR4ID0gMDsgaWR4IDwga2V5c0EubGVuZ3RoOyBpZHgrKyl7XG4gICAgICAgIHZhciBrZXkgPSBrZXlzQVtpZHhdO1xuICAgICAgICBpZiAoIWJIYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZhbHVlQSA9IG9iakFba2V5XTtcbiAgICAgICAgdmFyIHZhbHVlQiA9IG9iakJba2V5XTtcbiAgICAgICAgcmV0ID0gY29tcGFyZSA/IGNvbXBhcmUuY2FsbChjb21wYXJlQ29udGV4dCwgdmFsdWVBLCB2YWx1ZUIsIGtleSkgOiB2b2lkIDA7XG4gICAgICAgIGlmIChyZXQgPT09IGZhbHNlIHx8IHJldCA9PT0gdm9pZCAwICYmIHZhbHVlQSAhPT0gdmFsdWVCKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5cbn0pLFxuXCJAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9yc3BhY2suanMhPSFkYXRhOnRleHQvamF2YXNjcmlwdCxpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyBmcm9tIFxcXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9tb3ZpZXMvbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL21vdmllcy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzXFxcIjtpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18gZnJvbSBcXFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvbW92aWVzL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qc1xcXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyA9IFtfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXygpLCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzFfXygpXTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fID0ge307Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fID0gXFxcIm1vdmllc1xcXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fID0gXFxcImxvYWRlZC1maXJzdFxcXCI7aWYoKF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhfHxfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkmJl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbil7dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyO2NvbnN0IG92ZXJyaWRlPShvYmosa2V5LHZhbHVlKT0+e2lmKCFvYmopcmV0dXJuO2lmKG9ialtrZXldKW9ialtrZXldPXZhbHVlfTtjb25zdCBtZXJnZT0ob2JqLGtleSxmbik9Pntjb25zdCB2YWx1ZT1mbigpO2lmKEFycmF5LmlzQXJyYXkodmFsdWUpKXt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPVtdO29ialtrZXldLnB1c2goLi4udmFsdWUpfWVsc2UgaWYodHlwZW9mIHZhbHVlPT09XFxcIm9iamVjdFxcXCImJnZhbHVlIT09bnVsbCl7dmFyIF9vYmoxLF9rZXkxO3ZhciBfMTsoXzE9KF9vYmoxPW9iailbX2tleTE9a2V5XSkhPT1udWxsJiZfMSE9PXZvaWQgMD9fMTpfb2JqMVtfa2V5MV09e307T2JqZWN0LmFzc2lnbihvYmpba2V5XSx2YWx1ZSl9fTtjb25zdCBlYXJseT0ob2JqLGtleSxpbml0aWFsKT0+e3ZhciBfb2JqLF9rZXk7dmFyIF87KF89KF9vYmo9b2JqKVtfa2V5PWtleV0pIT09bnVsbCYmXyE9PXZvaWQgMD9fOl9vYmpbX2tleV09aW5pdGlhbCgpfTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZztjb25zdCBpbml0aWFsaXplU2hhcmluZ1Njb3BlVG9Jbml0RGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCBjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc6e307Y29uc3QgY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcz17fTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcz1bXTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRUb2tlbnM9e307Y29uc3QgY29udGFpbmVyU2hhcmVTY29wZT0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLnNoYXJlU2NvcGU7Zm9yKGNvbnN0IGtleSBpbiBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fKXtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb25ba2V5XT1fX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fW2tleV19ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nXFxcIiwoKT0+e2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nKSl7Y29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1ttb2R1bGVJZF09e2dldHRlcjpkYXRhLmZhbGxiYWNrLHNoYXJlSW5mbzp7c2hhcmVDb25maWc6e2ZpeGVkRGVwZW5kZW5jaWVzOmZhbHNlLHJlcXVpcmVkVmVyc2lvbjpkYXRhLnJlcXVpcmVkVmVyc2lvbixzdHJpY3RWZXJzaW9uOmRhdGEuc3RyaWN0VmVyc2lvbixzaW5nbGV0b246ZGF0YS5zaW5nbGV0b24sZWFnZXI6ZGF0YS5lYWdlcn0sc2NvcGU6W2RhdGEuc2hhcmVTY29wZV19LHNoYXJlS2V5OmRhdGEuc2hhcmVLZXl9fXJldHVybiBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJpbml0T3B0aW9uc1xcXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwibmFtZVxcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJzaGFyZVN0cmF0ZWd5XFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXFxcInNoYXJlZFxcXCIsKCk9Pntjb25zdCBzaGFyZWQ9e307Zm9yKGxldFtzY29wZSxzdGFnZXNdb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nKSl7Zm9yKGxldCBzdGFnZSBvZiBzdGFnZXMpe2lmKHR5cGVvZiBzdGFnZT09PVxcXCJvYmplY3RcXFwiJiZzdGFnZSE9PW51bGwpe2NvbnN0e25hbWUsdmVyc2lvbixmYWN0b3J5LGVhZ2VyLHNpbmdsZXRvbixyZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbn09c3RhZ2U7Y29uc3Qgc2hhcmVDb25maWc9e307Y29uc3QgaXNWYWxpZFZhbHVlPWZ1bmN0aW9uKHZhbCl7cmV0dXJuIHR5cGVvZiB2YWwhPT1cXFwidW5kZWZpbmVkXFxcIn07aWYoaXNWYWxpZFZhbHVlKHNpbmdsZXRvbikpe3NoYXJlQ29uZmlnLnNpbmdsZXRvbj1zaW5nbGV0b259aWYoaXNWYWxpZFZhbHVlKHJlcXVpcmVkVmVyc2lvbikpe3NoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbj1yZXF1aXJlZFZlcnNpb259aWYoaXNWYWxpZFZhbHVlKGVhZ2VyKSl7c2hhcmVDb25maWcuZWFnZXI9ZWFnZXJ9aWYoaXNWYWxpZFZhbHVlKHN0cmljdFZlcnNpb24pKXtzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uPXN0cmljdFZlcnNpb259Y29uc3Qgb3B0aW9ucz17dmVyc2lvbixzY29wZTpbc2NvcGVdLHNoYXJlQ29uZmlnLGdldDpmYWN0b3J5fTtpZihzaGFyZWRbbmFtZV0pe3NoYXJlZFtuYW1lXS5wdXNoKG9wdGlvbnMpfWVsc2V7c2hhcmVkW25hbWVdPVtvcHRpb25zXX19fX1yZXR1cm4gc2hhcmVkfSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKHJlbW90ZT0+cmVtb3RlLmV4dGVybmFsVHlwZT09PVxcXCJzY3JpcHRcXFwiKSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJwbHVnaW5zXFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJidW5kbGVyUnVudGltZU9wdGlvbnNcXFwiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJjaHVua01hcHBpbmdcXFwiLCgpPT5yZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1xcXCIsKCk9Pntjb25zdCByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZz17fTtmb3IobGV0W21vZHVsZUlkLGRhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtyZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ1ttb2R1bGVJZF09W2RhdGEuc2hhcmVTY29wZSxkYXRhLm5hbWUsZGF0YS5leHRlcm5hbE1vZHVsZUlkLGRhdGEucmVtb3RlTmFtZV19cmV0dXJuIHJlbW90ZXNMb2FkaW5nSWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJ3ZWJwYWNrUmVxdWlyZVxcXCIsKCk9Pl9fd2VicGFja19yZXF1aXJlX18pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiaWRUb1JlbW90ZU1hcFxcXCIsKCk9Pntjb25zdCBpZFRvUmVtb3RlTWFwPXt9O2ZvcihsZXRbaWQscmVtb3RlRGF0YV1vZiBPYmplY3QuZW50cmllcyhyZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykpe2NvbnN0IGluZm89X19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfX1tyZW1vdGVEYXRhLnJlbW90ZU5hbWVdO2lmKGluZm8paWRUb1JlbW90ZU1hcFtpZF09aW5mb31yZXR1cm4gaWRUb1JlbW90ZU1hcH0pO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcIlNcXFwiLF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtpZihfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyl9b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLFxcXCJyZW1vdGVzXFxcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpyZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyxpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsaWRUb1JlbW90ZU1hcDpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb1JlbW90ZU1hcCx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcXFwiY29uc3VtZXNcXFwiLChjaHVua0lkLHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmNvbnN1bWVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmcsbW9kdWxlVG9IYW5kbGVyTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZyxpbnN0YWxsZWRNb2R1bGVzOmNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJJXFxcIiwobmFtZSxpbml0U2NvcGUpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuSSh7c2hhcmVTY29wZU5hbWU6bmFtZSxpbml0U2NvcGUsaW5pdFByb21pc2VzOmluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzLGluaXRUb2tlbnM6aW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcXFwiaW5pdENvbnRhaW5lclxcXCIsKHNoYXJlU2NvcGUsaW5pdFNjb3BlLHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5pdENvbnRhaW5lckVudHJ5KHtzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zLHNoYXJlU2NvcGVLZXk6Y29udGFpbmVyU2hhcmVTY29wZSx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcImdldENvbnRhaW5lclxcXCIsKG1vZHVsZTEsZ2V0U2NvcGUpPT57dmFyIG1vZHVsZU1hcD1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YS5tb2R1bGVNYXA7X193ZWJwYWNrX3JlcXVpcmVfXy5SPWdldFNjb3BlO2dldFNjb3BlPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2R1bGVNYXAsbW9kdWxlMSk/bW9kdWxlTWFwW21vZHVsZTFdKCk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKT0+e3Rocm93IG5ldyBFcnJvcignTW9kdWxlIFxcXCInK21vZHVsZTErJ1xcXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5SPXVuZGVmaW5lZDtyZXR1cm4gZ2V0U2NvcGV9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5zdGFuY2U9X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyLmluaXRpYWxDb25zdW1lcyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe3dlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX18saW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLGluaXRpYWxDb25zdW1lczpfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmd9KX19XCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIEBtb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL3JzcGFjay5qcyE9IWRhdGE6dGV4dC9qYXZhc2NyaXB0LGltcG9ydCBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fIGZyb20gXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9tb3ZpZXMvbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1wiO2ltcG9ydCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXyBmcm9tIFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvbW92aWVzL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanNcIjtpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18gZnJvbSBcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL21vdmllcy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanNcIjtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luc19fID0gW19fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fKCksIF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fKCldO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX18gPSB7fTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18gPSBcIm1vdmllc1wiO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyA9IFwibG9hZGVkLWZpcnN0XCI7aWYoKF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhfHxfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkmJl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbil7dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyO2NvbnN0IG92ZXJyaWRlPShvYmosa2V5LHZhbHVlKT0+e2lmKCFvYmopcmV0dXJuO2lmKG9ialtrZXldKW9ialtrZXldPXZhbHVlfTtjb25zdCBtZXJnZT0ob2JqLGtleSxmbik9Pntjb25zdCB2YWx1ZT1mbigpO2lmKEFycmF5LmlzQXJyYXkodmFsdWUpKXt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPVtdO29ialtrZXldLnB1c2goLi4udmFsdWUpfWVsc2UgaWYodHlwZW9mIHZhbHVlPT09XCJvYmplY3RcIiYmdmFsdWUhPT1udWxsKXt2YXIgX29iajEsX2tleTE7dmFyIF8xOyhfMT0oX29iajE9b2JqKVtfa2V5MT1rZXldKSE9PW51bGwmJl8xIT09dm9pZCAwP18xOl9vYmoxW19rZXkxXT17fTtPYmplY3QuYXNzaWduKG9ialtrZXldLHZhbHVlKX19O2NvbnN0IGVhcmx5PShvYmosa2V5LGluaXRpYWwpPT57dmFyIF9vYmosX2tleTt2YXIgXzsoXz0oX29iaj1vYmopW19rZXk9a2V5XSkhPT1udWxsJiZfIT09dm9pZCAwP186X29ialtfa2V5XT1pbml0aWFsKCl9O3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc7Y29uc3QgcmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLmNodW5rTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nOnt9O3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc7Y29uc3QgcmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExPV9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nOnt9O3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nO2NvbnN0IGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhLnNjb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nOnt9O3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO2NvbnN0IGNvbnN1bWVzTG9hZGluZ0NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nOnt9O3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZztjb25zdCBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTE9X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEubW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZzp7fTtjb25zdCBjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzPXt9O2NvbnN0IGluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzPVtdO2NvbnN0IGluaXRpYWxpemVTaGFyaW5nSW5pdFRva2Vucz17fTtjb25zdCBjb250YWluZXJTaGFyZVNjb3BlPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEuc2hhcmVTY29wZTtmb3IoY29uc3Qga2V5IGluIF9fbW9kdWxlX2ZlZGVyYXRpb25fYnVuZGxlcl9ydW50aW1lX18pe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbltrZXldPV9fbW9kdWxlX2ZlZGVyYXRpb25fYnVuZGxlcl9ydW50aW1lX19ba2V5XX1lYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sXCJjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nXCIsKCk9Pntjb25zdCBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nPXt9O2ZvcihsZXRbbW9kdWxlSWQsZGF0YV1vZiBPYmplY3QuZW50cmllcyhjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZykpe2NvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdbbW9kdWxlSWRdPXtnZXR0ZXI6ZGF0YS5mYWxsYmFjayxzaGFyZUluZm86e3NoYXJlQ29uZmlnOntmaXhlZERlcGVuZGVuY2llczpmYWxzZSxyZXF1aXJlZFZlcnNpb246ZGF0YS5yZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbjpkYXRhLnN0cmljdFZlcnNpb24sc2luZ2xldG9uOmRhdGEuc2luZ2xldG9uLGVhZ2VyOmRhdGEuZWFnZXJ9LHNjb3BlOltkYXRhLnNoYXJlU2NvcGVdfSxzaGFyZUtleTpkYXRhLnNoYXJlS2V5fX1yZXR1cm4gY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcImluaXRPcHRpb25zXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcIm5hbWVcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXCJzaGFyZVN0cmF0ZWd5XCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFwic2hhcmVkXCIsKCk9Pntjb25zdCBzaGFyZWQ9e307Zm9yKGxldFtzY29wZSxzdGFnZXNdb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nKSl7Zm9yKGxldCBzdGFnZSBvZiBzdGFnZXMpe2lmKHR5cGVvZiBzdGFnZT09PVwib2JqZWN0XCImJnN0YWdlIT09bnVsbCl7Y29uc3R7bmFtZSx2ZXJzaW9uLGZhY3RvcnksZWFnZXIsc2luZ2xldG9uLHJlcXVpcmVkVmVyc2lvbixzdHJpY3RWZXJzaW9ufT1zdGFnZTtjb25zdCBzaGFyZUNvbmZpZz17fTtjb25zdCBpc1ZhbGlkVmFsdWU9ZnVuY3Rpb24odmFsKXtyZXR1cm4gdHlwZW9mIHZhbCE9PVwidW5kZWZpbmVkXCJ9O2lmKGlzVmFsaWRWYWx1ZShzaW5nbGV0b24pKXtzaGFyZUNvbmZpZy5zaW5nbGV0b249c2luZ2xldG9ufWlmKGlzVmFsaWRWYWx1ZShyZXF1aXJlZFZlcnNpb24pKXtzaGFyZUNvbmZpZy5yZXF1aXJlZFZlcnNpb249cmVxdWlyZWRWZXJzaW9ufWlmKGlzVmFsaWRWYWx1ZShlYWdlcikpe3NoYXJlQ29uZmlnLmVhZ2VyPWVhZ2VyfWlmKGlzVmFsaWRWYWx1ZShzdHJpY3RWZXJzaW9uKSl7c2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbj1zdHJpY3RWZXJzaW9ufWNvbnN0IG9wdGlvbnM9e3ZlcnNpb24sc2NvcGU6W3Njb3BlXSxzaGFyZUNvbmZpZyxnZXQ6ZmFjdG9yeX07aWYoc2hhcmVkW25hbWVdKXtzaGFyZWRbbmFtZV0ucHVzaChvcHRpb25zKX1lbHNle3NoYXJlZFtuYW1lXT1bb3B0aW9uc119fX19cmV0dXJuIHNoYXJlZH0pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcInJlbW90ZXNcIiwoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKHJlbW90ZT0+cmVtb3RlLmV4dGVybmFsVHlwZT09PVwic2NyaXB0XCIpKTttZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXCJwbHVnaW5zXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcImJ1bmRsZXJSdW50aW1lT3B0aW9uc1wiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLFwicmVtb3Rlc1wiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsXCJjaHVua01hcHBpbmdcIiwoKT0+cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcImlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nXCIsKCk9Pntjb25zdCByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZz17fTtmb3IobGV0W21vZHVsZUlkLGRhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtyZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ1ttb2R1bGVJZF09W2RhdGEuc2hhcmVTY29wZSxkYXRhLm5hbWUsZGF0YS5leHRlcm5hbE1vZHVsZUlkLGRhdGEucmVtb3RlTmFtZV19cmV0dXJuIHJlbW90ZXNMb2FkaW5nSWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFwid2VicGFja1JlcXVpcmVcIiwoKT0+X193ZWJwYWNrX3JlcXVpcmVfXyk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFwiaWRUb1JlbW90ZU1hcFwiLCgpPT57Y29uc3QgaWRUb1JlbW90ZU1hcD17fTtmb3IobGV0W2lkLHJlbW90ZURhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtjb25zdCBpbmZvPV9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX19bcmVtb3RlRGF0YS5yZW1vdGVOYW1lXTtpZihpbmZvKWlkVG9SZW1vdGVNYXBbaWRdPWluZm99cmV0dXJuIGlkVG9SZW1vdGVNYXB9KTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFwiU1wiLF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtpZihfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyl9b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLFwicmVtb3Rlc1wiLChjaHVua0lkLHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLnJlbW90ZXMoe2NodW5rSWQscHJvbWlzZXMsY2h1bmtNYXBwaW5nOnJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nLGlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3Rlcy5pZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZyxpZFRvUmVtb3RlTWFwOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3Rlcy5pZFRvUmVtb3RlTWFwLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLFwiY29uc3VtZXNcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5jb25zdW1lcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6Y29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmcsaW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcIklcIiwobmFtZSxpbml0U2NvcGUpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuSSh7c2hhcmVTY29wZU5hbWU6bmFtZSxpbml0U2NvcGUsaW5pdFByb21pc2VzOmluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzLGluaXRUb2tlbnM6aW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcImluaXRDb250YWluZXJcIiwoc2hhcmVTY29wZSxpbml0U2NvcGUscmVtb3RlRW50cnlJbml0T3B0aW9ucyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbml0Q29udGFpbmVyRW50cnkoe3NoYXJlU2NvcGUsaW5pdFNjb3BlLHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsc2hhcmVTY29wZUtleTpjb250YWluZXJTaGFyZVNjb3BlLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcImdldENvbnRhaW5lclwiLChtb2R1bGUxLGdldFNjb3BlKT0+e3ZhciBtb2R1bGVNYXA9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEubW9kdWxlTWFwO19fd2VicGFja19yZXF1aXJlX18uUj1nZXRTY29wZTtnZXRTY29wZT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kdWxlTWFwLG1vZHVsZTEpP21vZHVsZU1hcFttb2R1bGUxXSgpOlByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCk9Pnt0aHJvdyBuZXcgRXJyb3IoJ01vZHVsZSBcIicrbW9kdWxlMSsnXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5SPXVuZGVmaW5lZDtyZXR1cm4gZ2V0U2NvcGV9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5zdGFuY2U9X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyLmluaXRpYWxDb25zdW1lcyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe3dlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX18saW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLGluaXRpYWxDb25zdW1lczpfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmd9KX19ICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbnZhciBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janNcIik7XG52YXIgX3NsaWNlZF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19zbGljZWRfdG9fYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19jb25zdW1hYmxlX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2NvbnN1bWFibGVfYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqc1wiKTtcbnZhciBfaW5kZXhjanMgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1wiKSk7XG52YXIgX3Jlc29sdmVycGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanNcIikpO1xudmFyIF9jb3JlcGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzXCIpKTtcbnZhciBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luc19fID0gW1xuICAgICgwLCBfcmVzb2x2ZXJwbHVnaW4uZGVmYXVsdCkoKSxcbiAgICAoMCwgX2NvcmVwbHVnaW4uZGVmYXVsdCkoKVxuXTtcbnZhciBfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fID0ge307XG52YXIgX19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fID0gXCJtb3ZpZXNcIjtcbnZhciBfX21vZHVsZV9mZWRlcmF0aW9uX3NoYXJlX3N0cmF0ZWd5X18gPSBcImxvYWRlZC1maXJzdFwiO1xuaWYgKChfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YSB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkgJiYgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uKSB7XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLCBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEsIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEsIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEsIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyO1xuICAgIHZhciBvdmVycmlkZSA9IChvYmosIGtleSwgdmFsdWUpPT57XG4gICAgICAgIGlmICghb2JqKSByZXR1cm47XG4gICAgICAgIGlmIChvYmpba2V5XSkgb2JqW2tleV0gPSB2YWx1ZTtcbiAgICB9O1xuICAgIHZhciBtZXJnZSA9IChvYmosIGtleSwgZm4pPT57XG4gICAgICAgIHZhciB2YWx1ZSA9IGZuKCk7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgdmFyIF9vYmpfa2V5O1xuICAgICAgICAgICAgdmFyIF9vYmosIF9rZXk7XG4gICAgICAgICAgICB2YXIgXztcbiAgICAgICAgICAgIChfID0gKF9vYmogPSBvYmopW19rZXkgPSBrZXldKSAhPT0gbnVsbCAmJiBfICE9PSB2b2lkIDAgPyBfIDogX29ialtfa2V5XSA9IFtdO1xuICAgICAgICAgICAgKF9vYmpfa2V5ID0gb2JqW2tleV0pLnB1c2guYXBwbHkoX29ial9rZXksIF90b19jb25zdW1hYmxlX2FycmF5Ll8odmFsdWUpKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBfb2JqMSwgX2tleTE7XG4gICAgICAgICAgICB2YXIgXzE7XG4gICAgICAgICAgICAoXzEgPSAoX29iajEgPSBvYmopW19rZXkxID0ga2V5XSkgIT09IG51bGwgJiYgXzEgIT09IHZvaWQgMCA/IF8xIDogX29iajFbX2tleTFdID0ge307XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKG9ialtrZXldLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBlYXJseSA9IChvYmosIGtleSwgaW5pdGlhbCk9PntcbiAgICAgICAgdmFyIF9vYmosIF9rZXk7XG4gICAgICAgIHZhciBfO1xuICAgICAgICAoXyA9IChfb2JqID0gb2JqKVtfa2V5ID0ga2V5XSkgIT09IG51bGwgJiYgXyAhPT0gdm9pZCAwID8gXyA6IF9vYmpbX2tleV0gPSBpbml0aWFsKCk7XG4gICAgfTtcbiAgICB2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO1xuICAgIHZhciByZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLmNodW5rTWFwcGluZykgIT09IG51bGwgJiYgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmcgOiB7fTtcbiAgICB2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nO1xuICAgIHZhciByZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExID0gX193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykgIT09IG51bGwgJiYgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcgOiB7fTtcbiAgICB2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZztcbiAgICB2YXIgaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhLnNjb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmcgIT09IHZvaWQgMCA/IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmcgOiB7fTtcbiAgICB2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztcbiAgICB2YXIgY29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmcgIT09IHZvaWQgMCA/IF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmcgOiB7fTtcbiAgICB2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc7XG4gICAgdmFyIGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEubW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZykgIT09IG51bGwgJiYgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcgIT09IHZvaWQgMCA/IF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nIDoge307XG4gICAgdmFyIGNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMgPSB7fTtcbiAgICB2YXIgaW5pdGlhbGl6ZVNoYXJpbmdJbml0UHJvbWlzZXMgPSBbXTtcbiAgICB2YXIgaW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zID0ge307XG4gICAgdmFyIGNvbnRhaW5lclNoYXJlU2NvcGUgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLnNoYXJlU2NvcGU7XG4gICAgZm9yKHZhciBrZXkgaW4gX2luZGV4Y2pzLmRlZmF1bHQpe1xuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb25ba2V5XSA9IF9pbmRleGNqcy5kZWZhdWx0W2tleV07XG4gICAgfVxuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbiwgXCJjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nXCIsICgpPT57XG4gICAgICAgIHZhciBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nID0ge307XG4gICAgICAgIGZvciAodmFyIHJlZiBvZiBPYmplY3QuZW50cmllcyhjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZykpe1xuICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgbW9kdWxlSWQgPSBfcmVmWzBdLCBkYXRhID0gX3JlZlsxXTtcbiAgICAgICAgICAgIGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdbbW9kdWxlSWRdID0ge1xuICAgICAgICAgICAgICAgIGdldHRlcjogZGF0YS5mYWxsYmFjayxcbiAgICAgICAgICAgICAgICBzaGFyZUluZm86IHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVDb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpeGVkRGVwZW5kZW5jaWVzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkVmVyc2lvbjogZGF0YS5yZXF1aXJlZFZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpY3RWZXJzaW9uOiBkYXRhLnN0cmljdFZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBzaW5nbGV0b246IGRhdGEuc2luZ2xldG9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWFnZXI6IGRhdGEuZWFnZXJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc2hhcmVTY29wZVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzaGFyZUtleTogZGF0YS5zaGFyZUtleVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZztcbiAgICB9KTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sIFwiaW5pdE9wdGlvbnNcIiwgKCk9Pih7fSkpO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucywgXCJuYW1lXCIsICgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18pO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucywgXCJzaGFyZVN0cmF0ZWd5XCIsICgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX3NoYXJlX3N0cmF0ZWd5X18pO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucywgXCJzaGFyZWRcIiwgKCk9PntcbiAgICAgICAgdmFyIHNoYXJlZCA9IHt9O1xuICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nKSl7XG4gICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDIpLCBzY29wZSA9IF9yZWZbMF0sIHN0YWdlcyA9IF9yZWZbMV07XG4gICAgICAgICAgICBmb3IgKHZhciBzdGFnZSBvZiBzdGFnZXMpe1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhZ2UgPT09IFwib2JqZWN0XCIgJiYgc3RhZ2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBzdGFnZS5uYW1lLCB2ZXJzaW9uID0gc3RhZ2UudmVyc2lvbiwgZmFjdG9yeSA9IHN0YWdlLmZhY3RvcnksIGVhZ2VyID0gc3RhZ2UuZWFnZXIsIHNpbmdsZXRvbiA9IHN0YWdlLnNpbmdsZXRvbiwgcmVxdWlyZWRWZXJzaW9uID0gc3RhZ2UucmVxdWlyZWRWZXJzaW9uLCBzdHJpY3RWZXJzaW9uID0gc3RhZ2Uuc3RyaWN0VmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlQ29uZmlnID0ge307XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc1ZhbGlkVmFsdWUgPSBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsICE9PSBcInVuZGVmaW5lZFwiO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFZhbHVlKHNpbmdsZXRvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnLnNpbmdsZXRvbiA9IHNpbmdsZXRvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFZhbHVlKHJlcXVpcmVkVmVyc2lvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbiA9IHJlcXVpcmVkVmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFZhbHVlKGVhZ2VyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVDb25maWcuZWFnZXIgPSBlYWdlcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFZhbHVlKHN0cmljdFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uID0gc3RyaWN0VmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVDb25maWcsXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXQ6IGZhY3RvcnlcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNoYXJlZFtuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkW25hbWVdLnB1c2gob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWRbbmFtZV0gPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hhcmVkO1xuICAgIH0pO1xuICAgIG1lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucywgXCJyZW1vdGVzXCIsICgpPT5PYmplY3QudmFsdWVzKF9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX18pLmZsYXQoKS5maWx0ZXIoKHJlbW90ZSk9PnJlbW90ZS5leHRlcm5hbFR5cGUgPT09IFwic2NyaXB0XCIpKTtcbiAgICBtZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwicGx1Z2luc1wiLCAoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLCBcImJ1bmRsZXJSdW50aW1lT3B0aW9uc1wiLCAoKT0+KHt9KSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucywgXCJyZW1vdGVzXCIsICgpPT4oe30pKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsIFwiY2h1bmtNYXBwaW5nXCIsICgpPT5yZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLCBcImlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nXCIsICgpPT57XG4gICAgICAgIHZhciByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZyA9IHt9O1xuICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtcbiAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMiksIG1vZHVsZUlkID0gX3JlZlswXSwgZGF0YSA9IF9yZWZbMV07XG4gICAgICAgICAgICByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ1ttb2R1bGVJZF0gPSBbXG4gICAgICAgICAgICAgICAgZGF0YS5zaGFyZVNjb3BlLFxuICAgICAgICAgICAgICAgIGRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICBkYXRhLmV4dGVybmFsTW9kdWxlSWQsXG4gICAgICAgICAgICAgICAgZGF0YS5yZW1vdGVOYW1lXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZztcbiAgICB9KTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsIFwid2VicGFja1JlcXVpcmVcIiwgKCk9Pl9fd2VicGFja19yZXF1aXJlX18pO1xuICAgIG1lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcywgXCJpZFRvUmVtb3RlTWFwXCIsICgpPT57XG4gICAgICAgIHZhciBpZFRvUmVtb3RlTWFwID0ge307XG4gICAgICAgIGZvciAodmFyIHJlZiBvZiBPYmplY3QuZW50cmllcyhyZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykpe1xuICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgaWQgPSBfcmVmWzBdLCByZW1vdGVEYXRhID0gX3JlZlsxXTtcbiAgICAgICAgICAgIHZhciBpbmZvID0gX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfX1tyZW1vdGVEYXRhLnJlbW90ZU5hbWVdO1xuICAgICAgICAgICAgaWYgKGluZm8pIGlkVG9SZW1vdGVNYXBbaWRdID0gaW5mbztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaWRUb1JlbW90ZU1hcDtcbiAgICB9KTtcbiAgICBvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLCBcIlNcIiwgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLlMpO1xuICAgIGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCkge1xuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcChfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbiAgICB9XG4gICAgb3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLCBcInJlbW90ZXNcIiwgKGNodW5rSWQsIHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLnJlbW90ZXMoe1xuICAgICAgICAgICAgY2h1bmtJZCxcbiAgICAgICAgICAgIHByb21pc2VzLFxuICAgICAgICAgICAgY2h1bmtNYXBwaW5nOiByZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyxcbiAgICAgICAgICAgIGlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsXG4gICAgICAgICAgICBpZFRvUmVtb3RlTWFwOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb1JlbW90ZU1hcCxcbiAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlOiBfX3dlYnBhY2tfcmVxdWlyZV9fXG4gICAgICAgIH0pKTtcbiAgICBvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLmYsIFwiY29uc3VtZXNcIiwgKGNodW5rSWQsIHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmNvbnN1bWVzKHtcbiAgICAgICAgICAgIGNodW5rSWQsXG4gICAgICAgICAgICBwcm9taXNlcyxcbiAgICAgICAgICAgIGNodW5rTWFwcGluZzogY29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nLFxuICAgICAgICAgICAgbW9kdWxlVG9IYW5kbGVyTWFwcGluZzogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmcsXG4gICAgICAgICAgICBpbnN0YWxsZWRNb2R1bGVzOiBjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLFxuICAgICAgICAgICAgd2VicGFja1JlcXVpcmU6IF9fd2VicGFja19yZXF1aXJlX19cbiAgICAgICAgfSkpO1xuICAgIG92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sIFwiSVwiLCAobmFtZSwgaW5pdFNjb3BlKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLkkoe1xuICAgICAgICAgICAgc2hhcmVTY29wZU5hbWU6IG5hbWUsXG4gICAgICAgICAgICBpbml0U2NvcGUsXG4gICAgICAgICAgICBpbml0UHJvbWlzZXM6IGluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzLFxuICAgICAgICAgICAgaW5pdFRva2VuczogaW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zLFxuICAgICAgICAgICAgd2VicGFja1JlcXVpcmU6IF9fd2VicGFja19yZXF1aXJlX19cbiAgICAgICAgfSkpO1xuICAgIG92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sIFwiaW5pdENvbnRhaW5lclwiLCAoc2hhcmVTY29wZSwgaW5pdFNjb3BlLCByZW1vdGVFbnRyeUluaXRPcHRpb25zKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluaXRDb250YWluZXJFbnRyeSh7XG4gICAgICAgICAgICBzaGFyZVNjb3BlLFxuICAgICAgICAgICAgaW5pdFNjb3BlLFxuICAgICAgICAgICAgcmVtb3RlRW50cnlJbml0T3B0aW9ucyxcbiAgICAgICAgICAgIHNoYXJlU2NvcGVLZXk6IGNvbnRhaW5lclNoYXJlU2NvcGUsXG4gICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZTogX193ZWJwYWNrX3JlcXVpcmVfX1xuICAgICAgICB9KSk7XG4gICAgb3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXywgXCJnZXRDb250YWluZXJcIiwgKG1vZHVsZTEsIGdldFNjb3BlKT0+e1xuICAgICAgICB2YXIgbW9kdWxlTWFwID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEubW9kdWxlTWFwO1xuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLlIgPSBnZXRTY29wZTtcbiAgICAgICAgZ2V0U2NvcGUgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kdWxlTWFwLCBtb2R1bGUxKSA/IG1vZHVsZU1hcFttb2R1bGUxXSgpIDogUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKT0+e1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNb2R1bGUgXCInICsgbW9kdWxlMSArICdcIiBkb2VzIG5vdCBleGlzdCBpbiBjb250YWluZXIuJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLlIgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiBnZXRTY29wZTtcbiAgICB9KTtcbiAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5zdGFuY2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24ucnVudGltZS5pbml0KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyk7XG4gICAgaWYgKChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyID0gX193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyLmluaXRpYWxDb25zdW1lcykge1xuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5zdGFsbEluaXRpYWxDb25zdW1lcyh7XG4gICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZTogX193ZWJwYWNrX3JlcXVpcmVfXyxcbiAgICAgICAgICAgIGluc3RhbGxlZE1vZHVsZXM6IGNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMsXG4gICAgICAgICAgICBpbml0aWFsQ29uc3VtZXM6IF9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YS5pbml0aWFsQ29uc3VtZXMsXG4gICAgICAgICAgICBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cblxufSksXG5cIndlYnBhY2svY29udGFpbmVyL2VudHJ5L21vdmllc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIGNvbnRhaW5lciBlbnRyeSAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5kKGV4cG9ydHMsIHtcblx0Z2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZ2V0Q29udGFpbmVyOyB9LFxuXHRpbml0OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uaW5pdENvbnRhaW5lcjsgfVxufSk7XG5cbn0pLFxuXG59KTtcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbi8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxudmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5pZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcbnJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcbn1cbi8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG52YXIgbW9kdWxlID0gKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5pZDogbW9kdWxlSWQsXG5sb2FkZWQ6IGZhbHNlLFxuZXhwb3J0czoge31cbn0pO1xuLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5fX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxubW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxucmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuXG59XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBfX3dlYnBhY2tfbW9kdWxlc19fO1xuXG4vLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuX193ZWJwYWNrX3JlcXVpcmVfXy5jID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fO1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLy8gbW9kdWxlX2ZlZGVyYXRpb24vcnVudGltZVxuIWZ1bmN0aW9uKCkge1xuXG5pZighX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uKXtcbiAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24gPSB7XG4gICAgICAgIFxuY2h1bmtNYXRjaGVyOiBmdW5jdGlvbihjaHVua0lkKSB7XG4gICAgcmV0dXJuICEvXihcXC13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0XFwtXyg2ODMwfDgzMzcpfHdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RcXC1uYXRpdmVfKGFzc2V0c1xcLXJlZ2lzdHJ5XyhwYXRoXFwtc3VwcG9ydF9yZWFjdFxcLW5hdGl2ZV9hc3NldHNcXC0zNWYxNTR8cmVnaXN0cnlfcmVhY3RcXC1uYXRpdmVfYXNzZXRzXFwtcmVnXFwtNWQxZWFlKXxMaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxcXC05NmE2OTZ8bm9ybWFsaXplXFwtY29sb3JzX3JlYWN0XFwtbmF0aXZlX25vcm1hbGl6ZVxcLWNvbG9yc3xyZWFjdFxcLW5hdGl2ZXxzcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcXC1mZDMwOTB8dmlydHVhbGl6ZWRcXC1saXN0c19yZWFjdFxcLW5hdGl2ZV92aXJ0dWFsaXplZFxcLWxpc3RzXFwtZjYxMzc5KSkkLy50ZXN0KGNodW5rSWQpO1xufSxcbnJvb3RPdXRwdXREaXI6IFwiXCIsXG5cbiAgICB9O1xufVxuXG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvZGVmaW5lX3Byb3BlcnR5X2dldHRlcnNcbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuICAgICAgICBpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2Vuc3VyZV9jaHVua1xuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5mID0ge307XG4vLyBUaGlzIGZpbGUgY29udGFpbnMgb25seSB0aGUgZW50cnkgY2h1bmsuXG4vLyBUaGUgY2h1bmsgbG9hZGluZyBmdW5jdGlvbiBmb3IgYWRkaXRpb25hbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uZSA9IGZ1bmN0aW9uKGNodW5rSWQpIHtcblx0cmV0dXJuIFByb21pc2UuYWxsKFxuXHRcdE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uZikucmVkdWNlKGZ1bmN0aW9uKHByb21pc2VzLCBrZXkpIHtcblx0XHRcdF9fd2VicGFja19yZXF1aXJlX18uZltrZXldKGNodW5rSWQsIHByb21pc2VzKTtcblx0XHRcdHJldHVybiBwcm9taXNlcztcblx0XHR9LCBbXSlcblx0KTtcbn07XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvZ2V0IGphdmFzY3JpcHQgY2h1bmsgZmlsZW5hbWVcbiFmdW5jdGlvbigpIHtcbi8vIFRoaXMgZnVuY3Rpb24gYWxsb3cgdG8gcmVmZXJlbmNlIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy51ID0gZnVuY3Rpb24oY2h1bmtJZCkge1xuICAvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgbm90IGJhc2VkIG9uIHRlbXBsYXRlXG4gIFxuICAvLyByZXR1cm4gdXJsIGZvciBmaWxlbmFtZXMgYmFzZWQgb24gdGVtcGxhdGVcbiAgcmV0dXJuIFwiXCIgKyBjaHVua0lkICsgXCIuY2h1bmsuYnVuZGxlXCJcbn1cbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9nbG9iYWxcbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvaGFzX293bl9wcm9wZXJ0eVxuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfVxufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2xvYWRfc2NyaXB0XG4hZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIGxvYWRTY3JpcHRIYW5kbGVyKG5hbWUsIGNhbGxlciwgZG9uZSwgcmVmZXJlbmNlVXJsKSB7XG4gICAgaWYgKF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyKSB7XG4gICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlci5sb2FkU2NyaXB0KG5hbWUsIGNhbGxlciwgX193ZWJwYWNrX3JlcXVpcmVfXywgcmVmZXJlbmNlVXJsKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZXBhY2tSdW50aW1lXSBMb2FkaW5nIHNjcmlwdCBmYWlsZWQ6JywgcmVhc29uKTtcbiAgICAgICAgZG9uZSh7XG4gICAgICAgICAgdHlwZTogJ2V4ZWMnLFxuICAgICAgICAgIHRhcmdldDoge1xuICAgICAgICAgICAgc3JjOiBuYW1lXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbUmVwYWNrUnVudGltZV0gU2NyaXB0IG1hbmFnZXIgd2FzIG5vdCBwcm92aWRlZCcpO1xuICAgICAgZG9uZSh7XG4gICAgICAgIHR5cGU6ICdleGVjJyxcbiAgICAgICAgdGFyZ2V0OiB7XG4gICAgICAgICAgc3JjOiBuYW1lXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBsb2FkSG90VXBkYXRlSGFuZGxlcih1cmwsIGRvbmUpIHtcbiAgICBpZiAoIWZhbHNlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbUmVwYWNrUnVudGltZV0gTG9hZGluZyBITVIgdXBkYXRlIGNodW5rcyBpcyBkaXNhYmxlZCcpO1xuICAgICAgZG9uZSh7XG4gICAgICAgIHR5cGU6ICdkaXNhYmxlZCcsXG4gICAgICAgIHRhcmdldDoge1xuICAgICAgICAgIHNyYzogdXJsXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmZXRjaCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZXBhY2tSdW50aW1lXSBMb2FkaW5nIEhNUiB1cGRhdGUgZmFpbGVkOicsIHJlc3BvbnNlLnN0YXR1c1RleHQpO1xuICAgICAgICBkb25lKHtcbiAgICAgICAgICB0eXBlOiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICAgIHRhcmdldDoge1xuICAgICAgICAgICAgc3JjOiB1cmxcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpO1xuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHNjcmlwdCkge1xuICAgICAgaWYgKHNjcmlwdCkge1xuICAgICAgICBpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIpIHtcbiAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlci51bnN0YWJsZV9ldmFsdWF0ZVNjcmlwdChzY3JpcHQsIHVybCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZXZhbChzY3JpcHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgY29uc29sZS5lcnJvcignW1JlcGFja1J1bnRpbWVdIExvYWRpbmcgSE1SIHVwZGF0ZSBjaHVuayBmYWlsZWQ6JywgcmVhc29uKTtcbiAgICAgIGRvbmUoe1xuICAgICAgICB0eXBlOiAnZXhlYycsXG4gICAgICAgIHRhcmdldDoge1xuICAgICAgICAgIHNyYzogdXJsXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIF9fd2VicGFja19yZXF1aXJlX18ubCA9IGZ1bmN0aW9uIGxvYWRTY3JpcHQodXJsLCBkb25lLCBrZXksIGNodW5rSWQpIHtcbiAgICBpZiAoa2V5ICYmIGNodW5rSWQpIHtcbiAgICAgIGxvYWRTY3JpcHRIYW5kbGVyKGNodW5rSWQsICdtb3ZpZXMnLCBkb25lLCB1cmwpO1xuICAgIH0gZWxzZSBpZiAoa2V5KSB7XG4gICAgICBsb2FkU2NyaXB0SGFuZGxlcihrZXksIHVuZGVmaW5lZCwgZG9uZSwgdXJsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9hZEhvdFVwZGF0ZUhhbmRsZXIodXJsLCBkb25lKTtcbiAgICB9XG4gIH07XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvbm9kZV9tb2R1bGVfZGVjb3JhdG9yXG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLm5tZCA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuICBtb2R1bGUucGF0aHMgPSBbXTtcbiAgaWYgKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xuICByZXR1cm4gbW9kdWxlO1xufTtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9wdWJsaWNfcGF0aFxuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJub29wOi8vL1wiO1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL3JlcGFjay9ndWFyZGVkIHJlcXVpcmVcbiFmdW5jdGlvbigpIHtcbiAgdmFyIGluR3VhcmQgPSBmYWxzZTtcbiAgdmFyIG9yaWdpbmFsV2VicGFja1JlcXVpcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fO1xuICBmdW5jdGlvbiBndWFyZGVkV2VicGFja1JlcXVpcmUobW9kdWxlSWQpIHtcbiAgICBpZiAoIWluR3VhcmQgJiYgc2VsZi5FcnJvclV0aWxzKSB7XG4gICAgICBpbkd1YXJkID0gdHJ1ZTtcbiAgICAgIGxldCBleHBvcnRzO1xuICAgICAgdHJ5IHtcbiAgICAgICAgZXhwb3J0cyA9IG9yaWdpbmFsV2VicGFja1JlcXVpcmUobW9kdWxlSWQpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBzZWxmLkVycm9yVXRpbHMucmVwb3J0RmF0YWxFcnJvcihlKTtcbiAgICAgIH1cbiAgICAgIGluR3VhcmQgPSBmYWxzZTtcbiAgICAgIHJldHVybiBleHBvcnRzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gb3JpZ2luYWxXZWJwYWNrUmVxdWlyZShtb2R1bGVJZCk7XG4gICAgfVxuICB9XG4gIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9yaWdpbmFsV2VicGFja1JlcXVpcmUpLmZvckVhY2goa2V5ID0+IHtcbiAgICBndWFyZGVkV2VicGFja1JlcXVpcmVba2V5XSA9IG9yaWdpbmFsV2VicGFja1JlcXVpcmVba2V5XTtcbiAgfSk7XG4gIF9fd2VicGFja19yZXF1aXJlX18gPSBndWFyZGVkV2VicGFja1JlcXVpcmU7XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvcmVwYWNrL2luaXRcbiFmdW5jdGlvbigpIHtcbiAgdmFyIHJlcGFja1J1bnRpbWUgPSB7XG4gICAgc2hhcmVkOiBzZWxmLl9fcmVwYWNrX18gJiYgc2VsZi5fX3JlcGFja19fLnNoYXJlZCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjayAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQgfHwge1xuICAgICAgc2NyaXB0TWFuYWdlcjogdW5kZWZpbmVkXG4gICAgfVxuICB9O1xuICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjayA9IHNlbGYuX19yZXBhY2tfXyA9IHJlcGFja1J1bnRpbWU7XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvcnNwYWNrX3ZlcnNpb25cbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18ucnYgPSBmdW5jdGlvbigpIHsgcmV0dXJuIFwiMS4zLjE1XCI7IH1cbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9zaGFyaW5nXG4hZnVuY3Rpb24oKSB7XG5cbl9fd2VicGFja19yZXF1aXJlX18uUyA9IHt9O1xuX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEgPSB7IHNjb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc6IHsgXCJkZWZhdWx0XCI6IFt7IG5hbWU6IFwiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9yc1wiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHNcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzgzMzdcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3JlYWN0LW5hdGl2ZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLWZkMzA5MFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fZ2V0X2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfLWRkMjU3ZVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzL2luZGV4LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUxXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5LmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzY4MzBcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2NsYXNzX3ByaXZhdGVfZmllbGRfbG9vc2VfYmFzZV9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqcy0zMTIyN2JcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGFcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlLmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV82ODMwXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fODMzN1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlXCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX2NhbGxzdGFja19yZXBhY2tfZGlzdF9tb2R1bGVzX0VtcHR5TW9kdWxlX2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9FbXB0eU1vZHVsZS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9FbXB0eU1vZHVsZS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV82ODMwXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fODMzN1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanNcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yLmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvci5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTZcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkX2Nqcy1ub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanNcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV82ODMwXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fODMzN1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzLWY2MTM3OVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEgfSwgeyBuYW1lOiBcInJlYWN0XCIsIHZlcnNpb246IFwiMTkuMC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEgfV0gfSwgdW5pcXVlTmFtZTogXCJtb3ZpZXNcIiB9O1xuX193ZWJwYWNrX3JlcXVpcmVfXy5JID0gX193ZWJwYWNrX3JlcXVpcmVfXy5JIHx8IGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJzaG91bGQgaGF2ZSBfX3dlYnBhY2tfcmVxdWlyZV9fLklcIikgfVxuXG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvY29uc3VtZXNfbG9hZGluZ1xuIWZ1bmN0aW9uKCkge1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEgPSB7IGNodW5rTWFwcGluZzoge1wid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9yc1wiXSxcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV84MzM3XCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD84MzM3XCJdLFwibW92aWVzXCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlPzhkMTRcIl0sXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeS9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeVwiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmUvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVcIl0sXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fNjgzMFwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QvcmVhY3Q/NjgzMFwiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3JlYWN0LW5hdGl2ZVwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT8yYWQxXCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLWZkMzA5MFwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydFwiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5XCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzL0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHNcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeVwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5XCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXlcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvci9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yXCJdLFwiX19mZWRlcmF0aW9uX2V4cG9zZV9BcHBcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/ZGZmOVwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD83NTJhXCJdfSwgbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZzogeyBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5ICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkuanNcIik7IH07IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5XCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MFwiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnkgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnkuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvclwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvclwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvciAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3IuanNcIik7IH07IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0PzgzMzdcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3RcIiwgaW1wb3J0OiBcInJlYWN0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0Pzc1MmFcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3RcIiwgaW1wb3J0OiBcInJlYWN0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIxOS4wLjBcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdCAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0L2luZGV4LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydFwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnRcIiwgaW1wb3J0OiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydFwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMvQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcIkByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9yc1wiLCBpbXBvcnQ6IFwiQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzL2luZGV4LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT8yYWQxXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fNjgzMFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzLWY2MTM3OVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0PzY4MzBcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3RcIiwgaW1wb3J0OiBcInJlYWN0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCJeMTkuMC4wXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5XCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheS5qc1wiKTsgfTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0cy9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcIkByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHNcIiwgaW1wb3J0OiBcIkByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHNcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9yZWFjdC1uYXRpdmVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy1mZDMwOTBcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0cy9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlLmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT84ZDE0XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCI+PTAuNzRcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fNjgzMFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzgzMzdcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkuanNcIik7IH07IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/ZGZmOVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmVcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZVwiLCByZXF1aXJlZFZlcnNpb246IFwiMC43OC4wXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fNjgzMFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzLWY2MTM3OVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5XCIsIGltcG9ydDogXCJAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIEByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5ICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmVcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUuanNcIik7IH07IH0gfSB9LCBpbml0aWFsQ29uc3VtZXM6IFtcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT84ZDE0XCJdIH07XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmYuY29uc3VtZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmYuY29uc3VtZXMgfHwgZnVuY3Rpb24oKSB7IHRocm93IG5ldyBFcnJvcihcInNob3VsZCBoYXZlIF9fd2VicGFja19yZXF1aXJlX18uZi5jb25zdW1lc1wiKSB9XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvaW5pdGlhbGl6ZV9leHBvc2VzXG4hZnVuY3Rpb24oKSB7XG5cbl9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhID0ge1xuICBtb2R1bGVNYXA6IHtcbiAgXCIuL0FwcFwiOiBmdW5jdGlvbigpIHtcbnJldHVybiBQcm9taXNlLmFsbCgvKiEgIHwgX19mZWRlcmF0aW9uX2V4cG9zZV9BcHAgKi8gW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19zaG9waWZ5X3JlYWN0LW5hdGl2ZS1wZXJmb3JtYW5jZV9kaXN0X2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fODMzN1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfcmVhY3QtbmF0aXZlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJfX2ZlZGVyYXRpb25fZXhwb3NlX0FwcFwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vQXBwLmpzICovIFwiLi9BcHAuanNcIik7IH07IH0pO1xufSxcbn0sXG4gIHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLFxufTtcbl9fd2VicGFja19yZXF1aXJlX18uZ2V0Q29udGFpbmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nZXRDb250YWluZXIgfHwgZnVuY3Rpb24oKSB7IHRocm93IG5ldyBFcnJvcihcInNob3VsZCBoYXZlIF9fd2VicGFja19yZXF1aXJlX18uZ2V0Q29udGFpbmVyXCIpIH07X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0Q29udGFpbmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0Q29udGFpbmVyIHx8IGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJzaG91bGQgaGF2ZSBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRDb250YWluZXJcIikgfTtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9qc29ucF9jaHVua19sb2FkaW5nXG4hZnVuY3Rpb24oKSB7XG5cbiAgICAgIC8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4gICAgICAvLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbiAgICAgIC8vIFtyZXNvbHZlLCByZWplY3QsIFByb21pc2VdID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxuICAgICAgdmFyIGluc3RhbGxlZENodW5rcyA9IHtcIm1vdmllc1wiOiAwLH07XG4gICAgICBcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mLmogPSBmdW5jdGlvbiAoY2h1bmtJZCwgcHJvbWlzZXMpIHtcbiAgICAgICAgICAvLyBKU09OUCBjaHVuayBsb2FkaW5nIGZvciBqYXZhc2NyaXB0XG52YXIgaW5zdGFsbGVkQ2h1bmtEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZClcblx0PyBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1cblx0OiB1bmRlZmluZWQ7XG5pZiAoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSB7XG5cdC8vIDAgbWVhbnMgXCJhbHJlYWR5IGluc3RhbGxlZFwiLlxuXG5cdC8vIGEgUHJvbWlzZSBtZWFucyBcImN1cnJlbnRseSBsb2FkaW5nXCIuXG5cdGlmIChpbnN0YWxsZWRDaHVua0RhdGEpIHtcblx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSk7XG5cdH0gZWxzZSB7XG5cdFx0aWYgKCEvXihcXC13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0XFwtXyg2ODMwfDgzMzcpfHdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RcXC1uYXRpdmVfKGFzc2V0c1xcLXJlZ2lzdHJ5XyhwYXRoXFwtc3VwcG9ydF9yZWFjdFxcLW5hdGl2ZV9hc3NldHNcXC0zNWYxNTR8cmVnaXN0cnlfcmVhY3RcXC1uYXRpdmVfYXNzZXRzXFwtcmVnXFwtNWQxZWFlKXxMaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxcXC05NmE2OTZ8bm9ybWFsaXplXFwtY29sb3JzX3JlYWN0XFwtbmF0aXZlX25vcm1hbGl6ZVxcLWNvbG9yc3xyZWFjdFxcLW5hdGl2ZXxzcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcXC1mZDMwOTB8dmlydHVhbGl6ZWRcXC1saXN0c19yZWFjdFxcLW5hdGl2ZV92aXJ0dWFsaXplZFxcLWxpc3RzXFwtZjYxMzc5KSkkLy50ZXN0KGNodW5rSWQpKSB7XG5cdFx0XHQvLyBzZXR1cCBQcm9taXNlIGluIGNodW5rIGNhY2hlXG5cdFx0XHR2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgeyBpbnN0YWxsZWRDaHVua0RhdGEgPSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSBbcmVzb2x2ZSwgcmVqZWN0XTsgfSk7XG5cdFx0XHRwcm9taXNlcy5wdXNoKChpbnN0YWxsZWRDaHVua0RhdGFbMl0gPSBwcm9taXNlKSk7XG5cblx0XHRcdC8vIHN0YXJ0IGNodW5rIGxvYWRpbmdcblx0XHRcdHZhciB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCk7XG5cdFx0XHQvLyBjcmVhdGUgZXJyb3IgYmVmb3JlIHN0YWNrIHVud291bmQgdG8gZ2V0IHVzZWZ1bCBzdGFja3RyYWNlIGxhdGVyXG5cdFx0XHR2YXIgZXJyb3IgPSBuZXcgRXJyb3IoKTtcblx0XHRcdHZhciBsb2FkaW5nRW5kZWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpKSB7XG5cdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdO1xuXHRcdFx0XHRcdGlmIChpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRpZiAoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdFx0XHR2YXIgZXJyb3JUeXBlID1cblx0XHRcdFx0XHRcdFx0ZXZlbnQgJiYgKGV2ZW50LnR5cGUgPT09ICdsb2FkJyA/ICdtaXNzaW5nJyA6IGV2ZW50LnR5cGUpO1xuXHRcdFx0XHRcdFx0dmFyIHJlYWxTcmMgPSBldmVudCAmJiBldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LnNyYztcblx0XHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UgPVxuXHRcdFx0XHRcdFx0XHQnTG9hZGluZyBjaHVuayAnICtcblx0XHRcdFx0XHRcdFx0Y2h1bmtJZCArXG5cdFx0XHRcdFx0XHRcdCcgZmFpbGVkLlxcbignICtcblx0XHRcdFx0XHRcdFx0ZXJyb3JUeXBlICtcblx0XHRcdFx0XHRcdFx0JzogJyArXG5cdFx0XHRcdFx0XHRcdHJlYWxTcmMgK1xuXHRcdFx0XHRcdFx0XHQnKSc7XG5cdFx0XHRcdFx0XHRlcnJvci5uYW1lID0gJ0NodW5rTG9hZEVycm9yJztcblx0XHRcdFx0XHRcdGVycm9yLnR5cGUgPSBlcnJvclR5cGU7XG5cdFx0XHRcdFx0XHRlcnJvci5yZXF1ZXN0ID0gcmVhbFNyYztcblx0XHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YVsxXShlcnJvcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5sKHVybCwgbG9hZGluZ0VuZGVkLCBcImNodW5rLVwiICsgY2h1bmtJZCwgY2h1bmtJZCk7XG5cdFx0fSBlbHNlIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG5cblx0fVxufVxuXG4gICAgICAgIH1cbiAgICAgICAgLy8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG52YXIgd2VicGFja0pzb25wQ2FsbGJhY2sgPSBmdW5jdGlvbihwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiwgZGF0YSkge1xuXHR2YXIgY2h1bmtJZHMgPSBkYXRhWzBdO1xudmFyIG1vcmVNb2R1bGVzID0gZGF0YVsxXTtcbnZhciBydW50aW1lID0gZGF0YVsyXTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRpZiAoY2h1bmtJZHMuc29tZShmdW5jdGlvbihpZCkgeyByZXR1cm4gaW5zdGFsbGVkQ2h1bmtzW2lkXSAhPT0gMDsgfSkpIHtcblx0XHRmb3IgKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG5cdFx0XHRpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcblx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHJ1bnRpbWUpIHZhciByZXN1bHQgPSBydW50aW1lKF9fd2VicGFja19yZXF1aXJlX18pO1xuXHR9XG5cdGlmIChwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbikgcGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24oZGF0YSk7XG5cdGZvciAoOyBpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG5cdFx0aWYgKFxuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiZcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVxuXHRcdCkge1xuXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKCk7XG5cdFx0fVxuXHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG5cdH1cblx0XG59O1xuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua21vdmllc1wiXSA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmttb3ZpZXNcIl0gfHwgW107XG5jaHVua0xvYWRpbmdHbG9iYWwuZm9yRWFjaCh3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIDApKTtcbmNodW5rTG9hZGluZ0dsb2JhbC5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCkpO1xuXG59KCk7XG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLy8gbW9kdWxlIGNhY2hlIGFyZSB1c2VkIHNvIGVudHJ5IGlubGluaW5nIGlzIGRpc2FibGVkXG4vLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18oXCJAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9yc3BhY2suanMhPSFkYXRhOnRleHQvamF2YXNjcmlwdCxpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyBmcm9tIFxcXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9tb3ZpZXMvbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL21vdmllcy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzXFxcIjtpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18gZnJvbSBcXFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvbW92aWVzL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qc1xcXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyA9IFtfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXygpLCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzFfXygpXTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fID0ge307Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fID0gXFxcIm1vdmllc1xcXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fID0gXFxcImxvYWRlZC1maXJzdFxcXCI7aWYoKF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhfHxfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkmJl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbil7dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyO2NvbnN0IG92ZXJyaWRlPShvYmosa2V5LHZhbHVlKT0+e2lmKCFvYmopcmV0dXJuO2lmKG9ialtrZXldKW9ialtrZXldPXZhbHVlfTtjb25zdCBtZXJnZT0ob2JqLGtleSxmbik9Pntjb25zdCB2YWx1ZT1mbigpO2lmKEFycmF5LmlzQXJyYXkodmFsdWUpKXt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPVtdO29ialtrZXldLnB1c2goLi4udmFsdWUpfWVsc2UgaWYodHlwZW9mIHZhbHVlPT09XFxcIm9iamVjdFxcXCImJnZhbHVlIT09bnVsbCl7dmFyIF9vYmoxLF9rZXkxO3ZhciBfMTsoXzE9KF9vYmoxPW9iailbX2tleTE9a2V5XSkhPT1udWxsJiZfMSE9PXZvaWQgMD9fMTpfb2JqMVtfa2V5MV09e307T2JqZWN0LmFzc2lnbihvYmpba2V5XSx2YWx1ZSl9fTtjb25zdCBlYXJseT0ob2JqLGtleSxpbml0aWFsKT0+e3ZhciBfb2JqLF9rZXk7dmFyIF87KF89KF9vYmo9b2JqKVtfa2V5PWtleV0pIT09bnVsbCYmXyE9PXZvaWQgMD9fOl9vYmpbX2tleV09aW5pdGlhbCgpfTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZztjb25zdCBpbml0aWFsaXplU2hhcmluZ1Njb3BlVG9Jbml0RGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCBjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc6e307Y29uc3QgY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcz17fTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcz1bXTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRUb2tlbnM9e307Y29uc3QgY29udGFpbmVyU2hhcmVTY29wZT0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLnNoYXJlU2NvcGU7Zm9yKGNvbnN0IGtleSBpbiBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fKXtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb25ba2V5XT1fX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fW2tleV19ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nXFxcIiwoKT0+e2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nKSl7Y29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1ttb2R1bGVJZF09e2dldHRlcjpkYXRhLmZhbGxiYWNrLHNoYXJlSW5mbzp7c2hhcmVDb25maWc6e2ZpeGVkRGVwZW5kZW5jaWVzOmZhbHNlLHJlcXVpcmVkVmVyc2lvbjpkYXRhLnJlcXVpcmVkVmVyc2lvbixzdHJpY3RWZXJzaW9uOmRhdGEuc3RyaWN0VmVyc2lvbixzaW5nbGV0b246ZGF0YS5zaW5nbGV0b24sZWFnZXI6ZGF0YS5lYWdlcn0sc2NvcGU6W2RhdGEuc2hhcmVTY29wZV19LHNoYXJlS2V5OmRhdGEuc2hhcmVLZXl9fXJldHVybiBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJpbml0T3B0aW9uc1xcXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwibmFtZVxcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJzaGFyZVN0cmF0ZWd5XFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXFxcInNoYXJlZFxcXCIsKCk9Pntjb25zdCBzaGFyZWQ9e307Zm9yKGxldFtzY29wZSxzdGFnZXNdb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nKSl7Zm9yKGxldCBzdGFnZSBvZiBzdGFnZXMpe2lmKHR5cGVvZiBzdGFnZT09PVxcXCJvYmplY3RcXFwiJiZzdGFnZSE9PW51bGwpe2NvbnN0e25hbWUsdmVyc2lvbixmYWN0b3J5LGVhZ2VyLHNpbmdsZXRvbixyZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbn09c3RhZ2U7Y29uc3Qgc2hhcmVDb25maWc9e307Y29uc3QgaXNWYWxpZFZhbHVlPWZ1bmN0aW9uKHZhbCl7cmV0dXJuIHR5cGVvZiB2YWwhPT1cXFwidW5kZWZpbmVkXFxcIn07aWYoaXNWYWxpZFZhbHVlKHNpbmdsZXRvbikpe3NoYXJlQ29uZmlnLnNpbmdsZXRvbj1zaW5nbGV0b259aWYoaXNWYWxpZFZhbHVlKHJlcXVpcmVkVmVyc2lvbikpe3NoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbj1yZXF1aXJlZFZlcnNpb259aWYoaXNWYWxpZFZhbHVlKGVhZ2VyKSl7c2hhcmVDb25maWcuZWFnZXI9ZWFnZXJ9aWYoaXNWYWxpZFZhbHVlKHN0cmljdFZlcnNpb24pKXtzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uPXN0cmljdFZlcnNpb259Y29uc3Qgb3B0aW9ucz17dmVyc2lvbixzY29wZTpbc2NvcGVdLHNoYXJlQ29uZmlnLGdldDpmYWN0b3J5fTtpZihzaGFyZWRbbmFtZV0pe3NoYXJlZFtuYW1lXS5wdXNoKG9wdGlvbnMpfWVsc2V7c2hhcmVkW25hbWVdPVtvcHRpb25zXX19fX1yZXR1cm4gc2hhcmVkfSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKHJlbW90ZT0+cmVtb3RlLmV4dGVybmFsVHlwZT09PVxcXCJzY3JpcHRcXFwiKSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJwbHVnaW5zXFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJidW5kbGVyUnVudGltZU9wdGlvbnNcXFwiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJjaHVua01hcHBpbmdcXFwiLCgpPT5yZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1xcXCIsKCk9Pntjb25zdCByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZz17fTtmb3IobGV0W21vZHVsZUlkLGRhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtyZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ1ttb2R1bGVJZF09W2RhdGEuc2hhcmVTY29wZSxkYXRhLm5hbWUsZGF0YS5leHRlcm5hbE1vZHVsZUlkLGRhdGEucmVtb3RlTmFtZV19cmV0dXJuIHJlbW90ZXNMb2FkaW5nSWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJ3ZWJwYWNrUmVxdWlyZVxcXCIsKCk9Pl9fd2VicGFja19yZXF1aXJlX18pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiaWRUb1JlbW90ZU1hcFxcXCIsKCk9Pntjb25zdCBpZFRvUmVtb3RlTWFwPXt9O2ZvcihsZXRbaWQscmVtb3RlRGF0YV1vZiBPYmplY3QuZW50cmllcyhyZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykpe2NvbnN0IGluZm89X19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfX1tyZW1vdGVEYXRhLnJlbW90ZU5hbWVdO2lmKGluZm8paWRUb1JlbW90ZU1hcFtpZF09aW5mb31yZXR1cm4gaWRUb1JlbW90ZU1hcH0pO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcIlNcXFwiLF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtpZihfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyl9b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLFxcXCJyZW1vdGVzXFxcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpyZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyxpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsaWRUb1JlbW90ZU1hcDpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb1JlbW90ZU1hcCx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcXFwiY29uc3VtZXNcXFwiLChjaHVua0lkLHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmNvbnN1bWVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmcsbW9kdWxlVG9IYW5kbGVyTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZyxpbnN0YWxsZWRNb2R1bGVzOmNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJJXFxcIiwobmFtZSxpbml0U2NvcGUpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuSSh7c2hhcmVTY29wZU5hbWU6bmFtZSxpbml0U2NvcGUsaW5pdFByb21pc2VzOmluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzLGluaXRUb2tlbnM6aW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcXFwiaW5pdENvbnRhaW5lclxcXCIsKHNoYXJlU2NvcGUsaW5pdFNjb3BlLHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5pdENvbnRhaW5lckVudHJ5KHtzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zLHNoYXJlU2NvcGVLZXk6Y29udGFpbmVyU2hhcmVTY29wZSx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcImdldENvbnRhaW5lclxcXCIsKG1vZHVsZTEsZ2V0U2NvcGUpPT57dmFyIG1vZHVsZU1hcD1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YS5tb2R1bGVNYXA7X193ZWJwYWNrX3JlcXVpcmVfXy5SPWdldFNjb3BlO2dldFNjb3BlPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2R1bGVNYXAsbW9kdWxlMSk/bW9kdWxlTWFwW21vZHVsZTFdKCk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKT0+e3Rocm93IG5ldyBFcnJvcignTW9kdWxlIFxcXCInK21vZHVsZTErJ1xcXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5SPXVuZGVmaW5lZDtyZXR1cm4gZ2V0U2NvcGV9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5zdGFuY2U9X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyLmluaXRpYWxDb25zdW1lcyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe3dlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX18saW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLGluaXRpYWxDb25zdW1lczpfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmd9KX19XCIpO1xudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFwid2VicGFjay9jb250YWluZXIvZW50cnkvbW92aWVzXCIpO1xubW92aWVzID0gX193ZWJwYWNrX2V4cG9ydHNfXztcbn0pKClcbjsvLyMgc291cmNlTWFwcGluZ1VSTD1tb3ZpZXMuY29udGFpbmVyLmJ1bmRsZS5tYXA/cGxhdGZvcm09YW5kcm9pZCIsInJlc3BvbnNlVGltZSI6NDE1NDIsImlzSHRtbCI6ZmFsc2V9LCJlcnJvciI6bnVsbCwic3RhdHVzIjoicGFzcyIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjo0Mi41NDU5MDUxNjUsIm5hbWUiOiIvbW92aWVzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvbW92aWVzLmNvbnRhaW5lci5idW5kbGUiLCJwYXRoIjoibW92aWVzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbW92aWVzLmNvbnRhaW5lci5idW5kbGUiLCJpdGVyYXRpb25JbmRleCI6MX0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoibW92aWVzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbWYtbWFuaWZlc3QuanNvbi5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvYXJ0aWZhY3RzL21vdmllcy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L21mLW1hbmlmZXN0Lmpzb24iLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6MjAwLCJzdGF0dXNUZXh0IjoiT0siLCJoZWFkZXJzIjp7ImFjY2VwdC1yYW5nZXMiOiJieXRlcyIsImFnZSI6IjAiLCJjYWNoZS1jb250cm9sIjoicHVibGljLG1heC1hZ2U9MCxtdXN0LXJldmFsaWRhdGUiLCJjYWNoZS1zdGF0dXMiOiJcIk5ldGxpZnkgRWRnZVwiOyBmd2Q9bWlzcyIsImNvbnRlbnQtdHlwZSI6ImFwcGxpY2F0aW9uL2pzb24iLCJkYXRlIjoiVGh1LCAxNyBKdWwgMjAyNSAxNjoyMDozMyBHTVQiLCJldGFnIjoiXCJiM2Q4MmQ3YTQwMzIzNGNhZTc1MjUxM2YxOTIyNjk2Yi1zc2wtZGZcIiIsInNlcnZlciI6Ik5ldGxpZnkiLCJzdHJpY3QtdHJhbnNwb3J0LXNlY3VyaXR5IjoibWF4LWFnZT0zMTUzNjAwMDsgaW5jbHVkZVN1YkRvbWFpbnM7IHByZWxvYWQiLCJ2YXJ5IjoiQWNjZXB0LUVuY29kaW5nIiwieC1uZi1yZXF1ZXN0LWlkIjoiMDFLMENLMDBRTlhWVDRXWTRIUUZRUE01RE4iLCJjb25uZWN0aW9uIjoiY2xvc2UiLCJ0cmFuc2Zlci1lbmNvZGluZyI6ImNodW5rZWQifSwiZGF0YSI6eyJpZCI6Im1vdmllcyIsIm5hbWUiOiJtb3ZpZXMiLCJtZXRhRGF0YSI6eyJuYW1lIjoibW92aWVzIiwidHlwZSI6ImFwcCIsImJ1aWxkSW5mbyI6eyJidWlsZFZlcnNpb24iOiIxLjAuMCIsImJ1aWxkTmFtZSI6Im1vdmllcyJ9LCJyZW1vdGVFbnRyeSI6eyJuYW1lIjoibW92aWVzLmNvbnRhaW5lci5idW5kbGUiLCJwYXRoIjoiIiwidHlwZSI6Imdsb2JhbCJ9LCJ0eXBlcyI6eyJwYXRoIjoiIiwibmFtZSI6IiIsInppcCI6IiIsImFwaSI6IiJ9LCJnbG9iYWxOYW1lIjoibW92aWVzIiwicGx1Z2luVmVyc2lvbiI6IjAuMTAuMCIsInByZWZldGNoSW50ZXJmYWNlIjpmYWxzZSwicHVibGljUGF0aCI6Im5vb3A6Ly8vIn0sInNoYXJlZCI6W3siaWQiOiJtb3ZpZXM6cmVhY3QtbmF0aXZlIiwibmFtZSI6InJlYWN0LW5hdGl2ZSIsInZlcnNpb24iOiIwLjc4LjAiLCJzaW5nbGV0b24iOnRydWUsInJlcXVpcmVkVmVyc2lvbiI6Il4wLjc4LjAiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJtb3ZpZXM6cmVhY3QiLCJuYW1lIjoicmVhY3QiLCJ2ZXJzaW9uIjoiMTkuMC4wIiwic2luZ2xldG9uIjp0cnVlLCJyZXF1aXJlZFZlcnNpb24iOiJeMTkuMC4wIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbXSwic3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJtb3ZpZXM6QHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0cyIsIm5hbWUiOiJAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzIiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOC5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6Im1vdmllczpAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMiLCJuYW1lIjoiQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzIiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6W10sInN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibW92aWVzOkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5IiwibmFtZSI6IkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5IiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6W10sInN5bmMiOlsibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibW92aWVzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZSIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6Im1vdmllczpAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQiLCJuYW1lIjoiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0IiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6W10sInN5bmMiOlsibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6Im1vdmllczpyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZSIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZSIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOltdLCJzeW5jIjpbIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJtb3ZpZXM6cmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkiLCJuYW1lIjoicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4LmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTYuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9WaWV3Q29uLTk5MWM4YS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfY2FsbHN0YWNrX3JlcGFja19kaXN0X21vZHVsZXNfRW1wdHlNb2R1bGVfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fY2xhc3NfcHJpdmF0ZV9maWVsZF9sb29zZV9iYXNlX2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzLTMxMjI3Yi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19nZXRfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF8tZGQyNTdlLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF9janMtbm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbImluZGV4LmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6Im1vdmllczpyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkiLCJuYW1lIjoicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5IiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOC5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUwLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvcl9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3ItZTg2ZWU2LmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2NhbGxzdGFja19yZXBhY2tfZGlzdF9tb2R1bGVzX0VtcHR5TW9kdWxlX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUxLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2NsYXNzX3ByaXZhdGVfZmllbGRfbG9vc2VfYmFzZV9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqcy0zMTIyN2IuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fZ2V0X2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfLWRkMjU3ZS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfY2pzLW5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy5jaHVuay5idW5kbGUiXSwic3luYyI6WyJpbmRleC5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibW92aWVzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeSIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnkiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUwLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUxLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6Im1vdmllczpyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlIiwibmFtZSI6InJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4LmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTYuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9WaWV3Q29uLTk5MWM4YS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfY2FsbHN0YWNrX3JlcGFja19kaXN0X21vZHVsZXNfRW1wdHlNb2R1bGVfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fY2xhc3NfcHJpdmF0ZV9maWVsZF9sb29zZV9iYXNlX2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzLTMxMjI3Yi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19nZXRfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF8tZGQyNTdlLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF9janMtbm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbImluZGV4LmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGEuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibW92aWVzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheSIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4LmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTYuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9WaWV3Q29uLTk5MWM4YS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfY2FsbHN0YWNrX3JlcGFja19kaXN0X21vZHVsZXNfRW1wdHlNb2R1bGVfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fY2xhc3NfcHJpdmF0ZV9maWVsZF9sb29zZV9iYXNlX2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzLTMxMjI3Yi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19nZXRfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF8tZGQyNTdlLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF9janMtbm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbImluZGV4LmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTYuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibW92aWVzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3IiLCJuYW1lIjoicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvciIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MTguY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MC5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yLWU4NmVlNi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X1ZpZXdDb24tOTkxYzhhLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19jYWxsc3RhY2tfcmVwYWNrX2Rpc3RfbW9kdWxlc19FbXB0eU1vZHVsZV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19jbGFzc19wcml2YXRlX2ZpZWxkX2xvb3NlX2Jhc2VfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janMtMzEyMjdiLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2dldF9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkXy1kZDI1N2UuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkX2Nqcy1ub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsiaW5kZXguYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yLWU4NmVlNi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibW92aWVzOnJlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MiLCJuYW1lIjoicmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncyIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MTguY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MC5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yLWU4NmVlNi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X1ZpZXdDb24tOTkxYzhhLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19jYWxsc3RhY2tfcmVwYWNrX2Rpc3RfbW9kdWxlc19FbXB0eU1vZHVsZV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19jbGFzc19wcml2YXRlX2ZpZWxkX2xvb3NlX2Jhc2VfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janMtMzEyMjdiLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2dldF9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkXy1kZDI1N2UuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkX2Nqcy1ub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsiaW5kZXguYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19XSwicmVtb3RlcyI6W10sImV4cG9zZXMiOlt7ImlkIjoibW92aWVzOkFwcCIsIm5hbWUiOiJBcHAiLCJhc3NldHMiOnsianMiOnsic3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19zaG9waWZ5X3JlYWN0LW5hdGl2ZS1wZXJmb3JtYW5jZV9kaXN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIl9fZmVkZXJhdGlvbl9leHBvc2VfQXBwLmNodW5rLmJ1bmRsZSJdLCJhc3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOC5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUwLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7InN5bmMiOltdLCJhc3luYyI6W119fSwicGF0aCI6Ii4vQXBwIn1dfSwicmVzcG9uc2VUaW1lIjoxMjI0LCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOm51bGwsInN0YXR1cyI6InBhc3MiLCJhc3NlcnRpb25SZXN1bHRzIjpbXSwidGVzdFJlc3VsdHMiOltdLCJwcmVSZXF1ZXN0VGVzdFJlc3VsdHMiOltdLCJwb3N0UmVzcG9uc2VUZXN0UmVzdWx0cyI6W10sInNob3VsZFN0b3BSdW5uZXJFeGVjdXRpb24iOmZhbHNlLCJydW5EdXJhdGlvbiI6Mi4yMjc0NDI2OTgsIm5hbWUiOiIvbW92aWVzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvbWYtbWFuaWZlc3QuanNvbiIsInBhdGgiOiJtb3ZpZXMtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC1tZi1tYW5pZmVzdC5qc29uIiwiaXRlcmF0aW9uSW5kZXgiOjF9LHsidGVzdCI6eyJmaWxlbmFtZSI6Im11c2ljcy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LW11c2ljcy5jb250YWluZXIuYnVuZGxlLmJydSJ9LCJyZXF1ZXN0Ijp7Im1ldGhvZCI6IkdFVCIsInVybCI6Imh0dHBzOi8vcmVhY3QtbmF0aXZlLWFydGlmYWN0cy5uZXRsaWZ5LmFwcC9hcnRpZmFjdHMvbXVzaWNzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvbXVzaWNzLmNvbnRhaW5lci5idW5kbGUiLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6MjAwLCJzdGF0dXNUZXh0IjoiT0siLCJoZWFkZXJzIjp7ImFjY2VwdC1yYW5nZXMiOiJieXRlcyIsImFnZSI6IjAiLCJjYWNoZS1jb250cm9sIjoicHVibGljLG1heC1hZ2U9MCxtdXN0LXJldmFsaWRhdGUiLCJjYWNoZS1zdGF0dXMiOiJcIk5ldGxpZnkgRWRnZVwiOyBmd2Q9bWlzcyIsImNvbnRlbnQtdHlwZSI6InRleHQvamF2YXNjcmlwdCIsImRhdGUiOiJUaHUsIDE3IEp1bCAyMDI1IDE2OjIwOjM2IEdNVCIsImV0YWciOiJcIjYyYmNmYWM2Mjg4MGUzZGFjMjE4YTE1ZTNhYmM0NjEwLXNzbC1kZlwiIiwic2VydmVyIjoiTmV0bGlmeSIsInN0cmljdC10cmFuc3BvcnQtc2VjdXJpdHkiOiJtYXgtYWdlPTMxNTM2MDAwOyBpbmNsdWRlU3ViRG9tYWluczsgcHJlbG9hZCIsInZhcnkiOiJBY2NlcHQtRW5jb2RpbmciLCJ4LW5mLXJlcXVlc3QtaWQiOiIwMUswQ0swM0FXQjRHV1RGVDM5WjhRQTdZRyIsImNvbm5lY3Rpb24iOiJjbG9zZSIsInRyYW5zZmVyLWVuY29kaW5nIjoiY2h1bmtlZCJ9LCJkYXRhIjoiLyoqKioqKi8gdmFyIHNlbGYgPSBzZWxmIHx8IHRoaXMgfHwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKSB8fCAoe30pOyAvLyByZXBhY2tHbG9iYWwnXG4vKioqKioqL1xudmFyIG11c2ljcztcbihmdW5jdGlvbigpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxudmFyIF9fd2VicGFja19tb2R1bGVzX18gPSAoe1xuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL0NvcmVQbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL0NvcmVQbHVnaW4uanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX2RlZmF1bHQ7XG4gICAgfVxufSkpO1xudmFyIF9hc3luY190b19nZW5lcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fYXN5bmNfdG9fZ2VuZXJhdG9yICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiKTtcbnZhciBSZXBhY2tDb3JlUGx1Z2luID0gKCk9Pih7XG4gICAgICAgIG5hbWU6ICdyZXBhY2stY29yZS1wbHVnaW4nLFxuICAgICAgICBsb2FkRW50cnk6IChyZWYpPT57XG4gICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IHJlZi5yZW1vdGVJbmZvO1xuICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNsaWVudCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL1NjcmlwdE1hbmFnZXIvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9pbmRleC5qc1wiKTtcbiAgICAgICAgICAgICAgICB2YXIgU2NyaXB0TWFuYWdlciA9IGNsaWVudC5TY3JpcHRNYW5hZ2VyLCBnZXRXZWJwYWNrQ29udGV4dCA9IGNsaWVudC5nZXRXZWJwYWNrQ29udGV4dDtcbiAgICAgICAgICAgICAgICB2YXIgZW50cnkgPSByZW1vdGVJbmZvLmVudHJ5LCBlbnRyeUdsb2JhbE5hbWUgPSByZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5sb2FkU2NyaXB0KGVudHJ5R2xvYmFsTmFtZSwgdW5kZWZpbmVkLCBnZXRXZWJwYWNrQ29udGV4dCgpLCBlbnRyeSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFnbG9iYWxUaGlzW2VudHJ5R2xvYmFsTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdsb2JhbFRoaXNbZW50cnlHbG9iYWxOYW1lXTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBsb2FkIHJlbW90ZSBlbnRyeTogJHtlbnRyeUdsb2JhbE5hbWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2VuZXJhdGVQcmVsb2FkQXNzZXRzOiAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAvLyBub29wIGZvciBjb21wYXRpYmlsaXR5XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgICAgIGNzc0Fzc2V0czogW10sXG4gICAgICAgICAgICAgICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5OiBbXSxcbiAgICAgICAgICAgICAgICAgICAgZW50cnlBc3NldHM6IFtdXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KSgpXG4gICAgfSk7XG52YXIgX2RlZmF1bHQgPSBSZXBhY2tDb3JlUGx1Z2luO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL1Jlc29sdmVyUGx1Z2luLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvUmVzb2x2ZXJQbHVnaW4uanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZGVmYXVsdFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9kZWZhdWx0O1xuICAgIH1cbn0pKTtcbnZhciBfYXN5bmNfdG9fZ2VuZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2FzeW5jX3RvX2dlbmVyYXRvciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FzeW5jX3RvX2dlbmVyYXRvci5janNcIik7XG52YXIgX29iamVjdF9zcHJlYWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fb2JqZWN0X3NwcmVhZCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX29iamVjdF9zcHJlYWQuY2pzXCIpO1xudmFyIGNyZWF0ZVNjcmlwdExvY2F0b3IgPSAoZW50cnlVcmwsIGNvbmZpZyk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB2YXIgbG9jYXRvciA9IHlpZWxkIGNvbmZpZyhlbnRyeVVybCk7XG4gICAgICAgICAgICByZXR1cm4gbG9jYXRvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHJldHVybiBfb2JqZWN0X3NwcmVhZC5fKHtcbiAgICAgICAgICAgICAgICB1cmw6IGVudHJ5VXJsXG4gICAgICAgICAgICB9LCBjb25maWcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cmw6IGVudHJ5VXJsXG4gICAgICAgIH07XG4gICAgfSkoKTtcbnZhciBSZXBhY2tSZXNvbHZlclBsdWdpbiA9IChjb25maWcpPT4oe1xuICAgICAgICBuYW1lOiAncmVwYWNrLXJlc29sdmVyLXBsdWdpbicsXG4gICAgICAgIGFmdGVyUmVzb2x2ZSAoYXJncykge1xuICAgICAgICAgICAgdmFyIFNjcmlwdE1hbmFnZXIgPSAoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vU2NyaXB0TWFuYWdlci9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzXCIpLyogLlNjcmlwdE1hbmFnZXIgKi8uU2NyaXB0TWFuYWdlcik7XG4gICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IGFyZ3MucmVtb3RlSW5mbztcbiAgICAgICAgICAgIFNjcmlwdE1hbmFnZXIuc2hhcmVkLmFkZFJlc29sdmVyKChzY3JpcHRJZCwgY2FsbGVyLCByZWZlcmVuY2VVcmwpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlbnRyeSBjb250YWluZXJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjcmlwdElkID09PSByZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0b3IgPSB5aWVsZCBjcmVhdGVTY3JpcHRMb2NhdG9yKHJlbW90ZUluZm8uZW50cnksIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBlbnRyeSBjaHVua3NcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlZmVyZW5jZVVybCAmJiBjYWxsZXIgPT09IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHVibGljUGF0aCA9IHJlbW90ZUluZm8uZW50cnkuc3BsaXQoJy8nKS5zbGljZSgwLCAtMSkuam9pbignLycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1bmRsZVBhdGggPSBzY3JpcHRJZCArIHJlZmVyZW5jZVVybC5zcGxpdChzY3JpcHRJZClbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gcHVibGljUGF0aCArICcvJyArIGJ1bmRsZVBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRvcjEgPSB5aWVsZCBjcmVhdGVTY3JpcHRMb2NhdG9yKHVybCwgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhdG9yMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKCksIHtcbiAgICAgICAgICAgICAgICBrZXk6IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBhcmdzO1xuICAgICAgICB9XG4gICAgfSk7XG52YXIgX2RlZmF1bHQgPSBSZXBhY2tSZXNvbHZlclBsdWdpbjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0LmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0LmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiU2NyaXB0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gU2NyaXB0O1xuICAgIH1cbn0pKTtcbnZhciBfY2xhc3NfY2FsbF9jaGVjayA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jbGFzc19jYWxsX2NoZWNrICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janNcIik7XG52YXIgX2NyZWF0ZV9jbGFzcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jcmVhdGVfY2xhc3MgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzXCIpO1xudmFyIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiKTtcbnZhciBfc2hhbGxvd2VxdWFsID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBzaGFsbG93ZXF1YWwgKi8gXCIuL25vZGVfbW9kdWxlcy9zaGFsbG93ZXF1YWwvaW5kZXguanNcIikpO1xudmFyIF9OYXRpdmVTY3JpcHRNYW5hZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvTmF0aXZlU2NyaXB0TWFuYWdlci5qc1wiKTtcbnZhciBTY3JpcHQgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIGZ1bmN0aW9uIFNjcmlwdChzY3JpcHRJZCwgY2FsbGVyLCBsb2NhdG9yLCByZWYpIHtcbiAgICAgICAgdmFyIGNhY2hlID0gcmVmID09PSB2b2lkIDAgPyB0cnVlIDogcmVmO1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFNjcmlwdCk7XG4gICAgICAgIHRoaXMuc2NyaXB0SWQgPSBzY3JpcHRJZDtcbiAgICAgICAgdGhpcy5jYWxsZXIgPSBjYWxsZXI7XG4gICAgICAgIHRoaXMubG9jYXRvciA9IGxvY2F0b3I7XG4gICAgICAgIHRoaXMuY2FjaGUgPSBjYWNoZTtcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFNjcmlwdCwgW1xuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIHNjcmlwdCB3YXMgYWxyZWFkeSBjYWNoZWQgYW5kIGNhY2hlIHNob3VsZCBiZSB1cGRhdGVkIHdpdGggbmV3IGRhdGEuXG4gICAqXG4gICAqIEBwYXJhbSBjYWNoZWREYXRhIENhY2hlZCBkYXRhIGZvciB0aGUgc2FtZSBzY3JpcHQuXG4gICAqXG4gICAqIEBpbnRlcm5hbFxuICAgKi8ga2V5OiBcInNob3VsZFVwZGF0ZUNhY2hlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdWxkVXBkYXRlQ2FjaGUoY2FjaGVkRGF0YSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZSB8fCAhY2FjaGVkRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNoZWNrSWZDYWNoZURhdGFPdXRkYXRlZChjYWNoZWREYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIENoZWNrIGlmIHRoZSBzY3JpcHQgc2hvdWxkIGJlIGZldGNoZWQgYWdhaW4gb3IgcmV1c2VkLFxuICAgKiBiYXNlZCBvbiBwcmV2aW91cyBjYWNoZWQgZGF0YS5cbiAgICpcbiAgICogQHBhcmFtIGNhY2hlZERhdGEgQ2FjaGVkIGRhdGEgZm9yIHRoZSBzYW1lIHNjcmlwdC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwic2hvdWxkUmVmZXRjaFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNob3VsZFJlZmV0Y2goY2FjaGVkRGF0YSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkKGNhY2hlZERhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogQ2hlY2sgaWYgcHJldmlvdXMgY2FjaGVkIGRhdGEgaXMgdGhlIHNhbWUgYXMgdGhlIG5ldyBvbmUuXG4gICAqXG4gICAqIEBwYXJhbSBjYWNoZWREYXRhIENhY2hlZCBkYXRhIGZvciB0aGUgc2FtZSBzY3JpcHQuXG4gICAqXG4gICAqIEBpbnRlcm5hbFxuICAgKi8ga2V5OiBcImNoZWNrSWZDYWNoZURhdGFPdXRkYXRlZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNoZWNrSWZDYWNoZURhdGFPdXRkYXRlZChjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZERhdGEubWV0aG9kICE9PSB0aGlzLmxvY2F0b3IubWV0aG9kIHx8IGNhY2hlZERhdGEudXJsICE9PSB0aGlzLmxvY2F0b3IudXJsIHx8IGNhY2hlZERhdGEucXVlcnkgIT09IHRoaXMubG9jYXRvci5xdWVyeSB8fCAhKDAsIF9zaGFsbG93ZXF1YWwuZGVmYXVsdCkoY2FjaGVkRGF0YS5oZWFkZXJzLCB0aGlzLmxvY2F0b3IuaGVhZGVycykgfHwgY2FjaGVkRGF0YS5ib2R5ICE9PSB0aGlzLmxvY2F0b3IuYm9keTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIEdldCBvYmplY3QgdG8gc3RvcmUgaW4gY2FjaGUuXG4gICAqXG4gICAqIEBpbnRlcm5hbFxuICAgKi8ga2V5OiBcImdldENhY2hlRGF0YVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENhY2hlRGF0YSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IHRoaXMubG9jYXRvci5tZXRob2QsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdGhpcy5sb2NhdG9yLnVybCxcbiAgICAgICAgICAgICAgICAgICAgcXVlcnk6IHRoaXMubG9jYXRvci5xdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogdGhpcy5sb2NhdG9yLmhlYWRlcnMsXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IHRoaXMubG9jYXRvci5ib2R5XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInRvT2JqZWN0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdG9PYmplY3QoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc2NyaXB0SWQ6IHRoaXMuc2NyaXB0SWQsXG4gICAgICAgICAgICAgICAgICAgIGNhbGxlcjogdGhpcy5jYWxsZXIsXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0b3I6IHRoaXMubG9jYXRvcixcbiAgICAgICAgICAgICAgICAgICAgY2FjaGU6IHRoaXMuY2FjaGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZ2V0RGV2U2VydmVyVVJMXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIEdldCBVUkwgb2YgYSBzY3JpcHQgaG9zdGVkIG9uIGRldmVsb3BtZW50IHNlcnZlci5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQuXG4gICAqLyBmdW5jdGlvbiBnZXREZXZTZXJ2ZXJVUkwoc2NyaXB0SWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHdlYnBhY2tDb250ZXh0KT0+YCR7d2VicGFja0NvbnRleHQucH0ke3dlYnBhY2tDb250ZXh0LnUoc2NyaXB0SWQpfWA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRGaWxlU3lzdGVtVVJMXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIEdldCBVUkwgb2YgYSBzY3JpcHQgc3RvcmVkIG9uIGZpbGVzeXN0ZW0gb24gdGhlIHRhcmdldCBtb2JpbGUgZGV2aWNlLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdC5cbiAgICovIGZ1bmN0aW9uIGdldEZpbGVTeXN0ZW1VUkwoc2NyaXB0SWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHdlYnBhY2tDb250ZXh0KT0+d2VicGFja0NvbnRleHQudShgZmlsZTovLy8ke3NjcmlwdElkfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZ2V0UmVtb3RlVVJMXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIEdldCBVUkwgb2YgYSBzY3JpcHQgaG9zdGVkIG9uIGEgcmVtb3RlIHNlcnZlci5cbiAgICpcbiAgICogQnkgZGVmYXVsdCBgLmNodW5rLmJ1bmRsZWAgZXh0ZW5zaW9uIHdpbGwgYmUgYWRkZWQgdG8gdGhlIFVSTC5cbiAgICogSWYgeW91ciBzY3JpcHQgaGFzIGRpZmZlcmVudCBleHRlbnNpb24sIHlvdSBzaG91bGQgcGFzcyBgeyBleGNsdWRlRXh0ZW5zaW9uOiB0cnVlIH1gIGFzIDJuZCBhcmd1bWVudC5cbiAgICpcbiAgICogQHBhcmFtIHVybCBBIFVSTCB0byByZW1vdGUgbG9jYXRpb24gd2hlcmUgdGhlIHNjcmlwdCBpcyBzdG9yZWQuXG4gICAqIEBwYXJhbSBvcHRpb25zIEFkZGl0aW9uYWwgb3B0aW9ucy5cbiAgICovIGZ1bmN0aW9uIGdldFJlbW90ZVVSTCh1cmwsIHJlZikge1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5leGNsdWRlRXh0ZW5zaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT53ZWJwYWNrQ29udGV4dC51KHVybCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRTY3JpcHRVbmlxdWVJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IC8qKlxuICAgKiBHZXQgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBzY3JpcHQuXG4gICAqXG4gICAqIFVzZWQgdG8gY3JlYXRlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgc2NyaXB0LCB3aGljaCBzZXJ2ZXMgYXMgaXRzIGtleSBpbiB0aGUgY2FjaGUuXG4gICAqXG4gICAqIEBwYXJhbSBzY3JpcHRJZCBJZCBvZiB0aGUgc2NyaXB0LlxuICAgKiBAcGFyYW0gY2FsbGVyIE9wdGlvbmFsIGNhbGxlciBuYW1lIHRvIHByZWZpeCB0aGUgc2NyaXB0IGlkLlxuICAgKi8gZnVuY3Rpb24gZ2V0U2NyaXB0VW5pcXVlSWQoc2NyaXB0SWQsIGNhbGxlcikge1xuICAgICAgICAgICAgICAgIHZhciBwcmVmaXggPSBjYWxsZXIgPyBjYWxsZXIgKyAnXycgOiAnJztcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJlZml4ICsgc2NyaXB0SWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJmcm9tXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIENyZWF0ZSBuZXcgaW5zdGFuY2Ugb2YgYFNjcmlwdGAgZnJvbSBub24tbm9ybWFsaXplZCBzY3JpcHQgbG9jYXRvciBkYXRhLlxuICAgKlxuICAgKiBAcGFyYW0gbG9jYXRvciBOb24tbm9ybWFsaXplZCBsb2NhdG9yIGRhdGEuXG4gICAqIEBwYXJhbSBmZXRjaCBJbml0aWFsIGZsYWcgZm9yIHdoZXRoZXIgc2NyaXB0IHNob3VsZCBiZSBmZXRjaGVkIG9yIG5vdC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBmdW5jdGlvbiBmcm9tKGtleSwgbG9jYXRvciwgZmV0Y2gpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IHt9O1xuICAgICAgICAgICAgICAgIG5ldyBIZWFkZXJzKGxvY2F0b3IuaGVhZGVycykuZm9yRWFjaCgodmFsdWUsIGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1trZXkudG9Mb3dlckNhc2UoKV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgdW5pcXVlSWQgPSBTY3JpcHQuZ2V0U2NyaXB0VW5pcXVlSWQoa2V5LnNjcmlwdElkLCBrZXkuY2FsbGVyKTtcbiAgICAgICAgICAgICAgICB2YXIgYm9keTtcbiAgICAgICAgICAgICAgICBpZiAobG9jYXRvci5ib2R5IGluc3RhbmNlb2YgRm9ybURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJvZHlPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRvci5ib2R5LmZvckVhY2goKHZhbHVlLCBrZXkpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHlPYmplY3Rba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1NjcmlwdCBkb2VzIG5vdCBzdXBwb3J0IEZpbGUgYXMgRm9ybURhdGEga2V5IGluIGJvZHknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJvZHkgPSBKU09OLnN0cmluZ2lmeShib2R5T2JqZWN0KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxvY2F0b3IuYm9keSBpbnN0YW5jZW9mIFVSTFNlYXJjaFBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm9keU9iamVjdDEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRvci5ib2R5LmZvckVhY2goKHZhbHVlLCBrZXkpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBib2R5T2JqZWN0MVtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBib2R5ID0gSlNPTi5zdHJpbmdpZnkoYm9keU9iamVjdDEpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGJvZHkgPSBsb2NhdG9yLmJvZHkgPz8gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGxvY2F0b3IudXJsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUHJvcGVydHkgdXJsIGFzIGEgZnVuY3Rpb24gaXMgbm90IHN1cHBvcnQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHQoa2V5LnNjcmlwdElkLCBrZXkuY2FsbGVyLCB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZUlkLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IGxvY2F0b3IubWV0aG9kID8/IF9OYXRpdmVTY3JpcHRNYW5hZ2VyLk5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZC5HRVQsXG4gICAgICAgICAgICAgICAgICAgIHVybDogbG9jYXRvci51cmwsXG4gICAgICAgICAgICAgICAgICAgIGFic29sdXRlOiBsb2NhdG9yLmFic29sdXRlID8/IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiBsb2NhdG9yLnRpbWVvdXQgPz8gU2NyaXB0LkRFRkFVTFRfVElNRU9VVCxcbiAgICAgICAgICAgICAgICAgICAgcmV0cnk6IGxvY2F0b3IucmV0cnksXG4gICAgICAgICAgICAgICAgICAgIHJldHJ5RGVsYXk6IGxvY2F0b3IucmV0cnlEZWxheSxcbiAgICAgICAgICAgICAgICAgICAgcXVlcnk6IG5ldyBVUkxTZWFyY2hQYXJhbXMobG9jYXRvci5xdWVyeSkudG9TdHJpbmcoKSB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGJvZHksXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IE9iamVjdC5rZXlzKGhlYWRlcnMpLmxlbmd0aCA/IGhlYWRlcnMgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGZldGNoOiBsb2NhdG9yLmNhY2hlID09PSBmYWxzZSA/IHRydWUgOiBmZXRjaCxcbiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5U2NyaXB0U2lnbmF0dXJlOiBsb2NhdG9yLnZlcmlmeVNjcmlwdFNpZ25hdHVyZSA/PyBfTmF0aXZlU2NyaXB0TWFuYWdlci5Ob3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGUuT0ZGXG4gICAgICAgICAgICAgICAgfSwgbG9jYXRvci5jYWNoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gU2NyaXB0O1xufSAvLyMgc291cmNlTWFwcGluZ1VSTD1TY3JpcHQuanMubWFwXG4oKTtcblNjcmlwdC5ERUZBVUxUX1RJTUVPVVQgPSAzMDAwMCAvLyAzMHNcbjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0TWFuYWdlci5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHRNYW5hZ2VyLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4vLyBiaW9tZS1pZ25vcmUgbGludC9zdHlsZS91c2VOb2RlanNJbXBvcnRQcm90b2NvbDogdXNlICdldmVudHMnIG1vZHVsZSBpbnN0ZWFkIG9mIG5vZGUgYnVpbHRpblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJTY3JpcHRNYW5hZ2VyXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gU2NyaXB0TWFuYWdlcjtcbiAgICB9XG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIF9jYWxsX3N1cGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NhbGxfc3VwZXIgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jYWxsX3N1cGVyLmNqc1wiKTtcbnZhciBfY2xhc3NfY2FsbF9jaGVjayA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jbGFzc19jYWxsX2NoZWNrICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janNcIik7XG52YXIgX2NyZWF0ZV9jbGFzcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jcmVhdGVfY2xhc3MgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzXCIpO1xudmFyIF9pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbmhlcml0cyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2luaGVyaXRzLmNqc1wiKTtcbnZhciBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janNcIik7XG52YXIgX3NsaWNlZF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19zbGljZWRfdG9fYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19jb25zdW1hYmxlX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2NvbnN1bWFibGVfYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqc1wiKTtcbnZhciBfZXZlbnRzID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBldmVudHMgKi8gXCIuL25vZGVfbW9kdWxlcy9ldmVudHMvZXZlbnRzLmpzXCIpKTtcbnZhciBfTmF0aXZlU2NyaXB0TWFuYWdlciA9IC8qI19fUFVSRV9fKi8gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0Ll8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvTmF0aXZlU2NyaXB0TWFuYWdlci5qc1wiKSk7XG52YXIgX1NjcmlwdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vU2NyaXB0LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0LmpzXCIpO1xudmFyIF9nZXRXZWJwYWNrQ29udGV4dCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZ2V0V2VicGFja0NvbnRleHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9nZXRXZWJwYWNrQ29udGV4dC5qc1wiKTtcbnZhciBERUZBVUxUX1JFU09MVkVSX1BSSU9SSVRZID0gMjtcbnZhciBERUZBVUxUX1JFU09MVkVSX0tFWSA9ICdfX2RlZmF1bHRfXyc7XG52YXIgQ0FDSEVfTkFNRSA9ICdSZXBhY2suU2NyaXB0TWFuYWdlci5DYWNoZSc7XG52YXIgQ0FDSEVfVkVSU0lPTiA9ICd2NCc7XG52YXIgQ0FDSEVfRU5WID0gIHRydWUgPyAnZGVidWcnIDogMDtcbnZhciBDQUNIRV9LRVkgPSBbXG4gICAgQ0FDSEVfTkFNRSxcbiAgICBDQUNIRV9WRVJTSU9OLFxuICAgIENBQ0hFX0VOVlxuXS5qb2luKCcuJyk7XG52YXIgTE9BRElOR19FUlJPUl9DT0RFUyA9IFtcbiAgICAvLyBhbmRyb2lkXG4gICAgJ05ldHdvcmtGYWlsdXJlJyxcbiAgICAnUmVxdWVzdEZhaWx1cmUnLFxuICAgIC8vIGlvc1xuICAgICdTY3JpcHREb3dubG9hZEZhaWx1cmUnXG5dO1xudmFyIFNjcmlwdE1hbmFnZXIgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKEV2ZW50RW1pdHRlcikge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIF9pbmhlcml0cy5fKFNjcmlwdE1hbmFnZXIsIEV2ZW50RW1pdHRlcik7XG4gICAgZnVuY3Rpb24gU2NyaXB0TWFuYWdlcihyZWYpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVNjcmlwdE1hbmFnZXIgPSByZWYgPT09IHZvaWQgMCA/IF9OYXRpdmVTY3JpcHRNYW5hZ2VyLmRlZmF1bHQgOiByZWY7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU2NyaXB0TWFuYWdlcik7XG4gICAgICAgIHZhciBfdGhpcztcbiAgICAgICAgX3RoaXMgPSBfY2FsbF9zdXBlci5fKHRoaXMsIFNjcmlwdE1hbmFnZXIpLCBfdGhpcy5jYWNoZSA9IHt9LCBfdGhpcy5zY3JpcHRzUHJvbWlzZXMgPSB7fSwgX3RoaXMuY2FjaGVJbml0aWFsaXplZCA9IGZhbHNlLCBfdGhpcy5yZXNvbHZlcnMgPSBbXTtcbiAgICAgICAgX3RoaXMubmF0aXZlU2NyaXB0TWFuYWdlciA9IG5hdGl2ZVNjcmlwdE1hbmFnZXI7XG4gICAgICAgIGlmICghbmF0aXZlU2NyaXB0TWFuYWdlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdyZXBhY2sgcmVhY3QtbmF0aXZlIG1vZHVsZSB3YXMgbm90IGZvdW5kLicgKyAoIHRydWUgPyAnIERpZCB5b3UgZm9yZ2V0IHRvIHVwZGF0ZSBuYXRpdmUgZGVwZW5kZW5jaWVzPycgOiAwKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NjcmlwdE1hbmFnZXIgd2FzIGFscmVhZHkgaW5zdGFudGlhdGVkLiBVc2UgU2NyaXB0TWFuYWdlci5zaGFyZWQgaW5zdGVhZC4nKTtcbiAgICAgICAgfVxuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlciA9IF90aGlzO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTY3JpcHRNYW5hZ2VyLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBTZXRzIGEgc3RvcmFnZSBiYWNrZW5kIHRvIGNhY2hlIHJlc29sdmVkIHNjcmlwdHMgbG9jYXRvciBkYXRhLlxuICAgKlxuICAgKiBUaGUgc3RvcmVkIGRhdGEgaXMgdXNlZCB0byBkZXRlY3QgaWYgc2NyaXB0cyBsb2NhdG9yIGRhdGEgb2YgcHJldmlvdXNseSBkb3dubG9hZGVkXG4gICAqIHNjcmlwdCBoYXNuJ3QgY2hhbmdlZCB0byBhdm9pZCBvdmVyLWZldGNoaW5nIHRoZSBzY3JpcHQuXG4gICAqXG4gICAqIEBwYXJhbSBzdG9yYWdlIEltcGxlbWVudGF0aW9uIG9mIHN0b3JhZ2UgZnVuY3Rpb25zLlxuICAgKi8ga2V5OiBcInNldFN0b3JhZ2VcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTdG9yYWdlKHN0b3JhZ2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3JhZ2UgPSBzdG9yYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogQWRkcyBuZXcgc2NyaXB0IGxvY2F0b3IgcmVzb2x2ZXIuXG4gICAqXG4gICAqIFJlc29sdmVyIGlzIGFuIGFzeW5jIGZ1bmN0aW9uIHRvIHJlc29sdmUgc2NyaXB0IGxvY2F0b3IgZGF0YSAtIGluIG90aGVyIHdvcmRzLCBpdCdzIGEgZnVuY3Rpb24gdG9cbiAgICogdGVsbCB0aGUge0BsaW5rIFNjcmlwdE1hbmFnZXJ9IGhvdyB0byBmZXRjaCB0aGUgc2NyaXB0LlxuICAgKlxuICAgKiBUaGVyZSdzIG5vIGxpbWl0YXRpb24gb24gd2hhdCBsb2dpYyB5b3UgY2FuIHJ1biBpbnNpZGUgdGhpcyBmdW5jdGlvbiAtIGl0IGNhbiBpbmNsdWRlOlxuICAgKiAtIGZldGNoaW5nL2xvYWRpbmcgcmVtb3RlIGNvbmZpZ1xuICAgKiAtIGZldGNoaW5nL2xvYWRpbmcgZmVhdHVyZSBmbGFnc1xuICAgKiAtIGZldGNoaW5nL2xvYWRpbmcgQS9CIHRlc3RpbmcgZGF0YVxuICAgKiAtIGNhbGxpbmcgbmF0aXZlIG1vZHVsZXNcbiAgICogLSBydW5uaW5nIGFyYml0cmFyeSBsb2dpY1xuICAgKlxuICAgKiBAcGFyYW0gcmVzb2x2ZXIgUmVzb2x2ZXIgZnVuY3Rpb24gdG8gYWRkLlxuICAgKiBAcGFyYW0gb3B0aW9ucyBSZXNvbHZlciBvcHRpb25zLlxuICAgKi8ga2V5OiBcImFkZFJlc29sdmVyXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkUmVzb2x2ZXIocmVzb2x2ZXIsIHJlZikge1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICAgICAgICAgICAgICB2YXIgcHJpb3JpdHkgPSBvcHRpb25zLnByaW9yaXR5ID8/IERFRkFVTFRfUkVTT0xWRVJfUFJJT1JJVFk7XG4gICAgICAgICAgICAgICAgdmFyIHVuaXF1ZUtleSA9IG9wdGlvbnMua2V5O1xuICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZXJzID0gdGhpcy5yZXNvbHZlcnMuZmlsdGVyKChyZWYpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMSksIGtleSA9IF9yZWZbMF07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXkgIT09IHVuaXF1ZUtleTtcbiAgICAgICAgICAgICAgICB9KS5jb25jYXQoW1xuICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICB1bmlxdWVLZXkgPz8gREVGQVVMVF9SRVNPTFZFUl9LRVksXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmlvcml0eSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVyXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICBdKS5zb3J0KChyZWYsIHJlZjEpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMiksIGEgPSBfcmVmWzFdLCBfcmVmMSA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYxLCAyKSwgYiA9IF9yZWYxWzFdO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYiAtIGE7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBSZW1vdmVzIHByZXZpb3VzbHkgYWRkZWQgcmVzb2x2ZXIuXG4gICAqXG4gICAqIEBwYXJhbSByZXNvbHZlciBSZXNvbHZlciBmdW5jdGlvbiBvciByZXNvbHZlcidzIGB1bmlxdWVLZXlgIHRvIHJlbW92ZS5cbiAgICogQHJldHVybnMgYHRydWVgIGlmIHJlc29sdmVyIHdhcyBmb3VuZCBhbmQgcmVtb3ZlZCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAqLyBrZXk6IFwicmVtb3ZlUmVzb2x2ZXJcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVSZXNvbHZlcihyZXNvbHZlcikge1xuICAgICAgICAgICAgICAgIHZhciBpbmRleDtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc29sdmVyID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IHRoaXMucmVzb2x2ZXJzLmZpbmRJbmRleCgocmVmKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAxKSwga2V5ID0gX3JlZlswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXkgPT09IHJlc29sdmVyO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IHRoaXMucmVzb2x2ZXJzLmZpbmRJbmRleCgocmVmKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAzKSwgaXRlbSA9IF9yZWZbMl07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbSA9PT0gcmVzb2x2ZXI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc29sdmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogUmVtb3ZlcyBhbGwgcHJldmlvdXNseSBhZGRlZCByZXNvbHZlcnMuXG4gICAqLyBrZXk6IFwicmVtb3ZlQWxsUmVzb2x2ZXJzXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlQWxsUmVzb2x2ZXJzKCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZXJzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0Q2FjaGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0Q2FjaGUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZUluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXNfc3RvcmFnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWNoZUVudHJ5ID0geWllbGQgKF90aGlzX3N0b3JhZ2UgPSB0aGlzLnN0b3JhZ2UpID09PSBudWxsIHx8IF90aGlzX3N0b3JhZ2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzX3N0b3JhZ2UuZ2V0SXRlbShDQUNIRV9LRVkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZSA9IGNhY2hlRW50cnkgPyBKU09OLnBhcnNlKGNhY2hlRW50cnkpIDoge307XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInNhdmVDYWNoZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmVDYWNoZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzX3N0b3JhZ2U7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIChfdGhpc19zdG9yYWdlID0gdGhpcy5zdG9yYWdlKSA9PT0gbnVsbCB8fCBfdGhpc19zdG9yYWdlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpc19zdG9yYWdlLnNldEl0ZW0oQ0FDSEVfS0VZLCBKU09OLnN0cmluZ2lmeSh0aGlzLmNhY2hlKSk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImhhbmRsZUVycm9yXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlRXJyb3IoZXJyb3IsIG1lc3NhZ2UsIC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkuZXJyb3IuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncyksIFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxFcnJvcjogZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF0pKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2Vycm9yJywge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICBhcmdzLFxuICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEVycm9yOiBlcnJvclxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVzb2x2ZVNjcmlwdFwiLFxuICAgICAgICAgICAgdmFsdWU6IC8qKlxuICAgKiBSZXNvbHZlcyBhIHtAbGluayBTY3JpcHR9IGluc3RhbmNlIHdpdGggbm9ybWFsaXplZCBsb2NhdG9yIGRhdGEuXG4gICAqXG4gICAqIFJlc29sdXRpb24gd2lsbCB1c2UgcHJldmlvdXNseSBhZGRlZCAodmlhIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlciguLi4pYCkgcmVzb2x2ZXJzXG4gICAqIGluIHNlcmllcywgdXRpbCBvbmUgcmV0dXJucyBhIGxvY2F0b3IgZGF0YSBvciB3aWxsIHRocm93IGlmIG5vIHJlc29sdmVyIGhhbmRsZWQgdGhlIHJlcXVlc3QuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ3Jlc29sdmluZycsICh7IHNjcmlwdElkLCBjYWxsZXIgfSkgPT4geyB9KWAgdG8gbGlzdGVuIGZvciB3aGVuXG4gICAqIHRoZSBzY3JpcHQgcmVzb2x1dGlvbiBiZWdpbnMuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ3Jlc29sdmVkJywgKHNjcmlwdCkgPT4geyB9KWAgdG8gbGlzdGVuIGZvciB3aGVuXG4gICAqIHRoZSBzY3JpcHQncyBsb2NhdG9yIGRhdGEgaXMgcmVzb2x2ZWQuXG4gICAqXG4gICAqIEBwYXJhbSBzY3JpcHRJZCBJZCBvZiB0aGUgc2NyaXB0IHRvIHJlc29sdmUuXG4gICAqIEBwYXJhbSBjYWxsZXIgTmFtZSBvZiB0aGUgY2FsbGluZyBzY3JpcHQgLSBpdCBjYW4gYmUgZm9yIGV4YW1wbGU6IG5hbWUgb2YgdGhlIGJ1bmRsZSwgY2h1bmsgb3IgY29udGFpbmVyLlxuICAgKi8gZnVuY3Rpb24gcmVzb2x2ZVNjcmlwdChfMCwgXzEsIF8yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooc2NyaXB0SWQsIGNhbGxlciwgcmVmLCByZWZlcmVuY2VVcmwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdlYnBhY2tDb250ZXh0ID0gcmVmID09PSB2b2lkIDAgPyAoMCwgX2dldFdlYnBhY2tDb250ZXh0LmdldFdlYnBhY2tDb250ZXh0KSgpIDogcmVmO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmluaXRDYWNoZSgpO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnJlc29sdmVycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHNjcmlwdCByZXNvbHZlcnMgd2VyZSBhZGRlZC4gRGlkIHlvdSBmb3JnZXQgdG8gY2FsbCBgU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoLi4uKWA/Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ3Jlc29sdmluZycsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfJHJlZiBvZiB0aGlzLnJlc29sdmVycyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8oXyRyZWYsIDMpLCByZXNvbHZlID0gX3JlZlsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdG9yID0geWllbGQgcmVzb2x2ZShzY3JpcHRJZCwgY2FsbGVyLCByZWZlcmVuY2VVcmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbG9jYXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gcmVzb2x2ZXIgd2FzIGFibGUgdG8gcmVzb2x2ZSBzY3JpcHQgJHtzY3JpcHRJZH1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbG9jYXRvci51cmwgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdG9yLnVybCA9IGxvY2F0b3IudXJsKHdlYnBhY2tDb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzY3JpcHQgPSBfU2NyaXB0LlNjcmlwdC5mcm9tKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGxvY2F0b3IsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWNoZUtleSA9IHNjcmlwdC5sb2NhdG9yLnVuaXF1ZUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdXNlciBwcm92aWRlZCBhIGN1c3RvbSBzaG91bGRVcGRhdGVTY3JpcHQgZnVuY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdG9yLnNob3VsZFVwZGF0ZVNjcmlwdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHNvLCB3ZSBuZWVkIHRvIHdhaXQgZm9yIGl0IHRvIHJlc29sdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmV0Y2ggPSB5aWVsZCBsb2NhdG9yLnNob3VsZFVwZGF0ZVNjcmlwdChzY3JpcHRJZCwgY2FsbGVyLCBzY3JpcHQuc2hvdWxkVXBkYXRlQ2FjaGUodGhpcy5jYWNoZVtjYWNoZUtleV0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBpdCByZXR1cm5zIHRydWUsIHdlIG5lZWQgdG8gZmV0Y2ggdGhlIHNjcmlwdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmZXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHQubG9jYXRvci5mZXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgncmVzb2x2ZWQnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQgcmV0dXJucyBmYWxzZSwgd2UgZG9uJ3QgbmVlZCB0byBmZXRjaCB0aGUgc2NyaXB0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjcmlwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIG5vIGN1c3RvbSBzaG91bGRVcGRhdGVTY3JpcHQgZnVuY3Rpb24gd2FzIHByb3ZpZGVkLCB3ZSB1c2UgdGhlIGRlZmF1bHQgYmVoYXZpb3VyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FjaGVbY2FjaGVLZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyaXB0LmxvY2F0b3IuZmV0Y2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzY3JpcHQuc2hvdWxkUmVmZXRjaCh0aGlzLmNhY2hlW2NhY2hlS2V5XSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHQubG9jYXRvci5mZXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ3Jlc29sdmVkJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjcmlwdDtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdbU2NyaXB0TWFuYWdlcl0gRmFpbGVkIHdoaWxlIHJlc29sdmluZyBzY3JpcHQgbG9jYXRvcjonLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyaXB0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJ1cGRhdGVDYWNoZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUNhY2hlKHNjcmlwdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2NyaXB0LmxvY2F0b3IuZmV0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWNoZUtleSA9IHNjcmlwdC5sb2NhdG9yLnVuaXF1ZUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZVtjYWNoZUtleV0gPSBzY3JpcHQuZ2V0Q2FjaGVEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnNhdmVDYWNoZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTY3JpcHRcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogUmVzb2x2ZXMgZ2l2ZW4gc2NyaXB0J3MgbG9jYXRpb24sIGRvd25sb2FkcyBhbmQgZXhlY3V0ZXMgaXQuXG4gICAqIFRoZSBleGVjdXRpb24gb2YgdGhlIGNvZGUgaXMgaGFuZGxlZCBpbnRlcm5hbGx5IGJ5IHRocmVhZGluZyBpbiBSZWFjdCBOYXRpdmUuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ2xvYWRpbmcnLCAoc2NyaXB0KSA9PiB7IH0pYCB0byBsaXN0ZW4gZm9yIHdoZW5cbiAgICogdGhlIHNjcmlwdCBpcyBhYm91dCB0byBiZSBsb2FkZWQuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ2xvYWRlZCcsIChzY3JpcHQpID0+IHsgfSlgIHRvIGxpc3RlbiBmb3Igd2hlblxuICAgKiB0aGUgc2NyaXB0IGlzIGxvYWRlZC5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQgdG8gbG9hZC5cbiAgICogQHBhcmFtIGNhbGxlciBOYW1lIG9mIHRoZSBjYWxsaW5nIHNjcmlwdCAtIGl0IGNhbiBiZSBmb3IgZXhhbXBsZTogbmFtZSBvZiB0aGUgYnVuZGxlLCBjaHVuayBvciBjb250YWluZXIuXG4gICAqLyBmdW5jdGlvbiBsb2FkU2NyaXB0KF8wLCBfMSwgXzIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihzY3JpcHRJZCwgY2FsbGVyLCByZWYsIHJlZmVyZW5jZVVybCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgd2VicGFja0NvbnRleHQgPSByZWYgPT09IHZvaWQgMCA/ICgwLCBfZ2V0V2VicGFja0NvbnRleHQuZ2V0V2VicGFja0NvbnRleHQpKCkgOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1bmlxdWVJZCA9IF9TY3JpcHQuU2NyaXB0LmdldFNjcmlwdFVuaXF1ZUlkKHNjcmlwdElkLCBjYWxsZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNQcmVmZXRjaCA9IHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXS5pc1ByZWZldGNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJlZmV0Y2ggaXMgbm90IGV4ZWN1dGUgdGhlIHNjcmlwdCBzbyB3ZSBuZWVkIHRvIHJ1biBsb2FkU2NyaXB0IGlmIHByb21pc2UgaXMgZm9yIHByZWZldGNoXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNQcmVmZXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFByb2Nlc3MgPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2NyaXB0ID0geWllbGQgdGhpcy5yZXNvbHZlU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIHdlYnBhY2tDb250ZXh0LCByZWZlcmVuY2VVcmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnbG9hZGluZycsIHNjcmlwdC50b09iamVjdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5sb2FkU2NyaXB0V2l0aFJldHJ5KHNjcmlwdElkLCBzY3JpcHQubG9jYXRvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnbG9hZGVkJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnVwZGF0ZUNhY2hlKHNjcmlwdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBlcnJvci5jb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCAnW1NjcmlwdE1hbmFnZXJdIEZhaWxlZCB0byBsb2FkIHNjcmlwdDonLCBjb2RlID8gYFske2NvZGV9XWAgOiAnJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2hvdWxkIGRlbGV0ZSBzY3JpcHQgcHJvbWlzZSBldmVuIHNjcmlwdCBmYWlsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0gPSBsb2FkUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2FkU2NyaXB0V2l0aFJldHJ5XCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIExvYWRzIGEgc2NyaXB0IHdpdGggcmV0cnkgbG9naWMuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb24gYXR0ZW1wdHMgdG8gbG9hZCBhIHNjcmlwdCB1c2luZyB0aGUgbmF0aXZlU2NyaXB0TWFuYWdlci5cbiAgICogSWYgdGhlIGluaXRpYWwgYXR0ZW1wdCBmYWlscywgaXQgcmV0cmllcyB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lc1xuICAgKiB3aXRoIGFuIG9wdGlvbmFsIGRlbGF5IGJldHdlZW4gcmV0cmllcy5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNjcmlwdElkIC0gVGhlIElEIG9mIHRoZSBzY3JpcHQgdG8gbG9hZC5cbiAgICogQHBhcmFtIHtOb3JtYWxpemVkU2NyaXB0TG9jYXRvcn0gbG9jYXRvciAtIEFuIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yIGNvbnRhaW5pbmcgcmV0cnkgY29uZmlndXJhdGlvbi5cbiAgICogQHBhcmFtIHtudW1iZXJ9IFtsb2NhdG9yLnJldHJ5PTBdIC0gVGhlIG51bWJlciBvZiByZXRyeSBhdHRlbXB0cy5cbiAgICogQHBhcmFtIHtudW1iZXJ9IFtsb2NhdG9yLnJldHJ5RGVsYXk9MF0gLSBUaGUgZGVsYXkgaW4gbWlsbGlzZWNvbmRzIGJldHdlZW4gcmV0cmllcy5cbiAgICogQHRocm93cyB7RXJyb3J9IFRocm93cyBhbiBlcnJvciBpZiBhbGwgcmV0cnkgYXR0ZW1wdHMgZmFpbC5cbiAgICovIGZ1bmN0aW9uIGxvYWRTY3JpcHRXaXRoUmV0cnkoc2NyaXB0SWQsIGxvY2F0b3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9sb2NhdG9yX3JldHJ5ID0gbG9jYXRvci5yZXRyeSwgcmV0cnkgPSBfbG9jYXRvcl9yZXRyeSA9PT0gdm9pZCAwID8gMCA6IF9sb2NhdG9yX3JldHJ5LCBfbG9jYXRvcl9yZXRyeURlbGF5ID0gbG9jYXRvci5yZXRyeURlbGF5LCByZXRyeURlbGF5ID0gX2xvY2F0b3JfcmV0cnlEZWxheSA9PT0gdm9pZCAwID8gMCA6IF9sb2NhdG9yX3JldHJ5RGVsYXk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhdHRlbXB0cyA9IHJldHJ5ICsgMTsgLy8gSW5jbHVkZSB0aGUgaW5pdGlhbCBhdHRlbXB0XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlKGF0dGVtcHRzID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMubmF0aXZlU2NyaXB0TWFuYWdlci5sb2FkU2NyaXB0KHNjcmlwdElkLCBsb2NhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47IC8vIFN1Y2Nlc3NmdWxseSBsb2FkZWQgdGhlIHNjcmlwdCwgZXhpdCB0aGUgbG9vcFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRlbXB0cy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZXJyb3IuY29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ZW1wdHMgPiAwICYmIExPQURJTkdfRVJST1JfQ09ERVMuaW5jbHVkZXMoY29kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJldHJ5RGVsYXkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBuZXcgUHJvbWlzZSgocmVzb2x2ZSk9PnNldFRpbWVvdXQocmVzb2x2ZSwgcmV0cnlEZWxheSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7IC8vIE5vIG1vcmUgcmV0cmllcywgdGhyb3cgdGhlIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInByZWZldGNoU2NyaXB0XCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIFJlc29sdmVzIGdpdmVuIHNjcmlwdCdzIGxvY2F0aW9uIGFuZCBkb3dubG9hZHMgaXQgd2l0aG91dCBleGVjdXRpbmcuXG4gICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGF3YWl0ZWQgdG8gZGV0ZWN0IGlmIHRoZSBzY3JpcHQgd2FzIGRvd25sb2FkZWQgYW5kIGZvciBlcnJvciBoYW5kbGluZy5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbigncHJlZmV0Y2hpbmcnLCAoc2NyaXB0KSA9PiB7IH0pYCB0byBsaXN0ZW4gZm9yIHdoZW5cbiAgICogdGhlIHNjcmlwdCdzIHByZWZldGNoIGJlaW5ncy5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQgdG8gcHJlZmV0Y2guXG4gICAqIEBwYXJhbSBjYWxsZXIgTmFtZSBvZiB0aGUgY2FsbGluZyBzY3JpcHQgLSBpdCBjYW4gYmUgZm9yIGV4YW1wbGU6IG5hbWUgb2YgdGhlIGJ1bmRsZSwgY2h1bmsgb3IgY29udGFpbmVyLlxuICAgKi8gZnVuY3Rpb24gcHJlZmV0Y2hTY3JpcHQoXzAsIF8xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooc2NyaXB0SWQsIGNhbGxlciwgcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB3ZWJwYWNrQ29udGV4dCA9IHJlZiA9PT0gdm9pZCAwID8gKDAsIF9nZXRXZWJwYWNrQ29udGV4dC5nZXRXZWJwYWNrQ29udGV4dCkoKSA6IHJlZjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVuaXF1ZUlkID0gX1NjcmlwdC5TY3JpcHQuZ2V0U2NyaXB0VW5pcXVlSWQoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRQcm9jZXNzID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdCA9IHlpZWxkIHRoaXMucmVzb2x2ZVNjcmlwdChzY3JpcHRJZCwgY2FsbGVyLCB3ZWJwYWNrQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdwcmVmZXRjaGluZycsIHNjcmlwdC50b09iamVjdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5uYXRpdmVTY3JpcHRNYW5hZ2VyLnByZWZldGNoU2NyaXB0KHNjcmlwdElkLCBzY3JpcHQubG9jYXRvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMudXBkYXRlQ2FjaGUoc2NyaXB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29kZSA9IGVycm9yLmNvZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdbU2NyaXB0TWFuYWdlcl0gRmFpbGVkIHRvIHByZWZldGNoIHNjcmlwdDonLCBjb2RlID8gYFske2NvZGV9XWAgOiAnJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2hvdWxkIGRlbGV0ZSBzY3JpcHQgcHJvbWlzZSBldmVuIHNjcmlwdCBmYWlsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0gPSBsb2FkUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0uaXNQcmVmZXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF07XG4gICAgICAgICAgICAgICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImludmFsaWRhdGVTY3JpcHRzXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIENsZWFycyB0aGUgY2FjaGUgKGlmIGNvbmZpZ3VyZWQgaW4ge0BsaW5rIFNjcmlwdE1hbmFnZXIuc2V0U3RvcmFnZX0pIGFuZCByZW1vdmVzIGRvd25sb2FkZWRcbiAgICogZmlsZXMgZm9yIGdpdmVuIHNjcmlwdHMgZnJvbSB0aGUgZmlsZXN5c3RlbS4gVGhpcyBmdW5jdGlvbiBjYW4gYmUgYXdhaXRlZCB0byBkZXRlY3QgaWYgdGhlXG4gICAqIHNjcmlwdHMgd2VyZSBpbnZhbGlkYXRlZCBhbmQgZm9yIGVycm9yIGhhbmRsaW5nLlxuICAgKlxuICAgKiBVc2UgYFNjcmlwdE1hbmFnZXIuc2hhcmVkLm9uKCdpbnZhbGlkYXRlZCcsIChzY3JpcHRJZHMpID0+IHsgfSlgIHRvIGxpc3RlbiBmb3Igd2hlblxuICAgKiB0aGUgaW52YWxpZGF0aW9uIGNvbXBsZXRlcy5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkcyBBcnJheSBvZiBzY3JpcHQgaWRzIHRvIGNsZWFyIGZyb20gY2FjaGUgYW5kIHJlbW92ZSBmcm9tIGZpbGVzeXN0ZW0uXG4gICAqIEByZXR1cm5zIEFycmF5IG9mIHNjcmlwdCBpZHMgdGhhdCB3ZXJlIGludmFsaWRhdGVkLlxuICAgKi8gZnVuY3Rpb24gaW52YWxpZGF0ZVNjcmlwdHMoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzY3JpcHRJZHMgPSByZWYgPT09IHZvaWQgMCA/IFtdIDogcmVmO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5pbml0Q2FjaGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHMgPSBzY3JpcHRJZHMubGVuZ3RoID8gc2NyaXB0SWRzIDogT2JqZWN0LmtleXModGhpcy5jYWNoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZHMuZm9yRWFjaCgoc2NyaXB0SWQpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuY2FjaGVbc2NyaXB0SWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNjcmlwdHNQcm9taXNlc1tzY3JpcHRJZF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2F2ZUNhY2hlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLm5hdGl2ZVNjcmlwdE1hbmFnZXIuaW52YWxpZGF0ZVNjcmlwdHMoc2NyaXB0SWRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnaW52YWxpZGF0ZWQnLCBpZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlkcztcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZXJyb3IuY29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdbU2NyaXB0TWFuYWdlcl0gRmFpbGVkIHRvIGludmFsaWRhdGUgc2NyaXB0czonLCBjb2RlID8gYFske2NvZGV9XWAgOiAnJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogRXZhbHVhdGVzIGEgc2NyaXB0IHN5bmNocm9ub3VzbHkuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb24gc2VuZHMgdGhlIHNjcmlwdCBzb3VyY2UgYW5kIGl0cyBVUkwgdG8gdGhlIG5hdGl2ZSBzY3JpcHQgbWFuYWdlciBmb3IgZXZhbHVhdGlvbi5cbiAgICogSXQgaXMgZnVuY3Rpb25hbGx5IGlkZW50aWNhbCB0byBgZ2xvYmFsRXZhbFdpdGhTb3VyY2VVcmxgLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0U291cmNlIFRoZSBzb3VyY2UgY29kZSBvZiB0aGUgc2NyaXB0IHRvIGV2YWx1YXRlLlxuICAgKiBAcGFyYW0gc2NyaXB0U291cmNlVXJsIFRoZSBVUkwgb2YgdGhlIHNjcmlwdCBzb3VyY2UsIHVzZWQgZm9yIGRlYnVnZ2luZyBwdXJwb3Nlcy5cbiAgICovIGtleTogXCJ1bnN0YWJsZV9ldmFsdWF0ZVNjcmlwdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVuc3RhYmxlX2V2YWx1YXRlU2NyaXB0KHNjcmlwdFNvdXJjZSwgc2NyaXB0U291cmNlVXJsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVTY3JpcHRNYW5hZ2VyLnVuc3RhYmxlX2V2YWx1YXRlU2NyaXB0KHNjcmlwdFNvdXJjZSwgc2NyaXB0U291cmNlVXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImluaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgICAgIGlmICghX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIgPSBuZXcgU2NyaXB0TWFuYWdlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInNoYXJlZFwiLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gU2NyaXB0TWFuYWdlcjtcbn0gLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2NyaXB0TWFuYWdlci5qcy5tYXBcbihfZXZlbnRzLmRlZmF1bHQpO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9mZWRlcmF0ZWQuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9mZWRlcmF0ZWQuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJGZWRlcmF0ZWRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBGZWRlcmF0ZWQ7XG4gICAgfVxufSkpO1xudmFyIF9hc3luY190b19nZW5lcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fYXN5bmNfdG9fZ2VuZXJhdG9yICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiKTtcbnZhciBfU2NyaXB0TWFuYWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vU2NyaXB0TWFuYWdlci5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL1NjcmlwdE1hbmFnZXIuanNcIik7XG52YXIgRmVkZXJhdGVkO1xuKGZ1bmN0aW9uKF9GZWRlcmF0ZWQpIHtcbiAgICAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICpcbiAgICogUmVzb2x2ZXMgVVJMIHRvIGEgY29udGFpbmVyIG9yIGEgY2h1bmsgd2hlbiB1c2luZyBNb2R1bGUgRmVkZXJhdGlvbixcbiAgICogYmFzZWQgb24gZ2l2ZW4gYHNjcmlwdElkYCBhbmQgYGNhbGxlcmAuXG4gICAqLyAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICpcbiAgICogQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB7QGxpbmsgY3JlYXRlVVJMUmVzb2x2ZXJ9IGZvciBNb2R1bGUgRmVkZXJhdGlvbi5cbiAgICogQWxsb3dzIHRvIGNvbmZpZ3VyZSBob3cgY3JlYXRlZCB7QGxpbmsgVVJMUmVzb2x2ZXJ9IHdpbGwgYmVoYXZlLlxuICAgKi8gLyoqXG4gICAqIEBkZXByZWNhdGVkXG4gICAqXG4gICAqIENyZWF0ZXMgVVJMIHJlc29sdmVyIGZvciBNb2R1bGUgRmVkZXJhdGlvbiBmcm9tIHByb3ZpZGVkIGNvbmZpZy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHNcbiAgICogaW1wb3J0IHsgU2NyaXB0TWFuYWdlciwgU2NyaXB0LCBGZWRlcmF0ZWQgfSBmcm9tICdAY2FsbHN0YWNrL3JlcGFjay9jbGllbnQnO1xuICAgKlxuICAgKiBjb25zdCByZXNvbHZlVVJMID0gRmVkZXJhdGVkLmNyZWF0ZVVSTFJlc29sdmVyKHtcbiAgICogICBjb250YWluZXJzOiB7XG4gICAqICAgICBhcHAxOiAnaHR0cDovL2xvY2FsaG9zdDo5MDAxL1tuYW1lXVtleHRdJyxcbiAgICogICAgIGFwcDI6ICdodHRwOi8vbG9jYWxob3N0OjkwMDIvW25hbWVdLmNvbnRhaW5lci5qcycsXG4gICAqICAgfSxcbiAgICogICBjaHVua3M6IHtcbiAgICogICAgIGFwcDI6ICdodHRwOi8vbG9jYWxob3N0OjkwMDIvY2h1bmtzL1tuYW1lXVtleHRdJyxcbiAgICogICB9LFxuICAgKiB9KTtcbiAgICpcbiAgICogU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoYXN5bmMgKHNjcmlwdElkLCBjYWxsZXIpID0+IHtcbiAgICogICBsZXQgdXJsO1xuICAgKiAgIGlmIChjYWxsZXIgPT09ICdtYWluJykge1xuICAgKiAgICAgdXJsID0gX19ERVZfX1xuICAgKiAgICAgICA/IFNjcmlwdC5nZXREZXZTZXJ2ZXJVUkwoc2NyaXB0SWQpXG4gICAqICAgICAgIDogU2NyaXB0LmdldFJlbW90ZVVSTChgaHR0cDovL2xvY2FsaG9zdDo5MDAwLyR7c2NyaXB0SWR9YCk7XG4gICAqICAgfSBlbHNlIHtcbiAgICogICAgIHVybCA9IHJlc29sdmVVUkwoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAqICAgfVxuICAgKlxuICAgKiAgIGlmICghdXJsKSB7XG4gICAqICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgKiAgIH1cbiAgICpcbiAgICogICByZXR1cm4ge1xuICAgKiAgICAgdXJsLFxuICAgKiAgICAgcXVlcnk6IHtcbiAgICogICAgICAgcGxhdGZvcm06IFBsYXRmb3JtLk9TLFxuICAgKiAgICAgfSxcbiAgICogICB9O1xuICAgKiB9KTtcbiAgICogYGBgXG4gICAqXG4gICAqIGBjcmVhdGVVUkxSZXNvbHZlcmAgaXMgYSBhYnN0cmFjdGlvbiBvdmVyIHtAbGluayBTY3JpcHQuZ2V0UmVtb3RlVVJMfSxcbiAgICogZm9yIGV4YW1wbGU6XG4gICAqIGBgYHRzXG4gICAqIGltcG9ydCB7IFNjcmlwdE1hbmFnZXIsIEZlZGVyYXRlZCB9IGZyb20gJ0BjYWxsc3RhY2svcmVwYWNrL2NsaWVudCc7XG4gICAqXG4gICAqIFNjcmlwdE1hbmFnZXIuc2hhcmVkLmFkZFJlc29sdmVyKChzY3JpcHRJZCwgY2FsbGVyKSA9PiB7XG4gICAqICAgY29uc3QgcmVzb2x2ZVVSTCA9IEZlZGVyYXRlZC5jcmVhdGVVUkxSZXNvbHZlcih7XG4gICAqICAgICBjb250YWluZXJzOiB7XG4gICAqICAgICAgIGFwcDE6ICdodHRwOi8vbG9jYWxob3N0OjkwMDAvW25hbWVdW2V4dF0nLFxuICAgKiAgICAgfSxcbiAgICogICB9KTtcbiAgICpcbiAgICogICByZXR1cm4ge1xuICAgKiAgICAgdXJsOiByZXNvbHZlVVJMKHNjcmlwdElkLCBjYWxsZXIpO1xuICAgKiAgIH07XG4gICAqIH0pO1xuICAgKiBgYGBcbiAgICogaXMgZXF1aXZhbGVudCB0bzpcbiAgICogYGBgdHNcbiAgICogaW1wb3J0IHsgU2NyaXB0TWFuYWdlciwgU2NyaXB0IH0gZnJvbSAnQGNhbGxzdGFjay9yZXBhY2svY2xpZW50JztcbiAgICpcbiAgICogU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoYXN5bmMgKHNjcmlwdElkLCBjYWxsZXIpID0+IHtcbiAgICogICBpZiAoc2NyaXB0SWQgPT09ICdhcHAxJykge1xuICAgKiAgICAgcmV0dXJuIHtcbiAgICogICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo5MDAwL2FwcDEuY29udGFpbmVyLmJ1bmRsZScsXG4gICAqICAgICB9O1xuICAgKiAgIH1cbiAgICpcbiAgICogICBpZiAoY2FsbGVyID09PSAnYXBwMScpIHtcbiAgICogICAgIHJldHVybiB7XG4gICAqICAgICAgIHVybDogU2NyaXB0LmdldFJlbW90ZVVSTChgaHR0cDovL2xvY2FsaG9zdDo5MDAwLyR7c2NyaXB0SWR9YCksXG4gICAqICAgICB9O1xuICAgKiAgIH1cbiAgICogfSk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gY29uZmlnIENvbmZpZ3VyYXRpb24gZm9yIHRoZSByZXNvbHZlci5cbiAgICogQHBhcmFtIGNvbnRhaW5lckV4dCBFeHRlbnNpb24gb2YgY29udGFpbmVyIGJ1bmRsZXMuIERlZmF1bHRzIHRvIGAuY29udGFpbmVyLmJ1bmRsZWAuXG4gICAqIEByZXR1cm5zIEEgcmVzb2x2ZXIgZnVuY3Rpb24gd2hpY2ggd2lsbCB0cnkgdG8gcmVzb2x2ZSBVUkwgYmFzZWQgb24gZ2l2ZW4gYHNjcmlwdElkYCBhbmQgYGNhbGxlcmAuXG4gICAqLyBmdW5jdGlvbiBjcmVhdGVVUkxSZXNvbHZlcihjb25maWcsIHJlZikge1xuICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIHJlc29sdmVyc1trZXldID0gKHNjcmlwdElkLCBjYWxsZXIpPT57XG4gICAgICAgICAgICAgICAgaWYgKHNjcmlwdElkID09PSBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGNvbmZpZy5jb250YWluZXJzW2tleV0ucmVwbGFjZSgvXFxbbmFtZVxcXS9nLCBzY3JpcHRJZCkucmVwbGFjZSgvXFxbZXh0XFxdL2csIGNvbnRhaW5lckV4dCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjYWxsZXIgPT09IGtleSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2NvbmZpZ19jaHVua3M7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwxID0gKCgoX2NvbmZpZ19jaHVua3MgPSBjb25maWcuY2h1bmtzKSA9PT0gbnVsbCB8fCBfY29uZmlnX2NodW5rcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NvbmZpZ19jaHVua3Nba2V5XSkgPz8gY29uZmlnLmNvbnRhaW5lcnNba2V5XSkucmVwbGFjZSgvXFxbbmFtZVxcXS9nLCBzY3JpcHRJZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cmwxLmluY2x1ZGVzKCdbZXh0XScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHdlYnBhY2tDb250ZXh0KT0+d2VicGFja0NvbnRleHQudSh1cmwxLnJlcGxhY2UoL1xcW2V4dFxcXS9nLCAnJykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmwxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGNvbnRhaW5lckV4dCA9IHJlZiA9PT0gdm9pZCAwID8gJy5jb250YWluZXIuYnVuZGxlJyA6IHJlZjtcbiAgICAgICAgdmFyIHJlc29sdmVycyA9IHt9O1xuICAgICAgICBmb3IodmFyIGtleSBpbiBjb25maWcuY29udGFpbmVycylfbG9vcChrZXkpO1xuICAgICAgICByZXR1cm4gKHNjcmlwdElkLCBjYWxsZXIpPT57XG4gICAgICAgICAgICB2YXIgcmVzb2x2ZXIgPSAoY2FsbGVyID8gcmVzb2x2ZXJzW2NhbGxlcl0gOiB1bmRlZmluZWQpID8/IHJlc29sdmVyc1tzY3JpcHRJZF07XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZXIoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAgICAgIH07XG4gICAgfVxuICAgIF9GZWRlcmF0ZWQuY3JlYXRlVVJMUmVzb2x2ZXIgPSBjcmVhdGVVUkxSZXNvbHZlcjtcbiAgICAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICpcbiAgICogRHluYW1pY2FsbHkgaW1wb3J0cyBtb2R1bGUgZnJvbSBhIE1vZHVsZSBGZWRlcmF0aW9uIGNvbnRhaW5lci4gU2ltaWxhciB0byBgaW1wb3J0KCdmaWxlJylgLCBidXRcbiAgICogc3BlY2lmaWMgdG8gTW9kdWxlIEZlZGVyYXRpb24uIENhbGxpbmcgYGltcG9ydE1vZHVsZWAgd2lsbCBjcmVhdGUgYW4gYXN5bmMgYm91bmRhcnkuXG4gICAqXG4gICAqIENvbnRhaW5lciB3aWxsIGJlIGV2YWx1YXRlZCBvbmx5IG9uY2UuIElmIHlvdSB1c2UgYGltcG9ydE1vZHVsZWAgZm9yIHRoZSBzYW1lIGNvbnRhaW5lciB0d2ljZSxcbiAgICogdGhlIGNvbnRhaW5lciB3aWxsIGJlIGxvYWRlZCBhbmQgZXZhbHVhdGVkIG9ubHkgb24gdGhlIGZpcnN0IGltcG9ydC5cbiAgICpcbiAgICogVW5kZXIgdGhlIGhvb2QsIGBpbXBvcnRNb2R1bGVgIHdpbGwgY2FsbCBgU2NyaXB0TWFuYWdlci5zaGFyZWQubG9hZFNjcmlwdChjb250YWluZXJOYW1lKWAuXG4gICAqIFRoaXMgbWVhbnMsIGEgcmVzb2x2ZXIgbXVzdCBiZSBhZGRlZCB3aXRoIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlciguLi4pYCBiZWZvcmVoYW5kIGFuZCBwcm92aWRlZCBwcm9wZXJcbiAgICogcmVzb2x1dGlvbiBsb2dpYyB0byByZXNvbHZlIFVSTCBiYXNlZCBvbiB0aGUgYGNvbnRhaW5lck5hbWVgLlxuICAgKlxuICAgKiBAcGFyYW0gY29udGFpbmVyTmFtZSBOYW1lIG9mIHRoZSBjb250YWluZXIgLSBzaG91bGQgYmUgdGhlIHNhbWUgbmFtZSBwcm92aWRlZCB0b1xuICAgKiBgd2VicGFjay5jb250YWluZXIuTW9kdWxlRmVkZXJhdGlvblBsdWdpbmAgaW4gYGxpYnJhcnkubmFtZWAuXG4gICAqIEBwYXJhbSBtb2R1bGUgRnVsbCBuYW1lIHdpdGggZXh0ZW5zaW9uIG9mIHRoZSBtb2R1bGUgdG8gaW1wb3J0IGZyb20gdGhlIGNvbnRhaW5lciAtIG9ubHkgbW9kdWxlc1xuICAgKiBleHBvc2VkIGluIGBleHBvc2VzYCBpbiBgd2VicGFjay5jb250YWluZXIuTW9kdWxlRmVkZXJhdGlvblBsdWdpbmAgY2FuIGJlIHVzZWQuXG4gICAqIEBwYXJhbSBzY29wZSBPcHRpb25hbCwgc2NvcGUgZm9yIHNoYXJpbmcgbW9kdWxlcyBiZXR3ZWVuIGNvbnRhaW5lcnMuIERlZmF1bHRzIHRvIGAnZGVmYXVsdCdgLlxuICAgKiBAcmV0dXJucyBFeHBvcnRzIG9mIGdpdmVuIGBtb2R1bGVgIGZyb20gZ2l2ZW4gY29udGFpbmVyLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG4gICAqIGltcG9ydCB7IEZlZGVyYXRlZCB9IGZyb20gJ0BjYWxsc3RhY2svcmVwYWNrL2NsaWVudCc7XG4gICAqXG4gICAqIGNvbnN0IEJ1dHRvbiA9IFJlYWN0LmxhenkoKCkgPT4gRmVkZXJhdGVkLmltcG9ydE1vZHVsZSgnbXktY29tcG9uZW50cycsICcuL0J1dHRvbi5qcycpKTtcbiAgICpcbiAgICogY29uc3QgbXlVdGlsID0gYXdhaXQgRmVkZXJhdGVkLmltcG9ydE1vZHVsZSgnbXktbGliJywgJy4vbXlVdGlsLmpzJyk7XG4gICAqIGBgYFxuICAgKi8gZnVuY3Rpb24gaW1wb3J0TW9kdWxlKGNvbnRhaW5lck5hbWUsIG1vZHVsZSwgcmVmKSB7XG4gICAgICAgIHZhciBzY29wZSA9IHJlZiA9PT0gdm9pZCAwID8gJ2RlZmF1bHQnIDogcmVmO1xuICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgIHZhciBfX3dlYnBhY2tfc2hhcmVfc2NvcGVzX19fc2NvcGU7XG4gICAgICAgICAgICBpZiAoISgoX193ZWJwYWNrX3NoYXJlX3Njb3Blc19fX3Njb3BlID0gX193ZWJwYWNrX3JlcXVpcmVfXy5TW3Njb3BlXSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3NoYXJlX3Njb3Blc19fX3Njb3BlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfc2hhcmVfc2NvcGVzX19fc2NvcGUuX19pc0luaXRpYWxpemVkKSkge1xuICAgICAgICAgICAgICAgIC8vIEluaXRpYWxpemVzIHRoZSBzaGFyZSBzY29wZS5cbiAgICAgICAgICAgICAgICAvLyBUaGlzIGZpbGxzIGl0IHdpdGgga25vd24gcHJvdmlkZWQgbW9kdWxlcyBmcm9tIHRoaXMgYnVpbGQgYW5kIGFsbCByZW1vdGVzLlxuICAgICAgICAgICAgICAgIHlpZWxkIF9fd2VicGFja19yZXF1aXJlX18uSShzY29wZSk7XG4gICAgICAgICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5TW3Njb3BlXS5fX2lzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRG8gbm90IHVzZSBgY29uc3QgY29udGFpbmVyID0gc2VsZltjb250YWluZXJOYW1lXTtgIGhlcmUuIE9uY2UgY29udGFpbmVyIGlzIGxvYWRlZFxuICAgICAgICAgICAgLy8gYGNvbnRhaW5lcmAgcmVmZXJlbmNlIGlzIG5vdCB1cGRhdGVkLCBzbyBgY29udGFpbmVyLl9faXNJbml0aWFsaXplZGBcbiAgICAgICAgICAgIC8vIHdpbGwgY3Jhc2ggdGhlIGFwcGxpY2F0aW9uLCBiZWNhdXNlIG9mIHJlYWRpbmcgcHJvcGVydHkgZnJvbSBgdW5kZWZpbmVkYC5cbiAgICAgICAgICAgIGlmICghc2VsZltjb250YWluZXJOYW1lXSkge1xuICAgICAgICAgICAgICAgIC8vIERvd25sb2FkIGFuZCBleGVjdXRlIGNvbnRhaW5lclxuICAgICAgICAgICAgICAgIHlpZWxkIF9TY3JpcHRNYW5hZ2VyLlNjcmlwdE1hbmFnZXIuc2hhcmVkLmxvYWRTY3JpcHQoY29udGFpbmVyTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY29udGFpbmVyID0gc2VsZltjb250YWluZXJOYW1lXTtcbiAgICAgICAgICAgIGlmICghY29udGFpbmVyLl9faXNJbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5fX2lzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGNvbnRhaW5lciwgaXQgbWF5IHByb3ZpZGUgc2hhcmVkIG1vZHVsZXNcbiAgICAgICAgICAgICAgICB5aWVsZCBjb250YWluZXIuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLlNbc2NvcGVdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmYWN0b3J5ID0geWllbGQgY29udGFpbmVyLmdldChtb2R1bGUpO1xuICAgICAgICAgICAgdmFyIGV4cG9ydHMxID0gZmFjdG9yeSgpO1xuICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMxO1xuICAgICAgICB9KSgpO1xuICAgIH1cbiAgICBfRmVkZXJhdGVkLmltcG9ydE1vZHVsZSA9IGltcG9ydE1vZHVsZTtcbn0pKEZlZGVyYXRlZCB8fCAoRmVkZXJhdGVkID0ge30pKTsgLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmVkZXJhdGVkLmpzLm1hcFxuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9nZXRXZWJwYWNrQ29udGV4dC5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvZ2V0V2VicGFja0NvbnRleHQuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4vKipcbiAqIEdldCBXZWJwYWNrIHJ1bnRpbWUgY29udGV4dCBmb3JtIGN1cnJlbnQgSmF2YVNjcmlwdCBzY29wZS5cbiAqXG4gKiBfX1lvdSBsaWtlbHkgZG9uJ3QgbmVlZCB0byB1c2UgaXQuX19cbiAqLyBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImdldFdlYnBhY2tDb250ZXh0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gZ2V0V2VicGFja0NvbnRleHQ7XG4gICAgfVxufSkpO1xuZnVuY3Rpb24gZ2V0V2VicGFja0NvbnRleHQoKSB7XG4gICAgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX187XG59IC8vIyBzb3VyY2VNYXBwaW5nVVJMPWdldFdlYnBhY2tDb250ZXh0LmpzLm1hcFxuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9pbmRleC5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvaW5kZXguanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkZlZGVyYXRlZFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9mZWRlcmF0ZWQuRmVkZXJhdGVkO1xuICAgIH1cbn0pKTtcbnZhciBfZXhwb3J0X3N0YXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fZXhwb3J0X3N0YXIgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19leHBvcnRfc3Rhci5janNcIik7XG5fZXhwb3J0X3N0YXIuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL1NjcmlwdE1hbmFnZXIuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHRNYW5hZ2VyLmpzXCIpLCBleHBvcnRzKTtcbl9leHBvcnRfc3Rhci5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vU2NyaXB0LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0LmpzXCIpLCBleHBvcnRzKTtcbl9leHBvcnRfc3Rhci5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdHlwZXMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci90eXBlcy5qc1wiKSwgZXhwb3J0cyk7XG5fZXhwb3J0X3N0YXIuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL2dldFdlYnBhY2tDb250ZXh0LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvZ2V0V2VicGFja0NvbnRleHQuanNcIiksIGV4cG9ydHMpO1xudmFyIF9mZWRlcmF0ZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL2ZlZGVyYXRlZC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2ZlZGVyYXRlZC5qc1wiKTtcbiAvLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvdHlwZXMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL3R5cGVzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG4gLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHlwZXMuanMubWFwXG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZGVmYXVsdFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9Db3JlUGx1Z2luLmRlZmF1bHQ7XG4gICAgfVxufSkpO1xudmFyIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiKTtcbnZhciBfQ29yZVBsdWdpbiA9IC8qI19fUFVSRV9fKi8gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0Ll8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vZGlzdC9tb2R1bGVzL0ZlZGVyYXRpb25SdW50aW1lUGx1Z2lucy9Db3JlUGx1Z2luLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL0ZlZGVyYXRpb25SdW50aW1lUGx1Z2lucy9Db3JlUGx1Z2luLmpzXCIpKTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZGVmYXVsdFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9SZXNvbHZlclBsdWdpbi5kZWZhdWx0O1xuICAgIH1cbn0pKTtcbnZhciBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janNcIik7XG52YXIgX1Jlc29sdmVyUGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL1Jlc29sdmVyUGx1Z2luLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL0ZlZGVyYXRpb25SdW50aW1lUGx1Z2lucy9SZXNvbHZlclBsdWdpbi5qc1wiKSk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9lcnJvci1jb2Rlcy9kaXN0L2luZGV4LmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9lcnJvci1jb2Rlcy9kaXN0L2luZGV4LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIFJVTlRJTUVfMDAxID0gJ1JVTlRJTUUtMDAxJztcbnZhciBSVU5USU1FXzAwMiA9ICdSVU5USU1FLTAwMic7XG52YXIgUlVOVElNRV8wMDMgPSAnUlVOVElNRS0wMDMnO1xudmFyIFJVTlRJTUVfMDA0ID0gJ1JVTlRJTUUtMDA0JztcbnZhciBSVU5USU1FXzAwNSA9ICdSVU5USU1FLTAwNSc7XG52YXIgUlVOVElNRV8wMDYgPSAnUlVOVElNRS0wMDYnO1xudmFyIFJVTlRJTUVfMDA3ID0gJ1JVTlRJTUUtMDA3JztcbnZhciBSVU5USU1FXzAwOCA9ICdSVU5USU1FLTAwOCc7XG52YXIgVFlQRV8wMDEgPSAnVFlQRS0wMDEnO1xudmFyIEJVSUxEXzAwMSA9ICdCVUlMRC0wMDEnO1xudmFyIGdldERvY3NVcmwgPSAoZXJyb3JDb2RlKT0+e1xuICAgIHZhciB0eXBlID0gZXJyb3JDb2RlLnNwbGl0KCctJylbMF0udG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gYGh0dHBzOi8vbW9kdWxlLWZlZGVyYXRpb24uaW8vZ3VpZGUvdHJvdWJsZXNob290aW5nLyR7dHlwZX0vJHtlcnJvckNvZGV9YDtcbn07XG52YXIgZ2V0U2hvcnRFcnJvck1zZyA9IChlcnJvckNvZGUsIGVycm9yRGVzY01hcCwgYXJncywgb3JpZ2luYWxFcnJvck1zZyk9PntcbiAgICB2YXIgbXNnID0gW1xuICAgICAgICBgJHtbXG4gICAgICAgICAgICBlcnJvckRlc2NNYXBbZXJyb3JDb2RlXVxuICAgICAgICBdfSAjJHtlcnJvckNvZGV9YFxuICAgIF07XG4gICAgYXJncyAmJiBtc2cucHVzaChgYXJnczogJHtKU09OLnN0cmluZ2lmeShhcmdzKX1gKTtcbiAgICBtc2cucHVzaChnZXREb2NzVXJsKGVycm9yQ29kZSkpO1xuICAgIG9yaWdpbmFsRXJyb3JNc2cgJiYgbXNnLnB1c2goYE9yaWdpbmFsIEVycm9yIE1lc3NhZ2U6XFxuICR7b3JpZ2luYWxFcnJvck1zZ31gKTtcbiAgICByZXR1cm4gbXNnLmpvaW4oJ1xcbicpO1xufTtcbmZ1bmN0aW9uIF9leHRlbmRzKCkge1xuICAgIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0KSB7XG4gICAgICAgIGZvcih2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGZvcih2YXIga2V5IGluIHNvdXJjZSlpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH07XG4gICAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG52YXIgcnVudGltZURlc2NNYXAgPSB7XG4gICAgW1JVTlRJTUVfMDAxXTogJ0ZhaWxlZCB0byBnZXQgcmVtb3RlRW50cnkgZXhwb3J0cy4nLFxuICAgIFtSVU5USU1FXzAwMl06ICdUaGUgcmVtb3RlIGVudHJ5IGludGVyZmFjZSBkb2VzIG5vdCBjb250YWluIFwiaW5pdFwiJyxcbiAgICBbUlVOVElNRV8wMDNdOiAnRmFpbGVkIHRvIGdldCBtYW5pZmVzdC4nLFxuICAgIFtSVU5USU1FXzAwNF06ICdGYWlsZWQgdG8gbG9jYXRlIHJlbW90ZS4nLFxuICAgIFtSVU5USU1FXzAwNV06ICdJbnZhbGlkIGxvYWRTaGFyZVN5bmMgZnVuY3Rpb24gY2FsbCBmcm9tIGJ1bmRsZXIgcnVudGltZScsXG4gICAgW1JVTlRJTUVfMDA2XTogJ0ludmFsaWQgbG9hZFNoYXJlU3luYyBmdW5jdGlvbiBjYWxsIGZyb20gcnVudGltZScsXG4gICAgW1JVTlRJTUVfMDA3XTogJ0ZhaWxlZCB0byBnZXQgcmVtb3RlIHNuYXBzaG90LicsXG4gICAgW1JVTlRJTUVfMDA4XTogJ0ZhaWxlZCB0byBsb2FkIHNjcmlwdCByZXNvdXJjZXMuJ1xufTtcbnZhciB0eXBlRGVzY01hcCA9IHtcbiAgICBbVFlQRV8wMDFdOiAnRmFpbGVkIHRvIGdlbmVyYXRlIHR5cGUgZGVjbGFyYXRpb24uJ1xufTtcbnZhciBidWlsZERlc2NNYXAgPSB7XG4gICAgW0JVSUxEXzAwMV06ICdGYWlsZWQgdG8gZmluZCBleHBvc2UgbW9kdWxlLidcbn07XG52YXIgZXJyb3JEZXNjTWFwID0gX2V4dGVuZHMoe30sIHJ1bnRpbWVEZXNjTWFwLCB0eXBlRGVzY01hcCwgYnVpbGREZXNjTWFwKTtcbmV4cG9ydHMuQlVJTERfMDAxID0gQlVJTERfMDAxO1xuZXhwb3J0cy5SVU5USU1FXzAwMSA9IFJVTlRJTUVfMDAxO1xuZXhwb3J0cy5SVU5USU1FXzAwMiA9IFJVTlRJTUVfMDAyO1xuZXhwb3J0cy5SVU5USU1FXzAwMyA9IFJVTlRJTUVfMDAzO1xuZXhwb3J0cy5SVU5USU1FXzAwNCA9IFJVTlRJTUVfMDA0O1xuZXhwb3J0cy5SVU5USU1FXzAwNSA9IFJVTlRJTUVfMDA1O1xuZXhwb3J0cy5SVU5USU1FXzAwNiA9IFJVTlRJTUVfMDA2O1xuZXhwb3J0cy5SVU5USU1FXzAwNyA9IFJVTlRJTUVfMDA3O1xuZXhwb3J0cy5SVU5USU1FXzAwOCA9IFJVTlRJTUVfMDA4O1xuZXhwb3J0cy5UWVBFXzAwMSA9IFRZUEVfMDAxO1xuZXhwb3J0cy5idWlsZERlc2NNYXAgPSBidWlsZERlc2NNYXA7XG5leHBvcnRzLmVycm9yRGVzY01hcCA9IGVycm9yRGVzY01hcDtcbmV4cG9ydHMuZ2V0U2hvcnRFcnJvck1zZyA9IGdldFNob3J0RXJyb3JNc2c7XG5leHBvcnRzLnJ1bnRpbWVEZXNjTWFwID0gcnVudGltZURlc2NNYXA7XG5leHBvcnRzLnR5cGVEZXNjTWFwID0gdHlwZURlc2NNYXA7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lLWNvcmUvZGlzdC9pbmRleC5janMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L2luZGV4LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xudmFyIF9hc3luY190b19nZW5lcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fYXN5bmNfdG9fZ2VuZXJhdG9yICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiKTtcbnZhciBfY2FsbF9zdXBlciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jYWxsX3N1cGVyICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2FsbF9zdXBlci5janNcIik7XG52YXIgX2NsYXNzX2NhbGxfY2hlY2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY2xhc3NfY2FsbF9jaGVjayAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NsYXNzX2NhbGxfY2hlY2suY2pzXCIpO1xudmFyIF9jcmVhdGVfY2xhc3MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY3JlYXRlX2NsYXNzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY3JlYXRlX2NsYXNzLmNqc1wiKTtcbnZhciBfaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9faW5oZXJpdHMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbmhlcml0cy5janNcIik7XG52YXIgX3NsaWNlZF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19zbGljZWRfdG9fYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19jb25zdW1hYmxlX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2NvbnN1bWFibGVfYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqc1wiKTtcbnZhciBfdHlwZV9vZiA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL190eXBlX29mICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdHlwZV9vZi5janNcIik7XG52YXIgcG9seWZpbGxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9wb2x5ZmlsbHMuY2pzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L3BvbHlmaWxscy5janMuanNcIik7XG52YXIgc2RrID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQG1vZHVsZS1mZWRlcmF0aW9uL3NkayAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9zZGsvZGlzdC9pbmRleC5janMuanNcIik7XG52YXIgZXJyb3JDb2RlcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBtb2R1bGUtZmVkZXJhdGlvbi9lcnJvci1jb2RlcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9lcnJvci1jb2Rlcy9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbnZhciBMT0dfQ0FURUdPUlkgPSAnWyBGZWRlcmF0aW9uIFJ1bnRpbWUgXSc7XG4vLyBGSVhNRTogcHJlLWJ1bmRsZSA/XG52YXIgbG9nZ2VyID0gc2RrLmNyZWF0ZUxvZ2dlcihMT0dfQ0FURUdPUlkpO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXNcbmZ1bmN0aW9uIGFzc2VydChjb25kaXRpb24sIG1zZykge1xuICAgIGlmICghY29uZGl0aW9uKSB7XG4gICAgICAgIGVycm9yKG1zZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXJyb3IobXNnKSB7XG4gICAgaWYgKG1zZyBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIG1zZy5tZXNzYWdlID0gYCR7TE9HX0NBVEVHT1JZfTogJHttc2cubWVzc2FnZX1gO1xuICAgICAgICB0aHJvdyBtc2c7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihgJHtMT0dfQ0FURUdPUll9OiAke21zZ31gKTtcbn1cbmZ1bmN0aW9uIHdhcm4obXNnKSB7XG4gICAgaWYgKG1zZyBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIG1zZy5tZXNzYWdlID0gYCR7TE9HX0NBVEVHT1JZfTogJHttc2cubWVzc2FnZX1gO1xuICAgICAgICBsb2dnZXIud2Fybihtc2cpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZ2dlci53YXJuKG1zZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gYWRkVW5pcXVlSXRlbShhcnIsIGl0ZW0pIHtcbiAgICBpZiAoYXJyLmZpbmRJbmRleCgobmFtZTEpPT5uYW1lMSA9PT0gaXRlbSkgPT09IC0xKSB7XG4gICAgICAgIGFyci5wdXNoKGl0ZW0pO1xuICAgIH1cbiAgICByZXR1cm4gYXJyO1xufVxuZnVuY3Rpb24gZ2V0Rk1JZChyZW1vdGVJbmZvKSB7XG4gICAgaWYgKCd2ZXJzaW9uJyBpbiByZW1vdGVJbmZvICYmIHJlbW90ZUluZm8udmVyc2lvbikge1xuICAgICAgICByZXR1cm4gYCR7cmVtb3RlSW5mby5uYW1lfToke3JlbW90ZUluZm8udmVyc2lvbn1gO1xuICAgIH0gZWxzZSBpZiAoJ2VudHJ5JyBpbiByZW1vdGVJbmZvICYmIHJlbW90ZUluZm8uZW50cnkpIHtcbiAgICAgICAgcmV0dXJuIGAke3JlbW90ZUluZm8ubmFtZX06JHtyZW1vdGVJbmZvLmVudHJ5fWA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGAke3JlbW90ZUluZm8ubmFtZX1gO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGlzUmVtb3RlSW5mb1dpdGhFbnRyeShyZW1vdGUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHJlbW90ZS5lbnRyeSAhPT0gJ3VuZGVmaW5lZCc7XG59XG5mdW5jdGlvbiBpc1B1cmVSZW1vdGVFbnRyeShyZW1vdGUpIHtcbiAgICByZXR1cm4gIXJlbW90ZS5lbnRyeS5pbmNsdWRlcygnLmpzb24nKSAmJiByZW1vdGUuZW50cnkuaW5jbHVkZXMoJy5qcycpO1xufVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmZ1bmN0aW9uIHNhZmVXcmFwcGVyKGNhbGxiYWNrLCBkaXNhYmxlV2Fybikge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAhZGlzYWJsZVdhcm4gJiYgd2FybihlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pKCk7XG59XG5mdW5jdGlvbiBpc09iamVjdCh2YWwpIHtcbiAgICByZXR1cm4gdmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnO1xufVxudmFyIG9iamVjdFRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXG5mdW5jdGlvbiBpc1BsYWluT2JqZWN0KHZhbCkge1xuICAgIHJldHVybiBvYmplY3RUb1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IE9iamVjdF0nO1xufVxuZnVuY3Rpb24gaXNTdGF0aWNSZXNvdXJjZXNFcXVhbCh1cmwxLCB1cmwyKSB7XG4gICAgdmFyIFJFR19FWFAgPSAvXihodHRwcz86KT9cXC9cXC8vaTtcbiAgICAvLyBUcmFuc2Zvcm0gdXJsMSBhbmQgdXJsMiBpbnRvIHJlbGF0aXZlIHBhdGhzXG4gICAgdmFyIHJlbGF0aXZlVXJsMSA9IHVybDEucmVwbGFjZShSRUdfRVhQLCAnJykucmVwbGFjZSgvXFwvJC8sICcnKTtcbiAgICB2YXIgcmVsYXRpdmVVcmwyID0gdXJsMi5yZXBsYWNlKFJFR19FWFAsICcnKS5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgIC8vIENoZWNrIGlmIHRoZSByZWxhdGl2ZSBwYXRocyBhcmUgaWRlbnRpY2FsXG4gICAgcmV0dXJuIHJlbGF0aXZlVXJsMSA9PT0gcmVsYXRpdmVVcmwyO1xufVxuZnVuY3Rpb24gYXJyYXlPcHRpb25zKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShvcHRpb25zKSA/IG9wdGlvbnMgOiBbXG4gICAgICAgIG9wdGlvbnNcbiAgICBdO1xufVxuZnVuY3Rpb24gZ2V0UmVtb3RlRW50cnlJbmZvRnJvbVNuYXBzaG90KHNuYXBzaG90KSB7XG4gICAgdmFyIGRlZmF1bHRSZW1vdGVFbnRyeUluZm8gPSB7XG4gICAgICAgIHVybDogJycsXG4gICAgICAgIHR5cGU6ICdnbG9iYWwnLFxuICAgICAgICBnbG9iYWxOYW1lOiAnJ1xuICAgIH07XG4gICAgaWYgKHNkay5pc0Jyb3dzZXJFbnYoKSkge1xuICAgICAgICByZXR1cm4gJ3JlbW90ZUVudHJ5JyBpbiBzbmFwc2hvdCA/IHtcbiAgICAgICAgICAgIHVybDogc25hcHNob3QucmVtb3RlRW50cnksXG4gICAgICAgICAgICB0eXBlOiBzbmFwc2hvdC5yZW1vdGVFbnRyeVR5cGUsXG4gICAgICAgICAgICBnbG9iYWxOYW1lOiBzbmFwc2hvdC5nbG9iYWxOYW1lXG4gICAgICAgIH0gOiBkZWZhdWx0UmVtb3RlRW50cnlJbmZvO1xuICAgIH1cbiAgICBpZiAoJ3NzclJlbW90ZUVudHJ5JyBpbiBzbmFwc2hvdCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdXJsOiBzbmFwc2hvdC5zc3JSZW1vdGVFbnRyeSB8fCBkZWZhdWx0UmVtb3RlRW50cnlJbmZvLnVybCxcbiAgICAgICAgICAgIHR5cGU6IHNuYXBzaG90LnNzclJlbW90ZUVudHJ5VHlwZSB8fCBkZWZhdWx0UmVtb3RlRW50cnlJbmZvLnR5cGUsXG4gICAgICAgICAgICBnbG9iYWxOYW1lOiBzbmFwc2hvdC5nbG9iYWxOYW1lXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBkZWZhdWx0UmVtb3RlRW50cnlJbmZvO1xufVxudmFyIHByb2Nlc3NNb2R1bGVBbGlhcyA9IChuYW1lMSwgc3ViUGF0aCk9PntcbiAgICAvLyBAaG9zdC8gLi9idXR0b24gLT4gQGhvc3QvYnV0dG9uXG4gICAgdmFyIG1vZHVsZU5hbWU7XG4gICAgaWYgKG5hbWUxLmVuZHNXaXRoKCcvJykpIHtcbiAgICAgICAgbW9kdWxlTmFtZSA9IG5hbWUxLnNsaWNlKDAsIC0xKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBtb2R1bGVOYW1lID0gbmFtZTE7XG4gICAgfVxuICAgIGlmIChzdWJQYXRoLnN0YXJ0c1dpdGgoJy4nKSkge1xuICAgICAgICBzdWJQYXRoID0gc3ViUGF0aC5zbGljZSgxKTtcbiAgICB9XG4gICAgbW9kdWxlTmFtZSA9IG1vZHVsZU5hbWUgKyBzdWJQYXRoO1xuICAgIHJldHVybiBtb2R1bGVOYW1lO1xufTtcbnZhciBDdXJyZW50R2xvYmFsID0gdHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnID8gZ2xvYmFsVGhpcyA6IHdpbmRvdztcbnZhciBuYXRpdmVHbG9iYWwgPSAoKCk9PntcbiAgICB0cnkge1xuICAgICAgICAvLyBnZXQgcmVhbCB3aW5kb3cgKGluY2FzZSBvZiBzYW5kYm94KVxuICAgICAgICByZXR1cm4gZG9jdW1lbnQuZGVmYXVsdFZpZXc7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBub2RlIGVudlxuICAgICAgICByZXR1cm4gQ3VycmVudEdsb2JhbDtcbiAgICB9XG59KSgpO1xudmFyIEdsb2JhbCA9IG5hdGl2ZUdsb2JhbDtcbmZ1bmN0aW9uIGRlZmluZVByb3BlcnR5R2xvYmFsVmFsKHRhcmdldCwga2V5LCB2YWwpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHtcbiAgICAgICAgdmFsdWU6IHZhbCxcbiAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGluY2x1ZGVPd25Qcm9wZXJ0eSh0YXJnZXQsIGtleSkge1xuICAgIHJldHVybiBPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbCh0YXJnZXQsIGtleSk7XG59XG4vLyBUaGlzIHNlY3Rpb24gaXMgdG8gcHJldmVudCBlbmNhcHN1bGF0aW9uIGJ5IGNlcnRhaW4gbWljcm9mcm9udGVuZCBmcmFtZXdvcmtzLiBEdWUgdG8gcmV1c2UgcG9saWNpZXMsIHNhbmRib3ggZXNjYXBlcy5cbi8vIFRoZSBzYW5kYm94IGluIHRoZSBtaWNyb2Zyb250ZW5kIGRvZXMgbm90IHJlcGxpY2F0ZSB0aGUgdmFsdWUgb2YgJ2NvbmZpZ3VyYWJsZScuXG4vLyBJZiB0aGVyZSBpcyBubyBsb2FkaW5nIGNvbnRlbnQgb24gdGhlIGdsb2JhbCBvYmplY3QsIHRoaXMgc2VjdGlvbiBkZWZpbmVzIHRoZSBsb2FkaW5nIG9iamVjdC5cbmlmICghaW5jbHVkZU93blByb3BlcnR5KEN1cnJlbnRHbG9iYWwsICdfX0dMT0JBTF9MT0FESU5HX1JFTU9URV9FTlRSWV9fJykpIHtcbiAgICBkZWZpbmVQcm9wZXJ0eUdsb2JhbFZhbChDdXJyZW50R2xvYmFsLCAnX19HTE9CQUxfTE9BRElOR19SRU1PVEVfRU5UUllfXycsIHt9KTtcbn1cbnZhciBnbG9iYWxMb2FkaW5nID0gQ3VycmVudEdsb2JhbC5fX0dMT0JBTF9MT0FESU5HX1JFTU9URV9FTlRSWV9fO1xuZnVuY3Rpb24gc2V0R2xvYmFsRGVmYXVsdFZhbCh0YXJnZXQpIHtcbiAgICB2YXIgX3RhcmdldF9fX0ZFREVSQVRJT05fXywgX3RhcmdldF9fX0ZFREVSQVRJT05fXzEsIF90YXJnZXRfX19GRURFUkFUSU9OX18yLCBfdGFyZ2V0X19fRkVERVJBVElPTl9fMywgX3RhcmdldF9fX0ZFREVSQVRJT05fXzQsIF90YXJnZXRfX19GRURFUkFUSU9OX181O1xuICAgIGlmIChpbmNsdWRlT3duUHJvcGVydHkodGFyZ2V0LCAnX19WTU9LX18nKSAmJiAhaW5jbHVkZU93blByb3BlcnR5KHRhcmdldCwgJ19fRkVERVJBVElPTl9fJykpIHtcbiAgICAgICAgZGVmaW5lUHJvcGVydHlHbG9iYWxWYWwodGFyZ2V0LCAnX19GRURFUkFUSU9OX18nLCB0YXJnZXQuX19WTU9LX18pO1xuICAgIH1cbiAgICBpZiAoIWluY2x1ZGVPd25Qcm9wZXJ0eSh0YXJnZXQsICdfX0ZFREVSQVRJT05fXycpKSB7XG4gICAgICAgIGRlZmluZVByb3BlcnR5R2xvYmFsVmFsKHRhcmdldCwgJ19fRkVERVJBVElPTl9fJywge1xuICAgICAgICAgICAgX19HTE9CQUxfUExVR0lOX186IFtdLFxuICAgICAgICAgICAgX19JTlNUQU5DRVNfXzogW10sXG4gICAgICAgICAgICBtb2R1bGVJbmZvOiB7fSxcbiAgICAgICAgICAgIF9fU0hBUkVfXzoge30sXG4gICAgICAgICAgICBfX01BTklGRVNUX0xPQURJTkdfXzoge30sXG4gICAgICAgICAgICBfX1BSRUxPQURFRF9NQVBfXzogbmV3IE1hcCgpXG4gICAgICAgIH0pO1xuICAgICAgICBkZWZpbmVQcm9wZXJ0eUdsb2JhbFZhbCh0YXJnZXQsICdfX1ZNT0tfXycsIHRhcmdldC5fX0ZFREVSQVRJT05fXyk7XG4gICAgfVxuICAgIHZhciBfX19HTE9CQUxfUExVR0lOX187XG4gICAgKF9fX0dMT0JBTF9QTFVHSU5fXyA9IChfdGFyZ2V0X19fRkVERVJBVElPTl9fID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5fX0dMT0JBTF9QTFVHSU5fXykgIT0gbnVsbCA/IF9fX0dMT0JBTF9QTFVHSU5fXyA6IF90YXJnZXRfX19GRURFUkFUSU9OX18uX19HTE9CQUxfUExVR0lOX18gPSBbXTtcbiAgICB2YXIgX19fSU5TVEFOQ0VTX187XG4gICAgKF9fX0lOU1RBTkNFU19fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX18xID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5fX0lOU1RBTkNFU19fKSAhPSBudWxsID8gX19fSU5TVEFOQ0VTX18gOiBfdGFyZ2V0X19fRkVERVJBVElPTl9fMS5fX0lOU1RBTkNFU19fID0gW107XG4gICAgdmFyIF9tb2R1bGVJbmZvO1xuICAgIChfbW9kdWxlSW5mbyA9IChfdGFyZ2V0X19fRkVERVJBVElPTl9fMiA9IHRhcmdldC5fX0ZFREVSQVRJT05fXykubW9kdWxlSW5mbykgIT0gbnVsbCA/IF9tb2R1bGVJbmZvIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXzIubW9kdWxlSW5mbyA9IHt9O1xuICAgIHZhciBfX19TSEFSRV9fO1xuICAgIChfX19TSEFSRV9fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX18zID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5fX1NIQVJFX18pICE9IG51bGwgPyBfX19TSEFSRV9fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXzMuX19TSEFSRV9fID0ge307XG4gICAgdmFyIF9fX01BTklGRVNUX0xPQURJTkdfXztcbiAgICAoX19fTUFOSUZFU1RfTE9BRElOR19fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX180ID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5fX01BTklGRVNUX0xPQURJTkdfXykgIT0gbnVsbCA/IF9fX01BTklGRVNUX0xPQURJTkdfXyA6IF90YXJnZXRfX19GRURFUkFUSU9OX180Ll9fTUFOSUZFU1RfTE9BRElOR19fID0ge307XG4gICAgdmFyIF9fX1BSRUxPQURFRF9NQVBfXztcbiAgICAoX19fUFJFTE9BREVEX01BUF9fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX181ID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5fX1BSRUxPQURFRF9NQVBfXykgIT0gbnVsbCA/IF9fX1BSRUxPQURFRF9NQVBfXyA6IF90YXJnZXRfX19GRURFUkFUSU9OX181Ll9fUFJFTE9BREVEX01BUF9fID0gbmV3IE1hcCgpO1xufVxuc2V0R2xvYmFsRGVmYXVsdFZhbChDdXJyZW50R2xvYmFsKTtcbnNldEdsb2JhbERlZmF1bHRWYWwobmF0aXZlR2xvYmFsKTtcbmZ1bmN0aW9uIHJlc2V0RmVkZXJhdGlvbkdsb2JhbEluZm8oKSB7XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXyA9IFtdO1xuICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19JTlNUQU5DRVNfXyA9IFtdO1xuICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbyA9IHt9O1xuICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19TSEFSRV9fID0ge307XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX01BTklGRVNUX0xPQURJTkdfXyA9IHt9O1xuICAgIE9iamVjdC5rZXlzKGdsb2JhbExvYWRpbmcpLmZvckVhY2goKGtleSk9PntcbiAgICAgICAgZGVsZXRlIGdsb2JhbExvYWRpbmdba2V5XTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIHNldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZShGZWRlcmF0aW9uSW5zdGFuY2UpIHtcbiAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX18ucHVzaChGZWRlcmF0aW9uSW5zdGFuY2UpO1xufVxuZnVuY3Rpb24gZ2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yKCkge1xuICAgIHJldHVybiBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fREVCVUdfQ09OU1RSVUNUT1JfXztcbn1cbmZ1bmN0aW9uIHNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcihGZWRlcmF0aW9uQ29uc3RydWN0b3IsIHJlZikge1xuICAgIHZhciBpc0RlYnVnID0gcmVmID09PSB2b2lkIDAgPyBzZGsuaXNEZWJ1Z01vZGUoKSA6IHJlZjtcbiAgICBpZiAoaXNEZWJ1Zykge1xuICAgICAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fREVCVUdfQ09OU1RSVUNUT1JfXyA9IEZlZGVyYXRpb25Db25zdHJ1Y3RvcjtcbiAgICAgICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0RFQlVHX0NPTlNUUlVDVE9SX1ZFUlNJT05fXyA9IFwiMC4xMC4wXCI7XG4gICAgfVxufVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcbmZ1bmN0aW9uIGdldEluZm9XaXRob3V0VHlwZSh0YXJnZXQsIGtleSkge1xuICAgIGlmICh0eXBlb2Yga2V5ID09PSAnc3RyaW5nJykge1xuICAgICAgICB2YXIga2V5UmVzID0gdGFyZ2V0W2tleV07XG4gICAgICAgIGlmIChrZXlSZXMpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHRhcmdldFtrZXldLFxuICAgICAgICAgICAgICAgIGtleToga2V5XG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHRhcmdldEtleXMgPSBPYmplY3Qua2V5cyh0YXJnZXQpO1xuICAgICAgICAgICAgZm9yICh2YXIgdGFyZ2V0S2V5IG9mIHRhcmdldEtleXMpe1xuICAgICAgICAgICAgICAgIHZhciBfdGFyZ2V0S2V5X3NwbGl0ID0gX3NsaWNlZF90b19hcnJheS5fKHRhcmdldEtleS5zcGxpdCgnOicpLCAyKSwgdGFyZ2V0VHlwZU9yTmFtZSA9IF90YXJnZXRLZXlfc3BsaXRbMF0sIF8gPSBfdGFyZ2V0S2V5X3NwbGl0WzFdO1xuICAgICAgICAgICAgICAgIHZhciBuS2V5ID0gYCR7dGFyZ2V0VHlwZU9yTmFtZX06JHtrZXl9YDtcbiAgICAgICAgICAgICAgICB2YXIgdHlwZVdpdGhLZXlSZXMgPSB0YXJnZXRbbktleV07XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVXaXRoS2V5UmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdHlwZVdpdGhLZXlSZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk6IG5LZXlcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAga2V5OiBrZXlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2tleSBtdXN0IGJlIHN0cmluZycpO1xuICAgIH1cbn1cbnZhciBnZXRHbG9iYWxTbmFwc2hvdCA9ICgpPT5uYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbztcbnZhciBnZXRUYXJnZXRTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8gPSAobW9kdWxlSW5mbywgc25hcHNob3QpPT57XG4gICAgLy8gQ2hlY2sgaWYgdGhlIHJlbW90ZSBpcyBpbmNsdWRlZCBpbiB0aGUgaG9zdFNuYXBzaG90XG4gICAgdmFyIG1vZHVsZUtleSA9IGdldEZNSWQobW9kdWxlSW5mbyk7XG4gICAgdmFyIGdldE1vZHVsZUluZm8gPSBnZXRJbmZvV2l0aG91dFR5cGUoc25hcHNob3QsIG1vZHVsZUtleSkudmFsdWU7XG4gICAgLy8gVGhlIHJlbW90ZVNuYXBzaG90IG1pZ2h0IG5vdCBpbmNsdWRlIGEgdmVyc2lvblxuICAgIGlmIChnZXRNb2R1bGVJbmZvICYmICFnZXRNb2R1bGVJbmZvLnZlcnNpb24gJiYgJ3ZlcnNpb24nIGluIG1vZHVsZUluZm8gJiYgbW9kdWxlSW5mb1sndmVyc2lvbiddKSB7XG4gICAgICAgIGdldE1vZHVsZUluZm8udmVyc2lvbiA9IG1vZHVsZUluZm9bJ3ZlcnNpb24nXTtcbiAgICB9XG4gICAgaWYgKGdldE1vZHVsZUluZm8pIHtcbiAgICAgICAgcmV0dXJuIGdldE1vZHVsZUluZm87XG4gICAgfVxuICAgIC8vIElmIHRoZSByZW1vdGUgaXMgbm90IGluY2x1ZGVkIGluIHRoZSBob3N0U25hcHNob3QsIGRlcGxveSBhIG1pY3JvIGFwcCBzbmFwc2hvdFxuICAgIGlmICgndmVyc2lvbicgaW4gbW9kdWxlSW5mbyAmJiBtb2R1bGVJbmZvWyd2ZXJzaW9uJ10pIHtcbiAgICAgICAgdmFyIHZlcnNpb24gPSBtb2R1bGVJbmZvLnZlcnNpb24sIHJlc01vZHVsZUluZm8gPSBwb2x5ZmlsbHMuX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2UobW9kdWxlSW5mbywgW1xuICAgICAgICAgICAgXCJ2ZXJzaW9uXCJcbiAgICAgICAgXSk7XG4gICAgICAgIHZhciBtb2R1bGVLZXlXaXRob3V0VmVyc2lvbiA9IGdldEZNSWQocmVzTW9kdWxlSW5mbyk7XG4gICAgICAgIHZhciBnZXRNb2R1bGVJbmZvV2l0aG91dFZlcnNpb24gPSBnZXRJbmZvV2l0aG91dFR5cGUobmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm8sIG1vZHVsZUtleVdpdGhvdXRWZXJzaW9uKS52YWx1ZTtcbiAgICAgICAgaWYgKChnZXRNb2R1bGVJbmZvV2l0aG91dFZlcnNpb24gPT0gbnVsbCA/IHZvaWQgMCA6IGdldE1vZHVsZUluZm9XaXRob3V0VmVyc2lvbi52ZXJzaW9uKSA9PT0gdmVyc2lvbikge1xuICAgICAgICAgICAgcmV0dXJuIGdldE1vZHVsZUluZm9XaXRob3V0VmVyc2lvbjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm47XG59O1xudmFyIGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyA9IChtb2R1bGVJbmZvKT0+Z2V0VGFyZ2V0U25hcHNob3RJbmZvQnlNb2R1bGVJbmZvKG1vZHVsZUluZm8sIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvKTtcbnZhciBzZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8gPSAocmVtb3RlSW5mbywgbW9kdWxlRGV0YWlsSW5mbyk9PntcbiAgICB2YXIgbW9kdWxlS2V5ID0gZ2V0Rk1JZChyZW1vdGVJbmZvKTtcbiAgICBuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mb1ttb2R1bGVLZXldID0gbW9kdWxlRGV0YWlsSW5mbztcbiAgICByZXR1cm4gbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm87XG59O1xudmFyIGFkZEdsb2JhbFNuYXBzaG90ID0gKG1vZHVsZUluZm9zKT0+e1xuICAgIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbywgbW9kdWxlSW5mb3MpO1xuICAgIHJldHVybiAoKT0+e1xuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG1vZHVsZUluZm9zKTtcbiAgICAgICAgZm9yICh2YXIga2V5IG9mIGtleXMpe1xuICAgICAgICAgICAgZGVsZXRlIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvW2tleV07XG4gICAgICAgIH1cbiAgICB9O1xufTtcbnZhciBnZXRSZW1vdGVFbnRyeUV4cG9ydHMgPSAobmFtZTEsIGdsb2JhbE5hbWUpPT57XG4gICAgdmFyIHJlbW90ZUVudHJ5S2V5ID0gZ2xvYmFsTmFtZSB8fCBgX19GRURFUkFUSU9OXyR7bmFtZTF9OmN1c3RvbV9fYDtcbiAgICB2YXIgZW50cnlFeHBvcnRzID0gQ3VycmVudEdsb2JhbFtyZW1vdGVFbnRyeUtleV07XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVtb3RlRW50cnlLZXksXG4gICAgICAgIGVudHJ5RXhwb3J0c1xuICAgIH07XG59O1xuLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHJlZ2lzdGVyIGdsb2JhbCBwbHVnaW5zLlxuLy8gSXQgaXRlcmF0ZXMgb3ZlciB0aGUgcHJvdmlkZWQgcGx1Z2lucyBhbmQgY2hlY2tzIGlmIHRoZXkgYXJlIGFscmVhZHkgcmVnaXN0ZXJlZC5cbi8vIElmIGEgcGx1Z2luIGlzIG5vdCByZWdpc3RlcmVkLCBpdCBpcyBhZGRlZCB0byB0aGUgZ2xvYmFsIHBsdWdpbnMuXG4vLyBJZiBhIHBsdWdpbiBpcyBhbHJlYWR5IHJlZ2lzdGVyZWQsIGEgd2FybmluZyBtZXNzYWdlIGlzIGxvZ2dlZC5cbnZhciByZWdpc3Rlckdsb2JhbFBsdWdpbnMgPSAocGx1Z2lucyk9PntcbiAgICB2YXIgX19HTE9CQUxfUExVR0lOX18gPSBuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18uX19HTE9CQUxfUExVR0lOX187XG4gICAgcGx1Z2lucy5mb3JFYWNoKChwbHVnaW4pPT57XG4gICAgICAgIGlmIChfX0dMT0JBTF9QTFVHSU5fXy5maW5kSW5kZXgoKHApPT5wLm5hbWUgPT09IHBsdWdpbi5uYW1lKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIF9fR0xPQkFMX1BMVUdJTl9fLnB1c2gocGx1Z2luKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHdhcm4oYFRoZSBwbHVnaW4gJHtwbHVnaW4ubmFtZX0gaGFzIGJlZW4gcmVnaXN0ZXJlZC5gKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcbnZhciBnZXRHbG9iYWxIb3N0UGx1Z2lucyA9ICgpPT5uYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18uX19HTE9CQUxfUExVR0lOX187XG52YXIgZ2V0UHJlbG9hZGVkID0gKGlkKT0+Q3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1BSRUxPQURFRF9NQVBfXy5nZXQoaWQpO1xudmFyIHNldFByZWxvYWRlZCA9IChpZCk9PkN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19QUkVMT0FERURfTUFQX18uc2V0KGlkLCB0cnVlKTtcbnZhciBERUZBVUxUX1NDT1BFID0gJ2RlZmF1bHQnO1xudmFyIERFRkFVTFRfUkVNT1RFX1RZUEUgPSAnZ2xvYmFsJztcbi8vIGZvcmsgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vb3JpZ2luanMvdml0ZS1wbHVnaW4tZmVkZXJhdGlvbi9ibG9iL3YxLjEuMTIvcGFja2FnZXMvbGliL3NyYy91dGlscy9zZW12ZXIvaW5kZXgudHNcbi8vIHRob3NlIGNvbnN0YW50cyBhcmUgYmFzZWQgb24gaHR0cHM6Ly93d3cucnVieWRvYy5pbmZvL2dlbXMvc2VtYW50aWNfcmFuZ2UvMy4wLjAvU2VtYW50aWNSYW5nZSNCVUlMRElERU5USUZJRVItY29uc3RhbnRcbi8vIENvcHlyaWdodCAoYylcbi8vIHZpdGUtcGx1Z2luLWZlZGVyYXRpb24gaXMgbGljZW5zZWQgdW5kZXIgTXVsYW4gUFNMIHYyLlxuLy8gWW91IGNhbiB1c2UgdGhpcyBzb2Z0d2FyZSBhY2NvcmRpbmcgdG8gdGhlIHRlcm1zIGFuZCBjb25kaXRpb25zIG9mIHRoZSBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgTXVsYW4gUFNMIHYyIGF0OlxuLy8gICAgICBodHRwOi8vbGljZW5zZS5jb3NjbC5vcmcuY24vTXVsYW5QU0wyXG4vLyBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIE9OIEFOIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9GIEFOWSBLSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIE5PTi1JTkZSSU5HRU1FTlQsIE1FUkNIQU5UQUJJTElUWSBPUiBGSVQgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLlxuLy8gU2VlIHRoZSBNdWxhbiBQU0wgdjIgZm9yIG1vcmUgZGV0YWlscy5cbnZhciBidWlsZElkZW50aWZpZXIgPSAnWzAtOUEtWmEtei1dKyc7XG52YXIgYnVpbGQgPSBgKD86XFxcXCsoJHtidWlsZElkZW50aWZpZXJ9KD86XFxcXC4ke2J1aWxkSWRlbnRpZmllcn0pKikpYDtcbnZhciBudW1lcmljSWRlbnRpZmllciA9ICcwfFsxLTldXFxcXGQqJztcbnZhciBudW1lcmljSWRlbnRpZmllckxvb3NlID0gJ1swLTldKyc7XG52YXIgbm9uTnVtZXJpY0lkZW50aWZpZXIgPSAnXFxcXGQqW2EtekEtWi1dW2EtekEtWjAtOS1dKic7XG52YXIgcHJlUmVsZWFzZUlkZW50aWZpZXJMb29zZSA9IGAoPzoke251bWVyaWNJZGVudGlmaWVyTG9vc2V9fCR7bm9uTnVtZXJpY0lkZW50aWZpZXJ9KWA7XG52YXIgcHJlUmVsZWFzZUxvb3NlID0gYCg/Oi0/KCR7cHJlUmVsZWFzZUlkZW50aWZpZXJMb29zZX0oPzpcXFxcLiR7cHJlUmVsZWFzZUlkZW50aWZpZXJMb29zZX0pKikpYDtcbnZhciBwcmVSZWxlYXNlSWRlbnRpZmllciA9IGAoPzoke251bWVyaWNJZGVudGlmaWVyfXwke25vbk51bWVyaWNJZGVudGlmaWVyfSlgO1xudmFyIHByZVJlbGVhc2UgPSBgKD86LSgke3ByZVJlbGVhc2VJZGVudGlmaWVyfSg/OlxcXFwuJHtwcmVSZWxlYXNlSWRlbnRpZmllcn0pKikpYDtcbnZhciB4UmFuZ2VJZGVudGlmaWVyID0gYCR7bnVtZXJpY0lkZW50aWZpZXJ9fHh8WHxcXFxcKmA7XG52YXIgeFJhbmdlUGxhaW4gPSBgW3Y9XFxcXHNdKigke3hSYW5nZUlkZW50aWZpZXJ9KSg/OlxcXFwuKCR7eFJhbmdlSWRlbnRpZmllcn0pKD86XFxcXC4oJHt4UmFuZ2VJZGVudGlmaWVyfSkoPzoke3ByZVJlbGVhc2V9KT8ke2J1aWxkfT8pPyk/YDtcbnZhciBoeXBoZW5SYW5nZSA9IGBeXFxcXHMqKCR7eFJhbmdlUGxhaW59KVxcXFxzKy1cXFxccysoJHt4UmFuZ2VQbGFpbn0pXFxcXHMqJGA7XG52YXIgbWFpblZlcnNpb25Mb29zZSA9IGAoJHtudW1lcmljSWRlbnRpZmllckxvb3NlfSlcXFxcLigke251bWVyaWNJZGVudGlmaWVyTG9vc2V9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJMb29zZX0pYDtcbnZhciBsb29zZVBsYWluID0gYFt2PVxcXFxzXSoke21haW5WZXJzaW9uTG9vc2V9JHtwcmVSZWxlYXNlTG9vc2V9PyR7YnVpbGR9P2A7XG52YXIgZ3RsdCA9ICcoKD86PHw+KT89PyknO1xudmFyIGNvbXBhcmF0b3JUcmltID0gYChcXFxccyopJHtndGx0fVxcXFxzKigke2xvb3NlUGxhaW59fCR7eFJhbmdlUGxhaW59KWA7XG52YXIgbG9uZVRpbGRlID0gJyg/On4+PyknO1xudmFyIHRpbGRlVHJpbSA9IGAoXFxcXHMqKSR7bG9uZVRpbGRlfVxcXFxzK2A7XG52YXIgbG9uZUNhcmV0ID0gJyg/OlxcXFxeKSc7XG52YXIgY2FyZXRUcmltID0gYChcXFxccyopJHtsb25lQ2FyZXR9XFxcXHMrYDtcbnZhciBzdGFyID0gJyg8fD4pPz0/XFxcXHMqXFxcXConO1xudmFyIGNhcmV0ID0gYF4ke2xvbmVDYXJldH0ke3hSYW5nZVBsYWlufSRgO1xudmFyIG1haW5WZXJzaW9uID0gYCgke251bWVyaWNJZGVudGlmaWVyfSlcXFxcLigke251bWVyaWNJZGVudGlmaWVyfSlcXFxcLigke251bWVyaWNJZGVudGlmaWVyfSlgO1xudmFyIGZ1bGxQbGFpbiA9IGB2PyR7bWFpblZlcnNpb259JHtwcmVSZWxlYXNlfT8ke2J1aWxkfT9gO1xudmFyIHRpbGRlID0gYF4ke2xvbmVUaWxkZX0ke3hSYW5nZVBsYWlufSRgO1xudmFyIHhSYW5nZSA9IGBeJHtndGx0fVxcXFxzKiR7eFJhbmdlUGxhaW59JGA7XG52YXIgY29tcGFyYXRvciA9IGBeJHtndGx0fVxcXFxzKigke2Z1bGxQbGFpbn0pJHxeJGA7XG4vLyBjb3B5IGZyb20gc2VtdmVyIHBhY2thZ2VcbnZhciBndGUwID0gJ15cXFxccyo+PVxcXFxzKjAuMC4wXFxcXHMqJCc7XG4vLyBmb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL29yaWdpbmpzL3ZpdGUtcGx1Z2luLWZlZGVyYXRpb24vYmxvYi92MS4xLjEyL3BhY2thZ2VzL2xpYi9zcmMvdXRpbHMvc2VtdmVyL2luZGV4LnRzXG4vLyBDb3B5cmlnaHQgKGMpXG4vLyB2aXRlLXBsdWdpbi1mZWRlcmF0aW9uIGlzIGxpY2Vuc2VkIHVuZGVyIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBjYW4gdXNlIHRoaXMgc29mdHdhcmUgYWNjb3JkaW5nIHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgTXVsYW4gUFNMIHYyLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIE11bGFuIFBTTCB2MiBhdDpcbi8vICAgICAgaHR0cDovL2xpY2Vuc2UuY29zY2wub3JnLmNuL011bGFuUFNMMlxuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBOT04tSU5GUklOR0VNRU5ULCBNRVJDSEFOVEFCSUxJVFkgT1IgRklUIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cbi8vIFNlZSB0aGUgTXVsYW4gUFNMIHYyIGZvciBtb3JlIGRldGFpbHMuXG5mdW5jdGlvbiBwYXJzZVJlZ2V4KHNvdXJjZSkge1xuICAgIHJldHVybiBuZXcgUmVnRXhwKHNvdXJjZSk7XG59XG5mdW5jdGlvbiBpc1hWZXJzaW9uKHZlcnNpb24pIHtcbiAgICByZXR1cm4gIXZlcnNpb24gfHwgdmVyc2lvbi50b0xvd2VyQ2FzZSgpID09PSAneCcgfHwgdmVyc2lvbiA9PT0gJyonO1xufVxuZnVuY3Rpb24gcGlwZSguLi5mbnMpIHtcbiAgICByZXR1cm4gKHgpPT5mbnMucmVkdWNlKCh2LCBmKT0+Zih2KSwgeCk7XG59XG5mdW5jdGlvbiBleHRyYWN0Q29tcGFyYXRvcihjb21wYXJhdG9yU3RyaW5nKSB7XG4gICAgcmV0dXJuIGNvbXBhcmF0b3JTdHJpbmcubWF0Y2gocGFyc2VSZWdleChjb21wYXJhdG9yKSk7XG59XG5mdW5jdGlvbiBjb21iaW5lVmVyc2lvbihtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKSB7XG4gICAgdmFyIG1haW5WZXJzaW9uID0gYCR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9YDtcbiAgICBpZiAocHJlUmVsZWFzZSkge1xuICAgICAgICByZXR1cm4gYCR7bWFpblZlcnNpb259LSR7cHJlUmVsZWFzZX1gO1xuICAgIH1cbiAgICByZXR1cm4gbWFpblZlcnNpb247XG59XG4vLyBmb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL29yaWdpbmpzL3ZpdGUtcGx1Z2luLWZlZGVyYXRpb24vYmxvYi92MS4xLjEyL3BhY2thZ2VzL2xpYi9zcmMvdXRpbHMvc2VtdmVyL2luZGV4LnRzXG4vLyBDb3B5cmlnaHQgKGMpXG4vLyB2aXRlLXBsdWdpbi1mZWRlcmF0aW9uIGlzIGxpY2Vuc2VkIHVuZGVyIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBjYW4gdXNlIHRoaXMgc29mdHdhcmUgYWNjb3JkaW5nIHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgTXVsYW4gUFNMIHYyLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIE11bGFuIFBTTCB2MiBhdDpcbi8vICAgICAgaHR0cDovL2xpY2Vuc2UuY29zY2wub3JnLmNuL011bGFuUFNMMlxuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBOT04tSU5GUklOR0VNRU5ULCBNRVJDSEFOVEFCSUxJVFkgT1IgRklUIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cbi8vIFNlZSB0aGUgTXVsYW4gUFNMIHYyIGZvciBtb3JlIGRldGFpbHMuXG5mdW5jdGlvbiBwYXJzZUh5cGhlbihyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS5yZXBsYWNlKHBhcnNlUmVnZXgoaHlwaGVuUmFuZ2UpLCAoX3JhbmdlLCBmcm9tLCBmcm9tTWFqb3IsIGZyb21NaW5vciwgZnJvbVBhdGNoLCBfZnJvbVByZVJlbGVhc2UsIF9mcm9tQnVpbGQsIHRvLCB0b01ham9yLCB0b01pbm9yLCB0b1BhdGNoLCB0b1ByZVJlbGVhc2UpPT57XG4gICAgICAgIGlmIChpc1hWZXJzaW9uKGZyb21NYWpvcikpIHtcbiAgICAgICAgICAgIGZyb20gPSAnJztcbiAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKGZyb21NaW5vcikpIHtcbiAgICAgICAgICAgIGZyb20gPSBgPj0ke2Zyb21NYWpvcn0uMC4wYDtcbiAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKGZyb21QYXRjaCkpIHtcbiAgICAgICAgICAgIGZyb20gPSBgPj0ke2Zyb21NYWpvcn0uJHtmcm9tTWlub3J9LjBgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZnJvbSA9IGA+PSR7ZnJvbX1gO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1hWZXJzaW9uKHRvTWFqb3IpKSB7XG4gICAgICAgICAgICB0byA9ICcnO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24odG9NaW5vcikpIHtcbiAgICAgICAgICAgIHRvID0gYDwke051bWJlcih0b01ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKHRvUGF0Y2gpKSB7XG4gICAgICAgICAgICB0byA9IGA8JHt0b01ham9yfS4ke051bWJlcih0b01pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgIH0gZWxzZSBpZiAodG9QcmVSZWxlYXNlKSB7XG4gICAgICAgICAgICB0byA9IGA8PSR7dG9NYWpvcn0uJHt0b01pbm9yfS4ke3RvUGF0Y2h9LSR7dG9QcmVSZWxlYXNlfWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0byA9IGA8PSR7dG99YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7ZnJvbX0gJHt0b31gLnRyaW0oKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlQ29tcGFyYXRvclRyaW0ocmFuZ2UpIHtcbiAgICByZXR1cm4gcmFuZ2UucmVwbGFjZShwYXJzZVJlZ2V4KGNvbXBhcmF0b3JUcmltKSwgJyQxJDIkMycpO1xufVxuZnVuY3Rpb24gcGFyc2VUaWxkZVRyaW0ocmFuZ2UpIHtcbiAgICByZXR1cm4gcmFuZ2UucmVwbGFjZShwYXJzZVJlZ2V4KHRpbGRlVHJpbSksICckMX4nKTtcbn1cbmZ1bmN0aW9uIHBhcnNlQ2FyZXRUcmltKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnJlcGxhY2UocGFyc2VSZWdleChjYXJldFRyaW0pLCAnJDFeJyk7XG59XG5mdW5jdGlvbiBwYXJzZUNhcmV0cyhyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS50cmltKCkuc3BsaXQoL1xccysvKS5tYXAoKHJhbmdlVmVyc2lvbik9PnJhbmdlVmVyc2lvbi5yZXBsYWNlKHBhcnNlUmVnZXgoY2FyZXQpLCAoXywgbWFqb3IsIG1pbm9yLCBwYXRjaCwgcHJlUmVsZWFzZSk9PntcbiAgICAgICAgICAgIGlmIChpc1hWZXJzaW9uKG1ham9yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbihtaW5vcikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uMC4wIDwke051bWJlcihtYWpvcikgKyAxfS4wLjAtMGA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24ocGF0Y2gpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1ham9yID09PSAnMCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LjAgPCR7bWFqb3J9LiR7TnVtYmVyKG1pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LjAgPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByZVJlbGVhc2UpIHtcbiAgICAgICAgICAgICAgICBpZiAobWFqb3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWlub3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9LSR7cHJlUmVsZWFzZX0gPCR7bWFqb3J9LiR7bWlub3J9LiR7TnVtYmVyKHBhdGNoKSArIDF9LTBgO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9LSR7cHJlUmVsZWFzZX0gPCR7bWFqb3J9LiR7TnVtYmVyKG1pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0tJHtwcmVSZWxlYXNlfSA8JHtOdW1iZXIobWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG1ham9yID09PSAnMCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1pbm9yID09PSAnMCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofSA8JHttYWpvcn0uJHttaW5vcn0uJHtOdW1iZXIocGF0Y2gpICsgMX0tMGA7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0gPCR7bWFqb3J9LiR7TnVtYmVyKG1pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9IDwke051bWJlcihtYWpvcikgKyAxfS4wLjAtMGA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKS5qb2luKCcgJyk7XG59XG5mdW5jdGlvbiBwYXJzZVRpbGRlcyhyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS50cmltKCkuc3BsaXQoL1xccysvKS5tYXAoKHJhbmdlVmVyc2lvbik9PnJhbmdlVmVyc2lvbi5yZXBsYWNlKHBhcnNlUmVnZXgodGlsZGUpLCAoXywgbWFqb3IsIG1pbm9yLCBwYXRjaCwgcHJlUmVsZWFzZSk9PntcbiAgICAgICAgICAgIGlmIChpc1hWZXJzaW9uKG1ham9yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbihtaW5vcikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uMC4wIDwke051bWJlcihtYWpvcikgKyAxfS4wLjAtMGA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24ocGF0Y2gpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LjAgPCR7bWFqb3J9LiR7TnVtYmVyKG1pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByZVJlbGVhc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0tJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgfSkpLmpvaW4oJyAnKTtcbn1cbmZ1bmN0aW9uIHBhcnNlWFJhbmdlcyhyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS5zcGxpdCgvXFxzKy8pLm1hcCgocmFuZ2VWZXJzaW9uKT0+cmFuZ2VWZXJzaW9uLnRyaW0oKS5yZXBsYWNlKHBhcnNlUmVnZXgoeFJhbmdlKSwgKHJldCwgZ3RsdCwgbWFqb3IsIG1pbm9yLCBwYXRjaCwgcHJlUmVsZWFzZSk9PntcbiAgICAgICAgICAgIHZhciBpc1hNYWpvciA9IGlzWFZlcnNpb24obWFqb3IpO1xuICAgICAgICAgICAgdmFyIGlzWE1pbm9yID0gaXNYTWFqb3IgfHwgaXNYVmVyc2lvbihtaW5vcik7XG4gICAgICAgICAgICB2YXIgaXNYUGF0Y2ggPSBpc1hNaW5vciB8fCBpc1hWZXJzaW9uKHBhdGNoKTtcbiAgICAgICAgICAgIGlmIChndGx0ID09PSAnPScgJiYgaXNYUGF0Y2gpIHtcbiAgICAgICAgICAgICAgICBndGx0ID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcmVSZWxlYXNlID0gJyc7XG4gICAgICAgICAgICBpZiAoaXNYTWFqb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZ3RsdCA9PT0gJz4nIHx8IGd0bHQgPT09ICc8Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyBub3RoaW5nIGlzIGFsbG93ZWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8MC4wLjAtMCc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbm90aGluZyBpcyBmb3JiaWRkZW5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcqJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGd0bHQgJiYgaXNYUGF0Y2gpIHtcbiAgICAgICAgICAgICAgICAvLyByZXBsYWNlIFggd2l0aCAwXG4gICAgICAgICAgICAgICAgaWYgKGlzWE1pbm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG1pbm9yID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcGF0Y2ggPSAwO1xuICAgICAgICAgICAgICAgIGlmIChndGx0ID09PSAnPicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gPjEgPT4gPj0yLjAuMFxuICAgICAgICAgICAgICAgICAgICAvLyA+MS4yID0+ID49MS4zLjBcbiAgICAgICAgICAgICAgICAgICAgZ3RsdCA9ICc+PSc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1hNaW5vcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFqb3IgPSBOdW1iZXIobWFqb3IpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbm9yID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbm9yID0gTnVtYmVyKG1pbm9yKSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRjaCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGd0bHQgPT09ICc8PScpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gPD0wLjcueCBpcyBhY3R1YWxseSA8MC44LjAsIHNpbmNlIGFueSAwLjcueCBzaG91bGQgcGFzc1xuICAgICAgICAgICAgICAgICAgICAvLyBTaW1pbGFybHksIDw9Ny54IGlzIGFjdHVhbGx5IDw4LjAuMCwgZXRjLlxuICAgICAgICAgICAgICAgICAgICBndGx0ID0gJzwnO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNYTWlub3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ham9yID0gTnVtYmVyKG1ham9yKSArIDE7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtaW5vciA9IE51bWJlcihtaW5vcikgKyAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChndGx0ID09PSAnPCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJlUmVsZWFzZSA9ICctMCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBgJHtndGx0ICsgbWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9JHtwcmVSZWxlYXNlfWA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzWE1pbm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LjAuMCR7cHJlUmVsZWFzZX0gPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYUGF0Y2gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCR7cHJlUmVsZWFzZX0gPCR7bWFqb3J9LiR7TnVtYmVyKG1pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9KSkuam9pbignICcpO1xufVxuZnVuY3Rpb24gcGFyc2VTdGFyKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnRyaW0oKS5yZXBsYWNlKHBhcnNlUmVnZXgoc3RhciksICcnKTtcbn1cbmZ1bmN0aW9uIHBhcnNlR1RFMChjb21wYXJhdG9yU3RyaW5nKSB7XG4gICAgcmV0dXJuIGNvbXBhcmF0b3JTdHJpbmcudHJpbSgpLnJlcGxhY2UocGFyc2VSZWdleChndGUwKSwgJycpO1xufVxuLy8gZm9yayBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9vcmlnaW5qcy92aXRlLXBsdWdpbi1mZWRlcmF0aW9uL2Jsb2IvdjEuMS4xMi9wYWNrYWdlcy9saWIvc3JjL3V0aWxzL3NlbXZlci9pbmRleC50c1xuLy8gQ29weXJpZ2h0IChjKVxuLy8gdml0ZS1wbHVnaW4tZmVkZXJhdGlvbiBpcyBsaWNlbnNlZCB1bmRlciBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgY2FuIHVzZSB0aGlzIHNvZnR3YXJlIGFjY29yZGluZyB0byB0aGUgdGVybXMgYW5kIGNvbmRpdGlvbnMgb2YgdGhlIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiBNdWxhbiBQU0wgdjIgYXQ6XG4vLyAgICAgIGh0dHA6Ly9saWNlbnNlLmNvc2NsLm9yZy5jbi9NdWxhblBTTDJcbi8vIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgT04gQU4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT0YgQU5ZIEtJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gTk9OLUlORlJJTkdFTUVOVCwgTUVSQ0hBTlRBQklMSVRZIE9SIEZJVCBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuXG4vLyBTZWUgdGhlIE11bGFuIFBTTCB2MiBmb3IgbW9yZSBkZXRhaWxzLlxuZnVuY3Rpb24gY29tcGFyZUF0b20ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkge1xuICAgIHJhbmdlQXRvbSA9IE51bWJlcihyYW5nZUF0b20pIHx8IHJhbmdlQXRvbTtcbiAgICB2ZXJzaW9uQXRvbSA9IE51bWJlcih2ZXJzaW9uQXRvbSkgfHwgdmVyc2lvbkF0b207XG4gICAgaWYgKHJhbmdlQXRvbSA+IHZlcnNpb25BdG9tKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBpZiAocmFuZ2VBdG9tID09PSB2ZXJzaW9uQXRvbSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIC0xO1xufVxuZnVuY3Rpb24gY29tcGFyZVByZVJlbGVhc2UocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkge1xuICAgIHZhciByYW5nZVByZVJlbGVhc2UgPSByYW5nZUF0b20ucHJlUmVsZWFzZTtcbiAgICB2YXIgdmVyc2lvblByZVJlbGVhc2UgPSB2ZXJzaW9uQXRvbS5wcmVSZWxlYXNlO1xuICAgIGlmIChyYW5nZVByZVJlbGVhc2UgPT09IHVuZGVmaW5lZCAmJiBCb29sZWFuKHZlcnNpb25QcmVSZWxlYXNlKSkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgaWYgKEJvb2xlYW4ocmFuZ2VQcmVSZWxlYXNlKSAmJiB2ZXJzaW9uUHJlUmVsZWFzZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaWYgKHJhbmdlUHJlUmVsZWFzZSA9PT0gdW5kZWZpbmVkICYmIHZlcnNpb25QcmVSZWxlYXNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGZvcih2YXIgaSA9IDAsIG4gPSByYW5nZVByZVJlbGVhc2UubGVuZ3RoOyBpIDw9IG47IGkrKyl7XG4gICAgICAgIHZhciByYW5nZUVsZW1lbnQgPSByYW5nZVByZVJlbGVhc2VbaV07XG4gICAgICAgIHZhciB2ZXJzaW9uRWxlbWVudCA9IHZlcnNpb25QcmVSZWxlYXNlW2ldO1xuICAgICAgICBpZiAocmFuZ2VFbGVtZW50ID09PSB2ZXJzaW9uRWxlbWVudCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJhbmdlRWxlbWVudCA9PT0gdW5kZWZpbmVkICYmIHZlcnNpb25FbGVtZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmFuZ2VFbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZlcnNpb25FbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbXBhcmVBdG9tKHJhbmdlRWxlbWVudCwgdmVyc2lvbkVsZW1lbnQpO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbmZ1bmN0aW9uIGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHtcbiAgICByZXR1cm4gY29tcGFyZUF0b20ocmFuZ2VBdG9tLm1ham9yLCB2ZXJzaW9uQXRvbS5tYWpvcikgfHwgY29tcGFyZUF0b20ocmFuZ2VBdG9tLm1pbm9yLCB2ZXJzaW9uQXRvbS5taW5vcikgfHwgY29tcGFyZUF0b20ocmFuZ2VBdG9tLnBhdGNoLCB2ZXJzaW9uQXRvbS5wYXRjaCkgfHwgY29tcGFyZVByZVJlbGVhc2UocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSk7XG59XG5mdW5jdGlvbiBlcShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB7XG4gICAgcmV0dXJuIHJhbmdlQXRvbS52ZXJzaW9uID09PSB2ZXJzaW9uQXRvbS52ZXJzaW9uO1xufVxuZnVuY3Rpb24gY29tcGFyZShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB7XG4gICAgc3dpdGNoKHJhbmdlQXRvbS5vcGVyYXRvcil7XG4gICAgICAgIGNhc2UgJyc6XG4gICAgICAgIGNhc2UgJz0nOlxuICAgICAgICAgICAgcmV0dXJuIGVxKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pO1xuICAgICAgICBjYXNlICc+JzpcbiAgICAgICAgICAgIHJldHVybiBjb21wYXJlVmVyc2lvbihyYW5nZUF0b20sIHZlcnNpb25BdG9tKSA8IDA7XG4gICAgICAgIGNhc2UgJz49JzpcbiAgICAgICAgICAgIHJldHVybiBlcShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB8fCBjb21wYXJlVmVyc2lvbihyYW5nZUF0b20sIHZlcnNpb25BdG9tKSA8IDA7XG4gICAgICAgIGNhc2UgJzwnOlxuICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pID4gMDtcbiAgICAgICAgY2FzZSAnPD0nOlxuICAgICAgICAgICAgcmV0dXJuIGVxKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHx8IGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pID4gMDtcbiAgICAgICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gbWVhbiAqIG9yIHggLT4gYWxsIHZlcnNpb25zXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuLy8gZm9yayBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9vcmlnaW5qcy92aXRlLXBsdWdpbi1mZWRlcmF0aW9uL2Jsb2IvdjEuMS4xMi9wYWNrYWdlcy9saWIvc3JjL3V0aWxzL3NlbXZlci9pbmRleC50c1xuLy8gQ29weXJpZ2h0IChjKVxuLy8gdml0ZS1wbHVnaW4tZmVkZXJhdGlvbiBpcyBsaWNlbnNlZCB1bmRlciBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgY2FuIHVzZSB0aGlzIHNvZnR3YXJlIGFjY29yZGluZyB0byB0aGUgdGVybXMgYW5kIGNvbmRpdGlvbnMgb2YgdGhlIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiBNdWxhbiBQU0wgdjIgYXQ6XG4vLyAgICAgIGh0dHA6Ly9saWNlbnNlLmNvc2NsLm9yZy5jbi9NdWxhblBTTDJcbi8vIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgT04gQU4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT0YgQU5ZIEtJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gTk9OLUlORlJJTkdFTUVOVCwgTUVSQ0hBTlRBQklMSVRZIE9SIEZJVCBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuXG4vLyBTZWUgdGhlIE11bGFuIFBTTCB2MiBmb3IgbW9yZSBkZXRhaWxzLlxuZnVuY3Rpb24gcGFyc2VDb21wYXJhdG9yU3RyaW5nKHJhbmdlKSB7XG4gICAgcmV0dXJuIHBpcGUoLy8gXiAtLT4gKiAoYW55LCBraW5kYSBzaWxseSlcbiAgICAvLyBeMiwgXjIueCwgXjIueC54IC0tPiA+PTIuMC4wIDwzLjAuMC0wXG4gICAgLy8gXjIuMCwgXjIuMC54IC0tPiA+PTIuMC4wIDwzLjAuMC0wXG4gICAgLy8gXjEuMiwgXjEuMi54IC0tPiA+PTEuMi4wIDwyLjAuMC0wXG4gICAgLy8gXjEuMi4zIC0tPiA+PTEuMi4zIDwyLjAuMC0wXG4gICAgLy8gXjEuMi4wIC0tPiA+PTEuMi4wIDwyLjAuMC0wXG4gICAgcGFyc2VDYXJldHMsIC8vIH4sIH4+IC0tPiAqIChhbnksIGtpbmRhIHNpbGx5KVxuICAgIC8vIH4yLCB+Mi54LCB+Mi54LngsIH4+Miwgfj4yLnggfj4yLngueCAtLT4gPj0yLjAuMCA8My4wLjAtMFxuICAgIC8vIH4yLjAsIH4yLjAueCwgfj4yLjAsIH4+Mi4wLnggLS0+ID49Mi4wLjAgPDIuMS4wLTBcbiAgICAvLyB+MS4yLCB+MS4yLngsIH4+MS4yLCB+PjEuMi54IC0tPiA+PTEuMi4wIDwxLjMuMC0wXG4gICAgLy8gfjEuMi4zLCB+PjEuMi4zIC0tPiA+PTEuMi4zIDwxLjMuMC0wXG4gICAgLy8gfjEuMi4wLCB+PjEuMi4wIC0tPiA+PTEuMi4wIDwxLjMuMC0wXG4gICAgcGFyc2VUaWxkZXMsIHBhcnNlWFJhbmdlcywgcGFyc2VTdGFyKShyYW5nZSk7XG59XG5mdW5jdGlvbiBwYXJzZVJhbmdlKHJhbmdlKSB7XG4gICAgcmV0dXJuIHBpcGUoLy8gYDEuMi4zIC0gMS4yLjRgID0+IGA+PTEuMi4zIDw9MS4yLjRgXG4gICAgcGFyc2VIeXBoZW4sIC8vIGA+IDEuMi4zIDwgMS4yLjVgID0+IGA+MS4yLjMgPDEuMi41YFxuICAgIHBhcnNlQ29tcGFyYXRvclRyaW0sIC8vIGB+IDEuMi4zYCA9PiBgfjEuMi4zYFxuICAgIHBhcnNlVGlsZGVUcmltLCAvLyBgXiAxLjIuM2AgPT4gYF4xLjIuM2BcbiAgICBwYXJzZUNhcmV0VHJpbSkocmFuZ2UudHJpbSgpKS5zcGxpdCgvXFxzKy8pLmpvaW4oJyAnKTtcbn1cbmZ1bmN0aW9uIHNhdGlzZnkodmVyc2lvbiwgcmFuZ2UpIHtcbiAgICBpZiAoIXZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgcGFyc2VkUmFuZ2UgPSBwYXJzZVJhbmdlKHJhbmdlKTtcbiAgICB2YXIgcGFyc2VkQ29tcGFyYXRvciA9IHBhcnNlZFJhbmdlLnNwbGl0KCcgJykubWFwKChyYW5nZVZlcnNpb24pPT5wYXJzZUNvbXBhcmF0b3JTdHJpbmcocmFuZ2VWZXJzaW9uKSkuam9pbignICcpO1xuICAgIHZhciBjb21wYXJhdG9ycyA9IHBhcnNlZENvbXBhcmF0b3Iuc3BsaXQoL1xccysvKS5tYXAoKGNvbXBhcmF0b3IpPT5wYXJzZUdURTAoY29tcGFyYXRvcikpO1xuICAgIHZhciBleHRyYWN0ZWRWZXJzaW9uID0gZXh0cmFjdENvbXBhcmF0b3IodmVyc2lvbik7XG4gICAgaWYgKCFleHRyYWN0ZWRWZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIF9leHRyYWN0ZWRWZXJzaW9uID0gX3NsaWNlZF90b19hcnJheS5fKGV4dHJhY3RlZFZlcnNpb24sIDcpLCB2ZXJzaW9uT3BlcmF0b3IgPSBfZXh0cmFjdGVkVmVyc2lvblsxXSwgdmVyc2lvbk1ham9yID0gX2V4dHJhY3RlZFZlcnNpb25bM10sIHZlcnNpb25NaW5vciA9IF9leHRyYWN0ZWRWZXJzaW9uWzRdLCB2ZXJzaW9uUGF0Y2ggPSBfZXh0cmFjdGVkVmVyc2lvbls1XSwgdmVyc2lvblByZVJlbGVhc2UgPSBfZXh0cmFjdGVkVmVyc2lvbls2XTtcbiAgICB2YXIgdmVyc2lvbkF0b20gPSB7XG4gICAgICAgIG9wZXJhdG9yOiB2ZXJzaW9uT3BlcmF0b3IsXG4gICAgICAgIHZlcnNpb246IGNvbWJpbmVWZXJzaW9uKHZlcnNpb25NYWpvciwgdmVyc2lvbk1pbm9yLCB2ZXJzaW9uUGF0Y2gsIHZlcnNpb25QcmVSZWxlYXNlKSxcbiAgICAgICAgbWFqb3I6IHZlcnNpb25NYWpvcixcbiAgICAgICAgbWlub3I6IHZlcnNpb25NaW5vcixcbiAgICAgICAgcGF0Y2g6IHZlcnNpb25QYXRjaCxcbiAgICAgICAgcHJlUmVsZWFzZTogdmVyc2lvblByZVJlbGVhc2UgPT0gbnVsbCA/IHZvaWQgMCA6IHZlcnNpb25QcmVSZWxlYXNlLnNwbGl0KCcuJylcbiAgICB9O1xuICAgIGZvciAodmFyIGNvbXBhcmF0b3Igb2YgY29tcGFyYXRvcnMpe1xuICAgICAgICB2YXIgZXh0cmFjdGVkQ29tcGFyYXRvciA9IGV4dHJhY3RDb21wYXJhdG9yKGNvbXBhcmF0b3IpO1xuICAgICAgICBpZiAoIWV4dHJhY3RlZENvbXBhcmF0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX2V4dHJhY3RlZENvbXBhcmF0b3IgPSBfc2xpY2VkX3RvX2FycmF5Ll8oZXh0cmFjdGVkQ29tcGFyYXRvciwgNyksIHJhbmdlT3BlcmF0b3IgPSBfZXh0cmFjdGVkQ29tcGFyYXRvclsxXSwgcmFuZ2VNYWpvciA9IF9leHRyYWN0ZWRDb21wYXJhdG9yWzNdLCByYW5nZU1pbm9yID0gX2V4dHJhY3RlZENvbXBhcmF0b3JbNF0sIHJhbmdlUGF0Y2ggPSBfZXh0cmFjdGVkQ29tcGFyYXRvcls1XSwgcmFuZ2VQcmVSZWxlYXNlID0gX2V4dHJhY3RlZENvbXBhcmF0b3JbNl07XG4gICAgICAgIHZhciByYW5nZUF0b20gPSB7XG4gICAgICAgICAgICBvcGVyYXRvcjogcmFuZ2VPcGVyYXRvcixcbiAgICAgICAgICAgIHZlcnNpb246IGNvbWJpbmVWZXJzaW9uKHJhbmdlTWFqb3IsIHJhbmdlTWlub3IsIHJhbmdlUGF0Y2gsIHJhbmdlUHJlUmVsZWFzZSksXG4gICAgICAgICAgICBtYWpvcjogcmFuZ2VNYWpvcixcbiAgICAgICAgICAgIG1pbm9yOiByYW5nZU1pbm9yLFxuICAgICAgICAgICAgcGF0Y2g6IHJhbmdlUGF0Y2gsXG4gICAgICAgICAgICBwcmVSZWxlYXNlOiByYW5nZVByZVJlbGVhc2UgPT0gbnVsbCA/IHZvaWQgMCA6IHJhbmdlUHJlUmVsZWFzZS5zcGxpdCgnLicpXG4gICAgICAgIH07XG4gICAgICAgIGlmICghY29tcGFyZShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBlYXJseSByZXR1cm5cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIGZvcm1hdFNoYXJlKHNoYXJlQXJncywgZnJvbSwgbmFtZTEsIHNoYXJlU3RyYXRlZ3kpIHtcbiAgICB2YXIgZ2V0O1xuICAgIGlmICgnZ2V0JyBpbiBzaGFyZUFyZ3MpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1kZXN0cnVjdHVyaW5nXG4gICAgICAgIGdldCA9IHNoYXJlQXJncy5nZXQ7XG4gICAgfSBlbHNlIGlmICgnbGliJyBpbiBzaGFyZUFyZ3MpIHtcbiAgICAgICAgZ2V0ID0gKCk9PlByb21pc2UucmVzb2x2ZShzaGFyZUFyZ3MubGliKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBnZXQgPSAoKT0+UHJvbWlzZS5yZXNvbHZlKCgpPT57XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW4gbm90IGdldCBzaGFyZWQgJyR7bmFtZTF9JyFgKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoc2hhcmVBcmdzLnN0cmF0ZWd5KSB7XG4gICAgICAgIHdhcm4oYFwic2hhcmVkLnN0cmF0ZWd5IGlzIGRlcHJlY2F0ZWQsIHBsZWFzZSBzZXQgaW4gaW5pdE9wdGlvbnMuc2hhcmVTdHJhdGVneSBpbnN0ZWFkIVwiYCk7XG4gICAgfVxuICAgIHZhciBfc2hhcmVBcmdzX3ZlcnNpb24sIF9zaGFyZUFyZ3Nfc2NvcGUsIF9zaGFyZUFyZ3Nfc3RyYXRlZ3k7XG4gICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7XG4gICAgICAgIGRlcHM6IFtdLFxuICAgICAgICB1c2VJbjogW10sXG4gICAgICAgIGZyb20sXG4gICAgICAgIGxvYWRpbmc6IG51bGxcbiAgICB9LCBzaGFyZUFyZ3MsIHtcbiAgICAgICAgc2hhcmVDb25maWc6IHBvbHlmaWxscy5fZXh0ZW5kcyh7XG4gICAgICAgICAgICByZXF1aXJlZFZlcnNpb246IGBeJHtzaGFyZUFyZ3MudmVyc2lvbn1gLFxuICAgICAgICAgICAgc2luZ2xldG9uOiBmYWxzZSxcbiAgICAgICAgICAgIGVhZ2VyOiBmYWxzZSxcbiAgICAgICAgICAgIHN0cmljdFZlcnNpb246IGZhbHNlXG4gICAgICAgIH0sIHNoYXJlQXJncy5zaGFyZUNvbmZpZyksXG4gICAgICAgIGdldCxcbiAgICAgICAgbG9hZGVkOiAoc2hhcmVBcmdzID09IG51bGwgPyB2b2lkIDAgOiBzaGFyZUFyZ3MubG9hZGVkKSB8fCAnbGliJyBpbiBzaGFyZUFyZ3MgPyB0cnVlIDogdW5kZWZpbmVkLFxuICAgICAgICB2ZXJzaW9uOiAoX3NoYXJlQXJnc192ZXJzaW9uID0gc2hhcmVBcmdzLnZlcnNpb24pICE9IG51bGwgPyBfc2hhcmVBcmdzX3ZlcnNpb24gOiAnMCcsXG4gICAgICAgIHNjb3BlOiBBcnJheS5pc0FycmF5KHNoYXJlQXJncy5zY29wZSkgPyBzaGFyZUFyZ3Muc2NvcGUgOiBbXG4gICAgICAgICAgICAoX3NoYXJlQXJnc19zY29wZSA9IHNoYXJlQXJncy5zY29wZSkgIT0gbnVsbCA/IF9zaGFyZUFyZ3Nfc2NvcGUgOiAnZGVmYXVsdCdcbiAgICAgICAgXSxcbiAgICAgICAgc3RyYXRlZ3k6ICgoX3NoYXJlQXJnc19zdHJhdGVneSA9IHNoYXJlQXJncy5zdHJhdGVneSkgIT0gbnVsbCA/IF9zaGFyZUFyZ3Nfc3RyYXRlZ3kgOiBzaGFyZVN0cmF0ZWd5KSB8fCAndmVyc2lvbi1maXJzdCdcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGZvcm1hdFNoYXJlQ29uZmlncyhnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucykge1xuICAgIHZhciBzaGFyZUFyZ3MgPSB1c2VyT3B0aW9ucy5zaGFyZWQgfHwge307XG4gICAgdmFyIGZyb20gPSB1c2VyT3B0aW9ucy5uYW1lO1xuICAgIHZhciBzaGFyZUluZm9zID0gT2JqZWN0LmtleXMoc2hhcmVBcmdzKS5yZWR1Y2UoKHJlcywgcGtnTmFtZSk9PntcbiAgICAgICAgdmFyIGFycmF5U2hhcmVBcmdzID0gYXJyYXlPcHRpb25zKHNoYXJlQXJnc1twa2dOYW1lXSk7XG4gICAgICAgIHJlc1twa2dOYW1lXSA9IHJlc1twa2dOYW1lXSB8fCBbXTtcbiAgICAgICAgYXJyYXlTaGFyZUFyZ3MuZm9yRWFjaCgoc2hhcmVDb25maWcpPT57XG4gICAgICAgICAgICByZXNbcGtnTmFtZV0ucHVzaChmb3JtYXRTaGFyZShzaGFyZUNvbmZpZywgZnJvbSwgcGtnTmFtZSwgdXNlck9wdGlvbnMuc2hhcmVTdHJhdGVneSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9LCB7fSk7XG4gICAgdmFyIHNoYXJlZCA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgZ2xvYmFsT3B0aW9ucy5zaGFyZWQpO1xuICAgIE9iamVjdC5rZXlzKHNoYXJlSW5mb3MpLmZvckVhY2goKHNoYXJlS2V5KT0+e1xuICAgICAgICBpZiAoIXNoYXJlZFtzaGFyZUtleV0pIHtcbiAgICAgICAgICAgIHNoYXJlZFtzaGFyZUtleV0gPSBzaGFyZUluZm9zW3NoYXJlS2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNoYXJlSW5mb3Nbc2hhcmVLZXldLmZvckVhY2goKG5ld1VzZXJTaGFyZWRPcHRpb25zKT0+e1xuICAgICAgICAgICAgICAgIHZhciBpc1NhbWVWZXJzaW9uID0gc2hhcmVkW3NoYXJlS2V5XS5maW5kKChzaGFyZWRWYWwpPT5zaGFyZWRWYWwudmVyc2lvbiA9PT0gbmV3VXNlclNoYXJlZE9wdGlvbnMudmVyc2lvbik7XG4gICAgICAgICAgICAgICAgaWYgKCFpc1NhbWVWZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZFtzaGFyZUtleV0ucHVzaChuZXdVc2VyU2hhcmVkT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzaGFyZWQsXG4gICAgICAgIHNoYXJlSW5mb3NcbiAgICB9O1xufVxuZnVuY3Rpb24gdmVyc2lvbkx0KGEsIGIpIHtcbiAgICB2YXIgdHJhbnNmb3JtSW52YWxpZFZlcnNpb24gPSAodmVyc2lvbik9PntcbiAgICAgICAgdmFyIGlzTnVtYmVyVmVyc2lvbiA9ICFOdW1iZXIuaXNOYU4oTnVtYmVyKHZlcnNpb24pKTtcbiAgICAgICAgaWYgKGlzTnVtYmVyVmVyc2lvbikge1xuICAgICAgICAgICAgdmFyIHNwbGl0QXJyID0gdmVyc2lvbi5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIHZhbGlkVmVyc2lvbiA9IHZlcnNpb247XG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgMyAtIHNwbGl0QXJyLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICB2YWxpZFZlcnNpb24gKz0gJy4wJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWxpZFZlcnNpb247XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZlcnNpb247XG4gICAgfTtcbiAgICBpZiAoc2F0aXNmeSh0cmFuc2Zvcm1JbnZhbGlkVmVyc2lvbihhKSwgYDw9JHt0cmFuc2Zvcm1JbnZhbGlkVmVyc2lvbihiKX1gKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxudmFyIGZpbmRWZXJzaW9uID0gKHNoYXJlVmVyc2lvbk1hcCwgY2IpPT57XG4gICAgdmFyIGNhbGxiYWNrID0gY2IgfHwgZnVuY3Rpb24ocHJldiwgY3VyKSB7XG4gICAgICAgIHJldHVybiB2ZXJzaW9uTHQocHJldiwgY3VyKTtcbiAgICB9O1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhzaGFyZVZlcnNpb25NYXApLnJlZHVjZSgocHJldiwgY3VyKT0+e1xuICAgICAgICBpZiAoIXByZXYpIHtcbiAgICAgICAgICAgIHJldHVybiBjdXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhbGxiYWNrKHByZXYsIGN1cikpIHtcbiAgICAgICAgICAgIHJldHVybiBjdXI7XG4gICAgICAgIH1cbiAgICAgICAgLy8gZGVmYXVsdCB2ZXJzaW9uIGlzICcwJyBodHRwczovL2dpdGh1Yi5jb20vd2VicGFjay93ZWJwYWNrL2Jsb2IvbWFpbi9saWIvc2hhcmluZy9Qcm92aWRlU2hhcmVkTW9kdWxlLmpzI0wxMzZcbiAgICAgICAgaWYgKHByZXYgPT09ICcwJykge1xuICAgICAgICAgICAgcmV0dXJuIGN1cjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJldjtcbiAgICB9LCAwKTtcbn07XG52YXIgaXNMb2FkZWQgPSAoc2hhcmVkKT0+e1xuICAgIHJldHVybiBCb29sZWFuKHNoYXJlZC5sb2FkZWQpIHx8IHR5cGVvZiBzaGFyZWQubGliID09PSAnZnVuY3Rpb24nO1xufTtcbnZhciBpc0xvYWRpbmcgPSAoc2hhcmVkKT0+e1xuICAgIHJldHVybiBCb29sZWFuKHNoYXJlZC5sb2FkaW5nKTtcbn07XG5mdW5jdGlvbiBmaW5kU2luZ2xldG9uVmVyc2lvbk9yZGVyQnlWZXJzaW9uKHNoYXJlU2NvcGVNYXAsIHNjb3BlLCBwa2dOYW1lKSB7XG4gICAgdmFyIHZlcnNpb25zID0gc2hhcmVTY29wZU1hcFtzY29wZV1bcGtnTmFtZV07XG4gICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24ocHJldiwgY3VyKSB7XG4gICAgICAgIHJldHVybiAhaXNMb2FkZWQodmVyc2lvbnNbcHJldl0pICYmIHZlcnNpb25MdChwcmV2LCBjdXIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZpbmRWZXJzaW9uKHNoYXJlU2NvcGVNYXBbc2NvcGVdW3BrZ05hbWVdLCBjYWxsYmFjayk7XG59XG5mdW5jdGlvbiBmaW5kU2luZ2xldG9uVmVyc2lvbk9yZGVyQnlMb2FkZWQoc2hhcmVTY29wZU1hcCwgc2NvcGUsIHBrZ05hbWUpIHtcbiAgICB2YXIgdmVyc2lvbnMgPSBzaGFyZVNjb3BlTWFwW3Njb3BlXVtwa2dOYW1lXTtcbiAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgdmFyIGlzTG9hZGluZ09yTG9hZGVkID0gKHNoYXJlZCk9PntcbiAgICAgICAgICAgIHJldHVybiBpc0xvYWRlZChzaGFyZWQpIHx8IGlzTG9hZGluZyhzaGFyZWQpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoaXNMb2FkaW5nT3JMb2FkZWQodmVyc2lvbnNbY3VyXSkpIHtcbiAgICAgICAgICAgIGlmIChpc0xvYWRpbmdPckxvYWRlZCh2ZXJzaW9uc1twcmV2XSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbih2ZXJzaW9uTHQocHJldiwgY3VyKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpc0xvYWRpbmdPckxvYWRlZCh2ZXJzaW9uc1twcmV2XSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmVyc2lvbkx0KHByZXYsIGN1cik7XG4gICAgfTtcbiAgICByZXR1cm4gZmluZFZlcnNpb24oc2hhcmVTY29wZU1hcFtzY29wZV1bcGtnTmFtZV0sIGNhbGxiYWNrKTtcbn1cbmZ1bmN0aW9uIGdldEZpbmRTaGFyZUZ1bmN0aW9uKHN0cmF0ZWd5KSB7XG4gICAgaWYgKHN0cmF0ZWd5ID09PSAnbG9hZGVkLWZpcnN0Jykge1xuICAgICAgICByZXR1cm4gZmluZFNpbmdsZXRvblZlcnNpb25PcmRlckJ5TG9hZGVkO1xuICAgIH1cbiAgICByZXR1cm4gZmluZFNpbmdsZXRvblZlcnNpb25PcmRlckJ5VmVyc2lvbjtcbn1cbmZ1bmN0aW9uIGdldFJlZ2lzdGVyZWRTaGFyZShsb2NhbFNoYXJlU2NvcGVNYXAsIHBrZ05hbWUsIHNoYXJlSW5mbywgcmVzb2x2ZVNoYXJlKSB7XG4gICAgdmFyIF9sb29wID0gZnVuY3Rpb24oc2MpIHtcbiAgICAgICAgaWYgKHNoYXJlQ29uZmlnICYmIGxvY2FsU2hhcmVTY29wZU1hcFtzY10gJiYgbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXSkge1xuICAgICAgICAgICAgdmFyIHJlcXVpcmVkVmVyc2lvbiA9IHNoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbjtcbiAgICAgICAgICAgIHZhciBmaW5kU2hhcmVGdW5jdGlvbiA9IGdldEZpbmRTaGFyZUZ1bmN0aW9uKHN0cmF0ZWd5KTtcbiAgICAgICAgICAgIHZhciBtYXhPclNpbmdsZXRvblZlcnNpb24gPSBmaW5kU2hhcmVGdW5jdGlvbihsb2NhbFNoYXJlU2NvcGVNYXAsIHNjLCBwa2dOYW1lKTtcbiAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgdmFyIGRlZmF1bHRSZXNvbHZlciA9ICgpPT57XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlQ29uZmlnLnNpbmdsZXRvbikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlcXVpcmVkVmVyc2lvbiA9PT0gJ3N0cmluZycgJiYgIXNhdGlzZnkobWF4T3JTaW5nbGV0b25WZXJzaW9uLCByZXF1aXJlZFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXNnID0gYFZlcnNpb24gJHttYXhPclNpbmdsZXRvblZlcnNpb259IGZyb20gJHttYXhPclNpbmdsZXRvblZlcnNpb24gJiYgbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVttYXhPclNpbmdsZXRvblZlcnNpb25dLmZyb219IG9mIHNoYXJlZCBzaW5nbGV0b24gbW9kdWxlICR7cGtnTmFtZX0gZG9lcyBub3Qgc2F0aXNmeSB0aGUgcmVxdWlyZW1lbnQgb2YgJHtzaGFyZUluZm8uZnJvbX0gd2hpY2ggbmVlZHMgJHtyZXF1aXJlZFZlcnNpb259KWA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKG1zZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4obXNnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVttYXhPclNpbmdsZXRvblZlcnNpb25dO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXF1aXJlZFZlcnNpb24gPT09IGZhbHNlIHx8IHJlcXVpcmVkVmVyc2lvbiA9PT0gJyonKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVttYXhPclNpbmdsZXRvblZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzYXRpc2Z5KG1heE9yU2luZ2xldG9uVmVyc2lvbiwgcmVxdWlyZWRWZXJzaW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsU2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV1bbWF4T3JTaW5nbGV0b25WZXJzaW9uXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMobG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXSkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgdmVyc2lvbktleSA9IF9yZWZbMF0sIHZlcnNpb25WYWx1ZSA9IF9yZWZbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2F0aXNmeSh2ZXJzaW9uS2V5LCByZXF1aXJlZFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZlcnNpb25WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIHNoYXJlU2NvcGVNYXA6IGxvY2FsU2hhcmVTY29wZU1hcCxcbiAgICAgICAgICAgICAgICBzY29wZTogc2MsXG4gICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBtYXhPclNpbmdsZXRvblZlcnNpb24sXG4gICAgICAgICAgICAgICAgR2xvYmFsRmVkZXJhdGlvbjogR2xvYmFsLl9fRkVERVJBVElPTl9fLFxuICAgICAgICAgICAgICAgIHJlc29sdmVyOiBkZWZhdWx0UmVzb2x2ZXJcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcmVzb2x2ZVNoYXJlZCA9IHJlc29sdmVTaGFyZS5lbWl0KHBhcmFtcykgfHwgcGFyYW1zO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2OiByZXNvbHZlU2hhcmVkLnJlc29sdmVyKClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGlmICghbG9jYWxTaGFyZVNjb3BlTWFwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHNoYXJlQ29uZmlnID0gc2hhcmVJbmZvLnNoYXJlQ29uZmlnLCBfc2hhcmVJbmZvX3Njb3BlID0gc2hhcmVJbmZvLnNjb3BlLCBzY29wZSA9IF9zaGFyZUluZm9fc2NvcGUgPT09IHZvaWQgMCA/IERFRkFVTFRfU0NPUEUgOiBfc2hhcmVJbmZvX3Njb3BlLCBzdHJhdGVneSA9IHNoYXJlSW5mby5zdHJhdGVneTtcbiAgICB2YXIgc2NvcGVzID0gQXJyYXkuaXNBcnJheShzY29wZSkgPyBzY29wZSA6IFtcbiAgICAgICAgc2NvcGVcbiAgICBdO1xuICAgIGZvciAodmFyIHNjIG9mIHNjb3Blcyl7XG4gICAgICAgIHZhciBfcmV0ID0gX2xvb3Aoc2MpO1xuICAgICAgICBpZiAoX3R5cGVfb2YuXyhfcmV0KSA9PT0gXCJvYmplY3RcIikgcmV0dXJuIF9yZXQudjtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRHbG9iYWxTaGFyZVNjb3BlKCkge1xuICAgIHJldHVybiBHbG9iYWwuX19GRURFUkFUSU9OX18uX19TSEFSRV9fO1xufVxuZnVuY3Rpb24gZ2V0VGFyZ2V0U2hhcmVkT3B0aW9ucyhvcHRpb25zKSB7XG4gICAgdmFyIHBrZ05hbWUgPSBvcHRpb25zLnBrZ05hbWUsIGV4dHJhT3B0aW9ucyA9IG9wdGlvbnMuZXh0cmFPcHRpb25zLCBzaGFyZUluZm9zID0gb3B0aW9ucy5zaGFyZUluZm9zO1xuICAgIHZhciBkZWZhdWx0UmVzb2x2ZXIgPSAoc2hhcmVkT3B0aW9ucyk9PntcbiAgICAgICAgaWYgKCFzaGFyZWRPcHRpb25zKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzaGFyZVZlcnNpb25NYXAgPSB7fTtcbiAgICAgICAgc2hhcmVkT3B0aW9ucy5mb3JFYWNoKChzaGFyZWQpPT57XG4gICAgICAgICAgICBzaGFyZVZlcnNpb25NYXBbc2hhcmVkLnZlcnNpb25dID0gc2hhcmVkO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24ocHJldiwgY3VyKSB7XG4gICAgICAgICAgICByZXR1cm4gIWlzTG9hZGVkKHNoYXJlVmVyc2lvbk1hcFtwcmV2XSkgJiYgdmVyc2lvbkx0KHByZXYsIGN1cik7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBtYXhWZXJzaW9uID0gZmluZFZlcnNpb24oc2hhcmVWZXJzaW9uTWFwLCBjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiBzaGFyZVZlcnNpb25NYXBbbWF4VmVyc2lvbl07XG4gICAgfTtcbiAgICB2YXIgX2V4dHJhT3B0aW9uc19yZXNvbHZlcjtcbiAgICB2YXIgcmVzb2x2ZXIgPSAoX2V4dHJhT3B0aW9uc19yZXNvbHZlciA9IGV4dHJhT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZXh0cmFPcHRpb25zLnJlc29sdmVyKSAhPSBudWxsID8gX2V4dHJhT3B0aW9uc19yZXNvbHZlciA6IGRlZmF1bHRSZXNvbHZlcjtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgcmVzb2x2ZXIoc2hhcmVJbmZvc1twa2dOYW1lXSksIGV4dHJhT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZXh0cmFPcHRpb25zLmN1c3RvbVNoYXJlSW5mbyk7XG59XG52YXIgU2hhcmVVdGlscyA9IHtcbiAgICBnZXRSZWdpc3RlcmVkU2hhcmUsXG4gICAgZ2V0R2xvYmFsU2hhcmVTY29wZVxufTtcbnZhciBHbG9iYWxVdGlscyA9IHtcbiAgICBHbG9iYWwsXG4gICAgbmF0aXZlR2xvYmFsLFxuICAgIHJlc2V0RmVkZXJhdGlvbkdsb2JhbEluZm8sXG4gICAgc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlLFxuICAgIGdldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcixcbiAgICBzZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IsXG4gICAgZ2V0SW5mb1dpdGhvdXRUeXBlLFxuICAgIGdldEdsb2JhbFNuYXBzaG90LFxuICAgIGdldFRhcmdldFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyxcbiAgICBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8sXG4gICAgc2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvLFxuICAgIGFkZEdsb2JhbFNuYXBzaG90LFxuICAgIGdldFJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICByZWdpc3Rlckdsb2JhbFBsdWdpbnMsXG4gICAgZ2V0R2xvYmFsSG9zdFBsdWdpbnMsXG4gICAgZ2V0UHJlbG9hZGVkLFxuICAgIHNldFByZWxvYWRlZFxufTtcbnZhciBoZWxwZXJzID0ge1xuICAgIGdsb2JhbDogR2xvYmFsVXRpbHMsXG4gICAgc2hhcmU6IFNoYXJlVXRpbHNcbn07XG5mdW5jdGlvbiBnZXRCdWlsZGVySWQoKSB7XG4gICAgLy9AdHMtaWdub3JlXG4gICAgcmV0dXJuICB0cnVlID8gXCJtdXNpY3M6MS4wLjBcIiA6IDA7XG59XG4vLyBGdW5jdGlvbiB0byBtYXRjaCBhIHJlbW90ZSB3aXRoIGl0cyBuYW1lIGFuZCBleHBvc2Vcbi8vIGlkOiBwa2dOYW1lKEBmZWRlcmF0aW9uL2FwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBAZmVkZXJhdGlvbi9hcHAxL2J1dHRvblxuLy8gaWQ6IGFsaWFzKGFwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBhcHAxL2J1dHRvblxuLy8gaWQ6IGFsaWFzKGFwcDEvdXRpbHMpICsgZXhwb3NlKGxvYWRhc2gvc29ydCkgPSBhcHAxL3V0aWxzL2xvYWRhc2gvc29ydFxuZnVuY3Rpb24gbWF0Y2hSZW1vdGVXaXRoTmFtZUFuZEV4cG9zZShyZW1vdGVzLCBpZCkge1xuICAgIGZvciAodmFyIHJlbW90ZSBvZiByZW1vdGVzKXtcbiAgICAgICAgLy8gbWF0Y2ggcGtnTmFtZVxuICAgICAgICB2YXIgaXNOYW1lTWF0Y2hlZCA9IGlkLnN0YXJ0c1dpdGgocmVtb3RlLm5hbWUpO1xuICAgICAgICB2YXIgZXhwb3NlID0gaWQucmVwbGFjZShyZW1vdGUubmFtZSwgJycpO1xuICAgICAgICBpZiAoaXNOYW1lTWF0Y2hlZCkge1xuICAgICAgICAgICAgaWYgKGV4cG9zZS5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGtnTmFtZU9yQWxpYXMgPSByZW1vdGUubmFtZTtcbiAgICAgICAgICAgICAgICBleHBvc2UgPSBgLiR7ZXhwb3NlfWA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcGtnTmFtZU9yQWxpYXMsXG4gICAgICAgICAgICAgICAgICAgIGV4cG9zZSxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhwb3NlID09PSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzOiByZW1vdGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlOiAnLicsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gbWF0Y2ggYWxpYXNcbiAgICAgICAgdmFyIGlzQWxpYXNNYXRjaGVkID0gcmVtb3RlLmFsaWFzICYmIGlkLnN0YXJ0c1dpdGgocmVtb3RlLmFsaWFzKTtcbiAgICAgICAgdmFyIGV4cG9zZVdpdGhBbGlhcyA9IHJlbW90ZS5hbGlhcyAmJiBpZC5yZXBsYWNlKHJlbW90ZS5hbGlhcywgJycpO1xuICAgICAgICBpZiAocmVtb3RlLmFsaWFzICYmIGlzQWxpYXNNYXRjaGVkKSB7XG4gICAgICAgICAgICBpZiAoZXhwb3NlV2l0aEFsaWFzICYmIGV4cG9zZVdpdGhBbGlhcy5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGtnTmFtZU9yQWxpYXMxID0gcmVtb3RlLmFsaWFzO1xuICAgICAgICAgICAgICAgIGV4cG9zZVdpdGhBbGlhcyA9IGAuJHtleHBvc2VXaXRoQWxpYXN9YDtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwa2dOYW1lT3JBbGlhczogcGtnTmFtZU9yQWxpYXMxLFxuICAgICAgICAgICAgICAgICAgICBleHBvc2U6IGV4cG9zZVdpdGhBbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhwb3NlV2l0aEFsaWFzID09PSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzOiByZW1vdGUuYWxpYXMsXG4gICAgICAgICAgICAgICAgICAgIGV4cG9zZTogJy4nLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybjtcbn1cbi8vIEZ1bmN0aW9uIHRvIG1hdGNoIGEgcmVtb3RlIHdpdGggaXRzIG5hbWUgb3IgYWxpYXNcbmZ1bmN0aW9uIG1hdGNoUmVtb3RlKHJlbW90ZXMsIG5hbWVPckFsaWFzKSB7XG4gICAgZm9yICh2YXIgcmVtb3RlIG9mIHJlbW90ZXMpe1xuICAgICAgICB2YXIgaXNOYW1lTWF0Y2hlZCA9IG5hbWVPckFsaWFzID09PSByZW1vdGUubmFtZTtcbiAgICAgICAgaWYgKGlzTmFtZU1hdGNoZWQpIHtcbiAgICAgICAgICAgIHJldHVybiByZW1vdGU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlzQWxpYXNNYXRjaGVkID0gcmVtb3RlLmFsaWFzICYmIG5hbWVPckFsaWFzID09PSByZW1vdGUuYWxpYXM7XG4gICAgICAgIGlmIChpc0FsaWFzTWF0Y2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm47XG59XG5mdW5jdGlvbiByZWdpc3RlclBsdWdpbnMocGx1Z2lucywgaG9va0luc3RhbmNlcykge1xuICAgIHZhciBnbG9iYWxQbHVnaW5zID0gZ2V0R2xvYmFsSG9zdFBsdWdpbnMoKTtcbiAgICAvLyBJbmNvcnBvcmF0ZSBnbG9iYWwgcGx1Z2luc1xuICAgIGlmIChnbG9iYWxQbHVnaW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZ2xvYmFsUGx1Z2lucy5mb3JFYWNoKChwbHVnaW4pPT57XG4gICAgICAgICAgICBpZiAocGx1Z2lucyA9PSBudWxsID8gdm9pZCAwIDogcGx1Z2lucy5maW5kKChpdGVtKT0+aXRlbS5uYW1lICE9PSBwbHVnaW4ubmFtZSkpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW5zLnB1c2gocGx1Z2luKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChwbHVnaW5zICYmIHBsdWdpbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBwbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgICAgIGhvb2tJbnN0YW5jZXMuZm9yRWFjaCgoaG9va0luc3RhbmNlKT0+e1xuICAgICAgICAgICAgICAgIGhvb2tJbnN0YW5jZS5hcHBseVBsdWdpbihwbHVnaW4pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcGx1Z2lucztcbn1cbmZ1bmN0aW9uIGxvYWRFc21FbnRyeShfMCkge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKHJlZikge1xuICAgICAgICB2YXIgZW50cnkgPSByZWYuZW50cnksIHJlbW90ZUVudHJ5RXhwb3J0cyA9IHJlZi5yZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+e1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoIXJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEZ1bmN0aW9uKCdjYWxsYmFja3MnLCBgaW1wb3J0KFwiJHtlbnRyeX1cIikudGhlbihjYWxsYmFja3NbMF0pLmNhdGNoKGNhbGxiYWNrc1sxXSlgKShbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge31cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlbW90ZUVudHJ5RXhwb3J0cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIGxvYWRTeXN0ZW1Kc0VudHJ5KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHJlZi5lbnRyeSwgcmVtb3RlRW50cnlFeHBvcnRzID0gcmVmLnJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpPT57XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghcmVtb3RlRW50cnlFeHBvcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmFsc2UpIHt9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEZ1bmN0aW9uKCdjYWxsYmFja3MnLCBgU3lzdGVtLmltcG9ydChcIiR7ZW50cnl9XCIpLnRoZW4oY2FsbGJhY2tzWzBdKS5jYXRjaChjYWxsYmFja3NbMV0pYCkoW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVtb3RlRW50cnlFeHBvcnRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gbG9hZEVudHJ5U2NyaXB0KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBuYW1lMSA9IHJlZi5uYW1lLCBnbG9iYWxOYW1lID0gcmVmLmdsb2JhbE5hbWUsIGVudHJ5ID0gcmVmLmVudHJ5LCBsb2FkZXJIb29rID0gcmVmLmxvYWRlckhvb2s7XG4gICAgICAgIHZhciBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzID0gZ2V0UmVtb3RlRW50cnlFeHBvcnRzKG5hbWUxLCBnbG9iYWxOYW1lKSwgcmVtb3RlRW50cnlFeHBvcnRzID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5lbnRyeUV4cG9ydHM7XG4gICAgICAgIGlmIChyZW1vdGVFbnRyeUV4cG9ydHMpIHtcbiAgICAgICAgICAgIHJldHVybiByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNkay5sb2FkU2NyaXB0KGVudHJ5LCB7XG4gICAgICAgICAgICBhdHRyczoge30sXG4gICAgICAgICAgICBjcmVhdGVTY3JpcHRIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gbG9hZGVySG9vay5saWZlY3ljbGUuY3JlYXRlU2NyaXB0LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXMpIHJldHVybjtcbiAgICAgICAgICAgICAgICBpZiAocmVzIGluc3RhbmNlb2YgSFRNTFNjcmlwdEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCdzY3JpcHQnIGluIHJlcyB8fCAndGltZW91dCcgaW4gcmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkudGhlbigoKT0+e1xuICAgICAgICAgICAgdmFyIF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMgPSBnZXRSZW1vdGVFbnRyeUV4cG9ydHMobmFtZTEsIGdsb2JhbE5hbWUpLCByZW1vdGVFbnRyeUtleSA9IF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMucmVtb3RlRW50cnlLZXksIGVudHJ5RXhwb3J0cyA9IF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMuZW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgYXNzZXJ0KGVudHJ5RXhwb3J0cywgZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDEsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICByZW1vdGVOYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICByZW1vdGVFbnRyeVVybDogZW50cnksXG4gICAgICAgICAgICAgICAgcmVtb3RlRW50cnlLZXlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJldHVybiBlbnRyeUV4cG9ydHM7XG4gICAgICAgIH0pLmNhdGNoKChlKT0+e1xuICAgICAgICAgICAgYXNzZXJ0KHVuZGVmaW5lZCwgZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDgsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICByZW1vdGVOYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICByZXNvdXJjZVVybDogZW50cnlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgIH0pO1xuICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBsb2FkRW50cnlEb20oXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSByZWYucmVtb3RlSW5mbywgcmVtb3RlRW50cnlFeHBvcnRzID0gcmVmLnJlbW90ZUVudHJ5RXhwb3J0cywgbG9hZGVySG9vayA9IHJlZi5sb2FkZXJIb29rO1xuICAgICAgICB2YXIgZW50cnkgPSByZW1vdGVJbmZvLmVudHJ5LCBnbG9iYWxOYW1lID0gcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUsIG5hbWUxID0gcmVtb3RlSW5mby5uYW1lLCB0eXBlID0gcmVtb3RlSW5mby50eXBlO1xuICAgICAgICBzd2l0Y2godHlwZSl7XG4gICAgICAgICAgICBjYXNlICdlc20nOlxuICAgICAgICAgICAgY2FzZSAnbW9kdWxlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZEVzbUVudHJ5KHtcbiAgICAgICAgICAgICAgICAgICAgZW50cnksXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0c1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY2FzZSAnc3lzdGVtJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZFN5c3RlbUpzRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICBlbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkRW50cnlTY3JpcHQoe1xuICAgICAgICAgICAgICAgICAgICBlbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgICAgIGxvYWRlckhvb2tcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBsb2FkRW50cnlOb2RlKF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciByZW1vdGVJbmZvID0gcmVmLnJlbW90ZUluZm8sIGxvYWRlckhvb2sgPSByZWYubG9hZGVySG9vaztcbiAgICAgICAgdmFyIGVudHJ5ID0gcmVtb3RlSW5mby5lbnRyeSwgZ2xvYmFsTmFtZSA9IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lLCBuYW1lMSA9IHJlbW90ZUluZm8ubmFtZSwgdHlwZSA9IHJlbW90ZUluZm8udHlwZTtcbiAgICAgICAgdmFyIF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMgPSBnZXRSZW1vdGVFbnRyeUV4cG9ydHMobmFtZTEsIGdsb2JhbE5hbWUpLCByZW1vdGVFbnRyeUV4cG9ydHMgPSBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzLmVudHJ5RXhwb3J0cztcbiAgICAgICAgaWYgKHJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2RrLmxvYWRTY3JpcHROb2RlKGVudHJ5LCB7XG4gICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIGdsb2JhbE5hbWUsXG4gICAgICAgICAgICAgICAgdHlwZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxvYWRlckhvb2s6IHtcbiAgICAgICAgICAgICAgICBjcmVhdGVTY3JpcHRIb29rOiAodXJsLCByZWYpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBhdHRycyA9IHJlZiA9PT0gdm9pZCAwID8ge30gOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBsb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVTY3JpcHQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyc1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXMpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCd1cmwnIGluIHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KS50aGVuKCgpPT57XG4gICAgICAgICAgICB2YXIgX2dldFJlbW90ZUVudHJ5RXhwb3J0cyA9IGdldFJlbW90ZUVudHJ5RXhwb3J0cyhuYW1lMSwgZ2xvYmFsTmFtZSksIHJlbW90ZUVudHJ5S2V5ID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5yZW1vdGVFbnRyeUtleSwgZW50cnlFeHBvcnRzID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5lbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICBhc3NlcnQoZW50cnlFeHBvcnRzLCBlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwMSwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgIHJlbW90ZU5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5VXJsOiBlbnRyeSxcbiAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUtleVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIGVudHJ5RXhwb3J0cztcbiAgICAgICAgfSkuY2F0Y2goKGUpPT57XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9KTtcbiAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gZ2V0UmVtb3RlRW50cnlVbmlxdWVLZXkocmVtb3RlSW5mbykge1xuICAgIHZhciBlbnRyeSA9IHJlbW90ZUluZm8uZW50cnksIG5hbWUxID0gcmVtb3RlSW5mby5uYW1lO1xuICAgIHJldHVybiBzZGsuY29tcG9zZUtleVdpdGhTZXBhcmF0b3IobmFtZTEsIGVudHJ5KTtcbn1cbmZ1bmN0aW9uIGdldFJlbW90ZUVudHJ5KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBvcmlnaW4gPSByZWYub3JpZ2luLCByZW1vdGVFbnRyeUV4cG9ydHMgPSByZWYucmVtb3RlRW50cnlFeHBvcnRzLCByZW1vdGVJbmZvID0gcmVmLnJlbW90ZUluZm87XG4gICAgICAgIHZhciB1bmlxdWVLZXkgPSBnZXRSZW1vdGVFbnRyeVVuaXF1ZUtleShyZW1vdGVJbmZvKTtcbiAgICAgICAgaWYgKHJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWdsb2JhbExvYWRpbmdbdW5pcXVlS2V5XSkge1xuICAgICAgICAgICAgdmFyIGxvYWRFbnRyeUhvb2sgPSBvcmlnaW4ucmVtb3RlSGFuZGxlci5ob29rcy5saWZlY3ljbGUubG9hZEVudHJ5O1xuICAgICAgICAgICAgdmFyIGxvYWRlckhvb2sgPSBvcmlnaW4ubG9hZGVySG9vaztcbiAgICAgICAgICAgIGdsb2JhbExvYWRpbmdbdW5pcXVlS2V5XSA9IGxvYWRFbnRyeUhvb2suZW1pdCh7XG4gICAgICAgICAgICAgICAgbG9hZGVySG9vayxcbiAgICAgICAgICAgICAgICByZW1vdGVJbmZvLFxuICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0c1xuICAgICAgICAgICAgfSkudGhlbigocmVzKT0+e1xuICAgICAgICAgICAgICAgIGlmIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNkay5pc0Jyb3dzZXJFbnYoKSA/IGxvYWRFbnRyeURvbSh7XG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVySG9va1xuICAgICAgICAgICAgICAgIH0pIDogbG9hZEVudHJ5Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIGxvYWRlckhvb2tcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBnbG9iYWxMb2FkaW5nW3VuaXF1ZUtleV07XG4gICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIGdldFJlbW90ZUluZm8ocmVtb3RlKSB7XG4gICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgcmVtb3RlLCB7XG4gICAgICAgIGVudHJ5OiAnZW50cnknIGluIHJlbW90ZSA/IHJlbW90ZS5lbnRyeSA6ICcnLFxuICAgICAgICB0eXBlOiByZW1vdGUudHlwZSB8fCBERUZBVUxUX1JFTU9URV9UWVBFLFxuICAgICAgICBlbnRyeUdsb2JhbE5hbWU6IHJlbW90ZS5lbnRyeUdsb2JhbE5hbWUgfHwgcmVtb3RlLm5hbWUsXG4gICAgICAgIHNoYXJlU2NvcGU6IHJlbW90ZS5zaGFyZVNjb3BlIHx8IERFRkFVTFRfU0NPUEVcbiAgICB9KTtcbn1cbnZhciBNb2R1bGUgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIE1vZHVsZShyZWYpIHtcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSByZWYucmVtb3RlSW5mbywgaG9zdCA9IHJlZi5ob3N0O1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIE1vZHVsZSk7XG4gICAgICAgIHRoaXMuaW5pdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubGliID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJlbW90ZUluZm8gPSByZW1vdGVJbmZvO1xuICAgICAgICB0aGlzLmhvc3QgPSBob3N0O1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oTW9kdWxlLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRFbnRyeVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEVudHJ5KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yZW1vdGVFbnRyeUV4cG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgZ2V0UmVtb3RlRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogdGhpcy5ob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IHRoaXMucmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHM6IHRoaXMucmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdW5pcXVlS2V5ID0gZ2V0UmVtb3RlRW50cnlVbmlxdWVLZXkodGhpcy5yZW1vdGVJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0cyA9IHlpZWxkIHRoaXMuaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5sb2FkRW50cnlFcnJvci5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRSZW1vdGVFbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMuaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvOiB0aGlzLnJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzOiB0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxMb2FkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXF1ZUtleVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHJlbW90ZUVudHJ5RXhwb3J0cywgYHJlbW90ZUVudHJ5RXhwb3J0cyBpcyB1bmRlZmluZWQgXFxuICR7c2RrLnNhZmVUb1N0cmluZyh0aGlzLnJlbW90ZUluZm8pfWApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cyA9IHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0KGlkLCBleHBvc2UsIG9wdGlvbnMsIHJlbW90ZVNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gb3B0aW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkRmFjdG9yeTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9LCBfcmVmX2xvYWRGYWN0b3J5ID0gX3JlZi5sb2FkRmFjdG9yeSwgbG9hZEZhY3RvcnkgPSBfcmVmX2xvYWRGYWN0b3J5ID09PSB2b2lkIDAgPyB0cnVlIDogX3JlZl9sb2FkRmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHJlbW90ZUVudHJ5LmpzXG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVFbnRyeUV4cG9ydHMgPSB5aWVsZCB0aGlzLmdldEVudHJ5KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbml0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbFNoYXJlU2NvcGVNYXAgPSB0aGlzLmhvc3Quc2hhcmVTY29wZU1hcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVTaGFyZVNjb3BlID0gdGhpcy5yZW1vdGVJbmZvLnNoYXJlU2NvcGUgfHwgJ2RlZmF1bHQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsb2NhbFNoYXJlU2NvcGVNYXBbcmVtb3RlU2hhcmVTY29wZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFNoYXJlU2NvcGVNYXBbcmVtb3RlU2hhcmVTY29wZV0gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlID0gbG9jYWxTaGFyZVNjb3BlTWFwW3JlbW90ZVNoYXJlU2NvcGVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRTY29wZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5yZW1vdGVJbmZvLnZlcnNpb24gfHwgJydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIZWxwIHRvIGZpbmQgaG9zdCBpbnN0YW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsICdzaGFyZVNjb3BlTWFwJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBsb2NhbFNoYXJlU2NvcGVNYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3RlRW50cnlJbml0T3B0aW9ucyB3aWxsIGJlIHRyYXZlcnNlZCBhbmQgYXNzaWduZWQgZHVyaW5nIGNvbnRhaW5lciBpbml0LCAsc28gdGhpcyBhdHRyaWJ1dGUgaXMgbm90IGFsbG93ZWQgdG8gYmUgdHJhdmVyc2VkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRDb250YWluZXJPcHRpb25zID0geWllbGQgdGhpcy5ob3N0Lmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVJbml0Q29udGFpbmVyLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSBzaGFyZVNjb3BlTWFwIHdpbGwgYmUgc2V0IGJ5IE9iamVjdC5kZWZpbmVQcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdFNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IHRoaXMucmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMuaG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIChyZW1vdGVFbnRyeUV4cG9ydHMgPT0gbnVsbCA/IHZvaWQgMCA6IHJlbW90ZUVudHJ5RXhwb3J0cy5pbml0KSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcihlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwMiwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVOYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeVVybDogdGhpcy5yZW1vdGVJbmZvLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUtleTogdGhpcy5yZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHJlbW90ZUVudHJ5RXhwb3J0cy5pbml0KGluaXRDb250YWluZXJPcHRpb25zLnNoYXJlU2NvcGUsIGluaXRDb250YWluZXJPcHRpb25zLmluaXRTY29wZSwgaW5pdENvbnRhaW5lck9wdGlvbnMucmVtb3RlRW50cnlJbml0T3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhvc3QuaG9va3MubGlmZWN5Y2xlLmluaXRDb250YWluZXIuZW1pdChwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGluaXRDb250YWluZXJPcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saWIgPSByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZUZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZUZhY3RvcnkgPSB5aWVsZCB0aGlzLmhvc3QubG9hZGVySG9vay5saWZlY3ljbGUuZ2V0TW9kdWxlRmFjdG9yeS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm86IHRoaXMucmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGV4cG9zZUdldHRlclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZHVsZUZhY3RvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUZhY3RvcnkgPSB5aWVsZCByZW1vdGVFbnRyeUV4cG9ydHMuZ2V0KGV4cG9zZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1vZHVsZUZhY3RvcnksIGAke2dldEZNSWQodGhpcy5yZW1vdGVJbmZvKX0gcmVtb3RlIGRvbid0IGV4cG9ydCAke2V4cG9zZX0uYCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGtlZXAgc3ltYm9sIGZvciBtb2R1bGUgbmFtZSBhbHdheXMgb25lIGZvcm1hdFxuICAgICAgICAgICAgICAgICAgICB2YXIgc3ltYm9sTmFtZSA9IHByb2Nlc3NNb2R1bGVBbGlhcyh0aGlzLnJlbW90ZUluZm8ubmFtZSwgZXhwb3NlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdyYXBNb2R1bGVGYWN0b3J5ID0gdGhpcy53cmFwZXJGYWN0b3J5KG1vZHVsZUZhY3RvcnksIHN5bWJvbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWxvYWRGYWN0b3J5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gd3JhcE1vZHVsZUZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4cG9zZUNvbnRlbnQgPSB5aWVsZCB3cmFwTW9kdWxlRmFjdG9yeSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhwb3NlQ29udGVudDtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwid3JhcGVyRmFjdG9yeVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdyYXBlckZhY3RvcnkobW9kdWxlRmFjdG9yeSwgaWQpIHtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZWZpbmVNb2R1bGVJZChyZXMsIGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgdHlwZW9mIHJlcyA9PT0gJ29iamVjdCcgJiYgT2JqZWN0LmlzRXh0ZW5zaWJsZShyZXMpICYmICFPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHJlcywgU3ltYm9sLmZvcignbWZfbW9kdWxlX2lkJykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVzLCBTeW1ib2wuZm9yKCdtZl9tb2R1bGVfaWQnKSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1vZHVsZUZhY3RvcnkgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0geWllbGQgbW9kdWxlRmFjdG9yeSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgcGFyYW1ldGVyIGlzIHVzZWQgZm9yIGJyaWRnZSBkZWJ1Z2dpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZpbmVNb2R1bGVJZChyZXMsIGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBtb2R1bGVGYWN0b3J5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHBhcmFtZXRlciBpcyB1c2VkIGZvciBicmlkZ2UgZGVidWdnaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZpbmVNb2R1bGVJZChyZXMsIGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIE1vZHVsZTtcbn0oKTtcbnZhciBTeW5jSG9vayA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gU3luY0hvb2sodHlwZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFN5bmNIb29rKTtcbiAgICAgICAgdGhpcy50eXBlID0gJyc7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gbmV3IFNldCgpO1xuICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oU3luY0hvb2ssIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcIm9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb24oZm4pIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLmFkZChmbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwib25jZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uY2UoZm4pIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXNcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5vbihmdW5jdGlvbiB3cmFwcGVyKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZW1vdmUod3JhcHBlcik7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImVtaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlbWl0KC4uLmRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxpc3RlbmVycy5zaXplID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLXNwcmVhZFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5mb3JFYWNoKChmbik9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZuLmFwcGx5KHZvaWQgMCwgX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhkYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVtb3ZlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlKGZuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnMuZGVsZXRlKGZuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlbW92ZUFsbFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUFsbCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5jbGVhcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFN5bmNIb29rO1xufSgpO1xudmFyIEFzeW5jSG9vayA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oU3luY0hvb2spIHtcbiAgICBfaW5oZXJpdHMuXyhBc3luY0hvb2ssIFN5bmNIb29rKTtcbiAgICBmdW5jdGlvbiBBc3luY0hvb2soKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgQXN5bmNIb29rKTtcbiAgICAgICAgcmV0dXJuIF9jYWxsX3N1cGVyLl8odGhpcywgQXN5bmNIb29rLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oQXN5bmNIb29rLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJlbWl0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZW1pdCguLi5kYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB2YXIgbHMgPSBBcnJheS5mcm9tKHRoaXMubGlzdGVuZXJzKTtcbiAgICAgICAgICAgICAgICBpZiAobHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjYWxsID0gKHByZXYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldiA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIEFib3J0IHByb2Nlc3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA8IGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobHNbaSsrXS5hcHBseShudWxsLCBkYXRhKSkudGhlbihjYWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNhbGwoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIEFzeW5jSG9vaztcbn0oU3luY0hvb2spO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXNcbmZ1bmN0aW9uIGNoZWNrUmV0dXJuRGF0YShvcmlnaW5hbERhdGEsIHJldHVybmVkRGF0YSkge1xuICAgIGlmICghaXNPYmplY3QocmV0dXJuZWREYXRhKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChvcmlnaW5hbERhdGEgIT09IHJldHVybmVkRGF0YSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1zeW50YXhcbiAgICAgICAgZm9yKHZhciBrZXkgaW4gb3JpZ2luYWxEYXRhKXtcbiAgICAgICAgICAgIGlmICghKGtleSBpbiByZXR1cm5lZERhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxudmFyIFN5bmNXYXRlcmZhbGxIb29rID0gLyojX19QVVJFX18qLyBmdW5jdGlvbihTeW5jSG9vaykge1xuICAgIF9pbmhlcml0cy5fKFN5bmNXYXRlcmZhbGxIb29rLCBTeW5jSG9vayk7XG4gICAgZnVuY3Rpb24gU3luY1dhdGVyZmFsbEhvb2sodHlwZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFN5bmNXYXRlcmZhbGxIb29rKTtcbiAgICAgICAgdmFyIF90aGlzO1xuICAgICAgICBfdGhpcyA9IF9jYWxsX3N1cGVyLl8odGhpcywgU3luY1dhdGVyZmFsbEhvb2spLCBfdGhpcy5vbmVycm9yID0gZXJyb3I7XG4gICAgICAgIF90aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTeW5jV2F0ZXJmYWxsSG9vaywgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZW1pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGVtaXQoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmICghaXNPYmplY3QoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IoYFRoZSBkYXRhIGZvciB0aGUgXCIke3RoaXMudHlwZX1cIiBob29rIHNob3VsZCBiZSBhbiBvYmplY3QuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGZuIG9mIHRoaXMubGlzdGVuZXJzKXtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wRGF0YSA9IGZuKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrUmV0dXJuRGF0YShkYXRhLCB0ZW1wRGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGVtcERhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25lcnJvcihgQSBwbHVnaW4gcmV0dXJuZWQgYW4gdW5hY2NlcHRhYmxlIHZhbHVlIGZvciB0aGUgXCIke3RoaXMudHlwZX1cIiB0eXBlLmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFN5bmNXYXRlcmZhbGxIb29rO1xufShTeW5jSG9vayk7XG52YXIgQXN5bmNXYXRlcmZhbGxIb29rID0gLyojX19QVVJFX18qLyBmdW5jdGlvbihTeW5jSG9vaykge1xuICAgIF9pbmhlcml0cy5fKEFzeW5jV2F0ZXJmYWxsSG9vaywgU3luY0hvb2spO1xuICAgIGZ1bmN0aW9uIEFzeW5jV2F0ZXJmYWxsSG9vayh0eXBlKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgQXN5bmNXYXRlcmZhbGxIb29rKTtcbiAgICAgICAgdmFyIF90aGlzO1xuICAgICAgICBfdGhpcyA9IF9jYWxsX3N1cGVyLl8odGhpcywgQXN5bmNXYXRlcmZhbGxIb29rKSwgX3RoaXMub25lcnJvciA9IGVycm9yO1xuICAgICAgICBfdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oQXN5bmNXYXRlcmZhbGxIb29rLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJlbWl0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZW1pdChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc09iamVjdChkYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcihgVGhlIHJlc3BvbnNlIGRhdGEgZm9yIHRoZSBcIiR7dGhpcy50eXBlfVwiIGhvb2sgbXVzdCBiZSBhbiBvYmplY3QuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBscyA9IEFycmF5LmZyb20odGhpcy5saXN0ZW5lcnMpO1xuICAgICAgICAgICAgICAgIGlmIChscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NFcnJvciA9IChlKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgd2FybihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25lcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FsbCA9IChwcmV2RGF0YSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGVja1JldHVybkRhdGEoZGF0YSwgcHJldkRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHByZXZEYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpIDwgbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGxzW2krK10oZGF0YSkpLnRoZW4oY2FsbCwgcHJvY2Vzc0Vycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NFcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGBBIHBsdWdpbiByZXR1cm5lZCBhbiBpbmNvcnJlY3QgdmFsdWUgZm9yIHRoZSBcIiR7dGhpcy50eXBlfVwiIHR5cGUuYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjYWxsKGRhdGEpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBBc3luY1dhdGVyZmFsbEhvb2s7XG59KFN5bmNIb29rKTtcbnZhciBQbHVnaW5TeXN0ZW0gPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIFBsdWdpblN5c3RlbShsaWZlY3ljbGUpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBQbHVnaW5TeXN0ZW0pO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyUGx1Z2lucyA9IHt9O1xuICAgICAgICB0aGlzLmxpZmVjeWNsZSA9IGxpZmVjeWNsZTtcbiAgICAgICAgdGhpcy5saWZlY3ljbGVLZXlzID0gT2JqZWN0LmtleXMobGlmZWN5Y2xlKTtcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFBsdWdpblN5c3RlbSwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiYXBwbHlQbHVnaW5cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseVBsdWdpbihwbHVnaW4pIHtcbiAgICAgICAgICAgICAgICBhc3NlcnQoaXNQbGFpbk9iamVjdChwbHVnaW4pLCAnUGx1Z2luIGNvbmZpZ3VyYXRpb24gaXMgaW52YWxpZC4nKTtcbiAgICAgICAgICAgICAgICAvLyBUaGUgcGx1Z2luJ3MgbmFtZSBpcyBtYW5kYXRvcnkgYW5kIG11c3QgYmUgdW5pcXVlXG4gICAgICAgICAgICAgICAgdmFyIHBsdWdpbk5hbWUgPSBwbHVnaW4ubmFtZTtcbiAgICAgICAgICAgICAgICBhc3NlcnQocGx1Z2luTmFtZSwgJ0EgbmFtZSBtdXN0IGJlIHByb3ZpZGVkIGJ5IHRoZSBwbHVnaW4uJyk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXSA9IHBsdWdpbjtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5saWZlY3ljbGUpLmZvckVhY2goKGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbHVnaW5MaWZlID0gcGx1Z2luW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGx1Z2luTGlmZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlmZWN5Y2xlW2tleV0ub24ocGx1Z2luTGlmZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlbW92ZVBsdWdpblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVBsdWdpbihwbHVnaW5OYW1lKSB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0KHBsdWdpbk5hbWUsICdBIG5hbWUgaXMgcmVxdWlyZWQuJyk7XG4gICAgICAgICAgICAgICAgdmFyIHBsdWdpbiA9IHRoaXMucmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdO1xuICAgICAgICAgICAgICAgIGFzc2VydChwbHVnaW4sIGBUaGUgcGx1Z2luIFwiJHtwbHVnaW5OYW1lfVwiIGlzIG5vdCByZWdpc3RlcmVkLmApO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHBsdWdpbikuZm9yRWFjaCgoa2V5KT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSAnbmFtZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlmZWN5Y2xlW2tleV0ucmVtb3ZlKHBsdWdpbltrZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXNoYWRvd1xuICAgICAgICAgICAga2V5OiBcImluaGVyaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbmhlcml0KHJlZikge1xuICAgICAgICAgICAgICAgIHZhciBsaWZlY3ljbGUgPSByZWYubGlmZWN5Y2xlLCByZWdpc3RlclBsdWdpbnMgPSByZWYucmVnaXN0ZXJQbHVnaW5zO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGxpZmVjeWNsZSkuZm9yRWFjaCgoaG9va05hbWUpPT57XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydCghdGhpcy5saWZlY3ljbGVbaG9va05hbWVdLCBgVGhlIGhvb2sgXCIke2hvb2tOYW1lfVwiIGhhcyBhIGNvbmZsaWN0IGFuZCBjYW5ub3QgYmUgaW5oZXJpdGVkLmApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpZmVjeWNsZVtob29rTmFtZV0gPSBsaWZlY3ljbGVbaG9va05hbWVdO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlZ2lzdGVyUGx1Z2lucykuZm9yRWFjaCgocGx1Z2luTmFtZSk9PntcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCF0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXSwgYFRoZSBwbHVnaW4gXCIke3BsdWdpbk5hbWV9XCIgaGFzIGEgY29uZmxpY3QgYW5kIGNhbm5vdCBiZSBpbmhlcml0ZWQuYCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlQbHVnaW4ocmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBQbHVnaW5TeXN0ZW07XG59KCk7XG5mdW5jdGlvbiBkZWZhdWx0UHJlbG9hZEFyZ3MocHJlbG9hZENvbmZpZykge1xuICAgIHJldHVybiBwb2x5ZmlsbHMuX2V4dGVuZHMoe1xuICAgICAgICByZXNvdXJjZUNhdGVnb3J5OiAnc3luYycsXG4gICAgICAgIHNoYXJlOiB0cnVlLFxuICAgICAgICBkZXBzUmVtb3RlOiB0cnVlLFxuICAgICAgICBwcmVmZXRjaEludGVyZmFjZTogZmFsc2VcbiAgICB9LCBwcmVsb2FkQ29uZmlnKTtcbn1cbmZ1bmN0aW9uIGZvcm1hdFByZWxvYWRBcmdzKHJlbW90ZXMsIHByZWxvYWRBcmdzKSB7XG4gICAgcmV0dXJuIHByZWxvYWRBcmdzLm1hcCgoYXJncyk9PntcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBtYXRjaFJlbW90ZShyZW1vdGVzLCBhcmdzLm5hbWVPckFsaWFzKTtcbiAgICAgICAgYXNzZXJ0KHJlbW90ZUluZm8sIGBVbmFibGUgdG8gcHJlbG9hZCAke2FyZ3MubmFtZU9yQWxpYXN9IGFzIGl0IGlzIG5vdCBpbmNsdWRlZCBpbiAkeyFyZW1vdGVJbmZvICYmIHNkay5zYWZlVG9TdHJpbmcoe1xuICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgIHJlbW90ZXNcbiAgICAgICAgfSl9YCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZW1vdGU6IHJlbW90ZUluZm8sXG4gICAgICAgICAgICBwcmVsb2FkQ29uZmlnOiBkZWZhdWx0UHJlbG9hZEFyZ3MoYXJncylcbiAgICAgICAgfTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZVByZWxvYWRFeHBvc2VzKGV4cG9zZXMpIHtcbiAgICBpZiAoIWV4cG9zZXMpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICByZXR1cm4gZXhwb3Nlcy5tYXAoKGV4cG9zZSk9PntcbiAgICAgICAgaWYgKGV4cG9zZSA9PT0gJy4nKSB7XG4gICAgICAgICAgICByZXR1cm4gZXhwb3NlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChleHBvc2Uuc3RhcnRzV2l0aCgnLi8nKSkge1xuICAgICAgICAgICAgcmV0dXJuIGV4cG9zZS5yZXBsYWNlKCcuLycsICcnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXhwb3NlO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gcHJlbG9hZEFzc2V0cyhyZW1vdGVJbmZvLCBob3N0LCBhc3NldHMsIHJlZikge1xuICAgIHZhciB1c2VMaW5rUHJlbG9hZCA9IHJlZiA9PT0gdm9pZCAwID8gdHJ1ZSA6IHJlZjtcbiAgICB2YXIgY3NzQXNzZXRzID0gYXNzZXRzLmNzc0Fzc2V0cywganNBc3NldHNXaXRob3V0RW50cnkgPSBhc3NldHMuanNBc3NldHNXaXRob3V0RW50cnksIGVudHJ5QXNzZXRzID0gYXNzZXRzLmVudHJ5QXNzZXRzO1xuICAgIGlmIChob3N0Lm9wdGlvbnMuaW5Ccm93c2VyKSB7XG4gICAgICAgIGVudHJ5QXNzZXRzLmZvckVhY2goKGFzc2V0KT0+e1xuICAgICAgICAgICAgdmFyIG1vZHVsZUluZm8gPSBhc3NldC5tb2R1bGVJbmZvO1xuICAgICAgICAgICAgdmFyIG1vZHVsZSA9IGhvc3QubW9kdWxlQ2FjaGUuZ2V0KHJlbW90ZUluZm8ubmFtZSk7XG4gICAgICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgZ2V0UmVtb3RlRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0czogbW9kdWxlLnJlbW90ZUVudHJ5RXhwb3J0c1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBnZXRSZW1vdGVFbnRyeSh7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbzogbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh1c2VMaW5rUHJlbG9hZCkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRBdHRycyA9IHtcbiAgICAgICAgICAgICAgICByZWw6ICdwcmVsb2FkJyxcbiAgICAgICAgICAgICAgICBhczogJ3N0eWxlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNzc0Fzc2V0cy5mb3JFYWNoKChjc3NVcmwpPT57XG4gICAgICAgICAgICAgICAgdmFyIF9zZGtfY3JlYXRlTGluayA9IHNkay5jcmVhdGVMaW5rKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBjc3NVcmwsXG4gICAgICAgICAgICAgICAgICAgIGNiOiAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAvLyBub29wXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzOiBkZWZhdWx0QXR0cnMsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxpbmtIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZUxpbmsuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MTGlua0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksIGNzc0VsID0gX3Nka19jcmVhdGVMaW5rLmxpbmssIG5lZWRBdHRhY2ggPSBfc2RrX2NyZWF0ZUxpbmsubmVlZEF0dGFjaDtcbiAgICAgICAgICAgICAgICBuZWVkQXR0YWNoICYmIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoY3NzRWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdEF0dHJzMSA9IHtcbiAgICAgICAgICAgICAgICByZWw6ICdzdHlsZXNoZWV0JyxcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dC9jc3MnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY3NzQXNzZXRzLmZvckVhY2goKGNzc1VybCk9PntcbiAgICAgICAgICAgICAgICB2YXIgX3Nka19jcmVhdGVMaW5rID0gc2RrLmNyZWF0ZUxpbmsoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGNzc1VybCxcbiAgICAgICAgICAgICAgICAgICAgY2I6ICgpPT57XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vb3BcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYXR0cnM6IGRlZmF1bHRBdHRyczEsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxpbmtIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZUxpbmsuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MTGlua0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBuZWVkRGVsZXRlTGluazogZmFsc2VcbiAgICAgICAgICAgICAgICB9KSwgY3NzRWwgPSBfc2RrX2NyZWF0ZUxpbmsubGluaywgbmVlZEF0dGFjaCA9IF9zZGtfY3JlYXRlTGluay5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjc3NFbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXNlTGlua1ByZWxvYWQpIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0QXR0cnMyID0ge1xuICAgICAgICAgICAgICAgIHJlbDogJ3ByZWxvYWQnLFxuICAgICAgICAgICAgICAgIGFzOiAnc2NyaXB0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5LmZvckVhY2goKGpzVXJsKT0+e1xuICAgICAgICAgICAgICAgIHZhciBfc2RrX2NyZWF0ZUxpbmsgPSBzZGsuY3JlYXRlTGluayh7XG4gICAgICAgICAgICAgICAgICAgIHVybDoganNVcmwsXG4gICAgICAgICAgICAgICAgICAgIGNiOiAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAvLyBub29wXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzOiBkZWZhdWx0QXR0cnMyLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVMaW5rSG9vazogKHVybCwgYXR0cnMpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVMaW5rLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyc1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzIGluc3RhbmNlb2YgSFRNTExpbmtFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLCBsaW5rRWwgPSBfc2RrX2NyZWF0ZUxpbmsubGluaywgbmVlZEF0dGFjaCA9IF9zZGtfY3JlYXRlTGluay5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChsaW5rRWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdEF0dHJzMyA9IHtcbiAgICAgICAgICAgICAgICBmZXRjaHByaW9yaXR5OiAnaGlnaCcsXG4gICAgICAgICAgICAgICAgdHlwZTogKHJlbW90ZUluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IHJlbW90ZUluZm8udHlwZSkgPT09ICdtb2R1bGUnID8gJ21vZHVsZScgOiAndGV4dC9qYXZhc2NyaXB0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5LmZvckVhY2goKGpzVXJsKT0+e1xuICAgICAgICAgICAgICAgIHZhciBfc2RrX2NyZWF0ZVNjcmlwdCA9IHNkay5jcmVhdGVTY3JpcHQoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGpzVXJsLFxuICAgICAgICAgICAgICAgICAgICBjYjogKCk9PntcbiAgICAgICAgICAgICAgICAgICAgLy8gbm9vcFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhdHRyczogZGVmYXVsdEF0dHJzMyxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2NyaXB0SG9vazogKHVybCwgYXR0cnMpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVTY3JpcHQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MU2NyaXB0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVTY3JpcHQ6IHRydWVcbiAgICAgICAgICAgICAgICB9KSwgc2NyaXB0RWwgPSBfc2RrX2NyZWF0ZVNjcmlwdC5zY3JpcHQsIG5lZWRBdHRhY2ggPSBfc2RrX2NyZWF0ZVNjcmlwdC5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHRFbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGFzc2lnblJlbW90ZUluZm8ocmVtb3RlSW5mbywgcmVtb3RlU25hcHNob3QpIHtcbiAgICB2YXIgcmVtb3RlRW50cnlJbmZvID0gZ2V0UmVtb3RlRW50cnlJbmZvRnJvbVNuYXBzaG90KHJlbW90ZVNuYXBzaG90KTtcbiAgICBpZiAoIXJlbW90ZUVudHJ5SW5mby51cmwpIHtcbiAgICAgICAgZXJyb3IoYFRoZSBhdHRyaWJ1dGUgcmVtb3RlRW50cnkgb2YgJHtyZW1vdGVJbmZvLm5hbWV9IG11c3Qgbm90IGJlIHVuZGVmaW5lZC5gKTtcbiAgICB9XG4gICAgdmFyIGVudHJ5VXJsID0gc2RrLmdldFJlc291cmNlVXJsKHJlbW90ZVNuYXBzaG90LCByZW1vdGVFbnRyeUluZm8udXJsKTtcbiAgICBpZiAoIXNkay5pc0Jyb3dzZXJFbnYoKSAmJiAhZW50cnlVcmwuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XG4gICAgICAgIGVudHJ5VXJsID0gYGh0dHBzOiR7ZW50cnlVcmx9YDtcbiAgICB9XG4gICAgcmVtb3RlSW5mby50eXBlID0gcmVtb3RlRW50cnlJbmZvLnR5cGU7XG4gICAgcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUgPSByZW1vdGVFbnRyeUluZm8uZ2xvYmFsTmFtZTtcbiAgICByZW1vdGVJbmZvLmVudHJ5ID0gZW50cnlVcmw7XG4gICAgcmVtb3RlSW5mby52ZXJzaW9uID0gcmVtb3RlU25hcHNob3QudmVyc2lvbjtcbiAgICByZW1vdGVJbmZvLmJ1aWxkVmVyc2lvbiA9IHJlbW90ZVNuYXBzaG90LmJ1aWxkVmVyc2lvbjtcbn1cbmZ1bmN0aW9uIHNuYXBzaG90UGx1Z2luKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6ICdzbmFwc2hvdC1wbHVnaW4nLFxuICAgICAgICBhZnRlclJlc29sdmUgKGFyZ3MpIHtcbiAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSBhcmdzLnJlbW90ZSwgcGtnTmFtZU9yQWxpYXMgPSBhcmdzLnBrZ05hbWVPckFsaWFzLCBleHBvc2UgPSBhcmdzLmV4cG9zZSwgb3JpZ2luID0gYXJncy5vcmlnaW4sIHJlbW90ZUluZm8gPSBhcmdzLnJlbW90ZUluZm87XG4gICAgICAgICAgICAgICAgaWYgKCFpc1JlbW90ZUluZm9XaXRoRW50cnkocmVtb3RlKSB8fCAhaXNQdXJlUmVtb3RlRW50cnkocmVtb3RlKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IHlpZWxkIG9yaWdpbi5zbmFwc2hvdEhhbmRsZXIubG9hZFJlbW90ZVNuYXBzaG90SW5mbyhyZW1vdGUpLCByZW1vdGVTbmFwc2hvdCA9IF9yZWYucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90ID0gX3JlZi5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgYXNzaWduUmVtb3RlSW5mbyhyZW1vdGVJbmZvLCByZW1vdGVTbmFwc2hvdCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHByZWxvYWRpbmcgYXNzZXRzXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmVsb2FkT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRDb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lT3JBbGlhczogcGtnTmFtZU9yQWxpYXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlQ2F0ZWdvcnk6ICdzeW5jJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwc1JlbW90ZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2V0cyA9IHlpZWxkIG9yaWdpbi5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5nZW5lcmF0ZVByZWxvYWRBc3NldHMuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVsb2FkT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXNzZXRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVsb2FkQXNzZXRzKHJlbW90ZUluZm8sIG9yaWdpbiwgYXNzZXRzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgYXJncywge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhcmdzO1xuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgfVxuICAgIH07XG59XG4vLyBuYW1lXG4vLyBuYW1lOnZlcnNpb25cbmZ1bmN0aW9uIHNwbGl0SWQoaWQpIHtcbiAgICB2YXIgc3BsaXRJbmZvID0gaWQuc3BsaXQoJzonKTtcbiAgICBpZiAoc3BsaXRJbmZvLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogc3BsaXRJbmZvWzBdLFxuICAgICAgICAgICAgdmVyc2lvbjogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmIChzcGxpdEluZm8ubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBzcGxpdEluZm9bMF0sXG4gICAgICAgICAgICB2ZXJzaW9uOiBzcGxpdEluZm9bMV1cbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogc3BsaXRJbmZvWzFdLFxuICAgICAgICAgICAgdmVyc2lvbjogc3BsaXRJbmZvWzJdXG4gICAgICAgIH07XG4gICAgfVxufVxuLy8gVHJhdmVyc2UgYWxsIG5vZGVzIGluIG1vZHVsZUluZm8gYW5kIHRyYXZlcnNlIHRoZSBlbnRpcmUgc25hcHNob3RcbmZ1bmN0aW9uIHRyYXZlcnNlTW9kdWxlSW5mbyhnbG9iYWxTbmFwc2hvdCwgcmVtb3RlSW5mbywgdHJhdmVyc2UsIGlzUm9vdCwgcmVmLCByZW1vdGVTbmFwc2hvdCkge1xuICAgIHZhciBtZW1vID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICB2YXIgaWQgPSBnZXRGTUlkKHJlbW90ZUluZm8pO1xuICAgIHZhciBfZ2V0SW5mb1dpdGhvdXRUeXBlID0gZ2V0SW5mb1dpdGhvdXRUeXBlKGdsb2JhbFNuYXBzaG90LCBpZCksIHNuYXBzaG90VmFsdWUgPSBfZ2V0SW5mb1dpdGhvdXRUeXBlLnZhbHVlO1xuICAgIHZhciBlZmZlY3RpdmVSZW1vdGVTbmFwc2hvdCA9IHJlbW90ZVNuYXBzaG90IHx8IHNuYXBzaG90VmFsdWU7XG4gICAgaWYgKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90ICYmICFzZGsuaXNNYW5pZmVzdFByb3ZpZGVyKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90KSkge1xuICAgICAgICB0cmF2ZXJzZShlZmZlY3RpdmVSZW1vdGVTbmFwc2hvdCwgcmVtb3RlSW5mbywgaXNSb290KTtcbiAgICAgICAgaWYgKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LnJlbW90ZXNJbmZvKSB7XG4gICAgICAgICAgICB2YXIgcmVtb3RlS2V5cyA9IE9iamVjdC5rZXlzKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LnJlbW90ZXNJbmZvKTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBvZiByZW1vdGVLZXlzKXtcbiAgICAgICAgICAgICAgICBpZiAobWVtb1trZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtZW1vW2tleV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBzdWJSZW1vdGVJbmZvID0gc3BsaXRJZChrZXkpO1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVWYWx1ZSA9IGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LnJlbW90ZXNJbmZvW2tleV07XG4gICAgICAgICAgICAgICAgdHJhdmVyc2VNb2R1bGVJbmZvKGdsb2JhbFNuYXBzaG90LCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHN1YlJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogcmVtb3RlVmFsdWUubWF0Y2hlZFZlcnNpb25cbiAgICAgICAgICAgICAgICB9LCB0cmF2ZXJzZSwgZmFsc2UsIG1lbW8sIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvblxuZnVuY3Rpb24gZ2VuZXJhdGVQcmVsb2FkQXNzZXRzKG9yaWdpbiwgcHJlbG9hZE9wdGlvbnMsIHJlbW90ZSwgZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90KSB7XG4gICAgdmFyIGNzc0Fzc2V0cyA9IFtdO1xuICAgIHZhciBqc0Fzc2V0cyA9IFtdO1xuICAgIHZhciBlbnRyeUFzc2V0cyA9IFtdO1xuICAgIHZhciBsb2FkZWRTaGFyZWRKc0Fzc2V0cyA9IG5ldyBTZXQoKTtcbiAgICB2YXIgbG9hZGVkU2hhcmVkQ3NzQXNzZXRzID0gbmV3IFNldCgpO1xuICAgIHZhciBvcHRpb25zID0gb3JpZ2luLm9wdGlvbnM7XG4gICAgdmFyIHJvb3RQcmVsb2FkQ29uZmlnID0gcHJlbG9hZE9wdGlvbnMucHJlbG9hZENvbmZpZztcbiAgICB2YXIgZGVwc1JlbW90ZSA9IHJvb3RQcmVsb2FkQ29uZmlnLmRlcHNSZW1vdGU7XG4gICAgdmFyIG1lbW8gPSB7fTtcbiAgICB0cmF2ZXJzZU1vZHVsZUluZm8oZ2xvYmFsU25hcHNob3QsIHJlbW90ZSwgKG1vZHVsZUluZm9TbmFwc2hvdCwgcmVtb3RlSW5mbywgaXNSb290KT0+e1xuICAgICAgICB2YXIgcHJlbG9hZENvbmZpZztcbiAgICAgICAgaWYgKGlzUm9vdCkge1xuICAgICAgICAgICAgcHJlbG9hZENvbmZpZyA9IHJvb3RQcmVsb2FkQ29uZmlnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZGVwc1JlbW90ZSkpIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgYXJyYXktY2FsbGJhY2stcmV0dXJuXG4gICAgICAgICAgICAgICAgdmFyIGZpbmRQcmVsb2FkQ29uZmlnID0gZGVwc1JlbW90ZS5maW5kKChyZW1vdGVDb25maWcpPT57XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdGVDb25maWcubmFtZU9yQWxpYXMgPT09IHJlbW90ZUluZm8ubmFtZSB8fCByZW1vdGVDb25maWcubmFtZU9yQWxpYXMgPT09IHJlbW90ZUluZm8uYWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIWZpbmRQcmVsb2FkQ29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJlbG9hZENvbmZpZyA9IGRlZmF1bHRQcmVsb2FkQXJncyhmaW5kUHJlbG9hZENvbmZpZyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRlcHNSZW1vdGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBwcmVsb2FkQ29uZmlnID0gcm9vdFByZWxvYWRDb25maWc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVtb3RlRW50cnlVcmwgPSBzZGsuZ2V0UmVzb3VyY2VVcmwobW9kdWxlSW5mb1NuYXBzaG90LCBnZXRSZW1vdGVFbnRyeUluZm9Gcm9tU25hcHNob3QobW9kdWxlSW5mb1NuYXBzaG90KS51cmwpO1xuICAgICAgICBpZiAocmVtb3RlRW50cnlVcmwpIHtcbiAgICAgICAgICAgIGVudHJ5QXNzZXRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICBtb2R1bGVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZW50cnk6IHJlbW90ZUVudHJ5VXJsLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAncmVtb3RlRW50cnlUeXBlJyBpbiBtb2R1bGVJbmZvU25hcHNob3QgPyBtb2R1bGVJbmZvU25hcHNob3QucmVtb3RlRW50cnlUeXBlIDogJ2dsb2JhbCcsXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5R2xvYmFsTmFtZTogJ2dsb2JhbE5hbWUnIGluIG1vZHVsZUluZm9TbmFwc2hvdCA/IG1vZHVsZUluZm9TbmFwc2hvdC5nbG9iYWxOYW1lIDogcmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZVNjb3BlOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogJ3ZlcnNpb24nIGluIG1vZHVsZUluZm9TbmFwc2hvdCA/IG1vZHVsZUluZm9TbmFwc2hvdC52ZXJzaW9uIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1cmw6IHJlbW90ZUVudHJ5VXJsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbW9kdWxlQXNzZXRzSW5mbyA9ICdtb2R1bGVzJyBpbiBtb2R1bGVJbmZvU25hcHNob3QgPyBtb2R1bGVJbmZvU25hcHNob3QubW9kdWxlcyA6IFtdO1xuICAgICAgICB2YXIgbm9ybWFsaXplZFByZWxvYWRFeHBvc2VzID0gbm9ybWFsaXplUHJlbG9hZEV4cG9zZXMocHJlbG9hZENvbmZpZy5leHBvc2VzKTtcbiAgICAgICAgaWYgKG5vcm1hbGl6ZWRQcmVsb2FkRXhwb3Nlcy5sZW5ndGggJiYgJ21vZHVsZXMnIGluIG1vZHVsZUluZm9TbmFwc2hvdCkge1xuICAgICAgICAgICAgdmFyIF9tb2R1bGVJbmZvU25hcHNob3RfbW9kdWxlcztcbiAgICAgICAgICAgIG1vZHVsZUFzc2V0c0luZm8gPSBtb2R1bGVJbmZvU25hcHNob3QgPT0gbnVsbCA/IHZvaWQgMCA6IChfbW9kdWxlSW5mb1NuYXBzaG90X21vZHVsZXMgPSBtb2R1bGVJbmZvU25hcHNob3QubW9kdWxlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9tb2R1bGVJbmZvU25hcHNob3RfbW9kdWxlcy5yZWR1Y2UoKGFzc2V0cywgbW9kdWxlQXNzZXRJbmZvKT0+e1xuICAgICAgICAgICAgICAgIGlmICgobm9ybWFsaXplZFByZWxvYWRFeHBvc2VzID09IG51bGwgPyB2b2lkIDAgOiBub3JtYWxpemVkUHJlbG9hZEV4cG9zZXMuaW5kZXhPZihtb2R1bGVBc3NldEluZm8ubW9kdWxlTmFtZSkpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBhc3NldHMucHVzaChtb2R1bGVBc3NldEluZm8pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXRzO1xuICAgICAgICAgICAgfSwgW10pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZUFzc2V0cyhhc3NldHMpIHtcbiAgICAgICAgICAgIHZhciBhc3NldHNSZXMgPSBhc3NldHMubWFwKChhc3NldCk9PnNkay5nZXRSZXNvdXJjZVVybChtb2R1bGVJbmZvU25hcHNob3QsIGFzc2V0KSk7XG4gICAgICAgICAgICBpZiAocHJlbG9hZENvbmZpZy5maWx0ZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXRzUmVzLmZpbHRlcihwcmVsb2FkQ29uZmlnLmZpbHRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYXNzZXRzUmVzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb2R1bGVBc3NldHNJbmZvKSB7XG4gICAgICAgICAgICB2YXIgYXNzZXRzTGVuZ3RoID0gbW9kdWxlQXNzZXRzSW5mby5sZW5ndGg7XG4gICAgICAgICAgICBmb3IodmFyIGluZGV4ID0gMDsgaW5kZXggPCBhc3NldHNMZW5ndGg7IGluZGV4Kyspe1xuICAgICAgICAgICAgICAgIHZhciBhc3NldHNJbmZvID0gbW9kdWxlQXNzZXRzSW5mb1tpbmRleF07XG4gICAgICAgICAgICAgICAgdmFyIGV4cG9zZUZ1bGxQYXRoID0gYCR7cmVtb3RlSW5mby5uYW1lfS8ke2Fzc2V0c0luZm8ubW9kdWxlTmFtZX1gO1xuICAgICAgICAgICAgICAgIG9yaWdpbi5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5oYW5kbGVQcmVsb2FkTW9kdWxlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBpZDogYXNzZXRzSW5mby5tb2R1bGVOYW1lID09PSAnLicgPyByZW1vdGVJbmZvLm5hbWUgOiBleHBvc2VGdWxsUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdDogbW9kdWxlSW5mb1NuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICBwcmVsb2FkQ29uZmlnLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGU6IHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwcmVsb2FkZWQgPSBnZXRQcmVsb2FkZWQoZXhwb3NlRnVsbFBhdGgpO1xuICAgICAgICAgICAgICAgIGlmIChwcmVsb2FkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwcmVsb2FkQ29uZmlnLnJlc291cmNlQ2F0ZWdvcnkgPT09ICdhbGwnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY3NzQXNzZXRzLCBfY3NzQXNzZXRzMSwgX2pzQXNzZXRzLCBfanNBc3NldHMxO1xuICAgICAgICAgICAgICAgICAgICAoX2Nzc0Fzc2V0cyA9IGNzc0Fzc2V0cykucHVzaC5hcHBseShfY3NzQXNzZXRzLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5jc3MuYXN5bmMpKSk7XG4gICAgICAgICAgICAgICAgICAgIChfY3NzQXNzZXRzMSA9IGNzc0Fzc2V0cykucHVzaC5hcHBseShfY3NzQXNzZXRzMSwgX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhoYW5kbGVBc3NldHMoYXNzZXRzSW5mby5hc3NldHMuY3NzLnN5bmMpKSk7XG4gICAgICAgICAgICAgICAgICAgIChfanNBc3NldHMgPSBqc0Fzc2V0cykucHVzaC5hcHBseShfanNBc3NldHMsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmpzLmFzeW5jKSkpO1xuICAgICAgICAgICAgICAgICAgICAoX2pzQXNzZXRzMSA9IGpzQXNzZXRzKS5wdXNoLmFwcGx5KF9qc0Fzc2V0czEsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmpzLnN5bmMpKSk7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlbG9hZENvbmZpZy5yZXNvdXJjZUNhdGVnb3J5ID0gJ3N5bmMnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY3NzQXNzZXRzMiwgX2pzQXNzZXRzMjtcbiAgICAgICAgICAgICAgICAgICAgKF9jc3NBc3NldHMyID0gY3NzQXNzZXRzKS5wdXNoLmFwcGx5KF9jc3NBc3NldHMyLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5jc3Muc3luYykpKTtcbiAgICAgICAgICAgICAgICAgICAgKF9qc0Fzc2V0czIgPSBqc0Fzc2V0cykucHVzaC5hcHBseShfanNBc3NldHMyLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5qcy5zeW5jKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZXRQcmVsb2FkZWQoZXhwb3NlRnVsbFBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgdHJ1ZSwgbWVtbywgcmVtb3RlU25hcHNob3QpO1xuICAgIGlmIChyZW1vdGVTbmFwc2hvdC5zaGFyZWQpIHtcbiAgICAgICAgdmFyIGNvbGxlY3RTaGFyZWRBc3NldHMgPSAoc2hhcmVJbmZvLCBzbmFwc2hvdFNoYXJlZCk9PntcbiAgICAgICAgICAgIHZhciByZWdpc3RlcmVkU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKG9yaWdpbi5zaGFyZVNjb3BlTWFwLCBzbmFwc2hvdFNoYXJlZC5zaGFyZWROYW1lLCBzaGFyZUluZm8sIG9yaWdpbi5zaGFyZWRIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5yZXNvbHZlU2hhcmUpO1xuICAgICAgICAgICAgLy8gSWYgdGhlIGdsb2JhbCBzaGFyZSBkb2VzIG5vdCBleGlzdCwgb3IgdGhlIGxpYiBmdW5jdGlvbiBkb2VzIG5vdCBleGlzdCwgaXQgbWVhbnMgdGhhdCB0aGUgc2hhcmVkIGhhcyBub3QgYmVlbiBsb2FkZWQgeWV0IGFuZCBjYW4gYmUgcHJlbG9hZGVkLlxuICAgICAgICAgICAgaWYgKHJlZ2lzdGVyZWRTaGFyZWQgJiYgdHlwZW9mIHJlZ2lzdGVyZWRTaGFyZWQubGliID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgc25hcHNob3RTaGFyZWQuYXNzZXRzLmpzLnN5bmMuZm9yRWFjaCgoYXNzZXQpPT57XG4gICAgICAgICAgICAgICAgICAgIGxvYWRlZFNoYXJlZEpzQXNzZXRzLmFkZChhc3NldCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgc25hcHNob3RTaGFyZWQuYXNzZXRzLmNzcy5zeW5jLmZvckVhY2goKGFzc2V0KT0+e1xuICAgICAgICAgICAgICAgICAgICBsb2FkZWRTaGFyZWRDc3NBc3NldHMuYWRkKGFzc2V0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmVtb3RlU25hcHNob3Quc2hhcmVkLmZvckVhY2goKHNoYXJlZCk9PntcbiAgICAgICAgICAgIHZhciBfb3B0aW9uc19zaGFyZWQ7XG4gICAgICAgICAgICB2YXIgc2hhcmVJbmZvcyA9IChfb3B0aW9uc19zaGFyZWQgPSBvcHRpb25zLnNoYXJlZCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9vcHRpb25zX3NoYXJlZFtzaGFyZWQuc2hhcmVkTmFtZV07XG4gICAgICAgICAgICBpZiAoIXNoYXJlSW5mb3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiBubyB2ZXJzaW9uLCBwcmVsb2FkIGFsbCBzaGFyZWRcbiAgICAgICAgICAgIHZhciBzaGFyZWRPcHRpb25zID0gc2hhcmVkLnZlcnNpb24gPyBzaGFyZUluZm9zLmZpbmQoKHMpPT5zLnZlcnNpb24gPT09IHNoYXJlZC52ZXJzaW9uKSA6IHNoYXJlSW5mb3M7XG4gICAgICAgICAgICBpZiAoIXNoYXJlZE9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYXJyYXlTaGFyZUluZm8gPSBhcnJheU9wdGlvbnMoc2hhcmVkT3B0aW9ucyk7XG4gICAgICAgICAgICBhcnJheVNoYXJlSW5mby5mb3JFYWNoKChzKT0+e1xuICAgICAgICAgICAgICAgIGNvbGxlY3RTaGFyZWRBc3NldHMocywgc2hhcmVkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgdmFyIG5lZWRQcmVsb2FkSnNBc3NldHMgPSBqc0Fzc2V0cy5maWx0ZXIoKGFzc2V0KT0+IWxvYWRlZFNoYXJlZEpzQXNzZXRzLmhhcyhhc3NldCkpO1xuICAgIHZhciBuZWVkUHJlbG9hZENzc0Fzc2V0cyA9IGNzc0Fzc2V0cy5maWx0ZXIoKGFzc2V0KT0+IWxvYWRlZFNoYXJlZENzc0Fzc2V0cy5oYXMoYXNzZXQpKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjc3NBc3NldHM6IG5lZWRQcmVsb2FkQ3NzQXNzZXRzLFxuICAgICAgICBqc0Fzc2V0c1dpdGhvdXRFbnRyeTogbmVlZFByZWxvYWRKc0Fzc2V0cyxcbiAgICAgICAgZW50cnlBc3NldHNcbiAgICB9O1xufVxudmFyIGdlbmVyYXRlUHJlbG9hZEFzc2V0c1BsdWdpbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6ICdnZW5lcmF0ZS1wcmVsb2FkLWFzc2V0cy1wbHVnaW4nLFxuICAgICAgICBnZW5lcmF0ZVByZWxvYWRBc3NldHMgKGFyZ3MpIHtcbiAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIHZhciBvcmlnaW4gPSBhcmdzLm9yaWdpbiwgcHJlbG9hZE9wdGlvbnMgPSBhcmdzLnByZWxvYWRPcHRpb25zLCByZW1vdGVJbmZvID0gYXJncy5yZW1vdGVJbmZvLCByZW1vdGUgPSBhcmdzLnJlbW90ZSwgZ2xvYmFsU25hcHNob3QgPSBhcmdzLmdsb2JhbFNuYXBzaG90LCByZW1vdGVTbmFwc2hvdCA9IGFyZ3MucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgaWYgKGlzUmVtb3RlSW5mb1dpdGhFbnRyeShyZW1vdGUpICYmIGlzUHVyZVJlbW90ZUVudHJ5KHJlbW90ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzc0Fzc2V0czogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBqc0Fzc2V0c1dpdGhvdXRFbnRyeTogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRyeUFzc2V0czogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogcmVtb3RlLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGVJbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeTogcmVtb3RlLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogcmVtb3RlSW5mby50eXBlIHx8ICdnbG9iYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlHbG9iYWxOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGU6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFzc2lnblJlbW90ZUluZm8ocmVtb3RlSW5mbywgcmVtb3RlU25hcHNob3QpO1xuICAgICAgICAgICAgICAgIHZhciBhc3NldHMgPSBnZW5lcmF0ZVByZWxvYWRBc3NldHMob3JpZ2luLCBwcmVsb2FkT3B0aW9ucywgcmVtb3RlSW5mbywgZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXRzO1xuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuZnVuY3Rpb24gZ2V0R2xvYmFsUmVtb3RlSW5mbyhtb2R1bGVJbmZvLCBvcmlnaW4pIHtcbiAgICB2YXIgaG9zdEdsb2JhbFNuYXBzaG90ID0gZ2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvKHtcbiAgICAgICAgbmFtZTogb3JpZ2luLm9wdGlvbnMubmFtZSxcbiAgICAgICAgdmVyc2lvbjogb3JpZ2luLm9wdGlvbnMudmVyc2lvblxuICAgIH0pO1xuICAgIC8vIGdldCByZW1vdGUgZGV0YWlsIGluZm8gZnJvbSBnbG9iYWxcbiAgICB2YXIgZ2xvYmFsUmVtb3RlSW5mbyA9IGhvc3RHbG9iYWxTbmFwc2hvdCAmJiAncmVtb3Rlc0luZm8nIGluIGhvc3RHbG9iYWxTbmFwc2hvdCAmJiBob3N0R2xvYmFsU25hcHNob3QucmVtb3Rlc0luZm8gJiYgZ2V0SW5mb1dpdGhvdXRUeXBlKGhvc3RHbG9iYWxTbmFwc2hvdC5yZW1vdGVzSW5mbywgbW9kdWxlSW5mby5uYW1lKS52YWx1ZTtcbiAgICBpZiAoZ2xvYmFsUmVtb3RlSW5mbyAmJiBnbG9iYWxSZW1vdGVJbmZvLm1hdGNoZWRWZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBob3N0R2xvYmFsU25hcHNob3QsXG4gICAgICAgICAgICBnbG9iYWxTbmFwc2hvdDogZ2V0R2xvYmFsU25hcHNob3QoKSxcbiAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICAgICAgICAgIG5hbWU6IG1vZHVsZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBnbG9iYWxSZW1vdGVJbmZvLm1hdGNoZWRWZXJzaW9uXG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBob3N0R2xvYmFsU25hcHNob3Q6IHVuZGVmaW5lZCxcbiAgICAgICAgZ2xvYmFsU25hcHNob3Q6IGdldEdsb2JhbFNuYXBzaG90KCksXG4gICAgICAgIHJlbW90ZVNuYXBzaG90OiBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICAgICAgbmFtZTogbW9kdWxlSW5mby5uYW1lLFxuICAgICAgICAgICAgdmVyc2lvbjogJ3ZlcnNpb24nIGluIG1vZHVsZUluZm8gPyBtb2R1bGVJbmZvLnZlcnNpb24gOiB1bmRlZmluZWRcbiAgICAgICAgfSlcbiAgICB9O1xufVxudmFyIFNuYXBzaG90SGFuZGxlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gU25hcHNob3RIYW5kbGVyKEhvc3RJbnN0YW5jZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFNuYXBzaG90SGFuZGxlcik7XG4gICAgICAgIHRoaXMubG9hZGluZ0hvc3RTbmFwc2hvdCA9IG51bGw7XG4gICAgICAgIHRoaXMubWFuaWZlc3RDYWNoZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5ob29rcyA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYmVmb3JlTG9hZFJlbW90ZVNuYXBzaG90OiBuZXcgQXN5bmNIb29rKCdiZWZvcmVMb2FkUmVtb3RlU25hcHNob3QnKSxcbiAgICAgICAgICAgIGxvYWRTbmFwc2hvdDogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnbG9hZEdsb2JhbFNuYXBzaG90JyksXG4gICAgICAgICAgICBsb2FkUmVtb3RlU25hcHNob3Q6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2xvYWRSZW1vdGVTbmFwc2hvdCcpLFxuICAgICAgICAgICAgYWZ0ZXJMb2FkU25hcHNob3Q6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2FmdGVyTG9hZFNuYXBzaG90JylcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubWFuaWZlc3RMb2FkaW5nID0gR2xvYmFsLl9fRkVERVJBVElPTl9fLl9fTUFOSUZFU1RfTE9BRElOR19fO1xuICAgICAgICB0aGlzLkhvc3RJbnN0YW5jZSA9IEhvc3RJbnN0YW5jZTtcbiAgICAgICAgdGhpcy5sb2FkZXJIb29rID0gSG9zdEluc3RhbmNlLmxvYWRlckhvb2s7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTbmFwc2hvdEhhbmRsZXIsIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTbmFwc2hvdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTbmFwc2hvdChtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8gPSB0aGlzLmdldEdsb2JhbFJlbW90ZUluZm8obW9kdWxlSW5mbyksIGhvc3RHbG9iYWxTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8uaG9zdEdsb2JhbFNuYXBzaG90LCByZW1vdGVTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8ucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90ID0gX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mby5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5sb2FkU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RHbG9iYWxTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfSksIGdsb2JhbFJlbW90ZVNuYXBzaG90ID0gX3JlZi5yZW1vdGVTbmFwc2hvdCwgZ2xvYmFsU25hcHNob3RSZXMgPSBfcmVmLmdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IGdsb2JhbFJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3Q6IGdsb2JhbFNuYXBzaG90UmVzXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRSZW1vdGVTbmFwc2hvdEluZm9cIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvblxuICAgICAgICAgICAgZnVuY3Rpb24gbG9hZFJlbW90ZVNuYXBzaG90SW5mbyhtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlTG9hZFJlbW90ZVNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm9cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob3N0U25hcHNob3QgPSBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucy52ZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWhvc3RTbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFNuYXBzaG90ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IHRoaXMuSG9zdEluc3RhbmNlLm9wdGlvbnMudmVyc2lvbiB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeTogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3Rlc0luZm86IHt9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkR2xvYmFsU25hcHNob3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLm5hbWVdOiBob3N0U25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEluIGR5bmFtaWMgbG9hZFJlbW90ZSBzY2VuYXJpb3MsIGluY29tcGxldGUgcmVtb3Rlc0luZm8gZGVsaXZlcnkgbWF5IG9jY3VyLiBJbiBzdWNoIGNhc2VzLCB0aGUgcmVtb3Rlc0luZm8gaW4gdGhlIGhvc3QgbmVlZHMgdG8gYmUgY29tcGxldGVkIGluIHRoZSBzbmFwc2hvdCBhdCBydW50aW1lLlxuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGVuc3VyZXMgdGhlIHNuYXBzaG90J3MgaW50ZWdyaXR5IGFuZCBoZWxwcyB0aGUgY2hyb21lIHBsdWdpbiBjb3JyZWN0bHkgaWRlbnRpZnkgYWxsIHByb2R1Y2VyIG1vZHVsZXMsIGVuc3VyaW5nIHRoYXQgcHJveHlhYmxlIHByb2R1Y2VyIG1vZHVsZXMgd2lsbCBub3QgYmUgbWlzc2luZy5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGhvc3RTbmFwc2hvdCAmJiAncmVtb3Rlc0luZm8nIGluIGhvc3RTbmFwc2hvdCAmJiAhZ2V0SW5mb1dpdGhvdXRUeXBlKGhvc3RTbmFwc2hvdC5yZW1vdGVzSW5mbywgbW9kdWxlSW5mby5uYW1lKS52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCd2ZXJzaW9uJyBpbiBtb2R1bGVJbmZvIHx8ICdlbnRyeScgaW4gbW9kdWxlSW5mbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RTbmFwc2hvdC5yZW1vdGVzSW5mbyA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgaG9zdFNuYXBzaG90ID09IG51bGwgPyB2b2lkIDAgOiBob3N0U25hcHNob3QucmVtb3Rlc0luZm8sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW21vZHVsZUluZm8ubmFtZV06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uOiAndmVyc2lvbicgaW4gbW9kdWxlSW5mbyA/IG1vZHVsZUluZm8udmVyc2lvbiA6IG1vZHVsZUluZm8uZW50cnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvID0gdGhpcy5nZXRHbG9iYWxSZW1vdGVJbmZvKG1vZHVsZUluZm8pLCBob3N0R2xvYmFsU25hcHNob3QgPSBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvLmhvc3RHbG9iYWxTbmFwc2hvdCwgcmVtb3RlU25hcHNob3QgPSBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvLnJlbW90ZVNuYXBzaG90LCBnbG9iYWxTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8uZ2xvYmFsU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUubG9hZFNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0R2xvYmFsU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH0pLCBnbG9iYWxSZW1vdGVTbmFwc2hvdCA9IF9yZWYucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90UmVzID0gX3JlZi5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1TbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgLy8gZ2xvYmFsIHNuYXBzaG90IGluY2x1ZGVzIG1hbmlmZXN0IG9yIG1vZHVsZSBpbmZvIGluY2x1ZGVzIG1hbmlmZXN0XG4gICAgICAgICAgICAgICAgICAgIGlmIChnbG9iYWxSZW1vdGVTbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNkay5pc01hbmlmZXN0UHJvdmlkZXIoZ2xvYmFsUmVtb3RlU25hcHNob3QpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5ID0gc2RrLmlzQnJvd3NlckVudigpID8gZ2xvYmFsUmVtb3RlU25hcHNob3QucmVtb3RlRW50cnkgOiBnbG9iYWxSZW1vdGVTbmFwc2hvdC5zc3JSZW1vdGVFbnRyeSB8fCBnbG9iYWxSZW1vdGVTbmFwc2hvdC5yZW1vdGVFbnRyeSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlU25hcHNob3QgPSB5aWVsZCB0aGlzLmdldE1hbmlmZXN0SnNvbihyZW1vdGVFbnRyeSwgbW9kdWxlSW5mbywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tc2hhZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNuYXBzaG90UmVzMSA9IHNldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyhwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIG1vZHVsZUluZm8sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGdsb2JhbCByZW1vdGUgbWF5IGJlIG92ZXJyaWRkZW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmVmb3JlLCBzZXQgdGhlIHNuYXBzaG90IGtleSB0byB0aGUgZ2xvYmFsIGFkZHJlc3Mgb2YgdGhlIGFjdHVhbCByZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5OiByZW1vdGVFbnRyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBtb2R1bGVTbmFwc2hvdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbVNuYXBzaG90ID0gbW9kdWxlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NuYXBzaG90ID0gZ2xvYmFsU25hcHNob3RSZXMxO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjEgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5sb2FkUmVtb3RlU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuSG9zdEluc3RhbmNlLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBnbG9iYWxSZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ2dsb2JhbCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgcmVtb3RlU25hcHNob3RSZXMgPSBfcmVmMS5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtU25hcHNob3QgPSByZW1vdGVTbmFwc2hvdFJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU25hcHNob3QgPSBnbG9iYWxTbmFwc2hvdFJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1JlbW90ZUluZm9XaXRoRW50cnkobW9kdWxlSW5mbykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZnJvbSBtYW5pZmVzdC5qc29uIGFuZCBtZXJnZSByZW1vdGUgaW5mbyBmcm9tIHJlbW90ZSBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlU25hcHNob3QxID0geWllbGQgdGhpcy5nZXRNYW5pZmVzdEpzb24obW9kdWxlSW5mby5lbnRyeSwgbW9kdWxlSW5mbywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tc2hhZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNuYXBzaG90UmVzMiA9IHNldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyhtb2R1bGVJbmZvLCBtb2R1bGVTbmFwc2hvdDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMiA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmxvYWRSZW1vdGVTbmFwc2hvdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IG1vZHVsZVNuYXBzaG90MSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ2dsb2JhbCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgcmVtb3RlU25hcHNob3RSZXMxID0gX3JlZjIucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbVNuYXBzaG90ID0gcmVtb3RlU25hcHNob3RSZXMxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdTbmFwc2hvdCA9IGdsb2JhbFNuYXBzaG90UmVzMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDcsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdE5hbWU6IG1vZHVsZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFZlcnNpb246IG1vZHVsZUluZm8udmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3Q6IEpTT04uc3RyaW5naWZ5KGdsb2JhbFNuYXBzaG90UmVzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5hZnRlckxvYWRTbmFwc2hvdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IG1TbmFwc2hvdFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBtU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdDogZ1NuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldEdsb2JhbFJlbW90ZUluZm9cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRHbG9iYWxSZW1vdGVJbmZvMShtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEdsb2JhbFJlbW90ZUluZm8obW9kdWxlSW5mbywgdGhpcy5Ib3N0SW5zdGFuY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZ2V0TWFuaWZlc3RKc29uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWFuaWZlc3RKc29uKG1hbmlmZXN0VXJsLCBtb2R1bGVJbmZvLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdldE1hbmlmZXN0ID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hbmlmZXN0SnNvbiA9IHRoaXMubWFuaWZlc3RDYWNoZS5nZXQobWFuaWZlc3RVcmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYW5pZmVzdEpzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hbmlmZXN0SnNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIHRoaXMubG9hZGVySG9vay5saWZlY3ljbGUuZmV0Y2guZW1pdChtYW5pZmVzdFVybCwge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlcyB8fCAhKHJlcyBpbnN0YW5jZW9mIFJlc3BvbnNlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0geWllbGQgZmV0Y2gobWFuaWZlc3RVcmwsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdEpzb24gPSB5aWVsZCByZXMuanNvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdEpzb24gPSB5aWVsZCB0aGlzLkhvc3RJbnN0YW5jZS5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5lcnJvckxvYWRSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogbWFuaWZlc3RVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJ2FmdGVyUmVzb2x2ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMuSG9zdEluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1hbmlmZXN0SnNvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMubWFuaWZlc3RMb2FkaW5nW21hbmlmZXN0VXJsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDAzLCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3RVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlTmFtZTogbW9kdWxlSW5mby5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBgJHtlcnJ9YCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydChtYW5pZmVzdEpzb24ubWV0YURhdGEgJiYgbWFuaWZlc3RKc29uLmV4cG9zZXMgJiYgbWFuaWZlc3RKc29uLnNoYXJlZCwgYCR7bWFuaWZlc3RVcmx9IGlzIG5vdCBhIGZlZGVyYXRpb24gbWFuaWZlc3RgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0Q2FjaGUuc2V0KG1hbmlmZXN0VXJsLCBtYW5pZmVzdEpzb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYW5pZmVzdEpzb247XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXN5bmNMb2FkUHJvY2VzcyA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYW5pZmVzdEpzb24gPSB5aWVsZCBnZXRNYW5pZmVzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVTbmFwc2hvdCA9IHNkay5nZW5lcmF0ZVNuYXBzaG90RnJvbU1hbmlmZXN0KG1hbmlmZXN0SnNvbiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiBtYW5pZmVzdFVybFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUubG9hZFJlbW90ZVNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdEpzb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdFVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ21hbmlmZXN0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCByZW1vdGVTbmFwc2hvdFJlcyA9IF9yZWYucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbW90ZVNuYXBzaG90UmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLm1hbmlmZXN0TG9hZGluZ1ttYW5pZmVzdFVybF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFuaWZlc3RMb2FkaW5nW21hbmlmZXN0VXJsXSA9IGFzeW5jTG9hZFByb2Nlc3MoKS50aGVuKChyZXMpPT5yZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1hbmlmZXN0TG9hZGluZ1ttYW5pZmVzdFVybF07XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBTbmFwc2hvdEhhbmRsZXI7XG59KCk7XG52YXIgU2hhcmVkSGFuZGxlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gU2hhcmVkSGFuZGxlcihob3N0KSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU2hhcmVkSGFuZGxlcik7XG4gICAgICAgIHRoaXMuaG9va3MgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIGFmdGVyUmVzb2x2ZTogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYWZ0ZXJSZXNvbHZlJyksXG4gICAgICAgICAgICBiZWZvcmVMb2FkU2hhcmU6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZUxvYWRTaGFyZScpLFxuICAgICAgICAgICAgLy8gbm90IHVzZWQgeWV0XG4gICAgICAgICAgICBsb2FkU2hhcmU6IG5ldyBBc3luY0hvb2soKSxcbiAgICAgICAgICAgIHJlc29sdmVTaGFyZTogbmV3IFN5bmNXYXRlcmZhbGxIb29rKCdyZXNvbHZlU2hhcmUnKSxcbiAgICAgICAgICAgIC8vIG1heWJlIHdpbGwgY2hhbmdlLCB0ZW1wb3JhcmlseSBmb3IgaW50ZXJuYWwgdXNlIG9ubHlcbiAgICAgICAgICAgIGluaXRDb250YWluZXJTaGFyZVNjb3BlTWFwOiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ2luaXRDb250YWluZXJTaGFyZVNjb3BlTWFwJylcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XG4gICAgICAgIHRoaXMuc2hhcmVTY29wZU1hcCA9IHt9O1xuICAgICAgICB0aGlzLmluaXRUb2tlbnMgPSB7fTtcbiAgICAgICAgdGhpcy5fc2V0R2xvYmFsU2hhcmVTY29wZU1hcChob3N0Lm9wdGlvbnMpO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oU2hhcmVkSGFuZGxlciwgW1xuICAgICAgICB7XG4gICAgICAgICAgICAvLyByZWdpc3RlciBzaGFyZWQgaW4gc2hhcmVTY29wZU1hcFxuICAgICAgICAgICAga2V5OiBcInJlZ2lzdGVyU2hhcmVkXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJTaGFyZWQoZ2xvYmFsT3B0aW9ucywgdXNlck9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2Zvcm1hdFNoYXJlQ29uZmlncyA9IGZvcm1hdFNoYXJlQ29uZmlncyhnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucyksIHNoYXJlSW5mb3MgPSBfZm9ybWF0U2hhcmVDb25maWdzLnNoYXJlSW5mb3MsIHNoYXJlZCA9IF9mb3JtYXRTaGFyZUNvbmZpZ3Muc2hhcmVkO1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZWRLZXlzID0gT2JqZWN0LmtleXMoc2hhcmVJbmZvcyk7XG4gICAgICAgICAgICAgICAgc2hhcmVkS2V5cy5mb3JFYWNoKChzaGFyZWRLZXkpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWRWYWxzID0gc2hhcmVJbmZvc1tzaGFyZWRLZXldO1xuICAgICAgICAgICAgICAgICAgICBzaGFyZWRWYWxzLmZvckVhY2goKHNoYXJlZFZhbCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWdpc3RlcmVkU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKHRoaXMuc2hhcmVTY29wZU1hcCwgc2hhcmVkS2V5LCBzaGFyZWRWYWwsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlZ2lzdGVyZWRTaGFyZWQgJiYgc2hhcmVkVmFsICYmIHNoYXJlZFZhbC5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNoYXJlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWU6IHNoYXJlZEtleSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliOiBzaGFyZWRWYWwubGliLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXQ6IHNoYXJlZFZhbC5nZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkOiBzaGFyZWRWYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IHVzZXJPcHRpb25zLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvcyxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTaGFyZShwa2dOYW1lLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZnVuY3Rpb24gcGVyZm9ybXMgdGhlIGZvbGxvd2luZyBzdGVwczpcbiAgICAgICAgICAgICAgICAgICAgLy8gMS4gQ2hlY2tzIGlmIHRoZSBjdXJyZW50bHkgbG9hZGVkIHNoYXJlIGFscmVhZHkgZXhpc3RzLCBpZiBub3QsIGl0IHRocm93cyBhbiBlcnJvclxuICAgICAgICAgICAgICAgICAgICAvLyAyLiBTZWFyY2hlcyBnbG9iYWxseSBmb3IgYSBtYXRjaGluZyBzaGFyZSwgaWYgZm91bmQsIGl0IHVzZXMgaXQgZGlyZWN0bHlcbiAgICAgICAgICAgICAgICAgICAgLy8gMy4gSWYgbm90IGZvdW5kLCBpdCByZXRyaWV2ZXMgaXQgZnJvbSB0aGUgY3VycmVudCBzaGFyZSBhbmQgc3RvcmVzIHRoZSBvYnRhaW5lZCBzaGFyZSBnbG9iYWxseS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlSW5mbyA9IGdldFRhcmdldFNoYXJlZE9wdGlvbnMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb3M6IGhvc3Qub3B0aW9ucy5zaGFyZWRcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZUluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IHNoYXJlSW5mby5zY29wZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgUHJvbWlzZS5hbGwoc2hhcmVJbmZvLnNjb3BlLm1hcCgoc2hhcmVTY29wZSk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIFByb21pc2UuYWxsKHRoaXMuaW5pdGlhbGl6ZVNoYXJpbmcoc2hhcmVTY29wZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3k6IHNoYXJlSW5mby5zdHJhdGVneVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRTaGFyZVJlcyA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZUxvYWRTaGFyZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IGhvc3Qub3B0aW9ucy5zaGFyZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZUluZm9SZXMgPSBsb2FkU2hhcmVSZXMuc2hhcmVJbmZvO1xuICAgICAgICAgICAgICAgICAgICAvLyBBc3NlcnQgdGhhdCBzaGFyZUluZm9SZXMgZXhpc3RzLCBpZiBub3QsIHRocm93IGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChzaGFyZUluZm9SZXMsIGBDYW5ub3QgZmluZCAke3BrZ05hbWV9IFNoYXJlIGluIHRoZSAke2hvc3Qub3B0aW9ucy5uYW1lfS4gUGxlYXNlIGVuc3VyZSB0aGF0IHRoZSAke3BrZ05hbWV9IFNoYXJlIHBhcmFtZXRlcnMgaGF2ZSBiZWVuIGluamVjdGVkYCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJldHJpZXZlIGZyb20gY2FjaGVcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUodGhpcy5zaGFyZVNjb3BlTWFwLCBwa2dOYW1lLCBzaGFyZUluZm9SZXMsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhZGRVc2VJbiA9IChzaGFyZWQpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNoYXJlZC51c2VJbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZC51c2VJbiA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVW5pcXVlSXRlbShzaGFyZWQudXNlSW4sIGhvc3Qub3B0aW9ucy5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlZ2lzdGVyZWRTaGFyZWQgJiYgcmVnaXN0ZXJlZFNoYXJlZC5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHJlZ2lzdGVyZWRTaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2lzdGVyZWRTaGFyZWQubGliO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlZ2lzdGVyZWRTaGFyZWQgJiYgcmVnaXN0ZXJlZFNoYXJlZC5sb2FkaW5nICYmICFyZWdpc3RlcmVkU2hhcmVkLmxvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhY3RvcnkgPSB5aWVsZCByZWdpc3RlcmVkU2hhcmVkLmxvYWRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpc3RlcmVkU2hhcmVkLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlZ2lzdGVyZWRTaGFyZWQubGliKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJlZFNoYXJlZC5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4ocmVnaXN0ZXJlZFNoYXJlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWdpc3RlcmVkU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXN5bmNMb2FkUHJvY2VzcyA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFjdG9yeSA9IHlpZWxkIHJlZ2lzdGVyZWRTaGFyZWQuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb1Jlcy5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9SZXMubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4oc2hhcmVJbmZvUmVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUodGhpcy5zaGFyZVNjb3BlTWFwLCBwa2dOYW1lLCBzaGFyZUluZm9SZXMsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU2hhcmVkLmxpYiA9IGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU2hhcmVkLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2FkaW5nID0gYXN5bmNMb2FkUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTaGFyZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHJlZ2lzdGVyZWRTaGFyZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRpbmc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuY3VzdG9tU2hhcmVJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzeW5jTG9hZFByb2Nlc3MxID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWN0b3J5ID0geWllbGQgc2hhcmVJbmZvUmVzLmdldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9SZXMubGliID0gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvUmVzLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHNoYXJlSW5mb1Jlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKHRoaXMuc2hhcmVTY29wZU1hcCwgcGtnTmFtZSwgc2hhcmVJbmZvUmVzLCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5yZXNvbHZlU2hhcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ1NoYXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NoYXJlZC5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NoYXJlZC5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZGluZzEgPSBhc3luY0xvYWRQcm9jZXNzMSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTaGFyZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHNoYXJlSW5mb1JlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWI6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZzogbG9hZGluZzFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRpbmcxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIFRoaXMgZnVuY3Rpb24gaW5pdGlhbGl6ZXMgdGhlIHNoYXJpbmcgc2VxdWVuY2UgKGV4ZWN1dGVkIG9ubHkgb25jZSBwZXIgc2hhcmUgc2NvcGUpLlxuICAgKiBJdCBhY2NlcHRzIG9uZSBhcmd1bWVudCwgdGhlIG5hbWUgb2YgdGhlIHNoYXJlIHNjb3BlLlxuICAgKiBJZiB0aGUgc2hhcmUgc2NvcGUgZG9lcyBub3QgZXhpc3QsIGl0IGNyZWF0ZXMgb25lLlxuICAgKi8gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9tZW1iZXItb3JkZXJpbmdcbiAgICAgICAgICAgIGtleTogXCJpbml0aWFsaXplU2hhcmluZ1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemVTaGFyaW5nKHJlZiwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGVOYW1lID0gcmVmID09PSB2b2lkIDAgPyBERUZBVUxUX1NDT1BFIDogcmVmO1xuICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgIHZhciBmcm9tID0gZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuZnJvbTtcbiAgICAgICAgICAgICAgICB2YXIgc3RyYXRlZ3kgPSBleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5zdHJhdGVneTtcbiAgICAgICAgICAgICAgICB2YXIgaW5pdFNjb3BlID0gZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuaW5pdFNjb3BlO1xuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChmcm9tICE9PSAnYnVpbGQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbml0VG9rZW5zID0gdGhpcy5pbml0VG9rZW5zO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWluaXRTY29wZSkgaW5pdFNjb3BlID0gW107XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbml0VG9rZW4gPSBpbml0VG9rZW5zW3NoYXJlU2NvcGVOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpbml0VG9rZW4pIGluaXRUb2tlbiA9IGluaXRUb2tlbnNbc2hhcmVTY29wZU5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogdGhpcy5ob3N0Lm5hbWVcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluaXRTY29wZS5pbmRleE9mKGluaXRUb2tlbikgPj0gMCkgcmV0dXJuIHByb21pc2VzO1xuICAgICAgICAgICAgICAgICAgICBpbml0U2NvcGUucHVzaChpbml0VG9rZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2hhcmVTY29wZSA9IHRoaXMuc2hhcmVTY29wZU1hcDtcbiAgICAgICAgICAgICAgICB2YXIgaG9zdE5hbWUgPSBob3N0Lm9wdGlvbnMubmFtZTtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGVzIGEgbmV3IHNoYXJlIHNjb3BlIGlmIG5lY2Vzc2FyeVxuICAgICAgICAgICAgICAgIGlmICghc2hhcmVTY29wZVtzaGFyZVNjb3BlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZVtzaGFyZVNjb3BlTmFtZV0gPSB7fTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRXhlY3V0ZXMgYWxsIGluaXRpYWxpemF0aW9uIHNuaXBwZXRzIGZyb20gYWxsIGFjY2Vzc2libGUgbW9kdWxlc1xuICAgICAgICAgICAgICAgIHZhciBzY29wZSA9IHNoYXJlU2NvcGVbc2hhcmVTY29wZU5hbWVdO1xuICAgICAgICAgICAgICAgIHZhciByZWdpc3RlciA9IChuYW1lMSwgc2hhcmVkKT0+e1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2FjdGl2ZVZlcnNpb25fc2hhcmVDb25maWc7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gc2hhcmVkLnZlcnNpb24sIGVhZ2VyID0gc2hhcmVkLmVhZ2VyO1xuICAgICAgICAgICAgICAgICAgICBzY29wZVtuYW1lMV0gPSBzY29wZVtuYW1lMV0gfHwge307XG4gICAgICAgICAgICAgICAgICAgIHZhciB2ZXJzaW9ucyA9IHNjb3BlW25hbWUxXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVZlcnNpb24gPSB2ZXJzaW9uc1t2ZXJzaW9uXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVZlcnNpb25FYWdlciA9IEJvb2xlYW4oYWN0aXZlVmVyc2lvbiAmJiAoYWN0aXZlVmVyc2lvbi5lYWdlciB8fCAoKF9hY3RpdmVWZXJzaW9uX3NoYXJlQ29uZmlnID0gYWN0aXZlVmVyc2lvbi5zaGFyZUNvbmZpZykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hY3RpdmVWZXJzaW9uX3NoYXJlQ29uZmlnLmVhZ2VyKSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWFjdGl2ZVZlcnNpb24gfHwgYWN0aXZlVmVyc2lvbi5zdHJhdGVneSAhPT0gJ2xvYWRlZC1maXJzdCcgJiYgIWFjdGl2ZVZlcnNpb24ubG9hZGVkICYmIChCb29sZWFuKCFlYWdlcikgIT09ICFhY3RpdmVWZXJzaW9uRWFnZXIgPyBlYWdlciA6IGhvc3ROYW1lID4gYWN0aXZlVmVyc2lvbi5mcm9tKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbnNbdmVyc2lvbl0gPSBzaGFyZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBpbml0Rm4gPSAobW9kKT0+bW9kICYmIG1vZC5pbml0ICYmIG1vZC5pbml0KHNoYXJlU2NvcGVbc2hhcmVTY29wZU5hbWVdLCBpbml0U2NvcGUpO1xuICAgICAgICAgICAgICAgIHZhciBpbml0UmVtb3RlTW9kdWxlID0gKGtleSk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gKHlpZWxkIGhvc3QucmVtb3RlSGFuZGxlci5nZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDoga2V5XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSkubW9kdWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZHVsZS5nZXRFbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgbW9kdWxlLmdldEVudHJ5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgaG9zdC5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5lcnJvckxvYWRSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDoga2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAncnVudGltZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZlY3ljbGU6ICdiZWZvcmVMb2FkU2hhcmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZHVsZS5pbml0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgaW5pdEZuKHJlbW90ZUVudHJ5RXhwb3J0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZS5pbml0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhob3N0Lm9wdGlvbnMuc2hhcmVkKS5mb3JFYWNoKChzaGFyZU5hbWUpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWRBcnIgPSBob3N0Lm9wdGlvbnMuc2hhcmVkW3NoYXJlTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZEFyci5mb3JFYWNoKChzaGFyZWQpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hhcmVkLnNjb3BlLmluY2x1ZGVzKHNoYXJlU2NvcGVOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyKHNoYXJlTmFtZSwgc2hhcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogc3RyYXRlZ3k9PT0ndmVyc2lvbi1maXJzdCcgbmVlZCB0byBiZSByZW1vdmVkIGluIHRoZSBmdXR1cmVcbiAgICAgICAgICAgICAgICBpZiAoaG9zdC5vcHRpb25zLnNoYXJlU3RyYXRlZ3kgPT09ICd2ZXJzaW9uLWZpcnN0JyB8fCBzdHJhdGVneSA9PT0gJ3ZlcnNpb24tZmlyc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGhvc3Qub3B0aW9ucy5yZW1vdGVzLmZvckVhY2goKHJlbW90ZSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdGUuc2hhcmVTY29wZSA9PT0gc2hhcmVTY29wZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGluaXRSZW1vdGVNb2R1bGUocmVtb3RlLm5hbWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVGhlIGxpYiBmdW5jdGlvbiB3aWxsIG9ubHkgYmUgYXZhaWxhYmxlIGlmIHRoZSBzaGFyZWQgc2V0IGJ5IGVhZ2VyIG9yIHJ1bnRpbWUgaW5pdCBpcyBzZXQgb3IgdGhlIHNoYXJlZCBpcyBzdWNjZXNzZnVsbHkgbG9hZGVkLlxuICAgICAgICAgICAgLy8gMS4gSWYgdGhlIGxvYWRlZCBzaGFyZWQgYWxyZWFkeSBleGlzdHMgZ2xvYmFsbHksIHRoZW4gaXQgd2lsbCBiZSByZXVzZWRcbiAgICAgICAgICAgIC8vIDIuIElmIGxpYiBleGlzdHMgaW4gbG9jYWwgc2hhcmVkLCBpdCB3aWxsIGJlIHVzZWQgZGlyZWN0bHlcbiAgICAgICAgICAgIC8vIDMuIElmIHRoZSBsb2NhbCBnZXQgcmV0dXJucyBzb21ldGhpbmcgb3RoZXIgdGhhbiBQcm9taXNlLCB0aGVuIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseVxuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVN5bmNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkU2hhcmVTeW5jKHBrZ05hbWUsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZUluZm8gPSBnZXRUYXJnZXRTaGFyZWRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZXh0cmFPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9zOiBob3N0Lm9wdGlvbnMuc2hhcmVkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mbyA9PSBudWxsID8gdm9pZCAwIDogc2hhcmVJbmZvLnNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mby5zY29wZS5mb3JFYWNoKChzaGFyZVNjb3BlKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplU2hhcmluZyhzaGFyZVNjb3BlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3k6IHNoYXJlSW5mby5zdHJhdGVneVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVnaXN0ZXJlZFNoYXJlZCA9IGdldFJlZ2lzdGVyZWRTaGFyZSh0aGlzLnNoYXJlU2NvcGVNYXAsIHBrZ05hbWUsIHNoYXJlSW5mbywgdGhpcy5ob29rcy5saWZlY3ljbGUucmVzb2x2ZVNoYXJlKTtcbiAgICAgICAgICAgICAgICB2YXIgYWRkVXNlSW4gPSAoc2hhcmVkKT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNoYXJlZC51c2VJbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkLnVzZUluID0gW107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYWRkVW5pcXVlSXRlbShzaGFyZWQudXNlSW4sIGhvc3Qub3B0aW9ucy5uYW1lKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChyZWdpc3RlcmVkU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVnaXN0ZXJlZFNoYXJlZC5saWIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHJlZ2lzdGVyZWRTaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZWdpc3RlcmVkU2hhcmVkLmxvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyZWRTaGFyZWQubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVnaXN0ZXJlZFNoYXJlZC5mcm9tID09PSBob3N0Lm9wdGlvbnMubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm8ubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnaXN0ZXJlZFNoYXJlZC5saWI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZWdpc3RlcmVkU2hhcmVkLmdldCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZSA9IHJlZ2lzdGVyZWRTaGFyZWQuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShtb2R1bGUgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHJlZ2lzdGVyZWRTaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2hhcmVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliOiBtb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogcmVnaXN0ZXJlZFNoYXJlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mby5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzaGFyZUluZm8ubG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm8ubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hhcmVJbmZvLmxpYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mby5nZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZTEgPSBzaGFyZUluZm8uZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb2R1bGUxIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yQ29kZSA9IChleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5mcm9tKSA9PT0gJ2J1aWxkJyA/IGVycm9yQ29kZXMuUlVOVElNRV8wMDUgOiBlcnJvckNvZGVzLlJVTlRJTUVfMDA2O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGUsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkUGtnTmFtZTogcGtnTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mby5saWIgPSBtb2R1bGUxO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNoYXJlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaWI6IHNoYXJlSW5mby5saWIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHNoYXJlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNoYXJlSW5mby5saWI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwNiwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZFBrZ05hbWU6IHBrZ05hbWVcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0U2hhcmVTY29wZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRTaGFyZVNjb3BlTWFwKHNjb3BlTmFtZSwgc2hhcmVTY29wZSwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4dHJhT3B0aW9ucyA9IHJlZiA9PT0gdm9pZCAwID8ge30gOiByZWY7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwW3Njb3BlTmFtZV0gPSBzaGFyZVNjb3BlO1xuICAgICAgICAgICAgICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmluaXRDb250YWluZXJTaGFyZVNjb3BlTWFwLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBzaGFyZVNjb3BlLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVOYW1lLFxuICAgICAgICAgICAgICAgICAgICBob3N0U2hhcmVTY29wZU1hcDogZXh0cmFPcHRpb25zLmhvc3RTaGFyZVNjb3BlTWFwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJzZXRTaGFyZWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTaGFyZWQocmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBrZ05hbWUgPSByZWYucGtnTmFtZSwgc2hhcmVkID0gcmVmLnNoYXJlZCwgZnJvbSA9IHJlZi5mcm9tLCBsaWIgPSByZWYubGliLCBsb2FkaW5nID0gcmVmLmxvYWRpbmcsIGxvYWRlZCA9IHJlZi5sb2FkZWQsIGdldCA9IHJlZi5nZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHZlcnNpb24gPSBzaGFyZWQudmVyc2lvbiwgX3NoYXJlZF9zY29wZSA9IHNoYXJlZC5zY29wZSwgc2NvcGUgPSBfc2hhcmVkX3Njb3BlID09PSB2b2lkIDAgPyAnZGVmYXVsdCcgOiBfc2hhcmVkX3Njb3BlLCBzaGFyZUluZm8gPSBwb2x5ZmlsbHMuX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2Uoc2hhcmVkLCBbXG4gICAgICAgICAgICAgICAgICAgIFwidmVyc2lvblwiLFxuICAgICAgICAgICAgICAgICAgICBcInNjb3BlXCJcbiAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NvcGVzID0gQXJyYXkuaXNBcnJheShzY29wZSkgPyBzY29wZSA6IFtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIHNjb3Blcy5mb3JFYWNoKChzYyk9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNoYXJlU2NvcGVNYXBbc2NdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdID0ge307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdID0ge307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dID0gcG9seWZpbGxzLl9leHRlbmRzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkZWZhdWx0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHNoYXJlSW5mbywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVt2ZXJzaW9uXS5nZXQgPSBnZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRTaGFyZWQgPSB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGluZyAmJiAhcmVnaXN0ZXJlZFNoYXJlZC5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpc3RlcmVkU2hhcmVkLmxvYWRpbmcgPSBsb2FkaW5nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJfc2V0R2xvYmFsU2hhcmVTY29wZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRHbG9iYWxTaGFyZVNjb3BlTWFwKGhvc3RPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNoYXJlU2NvcGVNYXAgPSBnZXRHbG9iYWxTaGFyZVNjb3BlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGlkZW50aWZpZXIgPSBob3N0T3B0aW9ucy5pZCB8fCBob3N0T3B0aW9ucy5uYW1lO1xuICAgICAgICAgICAgICAgIGlmIChpZGVudGlmaWVyICYmICFnbG9iYWxTaGFyZVNjb3BlTWFwW2lkZW50aWZpZXJdKSB7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbFNoYXJlU2NvcGVNYXBbaWRlbnRpZmllcl0gPSB0aGlzLnNoYXJlU2NvcGVNYXA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFNoYXJlZEhhbmRsZXI7XG59KCk7XG52YXIgUmVtb3RlSGFuZGxlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gUmVtb3RlSGFuZGxlcihob3N0KSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgUmVtb3RlSGFuZGxlcik7XG4gICAgICAgIHRoaXMuaG9va3MgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIGJlZm9yZVJlZ2lzdGVyUmVtb3RlOiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZVJlZ2lzdGVyUmVtb3RlJyksXG4gICAgICAgICAgICByZWdpc3RlclJlbW90ZTogbmV3IFN5bmNXYXRlcmZhbGxIb29rKCdyZWdpc3RlclJlbW90ZScpLFxuICAgICAgICAgICAgYmVmb3JlUmVxdWVzdDogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYmVmb3JlUmVxdWVzdCcpLFxuICAgICAgICAgICAgb25Mb2FkOiBuZXcgQXN5bmNIb29rKCdvbkxvYWQnKSxcbiAgICAgICAgICAgIGhhbmRsZVByZWxvYWRNb2R1bGU6IG5ldyBTeW5jSG9vaygnaGFuZGxlUHJlbG9hZE1vZHVsZScpLFxuICAgICAgICAgICAgZXJyb3JMb2FkUmVtb3RlOiBuZXcgQXN5bmNIb29rKCdlcnJvckxvYWRSZW1vdGUnKSxcbiAgICAgICAgICAgIGJlZm9yZVByZWxvYWRSZW1vdGU6IG5ldyBBc3luY0hvb2soJ2JlZm9yZVByZWxvYWRSZW1vdGUnKSxcbiAgICAgICAgICAgIGdlbmVyYXRlUHJlbG9hZEFzc2V0czogbmV3IEFzeW5jSG9vaygnZ2VuZXJhdGVQcmVsb2FkQXNzZXRzJyksXG4gICAgICAgICAgICAvLyBub3QgdXNlZCB5ZXRcbiAgICAgICAgICAgIGFmdGVyUHJlbG9hZFJlbW90ZTogbmV3IEFzeW5jSG9vaygpLFxuICAgICAgICAgICAgbG9hZEVudHJ5OiBuZXcgQXN5bmNIb29rKClcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XG4gICAgICAgIHRoaXMuaWRUb1JlbW90ZU1hcCA9IHt9O1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oUmVtb3RlSGFuZGxlciwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZm9ybWF0QW5kUmVnaXN0ZXJSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JtYXRBbmRSZWdpc3RlclJlbW90ZShnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciB1c2VyUmVtb3RlcyA9IHVzZXJPcHRpb25zLnJlbW90ZXMgfHwgW107XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJSZW1vdGVzLnJlZHVjZSgocmVzLCByZW1vdGUpPT57XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJSZW1vdGUocmVtb3RlLCByZXMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9LCBnbG9iYWxPcHRpb25zLnJlbW90ZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic2V0SWRUb1JlbW90ZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldElkVG9SZW1vdGVNYXAoaWQsIHJlbW90ZU1hdGNoSW5mbykge1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSByZW1vdGVNYXRjaEluZm8ucmVtb3RlLCBleHBvc2UgPSByZW1vdGVNYXRjaEluZm8uZXhwb3NlO1xuICAgICAgICAgICAgICAgIHZhciBuYW1lMSA9IHJlbW90ZS5uYW1lLCBhbGlhcyA9IHJlbW90ZS5hbGlhcztcbiAgICAgICAgICAgICAgICB0aGlzLmlkVG9SZW1vdGVNYXBbaWRdID0ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoYWxpYXMgJiYgaWQuc3RhcnRzV2l0aChuYW1lMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkV2l0aEFsaWFzID0gaWQucmVwbGFjZShuYW1lMSwgYWxpYXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlkVG9SZW1vdGVNYXBbaWRXaXRoQWxpYXNdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWxpYXMgJiYgaWQuc3RhcnRzV2l0aChhbGlhcykpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkV2l0aE5hbWUgPSBpZC5yZXBsYWNlKGFsaWFzLCBuYW1lMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaWRUb1JlbW90ZU1hcFtpZFdpdGhOYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGluZXMtcGVyLWZ1bmN0aW9uXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAgZnVuY3Rpb24gbG9hZFJlbW90ZShpZCwgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gb3B0aW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZEZhY3Rvcnk6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9yZWZfbG9hZEZhY3RvcnkgPSBfcmVmLmxvYWRGYWN0b3J5LCBsb2FkRmFjdG9yeSA9IF9yZWZfbG9hZEZhY3RvcnkgPT09IHZvaWQgMCA/IHRydWUgOiBfcmVmX2xvYWRGYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMS4gVmFsaWRhdGUgdGhlIHBhcmFtZXRlcnMgb2YgdGhlIHJldHJpZXZlZCBtb2R1bGUuIFRoZXJlIGFyZSB0d28gbW9kdWxlIHJlcXVlc3QgbWV0aG9kczogcGtnTmFtZSArIGV4cG9zZSBhbmQgYWxpYXMgKyBleHBvc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAyLiBSZXF1ZXN0IHRoZSBzbmFwc2hvdCBpbmZvcm1hdGlvbiBvZiB0aGUgY3VycmVudCBob3N0IGFuZCBnbG9iYWxseSBzdG9yZSB0aGUgb2J0YWluZWQgc25hcHNob3QgaW5mb3JtYXRpb24uIFRoZSByZXRyaWV2ZWQgbW9kdWxlIGluZm9ybWF0aW9uIGlzIHBhcnRpYWxseSBvZmZsaW5lIGFuZCBwYXJ0aWFsbHkgb25saW5lLiBUaGUgb25saW5lIG1vZHVsZSBpbmZvcm1hdGlvbiB3aWxsIHJldHJpZXZlIHRoZSBtb2R1bGVzIHVzZWQgb25saW5lLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMy4gUmV0cmlldmUgdGhlIGRldGFpbGVkIGluZm9ybWF0aW9uIG9mIHRoZSBjdXJyZW50IG1vZHVsZSBmcm9tIGdsb2JhbCAocmVtb3RlRW50cnkgYWRkcmVzcywgZXhwb3NlIHJlc291cmNlIGFkZHJlc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA0LiBBZnRlciByZXRyaWV2aW5nIHJlbW90ZUVudHJ5LCBjYWxsIHRoZSBpbml0IG9mIHRoZSBtb2R1bGUsIGFuZCB0aGVuIHJldHJpZXZlIHRoZSBleHBvcnRlZCBjb250ZW50IG9mIHRoZSBtb2R1bGUgdGhyb3VnaCBnZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlkOiBwa2dOYW1lKEBmZWRlcmF0aW9uL2FwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBAZmVkZXJhdGlvbi9hcHAxL2J1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWQ6IGFsaWFzKGFwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBhcHAxL2J1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWQ6IGFsaWFzKGFwcDEvdXRpbHMpICsgZXhwb3NlKGxvYWRhc2gvc29ydCkgPSBhcHAxL3V0aWxzL2xvYWRhc2gvc29ydFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYxID0geWllbGQgdGhpcy5nZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSksIG1vZHVsZSA9IF9yZWYxLm1vZHVsZSwgbW9kdWxlT3B0aW9ucyA9IF9yZWYxLm1vZHVsZU9wdGlvbnMsIHJlbW90ZU1hdGNoSW5mbyA9IF9yZWYxLnJlbW90ZU1hdGNoSW5mbztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwa2dOYW1lT3JBbGlhcyA9IHJlbW90ZU1hdGNoSW5mby5wa2dOYW1lT3JBbGlhcywgcmVtb3RlID0gcmVtb3RlTWF0Y2hJbmZvLnJlbW90ZSwgZXhwb3NlID0gcmVtb3RlTWF0Y2hJbmZvLmV4cG9zZSwgaWRSZXMgPSByZW1vdGVNYXRjaEluZm8uaWQsIHJlbW90ZVNuYXBzaG90ID0gcmVtb3RlTWF0Y2hJbmZvLnJlbW90ZVNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZU9yRmFjdG9yeSA9IHlpZWxkIG1vZHVsZS5nZXQoaWRSZXMsIGV4cG9zZSwgb3B0aW9ucywgcmVtb3RlU25hcHNob3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZVdyYXBwZXIgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5vbkxvYWQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkUmVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VNb2R1bGU6IGxvYWRGYWN0b3J5ID8gbW9kdWxlT3JGYWN0b3J5IDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZU1vZHVsZUZhY3Rvcnk6IGxvYWRGYWN0b3J5ID8gdW5kZWZpbmVkIDogbW9kdWxlT3JGYWN0b3J5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBtb2R1bGVPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluc3RhbmNlOiBtb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0SWRUb1JlbW90ZU1hcChpZCwgcmVtb3RlTWF0Y2hJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbW9kdWxlV3JhcHBlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGVXcmFwcGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZU9yRmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMiA9IG9wdGlvbnMgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgX3JlZl9mcm9tID0gX3JlZjIuZnJvbSwgZnJvbSA9IF9yZWZfZnJvbSA9PT0gdm9pZCAwID8gJ3J1bnRpbWUnIDogX3JlZl9mcm9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWxPdmVyID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuZXJyb3JMb2FkUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb20sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlmZWN5Y2xlOiAnb25Mb2FkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmYWlsT3Zlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhaWxPdmVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInByZWxvYWRSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAgZnVuY3Rpb24gcHJlbG9hZFJlbW90ZShwcmVsb2FkT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlUHJlbG9hZFJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRPcHM6IHByZWxvYWRPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogaG9zdC5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJlbG9hZE9wcyA9IGZvcm1hdFByZWxvYWRBcmdzKGhvc3Qub3B0aW9ucy5yZW1vdGVzLCBwcmVsb2FkT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIFByb21pc2UuYWxsKHByZWxvYWRPcHMubWFwKChvcHMpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSBvcHMucmVtb3RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gZ2V0UmVtb3RlSW5mbyhyZW1vdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgaG9zdC5zbmFwc2hvdEhhbmRsZXIubG9hZFJlbW90ZVNuYXBzaG90SW5mbyhyZW1vdGUpLCBnbG9iYWxTbmFwc2hvdCA9IF9yZWYuZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90ID0gX3JlZi5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzZXRzID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuZ2VuZXJhdGVQcmVsb2FkQXNzZXRzLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRPcHRpb25zOiBvcHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhc3NldHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVsb2FkQXNzZXRzKHJlbW90ZUluZm8sIGhvc3QsIGFzc2V0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpKSk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlZ2lzdGVyUmVtb3Rlc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyUmVtb3RlcyhyZW1vdGVzLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgcmVtb3Rlcy5mb3JFYWNoKChyZW1vdGUpPT57XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJSZW1vdGUocmVtb3RlLCBob3N0Lm9wdGlvbnMucmVtb3Rlcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2U6IG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuZm9yY2VcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVtb3RlTW9kdWxlQW5kT3B0aW9ucyhvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBvcHRpb25zLmlkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFJlbW90ZUFyZ3M7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkUmVtb3RlQXJncyA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZVJlcXVlc3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogaG9zdC5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkUmVtb3RlQXJncyA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmVycm9yTG9hZFJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZlY3ljbGU6ICdiZWZvcmVSZXF1ZXN0J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxvYWRSZW1vdGVBcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkUmVzID0gbG9hZFJlbW90ZUFyZ3MuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVTcGxpdEluZm8gPSBtYXRjaFJlbW90ZVdpdGhOYW1lQW5kRXhwb3NlKGhvc3Qub3B0aW9ucy5yZW1vdGVzLCBpZFJlcyk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChyZW1vdGVTcGxpdEluZm8sIGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDA0LCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0SWQ6IGlkUmVzXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhd1JlbW90ZSA9IHJlbW90ZVNwbGl0SW5mby5yZW1vdGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gZ2V0UmVtb3RlSW5mbyhyYXdSZW1vdGUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hJbmZvID0geWllbGQgaG9zdC5zaGFyZWRIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5hZnRlclJlc29sdmUuZW1pdChwb2x5ZmlsbHMuX2V4dGVuZHMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkUmVzXG4gICAgICAgICAgICAgICAgICAgIH0sIHJlbW90ZVNwbGl0SW5mbywge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogaG9zdC5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSBtYXRjaEluZm8ucmVtb3RlLCBleHBvc2UgPSBtYXRjaEluZm8uZXhwb3NlO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQocmVtb3RlICYmIGV4cG9zZSwgYFRoZSAnYmVmb3JlUmVxdWVzdCcgaG9vayB3YXMgZXhlY3V0ZWQsIGJ1dCBpdCBmYWlsZWQgdG8gcmV0dXJuIHRoZSBjb3JyZWN0ICdyZW1vdGUnIGFuZCAnZXhwb3NlJyB2YWx1ZXMgd2hpbGUgbG9hZGluZyAke2lkUmVzfS5gKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZSA9IGhvc3QubW9kdWxlQ2FjaGUuZ2V0KHJlbW90ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZU9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0OiBob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlID0gbmV3IE1vZHVsZShtb2R1bGVPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QubW9kdWxlQ2FjaGUuc2V0KHJlbW90ZS5uYW1lLCBtb2R1bGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlTWF0Y2hJbmZvOiBtYXRjaEluZm9cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVnaXN0ZXJSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlclJlbW90ZShyZW1vdGUsIHRhcmdldFJlbW90ZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICB2YXIgbm9ybWFsaXplUmVtb3RlID0gKCk9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZS5hbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVmFsaWRhdGUgaWYgYWxpYXMgZXF1YWxzIHRoZSBwcmVmaXggb2YgcmVtb3RlLm5hbWUgYW5kIHJlbW90ZS5hbGlhcywgaWYgc28sIHRocm93IGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcyBtdWx0aS1sZXZlbCBwYXRoIHJlZmVyZW5jZXMgY2Fubm90IGd1YXJhbnRlZSB1bmlxdWUgbmFtZXMsIGFsaWFzIGJlaW5nIGEgcHJlZml4IG9mIHJlbW90ZS5uYW1lIGlzIG5vdCBzdXBwb3J0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaW5kRXF1YWwgPSB0YXJnZXRSZW1vdGVzLmZpbmQoKGl0ZW0pPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9pdGVtX2FsaWFzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZW1vdGUuYWxpYXMgJiYgKGl0ZW0ubmFtZS5zdGFydHNXaXRoKHJlbW90ZS5hbGlhcykgfHwgKChfaXRlbV9hbGlhcyA9IGl0ZW0uYWxpYXMpID09IG51bGwgPyB2b2lkIDAgOiBfaXRlbV9hbGlhcy5zdGFydHNXaXRoKHJlbW90ZS5hbGlhcykpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCFmaW5kRXF1YWwsIGBUaGUgYWxpYXMgJHtyZW1vdGUuYWxpYXN9IG9mIHJlbW90ZSAke3JlbW90ZS5uYW1lfSBpcyBub3QgYWxsb3dlZCB0byBiZSB0aGUgcHJlZml4IG9mICR7ZmluZEVxdWFsICYmIGZpbmRFcXVhbC5uYW1lfSBuYW1lIG9yIGFsaWFzYCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSByZW1vdGUgZW50cnkgdG8gYSBjb21wbGV0ZSBwYXRoXG4gICAgICAgICAgICAgICAgICAgIGlmICgnZW50cnknIGluIHJlbW90ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNkay5pc0Jyb3dzZXJFbnYoKSAmJiAhcmVtb3RlLmVudHJ5LnN0YXJ0c1dpdGgoJ2h0dHAnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZS5lbnRyeSA9IG5ldyBVUkwocmVtb3RlLmVudHJ5LCB3aW5kb3cubG9jYXRpb24ub3JpZ2luKS5ocmVmO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVtb3RlLnNoYXJlU2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZS5zaGFyZVNjb3BlID0gREVGQVVMVF9TQ09QRTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlbW90ZS50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUudHlwZSA9IERFRkFVTFRfUkVNT1RFX1RZUEU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZVJlZ2lzdGVyUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciByZWdpc3RlcmVkUmVtb3RlID0gdGFyZ2V0UmVtb3Rlcy5maW5kKChpdGVtKT0+aXRlbS5uYW1lID09PSByZW1vdGUubmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZWdpc3RlcmVkUmVtb3RlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZVJlbW90ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRSZW1vdGVzLnB1c2gocmVtb3RlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUucmVnaXN0ZXJSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VzID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgYFRoZSByZW1vdGUgXCIke3JlbW90ZS5uYW1lfVwiIGlzIGFscmVhZHkgcmVnaXN0ZXJlZC5gLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ1BsZWFzZSBub3RlIHRoYXQgb3ZlcnJpZGluZyBpdCBtYXkgY2F1c2UgdW5leHBlY3RlZCBlcnJvcnMuJ1xuICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5mb3JjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHJlZ2lzdGVyZWQgcmVtb3RlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVJlbW90ZShyZWdpc3RlcmVkUmVtb3RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZVJlbW90ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UmVtb3Rlcy5wdXNoKHJlbW90ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5yZWdpc3RlclJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNkay53YXJuKG1lc3NhZ2VzLmpvaW4oJyAnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZW1vdmVSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVSZW1vdGUocmVtb3RlKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lMSA9IHJlbW90ZS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5kZXggPSBob3N0Lm9wdGlvbnMucmVtb3Rlcy5maW5kSW5kZXgoKGl0ZW0pPT5pdGVtLm5hbWUgPT09IG5hbWUxKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5vcHRpb25zLnJlbW90ZXMuc3BsaWNlKHJlbW90ZUluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZGVkTW9kdWxlID0gaG9zdC5tb2R1bGVDYWNoZS5nZXQocmVtb3RlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGVkTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IGxvYWRlZE1vZHVsZS5yZW1vdGVJbmZvO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEN1cnJlbnRHbG9iYWxba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfT2JqZWN0X2dldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKF9PYmplY3RfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihDdXJyZW50R2xvYmFsLCBrZXkpKSA9PSBudWxsID8gdm9pZCAwIDogX09iamVjdF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IuY29uZmlndXJhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBDdXJyZW50R2xvYmFsW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDdXJyZW50R2xvYmFsW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5VW5pcXVlS2V5ID0gZ2V0UmVtb3RlRW50cnlVbmlxdWVLZXkobG9hZGVkTW9kdWxlLnJlbW90ZUluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdsb2JhbExvYWRpbmdbcmVtb3RlRW50cnlVbmlxdWVLZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGdsb2JhbExvYWRpbmdbcmVtb3RlRW50cnlVbmlxdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5zbmFwc2hvdEhhbmRsZXIubWFuaWZlc3RDYWNoZS5kZWxldGUocmVtb3RlSW5mby5lbnRyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkZWxldGUgdW5sb2FkZWQgc2hhcmVkIGFuZCBpbnN0YW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluc0lkID0gcmVtb3RlSW5mby5idWlsZFZlcnNpb24gPyBzZGsuY29tcG9zZUtleVdpdGhTZXBhcmF0b3IocmVtb3RlSW5mby5uYW1lLCByZW1vdGVJbmZvLmJ1aWxkVmVyc2lvbikgOiByZW1vdGVJbmZvLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5zSW5kZXggPSBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX18uZmluZEluZGV4KChpbnMpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUluZm8uYnVpbGRWZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnMub3B0aW9ucy5pZCA9PT0gcmVtb3RlSW5zSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlucy5uYW1lID09PSByZW1vdGVJbnNJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdGVJbnNJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5zID0gQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0lOU1RBTkNFU19fW3JlbW90ZUluc0luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbnNJZCA9IHJlbW90ZUlucy5vcHRpb25zLmlkIHx8IHJlbW90ZUluc0lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnbG9iYWxTaGFyZVNjb3BlTWFwID0gZ2V0R2xvYmFsU2hhcmVTY29wZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0FsbFNoYXJlZE5vdFVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZWVkRGVsZXRlS2V5cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGdsb2JhbFNoYXJlU2NvcGVNYXApLmZvckVhY2goKGluc3RJZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGVNYXAgPSBnbG9iYWxTaGFyZVNjb3BlTWFwW2luc3RJZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGVNYXAgJiYgT2JqZWN0LmtleXMoc2hhcmVTY29wZU1hcCkuZm9yRWFjaCgoc2hhcmVTY29wZSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlVmFsID0gc2hhcmVTY29wZU1hcFtzaGFyZVNjb3BlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGVWYWwgJiYgT2JqZWN0LmtleXMoc2hhcmVTY29wZVZhbCkuZm9yRWFjaCgoc2hhcmVOYW1lKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWRQa2dzID0gc2hhcmVTY29wZVZhbFtzaGFyZU5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZFBrZ3MgJiYgT2JqZWN0LmtleXMoc2hhcmVkUGtncykuZm9yRWFjaCgoc2hhcmVWZXJzaW9uKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2hhcmVkID0gc2hhcmVkUGtnc1tzaGFyZVZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hhcmVkICYmIHR5cGVvZiBzaGFyZWQgPT09ICdvYmplY3QnICYmIHNoYXJlZC5mcm9tID09PSByZW1vdGVJbmZvLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWQubG9hZGVkIHx8IHNoYXJlZC5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkLnVzZUluID0gc2hhcmVkLnVzZUluLmZpbHRlcigodXNlZEhvc3ROYW1lKT0+dXNlZEhvc3ROYW1lICE9PSByZW1vdGVJbmZvLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWQudXNlSW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQWxsU2hhcmVkTm90VXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVLZXlzLnB1c2goW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlVmVyc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVLZXlzLnB1c2goW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVWZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBbGxTaGFyZWROb3RVc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUlucy5zaGFyZVNjb3BlTWFwID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBnbG9iYWxTaGFyZVNjb3BlTWFwW3JlbW90ZUluc0lkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZERlbGV0ZUtleXMuZm9yRWFjaCgocmVmKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDQpLCBpbnNJZCA9IF9yZWZbMF0sIHNoYXJlU2NvcGUgPSBfcmVmWzFdLCBzaGFyZU5hbWUgPSBfcmVmWzJdLCBzaGFyZVZlcnNpb24gPSBfcmVmWzNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZV9zaGFyZU5hbWUsIF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkX3NoYXJlU2NvcGUsIF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWQgPSBnbG9iYWxTaGFyZVNjb3BlTWFwW2luc0lkXSkgPT0gbnVsbCA/IHRydWUgOiAoX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZSA9IF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkW3NoYXJlU2NvcGVdKSA9PSBudWxsID8gdHJ1ZSA6IChfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZF9zaGFyZVNjb3BlX3NoYXJlTmFtZSA9IF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkX3NoYXJlU2NvcGVbc2hhcmVOYW1lXSkgPT0gbnVsbCA/IHRydWUgOiBkZWxldGUgX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZV9zaGFyZU5hbWVbc2hhcmVWZXJzaW9uXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX18uc3BsaWNlKHJlbW90ZUluc0luZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBob3N0R2xvYmFsU25hcHNob3QgPSBnZXRHbG9iYWxSZW1vdGVJbmZvKHJlbW90ZSwgaG9zdCkuaG9zdEdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhvc3RHbG9iYWxTbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVLZXkgPSBob3N0R2xvYmFsU25hcHNob3QgJiYgJ3JlbW90ZXNJbmZvJyBpbiBob3N0R2xvYmFsU25hcHNob3QgJiYgaG9zdEdsb2JhbFNuYXBzaG90LnJlbW90ZXNJbmZvICYmIGdldEluZm9XaXRob3V0VHlwZShob3N0R2xvYmFsU25hcHNob3QucmVtb3Rlc0luZm8sIHJlbW90ZS5uYW1lKS5rZXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgaG9zdEdsb2JhbFNuYXBzaG90LnJlbW90ZXNJbmZvW3JlbW90ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX01BTklGRVNUX0xPQURJTkdfX1tyZW1vdGVLZXldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX01BTklGRVNUX0xPQURJTkdfX1tyZW1vdGVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5tb2R1bGVDYWNoZS5kZWxldGUocmVtb3RlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coJ3JlbW92ZVJlbW90ZSBmYWlsOiAnLCBlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBSZW1vdGVIYW5kbGVyO1xufSgpO1xudmFyIEZlZGVyYXRpb25Ib3N0ID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBGZWRlcmF0aW9uSG9zdCh1c2VyT3B0aW9ucykge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIEZlZGVyYXRpb25Ib3N0KTtcbiAgICAgICAgdGhpcy5ob29rcyA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYmVmb3JlSW5pdDogbmV3IFN5bmNXYXRlcmZhbGxIb29rKCdiZWZvcmVJbml0JyksXG4gICAgICAgICAgICBpbml0OiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIC8vIG1heWJlIHdpbGwgY2hhbmdlLCB0ZW1wb3JhcmlseSBmb3IgaW50ZXJuYWwgdXNlIG9ubHlcbiAgICAgICAgICAgIGJlZm9yZUluaXRDb250YWluZXI6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZUluaXRDb250YWluZXInKSxcbiAgICAgICAgICAgIC8vIG1heWJlIHdpbGwgY2hhbmdlLCB0ZW1wb3JhcmlseSBmb3IgaW50ZXJuYWwgdXNlIG9ubHlcbiAgICAgICAgICAgIGluaXRDb250YWluZXI6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2luaXRDb250YWluZXInKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gXCIwLjEwLjBcIjtcbiAgICAgICAgdGhpcy5tb2R1bGVDYWNoZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5sb2FkZXJIb29rID0gbmV3IFBsdWdpblN5c3RlbSh7XG4gICAgICAgICAgICAvLyBGSVhNRTogbWF5IG5vdCBiZSBzdWl0YWJsZSAsIG5vdCBvcGVuIHRvIHRoZSBwdWJsaWMgeWV0XG4gICAgICAgICAgICBnZXRNb2R1bGVJbmZvOiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGNyZWF0ZVNjcmlwdDogbmV3IFN5bmNIb29rKCksXG4gICAgICAgICAgICBjcmVhdGVMaW5rOiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGZldGNoOiBuZXcgQXN5bmNIb29rKCksXG4gICAgICAgICAgICBsb2FkRW50cnlFcnJvcjogbmV3IEFzeW5jSG9vaygpLFxuICAgICAgICAgICAgZ2V0TW9kdWxlRmFjdG9yeTogbmV3IEFzeW5jSG9vaygpXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJyaWRnZUhvb2sgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIGJlZm9yZUJyaWRnZVJlbmRlcjogbmV3IFN5bmNIb29rKCksXG4gICAgICAgICAgICBhZnRlckJyaWRnZVJlbmRlcjogbmV3IFN5bmNIb29rKCksXG4gICAgICAgICAgICBiZWZvcmVCcmlkZ2VEZXN0cm95OiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGFmdGVyQnJpZGdlRGVzdHJveTogbmV3IFN5bmNIb29rKClcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFRPRE86IFZhbGlkYXRlIHRoZSBkZXRhaWxzIG9mIHRoZSBvcHRpb25zXG4gICAgICAgIC8vIEluaXRpYWxpemUgb3B0aW9ucyB3aXRoIGRlZmF1bHQgdmFsdWVzXG4gICAgICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgICAgICAgIGlkOiBnZXRCdWlsZGVySWQoKSxcbiAgICAgICAgICAgIG5hbWU6IHVzZXJPcHRpb25zLm5hbWUsXG4gICAgICAgICAgICBwbHVnaW5zOiBbXG4gICAgICAgICAgICAgICAgc25hcHNob3RQbHVnaW4oKSxcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZVByZWxvYWRBc3NldHNQbHVnaW4oKVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHJlbW90ZXM6IFtdLFxuICAgICAgICAgICAgc2hhcmVkOiB7fSxcbiAgICAgICAgICAgIGluQnJvd3Nlcjogc2RrLmlzQnJvd3NlckVudigpXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubmFtZSA9IHVzZXJPcHRpb25zLm5hbWU7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICB0aGlzLnNuYXBzaG90SGFuZGxlciA9IG5ldyBTbmFwc2hvdEhhbmRsZXIodGhpcyk7XG4gICAgICAgIHRoaXMuc2hhcmVkSGFuZGxlciA9IG5ldyBTaGFyZWRIYW5kbGVyKHRoaXMpO1xuICAgICAgICB0aGlzLnJlbW90ZUhhbmRsZXIgPSBuZXcgUmVtb3RlSGFuZGxlcih0aGlzKTtcbiAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwID0gdGhpcy5zaGFyZWRIYW5kbGVyLnNoYXJlU2NvcGVNYXA7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJQbHVnaW5zKF90b19jb25zdW1hYmxlX2FycmF5Ll8oZGVmYXVsdE9wdGlvbnMucGx1Z2lucykuY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8odXNlck9wdGlvbnMucGx1Z2lucyB8fCBbXSkpKTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gdGhpcy5mb3JtYXRPcHRpb25zKGRlZmF1bHRPcHRpb25zLCB1c2VyT3B0aW9ucyk7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhGZWRlcmF0aW9uSG9zdCwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdE9wdGlvbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0T3B0aW9ucyh1c2VyT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJQbHVnaW5zKHVzZXJPcHRpb25zLnBsdWdpbnMpO1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5mb3JtYXRPcHRpb25zKHRoaXMub3B0aW9ucywgdXNlck9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2FkU2hhcmVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkU2hhcmUocGtnTmFtZSwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNoYXJlZEhhbmRsZXIubG9hZFNoYXJlKHBrZ05hbWUsIGV4dHJhT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVGhlIGxpYiBmdW5jdGlvbiB3aWxsIG9ubHkgYmUgYXZhaWxhYmxlIGlmIHRoZSBzaGFyZWQgc2V0IGJ5IGVhZ2VyIG9yIHJ1bnRpbWUgaW5pdCBpcyBzZXQgb3IgdGhlIHNoYXJlZCBpcyBzdWNjZXNzZnVsbHkgbG9hZGVkLlxuICAgICAgICAgICAgLy8gMS4gSWYgdGhlIGxvYWRlZCBzaGFyZWQgYWxyZWFkeSBleGlzdHMgZ2xvYmFsbHksIHRoZW4gaXQgd2lsbCBiZSByZXVzZWRcbiAgICAgICAgICAgIC8vIDIuIElmIGxpYiBleGlzdHMgaW4gbG9jYWwgc2hhcmVkLCBpdCB3aWxsIGJlIHVzZWQgZGlyZWN0bHlcbiAgICAgICAgICAgIC8vIDMuIElmIHRoZSBsb2NhbCBnZXQgcmV0dXJucyBzb21ldGhpbmcgb3RoZXIgdGhhbiBQcm9taXNlLCB0aGVuIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseVxuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVN5bmNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkU2hhcmVTeW5jKHBrZ05hbWUsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNoYXJlZEhhbmRsZXIubG9hZFNoYXJlU3luYyhwa2dOYW1lLCBleHRyYU9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdGlhbGl6ZVNoYXJpbmdcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplU2hhcmluZyhyZWYsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlTmFtZSA9IHJlZiA9PT0gdm9pZCAwID8gREVGQVVMVF9TQ09QRSA6IHJlZjtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zaGFyZWRIYW5kbGVyLmluaXRpYWxpemVTaGFyaW5nKHNoYXJlU2NvcGVOYW1lLCBleHRyYU9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFJhd0NvbnRhaW5lclwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRSYXdDb250YWluZXIobmFtZTEsIHVybCwgY29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBnZXRSZW1vdGVJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5OiB1cmxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gbmV3IE1vZHVsZSh7XG4gICAgICAgICAgICAgICAgICAgIGhvc3Q6IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm9cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBtb2R1bGUucmVtb3RlRW50cnlFeHBvcnRzID0gY29udGFpbmVyO1xuICAgICAgICAgICAgICAgIHRoaXMubW9kdWxlQ2FjaGUuc2V0KG5hbWUxLCBtb2R1bGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2FkUmVtb3RlXCIsXG4gICAgICAgICAgICB2YWx1ZTogLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1saW5lcy1wZXItZnVuY3Rpb25cbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbWVtYmVyLW9yZGVyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2FkUmVtb3RlKGlkLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZUhhbmRsZXIubG9hZFJlbW90ZShpZCwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInByZWxvYWRSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAgZnVuY3Rpb24gcHJlbG9hZFJlbW90ZShwcmVsb2FkT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVIYW5kbGVyLnByZWxvYWRSZW1vdGUocHJlbG9hZE9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0U2hhcmVTY29wZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRTaGFyZVNjb3BlTWFwKHNjb3BlTmFtZSwgc2hhcmVTY29wZSwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4dHJhT3B0aW9ucyA9IHJlZiA9PT0gdm9pZCAwID8ge30gOiByZWY7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRIYW5kbGVyLmluaXRTaGFyZVNjb3BlTWFwKHNjb3BlTmFtZSwgc2hhcmVTY29wZSwgZXh0cmFPcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImZvcm1hdE9wdGlvbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JtYXRPcHRpb25zKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlZCA9IGZvcm1hdFNoYXJlQ29uZmlncyhnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucykuc2hhcmVkO1xuICAgICAgICAgICAgICAgIHZhciBfdGhpc19ob29rc19saWZlY3ljbGVfYmVmb3JlSW5pdF9lbWl0ID0gdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlSW5pdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICB1c2VyT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogZ2xvYmFsT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvOiBzaGFyZWRcbiAgICAgICAgICAgICAgICB9KSwgdXNlck9wdGlvbnNSZXMgPSBfdGhpc19ob29rc19saWZlY3ljbGVfYmVmb3JlSW5pdF9lbWl0LnVzZXJPcHRpb25zLCBnbG9iYWxPcHRpb25zUmVzID0gX3RoaXNfaG9va3NfbGlmZWN5Y2xlX2JlZm9yZUluaXRfZW1pdC5vcHRpb25zO1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVzID0gdGhpcy5yZW1vdGVIYW5kbGVyLmZvcm1hdEFuZFJlZ2lzdGVyUmVtb3RlKGdsb2JhbE9wdGlvbnNSZXMsIHVzZXJPcHRpb25zUmVzKTtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXNfc2hhcmVkSGFuZGxlcl9yZWdpc3RlclNoYXJlZCA9IHRoaXMuc2hhcmVkSGFuZGxlci5yZWdpc3RlclNoYXJlZChnbG9iYWxPcHRpb25zUmVzLCB1c2VyT3B0aW9uc1JlcyksIGhhbmRsZWRTaGFyZWQgPSBfdGhpc19zaGFyZWRIYW5kbGVyX3JlZ2lzdGVyU2hhcmVkLnNoYXJlZDtcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2lucyA9IF90b19jb25zdW1hYmxlX2FycmF5Ll8oZ2xvYmFsT3B0aW9uc1Jlcy5wbHVnaW5zKTtcbiAgICAgICAgICAgICAgICBpZiAodXNlck9wdGlvbnNSZXMucGx1Z2lucykge1xuICAgICAgICAgICAgICAgICAgICB1c2VyT3B0aW9uc1Jlcy5wbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGx1Z2lucy5pbmNsdWRlcyhwbHVnaW4pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2lucy5wdXNoKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uc1JlcyA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgZ2xvYmFsT3B0aW9ucywgdXNlck9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2lucyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlcyxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkOiBoYW5kbGVkU2hhcmVkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuaW5pdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zUmVzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnNSZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZWdpc3RlclBsdWdpbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlclBsdWdpbnMxKHBsdWdpbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2luUmVzID0gcmVnaXN0ZXJQbHVnaW5zKHBsdWdpbnMsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ob29rcyxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdGVIYW5kbGVyLmhvb2tzLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZEhhbmRsZXIuaG9va3MsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc25hcHNob3RIYW5kbGVyLmhvb2tzLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRlckhvb2ssXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnJpZGdlSG9va1xuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIC8vIE1lcmdlIHBsdWdpblxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wbHVnaW5zID0gdGhpcy5vcHRpb25zLnBsdWdpbnMucmVkdWNlKChyZXMsIHBsdWdpbik9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwbHVnaW4pIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgIXJlcy5maW5kKChpdGVtKT0+aXRlbS5uYW1lID09PSBwbHVnaW4ubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9LCBwbHVnaW5SZXMgfHwgW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVnaXN0ZXJSZW1vdGVzXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJSZW1vdGVzKHJlbW90ZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVIYW5kbGVyLnJlZ2lzdGVyUmVtb3RlcyhyZW1vdGVzLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBGZWRlcmF0aW9uSG9zdDtcbn0oKTtcbnZhciBpbmRleCA9IC8qI19fUFVSRV9fKi8gT2JqZWN0LmZyZWV6ZSh7XG4gICAgX19wcm90b19fOiBudWxsXG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImxvYWRTY3JpcHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBzZGsubG9hZFNjcmlwdDtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJsb2FkU2NyaXB0Tm9kZVwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHNkay5sb2FkU2NyaXB0Tm9kZTtcbiAgICB9XG59KSk7XG5leHBvcnRzLkN1cnJlbnRHbG9iYWwgPSBDdXJyZW50R2xvYmFsO1xuZXhwb3J0cy5GZWRlcmF0aW9uSG9zdCA9IEZlZGVyYXRpb25Ib3N0O1xuZXhwb3J0cy5HbG9iYWwgPSBHbG9iYWw7XG5leHBvcnRzLk1vZHVsZSA9IE1vZHVsZTtcbmV4cG9ydHMuYWRkR2xvYmFsU25hcHNob3QgPSBhZGRHbG9iYWxTbmFwc2hvdDtcbmV4cG9ydHMuYXNzZXJ0ID0gYXNzZXJ0O1xuZXhwb3J0cy5nZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IgPSBnZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3I7XG5leHBvcnRzLmdldEdsb2JhbFNuYXBzaG90ID0gZ2V0R2xvYmFsU25hcHNob3Q7XG5leHBvcnRzLmdldEluZm9XaXRob3V0VHlwZSA9IGdldEluZm9XaXRob3V0VHlwZTtcbmV4cG9ydHMuZ2V0UmVnaXN0ZXJlZFNoYXJlID0gZ2V0UmVnaXN0ZXJlZFNoYXJlO1xuZXhwb3J0cy5nZXRSZW1vdGVFbnRyeSA9IGdldFJlbW90ZUVudHJ5O1xuZXhwb3J0cy5nZXRSZW1vdGVJbmZvID0gZ2V0UmVtb3RlSW5mbztcbmV4cG9ydHMuaGVscGVycyA9IGhlbHBlcnM7XG5leHBvcnRzLmlzU3RhdGljUmVzb3VyY2VzRXF1YWwgPSBpc1N0YXRpY1Jlc291cmNlc0VxdWFsO1xuZXhwb3J0cy5tYXRjaFJlbW90ZVdpdGhOYW1lQW5kRXhwb3NlID0gbWF0Y2hSZW1vdGVXaXRoTmFtZUFuZEV4cG9zZTtcbmV4cG9ydHMucmVnaXN0ZXJHbG9iYWxQbHVnaW5zID0gcmVnaXN0ZXJHbG9iYWxQbHVnaW5zO1xuZXhwb3J0cy5yZXNldEZlZGVyYXRpb25HbG9iYWxJbmZvID0gcmVzZXRGZWRlcmF0aW9uR2xvYmFsSW5mbztcbmV4cG9ydHMuc2FmZVdyYXBwZXIgPSBzYWZlV3JhcHBlcjtcbmV4cG9ydHMuc2F0aXNmeSA9IHNhdGlzZnk7XG5leHBvcnRzLnNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvciA9IHNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcjtcbmV4cG9ydHMuc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlID0gc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlO1xuZXhwb3J0cy50eXBlcyA9IGluZGV4O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvcG9seWZpbGxzLmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L3BvbHlmaWxscy5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gICAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQpIHtcbiAgICAgICAgZm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gc291cmNlKWlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbiAgICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIF9vYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzX2xvb3NlKHNvdXJjZSwgZXhjbHVkZWQpIHtcbiAgICBpZiAoc291cmNlID09IG51bGwpIHJldHVybiB7fTtcbiAgICB2YXIgdGFyZ2V0ID0ge307XG4gICAgdmFyIHNvdXJjZUtleXMgPSBPYmplY3Qua2V5cyhzb3VyY2UpO1xuICAgIHZhciBrZXksIGk7XG4gICAgZm9yKGkgPSAwOyBpIDwgc291cmNlS2V5cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIGtleSA9IHNvdXJjZUtleXNbaV07XG4gICAgICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7XG4gICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5leHBvcnRzLl9leHRlbmRzID0gX2V4dGVuZHM7XG5leHBvcnRzLl9vYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzX2xvb3NlID0gX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2U7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L2luZGV4LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgcnVudGltZUNvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbnZhciB1dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdXRpbHMuY2pzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvZGlzdC91dGlscy5janMuanNcIik7XG52YXIgRmVkZXJhdGlvbkluc3RhbmNlID0gbnVsbDtcbmZ1bmN0aW9uIGluaXQob3B0aW9ucykge1xuICAgIC8vIFJldHJpZXZlIHRoZSBzYW1lIGluc3RhbmNlIHdpdGggdGhlIHNhbWUgbmFtZVxuICAgIHZhciBpbnN0YW5jZSA9IHV0aWxzLmdldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZShvcHRpb25zLm5hbWUsIG9wdGlvbnMudmVyc2lvbik7XG4gICAgaWYgKCFpbnN0YW5jZSkge1xuICAgICAgICAvLyBSZXRyaWV2ZSBkZWJ1ZyBjb25zdHJ1Y3RvclxuICAgICAgICB2YXIgRmVkZXJhdGlvbkNvbnN0cnVjdG9yID0gcnVudGltZUNvcmUuZ2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yKCkgfHwgcnVudGltZUNvcmUuRmVkZXJhdGlvbkhvc3Q7XG4gICAgICAgIEZlZGVyYXRpb25JbnN0YW5jZSA9IG5ldyBGZWRlcmF0aW9uQ29uc3RydWN0b3Iob3B0aW9ucyk7XG4gICAgICAgIHJ1bnRpbWVDb3JlLnNldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZShGZWRlcmF0aW9uSW5zdGFuY2UpO1xuICAgICAgICByZXR1cm4gRmVkZXJhdGlvbkluc3RhbmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE1lcmdlIG9wdGlvbnNcbiAgICAgICAgaW5zdGFuY2UuaW5pdE9wdGlvbnMob3B0aW9ucyk7XG4gICAgICAgIGlmICghRmVkZXJhdGlvbkluc3RhbmNlKSB7XG4gICAgICAgICAgICBGZWRlcmF0aW9uSW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfVxufVxuZnVuY3Rpb24gbG9hZFJlbW90ZSguLi5hcmdzKSB7XG4gICAgcnVudGltZUNvcmUuYXNzZXJ0KEZlZGVyYXRpb25JbnN0YW5jZSwgJ1BsZWFzZSBjYWxsIGluaXQgZmlyc3QnKTtcbiAgICB2YXIgbG9hZFJlbW90ZTEgPSBGZWRlcmF0aW9uSW5zdGFuY2UubG9hZFJlbW90ZTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLXNwcmVhZFxuICAgIHJldHVybiBsb2FkUmVtb3RlMS5hcHBseShGZWRlcmF0aW9uSW5zdGFuY2UsIGFyZ3MpO1xufVxuZnVuY3Rpb24gbG9hZFNoYXJlKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgdmFyIGxvYWRTaGFyZTEgPSBGZWRlcmF0aW9uSW5zdGFuY2UubG9hZFNoYXJlO1xuICAgIHJldHVybiBsb2FkU2hhcmUxLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiBsb2FkU2hhcmVTeW5jKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIHZhciBsb2FkU2hhcmVTeW5jMSA9IEZlZGVyYXRpb25JbnN0YW5jZS5sb2FkU2hhcmVTeW5jO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIGxvYWRTaGFyZVN5bmMxLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiBwcmVsb2FkUmVtb3RlKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIEZlZGVyYXRpb25JbnN0YW5jZS5wcmVsb2FkUmVtb3RlLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiByZWdpc3RlclJlbW90ZXMoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICByZXR1cm4gRmVkZXJhdGlvbkluc3RhbmNlLnJlZ2lzdGVyUmVtb3Rlcy5hcHBseShGZWRlcmF0aW9uSW5zdGFuY2UsIGFyZ3MpO1xufVxuZnVuY3Rpb24gcmVnaXN0ZXJQbHVnaW5zKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIEZlZGVyYXRpb25JbnN0YW5jZS5yZWdpc3RlclBsdWdpbnMuYXBwbHkoRmVkZXJhdGlvbkluc3RhbmNlLCBhcmdzKTtcbn1cbmZ1bmN0aW9uIGdldEluc3RhbmNlKCkge1xuICAgIHJldHVybiBGZWRlcmF0aW9uSW5zdGFuY2U7XG59XG4vLyBJbmplY3QgZm9yIGRlYnVnXG5ydW50aW1lQ29yZS5zZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IocnVudGltZUNvcmUuRmVkZXJhdGlvbkhvc3QpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiRmVkZXJhdGlvbkhvc3RcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5GZWRlcmF0aW9uSG9zdDtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJNb2R1bGVcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5Nb2R1bGU7XG4gICAgfVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZ2V0UmVtb3RlRW50cnlcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5nZXRSZW1vdGVFbnRyeTtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJnZXRSZW1vdGVJbmZvXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcnVudGltZUNvcmUuZ2V0UmVtb3RlSW5mbztcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJsb2FkU2NyaXB0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcnVudGltZUNvcmUubG9hZFNjcmlwdDtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJsb2FkU2NyaXB0Tm9kZVwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLmxvYWRTY3JpcHROb2RlO1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInJlZ2lzdGVyR2xvYmFsUGx1Z2luc1wiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLnJlZ2lzdGVyR2xvYmFsUGx1Z2lucztcbiAgICB9XG59KSk7XG5leHBvcnRzLmdldEluc3RhbmNlID0gZ2V0SW5zdGFuY2U7XG5leHBvcnRzLmluaXQgPSBpbml0O1xuZXhwb3J0cy5sb2FkUmVtb3RlID0gbG9hZFJlbW90ZTtcbmV4cG9ydHMubG9hZFNoYXJlID0gbG9hZFNoYXJlO1xuZXhwb3J0cy5sb2FkU2hhcmVTeW5jID0gbG9hZFNoYXJlU3luYztcbmV4cG9ydHMucHJlbG9hZFJlbW90ZSA9IHByZWxvYWRSZW1vdGU7XG5leHBvcnRzLnJlZ2lzdGVyUGx1Z2lucyA9IHJlZ2lzdGVyUGx1Z2lucztcbmV4cG9ydHMucmVnaXN0ZXJSZW1vdGVzID0gcmVnaXN0ZXJSZW1vdGVzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L3V0aWxzLmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvZGlzdC91dGlscy5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIHJ1bnRpbWVDb3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lLWNvcmUvZGlzdC9pbmRleC5janMuanNcIik7XG4vLyBpbmplY3RlZCBieSBidW5kbGVyLCBzbyBpdCBjYW4gbm90IHVzZSBydW50aW1lLWNvcmUgc3R1ZmZcbmZ1bmN0aW9uIGdldEJ1aWxkZXJJZCgpIHtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICByZXR1cm4gIHRydWUgPyBcIm11c2ljczoxLjAuMFwiIDogMDtcbn1cbmZ1bmN0aW9uIGdldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZShuYW1lLCB2ZXJzaW9uKSB7XG4gICAgdmFyIGJ1aWxkSWQgPSBnZXRCdWlsZGVySWQoKTtcbiAgICByZXR1cm4gcnVudGltZUNvcmUuQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0lOU1RBTkNFU19fLmZpbmQoKEdNSW5zdGFuY2UpPT57XG4gICAgICAgIGlmIChidWlsZElkICYmIEdNSW5zdGFuY2Uub3B0aW9ucy5pZCA9PT0gZ2V0QnVpbGRlcklkKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChHTUluc3RhbmNlLm9wdGlvbnMubmFtZSA9PT0gbmFtZSAmJiAhR01JbnN0YW5jZS5vcHRpb25zLnZlcnNpb24gJiYgIXZlcnNpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChHTUluc3RhbmNlLm9wdGlvbnMubmFtZSA9PT0gbmFtZSAmJiB2ZXJzaW9uICYmIEdNSW5zdGFuY2Uub3B0aW9ucy52ZXJzaW9uID09PSB2ZXJzaW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG59XG5leHBvcnRzLmdldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZSA9IGdldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L2luZGV4LmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vc2RrL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIF9jbGFzc19jYWxsX2NoZWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NsYXNzX2NhbGxfY2hlY2sgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqc1wiKTtcbnZhciBfY3JlYXRlX2NsYXNzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NyZWF0ZV9jbGFzcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janNcIik7XG52YXIgX3NsaWNlZF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19zbGljZWRfdG9fYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL190b19hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2FycmF5LmNqc1wiKTtcbnZhciBfdG9fY29uc3VtYWJsZV9hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL190b19jb25zdW1hYmxlX2FycmF5ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fY29uc3VtYWJsZV9hcnJheS5janNcIik7XG52YXIgcG9seWZpbGxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9wb2x5ZmlsbHMuY2pzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L3BvbHlmaWxscy5janMuanNcIik7XG52YXIgRmVkZXJhdGlvbk1vZHVsZU1hbmlmZXN0ID0gJ2ZlZGVyYXRpb24tbWFuaWZlc3QuanNvbic7XG52YXIgTUFOSUZFU1RfRVhUID0gJy5qc29uJztcbnZhciBCUk9XU0VSX0xPR19LRVkgPSAnRkVERVJBVElPTl9ERUJVRyc7XG52YXIgQlJPV1NFUl9MT0dfVkFMVUUgPSAnMSc7XG52YXIgTmFtZVRyYW5zZm9ybVN5bWJvbCA9IHtcbiAgICBBVDogJ0AnLFxuICAgIEhZUEhFTjogJy0nLFxuICAgIFNMQVNIOiAnLydcbn07XG52YXIgTmFtZVRyYW5zZm9ybU1hcCA9IHtcbiAgICBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF06ICdzY29wZV8nLFxuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl06ICdfJyxcbiAgICBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF06ICdfXydcbn07XG52YXIgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXAgPSB7XG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF1dOiBOYW1lVHJhbnNmb3JtU3ltYm9sLkFULFxuICAgIFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXV06IE5hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOLFxuICAgIFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdXTogTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSFxufTtcbnZhciBTRVBBUkFUT1IgPSAnOic7XG52YXIgTWFuaWZlc3RGaWxlTmFtZSA9ICdtZi1tYW5pZmVzdC5qc29uJztcbnZhciBTdGF0c0ZpbGVOYW1lID0gJ21mLXN0YXRzLmpzb24nO1xudmFyIE1GTW9kdWxlVHlwZSA9IHtcbiAgICBOUE06ICducG0nLFxuICAgIEFQUDogJ2FwcCdcbn07XG52YXIgTU9EVUxFX0RFVlRPT0xfSURFTlRJRklFUiA9ICdfX01GX0RFVlRPT0xTX01PRFVMRV9JTkZPX18nO1xudmFyIEVOQ09ERV9OQU1FX1BSRUZJWCA9ICdFTkNPREVfTkFNRV9QUkVGSVgnO1xudmFyIFRFTVBfRElSID0gJy5mZWRlcmF0aW9uJztcbnZhciBNRlByZWZldGNoQ29tbW9uID0ge1xuICAgIGlkZW50aWZpZXI6ICdNRkRhdGFQcmVmZXRjaCcsXG4gICAgZ2xvYmFsS2V5OiAnX19QUkVGRVRDSF9fJyxcbiAgICBsaWJyYXJ5OiAnbWYtZGF0YS1wcmVmZXRjaCcsXG4gICAgZXhwb3J0c0tleTogJ19fUFJFRkVUQ0hfRVhQT1JUU19fJyxcbiAgICBmaWxlTmFtZTogJ2Jvb3RzdHJhcC5qcydcbn07XG52YXIgQ29udGFpbmVyUGx1Z2luID0gLyojX19QVVJFX18qLyBPYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGxcbn0pO1xudmFyIENvbnRhaW5lclJlZmVyZW5jZVBsdWdpbiA9IC8qI19fUFVSRV9fKi8gT2JqZWN0LmZyZWV6ZSh7XG4gICAgX19wcm90b19fOiBudWxsXG59KTtcbnZhciBNb2R1bGVGZWRlcmF0aW9uUGx1Z2luID0gLyojX19QVVJFX18qLyBPYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGxcbn0pO1xudmFyIFNoYXJlUGx1Z2luID0gLyojX19QVVJFX18qLyBPYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGxcbn0pO1xuZnVuY3Rpb24gaXNCcm93c2VyRW52KCkge1xuICAgIHJldHVybiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJztcbn1cbmZ1bmN0aW9uIGlzQnJvd3NlckRlYnVnKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmIChpc0Jyb3dzZXJFbnYoKSAmJiB3aW5kb3cubG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oQlJPV1NFUl9MT0dfS0VZKSA9PT0gQlJPV1NFUl9MT0dfVkFMVUU7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcjEpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBpc0RlYnVnTW9kZSgpIHtcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52WydGRURFUkFUSU9OX0RFQlVHJ10pIHtcbiAgICAgICAgcmV0dXJuIEJvb2xlYW4ocHJvY2Vzcy5lbnZbJ0ZFREVSQVRJT05fREVCVUcnXSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgRkVERVJBVElPTl9ERUJVRyAhPT0gJ3VuZGVmaW5lZCcgJiYgQm9vbGVhbihGRURFUkFUSU9OX0RFQlVHKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGlzQnJvd3NlckRlYnVnKCk7XG59XG52YXIgZ2V0UHJvY2Vzc0VudiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgcHJvY2Vzcy5lbnYgPyBwcm9jZXNzLmVudiA6IHt9O1xufTtcbnZhciBMT0dfQ0FURUdPUlkgPSAnWyBGZWRlcmF0aW9uIFJ1bnRpbWUgXSc7XG4vLyBlbnRyeTogbmFtZTp2ZXJzaW9uICAgdmVyc2lvbiA6IDEuMC4wIHwgXjEuMi4zXG4vLyBlbnRyeTogbmFtZTplbnRyeSAgZW50cnk6ICBodHRwczovL2xvY2FsaG9zdDo5MDAwL2ZlZGVyYXRpb24tbWFuaWZlc3QuanNvblxudmFyIHBhcnNlRW50cnkgPSAoc3RyLCBkZXZWZXJPclVybCwgcmVmKT0+e1xuICAgIHZhciBzZXBhcmF0b3IgPSByZWYgPT09IHZvaWQgMCA/IFNFUEFSQVRPUiA6IHJlZjtcbiAgICB2YXIgc3RyU3BsaXQgPSBzdHIuc3BsaXQoc2VwYXJhdG9yKTtcbiAgICB2YXIgZGV2VmVyc2lvbk9yVXJsID0gZ2V0UHJvY2Vzc0VudigpWydOT0RFX0VOViddID09PSAnZGV2ZWxvcG1lbnQnICYmIGRldlZlck9yVXJsO1xuICAgIHZhciBkZWZhdWx0VmVyc2lvbiA9ICcqJztcbiAgICB2YXIgaXNFbnRyeSA9IChzKT0+cy5zdGFydHNXaXRoKCdodHRwJykgfHwgcy5pbmNsdWRlcyhNQU5JRkVTVF9FWFQpO1xuICAgIC8vIENoZWNrIGlmIHRoZSBzdHJpbmcgc3RhcnRzIHdpdGggYSB0eXBlXG4gICAgaWYgKHN0clNwbGl0Lmxlbmd0aCA+PSAyKSB7XG4gICAgICAgIHZhciBfc3RyU3BsaXQgPSBfdG9fYXJyYXkuXyhzdHJTcGxpdCksIG5hbWUgPSBfc3RyU3BsaXRbMF0sIHZlcnNpb25PckVudHJ5QXJyID0gX3N0clNwbGl0LnNsaWNlKDEpO1xuICAgICAgICAvLyBAbmFtZUBtYW5pZmVzdC11cmwuanNvblxuICAgICAgICBpZiAoc3RyLnN0YXJ0c1dpdGgoc2VwYXJhdG9yKSkge1xuICAgICAgICAgICAgbmFtZSA9IHN0clNwbGl0LnNsaWNlKDAsIDIpLmpvaW4oc2VwYXJhdG9yKTtcbiAgICAgICAgICAgIHZlcnNpb25PckVudHJ5QXJyID0gW1xuICAgICAgICAgICAgICAgIGRldlZlcnNpb25PclVybCB8fCBzdHJTcGxpdC5zbGljZSgyKS5qb2luKHNlcGFyYXRvcilcbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZlcnNpb25PckVudHJ5ID0gZGV2VmVyc2lvbk9yVXJsIHx8IHZlcnNpb25PckVudHJ5QXJyLmpvaW4oc2VwYXJhdG9yKTtcbiAgICAgICAgaWYgKGlzRW50cnkodmVyc2lvbk9yRW50cnkpKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgZW50cnk6IHZlcnNpb25PckVudHJ5XG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gQXBwbHkgdmVyc2lvbiBydWxlXG4gICAgICAgICAgICAvLyBkZXZWZXJzaW9uT3JVcmwgPT4gaW5wdXRWZXJzaW9uID0+IGRlZmF1bHRWZXJzaW9uXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogdmVyc2lvbk9yRW50cnkgfHwgZGVmYXVsdFZlcnNpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHN0clNwbGl0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICB2YXIgX3N0clNwbGl0MSA9IF9zbGljZWRfdG9fYXJyYXkuXyhzdHJTcGxpdCwgMSksIG5hbWUxID0gX3N0clNwbGl0MVswXTtcbiAgICAgICAgaWYgKGRldlZlcnNpb25PclVybCAmJiBpc0VudHJ5KGRldlZlcnNpb25PclVybCkpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgZW50cnk6IGRldlZlcnNpb25PclVybFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICB2ZXJzaW9uOiBkZXZWZXJzaW9uT3JVcmwgfHwgZGVmYXVsdFZlcnNpb25cbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBgSW52YWxpZCBlbnRyeSB2YWx1ZTogJHtzdHJ9YDtcbiAgICB9XG59O1xudmFyIGNvbXBvc2VLZXlXaXRoU2VwYXJhdG9yID0gZnVuY3Rpb24oLi4uYXJncykge1xuICAgIGlmICghYXJncy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICByZXR1cm4gYXJncy5yZWR1Y2UoKHN1bSwgY3VyKT0+e1xuICAgICAgICBpZiAoIWN1cikge1xuICAgICAgICAgICAgcmV0dXJuIHN1bTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN1bSkge1xuICAgICAgICAgICAgcmV0dXJuIGN1cjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7c3VtfSR7U0VQQVJBVE9SfSR7Y3VyfWA7XG4gICAgfSwgJycpO1xufTtcbnZhciBlbmNvZGVOYW1lID0gZnVuY3Rpb24obmFtZSwgcmVmLCByZWYxKSB7XG4gICAgdmFyIHByZWZpeCA9IHJlZiA9PT0gdm9pZCAwID8gJycgOiByZWYsIHdpdGhFeHQgPSByZWYxID09PSB2b2lkIDAgPyBmYWxzZSA6IHJlZjE7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIGV4dCA9IHdpdGhFeHQgPyAnLmpzJyA6ICcnO1xuICAgICAgICByZXR1cm4gYCR7cHJlZml4fSR7bmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybVN5bWJvbC5BVH1gLCAnZycpLCBOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU59YCwgJ2cnKSwgTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIfWAsICdnJyksIE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF0pfSR7ZXh0fWA7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICB9XG59O1xudmFyIGRlY29kZU5hbWUgPSBmdW5jdGlvbihuYW1lLCBwcmVmaXgsIHdpdGhFeHQpIHtcbiAgICB0cnkge1xuICAgICAgICB2YXIgZGVjb2RlZE5hbWUgPSBuYW1lO1xuICAgICAgICBpZiAocHJlZml4KSB7XG4gICAgICAgICAgICBpZiAoIWRlY29kZWROYW1lLnN0YXJ0c1dpdGgocHJlZml4KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWNvZGVkTmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlY29kZWROYW1lID0gZGVjb2RlZE5hbWUucmVwbGFjZShuZXcgUmVnRXhwKHByZWZpeCwgJ2cnKSwgJycpO1xuICAgICAgICB9XG4gICAgICAgIGRlY29kZWROYW1lID0gZGVjb2RlZE5hbWUucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXV0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdfWAsICdnJyksIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF1dKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl1dKTtcbiAgICAgICAgaWYgKHdpdGhFeHQpIHtcbiAgICAgICAgICAgIGRlY29kZWROYW1lID0gZGVjb2RlZE5hbWUucmVwbGFjZSgnLmpzJywgJycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWNvZGVkTmFtZTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbn07XG52YXIgZ2VuZXJhdGVFeHBvc2VGaWxlbmFtZSA9IChleHBvc2VOYW1lLCB3aXRoRXh0KT0+e1xuICAgIGlmICghZXhwb3NlTmFtZSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIHZhciBleHBvc2UgPSBleHBvc2VOYW1lO1xuICAgIGlmIChleHBvc2UgPT09ICcuJykge1xuICAgICAgICBleHBvc2UgPSAnZGVmYXVsdF9leHBvcnQnO1xuICAgIH1cbiAgICBpZiAoZXhwb3NlLnN0YXJ0c1dpdGgoJy4vJykpIHtcbiAgICAgICAgZXhwb3NlID0gZXhwb3NlLnJlcGxhY2UoJy4vJywgJycpO1xuICAgIH1cbiAgICByZXR1cm4gZW5jb2RlTmFtZShleHBvc2UsICdfX2ZlZGVyYXRpb25fZXhwb3NlXycsIHdpdGhFeHQpO1xufTtcbnZhciBnZW5lcmF0ZVNoYXJlRmlsZW5hbWUgPSAocGtnTmFtZSwgd2l0aEV4dCk9PntcbiAgICBpZiAoIXBrZ05hbWUpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICByZXR1cm4gZW5jb2RlTmFtZShwa2dOYW1lLCAnX19mZWRlcmF0aW9uX3NoYXJlZF8nLCB3aXRoRXh0KTtcbn07XG52YXIgZ2V0UmVzb3VyY2VVcmwgPSAobW9kdWxlLCBzb3VyY2VVcmwpPT57XG4gICAgaWYgKCdnZXRQdWJsaWNQYXRoJyBpbiBtb2R1bGUpIHtcbiAgICAgICAgdmFyIHB1YmxpY1BhdGg7XG4gICAgICAgIGlmICghbW9kdWxlLmdldFB1YmxpY1BhdGguc3RhcnRzV2l0aCgnZnVuY3Rpb24nKSkge1xuICAgICAgICAgICAgcHVibGljUGF0aCA9IG5ldyBGdW5jdGlvbihtb2R1bGUuZ2V0UHVibGljUGF0aCkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHB1YmxpY1BhdGggPSBuZXcgRnVuY3Rpb24oJ3JldHVybiAnICsgbW9kdWxlLmdldFB1YmxpY1BhdGgpKCkoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7cHVibGljUGF0aH0ke3NvdXJjZVVybH1gO1xuICAgIH0gZWxzZSBpZiAoJ3B1YmxpY1BhdGgnIGluIG1vZHVsZSkge1xuICAgICAgICByZXR1cm4gYCR7bW9kdWxlLnB1YmxpY1BhdGh9JHtzb3VyY2VVcmx9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0Nhbm5vdCBnZXQgcmVzb3VyY2UgVVJMLiBJZiBpbiBkZWJ1ZyBtb2RlLCBwbGVhc2UgaWdub3JlLicsIG1vZHVsZSwgc291cmNlVXJsKTtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbn07XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xudmFyIGFzc2VydCA9IChjb25kaXRpb24sIG1zZyk9PntcbiAgICBpZiAoIWNvbmRpdGlvbikge1xuICAgICAgICBlcnJvcihtc2cpO1xuICAgIH1cbn07XG52YXIgZXJyb3IgPSAobXNnKT0+e1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtMT0dfQ0FURUdPUll9OiAke21zZ31gKTtcbn07XG52YXIgd2FybiA9IChtc2cpPT57XG4gICAgY29uc29sZS53YXJuKGAke0xPR19DQVRFR09SWX06ICR7bXNnfWApO1xufTtcbmZ1bmN0aW9uIHNhZmVUb1N0cmluZyhpbmZvKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGluZm8sIG51bGwsIDIpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbn1cbi8vIFJlZ0V4cCBmb3IgdmVyc2lvbiBzdHJpbmdcbnZhciBWRVJTSU9OX1BBVFRFUk5fUkVHRVhQID0gL14oW1xcZF49djw+fl18Wyp4WF0kKS87XG5mdW5jdGlvbiBpc1JlcXVpcmVkVmVyc2lvbihzdHIpIHtcbiAgICByZXR1cm4gVkVSU0lPTl9QQVRURVJOX1JFR0VYUC50ZXN0KHN0cik7XG59XG52YXIgc2ltcGxlSm9pblJlbW90ZUVudHJ5ID0gKHJQYXRoLCByTmFtZSk9PntcbiAgICBpZiAoIXJQYXRoKSB7XG4gICAgICAgIHJldHVybiByTmFtZTtcbiAgICB9XG4gICAgdmFyIHRyYW5zZm9ybVBhdGggPSAoc3RyKT0+e1xuICAgICAgICBpZiAoc3RyID09PSAnLicpIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyLnN0YXJ0c1dpdGgoJy4vJykpIHtcbiAgICAgICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgnLi8nLCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ci5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgIHZhciBzdHJXaXRob3V0U2xhc2ggPSBzdHIuc2xpY2UoMSk7XG4gICAgICAgICAgICBpZiAoc3RyV2l0aG91dFNsYXNoLmVuZHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyV2l0aG91dFNsYXNoLnNsaWNlKDAsIC0xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzdHJXaXRob3V0U2xhc2g7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICB9O1xuICAgIHZhciB0cmFuc2Zvcm1lZFBhdGggPSB0cmFuc2Zvcm1QYXRoKHJQYXRoKTtcbiAgICBpZiAoIXRyYW5zZm9ybWVkUGF0aCkge1xuICAgICAgICByZXR1cm4gck5hbWU7XG4gICAgfVxuICAgIGlmICh0cmFuc2Zvcm1lZFBhdGguZW5kc1dpdGgoJy8nKSkge1xuICAgICAgICByZXR1cm4gYCR7dHJhbnNmb3JtZWRQYXRofSR7ck5hbWV9YDtcbiAgICB9XG4gICAgcmV0dXJuIGAke3RyYW5zZm9ybWVkUGF0aH0vJHtyTmFtZX1gO1xufTtcbmZ1bmN0aW9uIGluZmVyQXV0b1B1YmxpY1BhdGgodXJsKSB7XG4gICAgcmV0dXJuIHVybC5yZXBsYWNlKC8jLiokLywgJycpLnJlcGxhY2UoL1xcPy4qJC8sICcnKS5yZXBsYWNlKC9cXC9bXlxcL10rJC8sICcvJyk7XG59XG4vLyBQcmlvcml0eTogb3ZlcnJpZGVzID4gcmVtb3Rlc1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1saW5lcy1wZXItZnVuY3Rpb25cbmZ1bmN0aW9uIGdlbmVyYXRlU25hcHNob3RGcm9tTWFuaWZlc3QobWFuaWZlc3QsIHJlZikge1xuICAgIHZhciBvcHRpb25zID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICB2YXIgX21hbmlmZXN0X21ldGFEYXRhLCBfbWFuaWZlc3RfbWV0YURhdGExO1xuICAgIHZhciBfb3B0aW9uc19yZW1vdGVzID0gb3B0aW9ucy5yZW1vdGVzLCByZW1vdGVzID0gX29wdGlvbnNfcmVtb3RlcyA9PT0gdm9pZCAwID8ge30gOiBfb3B0aW9uc19yZW1vdGVzLCBfb3B0aW9uc19vdmVycmlkZXMgPSBvcHRpb25zLm92ZXJyaWRlcywgb3ZlcnJpZGVzID0gX29wdGlvbnNfb3ZlcnJpZGVzID09PSB2b2lkIDAgPyB7fSA6IF9vcHRpb25zX292ZXJyaWRlcywgdmVyc2lvbiA9IG9wdGlvbnMudmVyc2lvbjtcbiAgICB2YXIgcmVtb3RlU25hcHNob3Q7XG4gICAgdmFyIGdldFB1YmxpY1BhdGggPSAoKT0+e1xuICAgICAgICBpZiAoJ3B1YmxpY1BhdGgnIGluIG1hbmlmZXN0Lm1ldGFEYXRhKSB7XG4gICAgICAgICAgICBpZiAobWFuaWZlc3QubWV0YURhdGEucHVibGljUGF0aCA9PT0gJ2F1dG8nICYmIHZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAvLyB1c2Ugc2FtZSBpbXBsZW1lbnRhdGlvbiBhcyBwdWJsaWNQYXRoIGF1dG8gcnVudGltZSBtb2R1bGUgaW1wbGVtZW50c1xuICAgICAgICAgICAgICAgIHJldHVybiBpbmZlckF1dG9QdWJsaWNQYXRoKHZlcnNpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG1hbmlmZXN0Lm1ldGFEYXRhLnB1YmxpY1BhdGg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbWFuaWZlc3QubWV0YURhdGEuZ2V0UHVibGljUGF0aDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmFyIG92ZXJyaWRlc0tleXMgPSBPYmplY3Qua2V5cyhvdmVycmlkZXMpO1xuICAgIHZhciByZW1vdGVzSW5mbyA9IHt9O1xuICAgIC8vIElmIHJlbW90ZXMgYXJlIG5vdCBwcm92aWRlZCwgb25seSB0aGUgcmVtb3RlcyBpbiB0aGUgbWFuaWZlc3Qgd2lsbCBiZSByZWFkXG4gICAgaWYgKCFPYmplY3Qua2V5cyhyZW1vdGVzKS5sZW5ndGgpIHtcbiAgICAgICAgdmFyIF9tYW5pZmVzdF9yZW1vdGVzO1xuICAgICAgICByZW1vdGVzSW5mbyA9ICgoX21hbmlmZXN0X3JlbW90ZXMgPSBtYW5pZmVzdC5yZW1vdGVzKSA9PSBudWxsID8gdm9pZCAwIDogX21hbmlmZXN0X3JlbW90ZXMucmVkdWNlKChyZXMsIG5leHQpPT57XG4gICAgICAgICAgICB2YXIgbWF0Y2hlZFZlcnNpb247XG4gICAgICAgICAgICB2YXIgbmFtZSA9IG5leHQuZmVkZXJhdGlvbkNvbnRhaW5lck5hbWU7XG4gICAgICAgICAgICAvLyBvdmVycmlkZXMgaGF2ZSBoaWdoZXIgcHJpb3JpdHlcbiAgICAgICAgICAgIGlmIChvdmVycmlkZXNLZXlzLmluY2x1ZGVzKG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgbWF0Y2hlZFZlcnNpb24gPSBvdmVycmlkZXNbbmFtZV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICgndmVyc2lvbicgaW4gbmV4dCkge1xuICAgICAgICAgICAgICAgICAgICBtYXRjaGVkVmVyc2lvbiA9IG5leHQudmVyc2lvbjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtYXRjaGVkVmVyc2lvbiA9IG5leHQuZW50cnk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzW25hbWVdID0ge1xuICAgICAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSwge30pKSB8fCB7fTtcbiAgICB9XG4gICAgLy8gSWYgcmVtb3RlcyAoZGVwbG95IHNjZW5hcmlvKSBhcmUgc3BlY2lmaWVkLCB0aGV5IG5lZWQgdG8gYmUgdHJhdmVyc2VkIGFnYWluXG4gICAgT2JqZWN0LmtleXMocmVtb3RlcykuZm9yRWFjaCgoa2V5KT0+cmVtb3Rlc0luZm9ba2V5XSA9IHtcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlcyB3aWxsIG92ZXJyaWRlIGRlcGVuZGVuY2llc1xuICAgICAgICAgICAgbWF0Y2hlZFZlcnNpb246IG92ZXJyaWRlc0tleXMuaW5jbHVkZXMoa2V5KSA/IG92ZXJyaWRlc1trZXldIDogcmVtb3Rlc1trZXldXG4gICAgICAgIH0pO1xuICAgIHZhciBfbWFuaWZlc3RfbWV0YURhdGEyID0gbWFuaWZlc3QubWV0YURhdGEsIF9tYW5pZmVzdF9tZXRhRGF0YV9yZW1vdGVFbnRyeSA9IF9tYW5pZmVzdF9tZXRhRGF0YTIucmVtb3RlRW50cnksIHJlbW90ZUVudHJ5UGF0aCA9IF9tYW5pZmVzdF9tZXRhRGF0YV9yZW1vdGVFbnRyeS5wYXRoLCByZW1vdGVFbnRyeU5hbWUgPSBfbWFuaWZlc3RfbWV0YURhdGFfcmVtb3RlRW50cnkubmFtZSwgcmVtb3RlRW50cnlUeXBlID0gX21hbmlmZXN0X21ldGFEYXRhX3JlbW90ZUVudHJ5LnR5cGUsIHJlbW90ZVR5cGVzID0gX21hbmlmZXN0X21ldGFEYXRhMi50eXBlcywgYnVpbGRWZXJzaW9uID0gX21hbmlmZXN0X21ldGFEYXRhMi5idWlsZEluZm8uYnVpbGRWZXJzaW9uLCBnbG9iYWxOYW1lID0gX21hbmlmZXN0X21ldGFEYXRhMi5nbG9iYWxOYW1lLCBzc3JSZW1vdGVFbnRyeSA9IF9tYW5pZmVzdF9tZXRhRGF0YTIuc3NyUmVtb3RlRW50cnk7XG4gICAgdmFyIGV4cG9zZXMgPSBtYW5pZmVzdC5leHBvc2VzO1xuICAgIHZhciBiYXNpY1JlbW90ZVNuYXBzaG90ID0ge1xuICAgICAgICB2ZXJzaW9uOiB2ZXJzaW9uID8gdmVyc2lvbiA6ICcnLFxuICAgICAgICBidWlsZFZlcnNpb24sXG4gICAgICAgIGdsb2JhbE5hbWUsXG4gICAgICAgIHJlbW90ZUVudHJ5OiBzaW1wbGVKb2luUmVtb3RlRW50cnkocmVtb3RlRW50cnlQYXRoLCByZW1vdGVFbnRyeU5hbWUpLFxuICAgICAgICByZW1vdGVFbnRyeVR5cGUsXG4gICAgICAgIHJlbW90ZVR5cGVzOiBzaW1wbGVKb2luUmVtb3RlRW50cnkocmVtb3RlVHlwZXMucGF0aCwgcmVtb3RlVHlwZXMubmFtZSksXG4gICAgICAgIHJlbW90ZVR5cGVzWmlwOiByZW1vdGVUeXBlcy56aXAgfHwgJycsXG4gICAgICAgIHJlbW90ZVR5cGVzQVBJOiByZW1vdGVUeXBlcy5hcGkgfHwgJycsXG4gICAgICAgIHJlbW90ZXNJbmZvLFxuICAgICAgICBzaGFyZWQ6IG1hbmlmZXN0ID09IG51bGwgPyB2b2lkIDAgOiBtYW5pZmVzdC5zaGFyZWQubWFwKChpdGVtKT0+KHtcbiAgICAgICAgICAgICAgICBhc3NldHM6IGl0ZW0uYXNzZXRzLFxuICAgICAgICAgICAgICAgIHNoYXJlZE5hbWU6IGl0ZW0ubmFtZSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBpdGVtLnZlcnNpb25cbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgbW9kdWxlczogZXhwb3NlcyA9PSBudWxsID8gdm9pZCAwIDogZXhwb3Nlcy5tYXAoKGV4cG9zZSk9Pih7XG4gICAgICAgICAgICAgICAgbW9kdWxlTmFtZTogZXhwb3NlLm5hbWUsXG4gICAgICAgICAgICAgICAgbW9kdWxlUGF0aDogZXhwb3NlLnBhdGgsXG4gICAgICAgICAgICAgICAgYXNzZXRzOiBleHBvc2UuYXNzZXRzXG4gICAgICAgICAgICB9KSlcbiAgICB9O1xuICAgIGlmICgoX21hbmlmZXN0X21ldGFEYXRhID0gbWFuaWZlc3QubWV0YURhdGEpID09IG51bGwgPyB2b2lkIDAgOiBfbWFuaWZlc3RfbWV0YURhdGEucHJlZmV0Y2hJbnRlcmZhY2UpIHtcbiAgICAgICAgdmFyIHByZWZldGNoSW50ZXJmYWNlID0gbWFuaWZlc3QubWV0YURhdGEucHJlZmV0Y2hJbnRlcmZhY2U7XG4gICAgICAgIGJhc2ljUmVtb3RlU25hcHNob3QgPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGJhc2ljUmVtb3RlU25hcHNob3QsIHtcbiAgICAgICAgICAgIHByZWZldGNoSW50ZXJmYWNlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoKF9tYW5pZmVzdF9tZXRhRGF0YTEgPSBtYW5pZmVzdC5tZXRhRGF0YSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9tYW5pZmVzdF9tZXRhRGF0YTEucHJlZmV0Y2hFbnRyeSkge1xuICAgICAgICB2YXIgX21hbmlmZXN0X21ldGFEYXRhX3ByZWZldGNoRW50cnkgPSBtYW5pZmVzdC5tZXRhRGF0YS5wcmVmZXRjaEVudHJ5LCBwYXRoID0gX21hbmlmZXN0X21ldGFEYXRhX3ByZWZldGNoRW50cnkucGF0aCwgbmFtZSA9IF9tYW5pZmVzdF9tZXRhRGF0YV9wcmVmZXRjaEVudHJ5Lm5hbWUsIHR5cGUgPSBfbWFuaWZlc3RfbWV0YURhdGFfcHJlZmV0Y2hFbnRyeS50eXBlO1xuICAgICAgICBiYXNpY1JlbW90ZVNuYXBzaG90ID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBiYXNpY1JlbW90ZVNuYXBzaG90LCB7XG4gICAgICAgICAgICBwcmVmZXRjaEVudHJ5OiBzaW1wbGVKb2luUmVtb3RlRW50cnkocGF0aCwgbmFtZSksXG4gICAgICAgICAgICBwcmVmZXRjaEVudHJ5VHlwZTogdHlwZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCdwdWJsaWNQYXRoJyBpbiBtYW5pZmVzdC5tZXRhRGF0YSkge1xuICAgICAgICByZW1vdGVTbmFwc2hvdCA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgYmFzaWNSZW1vdGVTbmFwc2hvdCwge1xuICAgICAgICAgICAgcHVibGljUGF0aDogZ2V0UHVibGljUGF0aCgpXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJlbW90ZVNuYXBzaG90ID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBiYXNpY1JlbW90ZVNuYXBzaG90LCB7XG4gICAgICAgICAgICBnZXRQdWJsaWNQYXRoOiBnZXRQdWJsaWNQYXRoKClcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChzc3JSZW1vdGVFbnRyeSkge1xuICAgICAgICB2YXIgZnVsbFNTUlJlbW90ZUVudHJ5ID0gc2ltcGxlSm9pblJlbW90ZUVudHJ5KHNzclJlbW90ZUVudHJ5LnBhdGgsIHNzclJlbW90ZUVudHJ5Lm5hbWUpO1xuICAgICAgICByZW1vdGVTbmFwc2hvdC5zc3JSZW1vdGVFbnRyeSA9IGZ1bGxTU1JSZW1vdGVFbnRyeTtcbiAgICAgICAgcmVtb3RlU25hcHNob3Quc3NyUmVtb3RlRW50cnlUeXBlID0gc3NyUmVtb3RlRW50cnkudHlwZSB8fCAnY29tbW9uanMtbW9kdWxlJztcbiAgICB9XG4gICAgcmV0dXJuIHJlbW90ZVNuYXBzaG90O1xufVxuZnVuY3Rpb24gaXNNYW5pZmVzdFByb3ZpZGVyKG1vZHVsZUluZm8pIHtcbiAgICBpZiAoJ3JlbW90ZUVudHJ5JyBpbiBtb2R1bGVJbmZvICYmIG1vZHVsZUluZm8ucmVtb3RlRW50cnkuaW5jbHVkZXMoTUFOSUZFU1RfRVhUKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxudmFyIFBSRUZJWCA9ICdbIE1vZHVsZSBGZWRlcmF0aW9uIF0nO1xudmFyIExvZ2dlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gTG9nZ2VyMShwcmVmaXgpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBMb2dnZXIxKTtcbiAgICAgICAgdGhpcy5wcmVmaXggPSBwcmVmaXg7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhMb2dnZXIxLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2dcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2coLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJ3YXJuXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd2FybjEoLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJlcnJvclwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGVycm9yMSguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInN1Y2Nlc3NcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdWNjZXNzKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5mb1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluZm8oLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZWFkeVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWR5KC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZGVidWdcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZWJ1ZyguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzRGVidWdNb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gTG9nZ2VyMTtcbn0oKTtcbmZ1bmN0aW9uIGNyZWF0ZUxvZ2dlcihwcmVmaXgpIHtcbiAgICByZXR1cm4gbmV3IExvZ2dlcihwcmVmaXgpO1xufVxudmFyIGxvZ2dlciA9IGNyZWF0ZUxvZ2dlcihQUkVGSVgpO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmZ1bmN0aW9uIHNhZmVXcmFwcGVyKGNhbGxiYWNrLCBkaXNhYmxlV2Fybikge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAhZGlzYWJsZVdhcm4gJiYgd2FybihlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pKCk7XG59XG5mdW5jdGlvbiBpc1N0YXRpY1Jlc291cmNlc0VxdWFsKHVybDEsIHVybDIpIHtcbiAgICB2YXIgUkVHX0VYUCA9IC9eKGh0dHBzPzopP1xcL1xcLy9pO1xuICAgIC8vIFRyYW5zZm9ybSB1cmwxIGFuZCB1cmwyIGludG8gcmVsYXRpdmUgcGF0aHNcbiAgICB2YXIgcmVsYXRpdmVVcmwxID0gdXJsMS5yZXBsYWNlKFJFR19FWFAsICcnKS5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgIHZhciByZWxhdGl2ZVVybDIgPSB1cmwyLnJlcGxhY2UoUkVHX0VYUCwgJycpLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gICAgLy8gQ2hlY2sgaWYgdGhlIHJlbGF0aXZlIHBhdGhzIGFyZSBpZGVudGljYWxcbiAgICByZXR1cm4gcmVsYXRpdmVVcmwxID09PSByZWxhdGl2ZVVybDI7XG59XG5mdW5jdGlvbiBjcmVhdGVTY3JpcHQoaW5mbykge1xuICAgIC8vIFJldHJpZXZlIHRoZSBleGlzdGluZyBzY3JpcHQgZWxlbWVudCBieSBpdHMgc3JjIGF0dHJpYnV0ZVxuICAgIHZhciBzY3JpcHQgPSBudWxsO1xuICAgIHZhciBuZWVkQXR0YWNoID0gdHJ1ZTtcbiAgICB2YXIgdGltZW91dCA9IDIwMDAwO1xuICAgIHZhciB0aW1lb3V0SWQ7XG4gICAgdmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0Jyk7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHNjcmlwdHMubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgcyA9IHNjcmlwdHNbaV07XG4gICAgICAgIHZhciBzY3JpcHRTcmMgPSBzLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgICAgIGlmIChzY3JpcHRTcmMgJiYgaXNTdGF0aWNSZXNvdXJjZXNFcXVhbChzY3JpcHRTcmMsIGluZm8udXJsKSkge1xuICAgICAgICAgICAgc2NyaXB0ID0gcztcbiAgICAgICAgICAgIG5lZWRBdHRhY2ggPSBmYWxzZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghc2NyaXB0KSB7XG4gICAgICAgIHZhciBhdHRycyA9IGluZm8uYXR0cnM7XG4gICAgICAgIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICBzY3JpcHQudHlwZSA9IChhdHRycyA9PSBudWxsID8gdm9pZCAwIDogYXR0cnNbJ3R5cGUnXSkgPT09ICdtb2R1bGUnID8gJ21vZHVsZScgOiAndGV4dC9qYXZhc2NyaXB0JztcbiAgICAgICAgdmFyIGNyZWF0ZVNjcmlwdFJlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGluZm8uY3JlYXRlU2NyaXB0SG9vaykge1xuICAgICAgICAgICAgY3JlYXRlU2NyaXB0UmVzID0gaW5mby5jcmVhdGVTY3JpcHRIb29rKGluZm8udXJsLCBpbmZvLmF0dHJzKTtcbiAgICAgICAgICAgIGlmIChjcmVhdGVTY3JpcHRSZXMgaW5zdGFuY2VvZiBIVE1MU2NyaXB0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHNjcmlwdCA9IGNyZWF0ZVNjcmlwdFJlcztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNyZWF0ZVNjcmlwdFJlcyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoJ3NjcmlwdCcgaW4gY3JlYXRlU2NyaXB0UmVzICYmIGNyZWF0ZVNjcmlwdFJlcy5zY3JpcHQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NyaXB0ID0gY3JlYXRlU2NyaXB0UmVzLnNjcmlwdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCd0aW1lb3V0JyBpbiBjcmVhdGVTY3JpcHRSZXMgJiYgY3JlYXRlU2NyaXB0UmVzLnRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IGNyZWF0ZVNjcmlwdFJlcy50aW1lb3V0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNjcmlwdC5zcmMpIHtcbiAgICAgICAgICAgIHNjcmlwdC5zcmMgPSBpbmZvLnVybDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXR0cnMgJiYgIWNyZWF0ZVNjcmlwdFJlcykge1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoYXR0cnMpLmZvckVhY2goKG5hbWUpPT57XG4gICAgICAgICAgICAgICAgaWYgKHNjcmlwdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gJ2FzeW5jJyB8fCBuYW1lID09PSAnZGVmZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRbbmFtZV0gPSBhdHRyc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQXR0cmlidXRlcyB0aGF0IGRvIG5vdCBleGlzdCBhcmUgY29uc2lkZXJlZCBvdmVycmlkZGVuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXNjcmlwdC5nZXRBdHRyaWJ1dGUobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdC5zZXRBdHRyaWJ1dGUobmFtZSwgYXR0cnNbbmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIG9uU2NyaXB0Q29tcGxldGUgPSAocHJldiwgZXZlbnQpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICAgICAgICB2YXIgb25TY3JpcHRDb21wbGV0ZUNhbGxiYWNrID0gKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoKGV2ZW50ID09IG51bGwgPyB2b2lkIDAgOiBldmVudC50eXBlKSA9PT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgICAgICAgICAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5vbkVycm9yQ2FsbGJhY2spICYmIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLm9uRXJyb3JDYWxsYmFjayhldmVudCkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLmNiKSAmJiAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5jYigpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gUHJldmVudCBtZW1vcnkgbGVha3MgaW4gSUUuXG4gICAgICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgc2NyaXB0Lm9uZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIHNjcmlwdC5vbmxvYWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHNhZmVXcmFwcGVyKCgpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBfaW5mb19uZWVkRGVsZXRlU2NyaXB0ID0gaW5mby5uZWVkRGVsZXRlU2NyaXB0LCBuZWVkRGVsZXRlU2NyaXB0ID0gX2luZm9fbmVlZERlbGV0ZVNjcmlwdCA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9pbmZvX25lZWREZWxldGVTY3JpcHQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZWVkRGVsZXRlU2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAoc2NyaXB0ID09IG51bGwgPyB2b2lkIDAgOiBzY3JpcHQucGFyZW50Tm9kZSkgJiYgc2NyaXB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2ICYmIHR5cGVvZiBwcmV2ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBwcmV2KGV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB5aWVsZCByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBvblNjcmlwdENvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgb25TY3JpcHRDb21wbGV0ZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb25TY3JpcHRDb21wbGV0ZUNhbGxiYWNrKCk7XG4gICAgICAgIH0pKCk7XG4gICAgc2NyaXB0Lm9uZXJyb3IgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9uZXJyb3IpO1xuICAgIHNjcmlwdC5vbmxvYWQgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9ubG9hZCk7XG4gICAgdGltZW91dElkID0gc2V0VGltZW91dCgoKT0+e1xuICAgICAgICBvblNjcmlwdENvbXBsZXRlKG51bGwsIG5ldyBFcnJvcihgUmVtb3RlIHNjcmlwdCBcIiR7aW5mby51cmx9XCIgdGltZS1vdXRlZC5gKSk7XG4gICAgfSwgdGltZW91dCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2NyaXB0LFxuICAgICAgICBuZWVkQXR0YWNoXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUxpbmsoaW5mbykge1xuICAgIC8vIDxsaW5rIHJlbD1cInByZWxvYWRcIiBocmVmPVwic2NyaXB0LmpzXCIgYXM9XCJzY3JpcHRcIj5cbiAgICAvLyBSZXRyaWV2ZSB0aGUgZXhpc3Rpbmcgc2NyaXB0IGVsZW1lbnQgYnkgaXRzIHNyYyBhdHRyaWJ1dGVcbiAgICB2YXIgbGluayA9IG51bGw7XG4gICAgdmFyIG5lZWRBdHRhY2ggPSB0cnVlO1xuICAgIHZhciBsaW5rcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdsaW5rJyk7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgdmFyIGwgPSBsaW5rc1tpXTtcbiAgICAgICAgdmFyIGxpbmtIcmVmID0gbC5nZXRBdHRyaWJ1dGUoJ2hyZWYnKTtcbiAgICAgICAgdmFyIGxpbmtSZWwgPSBsLmdldEF0dHJpYnV0ZSgncmVsJyk7XG4gICAgICAgIGlmIChsaW5rSHJlZiAmJiBpc1N0YXRpY1Jlc291cmNlc0VxdWFsKGxpbmtIcmVmLCBpbmZvLnVybCkgJiYgbGlua1JlbCA9PT0gaW5mby5hdHRyc1sncmVsJ10pIHtcbiAgICAgICAgICAgIGxpbmsgPSBsO1xuICAgICAgICAgICAgbmVlZEF0dGFjaCA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFsaW5rKSB7XG4gICAgICAgIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7XG4gICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgaW5mby51cmwpO1xuICAgICAgICB2YXIgY3JlYXRlTGlua1JlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIGF0dHJzID0gaW5mby5hdHRycztcbiAgICAgICAgaWYgKGluZm8uY3JlYXRlTGlua0hvb2spIHtcbiAgICAgICAgICAgIGNyZWF0ZUxpbmtSZXMgPSBpbmZvLmNyZWF0ZUxpbmtIb29rKGluZm8udXJsLCBhdHRycyk7XG4gICAgICAgICAgICBpZiAoY3JlYXRlTGlua1JlcyBpbnN0YW5jZW9mIEhUTUxMaW5rRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGxpbmsgPSBjcmVhdGVMaW5rUmVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChhdHRycyAmJiAhY3JlYXRlTGlua1Jlcykge1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoYXR0cnMpLmZvckVhY2goKG5hbWUpPT57XG4gICAgICAgICAgICAgICAgaWYgKGxpbmsgJiYgIWxpbmsuZ2V0QXR0cmlidXRlKG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKG5hbWUsIGF0dHJzW25hbWVdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgb25MaW5rQ29tcGxldGUgPSAocHJldiwgZXZlbnQpPT57XG4gICAgICAgIHZhciBvbkxpbmtDb21wbGV0ZUNhbGxiYWNrID0gKCk9PntcbiAgICAgICAgICAgIGlmICgoZXZlbnQgPT0gbnVsbCA/IHZvaWQgMCA6IGV2ZW50LnR5cGUpID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgICAgICAgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8ub25FcnJvckNhbGxiYWNrKSAmJiAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5vbkVycm9yQ2FsbGJhY2soZXZlbnQpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8uY2IpICYmIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLmNiKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBQcmV2ZW50IG1lbW9yeSBsZWFrcyBpbiBJRS5cbiAgICAgICAgaWYgKGxpbmspIHtcbiAgICAgICAgICAgIGxpbmsub25lcnJvciA9IG51bGw7XG4gICAgICAgICAgICBsaW5rLm9ubG9hZCA9IG51bGw7XG4gICAgICAgICAgICBzYWZlV3JhcHBlcigoKT0+e1xuICAgICAgICAgICAgICAgIHZhciBfaW5mb19uZWVkRGVsZXRlTGluayA9IGluZm8ubmVlZERlbGV0ZUxpbmssIG5lZWREZWxldGVMaW5rID0gX2luZm9fbmVlZERlbGV0ZUxpbmsgPT09IHZvaWQgMCA/IHRydWUgOiBfaW5mb19uZWVkRGVsZXRlTGluaztcbiAgICAgICAgICAgICAgICBpZiAobmVlZERlbGV0ZUxpbmspIHtcbiAgICAgICAgICAgICAgICAgICAgKGxpbmsgPT0gbnVsbCA/IHZvaWQgMCA6IGxpbmsucGFyZW50Tm9kZSkgJiYgbGluay5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGxpbmspO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHByZXYpIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgIHZhciByZXMgPSBwcmV2KGV2ZW50KTtcbiAgICAgICAgICAgICAgICBvbkxpbmtDb21wbGV0ZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBvbkxpbmtDb21wbGV0ZUNhbGxiYWNrKCk7XG4gICAgfTtcbiAgICBsaW5rLm9uZXJyb3IgPSBvbkxpbmtDb21wbGV0ZS5iaW5kKG51bGwsIGxpbmsub25lcnJvcik7XG4gICAgbGluay5vbmxvYWQgPSBvbkxpbmtDb21wbGV0ZS5iaW5kKG51bGwsIGxpbmsub25sb2FkKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBsaW5rLFxuICAgICAgICBuZWVkQXR0YWNoXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGxvYWRTY3JpcHQodXJsLCBpbmZvKSB7XG4gICAgdmFyIF9pbmZvX2F0dHJzID0gaW5mby5hdHRycywgYXR0cnMgPSBfaW5mb19hdHRycyA9PT0gdm9pZCAwID8ge30gOiBfaW5mb19hdHRycywgY3JlYXRlU2NyaXB0SG9vayA9IGluZm8uY3JlYXRlU2NyaXB0SG9vaztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCk9PntcbiAgICAgICAgdmFyIF9jcmVhdGVTY3JpcHQgPSBjcmVhdGVTY3JpcHQoe1xuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgY2I6IHJlc29sdmUsXG4gICAgICAgICAgICBvbkVycm9yQ2FsbGJhY2s6IHJlamVjdCxcbiAgICAgICAgICAgIGF0dHJzOiBwb2x5ZmlsbHMuX2V4dGVuZHMoe1xuICAgICAgICAgICAgICAgIGZldGNocHJpb3JpdHk6ICdoaWdoJ1xuICAgICAgICAgICAgfSwgYXR0cnMpLFxuICAgICAgICAgICAgY3JlYXRlU2NyaXB0SG9vayxcbiAgICAgICAgICAgIG5lZWREZWxldGVTY3JpcHQ6IHRydWVcbiAgICAgICAgfSksIHNjcmlwdCA9IF9jcmVhdGVTY3JpcHQuc2NyaXB0LCBuZWVkQXR0YWNoID0gX2NyZWF0ZVNjcmlwdC5uZWVkQXR0YWNoO1xuICAgICAgICBuZWVkQXR0YWNoICYmIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGltcG9ydE5vZGVNb2R1bGUobmFtZSkge1xuICAgIGlmICghbmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ltcG9ydCBzcGVjaWZpZXIgaXMgcmVxdWlyZWQnKTtcbiAgICB9XG4gICAgdmFyIGltcG9ydE1vZHVsZSA9IG5ldyBGdW5jdGlvbignbmFtZScsIGByZXR1cm4gaW1wb3J0KG5hbWUpYCk7XG4gICAgcmV0dXJuIGltcG9ydE1vZHVsZShuYW1lKS50aGVuKChyZXMpPT5yZXMpLmNhdGNoKChlcnJvcjEpPT57XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGltcG9ydGluZyBtb2R1bGUgJHtuYW1lfTpgLCBlcnJvcjEpO1xuICAgICAgICB0aHJvdyBlcnJvcjE7XG4gICAgfSk7XG59XG52YXIgbG9hZE5vZGVGZXRjaCA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICB2YXIgZmV0Y2hNb2R1bGUgPSB5aWVsZCBpbXBvcnROb2RlTW9kdWxlKCdub2RlLWZldGNoJyk7XG4gICAgICAgIHJldHVybiBmZXRjaE1vZHVsZS5kZWZhdWx0IHx8IGZldGNoTW9kdWxlO1xuICAgIH0pKCk7XG52YXIgbGF6eUxvYWRlckhvb2tGZXRjaCA9IChpbnB1dCwgaW5pdCwgbG9hZGVySG9vayk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHZhciBob29rID0gKHVybCwgaW5pdCk9PntcbiAgICAgICAgICAgIHJldHVybiBsb2FkZXJIb29rLmxpZmVjeWNsZS5mZXRjaC5lbWl0KHVybCwgaW5pdCk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXMgPSB5aWVsZCBob29rKGlucHV0LCBpbml0IHx8IHt9KTtcbiAgICAgICAgaWYgKCFyZXMgfHwgIShyZXMgaW5zdGFuY2VvZiBSZXNwb25zZSkpIHtcbiAgICAgICAgICAgIHZhciBmZXRjaEZ1bmN0aW9uID0gdHlwZW9mIGZldGNoID09PSAndW5kZWZpbmVkJyA/IHlpZWxkIGxvYWROb2RlRmV0Y2goKSA6IGZldGNoO1xuICAgICAgICAgICAgcmV0dXJuIGZldGNoRnVuY3Rpb24oaW5wdXQsIGluaXQgfHwge30pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfSkoKTtcbmZ1bmN0aW9uIGNyZWF0ZVNjcmlwdE5vZGUodXJsLCBjYiwgYXR0cnMsIGxvYWRlckhvb2spIHtcbiAgICBpZiAobG9hZGVySG9vayA9PSBudWxsID8gdm9pZCAwIDogbG9hZGVySG9vay5jcmVhdGVTY3JpcHRIb29rKSB7XG4gICAgICAgIHZhciBob29rUmVzdWx0ID0gbG9hZGVySG9vay5jcmVhdGVTY3JpcHRIb29rKHVybCk7XG4gICAgICAgIGlmIChob29rUmVzdWx0ICYmIHR5cGVvZiBob29rUmVzdWx0ID09PSAnb2JqZWN0JyAmJiAndXJsJyBpbiBob29rUmVzdWx0KSB7XG4gICAgICAgICAgICB1cmwgPSBob29rUmVzdWx0LnVybDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgdXJsT2JqO1xuICAgIHRyeSB7XG4gICAgICAgIHVybE9iaiA9IG5ldyBVUkwodXJsKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNvbnN0cnVjdGluZyBVUkw6JywgZSk7XG4gICAgICAgIGNiKG5ldyBFcnJvcihgSW52YWxpZCBVUkw6ICR7ZX1gKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGdldEZldGNoID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICBpZiAobG9hZGVySG9vayA9PSBudWxsID8gdm9pZCAwIDogbG9hZGVySG9vay5mZXRjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoaW5wdXQsIGluaXQpPT5sYXp5TG9hZGVySG9va0ZldGNoKGlucHV0LCBpbml0LCBsb2FkZXJIb29rKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgZmV0Y2ggPT09ICd1bmRlZmluZWQnID8gbG9hZE5vZGVGZXRjaCgpIDogZmV0Y2g7XG4gICAgICAgIH0pKCk7XG4gICAgdmFyIGhhbmRsZVNjcmlwdEZldGNoID0gKGYsIHVybE9iaik9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBfdm1fY29uc3RhbnRzO1xuICAgICAgICAgICAgICAgIHZhciByZXMgPSB5aWVsZCBmKHVybE9iai5ocmVmKTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHlpZWxkIHJlcy50ZXh0KCk7XG4gICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8oKHlpZWxkIFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgICAgICAgICAgaW1wb3J0Tm9kZU1vZHVsZSgncGF0aCcpLFxuICAgICAgICAgICAgICAgICAgICBpbXBvcnROb2RlTW9kdWxlKCd2bScpXG4gICAgICAgICAgICAgICAgXSkpLCAyKSwgcGF0aCA9IF9yZWZbMF0sIHZtID0gX3JlZlsxXTtcbiAgICAgICAgICAgICAgICB2YXIgc2NyaXB0Q29udGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgZXhwb3J0czoge30sXG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0czoge31cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHVybERpcm5hbWUgPSB1cmxPYmoucGF0aG5hbWUuc3BsaXQoJy8nKS5zbGljZSgwLCAtMSkuam9pbignLycpO1xuICAgICAgICAgICAgICAgIHZhciBmaWxlbmFtZSA9IHBhdGguYmFzZW5hbWUodXJsT2JqLnBhdGhuYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgX3ZtX2NvbnN0YW50c19VU0VfTUFJTl9DT05URVhUX0RFRkFVTFRfTE9BREVSO1xuICAgICAgICAgICAgICAgIHZhciBzY3JpcHQgPSBuZXcgdm0uU2NyaXB0KGAoZnVuY3Rpb24oZXhwb3J0cywgbW9kdWxlLCByZXF1aXJlLCBfX2Rpcm5hbWUsIF9fZmlsZW5hbWUpIHske2RhdGF9XFxufSlgLCB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lLFxuICAgICAgICAgICAgICAgICAgICBpbXBvcnRNb2R1bGVEeW5hbWljYWxseTogKF92bV9jb25zdGFudHNfVVNFX01BSU5fQ09OVEVYVF9ERUZBVUxUX0xPQURFUiA9IChfdm1fY29uc3RhbnRzID0gdm0uY29uc3RhbnRzKSA9PSBudWxsID8gdm9pZCAwIDogX3ZtX2NvbnN0YW50cy5VU0VfTUFJTl9DT05URVhUX0RFRkFVTFRfTE9BREVSKSAhPSBudWxsID8gX3ZtX2NvbnN0YW50c19VU0VfTUFJTl9DT05URVhUX0RFRkFVTFRfTE9BREVSIDogaW1wb3J0Tm9kZU1vZHVsZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHNjcmlwdC5ydW5JblRoaXNDb250ZXh0KCkoc2NyaXB0Q29udGV4dC5leHBvcnRzLCBzY3JpcHRDb250ZXh0Lm1vZHVsZSwgZXZhbCgncmVxdWlyZScpLCB1cmxEaXJuYW1lLCBmaWxlbmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIGV4cG9ydGVkSW50ZXJmYWNlID0gc2NyaXB0Q29udGV4dC5tb2R1bGUuZXhwb3J0cyB8fCBzY3JpcHRDb250ZXh0LmV4cG9ydHM7XG4gICAgICAgICAgICAgICAgaWYgKGF0dHJzICYmIGV4cG9ydGVkSW50ZXJmYWNlICYmIGF0dHJzWydnbG9iYWxOYW1lJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IGV4cG9ydGVkSW50ZXJmYWNlW2F0dHJzWydnbG9iYWxOYW1lJ11dIHx8IGV4cG9ydGVkSW50ZXJmYWNlO1xuICAgICAgICAgICAgICAgICAgICBjYih1bmRlZmluZWQsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2IodW5kZWZpbmVkLCBleHBvcnRlZEludGVyZmFjZSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY2IoZSBpbnN0YW5jZW9mIEVycm9yID8gZSA6IG5ldyBFcnJvcihgU2NyaXB0IGV4ZWN1dGlvbiBlcnJvcjogJHtlfWApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKTtcbiAgICBnZXRGZXRjaCgpLnRoZW4oKGYpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgaWYgKChhdHRycyA9PSBudWxsID8gdm9pZCAwIDogYXR0cnNbJ3R5cGUnXSkgPT09ICdlc20nIHx8IChhdHRycyA9PSBudWxsID8gdm9pZCAwIDogYXR0cnNbJ3R5cGUnXSkgPT09ICdtb2R1bGUnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRNb2R1bGUodXJsT2JqLmhyZWYsIHtcbiAgICAgICAgICAgICAgICAgICAgZmV0Y2g6IGYsXG4gICAgICAgICAgICAgICAgICAgIHZtOiB5aWVsZCBpbXBvcnROb2RlTW9kdWxlKCd2bScpXG4gICAgICAgICAgICAgICAgfSkudGhlbigobW9kdWxlKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIG1vZHVsZS5ldmFsdWF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2IodW5kZWZpbmVkLCBtb2R1bGUubmFtZXNwYWNlKTtcbiAgICAgICAgICAgICAgICAgICAgfSkoKSkuY2F0Y2goKGUpPT57XG4gICAgICAgICAgICAgICAgICAgIGNiKGUgaW5zdGFuY2VvZiBFcnJvciA/IGUgOiBuZXcgRXJyb3IoYFNjcmlwdCBleGVjdXRpb24gZXJyb3I6ICR7ZX1gKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoYW5kbGVTY3JpcHRGZXRjaChmLCB1cmxPYmopO1xuICAgICAgICB9KSgpKS5jYXRjaCgoZXJyKT0+e1xuICAgICAgICBjYihlcnIpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gbG9hZFNjcmlwdE5vZGUodXJsLCBpbmZvKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpPT57XG4gICAgICAgIGNyZWF0ZVNjcmlwdE5vZGUodXJsLCAoZXJyb3IxLCBzY3JpcHRDb250ZXh0KT0+e1xuICAgICAgICAgICAgaWYgKGVycm9yMSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcjEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgX2luZm9fYXR0cnMsIF9pbmZvX2F0dHJzMTtcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnlLZXkgPSAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogKF9pbmZvX2F0dHJzID0gaW5mby5hdHRycykgPT0gbnVsbCA/IHZvaWQgMCA6IF9pbmZvX2F0dHJzWydnbG9iYWxOYW1lJ10pIHx8IGBfX0ZFREVSQVRJT05fJHtpbmZvID09IG51bGwgPyB2b2lkIDAgOiAoX2luZm9fYXR0cnMxID0gaW5mby5hdHRycykgPT0gbnVsbCA/IHZvaWQgMCA6IF9pbmZvX2F0dHJzMVsnbmFtZSddfTpjdXN0b21fX2A7XG4gICAgICAgICAgICAgICAgdmFyIGVudHJ5RXhwb3J0cyA9IGdsb2JhbFRoaXNbcmVtb3RlRW50cnlLZXldID0gc2NyaXB0Q29udGV4dDtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGVudHJ5RXhwb3J0cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGluZm8uYXR0cnMsIGluZm8ubG9hZGVySG9vayk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBsb2FkTW9kdWxlKHVybCwgb3B0aW9ucykge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICB2YXIgZmV0Y2gxID0gb3B0aW9ucy5mZXRjaCwgdm0gPSBvcHRpb25zLnZtO1xuICAgICAgICB2YXIgcmVzcG9uc2UgPSB5aWVsZCBmZXRjaDEodXJsKTtcbiAgICAgICAgdmFyIGNvZGUgPSB5aWVsZCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIHZhciBtb2R1bGUgPSBuZXcgdm0uU291cmNlVGV4dE1vZHVsZShjb2RlLCB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBpbXBvcnRNb2R1bGVEeW5hbWljYWxseTogKHNwZWNpZmllciwgc2NyaXB0KT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc29sdmVkVXJsID0gbmV3IFVSTChzcGVjaWZpZXIsIHVybCkuaHJlZjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRNb2R1bGUocmVzb2x2ZWRVcmwsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIH0pKClcbiAgICAgICAgfSk7XG4gICAgICAgIHlpZWxkIG1vZHVsZS5saW5rKChzcGVjaWZpZXIpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIHZhciByZXNvbHZlZFVybCA9IG5ldyBVUkwoc3BlY2lmaWVyLCB1cmwpLmhyZWY7XG4gICAgICAgICAgICAgICAgdmFyIG1vZHVsZSA9IHlpZWxkIGxvYWRNb2R1bGUocmVzb2x2ZWRVcmwsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgICAgICAgICB9KSgpKTtcbiAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICB9KSgpO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplT3B0aW9ucyhlbmFibGVEZWZhdWx0LCBkZWZhdWx0T3B0aW9ucywga2V5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgaWYgKGVuYWJsZURlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRPcHRpb25zO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zICYmIHR5cGVvZiBvcHRpb25zID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCB0eXBlIGZvciBcXGAke2tleX1cXGAsIGV4cGVjdCBib29sZWFuL3VuZGVmaW5lZC9vYmplY3QsIGdvdDogJHt0eXBlb2Ygb3B0aW9uc31gKTtcbiAgICB9O1xufVxuZXhwb3J0cy5CUk9XU0VSX0xPR19LRVkgPSBCUk9XU0VSX0xPR19LRVk7XG5leHBvcnRzLkJST1dTRVJfTE9HX1ZBTFVFID0gQlJPV1NFUl9MT0dfVkFMVUU7XG5leHBvcnRzLkVOQ09ERV9OQU1FX1BSRUZJWCA9IEVOQ09ERV9OQU1FX1BSRUZJWDtcbmV4cG9ydHMuRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXAgPSBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcDtcbmV4cG9ydHMuRmVkZXJhdGlvbk1vZHVsZU1hbmlmZXN0ID0gRmVkZXJhdGlvbk1vZHVsZU1hbmlmZXN0O1xuZXhwb3J0cy5NQU5JRkVTVF9FWFQgPSBNQU5JRkVTVF9FWFQ7XG5leHBvcnRzLk1GTW9kdWxlVHlwZSA9IE1GTW9kdWxlVHlwZTtcbmV4cG9ydHMuTUZQcmVmZXRjaENvbW1vbiA9IE1GUHJlZmV0Y2hDb21tb247XG5leHBvcnRzLk1PRFVMRV9ERVZUT09MX0lERU5USUZJRVIgPSBNT0RVTEVfREVWVE9PTF9JREVOVElGSUVSO1xuZXhwb3J0cy5NYW5pZmVzdEZpbGVOYW1lID0gTWFuaWZlc3RGaWxlTmFtZTtcbmV4cG9ydHMuTmFtZVRyYW5zZm9ybU1hcCA9IE5hbWVUcmFuc2Zvcm1NYXA7XG5leHBvcnRzLk5hbWVUcmFuc2Zvcm1TeW1ib2wgPSBOYW1lVHJhbnNmb3JtU3ltYm9sO1xuZXhwb3J0cy5TRVBBUkFUT1IgPSBTRVBBUkFUT1I7XG5leHBvcnRzLlN0YXRzRmlsZU5hbWUgPSBTdGF0c0ZpbGVOYW1lO1xuZXhwb3J0cy5URU1QX0RJUiA9IFRFTVBfRElSO1xuZXhwb3J0cy5hc3NlcnQgPSBhc3NlcnQ7XG5leHBvcnRzLmNvbXBvc2VLZXlXaXRoU2VwYXJhdG9yID0gY29tcG9zZUtleVdpdGhTZXBhcmF0b3I7XG5leHBvcnRzLmNvbnRhaW5lclBsdWdpbiA9IENvbnRhaW5lclBsdWdpbjtcbmV4cG9ydHMuY29udGFpbmVyUmVmZXJlbmNlUGx1Z2luID0gQ29udGFpbmVyUmVmZXJlbmNlUGx1Z2luO1xuZXhwb3J0cy5jcmVhdGVMaW5rID0gY3JlYXRlTGluaztcbmV4cG9ydHMuY3JlYXRlTG9nZ2VyID0gY3JlYXRlTG9nZ2VyO1xuZXhwb3J0cy5jcmVhdGVTY3JpcHQgPSBjcmVhdGVTY3JpcHQ7XG5leHBvcnRzLmNyZWF0ZVNjcmlwdE5vZGUgPSBjcmVhdGVTY3JpcHROb2RlO1xuZXhwb3J0cy5kZWNvZGVOYW1lID0gZGVjb2RlTmFtZTtcbmV4cG9ydHMuZW5jb2RlTmFtZSA9IGVuY29kZU5hbWU7XG5leHBvcnRzLmVycm9yID0gZXJyb3I7XG5leHBvcnRzLmdlbmVyYXRlRXhwb3NlRmlsZW5hbWUgPSBnZW5lcmF0ZUV4cG9zZUZpbGVuYW1lO1xuZXhwb3J0cy5nZW5lcmF0ZVNoYXJlRmlsZW5hbWUgPSBnZW5lcmF0ZVNoYXJlRmlsZW5hbWU7XG5leHBvcnRzLmdlbmVyYXRlU25hcHNob3RGcm9tTWFuaWZlc3QgPSBnZW5lcmF0ZVNuYXBzaG90RnJvbU1hbmlmZXN0O1xuZXhwb3J0cy5nZXRQcm9jZXNzRW52ID0gZ2V0UHJvY2Vzc0VudjtcbmV4cG9ydHMuZ2V0UmVzb3VyY2VVcmwgPSBnZXRSZXNvdXJjZVVybDtcbmV4cG9ydHMuaW5mZXJBdXRvUHVibGljUGF0aCA9IGluZmVyQXV0b1B1YmxpY1BhdGg7XG5leHBvcnRzLmlzQnJvd3NlckVudiA9IGlzQnJvd3NlckVudjtcbmV4cG9ydHMuaXNEZWJ1Z01vZGUgPSBpc0RlYnVnTW9kZTtcbmV4cG9ydHMuaXNNYW5pZmVzdFByb3ZpZGVyID0gaXNNYW5pZmVzdFByb3ZpZGVyO1xuZXhwb3J0cy5pc1JlcXVpcmVkVmVyc2lvbiA9IGlzUmVxdWlyZWRWZXJzaW9uO1xuZXhwb3J0cy5pc1N0YXRpY1Jlc291cmNlc0VxdWFsID0gaXNTdGF0aWNSZXNvdXJjZXNFcXVhbDtcbmV4cG9ydHMubG9hZFNjcmlwdCA9IGxvYWRTY3JpcHQ7XG5leHBvcnRzLmxvYWRTY3JpcHROb2RlID0gbG9hZFNjcmlwdE5vZGU7XG5leHBvcnRzLmxvZ2dlciA9IGxvZ2dlcjtcbmV4cG9ydHMubW9kdWxlRmVkZXJhdGlvblBsdWdpbiA9IE1vZHVsZUZlZGVyYXRpb25QbHVnaW47XG5leHBvcnRzLm5vcm1hbGl6ZU9wdGlvbnMgPSBub3JtYWxpemVPcHRpb25zO1xuZXhwb3J0cy5wYXJzZUVudHJ5ID0gcGFyc2VFbnRyeTtcbmV4cG9ydHMuc2FmZVRvU3RyaW5nID0gc2FmZVRvU3RyaW5nO1xuZXhwb3J0cy5zYWZlV3JhcHBlciA9IHNhZmVXcmFwcGVyO1xuZXhwb3J0cy5zaGFyZVBsdWdpbiA9IFNoYXJlUGx1Z2luO1xuZXhwb3J0cy5zaW1wbGVKb2luUmVtb3RlRW50cnkgPSBzaW1wbGVKb2luUmVtb3RlRW50cnk7XG5leHBvcnRzLndhcm4gPSB3YXJuO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vc2RrL2Rpc3QvcG9seWZpbGxzLmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L3BvbHlmaWxscy5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gICAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQpIHtcbiAgICAgICAgZm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gc291cmNlKWlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbiAgICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmV4cG9ydHMuX2V4dGVuZHMgPSBfZXh0ZW5kcztcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvY29uc3RhbnQuY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvY29uc3RhbnQuY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgRkVERVJBVElPTl9TVVBQT1JURURfVFlQRVMgPSBbXG4gICAgJ3NjcmlwdCdcbl07XG5leHBvcnRzLkZFREVSQVRJT05fU1VQUE9SVEVEX1RZUEVTID0gRkVERVJBVElPTl9TVVBQT1JURURfVFlQRVM7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xudmFyIF9vYmplY3Rfc3ByZWFkID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX29iamVjdF9zcHJlYWQgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19vYmplY3Rfc3ByZWFkLmNqc1wiKTtcbnZhciBydW50aW1lID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbnZhciBjb25zdGFudCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vY29uc3RhbnQuY2pzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvY29uc3RhbnQuY2pzLmpzXCIpO1xuZnVuY3Rpb24gX2ludGVyb3BOYW1lc3BhY2VEZWZhdWx0KGUpIHtcbiAgICB2YXIgbiA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgaWYgKGUpIHtcbiAgICAgICAgT2JqZWN0LmtleXMoZSkuZm9yRWFjaChmdW5jdGlvbihrKSB7XG4gICAgICAgICAgICBpZiAoayAhPT0gJ2RlZmF1bHQnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIGspO1xuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLCBrLCBkLmdldCA/IGQgOiB7XG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZVtrXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgbi5kZWZhdWx0ID0gZTtcbiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZShuKTtcbn1cbnZhciBydW50aW1lX19uYW1lc3BhY2UgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wTmFtZXNwYWNlRGVmYXVsdChydW50aW1lKTtcbmZ1bmN0aW9uIGF0dGFjaFNoYXJlU2NvcGVNYXAod2VicGFja1JlcXVpcmUpIHtcbiAgICBpZiAoIXdlYnBhY2tSZXF1aXJlLlMgfHwgd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5oYXNBdHRhY2hTaGFyZVNjb3BlTWFwIHx8ICF3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlIHx8ICF3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlLnNoYXJlU2NvcGVNYXApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB3ZWJwYWNrUmVxdWlyZS5TID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZS5zaGFyZVNjb3BlTWFwO1xuICAgIHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaGFzQXR0YWNoU2hhcmVTY29wZU1hcCA9IHRydWU7XG59XG52YXIgTmFtZVRyYW5zZm9ybVN5bWJvbCA9IHtcbiAgICBBVDogJ0AnLFxuICAgIEhZUEhFTjogJy0nLFxuICAgIFNMQVNIOiAnLydcbn07XG52YXIgTmFtZVRyYW5zZm9ybU1hcCA9IHtcbiAgICBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF06ICdzY29wZV8nLFxuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl06ICdfJyxcbiAgICBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF06ICdfXydcbn07XG52YXIgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXAgPSB7XG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF1dOiBOYW1lVHJhbnNmb3JtU3ltYm9sLkFULFxuICAgIFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXV06IE5hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOLFxuICAgIFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdXTogTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSFxufTtcbnZhciBFTkNPREVfTkFNRV9QUkVGSVggPSAnRU5DT0RFX05BTUVfUFJFRklYJztcbnZhciBkZWNvZGVOYW1lID0gZnVuY3Rpb24obmFtZSwgcHJlZml4LCB3aXRoRXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIGRlY29kZWROYW1lID0gbmFtZTtcbiAgICAgICAgaWYgKHByZWZpeCkge1xuICAgICAgICAgICAgaWYgKCFkZWNvZGVkTmFtZS5zdGFydHNXaXRoKHByZWZpeCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjb2RlZE5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWNvZGVkTmFtZSA9IGRlY29kZWROYW1lLnJlcGxhY2UobmV3IFJlZ0V4cChwcmVmaXgsICdnJyksICcnKTtcbiAgICAgICAgfVxuICAgICAgICBkZWNvZGVkTmFtZSA9IGRlY29kZWROYW1lLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdfWAsICdnJyksIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF1dKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXX1gLCAnZycpLCBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdXSkucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dfWAsICdnJyksIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dXSk7XG4gICAgICAgIGlmICh3aXRoRXh0KSA7XG4gICAgICAgIHJldHVybiBkZWNvZGVkTmFtZTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbn07XG5mdW5jdGlvbiByZW1vdGVzKG9wdGlvbnMpIHtcbiAgICB2YXIgY2h1bmtJZCA9IG9wdGlvbnMuY2h1bmtJZCwgcHJvbWlzZXMgPSBvcHRpb25zLnByb21pc2VzLCBjaHVua01hcHBpbmcgPSBvcHRpb25zLmNodW5rTWFwcGluZywgaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcgPSBvcHRpb25zLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nLCB3ZWJwYWNrUmVxdWlyZSA9IG9wdGlvbnMud2VicGFja1JlcXVpcmUsIGlkVG9SZW1vdGVNYXAgPSBvcHRpb25zLmlkVG9SZW1vdGVNYXA7XG4gICAgYXR0YWNoU2hhcmVTY29wZU1hcCh3ZWJwYWNrUmVxdWlyZSk7XG4gICAgaWYgKHdlYnBhY2tSZXF1aXJlLm8oY2h1bmtNYXBwaW5nLCBjaHVua0lkKSkge1xuICAgICAgICBjaHVua01hcHBpbmdbY2h1bmtJZF0uZm9yRWFjaCgoaWQpPT57XG4gICAgICAgICAgICB2YXIgZ2V0U2NvcGUgPSB3ZWJwYWNrUmVxdWlyZS5SO1xuICAgICAgICAgICAgaWYgKCFnZXRTY29wZSkge1xuICAgICAgICAgICAgICAgIGdldFNjb3BlID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nW2lkXTtcbiAgICAgICAgICAgIHZhciByZW1vdGVJbmZvcyA9IGlkVG9SZW1vdGVNYXBbaWRdO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSBzZWVtcyBub3Qgd29ya1xuICAgICAgICAgICAgaWYgKGdldFNjb3BlLmluZGV4T2YoZGF0YSkgPj0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgc2VlbXMgbm90IHdvcmtcbiAgICAgICAgICAgIGdldFNjb3BlLnB1c2goZGF0YSk7XG4gICAgICAgICAgICBpZiAoZGF0YS5wKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzLnB1c2goZGF0YS5wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbkVycm9yID0gKGVycm9yKT0+e1xuICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBuZXcgRXJyb3IoJ0NvbnRhaW5lciBtaXNzaW5nJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyb3IubWVzc2FnZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZSArPSBgXFxud2hpbGUgbG9hZGluZyBcIiR7ZGF0YVsxXX1cIiBmcm9tICR7ZGF0YVsyXX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZS5tW2lkXSA9ICgpPT57XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZGF0YS5wID0gMDtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgaGFuZGxlRnVuY3Rpb24gPSAoZm4sIGFyZzEsIGFyZzIsIGQsIG5leHQsIGZpcnN0KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gZm4oYXJnMSwgYXJnMik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9taXNlICYmIHByb21pc2UudGhlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBwcm9taXNlLnRoZW4oKHJlc3VsdCk9Pm5leHQocmVzdWx0LCBkKSwgb25FcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGRhdGEucCA9IHApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0KHByb21pc2UsIGQsIGZpcnN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgb25FeHRlcm5hbCA9IChleHRlcm5hbCwgXywgZmlyc3QpPT5leHRlcm5hbCA/IGhhbmRsZUZ1bmN0aW9uKHdlYnBhY2tSZXF1aXJlLkksIGRhdGFbMF0sIDAsIGV4dGVybmFsLCBvbkluaXRpYWxpemVkLCBmaXJzdCkgOiBvbkVycm9yKCk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdmFyXG4gICAgICAgICAgICB2YXIgb25Jbml0aWFsaXplZCA9IChfLCBleHRlcm5hbCwgZmlyc3QpPT5oYW5kbGVGdW5jdGlvbihleHRlcm5hbC5nZXQsIGRhdGFbMV0sIGdldFNjb3BlLCAwLCBvbkZhY3RvcnksIGZpcnN0KTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgICAgICAgICAgIHZhciBvbkZhY3RvcnkgPSAoZmFjdG9yeSk9PntcbiAgICAgICAgICAgICAgICBkYXRhLnAgPSAxO1xuICAgICAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlLm1baWRdID0gKG1vZHVsZTEpPT57XG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZTEuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBvblJlbW90ZUxvYWRlZCA9ICgpPT57XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZU5hbWUgPSBkZWNvZGVOYW1lKHJlbW90ZUluZm9zWzBdLm5hbWUsIEVOQ09ERV9OQU1FX1BSRUZJWCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVNb2R1bGVOYW1lID0gcmVtb3RlTmFtZSArIGRhdGFbMV0uc2xpY2UoMSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkUmVtb3RlID0gKCk9PndlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2UubG9hZFJlbW90ZShyZW1vdGVNb2R1bGVOYW1lLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZEZhY3Rvcnk6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdidWlsZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2Uub3B0aW9ucy5zaGFyZVN0cmF0ZWd5ID09PSAndmVyc2lvbi1maXJzdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChpbnN0YW5jZS5zaGFyZWRIYW5kbGVyLmluaXRpYWxpemVTaGFyaW5nKGRhdGFbMF0pKS50aGVuKCgpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRSZW1vdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2FkUmVtb3RlKCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciB1c2VSdW50aW1lTG9hZCA9IHJlbW90ZUluZm9zLmxlbmd0aCA9PT0gMSAmJiBjb25zdGFudC5GRURFUkFUSU9OX1NVUFBPUlRFRF9UWVBFUy5pbmNsdWRlcyhyZW1vdGVJbmZvc1swXS5leHRlcm5hbFR5cGUpICYmIHJlbW90ZUluZm9zWzBdLm5hbWU7XG4gICAgICAgICAgICBpZiAodXNlUnVudGltZUxvYWQpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVGdW5jdGlvbihvblJlbW90ZUxvYWRlZCwgZGF0YVsyXSwgMCwgMCwgb25GYWN0b3J5LCAxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlRnVuY3Rpb24od2VicGFja1JlcXVpcmUsIGRhdGFbMl0sIDAsIDAsIG9uRXh0ZXJuYWwsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBjb25zdW1lcyhvcHRpb25zKSB7XG4gICAgdmFyIGNodW5rSWQgPSBvcHRpb25zLmNodW5rSWQsIHByb21pc2VzID0gb3B0aW9ucy5wcm9taXNlcywgY2h1bmtNYXBwaW5nID0gb3B0aW9ucy5jaHVua01hcHBpbmcsIGluc3RhbGxlZE1vZHVsZXMgPSBvcHRpb25zLmluc3RhbGxlZE1vZHVsZXMsIG1vZHVsZVRvSGFuZGxlck1hcHBpbmcgPSBvcHRpb25zLm1vZHVsZVRvSGFuZGxlck1hcHBpbmcsIHdlYnBhY2tSZXF1aXJlID0gb3B0aW9ucy53ZWJwYWNrUmVxdWlyZTtcbiAgICBhdHRhY2hTaGFyZVNjb3BlTWFwKHdlYnBhY2tSZXF1aXJlKTtcbiAgICBpZiAod2VicGFja1JlcXVpcmUubyhjaHVua01hcHBpbmcsIGNodW5rSWQpKSB7XG4gICAgICAgIGNodW5rTWFwcGluZ1tjaHVua0lkXS5mb3JFYWNoKChpZCk9PntcbiAgICAgICAgICAgIGlmICh3ZWJwYWNrUmVxdWlyZS5vKGluc3RhbGxlZE1vZHVsZXMsIGlkKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlcy5wdXNoKGluc3RhbGxlZE1vZHVsZXNbaWRdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbkZhY3RvcnkgPSAoZmFjdG9yeSk9PntcbiAgICAgICAgICAgICAgICBpbnN0YWxsZWRNb2R1bGVzW2lkXSA9IDA7XG4gICAgICAgICAgICAgICAgd2VicGFja1JlcXVpcmUubVtpZF0gPSAobW9kdWxlMSk9PntcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdlYnBhY2tSZXF1aXJlLmNbaWRdO1xuICAgICAgICAgICAgICAgICAgICBtb2R1bGUxLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgb25FcnJvciA9IChlcnJvcik9PntcbiAgICAgICAgICAgICAgICBkZWxldGUgaW5zdGFsbGVkTW9kdWxlc1tpZF07XG4gICAgICAgICAgICAgICAgd2VicGFja1JlcXVpcmUubVtpZF0gPSAobW9kdWxlMSk9PntcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdlYnBhY2tSZXF1aXJlLmNbaWRdO1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGZlZGVyYXRpb25JbnN0YW5jZSA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgaWYgKCFmZWRlcmF0aW9uSW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGZWRlcmF0aW9uIGluc3RhbmNlIG5vdCBmb3VuZCEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX2lkID0gbW9kdWxlVG9IYW5kbGVyTWFwcGluZ1tpZF0sIHNoYXJlS2V5ID0gX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfaWQuc2hhcmVLZXksIGdldHRlciA9IF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX2lkLmdldHRlciwgc2hhcmVJbmZvID0gX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfaWQuc2hhcmVJbmZvO1xuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gZmVkZXJhdGlvbkluc3RhbmNlLmxvYWRTaGFyZShzaGFyZUtleSwge1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21TaGFyZUluZm86IHNoYXJlSW5mb1xuICAgICAgICAgICAgICAgIH0pLnRoZW4oKGZhY3RvcnkpPT57XG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWN0b3J5ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldHRlcigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWN0b3J5O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChwcm9taXNlLnRoZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChpbnN0YWxsZWRNb2R1bGVzW2lkXSA9IHByb21pc2UudGhlbihvbkZhY3RvcnkpLmNhdGNoKG9uRXJyb3IpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIG1haW50YWluIHByZXZpb3VzIGxvZ2ljXG4gICAgICAgICAgICAgICAgICAgIG9uRmFjdG9yeShwcm9taXNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuZnVuY3Rpb24gaW5pdGlhbGl6ZVNoYXJpbmcocmVmKSB7XG4gICAgdmFyIHNoYXJlU2NvcGVOYW1lID0gcmVmLnNoYXJlU2NvcGVOYW1lLCB3ZWJwYWNrUmVxdWlyZSA9IHJlZi53ZWJwYWNrUmVxdWlyZSwgaW5pdFByb21pc2VzID0gcmVmLmluaXRQcm9taXNlcywgaW5pdFRva2VucyA9IHJlZi5pbml0VG9rZW5zLCBpbml0U2NvcGUgPSByZWYuaW5pdFNjb3BlO1xuICAgIGlmICghaW5pdFNjb3BlKSBpbml0U2NvcGUgPSBbXTtcbiAgICB2YXIgbWZJbnN0YW5jZSA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2U7XG4gICAgLy8gaGFuZGxpbmcgY2lyY3VsYXIgaW5pdCBjYWxsc1xuICAgIHZhciBpbml0VG9rZW4gPSBpbml0VG9rZW5zW3NoYXJlU2NvcGVOYW1lXTtcbiAgICBpZiAoIWluaXRUb2tlbikgaW5pdFRva2VuID0gaW5pdFRva2Vuc1tzaGFyZVNjb3BlTmFtZV0gPSB7XG4gICAgICAgIGZyb206IG1mSW5zdGFuY2UubmFtZVxuICAgIH07XG4gICAgaWYgKGluaXRTY29wZS5pbmRleE9mKGluaXRUb2tlbikgPj0gMCkgcmV0dXJuO1xuICAgIGluaXRTY29wZS5wdXNoKGluaXRUb2tlbik7XG4gICAgdmFyIHByb21pc2UgPSBpbml0UHJvbWlzZXNbc2hhcmVTY29wZU5hbWVdO1xuICAgIGlmIChwcm9taXNlKSByZXR1cm4gcHJvbWlzZTtcbiAgICB2YXIgd2FybiA9IChtc2cpPT50eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYgY29uc29sZS53YXJuICYmIGNvbnNvbGUud2Fybihtc2cpO1xuICAgIHZhciBpbml0RXh0ZXJuYWwgPSAoaWQpPT57XG4gICAgICAgIHZhciBoYW5kbGVFcnJvciA9IChlcnIpPT53YXJuKCdJbml0aWFsaXphdGlvbiBvZiBzaGFyaW5nIGV4dGVybmFsIGZhaWxlZDogJyArIGVycik7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgXyRtb2R1bGUgPSB3ZWJwYWNrUmVxdWlyZShpZCk7XG4gICAgICAgICAgICBpZiAoIV8kbW9kdWxlKSByZXR1cm47XG4gICAgICAgICAgICB2YXIgaW5pdEZuID0gKG1vZHVsZTEpPT5tb2R1bGUxICYmIG1vZHVsZTEuaW5pdCAmJiAvLyBAdHMtaWdub3JlIGNvbXBhdCBsZWdhY3kgbWYgc2hhcmVkIGJlaGF2aW9yXG4gICAgICAgICAgICAgICAgbW9kdWxlMS5pbml0KHdlYnBhY2tSZXF1aXJlLlNbc2hhcmVTY29wZU5hbWVdLCBpbml0U2NvcGUpO1xuICAgICAgICAgICAgaWYgKF8kbW9kdWxlLnRoZW4pIHJldHVybiBwcm9taXNlcy5wdXNoKF8kbW9kdWxlLnRoZW4oaW5pdEZuLCBoYW5kbGVFcnJvcikpO1xuICAgICAgICAgICAgdmFyIGluaXRSZXN1bHQgPSBpbml0Rm4oXyRtb2R1bGUpO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgaWYgKGluaXRSZXN1bHQgJiYgdHlwZW9mIGluaXRSZXN1bHQgIT09ICdib29sZWFuJyAmJiBpbml0UmVzdWx0LnRoZW4pIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlcy5wdXNoKGluaXRSZXN1bHRbJ2NhdGNoJ10oaGFuZGxlRXJyb3IpKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBoYW5kbGVFcnJvcihlcnIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgcHJvbWlzZXMgPSBtZkluc3RhbmNlLmluaXRpYWxpemVTaGFyaW5nKHNoYXJlU2NvcGVOYW1lLCB7XG4gICAgICAgIHN0cmF0ZWd5OiBtZkluc3RhbmNlLm9wdGlvbnMuc2hhcmVTdHJhdGVneSxcbiAgICAgICAgaW5pdFNjb3BlLFxuICAgICAgICBmcm9tOiAnYnVpbGQnXG4gICAgfSk7XG4gICAgYXR0YWNoU2hhcmVTY29wZU1hcCh3ZWJwYWNrUmVxdWlyZSk7XG4gICAgdmFyIGJ1bmRsZXJSdW50aW1lUmVtb3Rlc09wdGlvbnMgPSB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzO1xuICAgIGlmIChidW5kbGVyUnVudGltZVJlbW90ZXNPcHRpb25zKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKGJ1bmRsZXJSdW50aW1lUmVtb3Rlc09wdGlvbnMuaWRUb1JlbW90ZU1hcCkuZm9yRWFjaCgobW9kdWxlSWQpPT57XG4gICAgICAgICAgICB2YXIgaW5mbyA9IGJ1bmRsZXJSdW50aW1lUmVtb3Rlc09wdGlvbnMuaWRUb1JlbW90ZU1hcFttb2R1bGVJZF07XG4gICAgICAgICAgICB2YXIgZXh0ZXJuYWxNb2R1bGVJZCA9IGJ1bmRsZXJSdW50aW1lUmVtb3Rlc09wdGlvbnMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdbbW9kdWxlSWRdWzJdO1xuICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGluaXRFeHRlcm5hbChleHRlcm5hbE1vZHVsZUlkKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IGluZm9bMF07XG4gICAgICAgICAgICAgICAgaWYgKCFjb25zdGFudC5GRURFUkFUSU9OX1NVUFBPUlRFRF9UWVBFUy5pbmNsdWRlcyhyZW1vdGVJbmZvLmV4dGVybmFsVHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5pdEV4dGVybmFsKGV4dGVybmFsTW9kdWxlSWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmICghcHJvbWlzZXMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBpbml0UHJvbWlzZXNbc2hhcmVTY29wZU5hbWVdID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGluaXRQcm9taXNlc1tzaGFyZVNjb3BlTmFtZV0gPSBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbigoKT0+aW5pdFByb21pc2VzW3NoYXJlU2NvcGVOYW1lXSA9IHRydWUpO1xufVxuZnVuY3Rpb24gaGFuZGxlSW5pdGlhbENvbnN1bWVzKG9wdGlvbnMpIHtcbiAgICB2YXIgbW9kdWxlSWQgPSBvcHRpb25zLm1vZHVsZUlkLCBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nID0gb3B0aW9ucy5tb2R1bGVUb0hhbmRsZXJNYXBwaW5nLCB3ZWJwYWNrUmVxdWlyZSA9IG9wdGlvbnMud2VicGFja1JlcXVpcmU7XG4gICAgdmFyIGZlZGVyYXRpb25JbnN0YW5jZSA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2U7XG4gICAgaWYgKCFmZWRlcmF0aW9uSW5zdGFuY2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGZWRlcmF0aW9uIGluc3RhbmNlIG5vdCBmb3VuZCEnKTtcbiAgICB9XG4gICAgdmFyIF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX21vZHVsZUlkID0gbW9kdWxlVG9IYW5kbGVyTWFwcGluZ1ttb2R1bGVJZF0sIHNoYXJlS2V5ID0gX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfbW9kdWxlSWQuc2hhcmVLZXksIHNoYXJlSW5mbyA9IF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX21vZHVsZUlkLnNoYXJlSW5mbztcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gZmVkZXJhdGlvbkluc3RhbmNlLmxvYWRTaGFyZVN5bmMoc2hhcmVLZXksIHtcbiAgICAgICAgICAgIGN1c3RvbVNoYXJlSW5mbzogc2hhcmVJbmZvXG4gICAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdsb2FkU2hhcmVTeW5jIGZhaWxlZCEgVGhlIGZ1bmN0aW9uIHNob3VsZCBub3QgYmUgY2FsbGVkIHVubGVzcyB5b3Ugc2V0IFwiZWFnZXI6dHJ1ZVwiLiBJZiB5b3UgZG8gbm90IHNldCBpdCwgYW5kIGVuY291bnRlciB0aGlzIGlzc3VlLCB5b3UgY2FuIGNoZWNrIHdoZXRoZXIgYW4gYXN5bmMgYm91bmRhcnkgaXMgaW1wbGVtZW50ZWQuJyk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RoZSBvcmlnaW5hbCBlcnJvciBtZXNzYWdlIGlzIGFzIGZvbGxvd3M6ICcpO1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgfVxufVxuZnVuY3Rpb24gaW5zdGFsbEluaXRpYWxDb25zdW1lcyhvcHRpb25zKSB7XG4gICAgdmFyIG1vZHVsZVRvSGFuZGxlck1hcHBpbmcgPSBvcHRpb25zLm1vZHVsZVRvSGFuZGxlck1hcHBpbmcsIHdlYnBhY2tSZXF1aXJlID0gb3B0aW9ucy53ZWJwYWNrUmVxdWlyZSwgaW5zdGFsbGVkTW9kdWxlcyA9IG9wdGlvbnMuaW5zdGFsbGVkTW9kdWxlcywgaW5pdGlhbENvbnN1bWVzID0gb3B0aW9ucy5pbml0aWFsQ29uc3VtZXM7XG4gICAgaW5pdGlhbENvbnN1bWVzLmZvckVhY2goKGlkKT0+e1xuICAgICAgICB3ZWJwYWNrUmVxdWlyZS5tW2lkXSA9IChtb2R1bGUxKT0+e1xuICAgICAgICAgICAgLy8gSGFuZGxlIHNjZW5hcmlvIHdoZW4gbW9kdWxlIGlzIHVzZWQgc3luY2hyb25vdXNseVxuICAgICAgICAgICAgaW5zdGFsbGVkTW9kdWxlc1tpZF0gPSAwO1xuICAgICAgICAgICAgZGVsZXRlIHdlYnBhY2tSZXF1aXJlLmNbaWRdO1xuICAgICAgICAgICAgdmFyIGZhY3RvcnkgPSBoYW5kbGVJbml0aWFsQ29uc3VtZXMoe1xuICAgICAgICAgICAgICAgIG1vZHVsZUlkOiBpZCxcbiAgICAgICAgICAgICAgICBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nLFxuICAgICAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZmFjdG9yeSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgU2hhcmVkIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlIGZvciBlYWdlciBjb25zdW1wdGlvbjogJHtpZH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1vZHVsZTEuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICAgICAgfTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGluaXRDb250YWluZXJFbnRyeShvcHRpb25zKSB7XG4gICAgdmFyIHdlYnBhY2tSZXF1aXJlID0gb3B0aW9ucy53ZWJwYWNrUmVxdWlyZSwgc2hhcmVTY29wZSA9IG9wdGlvbnMuc2hhcmVTY29wZSwgaW5pdFNjb3BlID0gb3B0aW9ucy5pbml0U2NvcGUsIHNoYXJlU2NvcGVLZXkgPSBvcHRpb25zLnNoYXJlU2NvcGVLZXksIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMgPSBvcHRpb25zLnJlbW90ZUVudHJ5SW5pdE9wdGlvbnM7XG4gICAgaWYgKCF3ZWJwYWNrUmVxdWlyZS5TKSByZXR1cm47XG4gICAgaWYgKCF3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uIHx8ICF3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlIHx8ICF3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluaXRPcHRpb25zKSByZXR1cm47XG4gICAgdmFyIGZlZGVyYXRpb25JbnN0YW5jZSA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2U7XG4gICAgdmFyIG5hbWUgPSBzaGFyZVNjb3BlS2V5IHx8ICdkZWZhdWx0JztcbiAgICBmZWRlcmF0aW9uSW5zdGFuY2UuaW5pdE9wdGlvbnMoX29iamVjdF9zcHJlYWQuXyh7XG4gICAgICAgIG5hbWU6IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMubmFtZSxcbiAgICAgICAgcmVtb3RlczogW11cbiAgICB9LCByZW1vdGVFbnRyeUluaXRPcHRpb25zKSk7XG4gICAgZmVkZXJhdGlvbkluc3RhbmNlLmluaXRTaGFyZVNjb3BlTWFwKG5hbWUsIHNoYXJlU2NvcGUsIHtcbiAgICAgICAgaG9zdFNoYXJlU2NvcGVNYXA6IChyZW1vdGVFbnRyeUluaXRPcHRpb25zID09PSBudWxsIHx8IHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMuc2hhcmVTY29wZU1hcCkgfHwge31cbiAgICB9KTtcbiAgICBpZiAod2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKSB7XG4gICAgICAgIHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCh3ZWJwYWNrUmVxdWlyZSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5wcmVmZXRjaCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLnByZWZldGNoKCk7XG4gICAgfVxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICByZXR1cm4gd2VicGFja1JlcXVpcmUuSShuYW1lLCBpbml0U2NvcGUpO1xufVxudmFyIGZlZGVyYXRpb24gPSB7XG4gICAgcnVudGltZTogcnVudGltZV9fbmFtZXNwYWNlLFxuICAgIGluc3RhbmNlOiB1bmRlZmluZWQsXG4gICAgaW5pdE9wdGlvbnM6IHVuZGVmaW5lZCxcbiAgICBidW5kbGVyUnVudGltZToge1xuICAgICAgICByZW1vdGVzLFxuICAgICAgICBjb25zdW1lcyxcbiAgICAgICAgSTogaW5pdGlhbGl6ZVNoYXJpbmcsXG4gICAgICAgIFM6IHt9LFxuICAgICAgICBpbnN0YWxsSW5pdGlhbENvbnN1bWVzLFxuICAgICAgICBpbml0Q29udGFpbmVyRW50cnlcbiAgICB9LFxuICAgIGF0dGFjaFNoYXJlU2NvcGVNYXAsXG4gICAgYnVuZGxlclJ1bnRpbWVPcHRpb25zOiB7fVxufTtcbm1vZHVsZS5leHBvcnRzID0gZmVkZXJhdGlvbjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfbGlrZV90b19hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X2xpa2VfdG9fYXJyYXkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9hcnJheV9saWtlX3RvX2FycmF5KGFyciwgbGVuKSB7XG4gICAgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7XG4gICAgZm9yKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspYXJyMltpXSA9IGFycltpXTtcbiAgICByZXR1cm4gYXJyMjtcbn1cbmV4cG9ydHMuXyA9IF9hcnJheV9saWtlX3RvX2FycmF5O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRoX2hvbGVzLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aF9ob2xlcy5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2FycmF5X3dpdGhfaG9sZXMoYXJyKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjtcbn1cbmV4cG9ydHMuXyA9IF9hcnJheV93aXRoX2hvbGVzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRob3V0X2hvbGVzLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aG91dF9ob2xlcy5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9hcnJheV9saWtlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fYXJyYXlfbGlrZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV9saWtlX3RvX2FycmF5LmNqc1wiKTtcbmZ1bmN0aW9uIF9hcnJheV93aXRob3V0X2hvbGVzKGFycikge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlfbGlrZV90b19hcnJheS5fKGFycik7XG59XG5leHBvcnRzLl8gPSBfYXJyYXlfd2l0aG91dF9ob2xlcztcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQoc2VsZikge1xuICAgIGlmIChzZWxmID09PSB2b2lkIDApIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTtcbiAgICByZXR1cm4gc2VsZjtcbn1cbmV4cG9ydHMuXyA9IF9hc3NlcnRfdGhpc19pbml0aWFsaXplZDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykge1xuICAgIHRyeSB7XG4gICAgICAgIHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTtcbiAgICAgICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChpbmZvLmRvbmUpIHJlc29sdmUodmFsdWUpO1xuICAgIGVsc2UgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpO1xufVxuZnVuY3Rpb24gX2FzeW5jX3RvX2dlbmVyYXRvcihmbikge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgICAgICAgICBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgXCJuZXh0XCIsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIF90aHJvdyhlcnIpIHtcbiAgICAgICAgICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIFwidGhyb3dcIiwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9uZXh0KHVuZGVmaW5lZCk7XG4gICAgICAgIH0pO1xuICAgIH07XG59XG5leHBvcnRzLl8gPSBfYXN5bmNfdG9fZ2VuZXJhdG9yO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jYWxsX3N1cGVyLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2FsbF9zdXBlci5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9nZXRfcHJvdG90eXBlX29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fZ2V0X3Byb3RvdHlwZV9vZi5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19nZXRfcHJvdG90eXBlX29mLmNqc1wiKTtcbnZhciBfaXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9faXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdC5janNcIik7XG52YXIgX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybiA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybi5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4uY2pzXCIpO1xuZnVuY3Rpb24gX2NhbGxfc3VwZXIoX3RoaXMsIGRlcml2ZWQsIGFyZ3MpIHtcbiAgICAvLyBTdXBlclxuICAgIGRlcml2ZWQgPSBfZ2V0X3Byb3RvdHlwZV9vZi5fKGRlcml2ZWQpO1xuICAgIHJldHVybiBfcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuLl8oX3RoaXMsIF9pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QuXygpID8gUmVmbGVjdC5jb25zdHJ1Y3QoZGVyaXZlZCwgYXJncyB8fCBbXSwgX2dldF9wcm90b3R5cGVfb2YuXyhfdGhpcykuY29uc3RydWN0b3IpIDogZGVyaXZlZC5hcHBseShfdGhpcywgYXJncykpO1xufVxuZXhwb3J0cy5fID0gX2NhbGxfc3VwZXI7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NsYXNzX2NhbGxfY2hlY2suY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfY2xhc3NfY2FsbF9jaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcbiAgICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbn1cbmV4cG9ydHMuXyA9IF9jbGFzc19jYWxsX2NoZWNrO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTtcbiAgICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgICAgIGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTtcbiAgICB9XG59XG5mdW5jdGlvbiBfY3JlYXRlX2NsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykge1xuICAgIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xuICAgIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgICByZXR1cm4gQ29uc3RydWN0b3I7XG59XG5leHBvcnRzLl8gPSBfY3JlYXRlX2NsYXNzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19kZWZpbmVfcHJvcGVydHkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2RlZmluZV9wcm9wZXJ0eS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfZGVmaW5lX3Byb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkge1xuICAgIGlmIChrZXkgaW4gb2JqKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwge1xuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSBvYmpba2V5XSA9IHZhbHVlO1xuICAgIHJldHVybiBvYmo7XG59XG5leHBvcnRzLl8gPSBfZGVmaW5lX3Byb3BlcnR5O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19leHBvcnRfc3Rhci5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19leHBvcnRfc3Rhci5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9leHBvcnRfc3Rhcihmcm9tLCB0bykge1xuICAgIE9iamVjdC5rZXlzKGZyb20pLmZvckVhY2goZnVuY3Rpb24oaykge1xuICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0bywgaykpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0bywgaywge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZyb21ba107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZnJvbTtcbn1cbmV4cG9ydHMuXyA9IF9leHBvcnRfc3RhcjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZ2V0X3Byb3RvdHlwZV9vZi5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2dldF9wcm90b3R5cGVfb2YuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9nZXRfcHJvdG90eXBlX29mKG8pIHtcbiAgICBleHBvcnRzLl8gPSBfZ2V0X3Byb3RvdHlwZV9vZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKG8pIHtcbiAgICAgICAgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTtcbiAgICB9O1xuICAgIHJldHVybiBfZ2V0X3Byb3RvdHlwZV9vZihvKTtcbn1cbmV4cG9ydHMuXyA9IF9nZXRfcHJvdG90eXBlX29mO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbmhlcml0cy5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbmhlcml0cy5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfc2V0X3Byb3RvdHlwZV9vZiA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3NldF9wcm90b3R5cGVfb2YuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2V0X3Byb3RvdHlwZV9vZi5janNcIik7XG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHtcbiAgICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICAgICAgICB2YWx1ZTogc3ViQ2xhc3MsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRfcHJvdG90eXBlX29mLl8oc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpO1xufVxuZXhwb3J0cy5fID0gX2luaGVyaXRzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdChvYmopIHtcbiAgICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDoge1xuICAgICAgICBkZWZhdWx0OiBvYmpcbiAgICB9O1xufVxuZXhwb3J0cy5fID0gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfaXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0KCkge1xuICAgIC8vIFNpbmNlIFJlZmxlY3QuY29uc3RydWN0IGNhbid0IGJlIHByb3Blcmx5IHBvbHlmaWxsZWQsIHNvbWVcbiAgICAvLyBpbXBsZW1lbnRhdGlvbnMgKGUuZy4gY29yZS1qc0AyKSBkb24ndCBzZXQgdGhlIGNvcnJlY3QgaW50ZXJuYWwgc2xvdHMuXG4gICAgLy8gVGhvc2UgcG9seWZpbGxzIGRvbid0IGFsbG93IHVzIHRvIHN1YmNsYXNzIGJ1aWx0LWlucywgc28gd2UgbmVlZCB0b1xuICAgIC8vIHVzZSBvdXIgZmFsbGJhY2sgaW1wbGVtZW50YXRpb24uXG4gICAgdHJ5IHtcbiAgICAgICAgLy8gSWYgdGhlIGludGVybmFsIHNsb3RzIGFyZW4ndCBzZXQsIHRoaXMgdGhyb3dzIGFuIGVycm9yIHNpbWlsYXIgdG9cbiAgICAgICAgLy8gICBUeXBlRXJyb3I6IHRoaXMgaXMgbm90IGEgQm9vbGVhbiBvYmplY3QuXG4gICAgICAgIHZhciByZXN1bHQgPSAhQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbigpIHt9KSk7XG4gICAgfSBjYXRjaCAoXykge31cbiAgICByZXR1cm4gKGV4cG9ydHMuXyA9IF9pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICEhcmVzdWx0O1xuICAgIH0pKCk7XG59XG5leHBvcnRzLl8gPSBfaXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pdGVyYWJsZV90b19hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pdGVyYWJsZV90b19hcnJheS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9pdGVyYWJsZV90b19hcnJheShpdGVyKSB7XG4gICAgaWYgKHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgaXRlcltTeW1ib2wuaXRlcmF0b3JdICE9IG51bGwgfHwgaXRlcltcIkBAaXRlcmF0b3JcIl0gIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTtcbiAgICB9XG59XG5leHBvcnRzLl8gPSBfaXRlcmFibGVfdG9fYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0KGFyciwgaSkge1xuICAgIHZhciBfaSA9IGFyciA9PSBudWxsID8gbnVsbCA6IHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgYXJyW1N5bWJvbC5pdGVyYXRvcl0gfHwgYXJyW1wiQEBpdGVyYXRvclwiXTtcbiAgICBpZiAoX2kgPT0gbnVsbCkgcmV0dXJuO1xuICAgIHZhciBfYXJyID0gW107XG4gICAgdmFyIF9uID0gdHJ1ZTtcbiAgICB2YXIgX2QgPSBmYWxzZTtcbiAgICB2YXIgX3MsIF9lO1xuICAgIHRyeSB7XG4gICAgICAgIGZvcihfaSA9IF9pLmNhbGwoYXJyKTsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSl7XG4gICAgICAgICAgICBfYXJyLnB1c2goX3MudmFsdWUpO1xuICAgICAgICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIF9kID0gdHJ1ZTtcbiAgICAgICAgX2UgPSBlcnI7XG4gICAgfSBmaW5hbGx5e1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCFfbiAmJiBfaVtcInJldHVyblwiXSAhPSBudWxsKSBfaVtcInJldHVyblwiXSgpO1xuICAgICAgICB9IGZpbmFsbHl7XG4gICAgICAgICAgICBpZiAoX2QpIHRocm93IF9lO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBfYXJyO1xufVxuZXhwb3J0cy5fID0gX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfcmVzdC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfcmVzdC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9ub25faXRlcmFibGVfcmVzdCgpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xufVxuZXhwb3J0cy5fID0gX25vbl9pdGVyYWJsZV9yZXN0O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfc3ByZWFkLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fbm9uX2l0ZXJhYmxlX3NwcmVhZC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX25vbl9pdGVyYWJsZV9zcHJlYWQoKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7XG59XG5leHBvcnRzLl8gPSBfbm9uX2l0ZXJhYmxlX3NwcmVhZDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fb2JqZWN0X3NwcmVhZC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX29iamVjdF9zcHJlYWQuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfZGVmaW5lX3Byb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fZGVmaW5lX3Byb3BlcnR5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2RlZmluZV9wcm9wZXJ0eS5janNcIik7XG5mdW5jdGlvbiBfb2JqZWN0X3NwcmVhZCh0YXJnZXQpIHtcbiAgICBmb3IodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307XG4gICAgICAgIHZhciBvd25LZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcbiAgICAgICAgaWYgKHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIG93bktleXMgPSBvd25LZXlzLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHNvdXJjZSkuZmlsdGVyKGZ1bmN0aW9uKHN5bSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwgc3ltKS5lbnVtZXJhYmxlO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIG93bktleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIF9kZWZpbmVfcHJvcGVydHkuXyh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbn1cbmV4cG9ydHMuXyA9IF9vYmplY3Rfc3ByZWFkO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4uY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybi5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2Fzc2VydF90aGlzX2luaXRpYWxpemVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQuY2pzXCIpO1xudmFyIF90eXBlX29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fdHlwZV9vZi5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190eXBlX29mLmNqc1wiKTtcbmZ1bmN0aW9uIF9wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4oc2VsZiwgY2FsbCkge1xuICAgIGlmIChjYWxsICYmIChfdHlwZV9vZi5fKGNhbGwpID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpKSByZXR1cm4gY2FsbDtcbiAgICByZXR1cm4gX2Fzc2VydF90aGlzX2luaXRpYWxpemVkLl8oc2VsZik7XG59XG5leHBvcnRzLl8gPSBfcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zZXRfcHJvdG90eXBlX29mLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2V0X3Byb3RvdHlwZV9vZi5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX3NldF9wcm90b3R5cGVfb2YobywgcCkge1xuICAgIGV4cG9ydHMuXyA9IF9zZXRfcHJvdG90eXBlX29mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKG8sIHApIHtcbiAgICAgICAgby5fX3Byb3RvX18gPSBwO1xuICAgICAgICByZXR1cm4gbztcbiAgICB9O1xuICAgIHJldHVybiBfc2V0X3Byb3RvdHlwZV9vZihvLCBwKTtcbn1cbmV4cG9ydHMuXyA9IF9zZXRfcHJvdG90eXBlX29mO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2FycmF5X3dpdGhfaG9sZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hcnJheV93aXRoX2hvbGVzLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhfaG9sZXMuY2pzXCIpO1xudmFyIF9pdGVyYWJsZV90b19hcnJheV9saW1pdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0LmNqc1wiKTtcbnZhciBfbm9uX2l0ZXJhYmxlX3Jlc3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19ub25faXRlcmFibGVfcmVzdC5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfcmVzdC5janNcIik7XG52YXIgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzXCIpO1xuZnVuY3Rpb24gX3NsaWNlZF90b19hcnJheShhcnIsIGkpIHtcbiAgICByZXR1cm4gX2FycmF5X3dpdGhfaG9sZXMuXyhhcnIpIHx8IF9pdGVyYWJsZV90b19hcnJheV9saW1pdC5fKGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5Ll8oYXJyLCBpKSB8fCBfbm9uX2l0ZXJhYmxlX3Jlc3QuXygpO1xufVxuZXhwb3J0cy5fID0gX3NsaWNlZF90b19hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fYXJyYXkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fYXJyYXkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2FycmF5X3dpdGhfaG9sZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hcnJheV93aXRoX2hvbGVzLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhfaG9sZXMuY2pzXCIpO1xudmFyIF9pdGVyYWJsZV90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiKTtcbnZhciBfbm9uX2l0ZXJhYmxlX3Jlc3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19ub25faXRlcmFibGVfcmVzdC5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfcmVzdC5janNcIik7XG52YXIgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzXCIpO1xuZnVuY3Rpb24gX3RvX2FycmF5KGFycikge1xuICAgIHJldHVybiBfYXJyYXlfd2l0aF9ob2xlcy5fKGFycikgfHwgX2l0ZXJhYmxlX3RvX2FycmF5Ll8oYXJyKSB8fCBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuXyhhcnIpIHx8IF9ub25faXRlcmFibGVfcmVzdC5fKCk7XG59XG5leHBvcnRzLl8gPSBfdG9fYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2FycmF5X3dpdGhvdXRfaG9sZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hcnJheV93aXRob3V0X2hvbGVzLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhvdXRfaG9sZXMuY2pzXCIpO1xudmFyIF9pdGVyYWJsZV90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiKTtcbnZhciBfbm9uX2l0ZXJhYmxlX3NwcmVhZCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX25vbl9pdGVyYWJsZV9zcHJlYWQuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fbm9uX2l0ZXJhYmxlX3NwcmVhZC5janNcIik7XG52YXIgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzXCIpO1xuZnVuY3Rpb24gX3RvX2NvbnN1bWFibGVfYXJyYXkoYXJyKSB7XG4gICAgcmV0dXJuIF9hcnJheV93aXRob3V0X2hvbGVzLl8oYXJyKSB8fCBfaXRlcmFibGVfdG9fYXJyYXkuXyhhcnIpIHx8IF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5fKGFycikgfHwgX25vbl9pdGVyYWJsZV9zcHJlYWQuXygpO1xufVxuZXhwb3J0cy5fID0gX3RvX2NvbnN1bWFibGVfYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3R5cGVfb2YuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190eXBlX29mLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfdHlwZV9vZihvYmopIHtcbiAgICBcIkBzd2MvaGVscGVycyAtIHR5cGVvZlwiO1xuICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqO1xufVxuZXhwb3J0cy5fID0gX3R5cGVfb2Y7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9hcnJheV9saWtlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fYXJyYXlfbGlrZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV9saWtlX3RvX2FycmF5LmNqc1wiKTtcbmZ1bmN0aW9uIF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheShvLCBtaW5MZW4pIHtcbiAgICBpZiAoIW8pIHJldHVybjtcbiAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlfbGlrZV90b19hcnJheS5fKG8sIG1pbkxlbik7XG4gICAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xuICAgIGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obik7XG4gICAgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlfbGlrZV90b19hcnJheS5fKG8sIG1pbkxlbik7XG59XG5leHBvcnRzLl8gPSBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL05hdGl2ZVNjcmlwdE1hbmFnZXIuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvTmF0aXZlU2NyaXB0TWFuYWdlci5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5mdW5jdGlvbiBfZXhwb3J0KHRhcmdldCwgYWxsKSB7XG4gICAgZm9yKHZhciBuYW1lIGluIGFsbClPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBuYW1lLCB7XG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGdldDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihhbGwsIG5hbWUpLmdldFxuICAgIH0pO1xufVxuX2V4cG9ydChleHBvcnRzLCB7XG4gICAgZ2V0IE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZCAoKSB7XG4gICAgICAgIHJldHVybiBOb3JtYWxpemVkU2NyaXB0TG9jYXRvckhUVFBNZXRob2Q7XG4gICAgfSxcbiAgICBnZXQgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlICgpIHtcbiAgICAgICAgcmV0dXJuIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZTtcbiAgICB9LFxuICAgIGdldCBkZWZhdWx0ICgpIHtcbiAgICAgICAgcmV0dXJuIF9kZWZhdWx0O1xuICAgIH1cbn0pO1xudmFyIF9yZWFjdG5hdGl2ZSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZSAqLyBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT83ZDRkXCIpO1xudmFyIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZCA9IGZ1bmN0aW9uKE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZCkge1xuICAgIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZFtcIkdFVFwiXSA9IFwiR0VUXCI7XG4gICAgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kW1wiUE9TVFwiXSA9IFwiUE9TVFwiO1xuICAgIHJldHVybiBOb3JtYWxpemVkU2NyaXB0TG9jYXRvckhUVFBNZXRob2Q7XG59KHt9KTtcbnZhciBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGUgPSBmdW5jdGlvbihOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGUpIHtcbiAgICBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGVbXCJTVFJJQ1RcIl0gPSBcInN0cmljdFwiO1xuICAgIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZVtcIkxBWFwiXSA9IFwibGF4XCI7XG4gICAgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlW1wiT0ZGXCJdID0gXCJvZmZcIjtcbiAgICByZXR1cm4gTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlO1xufSh7fSk7XG52YXIgX2RlZmF1bHQgPSBfcmVhY3RuYXRpdmUuVHVyYm9Nb2R1bGVSZWdpc3RyeS5nZXQoJ1NjcmlwdE1hbmFnZXInKTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvZXZlbnRzL2V2ZW50cy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9ldmVudHMvZXZlbnRzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKG1vZHVsZSkge1xuXCJ1c2Ugc3RyaWN0XCI7XG4vLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIFIgPSB0eXBlb2YgUmVmbGVjdCA9PT0gJ29iamVjdCcgPyBSZWZsZWN0IDogbnVsbDtcbnZhciBSZWZsZWN0QXBwbHkgPSBSICYmIHR5cGVvZiBSLmFwcGx5ID09PSAnZnVuY3Rpb24nID8gUi5hcHBseSA6IGZ1bmN0aW9uIFJlZmxlY3RBcHBseSh0YXJnZXQsIHJlY2VpdmVyLCBhcmdzKSB7XG4gICAgcmV0dXJuIEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseS5jYWxsKHRhcmdldCwgcmVjZWl2ZXIsIGFyZ3MpO1xufTtcbnZhciBSZWZsZWN0T3duS2V5cztcbmlmIChSICYmIHR5cGVvZiBSLm93bktleXMgPT09ICdmdW5jdGlvbicpIHtcbiAgICBSZWZsZWN0T3duS2V5cyA9IFIub3duS2V5cztcbn0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykge1xuICAgIFJlZmxlY3RPd25LZXlzID0gZnVuY3Rpb24gUmVmbGVjdE93bktleXModGFyZ2V0KSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0YXJnZXQpLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHRhcmdldCkpO1xuICAgIH07XG59IGVsc2Uge1xuICAgIFJlZmxlY3RPd25LZXlzID0gZnVuY3Rpb24gUmVmbGVjdE93bktleXModGFyZ2V0KSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0YXJnZXQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBQcm9jZXNzRW1pdFdhcm5pbmcod2FybmluZykge1xuICAgIGlmIChjb25zb2xlICYmIGNvbnNvbGUud2FybikgY29uc29sZS53YXJuKHdhcm5pbmcpO1xufVxudmFyIE51bWJlcklzTmFOID0gTnVtYmVyLmlzTmFOIHx8IGZ1bmN0aW9uIE51bWJlcklzTmFOKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICE9PSB2YWx1ZTtcbn07XG5mdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XG4gICAgRXZlbnRFbWl0dGVyLmluaXQuY2FsbCh0aGlzKTtcbn1cbm1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyO1xubW9kdWxlLmV4cG9ydHMub25jZSA9IG9uY2U7XG4vLyBCYWNrd2FyZHMtY29tcGF0IHdpdGggbm9kZSAwLjEwLnhcbkV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLl9ldmVudHMgPSB1bmRlZmluZWQ7XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLl9ldmVudHNDb3VudCA9IDA7XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLl9tYXhMaXN0ZW5lcnMgPSB1bmRlZmluZWQ7XG4vLyBCeSBkZWZhdWx0IEV2ZW50RW1pdHRlcnMgd2lsbCBwcmludCBhIHdhcm5pbmcgaWYgbW9yZSB0aGFuIDEwIGxpc3RlbmVycyBhcmVcbi8vIGFkZGVkIHRvIGl0LiBUaGlzIGlzIGEgdXNlZnVsIGRlZmF1bHQgd2hpY2ggaGVscHMgZmluZGluZyBtZW1vcnkgbGVha3MuXG52YXIgZGVmYXVsdE1heExpc3RlbmVycyA9IDEwO1xuZnVuY3Rpb24gY2hlY2tMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIFwibGlzdGVuZXJcIiBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGUgRnVuY3Rpb24uIFJlY2VpdmVkIHR5cGUgJyArIHR5cGVvZiBsaXN0ZW5lcik7XG4gICAgfVxufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KEV2ZW50RW1pdHRlciwgJ2RlZmF1bHRNYXhMaXN0ZW5lcnMnLCB7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdE1heExpc3RlbmVycztcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24oYXJnKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYXJnICE9PSAnbnVtYmVyJyB8fCBhcmcgPCAwIHx8IE51bWJlcklzTmFOKGFyZykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdUaGUgdmFsdWUgb2YgXCJkZWZhdWx0TWF4TGlzdGVuZXJzXCIgaXMgb3V0IG9mIHJhbmdlLiBJdCBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlci4gUmVjZWl2ZWQgJyArIGFyZyArICcuJyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmYXVsdE1heExpc3RlbmVycyA9IGFyZztcbiAgICB9XG59KTtcbkV2ZW50RW1pdHRlci5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX2V2ZW50cyA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuX2V2ZW50cyA9PT0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLl9ldmVudHMpIHtcbiAgICAgICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgdGhpcy5fZXZlbnRzQ291bnQgPSAwO1xuICAgIH1cbiAgICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkO1xufTtcbi8vIE9idmlvdXNseSBub3QgYWxsIEVtaXR0ZXJzIHNob3VsZCBiZSBsaW1pdGVkIHRvIDEwLiBUaGlzIGZ1bmN0aW9uIGFsbG93c1xuLy8gdGhhdCB0byBiZSBpbmNyZWFzZWQuIFNldCB0byB6ZXJvIGZvciB1bmxpbWl0ZWQuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnNldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uIHNldE1heExpc3RlbmVycyhuKSB7XG4gICAgaWYgKHR5cGVvZiBuICE9PSAnbnVtYmVyJyB8fCBuIDwgMCB8fCBOdW1iZXJJc05hTihuKSkge1xuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignVGhlIHZhbHVlIG9mIFwiblwiIGlzIG91dCBvZiByYW5nZS4gSXQgbXVzdCBiZSBhIG5vbi1uZWdhdGl2ZSBudW1iZXIuIFJlY2VpdmVkICcgKyBuICsgJy4nKTtcbiAgICB9XG4gICAgdGhpcy5fbWF4TGlzdGVuZXJzID0gbjtcbiAgICByZXR1cm4gdGhpcztcbn07XG5mdW5jdGlvbiBfZ2V0TWF4TGlzdGVuZXJzKHRoYXQpIHtcbiAgICBpZiAodGhhdC5fbWF4TGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHJldHVybiBFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycztcbiAgICByZXR1cm4gdGhhdC5fbWF4TGlzdGVuZXJzO1xufVxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5nZXRNYXhMaXN0ZW5lcnMgPSBmdW5jdGlvbiBnZXRNYXhMaXN0ZW5lcnMoKSB7XG4gICAgcmV0dXJuIF9nZXRNYXhMaXN0ZW5lcnModGhpcyk7XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gZW1pdCh0eXBlKSB7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKWFyZ3MucHVzaChhcmd1bWVudHNbaV0pO1xuICAgIHZhciBkb0Vycm9yID0gdHlwZSA9PT0gJ2Vycm9yJztcbiAgICB2YXIgZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgIT09IHVuZGVmaW5lZCkgZG9FcnJvciA9IGRvRXJyb3IgJiYgZXZlbnRzLmVycm9yID09PSB1bmRlZmluZWQ7XG4gICAgZWxzZSBpZiAoIWRvRXJyb3IpIHJldHVybiBmYWxzZTtcbiAgICAvLyBJZiB0aGVyZSBpcyBubyAnZXJyb3InIGV2ZW50IGxpc3RlbmVyIHRoZW4gdGhyb3cuXG4gICAgaWYgKGRvRXJyb3IpIHtcbiAgICAgICAgdmFyIGVyO1xuICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAwKSBlciA9IGFyZ3NbMF07XG4gICAgICAgIGlmIChlciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAvLyBOb3RlOiBUaGUgY29tbWVudHMgb24gdGhlIGB0aHJvd2AgbGluZXMgYXJlIGludGVudGlvbmFsLCB0aGV5IHNob3dcbiAgICAgICAgICAgIC8vIHVwIGluIE5vZGUncyBvdXRwdXQgaWYgdGhpcyByZXN1bHRzIGluIGFuIHVuaGFuZGxlZCBleGNlcHRpb24uXG4gICAgICAgICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICAgICAgfVxuICAgICAgICAvLyBBdCBsZWFzdCBnaXZlIHNvbWUga2luZCBvZiBjb250ZXh0IHRvIHRoZSB1c2VyXG4gICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ1VuaGFuZGxlZCBlcnJvci4nICsgKGVyID8gJyAoJyArIGVyLm1lc3NhZ2UgKyAnKScgOiAnJykpO1xuICAgICAgICBlcnIuY29udGV4dCA9IGVyO1xuICAgICAgICB0aHJvdyBlcnI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50XG4gICAgfVxuICAgIHZhciBoYW5kbGVyID0gZXZlbnRzW3R5cGVdO1xuICAgIGlmIChoYW5kbGVyID09PSB1bmRlZmluZWQpIHJldHVybiBmYWxzZTtcbiAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgUmVmbGVjdEFwcGx5KGhhbmRsZXIsIHRoaXMsIGFyZ3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBsZW4gPSBoYW5kbGVyLmxlbmd0aDtcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IGFycmF5Q2xvbmUoaGFuZGxlciwgbGVuKTtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKVJlZmxlY3RBcHBseShsaXN0ZW5lcnNbaV0sIHRoaXMsIGFyZ3MpO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5mdW5jdGlvbiBfYWRkTGlzdGVuZXIodGFyZ2V0LCB0eXBlLCBsaXN0ZW5lciwgcHJlcGVuZCkge1xuICAgIHZhciBtO1xuICAgIHZhciBldmVudHM7XG4gICAgdmFyIGV4aXN0aW5nO1xuICAgIGNoZWNrTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIGV2ZW50cyA9IHRhcmdldC5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBldmVudHMgPSB0YXJnZXQuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIHRhcmdldC5fZXZlbnRzQ291bnQgPSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRvIGF2b2lkIHJlY3Vyc2lvbiBpbiB0aGUgY2FzZSB0aGF0IHR5cGUgPT09IFwibmV3TGlzdGVuZXJcIiEgQmVmb3JlXG4gICAgICAgIC8vIGFkZGluZyBpdCB0byB0aGUgbGlzdGVuZXJzLCBmaXJzdCBlbWl0IFwibmV3TGlzdGVuZXJcIi5cbiAgICAgICAgaWYgKGV2ZW50cy5uZXdMaXN0ZW5lciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0YXJnZXQuZW1pdCgnbmV3TGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lci5saXN0ZW5lciA/IGxpc3RlbmVyLmxpc3RlbmVyIDogbGlzdGVuZXIpO1xuICAgICAgICAgICAgLy8gUmUtYXNzaWduIGBldmVudHNgIGJlY2F1c2UgYSBuZXdMaXN0ZW5lciBoYW5kbGVyIGNvdWxkIGhhdmUgY2F1c2VkIHRoZVxuICAgICAgICAgICAgLy8gdGhpcy5fZXZlbnRzIHRvIGJlIGFzc2lnbmVkIHRvIGEgbmV3IG9iamVjdFxuICAgICAgICAgICAgZXZlbnRzID0gdGFyZ2V0Ll9ldmVudHM7XG4gICAgICAgIH1cbiAgICAgICAgZXhpc3RpbmcgPSBldmVudHNbdHlwZV07XG4gICAgfVxuICAgIGlmIChleGlzdGluZyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIE9wdGltaXplIHRoZSBjYXNlIG9mIG9uZSBsaXN0ZW5lci4gRG9uJ3QgbmVlZCB0aGUgZXh0cmEgYXJyYXkgb2JqZWN0LlxuICAgICAgICBleGlzdGluZyA9IGV2ZW50c1t0eXBlXSA9IGxpc3RlbmVyO1xuICAgICAgICArK3RhcmdldC5fZXZlbnRzQ291bnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHR5cGVvZiBleGlzdGluZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgLy8gQWRkaW5nIHRoZSBzZWNvbmQgZWxlbWVudCwgbmVlZCB0byBjaGFuZ2UgdG8gYXJyYXkuXG4gICAgICAgICAgICBleGlzdGluZyA9IGV2ZW50c1t0eXBlXSA9IHByZXBlbmQgPyBbXG4gICAgICAgICAgICAgICAgbGlzdGVuZXIsXG4gICAgICAgICAgICAgICAgZXhpc3RpbmdcbiAgICAgICAgICAgIF0gOiBbXG4gICAgICAgICAgICAgICAgZXhpc3RpbmcsXG4gICAgICAgICAgICAgICAgbGlzdGVuZXJcbiAgICAgICAgICAgIF07XG4gICAgICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgZ290IGFuIGFycmF5LCBqdXN0IGFwcGVuZC5cbiAgICAgICAgfSBlbHNlIGlmIChwcmVwZW5kKSB7XG4gICAgICAgICAgICBleGlzdGluZy51bnNoaWZ0KGxpc3RlbmVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGV4aXN0aW5nLnB1c2gobGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENoZWNrIGZvciBsaXN0ZW5lciBsZWFrXG4gICAgICAgIG0gPSBfZ2V0TWF4TGlzdGVuZXJzKHRhcmdldCk7XG4gICAgICAgIGlmIChtID4gMCAmJiBleGlzdGluZy5sZW5ndGggPiBtICYmICFleGlzdGluZy53YXJuZWQpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nLndhcm5lZCA9IHRydWU7XG4gICAgICAgICAgICAvLyBObyBlcnJvciBjb2RlIGZvciB0aGlzIHNpbmNlIGl0IGlzIGEgV2FybmluZ1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtc3ludGF4XG4gICAgICAgICAgICB2YXIgdyA9IG5ldyBFcnJvcignUG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSBsZWFrIGRldGVjdGVkLiAnICsgZXhpc3RpbmcubGVuZ3RoICsgJyAnICsgU3RyaW5nKHR5cGUpICsgJyBsaXN0ZW5lcnMgJyArICdhZGRlZC4gVXNlIGVtaXR0ZXIuc2V0TWF4TGlzdGVuZXJzKCkgdG8gJyArICdpbmNyZWFzZSBsaW1pdCcpO1xuICAgICAgICAgICAgdy5uYW1lID0gJ01heExpc3RlbmVyc0V4Y2VlZGVkV2FybmluZyc7XG4gICAgICAgICAgICB3LmVtaXR0ZXIgPSB0YXJnZXQ7XG4gICAgICAgICAgICB3LnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdy5jb3VudCA9IGV4aXN0aW5nLmxlbmd0aDtcbiAgICAgICAgICAgIFByb2Nlc3NFbWl0V2FybmluZyh3KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uIGFkZExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgcmV0dXJuIF9hZGRMaXN0ZW5lcih0aGlzLCB0eXBlLCBsaXN0ZW5lciwgZmFsc2UpO1xufTtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub24gPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyO1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5wcmVwZW5kTGlzdGVuZXIgPSBmdW5jdGlvbiBwcmVwZW5kTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICByZXR1cm4gX2FkZExpc3RlbmVyKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCB0cnVlKTtcbn07XG5mdW5jdGlvbiBvbmNlV3JhcHBlcigpIHtcbiAgICBpZiAoIXRoaXMuZmlyZWQpIHtcbiAgICAgICAgdGhpcy50YXJnZXQucmVtb3ZlTGlzdGVuZXIodGhpcy50eXBlLCB0aGlzLndyYXBGbik7XG4gICAgICAgIHRoaXMuZmlyZWQgPSB0cnVlO1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHRoaXMubGlzdGVuZXIuY2FsbCh0aGlzLnRhcmdldCk7XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3RlbmVyLmFwcGx5KHRoaXMudGFyZ2V0LCBhcmd1bWVudHMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIF9vbmNlV3JhcCh0YXJnZXQsIHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIHN0YXRlID0ge1xuICAgICAgICBmaXJlZDogZmFsc2UsXG4gICAgICAgIHdyYXBGbjogdW5kZWZpbmVkLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldCxcbiAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgbGlzdGVuZXI6IGxpc3RlbmVyXG4gICAgfTtcbiAgICB2YXIgd3JhcHBlZCA9IG9uY2VXcmFwcGVyLmJpbmQoc3RhdGUpO1xuICAgIHdyYXBwZWQubGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICBzdGF0ZS53cmFwRm4gPSB3cmFwcGVkO1xuICAgIHJldHVybiB3cmFwcGVkO1xufVxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24gb25jZSh0eXBlLCBsaXN0ZW5lcikge1xuICAgIGNoZWNrTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIHRoaXMub24odHlwZSwgX29uY2VXcmFwKHRoaXMsIHR5cGUsIGxpc3RlbmVyKSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5wcmVwZW5kT25jZUxpc3RlbmVyID0gZnVuY3Rpb24gcHJlcGVuZE9uY2VMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikge1xuICAgIGNoZWNrTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIHRoaXMucHJlcGVuZExpc3RlbmVyKHR5cGUsIF9vbmNlV3JhcCh0aGlzLCB0eXBlLCBsaXN0ZW5lcikpO1xuICAgIHJldHVybiB0aGlzO1xufTtcbi8vIEVtaXRzIGEgJ3JlbW92ZUxpc3RlbmVyJyBldmVudCBpZiBhbmQgb25seSBpZiB0aGUgbGlzdGVuZXIgd2FzIHJlbW92ZWQuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24gcmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgbGlzdCwgZXZlbnRzLCBwb3NpdGlvbiwgaSwgb3JpZ2luYWxMaXN0ZW5lcjtcbiAgICBjaGVja0xpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdGhpcztcbiAgICBsaXN0ID0gZXZlbnRzW3R5cGVdO1xuICAgIGlmIChsaXN0ID09PSB1bmRlZmluZWQpIHJldHVybiB0aGlzO1xuICAgIGlmIChsaXN0ID09PSBsaXN0ZW5lciB8fCBsaXN0Lmxpc3RlbmVyID09PSBsaXN0ZW5lcikge1xuICAgICAgICBpZiAoLS10aGlzLl9ldmVudHNDb3VudCA9PT0gMCkgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgZXZlbnRzW3R5cGVdO1xuICAgICAgICAgICAgaWYgKGV2ZW50cy5yZW1vdmVMaXN0ZW5lcikgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3QubGlzdGVuZXIgfHwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbGlzdCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBwb3NpdGlvbiA9IC0xO1xuICAgICAgICBmb3IoaSA9IGxpc3QubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xuICAgICAgICAgICAgaWYgKGxpc3RbaV0gPT09IGxpc3RlbmVyIHx8IGxpc3RbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxMaXN0ZW5lciA9IGxpc3RbaV0ubGlzdGVuZXI7XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSBpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwb3NpdGlvbiA8IDApIHJldHVybiB0aGlzO1xuICAgICAgICBpZiAocG9zaXRpb24gPT09IDApIGxpc3Quc2hpZnQoKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzcGxpY2VPbmUobGlzdCwgcG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMSkgZXZlbnRzW3R5cGVdID0gbGlzdFswXTtcbiAgICAgICAgaWYgKGV2ZW50cy5yZW1vdmVMaXN0ZW5lciAhPT0gdW5kZWZpbmVkKSB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgb3JpZ2luYWxMaXN0ZW5lciB8fCBsaXN0ZW5lcik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub2ZmID0gRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcjtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gZnVuY3Rpb24gcmVtb3ZlQWxsTGlzdGVuZXJzKHR5cGUpIHtcbiAgICB2YXIgbGlzdGVuZXJzLCBldmVudHMsIGk7XG4gICAgZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXM7XG4gICAgLy8gbm90IGxpc3RlbmluZyBmb3IgcmVtb3ZlTGlzdGVuZXIsIG5vIG5lZWQgdG8gZW1pdFxuICAgIGlmIChldmVudHMucmVtb3ZlTGlzdGVuZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgICAgIHRoaXMuX2V2ZW50c0NvdW50ID0gMDtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudHNbdHlwZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKC0tdGhpcy5fZXZlbnRzQ291bnQgPT09IDApIHRoaXMuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgICAgICBlbHNlIGRlbGV0ZSBldmVudHNbdHlwZV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8vIGVtaXQgcmVtb3ZlTGlzdGVuZXIgZm9yIGFsbCBsaXN0ZW5lcnMgb24gYWxsIGV2ZW50c1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZXZlbnRzKTtcbiAgICAgICAgdmFyIGtleTtcbiAgICAgICAgZm9yKGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7ICsraSl7XG4gICAgICAgICAgICBrZXkgPSBrZXlzW2ldO1xuICAgICAgICAgICAgaWYgKGtleSA9PT0gJ3JlbW92ZUxpc3RlbmVyJykgY29udGludWU7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycyhrZXkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCdyZW1vdmVMaXN0ZW5lcicpO1xuICAgICAgICB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICB0aGlzLl9ldmVudHNDb3VudCA9IDA7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBsaXN0ZW5lcnMgPSBldmVudHNbdHlwZV07XG4gICAgaWYgKHR5cGVvZiBsaXN0ZW5lcnMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpO1xuICAgIH0gZWxzZSBpZiAobGlzdGVuZXJzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gTElGTyBvcmRlclxuICAgICAgICBmb3IoaSA9IGxpc3RlbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyc1tpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuZnVuY3Rpb24gX2xpc3RlbmVycyh0YXJnZXQsIHR5cGUsIHVud3JhcCkge1xuICAgIHZhciBldmVudHMgPSB0YXJnZXQuX2V2ZW50cztcbiAgICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpIHJldHVybiBbXTtcbiAgICB2YXIgZXZsaXN0ZW5lciA9IGV2ZW50c1t0eXBlXTtcbiAgICBpZiAoZXZsaXN0ZW5lciA9PT0gdW5kZWZpbmVkKSByZXR1cm4gW107XG4gICAgaWYgKHR5cGVvZiBldmxpc3RlbmVyID09PSAnZnVuY3Rpb24nKSByZXR1cm4gdW53cmFwID8gW1xuICAgICAgICBldmxpc3RlbmVyLmxpc3RlbmVyIHx8IGV2bGlzdGVuZXJcbiAgICBdIDogW1xuICAgICAgICBldmxpc3RlbmVyXG4gICAgXTtcbiAgICByZXR1cm4gdW53cmFwID8gdW53cmFwTGlzdGVuZXJzKGV2bGlzdGVuZXIpIDogYXJyYXlDbG9uZShldmxpc3RlbmVyLCBldmxpc3RlbmVyLmxlbmd0aCk7XG59XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uIGxpc3RlbmVycyh0eXBlKSB7XG4gICAgcmV0dXJuIF9saXN0ZW5lcnModGhpcywgdHlwZSwgdHJ1ZSk7XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yYXdMaXN0ZW5lcnMgPSBmdW5jdGlvbiByYXdMaXN0ZW5lcnModHlwZSkge1xuICAgIHJldHVybiBfbGlzdGVuZXJzKHRoaXMsIHR5cGUsIGZhbHNlKTtcbn07XG5FdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUpIHtcbiAgICBpZiAodHlwZW9mIGVtaXR0ZXIubGlzdGVuZXJDb3VudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBsaXN0ZW5lckNvdW50LmNhbGwoZW1pdHRlciwgdHlwZSk7XG4gICAgfVxufTtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJDb3VudCA9IGxpc3RlbmVyQ291bnQ7XG5mdW5jdGlvbiBsaXN0ZW5lckNvdW50KHR5cGUpIHtcbiAgICB2YXIgZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgZXZsaXN0ZW5lciA9IGV2ZW50c1t0eXBlXTtcbiAgICAgICAgaWYgKHR5cGVvZiBldmxpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfSBlbHNlIGlmIChldmxpc3RlbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZXZlbnROYW1lcyA9IGZ1bmN0aW9uIGV2ZW50TmFtZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2V2ZW50c0NvdW50ID4gMCA/IFJlZmxlY3RPd25LZXlzKHRoaXMuX2V2ZW50cykgOiBbXTtcbn07XG5mdW5jdGlvbiBhcnJheUNsb25lKGFyciwgbikge1xuICAgIHZhciBjb3B5ID0gbmV3IEFycmF5KG4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBuOyArK2kpY29weVtpXSA9IGFycltpXTtcbiAgICByZXR1cm4gY29weTtcbn1cbmZ1bmN0aW9uIHNwbGljZU9uZShsaXN0LCBpbmRleCkge1xuICAgIGZvcig7IGluZGV4ICsgMSA8IGxpc3QubGVuZ3RoOyBpbmRleCsrKWxpc3RbaW5kZXhdID0gbGlzdFtpbmRleCArIDFdO1xuICAgIGxpc3QucG9wKCk7XG59XG5mdW5jdGlvbiB1bndyYXBMaXN0ZW5lcnMoYXJyKSB7XG4gICAgdmFyIHJldCA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgcmV0Lmxlbmd0aDsgKytpKXtcbiAgICAgICAgcmV0W2ldID0gYXJyW2ldLmxpc3RlbmVyIHx8IGFycltpXTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cbmZ1bmN0aW9uIG9uY2UoZW1pdHRlciwgbmFtZSkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZXJyb3JMaXN0ZW5lcihlcnIpIHtcbiAgICAgICAgICAgIGVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIobmFtZSwgcmVzb2x2ZXIpO1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZXIoKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBlbWl0dGVyLnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIGVycm9yTGlzdGVuZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb2x2ZShbXS5zbGljZS5jYWxsKGFyZ3VtZW50cykpO1xuICAgICAgICB9XG4gICAgICAgIDtcbiAgICAgICAgZXZlbnRUYXJnZXRBZ25vc3RpY0FkZExpc3RlbmVyKGVtaXR0ZXIsIG5hbWUsIHJlc29sdmVyLCB7XG4gICAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobmFtZSAhPT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgYWRkRXJyb3JIYW5kbGVySWZFdmVudEVtaXR0ZXIoZW1pdHRlciwgZXJyb3JMaXN0ZW5lciwge1xuICAgICAgICAgICAgICAgIG9uY2U6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5mdW5jdGlvbiBhZGRFcnJvckhhbmRsZXJJZkV2ZW50RW1pdHRlcihlbWl0dGVyLCBoYW5kbGVyLCBmbGFncykge1xuICAgIGlmICh0eXBlb2YgZW1pdHRlci5vbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBldmVudFRhcmdldEFnbm9zdGljQWRkTGlzdGVuZXIoZW1pdHRlciwgJ2Vycm9yJywgaGFuZGxlciwgZmxhZ3MpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGV2ZW50VGFyZ2V0QWdub3N0aWNBZGRMaXN0ZW5lcihlbWl0dGVyLCBuYW1lLCBsaXN0ZW5lciwgZmxhZ3MpIHtcbiAgICBpZiAodHlwZW9mIGVtaXR0ZXIub24gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgaWYgKGZsYWdzLm9uY2UpIHtcbiAgICAgICAgICAgIGVtaXR0ZXIub25jZShuYW1lLCBsaXN0ZW5lcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbWl0dGVyLm9uKG5hbWUsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGVtaXR0ZXIuYWRkRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBFdmVudFRhcmdldCBkb2VzIG5vdCBoYXZlIGBlcnJvcmAgZXZlbnQgc2VtYW50aWNzIGxpa2UgTm9kZVxuICAgICAgICAvLyBFdmVudEVtaXR0ZXJzLCB3ZSBkbyBub3QgbGlzdGVuIGZvciBgZXJyb3JgIGV2ZW50cyBoZXJlLlxuICAgICAgICBlbWl0dGVyLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgZnVuY3Rpb24gd3JhcExpc3RlbmVyKGFyZykge1xuICAgICAgICAgICAgLy8gSUUgZG9lcyBub3QgaGF2ZSBidWlsdGluIGB7IG9uY2U6IHRydWUgfWAgc3VwcG9ydCBzbyB3ZVxuICAgICAgICAgICAgLy8gaGF2ZSB0byBkbyBpdCBtYW51YWxseS5cbiAgICAgICAgICAgIGlmIChmbGFncy5vbmNlKSB7XG4gICAgICAgICAgICAgICAgZW1pdHRlci5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIHdyYXBMaXN0ZW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsaXN0ZW5lcihhcmcpO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJlbWl0dGVyXCIgYXJndW1lbnQgbXVzdCBiZSBvZiB0eXBlIEV2ZW50RW1pdHRlci4gUmVjZWl2ZWQgdHlwZSAnICsgdHlwZW9mIGVtaXR0ZXIpO1xuICAgIH1cbn1cblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvc2hhbGxvd2VxdWFsL2luZGV4LmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvc2hhbGxvd2VxdWFsL2luZGV4LmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAobW9kdWxlKSB7XG4vL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzaGFsbG93RXF1YWwob2JqQSwgb2JqQiwgY29tcGFyZSwgY29tcGFyZUNvbnRleHQpIHtcbiAgICB2YXIgcmV0ID0gY29tcGFyZSA/IGNvbXBhcmUuY2FsbChjb21wYXJlQ29udGV4dCwgb2JqQSwgb2JqQikgOiB2b2lkIDA7XG4gICAgaWYgKHJldCAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHJldHVybiAhIXJldDtcbiAgICB9XG4gICAgaWYgKG9iakEgPT09IG9iakIpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb2JqQSAhPT0gXCJvYmplY3RcIiB8fCAhb2JqQSB8fCB0eXBlb2Ygb2JqQiAhPT0gXCJvYmplY3RcIiB8fCAhb2JqQikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBrZXlzQSA9IE9iamVjdC5rZXlzKG9iakEpO1xuICAgIHZhciBrZXlzQiA9IE9iamVjdC5rZXlzKG9iakIpO1xuICAgIGlmIChrZXlzQS5sZW5ndGggIT09IGtleXNCLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBiSGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmJpbmQob2JqQik7XG4gICAgLy8gVGVzdCBmb3IgQSdzIGtleXMgZGlmZmVyZW50IGZyb20gQi5cbiAgICBmb3IodmFyIGlkeCA9IDA7IGlkeCA8IGtleXNBLmxlbmd0aDsgaWR4Kyspe1xuICAgICAgICB2YXIga2V5ID0ga2V5c0FbaWR4XTtcbiAgICAgICAgaWYgKCFiSGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWx1ZUEgPSBvYmpBW2tleV07XG4gICAgICAgIHZhciB2YWx1ZUIgPSBvYmpCW2tleV07XG4gICAgICAgIHJldCA9IGNvbXBhcmUgPyBjb21wYXJlLmNhbGwoY29tcGFyZUNvbnRleHQsIHZhbHVlQSwgdmFsdWVCLCBrZXkpIDogdm9pZCAwO1xuICAgICAgICBpZiAocmV0ID09PSBmYWxzZSB8fCByZXQgPT09IHZvaWQgMCAmJiB2YWx1ZUEgIT09IHZhbHVlQikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcblxuXG59KSxcblwiQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvcnNwYWNrLmpzIT0hZGF0YTp0ZXh0L2phdmFzY3JpcHQsaW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fYnVuZGxlcl9ydW50aW1lX18gZnJvbSBcXFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvbXVzaWNzL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanNcXFwiO2ltcG9ydCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXyBmcm9tIFxcXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9tdXNpY3Mvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL3Jlc29sdmVyLXBsdWdpbi5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL211c2ljcy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanNcXFwiO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18gPSBbX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8wX18oKSwgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18oKV07Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXyA9IHt9O2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyA9IFxcXCJtdXNpY3NcXFwiO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyA9IFxcXCJsb2FkZWQtZmlyc3RcXFwiO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YXx8X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpJiZfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24pe3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMjtjb25zdCBvdmVycmlkZT0ob2JqLGtleSx2YWx1ZSk9PntpZighb2JqKXJldHVybjtpZihvYmpba2V5XSlvYmpba2V5XT12YWx1ZX07Y29uc3QgbWVyZ2U9KG9iaixrZXksZm4pPT57Y29uc3QgdmFsdWU9Zm4oKTtpZihBcnJheS5pc0FycmF5KHZhbHVlKSl7dmFyIF9vYmosX2tleTt2YXIgXzsoXz0oX29iaj1vYmopW19rZXk9a2V5XSkhPT1udWxsJiZfIT09dm9pZCAwP186X29ialtfa2V5XT1bXTtvYmpba2V5XS5wdXNoKC4uLnZhbHVlKX1lbHNlIGlmKHR5cGVvZiB2YWx1ZT09PVxcXCJvYmplY3RcXFwiJiZ2YWx1ZSE9PW51bGwpe3ZhciBfb2JqMSxfa2V5MTt2YXIgXzE7KF8xPShfb2JqMT1vYmopW19rZXkxPWtleV0pIT09bnVsbCYmXzEhPT12b2lkIDA/XzE6X29iajFbX2tleTFdPXt9O09iamVjdC5hc3NpZ24ob2JqW2tleV0sdmFsdWUpfX07Y29uc3QgZWFybHk9KG9iaixrZXksaW5pdGlhbCk9Pnt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPWluaXRpYWwoKX07dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCByZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZztjb25zdCByZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9X193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEubW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc7Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEuc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLmNodW5rTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nO2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nOnt9O2NvbnN0IGNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXM9e307Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdJbml0UHJvbWlzZXM9W107Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zPXt9O2NvbnN0IGNvbnRhaW5lclNoYXJlU2NvcGU9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YS5zaGFyZVNjb3BlO2Zvcihjb25zdCBrZXkgaW4gX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uW2tleV09X19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfX1trZXldfWVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1xcXCIsKCk9Pntjb25zdCBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nPXt9O2ZvcihsZXRbbW9kdWxlSWQsZGF0YV1vZiBPYmplY3QuZW50cmllcyhjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZykpe2NvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdbbW9kdWxlSWRdPXtnZXR0ZXI6ZGF0YS5mYWxsYmFjayxzaGFyZUluZm86e3NoYXJlQ29uZmlnOntmaXhlZERlcGVuZGVuY2llczpmYWxzZSxyZXF1aXJlZFZlcnNpb246ZGF0YS5yZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbjpkYXRhLnN0cmljdFZlcnNpb24sc2luZ2xldG9uOmRhdGEuc2luZ2xldG9uLGVhZ2VyOmRhdGEuZWFnZXJ9LHNjb3BlOltkYXRhLnNoYXJlU2NvcGVdfSxzaGFyZUtleTpkYXRhLnNoYXJlS2V5fX1yZXR1cm4gY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiaW5pdE9wdGlvbnNcXFwiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXFxcIm5hbWVcXFwiLCgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwic2hhcmVTdHJhdGVneVxcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJzaGFyZWRcXFwiLCgpPT57Y29uc3Qgc2hhcmVkPXt9O2ZvcihsZXRbc2NvcGUsc3RhZ2VzXW9mIE9iamVjdC5lbnRyaWVzKGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZykpe2ZvcihsZXQgc3RhZ2Ugb2Ygc3RhZ2VzKXtpZih0eXBlb2Ygc3RhZ2U9PT1cXFwib2JqZWN0XFxcIiYmc3RhZ2UhPT1udWxsKXtjb25zdHtuYW1lLHZlcnNpb24sZmFjdG9yeSxlYWdlcixzaW5nbGV0b24scmVxdWlyZWRWZXJzaW9uLHN0cmljdFZlcnNpb259PXN0YWdlO2NvbnN0IHNoYXJlQ29uZmlnPXt9O2NvbnN0IGlzVmFsaWRWYWx1ZT1mdW5jdGlvbih2YWwpe3JldHVybiB0eXBlb2YgdmFsIT09XFxcInVuZGVmaW5lZFxcXCJ9O2lmKGlzVmFsaWRWYWx1ZShzaW5nbGV0b24pKXtzaGFyZUNvbmZpZy5zaW5nbGV0b249c2luZ2xldG9ufWlmKGlzVmFsaWRWYWx1ZShyZXF1aXJlZFZlcnNpb24pKXtzaGFyZUNvbmZpZy5yZXF1aXJlZFZlcnNpb249cmVxdWlyZWRWZXJzaW9ufWlmKGlzVmFsaWRWYWx1ZShlYWdlcikpe3NoYXJlQ29uZmlnLmVhZ2VyPWVhZ2VyfWlmKGlzVmFsaWRWYWx1ZShzdHJpY3RWZXJzaW9uKSl7c2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbj1zdHJpY3RWZXJzaW9ufWNvbnN0IG9wdGlvbnM9e3ZlcnNpb24sc2NvcGU6W3Njb3BlXSxzaGFyZUNvbmZpZyxnZXQ6ZmFjdG9yeX07aWYoc2hhcmVkW25hbWVdKXtzaGFyZWRbbmFtZV0ucHVzaChvcHRpb25zKX1lbHNle3NoYXJlZFtuYW1lXT1bb3B0aW9uc119fX19cmV0dXJuIHNoYXJlZH0pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwicmVtb3Rlc1xcXCIsKCk9Pk9iamVjdC52YWx1ZXMoX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXykuZmxhdCgpLmZpbHRlcihyZW1vdGU9PnJlbW90ZS5leHRlcm5hbFR5cGU9PT1cXFwic2NyaXB0XFxcIikpO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwicGx1Z2luc1xcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiYnVuZGxlclJ1bnRpbWVPcHRpb25zXFxcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucyxcXFwicmVtb3Rlc1xcXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiY2h1bmtNYXBwaW5nXFxcIiwoKT0+cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdcXFwiLCgpPT57Y29uc3QgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7cmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmdbbW9kdWxlSWRdPVtkYXRhLnNoYXJlU2NvcGUsZGF0YS5uYW1lLGRhdGEuZXh0ZXJuYWxNb2R1bGVJZCxkYXRhLnJlbW90ZU5hbWVdfXJldHVybiByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwid2VicGFja1JlcXVpcmVcXFwiLCgpPT5fX3dlYnBhY2tfcmVxdWlyZV9fKTttZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsXFxcImlkVG9SZW1vdGVNYXBcXFwiLCgpPT57Y29uc3QgaWRUb1JlbW90ZU1hcD17fTtmb3IobGV0W2lkLHJlbW90ZURhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtjb25zdCBpbmZvPV9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX19bcmVtb3RlRGF0YS5yZW1vdGVOYW1lXTtpZihpbmZvKWlkVG9SZW1vdGVNYXBbaWRdPWluZm99cmV0dXJuIGlkVG9SZW1vdGVNYXB9KTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJTXFxcIixfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuUyk7aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKF9fd2VicGFja19yZXF1aXJlX18pfW92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcXFwicmVtb3Rlc1xcXCIsKGNodW5rSWQscHJvbWlzZXMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUucmVtb3Rlcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcsaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nLGlkVG9SZW1vdGVNYXA6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9SZW1vdGVNYXAsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLmYsXFxcImNvbnN1bWVzXFxcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5jb25zdW1lcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6Y29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmcsaW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcXFwiSVxcXCIsKG5hbWUsaW5pdFNjb3BlKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLkkoe3NoYXJlU2NvcGVOYW1lOm5hbWUsaW5pdFNjb3BlLGluaXRQcm9taXNlczppbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcyxpbml0VG9rZW5zOmluaXRpYWxpemVTaGFyaW5nSW5pdFRva2Vucyx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcImluaXRDb250YWluZXJcXFwiLChzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluaXRDb250YWluZXJFbnRyeSh7c2hhcmVTY29wZSxpbml0U2NvcGUscmVtb3RlRW50cnlJbml0T3B0aW9ucyxzaGFyZVNjb3BlS2V5OmNvbnRhaW5lclNoYXJlU2NvcGUsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJnZXRDb250YWluZXJcXFwiLChtb2R1bGUxLGdldFNjb3BlKT0+e3ZhciBtb2R1bGVNYXA9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEubW9kdWxlTWFwO19fd2VicGFja19yZXF1aXJlX18uUj1nZXRTY29wZTtnZXRTY29wZT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kdWxlTWFwLG1vZHVsZTEpP21vZHVsZU1hcFttb2R1bGUxXSgpOlByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCk9Pnt0aHJvdyBuZXcgRXJyb3IoJ01vZHVsZSBcXFwiJyttb2R1bGUxKydcXFwiIGRvZXMgbm90IGV4aXN0IGluIGNvbnRhaW5lci4nKX0pO19fd2VicGFja19yZXF1aXJlX18uUj11bmRlZmluZWQ7cmV0dXJuIGdldFNjb3BlfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluc3RhbmNlPV9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5ydW50aW1lLmluaXQoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zKTtpZigoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMi5pbml0aWFsQ29uc3VtZXMpe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbnN0YWxsSW5pdGlhbENvbnN1bWVzKHt3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9fLGluc3RhbGxlZE1vZHVsZXM6Y29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyxpbml0aWFsQ29uc3VtZXM6X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhLmluaXRpYWxDb25zdW1lcyxtb2R1bGVUb0hhbmRsZXJNYXBwaW5nOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSl9fVwiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiBAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9yc3BhY2suanMhPSFkYXRhOnRleHQvamF2YXNjcmlwdCxpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyBmcm9tIFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvbXVzaWNzL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanNcIjtpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8wX18gZnJvbSBcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL211c2ljcy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fIGZyb20gXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9tdXNpY3Mvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyA9IFtfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXygpLCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzFfXygpXTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fID0ge307Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fID0gXCJtdXNpY3NcIjtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3NoYXJlX3N0cmF0ZWd5X18gPSBcImxvYWRlZC1maXJzdFwiO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YXx8X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpJiZfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24pe3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMjtjb25zdCBvdmVycmlkZT0ob2JqLGtleSx2YWx1ZSk9PntpZighb2JqKXJldHVybjtpZihvYmpba2V5XSlvYmpba2V5XT12YWx1ZX07Y29uc3QgbWVyZ2U9KG9iaixrZXksZm4pPT57Y29uc3QgdmFsdWU9Zm4oKTtpZihBcnJheS5pc0FycmF5KHZhbHVlKSl7dmFyIF9vYmosX2tleTt2YXIgXzsoXz0oX29iaj1vYmopW19rZXk9a2V5XSkhPT1udWxsJiZfIT09dm9pZCAwP186X29ialtfa2V5XT1bXTtvYmpba2V5XS5wdXNoKC4uLnZhbHVlKX1lbHNlIGlmKHR5cGVvZiB2YWx1ZT09PVwib2JqZWN0XCImJnZhbHVlIT09bnVsbCl7dmFyIF9vYmoxLF9rZXkxO3ZhciBfMTsoXzE9KF9vYmoxPW9iailbX2tleTE9a2V5XSkhPT1udWxsJiZfMSE9PXZvaWQgMD9fMTpfb2JqMVtfa2V5MV09e307T2JqZWN0LmFzc2lnbihvYmpba2V5XSx2YWx1ZSl9fTtjb25zdCBlYXJseT0ob2JqLGtleSxpbml0aWFsKT0+e3ZhciBfb2JqLF9rZXk7dmFyIF87KF89KF9vYmo9b2JqKVtfa2V5PWtleV0pIT09bnVsbCYmXyE9PXZvaWQgMD9fOl9vYmpbX2tleV09aW5pdGlhbCgpfTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZztjb25zdCBpbml0aWFsaXplU2hhcmluZ1Njb3BlVG9Jbml0RGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCBjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc6e307Y29uc3QgY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcz17fTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcz1bXTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRUb2tlbnM9e307Y29uc3QgY29udGFpbmVyU2hhcmVTY29wZT0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLnNoYXJlU2NvcGU7Zm9yKGNvbnN0IGtleSBpbiBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fKXtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb25ba2V5XT1fX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fW2tleV19ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFwiY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1wiLCgpPT57Y29uc3QgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZz17fTtmb3IobGV0W21vZHVsZUlkLGRhdGFdb2YgT2JqZWN0LmVudHJpZXMoY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmcpKXtjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nW21vZHVsZUlkXT17Z2V0dGVyOmRhdGEuZmFsbGJhY2ssc2hhcmVJbmZvOntzaGFyZUNvbmZpZzp7Zml4ZWREZXBlbmRlbmNpZXM6ZmFsc2UscmVxdWlyZWRWZXJzaW9uOmRhdGEucmVxdWlyZWRWZXJzaW9uLHN0cmljdFZlcnNpb246ZGF0YS5zdHJpY3RWZXJzaW9uLHNpbmdsZXRvbjpkYXRhLnNpbmdsZXRvbixlYWdlcjpkYXRhLmVhZ2VyfSxzY29wZTpbZGF0YS5zaGFyZVNjb3BlXX0sc2hhcmVLZXk6ZGF0YS5zaGFyZUtleX19cmV0dXJuIGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmd9KTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sXCJpbml0T3B0aW9uc1wiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXCJuYW1lXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFwic2hhcmVTdHJhdGVneVwiLCgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX3NoYXJlX3N0cmF0ZWd5X18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcInNoYXJlZFwiLCgpPT57Y29uc3Qgc2hhcmVkPXt9O2ZvcihsZXRbc2NvcGUsc3RhZ2VzXW9mIE9iamVjdC5lbnRyaWVzKGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZykpe2ZvcihsZXQgc3RhZ2Ugb2Ygc3RhZ2VzKXtpZih0eXBlb2Ygc3RhZ2U9PT1cIm9iamVjdFwiJiZzdGFnZSE9PW51bGwpe2NvbnN0e25hbWUsdmVyc2lvbixmYWN0b3J5LGVhZ2VyLHNpbmdsZXRvbixyZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbn09c3RhZ2U7Y29uc3Qgc2hhcmVDb25maWc9e307Y29uc3QgaXNWYWxpZFZhbHVlPWZ1bmN0aW9uKHZhbCl7cmV0dXJuIHR5cGVvZiB2YWwhPT1cInVuZGVmaW5lZFwifTtpZihpc1ZhbGlkVmFsdWUoc2luZ2xldG9uKSl7c2hhcmVDb25maWcuc2luZ2xldG9uPXNpbmdsZXRvbn1pZihpc1ZhbGlkVmFsdWUocmVxdWlyZWRWZXJzaW9uKSl7c2hhcmVDb25maWcucmVxdWlyZWRWZXJzaW9uPXJlcXVpcmVkVmVyc2lvbn1pZihpc1ZhbGlkVmFsdWUoZWFnZXIpKXtzaGFyZUNvbmZpZy5lYWdlcj1lYWdlcn1pZihpc1ZhbGlkVmFsdWUoc3RyaWN0VmVyc2lvbikpe3NoYXJlQ29uZmlnLnN0cmljdFZlcnNpb249c3RyaWN0VmVyc2lvbn1jb25zdCBvcHRpb25zPXt2ZXJzaW9uLHNjb3BlOltzY29wZV0sc2hhcmVDb25maWcsZ2V0OmZhY3Rvcnl9O2lmKHNoYXJlZFtuYW1lXSl7c2hhcmVkW25hbWVdLnB1c2gob3B0aW9ucyl9ZWxzZXtzaGFyZWRbbmFtZV09W29wdGlvbnNdfX19fXJldHVybiBzaGFyZWR9KTttZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXCJyZW1vdGVzXCIsKCk9Pk9iamVjdC52YWx1ZXMoX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXykuZmxhdCgpLmZpbHRlcihyZW1vdGU9PnJlbW90ZS5leHRlcm5hbFR5cGU9PT1cInNjcmlwdFwiKSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFwicGx1Z2luc1wiLCgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luc19fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sXCJidW5kbGVyUnVudGltZU9wdGlvbnNcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucyxcInJlbW90ZXNcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFwiY2h1bmtNYXBwaW5nXCIsKCk9PnJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1wiLCgpPT57Y29uc3QgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7cmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmdbbW9kdWxlSWRdPVtkYXRhLnNoYXJlU2NvcGUsZGF0YS5uYW1lLGRhdGEuZXh0ZXJuYWxNb2R1bGVJZCxkYXRhLnJlbW90ZU5hbWVdfXJldHVybiByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcIndlYnBhY2tSZXF1aXJlXCIsKCk9Pl9fd2VicGFja19yZXF1aXJlX18pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcImlkVG9SZW1vdGVNYXBcIiwoKT0+e2NvbnN0IGlkVG9SZW1vdGVNYXA9e307Zm9yKGxldFtpZCxyZW1vdGVEYXRhXW9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7Y29uc3QgaW5mbz1fX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fW3JlbW90ZURhdGEucmVtb3RlTmFtZV07aWYoaW5mbylpZFRvUmVtb3RlTWFwW2lkXT1pbmZvfXJldHVybiBpZFRvUmVtb3RlTWFwfSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcIlNcIixfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuUyk7aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKF9fd2VicGFja19yZXF1aXJlX18pfW92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcInJlbW90ZXNcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpyZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyxpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsaWRUb1JlbW90ZU1hcDpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb1JlbW90ZU1hcCx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcImNvbnN1bWVzXCIsKGNodW5rSWQscHJvbWlzZXMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuY29uc3VtZXMoe2NodW5rSWQscHJvbWlzZXMsY2h1bmtNYXBwaW5nOmNvbnN1bWVzTG9hZGluZ0NodW5rTWFwcGluZyxtb2R1bGVUb0hhbmRsZXJNYXBwaW5nOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nLGluc3RhbGxlZE1vZHVsZXM6Y29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXCJJXCIsKG5hbWUsaW5pdFNjb3BlKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLkkoe3NoYXJlU2NvcGVOYW1lOm5hbWUsaW5pdFNjb3BlLGluaXRQcm9taXNlczppbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcyxpbml0VG9rZW5zOmluaXRpYWxpemVTaGFyaW5nSW5pdFRva2Vucyx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXCJpbml0Q29udGFpbmVyXCIsKHNoYXJlU2NvcGUsaW5pdFNjb3BlLHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5pdENvbnRhaW5lckVudHJ5KHtzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zLHNoYXJlU2NvcGVLZXk6Y29udGFpbmVyU2hhcmVTY29wZSx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXCJnZXRDb250YWluZXJcIiwobW9kdWxlMSxnZXRTY29wZSk9Pnt2YXIgbW9kdWxlTWFwPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhLm1vZHVsZU1hcDtfX3dlYnBhY2tfcmVxdWlyZV9fLlI9Z2V0U2NvcGU7Z2V0U2NvcGU9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZHVsZU1hcCxtb2R1bGUxKT9tb2R1bGVNYXBbbW9kdWxlMV0oKTpQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpPT57dGhyb3cgbmV3IEVycm9yKCdNb2R1bGUgXCInK21vZHVsZTErJ1wiIGRvZXMgbm90IGV4aXN0IGluIGNvbnRhaW5lci4nKX0pO19fd2VicGFja19yZXF1aXJlX18uUj11bmRlZmluZWQ7cmV0dXJuIGdldFNjb3BlfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluc3RhbmNlPV9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5ydW50aW1lLmluaXQoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zKTtpZigoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMi5pbml0aWFsQ29uc3VtZXMpe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbnN0YWxsSW5pdGlhbENvbnN1bWVzKHt3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9fLGluc3RhbGxlZE1vZHVsZXM6Y29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyxpbml0aWFsQ29uc3VtZXM6X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhLmluaXRpYWxDb25zdW1lcyxtb2R1bGVUb0hhbmRsZXJNYXBwaW5nOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSl9fSAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG52YXIgX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuY2pzXCIpO1xudmFyIF9zbGljZWRfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fc2xpY2VkX3RvX2FycmF5ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2xpY2VkX3RvX2FycmF5LmNqc1wiKTtcbnZhciBfdG9fY29uc3VtYWJsZV9hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL190b19jb25zdW1hYmxlX2FycmF5ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fY29uc3VtYWJsZV9hcnJheS5janNcIik7XG52YXIgX2luZGV4Y2pzID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanNcIikpO1xudmFyIF9yZXNvbHZlcnBsdWdpbiA9IC8qI19fUFVSRV9fKi8gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0Ll8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzXCIpKTtcbnZhciBfY29yZXBsdWdpbiA9IC8qI19fUFVSRV9fKi8gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0Ll8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qc1wiKSk7XG52YXIgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyA9IFtcbiAgICAoMCwgX3Jlc29sdmVycGx1Z2luLmRlZmF1bHQpKCksXG4gICAgKDAsIF9jb3JlcGx1Z2luLmRlZmF1bHQpKClcbl07XG52YXIgX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXyA9IHt9O1xudmFyIF9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyA9IFwibXVzaWNzXCI7XG52YXIgX19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fID0gXCJsb2FkZWQtZmlyc3RcIjtcbmlmICgoX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEgfHwgX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpICYmIF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbikge1xuICAgIHZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YSwgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMjtcbiAgICB2YXIgb3ZlcnJpZGUgPSAob2JqLCBrZXksIHZhbHVlKT0+e1xuICAgICAgICBpZiAoIW9iaikgcmV0dXJuO1xuICAgICAgICBpZiAob2JqW2tleV0pIG9ialtrZXldID0gdmFsdWU7XG4gICAgfTtcbiAgICB2YXIgbWVyZ2UgPSAob2JqLCBrZXksIGZuKT0+e1xuICAgICAgICB2YXIgdmFsdWUgPSBmbigpO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHZhciBfb2JqX2tleTtcbiAgICAgICAgICAgIHZhciBfb2JqLCBfa2V5O1xuICAgICAgICAgICAgdmFyIF87XG4gICAgICAgICAgICAoXyA9IChfb2JqID0gb2JqKVtfa2V5ID0ga2V5XSkgIT09IG51bGwgJiYgXyAhPT0gdm9pZCAwID8gXyA6IF9vYmpbX2tleV0gPSBbXTtcbiAgICAgICAgICAgIChfb2JqX2tleSA9IG9ialtrZXldKS5wdXNoLmFwcGx5KF9vYmpfa2V5LCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKHZhbHVlKSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgX29iajEsIF9rZXkxO1xuICAgICAgICAgICAgdmFyIF8xO1xuICAgICAgICAgICAgKF8xID0gKF9vYmoxID0gb2JqKVtfa2V5MSA9IGtleV0pICE9PSBudWxsICYmIF8xICE9PSB2b2lkIDAgPyBfMSA6IF9vYmoxW19rZXkxXSA9IHt9O1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihvYmpba2V5XSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgZWFybHkgPSAob2JqLCBrZXksIGluaXRpYWwpPT57XG4gICAgICAgIHZhciBfb2JqLCBfa2V5O1xuICAgICAgICB2YXIgXztcbiAgICAgICAgKF8gPSAoX29iaiA9IG9iailbX2tleSA9IGtleV0pICE9PSBudWxsICYmIF8gIT09IHZvaWQgMCA/IF8gOiBfb2JqW19rZXldID0gaW5pdGlhbCgpO1xuICAgIH07XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztcbiAgICB2YXIgcmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZyAhPT0gdm9pZCAwID8gX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZztcbiAgICB2YXIgcmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSA9IF9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZyAhPT0gdm9pZCAwID8gX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc7XG4gICAgdmFyIGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSAhPT0gbnVsbCAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc7XG4gICAgdmFyIGNvbnN1bWVzTG9hZGluZ0NodW5rTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YSA9IF9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSAhPT0gbnVsbCAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nO1xuICAgIHZhciBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExID0gX193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZyA6IHt9O1xuICAgIHZhciBjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzID0ge307XG4gICAgdmFyIGluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzID0gW107XG4gICAgdmFyIGluaXRpYWxpemVTaGFyaW5nSW5pdFRva2VucyA9IHt9O1xuICAgIHZhciBjb250YWluZXJTaGFyZVNjb3BlID0gKF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YS5zaGFyZVNjb3BlO1xuICAgIGZvcih2YXIga2V5IGluIF9pbmRleGNqcy5kZWZhdWx0KXtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uW2tleV0gPSBfaW5kZXhjanMuZGVmYXVsdFtrZXldO1xuICAgIH1cbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sIFwiY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1wiLCAoKT0+e1xuICAgICAgICB2YXIgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZyA9IHt9O1xuICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMoY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmcpKXtcbiAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMiksIG1vZHVsZUlkID0gX3JlZlswXSwgZGF0YSA9IF9yZWZbMV07XG4gICAgICAgICAgICBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nW21vZHVsZUlkXSA9IHtcbiAgICAgICAgICAgICAgICBnZXR0ZXI6IGRhdGEuZmFsbGJhY2ssXG4gICAgICAgICAgICAgICAgc2hhcmVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZERlcGVuZGVuY2llczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZFZlcnNpb246IGRhdGEucmVxdWlyZWRWZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaWN0VmVyc2lvbjogZGF0YS5zdHJpY3RWZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2luZ2xldG9uOiBkYXRhLnNpbmdsZXRvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGVhZ2VyOiBkYXRhLmVhZ2VyXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnNoYXJlU2NvcGVcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2hhcmVLZXk6IGRhdGEuc2hhcmVLZXlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmc7XG4gICAgfSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLCBcImluaXRPcHRpb25zXCIsICgpPT4oe30pKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwibmFtZVwiLCAoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwic2hhcmVTdHJhdGVneVwiLCAoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwic2hhcmVkXCIsICgpPT57XG4gICAgICAgIHZhciBzaGFyZWQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgcmVmIG9mIE9iamVjdC5lbnRyaWVzKGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZykpe1xuICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgc2NvcGUgPSBfcmVmWzBdLCBzdGFnZXMgPSBfcmVmWzFdO1xuICAgICAgICAgICAgZm9yICh2YXIgc3RhZ2Ugb2Ygc3RhZ2VzKXtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0YWdlID09PSBcIm9iamVjdFwiICYmIHN0YWdlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gc3RhZ2UubmFtZSwgdmVyc2lvbiA9IHN0YWdlLnZlcnNpb24sIGZhY3RvcnkgPSBzdGFnZS5mYWN0b3J5LCBlYWdlciA9IHN0YWdlLmVhZ2VyLCBzaW5nbGV0b24gPSBzdGFnZS5zaW5nbGV0b24sIHJlcXVpcmVkVmVyc2lvbiA9IHN0YWdlLnJlcXVpcmVkVmVyc2lvbiwgc3RyaWN0VmVyc2lvbiA9IHN0YWdlLnN0cmljdFZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZUNvbmZpZyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNWYWxpZFZhbHVlID0gZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbCAhPT0gXCJ1bmRlZmluZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShzaW5nbGV0b24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUNvbmZpZy5zaW5nbGV0b24gPSBzaW5nbGV0b247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShyZXF1aXJlZFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUNvbmZpZy5yZXF1aXJlZFZlcnNpb24gPSByZXF1aXJlZFZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShlYWdlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnLmVhZ2VyID0gZWFnZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShzdHJpY3RWZXJzaW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbiA9IHN0cmljdFZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZVxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0OiBmYWN0b3J5XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWRbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZFtuYW1lXS5wdXNoKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkW25hbWVdID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNoYXJlZDtcbiAgICB9KTtcbiAgICBtZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwicmVtb3Rlc1wiLCAoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKChyZW1vdGUpPT5yZW1vdGUuZXh0ZXJuYWxUeXBlID09PSBcInNjcmlwdFwiKSk7XG4gICAgbWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLCBcInBsdWdpbnNcIiwgKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18pO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbiwgXCJidW5kbGVyUnVudGltZU9wdGlvbnNcIiwgKCk9Pih7fSkpO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMsIFwicmVtb3Rlc1wiLCAoKT0+KHt9KSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLCBcImNodW5rTWFwcGluZ1wiLCAoKT0+cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcpO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcywgXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1wiLCAoKT0+e1xuICAgICAgICB2YXIgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmcgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgcmVmIG9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7XG4gICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDIpLCBtb2R1bGVJZCA9IF9yZWZbMF0sIGRhdGEgPSBfcmVmWzFdO1xuICAgICAgICAgICAgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmdbbW9kdWxlSWRdID0gW1xuICAgICAgICAgICAgICAgIGRhdGEuc2hhcmVTY29wZSxcbiAgICAgICAgICAgICAgICBkYXRhLm5hbWUsXG4gICAgICAgICAgICAgICAgZGF0YS5leHRlcm5hbE1vZHVsZUlkLFxuICAgICAgICAgICAgICAgIGRhdGEucmVtb3RlTmFtZVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmc7XG4gICAgfSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLCBcIndlYnBhY2tSZXF1aXJlXCIsICgpPT5fX3dlYnBhY2tfcmVxdWlyZV9fKTtcbiAgICBtZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsIFwiaWRUb1JlbW90ZU1hcFwiLCAoKT0+e1xuICAgICAgICB2YXIgaWRUb1JlbW90ZU1hcCA9IHt9O1xuICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtcbiAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMiksIGlkID0gX3JlZlswXSwgcmVtb3RlRGF0YSA9IF9yZWZbMV07XG4gICAgICAgICAgICB2YXIgaW5mbyA9IF9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX19bcmVtb3RlRGF0YS5yZW1vdGVOYW1lXTtcbiAgICAgICAgICAgIGlmIChpbmZvKSBpZFRvUmVtb3RlTWFwW2lkXSA9IGluZm87XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlkVG9SZW1vdGVNYXA7XG4gICAgfSk7XG4gICAgb3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXywgXCJTXCIsIF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtcbiAgICBpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApIHtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4gICAgfVxuICAgIG92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZiwgXCJyZW1vdGVzXCIsIChjaHVua0lkLCBwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtcbiAgICAgICAgICAgIGNodW5rSWQsXG4gICAgICAgICAgICBwcm9taXNlcyxcbiAgICAgICAgICAgIGNodW5rTWFwcGluZzogcmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcsXG4gICAgICAgICAgICBpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nLFxuICAgICAgICAgICAgaWRUb1JlbW90ZU1hcDogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9SZW1vdGVNYXAsXG4gICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZTogX193ZWJwYWNrX3JlcXVpcmVfX1xuICAgICAgICB9KSk7XG4gICAgb3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLCBcImNvbnN1bWVzXCIsIChjaHVua0lkLCBwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5jb25zdW1lcyh7XG4gICAgICAgICAgICBjaHVua0lkLFxuICAgICAgICAgICAgcHJvbWlzZXMsXG4gICAgICAgICAgICBjaHVua01hcHBpbmc6IGNvbnN1bWVzTG9hZGluZ0NodW5rTWFwcGluZyxcbiAgICAgICAgICAgIG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6IF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nLFxuICAgICAgICAgICAgaW5zdGFsbGVkTW9kdWxlczogY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyxcbiAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlOiBfX3dlYnBhY2tfcmVxdWlyZV9fXG4gICAgICAgIH0pKTtcbiAgICBvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLCBcIklcIiwgKG5hbWUsIGluaXRTY29wZSk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5JKHtcbiAgICAgICAgICAgIHNoYXJlU2NvcGVOYW1lOiBuYW1lLFxuICAgICAgICAgICAgaW5pdFNjb3BlLFxuICAgICAgICAgICAgaW5pdFByb21pc2VzOiBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcyxcbiAgICAgICAgICAgIGluaXRUb2tlbnM6IGluaXRpYWxpemVTaGFyaW5nSW5pdFRva2VucyxcbiAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlOiBfX3dlYnBhY2tfcmVxdWlyZV9fXG4gICAgICAgIH0pKTtcbiAgICBvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLCBcImluaXRDb250YWluZXJcIiwgKHNoYXJlU2NvcGUsIGluaXRTY29wZSwgcmVtb3RlRW50cnlJbml0T3B0aW9ucyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbml0Q29udGFpbmVyRW50cnkoe1xuICAgICAgICAgICAgc2hhcmVTY29wZSxcbiAgICAgICAgICAgIGluaXRTY29wZSxcbiAgICAgICAgICAgIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsXG4gICAgICAgICAgICBzaGFyZVNjb3BlS2V5OiBjb250YWluZXJTaGFyZVNjb3BlLFxuICAgICAgICAgICAgd2VicGFja1JlcXVpcmU6IF9fd2VicGFja19yZXF1aXJlX19cbiAgICAgICAgfSkpO1xuICAgIG92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sIFwiZ2V0Q29udGFpbmVyXCIsIChtb2R1bGUxLCBnZXRTY29wZSk9PntcbiAgICAgICAgdmFyIG1vZHVsZU1hcCA9IF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhLm1vZHVsZU1hcDtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5SID0gZ2V0U2NvcGU7XG4gICAgICAgIGdldFNjb3BlID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZHVsZU1hcCwgbW9kdWxlMSkgPyBtb2R1bGVNYXBbbW9kdWxlMV0oKSA6IFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCk9PntcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTW9kdWxlIFwiJyArIG1vZHVsZTEgKyAnXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpO1xuICAgICAgICB9KTtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5SID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gZ2V0U2NvcGU7XG4gICAgfSk7XG4gICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluc3RhbmNlID0gX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO1xuICAgIGlmICgoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMiA9IF9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMi5pbml0aWFsQ29uc3VtZXMpIHtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe1xuICAgICAgICAgICAgd2VicGFja1JlcXVpcmU6IF9fd2VicGFja19yZXF1aXJlX18sXG4gICAgICAgICAgICBpbnN0YWxsZWRNb2R1bGVzOiBjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLFxuICAgICAgICAgICAgaW5pdGlhbENvbnN1bWVzOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLFxuICAgICAgICAgICAgbW9kdWxlVG9IYW5kbGVyTWFwcGluZzogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5cbn0pLFxuXCJ3ZWJwYWNrL2NvbnRhaW5lci9lbnRyeS9tdXNpY3NcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiBjb250YWluZXIgZW50cnkgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbl9fd2VicGFja19yZXF1aXJlX18uZChleHBvcnRzLCB7XG5cdGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmdldENvbnRhaW5lcjsgfSxcblx0aW5pdDogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRDb250YWluZXI7IH1cbn0pO1xuXG59KSxcblxufSk7XG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4vLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbnZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuaWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5yZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG59XG4vLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxudmFyIG1vZHVsZSA9IChfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuaWQ6IG1vZHVsZUlkLFxubG9hZGVkOiBmYWxzZSxcbmV4cG9ydHM6IHt9XG59KTtcbi8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuX193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbi8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbm1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbnJldHVybiBtb2R1bGUuZXhwb3J0cztcblxufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbl9fd2VicGFja19yZXF1aXJlX18uYyA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfXztcblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8vIG1vZHVsZV9mZWRlcmF0aW9uL3J1bnRpbWVcbiFmdW5jdGlvbigpIHtcblxuaWYoIV9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbil7XG4gICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uID0ge1xuICAgICAgICBcbmNodW5rTWF0Y2hlcjogZnVuY3Rpb24oY2h1bmtJZCkge1xuICAgIHJldHVybiAhL14oXFwtd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdFxcLV8oMTUzOXwzMWQ0KXx3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0XFwtbmF0aXZlXyhhc3NldHNcXC1yZWdpc3RyeV8ocGF0aFxcLXN1cHBvcnRfcmVhY3RcXC1uYXRpdmVfYXNzZXRzXFwtMzVmMTU0fHJlZ2lzdHJ5X3JlYWN0XFwtbmF0aXZlX2Fzc2V0c1xcLXJlZ1xcLTVkMWVhZSl8TGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsXFwtOTZhNjk2fG5vcm1hbGl6ZVxcLWNvbG9yc19yZWFjdFxcLW5hdGl2ZV9ub3JtYWxpemVcXC1jb2xvcnN8cmVhY3RcXC1uYXRpdmV8c3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXFwtZmQzMDkwfHZpcnR1YWxpemVkXFwtbGlzdHNfcmVhY3RcXC1uYXRpdmVfdmlydHVhbGl6ZWRcXC1saXN0c1xcLWY2MTM3OSkpJC8udGVzdChjaHVua0lkKTtcbn0sXG5yb290T3V0cHV0RGlyOiBcIlwiLFxuXG4gICAgfTtcbn1cblxufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2RlZmluZV9wcm9wZXJ0eV9nZXR0ZXJzXG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBkZWZpbml0aW9uKSB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcbiAgICAgICAgaWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuICAgICAgICB9XG4gICAgfVxufTtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9lbnN1cmVfY2h1bmtcbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18uZiA9IHt9O1xuLy8gVGhpcyBmaWxlIGNvbnRhaW5zIG9ubHkgdGhlIGVudHJ5IGNodW5rLlxuLy8gVGhlIGNodW5rIGxvYWRpbmcgZnVuY3Rpb24gZm9yIGFkZGl0aW9uYWwgY2h1bmtzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmUgPSBmdW5jdGlvbihjaHVua0lkKSB7XG5cdHJldHVybiBQcm9taXNlLmFsbChcblx0XHRPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmYpLnJlZHVjZShmdW5jdGlvbihwcm9taXNlcywga2V5KSB7XG5cdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmZba2V5XShjaHVua0lkLCBwcm9taXNlcyk7XG5cdFx0XHRyZXR1cm4gcHJvbWlzZXM7XG5cdFx0fSwgW10pXG5cdCk7XG59O1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2dldCBqYXZhc2NyaXB0IGNodW5rIGZpbGVuYW1lXG4hZnVuY3Rpb24oKSB7XG4vLyBUaGlzIGZ1bmN0aW9uIGFsbG93IHRvIHJlZmVyZW5jZSBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18udSA9IGZ1bmN0aW9uKGNodW5rSWQpIHtcbiAgLy8gcmV0dXJuIHVybCBmb3IgZmlsZW5hbWVzIG5vdCBiYXNlZCBvbiB0ZW1wbGF0ZVxuICBcbiAgLy8gcmV0dXJuIHVybCBmb3IgZmlsZW5hbWVzIGJhc2VkIG9uIHRlbXBsYXRlXG4gIHJldHVybiBcIlwiICsgY2h1bmtJZCArIFwiLmNodW5rLmJ1bmRsZVwiXG59XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsXG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpO1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2hhc19vd25fcHJvcGVydHlcbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH1cbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9sb2FkX3NjcmlwdFxuIWZ1bmN0aW9uKCkge1xuICBmdW5jdGlvbiBsb2FkU2NyaXB0SGFuZGxlcihuYW1lLCBjYWxsZXIsIGRvbmUsIHJlZmVyZW5jZVVybCkge1xuICAgIGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlcikge1xuICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIubG9hZFNjcmlwdChuYW1lLCBjYWxsZXIsIF9fd2VicGFja19yZXF1aXJlX18sIHJlZmVyZW5jZVVybCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRvbmUoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbUmVwYWNrUnVudGltZV0gTG9hZGluZyBzY3JpcHQgZmFpbGVkOicsIHJlYXNvbik7XG4gICAgICAgIGRvbmUoe1xuICAgICAgICAgIHR5cGU6ICdleGVjJyxcbiAgICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICAgIHNyYzogbmFtZVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5lcnJvcignW1JlcGFja1J1bnRpbWVdIFNjcmlwdCBtYW5hZ2VyIHdhcyBub3QgcHJvdmlkZWQnKTtcbiAgICAgIGRvbmUoe1xuICAgICAgICB0eXBlOiAnZXhlYycsXG4gICAgICAgIHRhcmdldDoge1xuICAgICAgICAgIHNyYzogbmFtZVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gbG9hZEhvdFVwZGF0ZUhhbmRsZXIodXJsLCBkb25lKSB7XG4gICAgaWYgKCFmYWxzZSkge1xuICAgICAgY29uc29sZS5lcnJvcignW1JlcGFja1J1bnRpbWVdIExvYWRpbmcgSE1SIHVwZGF0ZSBjaHVua3MgaXMgZGlzYWJsZWQnKTtcbiAgICAgIGRvbmUoe1xuICAgICAgICB0eXBlOiAnZGlzYWJsZWQnLFxuICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICBzcmM6IHVybFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZmV0Y2godXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbUmVwYWNrUnVudGltZV0gTG9hZGluZyBITVIgdXBkYXRlIGZhaWxlZDonLCByZXNwb25zZS5zdGF0dXNUZXh0KTtcbiAgICAgICAgZG9uZSh7XG4gICAgICAgICAgdHlwZTogcmVzcG9uc2Uuc3RhdHVzVGV4dCxcbiAgICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICAgIHNyYzogdXJsXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTtcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChzY3JpcHQpIHtcbiAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgaWYgKF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyKSB7XG4gICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIudW5zdGFibGVfZXZhbHVhdGVTY3JpcHQoc2NyaXB0LCB1cmwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGV2YWwoc2NyaXB0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZXBhY2tSdW50aW1lXSBMb2FkaW5nIEhNUiB1cGRhdGUgY2h1bmsgZmFpbGVkOicsIHJlYXNvbik7XG4gICAgICBkb25lKHtcbiAgICAgICAgdHlwZTogJ2V4ZWMnLFxuICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICBzcmM6IHVybFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICBfX3dlYnBhY2tfcmVxdWlyZV9fLmwgPSBmdW5jdGlvbiBsb2FkU2NyaXB0KHVybCwgZG9uZSwga2V5LCBjaHVua0lkKSB7XG4gICAgaWYgKGtleSAmJiBjaHVua0lkKSB7XG4gICAgICBsb2FkU2NyaXB0SGFuZGxlcihjaHVua0lkLCAnbXVzaWNzJywgZG9uZSwgdXJsKTtcbiAgICB9IGVsc2UgaWYgKGtleSkge1xuICAgICAgbG9hZFNjcmlwdEhhbmRsZXIoa2V5LCB1bmRlZmluZWQsIGRvbmUsIHVybCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvYWRIb3RVcGRhdGVIYW5kbGVyKHVybCwgZG9uZSk7XG4gICAgfVxuICB9O1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL25vZGVfbW9kdWxlX2RlY29yYXRvclxuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5ubWQgPSBmdW5jdGlvbihtb2R1bGUpIHtcbiAgbW9kdWxlLnBhdGhzID0gW107XG4gIGlmICghbW9kdWxlLmNoaWxkcmVuKSBtb2R1bGUuY2hpbGRyZW4gPSBbXTtcbiAgcmV0dXJuIG1vZHVsZTtcbn07XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvcHVibGljX3BhdGhcbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwibm9vcDovLy9cIjtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9yZXBhY2svZ3VhcmRlZCByZXF1aXJlXG4hZnVuY3Rpb24oKSB7XG4gIHZhciBpbkd1YXJkID0gZmFsc2U7XG4gIHZhciBvcmlnaW5hbFdlYnBhY2tSZXF1aXJlID0gX193ZWJwYWNrX3JlcXVpcmVfXztcbiAgZnVuY3Rpb24gZ3VhcmRlZFdlYnBhY2tSZXF1aXJlKG1vZHVsZUlkKSB7XG4gICAgaWYgKCFpbkd1YXJkICYmIHNlbGYuRXJyb3JVdGlscykge1xuICAgICAgaW5HdWFyZCA9IHRydWU7XG4gICAgICBsZXQgZXhwb3J0cztcbiAgICAgIHRyeSB7XG4gICAgICAgIGV4cG9ydHMgPSBvcmlnaW5hbFdlYnBhY2tSZXF1aXJlKG1vZHVsZUlkKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgc2VsZi5FcnJvclV0aWxzLnJlcG9ydEZhdGFsRXJyb3IoZSk7XG4gICAgICB9XG4gICAgICBpbkd1YXJkID0gZmFsc2U7XG4gICAgICByZXR1cm4gZXhwb3J0cztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG9yaWdpbmFsV2VicGFja1JlcXVpcmUobW9kdWxlSWQpO1xuICAgIH1cbiAgfVxuICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvcmlnaW5hbFdlYnBhY2tSZXF1aXJlKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgZ3VhcmRlZFdlYnBhY2tSZXF1aXJlW2tleV0gPSBvcmlnaW5hbFdlYnBhY2tSZXF1aXJlW2tleV07XG4gIH0pO1xuICBfX3dlYnBhY2tfcmVxdWlyZV9fID0gZ3VhcmRlZFdlYnBhY2tSZXF1aXJlO1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL3JlcGFjay9pbml0XG4hZnVuY3Rpb24oKSB7XG4gIHZhciByZXBhY2tSdW50aW1lID0ge1xuICAgIHNoYXJlZDogc2VsZi5fX3JlcGFja19fICYmIHNlbGYuX19yZXBhY2tfXy5zaGFyZWQgfHwgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2sgJiYgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkIHx8IHtcbiAgICAgIHNjcmlwdE1hbmFnZXI6IHVuZGVmaW5lZFxuICAgIH1cbiAgfTtcbiAgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2sgPSBzZWxmLl9fcmVwYWNrX18gPSByZXBhY2tSdW50aW1lO1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL3JzcGFja192ZXJzaW9uXG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLnJ2ID0gZnVuY3Rpb24oKSB7IHJldHVybiBcIjEuMy4xNVwiOyB9XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvc2hhcmluZ1xuIWZ1bmN0aW9uKCkge1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLlMgPSB7fTtcbl9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhID0geyBzY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nOiB7IFwiZGVmYXVsdFwiOiBbeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydFwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnNcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMvaW5kZXguanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzXCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV8zMWQ0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9yZWFjdC1uYXRpdmVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy1mZDMwOTBcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2dldF9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkXy1kZDI1N2VcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzL2luZGV4LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0cy9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV8xNTM5XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X3JlYWN0LW5hdGl2ZV9hc3NldHMtMzVmMTU0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19jbGFzc19wcml2YXRlX2ZpZWxkX2xvb3NlX2Jhc2VfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janMtMzEyMjdiXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmVcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X1ZpZXdDb24tOTkxYzhhXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHlcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fMTUzOVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzMxZDRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19jYWxsc3RhY2tfcmVwYWNrX2Rpc3RfbW9kdWxlc19FbXB0eU1vZHVsZV9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRW1wdHlNb2R1bGUuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRW1wdHlNb2R1bGUuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fMTUzOVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzMxZDRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yXCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvci5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3IuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXlcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3ItZTg2ZWU2XCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5LmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc1wiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF9janMtbm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmVcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fMTUzOVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzMxZDRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxIH0sIHsgbmFtZTogXCJyZWFjdFwiLCB2ZXJzaW9uOiBcIjE5LjAuMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0L2luZGV4LmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QvaW5kZXguanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxIH1dIH0sIHVuaXF1ZU5hbWU6IFwibXVzaWNzXCIgfTtcbl9fd2VicGFja19yZXF1aXJlX18uSSA9IF9fd2VicGFja19yZXF1aXJlX18uSSB8fCBmdW5jdGlvbigpIHsgdGhyb3cgbmV3IEVycm9yKFwic2hvdWxkIGhhdmUgX193ZWJwYWNrX3JlcXVpcmVfXy5JXCIpIH1cblxufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2NvbnN1bWVzX2xvYWRpbmdcbiFmdW5jdGlvbigpIHtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhID0geyBjaHVua01hcHBpbmc6IHtcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnNcIl0sXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWwtOTZhNjk2XCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlXCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlXCJdLFwiX19mZWRlcmF0aW9uX2V4cG9zZV9BcHBcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/ZDk3MFwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD9hNTZhXCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnlcIl0sXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9yZWFjdC1uYXRpdmVcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/NzQ1YlwiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy1mZDMwOTBcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc1wiXSxcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV8xNTM5XCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD8xNTM5XCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydFwiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0c1wiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5XCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5XCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5XCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnlcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvci9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yXCJdLFwibXVzaWNzXCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlPzdkNGRcIl0sXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fMzFkNFwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QvcmVhY3Q/MzFkNFwiXX0sIG1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc6IHsgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0PzMxZDRcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3RcIiwgaW1wb3J0OiBcInJlYWN0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc1wiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X3JlYWN0LW5hdGl2ZV9hc3NldHMtMzVmMTU0XCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlLmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5LmpzXCIpOyB9OyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTBcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5ICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvci9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3IgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yLmpzXCIpOyB9OyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD9hNTZhXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0XCIsIGltcG9ydDogXCJyZWFjdFwiLCByZXF1aXJlZFZlcnNpb246IFwiMTkuMC4wXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnRcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0XCIsIGltcG9ydDogXCJAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnRcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0ICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9yc1wiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnNcIiwgaW1wb3J0OiBcIkByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9yc1wiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIEByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycyAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5XCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheS5qc1wiKTsgfTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT83ZDRkXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCI+PTAuNzRcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fMTUzOVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzMxZDRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzL0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHNcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwiQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0c1wiLCBpbXBvcnQ6IFwiQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0c1wiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3JlYWN0LW5hdGl2ZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLWZkMzA5MFwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIEByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzL2luZGV4LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmUvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlX2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmUuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlPzc0NWJcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmVcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV8xNTM5XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X3JlYWN0LW5hdGl2ZV9hc3NldHMtMzVmMTU0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWwtOTZhNjk2XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHMtZjYxMzc5XCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL2luZGV4LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHlcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5ICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5LmpzXCIpOyB9OyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD8xNTM5XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0XCIsIGltcG9ydDogXCJyZWFjdFwiLCByZXF1aXJlZFZlcnNpb246IFwiXjE5LjAuMFwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlP2Q5NzBcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmVcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIjAuNzguMFwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MThcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzE1MzlcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeS9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeVwiLCBpbXBvcnQ6IFwiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeSAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmVcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmVcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlLmpzXCIpOyB9OyB9IH0gfSwgaW5pdGlhbENvbnN1bWVzOiBbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/N2Q0ZFwiXSB9O1xuX193ZWJwYWNrX3JlcXVpcmVfXy5mLmNvbnN1bWVzID0gX193ZWJwYWNrX3JlcXVpcmVfXy5mLmNvbnN1bWVzIHx8IGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJzaG91bGQgaGF2ZSBfX3dlYnBhY2tfcmVxdWlyZV9fLmYuY29uc3VtZXNcIikgfVxufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2luaXRpYWxpemVfZXhwb3Nlc1xuIWZ1bmN0aW9uKCkge1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSA9IHtcbiAgbW9kdWxlTWFwOiB7XG4gIFwiLi9BcHBcIjogZnVuY3Rpb24oKSB7XG5yZXR1cm4gUHJvbWlzZS5hbGwoLyohICB8IF9fZmVkZXJhdGlvbl9leHBvc2VfQXBwICovIFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfc2hvcGlmeV9yZWFjdC1uYXRpdmUtcGVyZm9ybWFuY2VfZGlzdF9pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzMxZDRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3JlYWN0LW5hdGl2ZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiX19mZWRlcmF0aW9uX2V4cG9zZV9BcHBcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL0FwcC5qcyAqLyBcIi4vQXBwLmpzXCIpOyB9OyB9KTtcbn0sXG59LFxuICBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIixcbn07XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmdldENvbnRhaW5lciA9IF9fd2VicGFja19yZXF1aXJlX18uZ2V0Q29udGFpbmVyIHx8IGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJzaG91bGQgaGF2ZSBfX3dlYnBhY2tfcmVxdWlyZV9fLmdldENvbnRhaW5lclwiKSB9O19fd2VicGFja19yZXF1aXJlX18uaW5pdENvbnRhaW5lciA9IF9fd2VicGFja19yZXF1aXJlX18uaW5pdENvbnRhaW5lciB8fCBmdW5jdGlvbigpIHsgdGhyb3cgbmV3IEVycm9yKFwic2hvdWxkIGhhdmUgX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0Q29udGFpbmVyXCIpIH07XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvanNvbnBfY2h1bmtfbG9hZGluZ1xuIWZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuICAgICAgLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4gICAgICAvLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbiAgICAgIHZhciBpbnN0YWxsZWRDaHVua3MgPSB7XCJtdXNpY3NcIjogMCx9O1xuICAgICAgXG4gICAgICAgIF9fd2VicGFja19yZXF1aXJlX18uZi5qID0gZnVuY3Rpb24gKGNodW5rSWQsIHByb21pc2VzKSB7XG4gICAgICAgICAgLy8gSlNPTlAgY2h1bmsgbG9hZGluZyBmb3IgamF2YXNjcmlwdFxudmFyIGluc3RhbGxlZENodW5rRGF0YSA9IF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpXG5cdD8gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdXG5cdDogdW5kZWZpbmVkO1xuaWYgKGluc3RhbGxlZENodW5rRGF0YSAhPT0gMCkge1xuXHQvLyAwIG1lYW5zIFwiYWxyZWFkeSBpbnN0YWxsZWRcIi5cblxuXHQvLyBhIFByb21pc2UgbWVhbnMgXCJjdXJyZW50bHkgbG9hZGluZ1wiLlxuXHRpZiAoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0cHJvbWlzZXMucHVzaChpbnN0YWxsZWRDaHVua0RhdGFbMl0pO1xuXHR9IGVsc2Uge1xuXHRcdGlmICghL14oXFwtd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdFxcLV8oMTUzOXwzMWQ0KXx3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0XFwtbmF0aXZlXyhhc3NldHNcXC1yZWdpc3RyeV8ocGF0aFxcLXN1cHBvcnRfcmVhY3RcXC1uYXRpdmVfYXNzZXRzXFwtMzVmMTU0fHJlZ2lzdHJ5X3JlYWN0XFwtbmF0aXZlX2Fzc2V0c1xcLXJlZ1xcLTVkMWVhZSl8TGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsXFwtOTZhNjk2fG5vcm1hbGl6ZVxcLWNvbG9yc19yZWFjdFxcLW5hdGl2ZV9ub3JtYWxpemVcXC1jb2xvcnN8cmVhY3RcXC1uYXRpdmV8c3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXFwtZmQzMDkwfHZpcnR1YWxpemVkXFwtbGlzdHNfcmVhY3RcXC1uYXRpdmVfdmlydHVhbGl6ZWRcXC1saXN0c1xcLWY2MTM3OSkpJC8udGVzdChjaHVua0lkKSkge1xuXHRcdFx0Ly8gc2V0dXAgUHJvbWlzZSBpbiBjaHVuayBjYWNoZVxuXHRcdFx0dmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsgaW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gW3Jlc29sdmUsIHJlamVjdF07IH0pO1xuXHRcdFx0cHJvbWlzZXMucHVzaCgoaW5zdGFsbGVkQ2h1bmtEYXRhWzJdID0gcHJvbWlzZSkpO1xuXG5cdFx0XHQvLyBzdGFydCBjaHVuayBsb2FkaW5nXG5cdFx0XHR2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXy5wICsgX193ZWJwYWNrX3JlcXVpcmVfXy51KGNodW5rSWQpO1xuXHRcdFx0Ly8gY3JlYXRlIGVycm9yIGJlZm9yZSBzdGFjayB1bndvdW5kIHRvIGdldCB1c2VmdWwgc3RhY2t0cmFjZSBsYXRlclxuXHRcdFx0dmFyIGVycm9yID0gbmV3IEVycm9yKCk7XG5cdFx0XHR2YXIgbG9hZGluZ0VuZGVkID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSkge1xuXHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXTtcblx0XHRcdFx0XHRpZiAoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0aWYgKGluc3RhbGxlZENodW5rRGF0YSkge1xuXHRcdFx0XHRcdFx0dmFyIGVycm9yVHlwZSA9XG5cdFx0XHRcdFx0XHRcdGV2ZW50ICYmIChldmVudC50eXBlID09PSAnbG9hZCcgPyAnbWlzc2luZycgOiBldmVudC50eXBlKTtcblx0XHRcdFx0XHRcdHZhciByZWFsU3JjID0gZXZlbnQgJiYgZXZlbnQudGFyZ2V0ICYmIGV2ZW50LnRhcmdldC5zcmM7XG5cdFx0XHRcdFx0XHRlcnJvci5tZXNzYWdlID1cblx0XHRcdFx0XHRcdFx0J0xvYWRpbmcgY2h1bmsgJyArXG5cdFx0XHRcdFx0XHRcdGNodW5rSWQgK1xuXHRcdFx0XHRcdFx0XHQnIGZhaWxlZC5cXG4oJyArXG5cdFx0XHRcdFx0XHRcdGVycm9yVHlwZSArXG5cdFx0XHRcdFx0XHRcdCc6ICcgK1xuXHRcdFx0XHRcdFx0XHRyZWFsU3JjICtcblx0XHRcdFx0XHRcdFx0JyknO1xuXHRcdFx0XHRcdFx0ZXJyb3IubmFtZSA9ICdDaHVua0xvYWRFcnJvcic7XG5cdFx0XHRcdFx0XHRlcnJvci50eXBlID0gZXJyb3JUeXBlO1xuXHRcdFx0XHRcdFx0ZXJyb3IucmVxdWVzdCA9IHJlYWxTcmM7XG5cdFx0XHRcdFx0XHRpbnN0YWxsZWRDaHVua0RhdGFbMV0oZXJyb3IpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubCh1cmwsIGxvYWRpbmdFbmRlZCwgXCJjaHVuay1cIiArIGNodW5rSWQsIGNodW5rSWQpO1xuXHRcdH0gZWxzZSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXG5cdH1cbn1cblxuICAgICAgICB9XG4gICAgICAgIC8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xudmFyIHdlYnBhY2tKc29ucENhbGxiYWNrID0gZnVuY3Rpb24ocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24sIGRhdGEpIHtcblx0dmFyIGNodW5rSWRzID0gZGF0YVswXTtcbnZhciBtb3JlTW9kdWxlcyA9IGRhdGFbMV07XG52YXIgcnVudGltZSA9IGRhdGFbMl07XG5cdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuXHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcblx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMDtcblx0aWYgKGNodW5rSWRzLnNvbWUoZnVuY3Rpb24oaWQpIHsgcmV0dXJuIGluc3RhbGxlZENodW5rc1tpZF0gIT09IDA7IH0pKSB7XG5cdFx0Zm9yIChtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubyhtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubVttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChydW50aW1lKSB2YXIgcmVzdWx0ID0gcnVudGltZShfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblx0fVxuXHRpZiAocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24pIHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKGRhdGEpO1xuXHRmb3IgKDsgaSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuXHRcdGlmIChcblx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpICYmXG5cdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1cblx0XHQpIHtcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSgpO1xuXHRcdH1cblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXHR9XG5cdFxufTtcblxudmFyIGNodW5rTG9hZGluZ0dsb2JhbCA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmttdXNpY3NcIl0gPSBzZWxmW1wid2VicGFja0NodW5rbXVzaWNzXCJdIHx8IFtdO1xuY2h1bmtMb2FkaW5nR2xvYmFsLmZvckVhY2god2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCAwKSk7XG5jaHVua0xvYWRpbmdHbG9iYWwucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2guYmluZChjaHVua0xvYWRpbmdHbG9iYWwpKTtcblxufSgpO1xuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8vIG1vZHVsZSBjYWNoZSBhcmUgdXNlZCBzbyBlbnRyeSBpbmxpbmluZyBpcyBkaXNhYmxlZFxuLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fKFwiQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvcnNwYWNrLmpzIT0hZGF0YTp0ZXh0L2phdmFzY3JpcHQsaW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fYnVuZGxlcl9ydW50aW1lX18gZnJvbSBcXFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvbXVzaWNzL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanNcXFwiO2ltcG9ydCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXyBmcm9tIFxcXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9tdXNpY3Mvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL3Jlc29sdmVyLXBsdWdpbi5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL211c2ljcy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanNcXFwiO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18gPSBbX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8wX18oKSwgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18oKV07Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXyA9IHt9O2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyA9IFxcXCJtdXNpY3NcXFwiO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyA9IFxcXCJsb2FkZWQtZmlyc3RcXFwiO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YXx8X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpJiZfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24pe3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMjtjb25zdCBvdmVycmlkZT0ob2JqLGtleSx2YWx1ZSk9PntpZighb2JqKXJldHVybjtpZihvYmpba2V5XSlvYmpba2V5XT12YWx1ZX07Y29uc3QgbWVyZ2U9KG9iaixrZXksZm4pPT57Y29uc3QgdmFsdWU9Zm4oKTtpZihBcnJheS5pc0FycmF5KHZhbHVlKSl7dmFyIF9vYmosX2tleTt2YXIgXzsoXz0oX29iaj1vYmopW19rZXk9a2V5XSkhPT1udWxsJiZfIT09dm9pZCAwP186X29ialtfa2V5XT1bXTtvYmpba2V5XS5wdXNoKC4uLnZhbHVlKX1lbHNlIGlmKHR5cGVvZiB2YWx1ZT09PVxcXCJvYmplY3RcXFwiJiZ2YWx1ZSE9PW51bGwpe3ZhciBfb2JqMSxfa2V5MTt2YXIgXzE7KF8xPShfb2JqMT1vYmopW19rZXkxPWtleV0pIT09bnVsbCYmXzEhPT12b2lkIDA/XzE6X29iajFbX2tleTFdPXt9O09iamVjdC5hc3NpZ24ob2JqW2tleV0sdmFsdWUpfX07Y29uc3QgZWFybHk9KG9iaixrZXksaW5pdGlhbCk9Pnt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPWluaXRpYWwoKX07dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCByZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZztjb25zdCByZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9X193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEubW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc7Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEuc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLmNodW5rTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nO2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nOnt9O2NvbnN0IGNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXM9e307Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdJbml0UHJvbWlzZXM9W107Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zPXt9O2NvbnN0IGNvbnRhaW5lclNoYXJlU2NvcGU9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YS5zaGFyZVNjb3BlO2Zvcihjb25zdCBrZXkgaW4gX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uW2tleV09X19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfX1trZXldfWVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1xcXCIsKCk9Pntjb25zdCBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nPXt9O2ZvcihsZXRbbW9kdWxlSWQsZGF0YV1vZiBPYmplY3QuZW50cmllcyhjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZykpe2NvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdbbW9kdWxlSWRdPXtnZXR0ZXI6ZGF0YS5mYWxsYmFjayxzaGFyZUluZm86e3NoYXJlQ29uZmlnOntmaXhlZERlcGVuZGVuY2llczpmYWxzZSxyZXF1aXJlZFZlcnNpb246ZGF0YS5yZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbjpkYXRhLnN0cmljdFZlcnNpb24sc2luZ2xldG9uOmRhdGEuc2luZ2xldG9uLGVhZ2VyOmRhdGEuZWFnZXJ9LHNjb3BlOltkYXRhLnNoYXJlU2NvcGVdfSxzaGFyZUtleTpkYXRhLnNoYXJlS2V5fX1yZXR1cm4gY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiaW5pdE9wdGlvbnNcXFwiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXFxcIm5hbWVcXFwiLCgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwic2hhcmVTdHJhdGVneVxcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJzaGFyZWRcXFwiLCgpPT57Y29uc3Qgc2hhcmVkPXt9O2ZvcihsZXRbc2NvcGUsc3RhZ2VzXW9mIE9iamVjdC5lbnRyaWVzKGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZykpe2ZvcihsZXQgc3RhZ2Ugb2Ygc3RhZ2VzKXtpZih0eXBlb2Ygc3RhZ2U9PT1cXFwib2JqZWN0XFxcIiYmc3RhZ2UhPT1udWxsKXtjb25zdHtuYW1lLHZlcnNpb24sZmFjdG9yeSxlYWdlcixzaW5nbGV0b24scmVxdWlyZWRWZXJzaW9uLHN0cmljdFZlcnNpb259PXN0YWdlO2NvbnN0IHNoYXJlQ29uZmlnPXt9O2NvbnN0IGlzVmFsaWRWYWx1ZT1mdW5jdGlvbih2YWwpe3JldHVybiB0eXBlb2YgdmFsIT09XFxcInVuZGVmaW5lZFxcXCJ9O2lmKGlzVmFsaWRWYWx1ZShzaW5nbGV0b24pKXtzaGFyZUNvbmZpZy5zaW5nbGV0b249c2luZ2xldG9ufWlmKGlzVmFsaWRWYWx1ZShyZXF1aXJlZFZlcnNpb24pKXtzaGFyZUNvbmZpZy5yZXF1aXJlZFZlcnNpb249cmVxdWlyZWRWZXJzaW9ufWlmKGlzVmFsaWRWYWx1ZShlYWdlcikpe3NoYXJlQ29uZmlnLmVhZ2VyPWVhZ2VyfWlmKGlzVmFsaWRWYWx1ZShzdHJpY3RWZXJzaW9uKSl7c2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbj1zdHJpY3RWZXJzaW9ufWNvbnN0IG9wdGlvbnM9e3ZlcnNpb24sc2NvcGU6W3Njb3BlXSxzaGFyZUNvbmZpZyxnZXQ6ZmFjdG9yeX07aWYoc2hhcmVkW25hbWVdKXtzaGFyZWRbbmFtZV0ucHVzaChvcHRpb25zKX1lbHNle3NoYXJlZFtuYW1lXT1bb3B0aW9uc119fX19cmV0dXJuIHNoYXJlZH0pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwicmVtb3Rlc1xcXCIsKCk9Pk9iamVjdC52YWx1ZXMoX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXykuZmxhdCgpLmZpbHRlcihyZW1vdGU9PnJlbW90ZS5leHRlcm5hbFR5cGU9PT1cXFwic2NyaXB0XFxcIikpO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwicGx1Z2luc1xcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiYnVuZGxlclJ1bnRpbWVPcHRpb25zXFxcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucyxcXFwicmVtb3Rlc1xcXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiY2h1bmtNYXBwaW5nXFxcIiwoKT0+cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdcXFwiLCgpPT57Y29uc3QgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7cmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmdbbW9kdWxlSWRdPVtkYXRhLnNoYXJlU2NvcGUsZGF0YS5uYW1lLGRhdGEuZXh0ZXJuYWxNb2R1bGVJZCxkYXRhLnJlbW90ZU5hbWVdfXJldHVybiByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwid2VicGFja1JlcXVpcmVcXFwiLCgpPT5fX3dlYnBhY2tfcmVxdWlyZV9fKTttZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsXFxcImlkVG9SZW1vdGVNYXBcXFwiLCgpPT57Y29uc3QgaWRUb1JlbW90ZU1hcD17fTtmb3IobGV0W2lkLHJlbW90ZURhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtjb25zdCBpbmZvPV9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX19bcmVtb3RlRGF0YS5yZW1vdGVOYW1lXTtpZihpbmZvKWlkVG9SZW1vdGVNYXBbaWRdPWluZm99cmV0dXJuIGlkVG9SZW1vdGVNYXB9KTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJTXFxcIixfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuUyk7aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKF9fd2VicGFja19yZXF1aXJlX18pfW92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcXFwicmVtb3Rlc1xcXCIsKGNodW5rSWQscHJvbWlzZXMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUucmVtb3Rlcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcsaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nLGlkVG9SZW1vdGVNYXA6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9SZW1vdGVNYXAsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLmYsXFxcImNvbnN1bWVzXFxcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5jb25zdW1lcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6Y29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmcsaW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcXFwiSVxcXCIsKG5hbWUsaW5pdFNjb3BlKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLkkoe3NoYXJlU2NvcGVOYW1lOm5hbWUsaW5pdFNjb3BlLGluaXRQcm9taXNlczppbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcyxpbml0VG9rZW5zOmluaXRpYWxpemVTaGFyaW5nSW5pdFRva2Vucyx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcImluaXRDb250YWluZXJcXFwiLChzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluaXRDb250YWluZXJFbnRyeSh7c2hhcmVTY29wZSxpbml0U2NvcGUscmVtb3RlRW50cnlJbml0T3B0aW9ucyxzaGFyZVNjb3BlS2V5OmNvbnRhaW5lclNoYXJlU2NvcGUsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJnZXRDb250YWluZXJcXFwiLChtb2R1bGUxLGdldFNjb3BlKT0+e3ZhciBtb2R1bGVNYXA9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEubW9kdWxlTWFwO19fd2VicGFja19yZXF1aXJlX18uUj1nZXRTY29wZTtnZXRTY29wZT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kdWxlTWFwLG1vZHVsZTEpP21vZHVsZU1hcFttb2R1bGUxXSgpOlByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCk9Pnt0aHJvdyBuZXcgRXJyb3IoJ01vZHVsZSBcXFwiJyttb2R1bGUxKydcXFwiIGRvZXMgbm90IGV4aXN0IGluIGNvbnRhaW5lci4nKX0pO19fd2VicGFja19yZXF1aXJlX18uUj11bmRlZmluZWQ7cmV0dXJuIGdldFNjb3BlfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluc3RhbmNlPV9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5ydW50aW1lLmluaXQoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zKTtpZigoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMi5pbml0aWFsQ29uc3VtZXMpe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbnN0YWxsSW5pdGlhbENvbnN1bWVzKHt3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9fLGluc3RhbGxlZE1vZHVsZXM6Y29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyxpbml0aWFsQ29uc3VtZXM6X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhLmluaXRpYWxDb25zdW1lcyxtb2R1bGVUb0hhbmRsZXJNYXBwaW5nOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSl9fVwiKTtcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcIndlYnBhY2svY29udGFpbmVyL2VudHJ5L211c2ljc1wiKTtcbm11c2ljcyA9IF9fd2VicGFja19leHBvcnRzX187XG59KSgpXG47Ly8jIHNvdXJjZU1hcHBpbmdVUkw9bXVzaWNzLmNvbnRhaW5lci5idW5kbGUubWFwP3BsYXRmb3JtPWFuZHJvaWQiLCJyZXNwb25zZVRpbWUiOjg0MDksImlzSHRtbCI6ZmFsc2V9LCJlcnJvciI6bnVsbCwic3RhdHVzIjoicGFzcyIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjo5LjQxMjU2OTQyNSwibmFtZSI6Ii9tdXNpY3MvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9tdXNpY3MuY29udGFpbmVyLmJ1bmRsZSIsInBhdGgiOiJtdXNpY3MtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC1tdXNpY3MuY29udGFpbmVyLmJ1bmRsZSIsIml0ZXJhdGlvbkluZGV4IjoxfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJtdXNpY3MtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC1tZi1tYW5pZmVzdC5qc29uLmJydSJ9LCJyZXF1ZXN0Ijp7Im1ldGhvZCI6IkdFVCIsInVybCI6Imh0dHBzOi8vcmVhY3QtbmF0aXZlLWFydGlmYWN0cy5uZXRsaWZ5LmFwcC9hcnRpZmFjdHMvbXVzaWNzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvbWYtbWFuaWZlc3QuanNvbiIsImhlYWRlcnMiOnsiVXNlci1BZ2VudCI6Imluc29tbmlhLzExLjIuMCJ9LCJpc0h0bWwiOmZhbHNlfSwicmVzcG9uc2UiOnsic3RhdHVzIjoyMDAsInN0YXR1c1RleHQiOiJPSyIsImhlYWRlcnMiOnsiYWNjZXB0LXJhbmdlcyI6ImJ5dGVzIiwiYWdlIjoiMiIsImNhY2hlLWNvbnRyb2wiOiJwdWJsaWMsbWF4LWFnZT0wLG11c3QtcmV2YWxpZGF0ZSIsImNhY2hlLXN0YXR1cyI6IlwiTmV0bGlmeSBFZGdlXCI7IGZ3ZD1taXNzIiwiY29udGVudC10eXBlIjoiYXBwbGljYXRpb24vanNvbiIsImRhdGUiOiJUaHUsIDE3IEp1bCAyMDI1IDE2OjIwOjQ2IEdNVCIsImV0YWciOiJcIjg0MDllNjExZDZhZjIzYjBlMmQ3MDYxOWVlNTJlODRhLXNzbC1kZlwiIiwic2VydmVyIjoiTmV0bGlmeSIsInN0cmljdC10cmFuc3BvcnQtc2VjdXJpdHkiOiJtYXgtYWdlPTMxNTM2MDAwOyBpbmNsdWRlU3ViRG9tYWluczsgcHJlbG9hZCIsInZhcnkiOiJBY2NlcHQtRW5jb2RpbmciLCJ4LW5mLXJlcXVlc3QtaWQiOiIwMUswQ0swQ0g4RTY0QzZaSEVTWjRNQUNSRyIsImNvbm5lY3Rpb24iOiJjbG9zZSIsInRyYW5zZmVyLWVuY29kaW5nIjoiY2h1bmtlZCJ9LCJkYXRhIjp7ImlkIjoibXVzaWNzIiwibmFtZSI6Im11c2ljcyIsIm1ldGFEYXRhIjp7Im5hbWUiOiJtdXNpY3MiLCJ0eXBlIjoiYXBwIiwiYnVpbGRJbmZvIjp7ImJ1aWxkVmVyc2lvbiI6IjEuMC4wIiwiYnVpbGROYW1lIjoibXVzaWNzIn0sInJlbW90ZUVudHJ5Ijp7Im5hbWUiOiJtdXNpY3MuY29udGFpbmVyLmJ1bmRsZSIsInBhdGgiOiIiLCJ0eXBlIjoiZ2xvYmFsIn0sInR5cGVzIjp7InBhdGgiOiIiLCJuYW1lIjoiIiwiemlwIjoiIiwiYXBpIjoiIn0sImdsb2JhbE5hbWUiOiJtdXNpY3MiLCJwbHVnaW5WZXJzaW9uIjoiMC4xMC4wIiwicHJlZmV0Y2hJbnRlcmZhY2UiOmZhbHNlLCJwdWJsaWNQYXRoIjoibm9vcDovLy8ifSwic2hhcmVkIjpbeyJpZCI6Im11c2ljczpyZWFjdC1uYXRpdmUiLCJuYW1lIjoicmVhY3QtbmF0aXZlIiwidmVyc2lvbiI6IjAuNzguMCIsInNpbmdsZXRvbiI6dHJ1ZSwicmVxdWlyZWRWZXJzaW9uIjoiXjAuNzguMCIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MC5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6Im11c2ljczpyZWFjdCIsIm5hbWUiOiJyZWFjdCIsInZlcnNpb24iOiIxOS4wLjAiLCJzaW5nbGV0b24iOnRydWUsInJlcXVpcmVkVmVyc2lvbiI6Il4xOS4wLjAiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOltdLCJzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6Im11c2ljczpAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzIiwibmFtZSI6IkByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4LmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MC5jaHVuay5idW5kbGUiXSwic3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibXVzaWNzOkByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycyIsIm5hbWUiOiJAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbXSwic3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJtdXNpY3M6QHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkiLCJuYW1lIjoiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbXSwic3luYyI6WyJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJtdXNpY3M6cmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlIiwibmFtZSI6InJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZSIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiXSwic3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibXVzaWNzOkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydCIsIm5hbWUiOiJAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbXSwic3luYyI6WyJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibXVzaWNzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlIiwibmFtZSI6InJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlIiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6W10sInN5bmMiOlsibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlX2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6Im11c2ljczpyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeSIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeSIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MTguY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MC5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3ItZTg2ZWU2LmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2NsYXNzX3ByaXZhdGVfZmllbGRfbG9vc2VfYmFzZV9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqcy0zMTIyN2IuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2NhbGxzdGFja19yZXBhY2tfZGlzdF9tb2R1bGVzX0VtcHR5TW9kdWxlX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkX2Nqcy1ub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2dldF9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkXy1kZDI1N2UuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsiaW5kZXguYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibXVzaWNzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eSIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4LmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yLWU4NmVlNi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19jbGFzc19wcml2YXRlX2ZpZWxkX2xvb3NlX2Jhc2VfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janMtMzEyMjdiLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUxLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19jYWxsc3RhY2tfcmVwYWNrX2Rpc3RfbW9kdWxlc19FbXB0eU1vZHVsZV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X1ZpZXdDb24tOTkxYzhhLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF9janMtbm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvcl9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19nZXRfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF8tZGQyNTdlLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbImluZGV4LmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJtdXNpY3M6cmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5IiwibmFtZSI6InJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeSIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTEuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoibXVzaWNzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUiLCJuYW1lIjoicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZSIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MTguY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MC5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3ItZTg2ZWU2LmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2NsYXNzX3ByaXZhdGVfZmllbGRfbG9vc2VfYmFzZV9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqcy0zMTIyN2IuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2NhbGxzdGFja19yZXBhY2tfZGlzdF9tb2R1bGVzX0VtcHR5TW9kdWxlX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkX2Nqcy1ub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2dldF9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkXy1kZDI1N2UuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsiaW5kZXguYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9WaWV3Q29uLTk5MWM4YS5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJtdXNpY3M6cmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5IiwibmFtZSI6InJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheSIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MTguY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MC5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3ItZTg2ZWU2LmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2NsYXNzX3ByaXZhdGVfZmllbGRfbG9vc2VfYmFzZV9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqcy0zMTIyN2IuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2NhbGxzdGFja19yZXBhY2tfZGlzdF9tb2R1bGVzX0VtcHR5TW9kdWxlX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkX2Nqcy1ub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2dldF9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkXy1kZDI1N2UuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsiaW5kZXguYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yLWU4NmVlNi5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJtdXNpY3M6cmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvciIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yIiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOC5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUwLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTYuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fY2xhc3NfcHJpdmF0ZV9maWVsZF9sb29zZV9iYXNlX2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzLTMxMjI3Yi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfY2FsbHN0YWNrX3JlcGFja19kaXN0X21vZHVsZXNfRW1wdHlNb2R1bGVfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9WaWV3Q29uLTk5MWM4YS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfY2pzLW5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fZ2V0X2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfLWRkMjU3ZS5jaHVuay5idW5kbGUiXSwic3luYyI6WyJpbmRleC5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3ItZTg2ZWU2LmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvcl9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJtdXNpY3M6cmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncyIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzIiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOC5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUwLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTYuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fY2xhc3NfcHJpdmF0ZV9maWVsZF9sb29zZV9iYXNlX2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzLTMxMjI3Yi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfY2FsbHN0YWNrX3JlcGFja19kaXN0X21vZHVsZXNfRW1wdHlNb2R1bGVfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9WaWV3Q29uLTk5MWM4YS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfY2pzLW5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fZ2V0X2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfLWRkMjU3ZS5jaHVuay5idW5kbGUiXSwic3luYyI6WyJpbmRleC5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX1dLCJyZW1vdGVzIjpbXSwiZXhwb3NlcyI6W3siaWQiOiJtdXNpY3M6QXBwIiwibmFtZSI6IkFwcCIsImFzc2V0cyI6eyJqcyI6eyJzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3Nob3BpZnlfcmVhY3QtbmF0aXZlLXBlcmZvcm1hbmNlX2Rpc3RfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwiX19mZWRlcmF0aW9uX2V4cG9zZV9BcHAuY2h1bmsuYnVuZGxlIl0sImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4LmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsic3luYyI6W10sImFzeW5jIjpbXX19LCJwYXRoIjoiLi9BcHAifV19LCJyZXNwb25zZVRpbWUiOjE4NDksImlzSHRtbCI6ZmFsc2V9LCJlcnJvciI6bnVsbCwic3RhdHVzIjoicGFzcyIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjoyLjg1MTI1MTA3NCwibmFtZSI6Ii9tdXNpY3MvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9tZi1tYW5pZmVzdC5qc29uIiwicGF0aCI6Im11c2ljcy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LW1mLW1hbmlmZXN0Lmpzb24iLCJpdGVyYXRpb25JbmRleCI6MX0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoib3V0ZG9vcnMtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC1tZi1tYW5pZmVzdC5qc29uLmJydSJ9LCJyZXF1ZXN0Ijp7Im1ldGhvZCI6IkdFVCIsInVybCI6Imh0dHBzOi8vcmVhY3QtbmF0aXZlLWFydGlmYWN0cy5uZXRsaWZ5LmFwcC9hcnRpZmFjdHMvb3V0ZG9vcnMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9tZi1tYW5pZmVzdC5qc29uIiwiaGVhZGVycyI6eyJVc2VyLUFnZW50IjoiaW5zb21uaWEvMTEuMi4wIn0sImlzSHRtbCI6ZmFsc2V9LCJyZXNwb25zZSI6eyJzdGF0dXMiOiJlcnJvciIsInN0YXR1c1RleHQiOm51bGwsImhlYWRlcnMiOm51bGwsImRhdGEiOm51bGwsInJlc3BvbnNlVGltZSI6MCwiaXNIdG1sIjpmYWxzZX0sImVycm9yIjoiY29ubmVjdCBFVElNRURPVVQgMTMuMjE1LjIzOS4yMTk6NDQzIiwic3RhdHVzIjoiZXJyb3IiLCJhc3NlcnRpb25SZXN1bHRzIjpbXSwidGVzdFJlc3VsdHMiOltdLCJwcmVSZXF1ZXN0VGVzdFJlc3VsdHMiOltdLCJwb3N0UmVzcG9uc2VUZXN0UmVzdWx0cyI6W10sInNob3VsZFN0b3BSdW5uZXJFeGVjdXRpb24iOmZhbHNlLCJydW5EdXJhdGlvbiI6MS41Mzg2NTQzMTUsIm5hbWUiOiIvb3V0ZG9vcnMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9tZi1tYW5pZmVzdC5qc29uIiwicGF0aCI6Im91dGRvb3JzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbWYtbWFuaWZlc3QuanNvbiIsIml0ZXJhdGlvbkluZGV4IjoxfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJvdXRkb29ycy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LW91dGRvb3JzLmNvbnRhaW5lci5idW5kbGUuYnJ1In0sInJlcXVlc3QiOnsibWV0aG9kIjoiR0VUIiwidXJsIjoiaHR0cHM6Ly9yZWFjdC1uYXRpdmUtYXJ0aWZhY3RzLm5ldGxpZnkuYXBwL2FydGlmYWN0cy9vdXRkb29ycy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L291dGRvb3JzLmNvbnRhaW5lci5idW5kbGUiLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJjb25uZWN0IEVUSU1FRE9VVCAxMy4yMTUuMjM5LjIxOTo0NDMiLCJzdGF0dXMiOiJlcnJvciIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjoxLjUwNzgxNDQ4LCJuYW1lIjoiL291dGRvb3JzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvb3V0ZG9vcnMuY29udGFpbmVyLmJ1bmRsZSIsInBhdGgiOiJvdXRkb29ycy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LW91dGRvb3JzLmNvbnRhaW5lci5idW5kbGUiLCJpdGVyYXRpb25JbmRleCI6MX0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoic3BvcnRzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbWYtbWFuaWZlc3QuanNvbi5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvYXJ0aWZhY3RzL3Nwb3J0cy9sZWFzdC9hbmRyb2lkL2RldmVsb3BtZW50L21mLW1hbmlmZXN0Lmpzb24iLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6MjAwLCJzdGF0dXNUZXh0IjoiT0siLCJoZWFkZXJzIjp7ImFjY2VwdC1yYW5nZXMiOiJieXRlcyIsImFnZSI6IjAiLCJjYWNoZS1jb250cm9sIjoicHVibGljLG1heC1hZ2U9MCxtdXN0LXJldmFsaWRhdGUiLCJjYWNoZS1zdGF0dXMiOiJcIk5ldGxpZnkgRWRnZVwiOyBmd2Q9bWlzcyIsImNvbnRlbnQtdHlwZSI6ImFwcGxpY2F0aW9uL2pzb24iLCJkYXRlIjoiVGh1LCAxNyBKdWwgMjAyNSAxNjoyMDo1MSBHTVQiLCJldGFnIjoiXCI2MmQ0M2NhNzkzZjEyYjgwZGQ1MWI0NmM4ZjRlYjM4Yy1zc2wtZGZcIiIsInNlcnZlciI6Ik5ldGxpZnkiLCJzdHJpY3QtdHJhbnNwb3J0LXNlY3VyaXR5IjoibWF4LWFnZT0zMTUzNjAwMDsgaW5jbHVkZVN1YkRvbWFpbnM7IHByZWxvYWQiLCJ2YXJ5IjoiQWNjZXB0LUVuY29kaW5nIiwieC1uZi1yZXF1ZXN0LWlkIjoiMDFLMENLMEo5WUFHMk5ETUdERkszUjZEUzYiLCJjb25uZWN0aW9uIjoiY2xvc2UiLCJ0cmFuc2Zlci1lbmNvZGluZyI6ImNodW5rZWQifSwiZGF0YSI6eyJpZCI6InNwb3J0cyIsIm5hbWUiOiJzcG9ydHMiLCJtZXRhRGF0YSI6eyJuYW1lIjoic3BvcnRzIiwidHlwZSI6ImFwcCIsImJ1aWxkSW5mbyI6eyJidWlsZFZlcnNpb24iOiIxLjAuMCIsImJ1aWxkTmFtZSI6InNwb3J0cyJ9LCJyZW1vdGVFbnRyeSI6eyJuYW1lIjoic3BvcnRzLmNvbnRhaW5lci5idW5kbGUiLCJwYXRoIjoiIiwidHlwZSI6Imdsb2JhbCJ9LCJ0eXBlcyI6eyJwYXRoIjoiIiwibmFtZSI6IiIsInppcCI6IiIsImFwaSI6IiJ9LCJnbG9iYWxOYW1lIjoic3BvcnRzIiwicGx1Z2luVmVyc2lvbiI6IjAuMTAuMCIsInByZWZldGNoSW50ZXJmYWNlIjpmYWxzZSwicHVibGljUGF0aCI6Im5vb3A6Ly8vIn0sInNoYXJlZCI6W3siaWQiOiJzcG9ydHM6cmVhY3QtbmF0aXZlIiwibmFtZSI6InJlYWN0LW5hdGl2ZSIsInZlcnNpb24iOiIwLjc4LjAiLCJzaW5nbGV0b24iOnRydWUsInJlcXVpcmVkVmVyc2lvbiI6Il4wLjc4LjAiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJzcG9ydHM6cmVhY3QiLCJuYW1lIjoicmVhY3QiLCJ2ZXJzaW9uIjoiMTkuMC4wIiwic2luZ2xldG9uIjp0cnVlLCJyZXF1aXJlZFZlcnNpb24iOiJeMTkuMC4wIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbXSwic3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJzcG9ydHM6QHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0cyIsIm5hbWUiOiJAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzIiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOC5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6InNwb3J0czpAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMiLCJuYW1lIjoiQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzIiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6W10sInN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoic3BvcnRzOkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5IiwibmFtZSI6IkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5IiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6W10sInN5bmMiOlsibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoic3BvcnRzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZSIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6InNwb3J0czpAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQiLCJuYW1lIjoiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0IiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6W10sInN5bmMiOlsibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6InNwb3J0czpyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZSIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZSIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOltdLCJzeW5jIjpbIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19LHsiaWQiOiJzcG9ydHM6cmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkiLCJuYW1lIjoicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4LmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF9janMtbm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19jYWxsc3RhY2tfcmVwYWNrX2Rpc3RfbW9kdWxlc19FbXB0eU1vZHVsZV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19nZXRfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF8tZGQyNTdlLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yLWU4NmVlNi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19jbGFzc19wcml2YXRlX2ZpZWxkX2xvb3NlX2Jhc2VfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janMtMzEyMjdiLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUxLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbImluZGV4LmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6InNwb3J0czpyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkiLCJuYW1lIjoicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5IiwidmVyc2lvbiI6IioiLCJyZXF1aXJlZFZlcnNpb24iOiJeKiIsImFzc2V0cyI6eyJqcyI6eyJhc3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOC5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUwLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvcl9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfY2pzLW5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfY2FsbHN0YWNrX3JlcGFja19kaXN0X21vZHVsZXNfRW1wdHlNb2R1bGVfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fZ2V0X2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfLWRkMjU3ZS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X1ZpZXdDb24tOTkxYzhhLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTYuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fY2xhc3NfcHJpdmF0ZV9maWVsZF9sb29zZV9iYXNlX2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzLTMxMjI3Yi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MS5jaHVuay5idW5kbGUiXSwic3luYyI6WyJpbmRleC5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoic3BvcnRzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeSIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnkiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUwLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUxLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7ImFzeW5jIjpbXSwic3luYyI6W119fX0seyJpZCI6InNwb3J0czpyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlIiwibmFtZSI6InJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4LmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF9janMtbm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19jYWxsc3RhY2tfcmVwYWNrX2Rpc3RfbW9kdWxlc19FbXB0eU1vZHVsZV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19nZXRfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF8tZGQyNTdlLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yLWU4NmVlNi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19jbGFzc19wcml2YXRlX2ZpZWxkX2xvb3NlX2Jhc2VfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janMtMzEyMjdiLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUxLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbImluZGV4LmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGEuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoic3BvcnRzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheSIsIm5hbWUiOiJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkiLCJ2ZXJzaW9uIjoiKiIsInJlcXVpcmVkVmVyc2lvbiI6Il4qIiwiYXNzZXRzIjp7ImpzIjp7ImFzeW5jIjpbInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4LmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTAuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF9janMtbm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19jYWxsc3RhY2tfcmVwYWNrX2Rpc3RfbW9kdWxlc19FbXB0eU1vZHVsZV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19nZXRfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF8tZGQyNTdlLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGEuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yLWU4NmVlNi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19jbGFzc19wcml2YXRlX2ZpZWxkX2xvb3NlX2Jhc2VfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janMtMzEyMjdiLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUxLmNodW5rLmJ1bmRsZSJdLCJzeW5jIjpbImluZGV4LmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTYuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoic3BvcnRzOnJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3IiLCJuYW1lIjoicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvciIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MTguY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MC5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkX2Nqcy1ub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2NhbGxzdGFja19yZXBhY2tfZGlzdF9tb2R1bGVzX0VtcHR5TW9kdWxlX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2dldF9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkXy1kZDI1N2UuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9WaWV3Q29uLTk5MWM4YS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3ItZTg2ZWU2LmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2NsYXNzX3ByaXZhdGVfZmllbGRfbG9vc2VfYmFzZV9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqcy0zMTIyN2IuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTEuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsiaW5kZXguYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yLWU4NmVlNi5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIl19LCJjc3MiOnsiYXN5bmMiOltdLCJzeW5jIjpbXX19fSx7ImlkIjoic3BvcnRzOnJlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MiLCJuYW1lIjoicmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncyIsInZlcnNpb24iOiIqIiwicmVxdWlyZWRWZXJzaW9uIjoiXioiLCJhc3NldHMiOnsianMiOnsiYXN5bmMiOlsidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MTguY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MC5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkX2Nqcy1ub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2NhbGxzdGFja19yZXBhY2tfZGlzdF9tb2R1bGVzX0VtcHR5TW9kdWxlX2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2dldF9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkXy1kZDI1N2UuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9WaWV3Q29uLTk5MWM4YS5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3ItZTg2ZWU2LmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2NsYXNzX3ByaXZhdGVfZmllbGRfbG9vc2VfYmFzZV9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqcy0zMTIyN2IuY2h1bmsuYnVuZGxlIiwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfSW1hZ2VfQXNzZXRSZWdpc3RyeV9qcy1fMjQ1NTEuY2h1bmsuYnVuZGxlIl0sInN5bmMiOlsiaW5kZXguYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qcy5jaHVuay5idW5kbGUiXX0sImNzcyI6eyJhc3luYyI6W10sInN5bmMiOltdfX19XSwicmVtb3RlcyI6W10sImV4cG9zZXMiOlt7ImlkIjoic3BvcnRzOkFwcCIsIm5hbWUiOiJBcHAiLCJhc3NldHMiOnsianMiOnsic3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19zaG9waWZ5X3JlYWN0LW5hdGl2ZS1wZXJmb3JtYW5jZV9kaXN0X2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIl9fZmVkZXJhdGlvbl9leHBvc2VfQXBwLmNodW5rLmJ1bmRsZSJdLCJhc3luYyI6WyJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOC5jaHVuay5idW5kbGUiLCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzLmNodW5rLmJ1bmRsZSIsInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9qcy5jaHVuay5idW5kbGUiLCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanMuY2h1bmsuYnVuZGxlIiwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX2luZGV4X2pzLmNodW5rLmJ1bmRsZSIsIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUwLmNodW5rLmJ1bmRsZSJdfSwiY3NzIjp7InN5bmMiOltdLCJhc3luYyI6W119fSwicGF0aCI6Ii4vQXBwIn1dfSwicmVzcG9uc2VUaW1lIjozOTU4LCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOm51bGwsInN0YXR1cyI6InBhc3MiLCJhc3NlcnRpb25SZXN1bHRzIjpbXSwidGVzdFJlc3VsdHMiOltdLCJwcmVSZXF1ZXN0VGVzdFJlc3VsdHMiOltdLCJwb3N0UmVzcG9uc2VUZXN0UmVzdWx0cyI6W10sInNob3VsZFN0b3BSdW5uZXJFeGVjdXRpb24iOmZhbHNlLCJydW5EdXJhdGlvbiI6NC45NjA4MTU2MDUsIm5hbWUiOiIvc3BvcnRzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvbWYtbWFuaWZlc3QuanNvbiIsInBhdGgiOiJzcG9ydHMtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC1tZi1tYW5pZmVzdC5qc29uIiwiaXRlcmF0aW9uSW5kZXgiOjF9LHsidGVzdCI6eyJmaWxlbmFtZSI6InNwb3J0cy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LXNwb3J0cy5jb250YWluZXIuYnVuZGxlLmJydSJ9LCJyZXF1ZXN0Ijp7Im1ldGhvZCI6IkdFVCIsInVybCI6Imh0dHBzOi8vcmVhY3QtbmF0aXZlLWFydGlmYWN0cy5uZXRsaWZ5LmFwcC9hcnRpZmFjdHMvc3BvcnRzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvc3BvcnRzLmNvbnRhaW5lci5idW5kbGUiLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6MjAwLCJzdGF0dXNUZXh0IjoiT0siLCJoZWFkZXJzIjp7ImFjY2VwdC1yYW5nZXMiOiJieXRlcyIsImFnZSI6IjIiLCJjYWNoZS1jb250cm9sIjoicHVibGljLG1heC1hZ2U9MCxtdXN0LXJldmFsaWRhdGUiLCJjYWNoZS1zdGF0dXMiOiJcIk5ldGxpZnkgRWRnZVwiOyBmd2Q9bWlzcyIsImNvbnRlbnQtdHlwZSI6InRleHQvamF2YXNjcmlwdCIsImRhdGUiOiJUaHUsIDE3IEp1bCAyMDI1IDE2OjIwOjU3IEdNVCIsImV0YWciOiJcImMxNjM4MTg1YzM2NWVhYTYxNThiOTZkNTQ0ZjJiOTFlLXNzbC1kZlwiIiwic2VydmVyIjoiTmV0bGlmeSIsInN0cmljdC10cmFuc3BvcnQtc2VjdXJpdHkiOiJtYXgtYWdlPTMxNTM2MDAwOyBpbmNsdWRlU3ViRG9tYWluczsgcHJlbG9hZCIsInZhcnkiOiJBY2NlcHQtRW5jb2RpbmciLCJ4LW5mLXJlcXVlc3QtaWQiOiIwMUswQ0swUUNLQlpCM1lHSEpUQTVZWUtaQyIsImNvbm5lY3Rpb24iOiJjbG9zZSIsInRyYW5zZmVyLWVuY29kaW5nIjoiY2h1bmtlZCJ9LCJkYXRhIjoiLyoqKioqKi8gdmFyIHNlbGYgPSBzZWxmIHx8IHRoaXMgfHwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKSB8fCAoe30pOyAvLyByZXBhY2tHbG9iYWwnXG4vKioqKioqL1xudmFyIHNwb3J0cztcbihmdW5jdGlvbigpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxudmFyIF9fd2VicGFja19tb2R1bGVzX18gPSAoe1xuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL0NvcmVQbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL0NvcmVQbHVnaW4uanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX2RlZmF1bHQ7XG4gICAgfVxufSkpO1xudmFyIF9hc3luY190b19nZW5lcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fYXN5bmNfdG9fZ2VuZXJhdG9yICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiKTtcbnZhciBSZXBhY2tDb3JlUGx1Z2luID0gKCk9Pih7XG4gICAgICAgIG5hbWU6ICdyZXBhY2stY29yZS1wbHVnaW4nLFxuICAgICAgICBsb2FkRW50cnk6IChyZWYpPT57XG4gICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IHJlZi5yZW1vdGVJbmZvO1xuICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNsaWVudCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL1NjcmlwdE1hbmFnZXIvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9pbmRleC5qc1wiKTtcbiAgICAgICAgICAgICAgICB2YXIgU2NyaXB0TWFuYWdlciA9IGNsaWVudC5TY3JpcHRNYW5hZ2VyLCBnZXRXZWJwYWNrQ29udGV4dCA9IGNsaWVudC5nZXRXZWJwYWNrQ29udGV4dDtcbiAgICAgICAgICAgICAgICB2YXIgZW50cnkgPSByZW1vdGVJbmZvLmVudHJ5LCBlbnRyeUdsb2JhbE5hbWUgPSByZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5sb2FkU2NyaXB0KGVudHJ5R2xvYmFsTmFtZSwgdW5kZWZpbmVkLCBnZXRXZWJwYWNrQ29udGV4dCgpLCBlbnRyeSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFnbG9iYWxUaGlzW2VudHJ5R2xvYmFsTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdsb2JhbFRoaXNbZW50cnlHbG9iYWxOYW1lXTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBsb2FkIHJlbW90ZSBlbnRyeTogJHtlbnRyeUdsb2JhbE5hbWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2VuZXJhdGVQcmVsb2FkQXNzZXRzOiAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAvLyBub29wIGZvciBjb21wYXRpYmlsaXR5XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgICAgIGNzc0Fzc2V0czogW10sXG4gICAgICAgICAgICAgICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5OiBbXSxcbiAgICAgICAgICAgICAgICAgICAgZW50cnlBc3NldHM6IFtdXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KSgpXG4gICAgfSk7XG52YXIgX2RlZmF1bHQgPSBSZXBhY2tDb3JlUGx1Z2luO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL1Jlc29sdmVyUGx1Z2luLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvUmVzb2x2ZXJQbHVnaW4uanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZGVmYXVsdFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9kZWZhdWx0O1xuICAgIH1cbn0pKTtcbnZhciBfYXN5bmNfdG9fZ2VuZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2FzeW5jX3RvX2dlbmVyYXRvciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FzeW5jX3RvX2dlbmVyYXRvci5janNcIik7XG52YXIgX29iamVjdF9zcHJlYWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fb2JqZWN0X3NwcmVhZCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX29iamVjdF9zcHJlYWQuY2pzXCIpO1xudmFyIGNyZWF0ZVNjcmlwdExvY2F0b3IgPSAoZW50cnlVcmwsIGNvbmZpZyk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB2YXIgbG9jYXRvciA9IHlpZWxkIGNvbmZpZyhlbnRyeVVybCk7XG4gICAgICAgICAgICByZXR1cm4gbG9jYXRvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHJldHVybiBfb2JqZWN0X3NwcmVhZC5fKHtcbiAgICAgICAgICAgICAgICB1cmw6IGVudHJ5VXJsXG4gICAgICAgICAgICB9LCBjb25maWcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cmw6IGVudHJ5VXJsXG4gICAgICAgIH07XG4gICAgfSkoKTtcbnZhciBSZXBhY2tSZXNvbHZlclBsdWdpbiA9IChjb25maWcpPT4oe1xuICAgICAgICBuYW1lOiAncmVwYWNrLXJlc29sdmVyLXBsdWdpbicsXG4gICAgICAgIGFmdGVyUmVzb2x2ZSAoYXJncykge1xuICAgICAgICAgICAgdmFyIFNjcmlwdE1hbmFnZXIgPSAoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vU2NyaXB0TWFuYWdlci9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzXCIpLyogLlNjcmlwdE1hbmFnZXIgKi8uU2NyaXB0TWFuYWdlcik7XG4gICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IGFyZ3MucmVtb3RlSW5mbztcbiAgICAgICAgICAgIFNjcmlwdE1hbmFnZXIuc2hhcmVkLmFkZFJlc29sdmVyKChzY3JpcHRJZCwgY2FsbGVyLCByZWZlcmVuY2VVcmwpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlbnRyeSBjb250YWluZXJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjcmlwdElkID09PSByZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0b3IgPSB5aWVsZCBjcmVhdGVTY3JpcHRMb2NhdG9yKHJlbW90ZUluZm8uZW50cnksIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBlbnRyeSBjaHVua3NcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlZmVyZW5jZVVybCAmJiBjYWxsZXIgPT09IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHVibGljUGF0aCA9IHJlbW90ZUluZm8uZW50cnkuc3BsaXQoJy8nKS5zbGljZSgwLCAtMSkuam9pbignLycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1bmRsZVBhdGggPSBzY3JpcHRJZCArIHJlZmVyZW5jZVVybC5zcGxpdChzY3JpcHRJZClbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gcHVibGljUGF0aCArICcvJyArIGJ1bmRsZVBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRvcjEgPSB5aWVsZCBjcmVhdGVTY3JpcHRMb2NhdG9yKHVybCwgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhdG9yMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKCksIHtcbiAgICAgICAgICAgICAgICBrZXk6IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBhcmdzO1xuICAgICAgICB9XG4gICAgfSk7XG52YXIgX2RlZmF1bHQgPSBSZXBhY2tSZXNvbHZlclBsdWdpbjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0LmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0LmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiU2NyaXB0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gU2NyaXB0O1xuICAgIH1cbn0pKTtcbnZhciBfY2xhc3NfY2FsbF9jaGVjayA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jbGFzc19jYWxsX2NoZWNrICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janNcIik7XG52YXIgX2NyZWF0ZV9jbGFzcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jcmVhdGVfY2xhc3MgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzXCIpO1xudmFyIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiKTtcbnZhciBfc2hhbGxvd2VxdWFsID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBzaGFsbG93ZXF1YWwgKi8gXCIuL25vZGVfbW9kdWxlcy9zaGFsbG93ZXF1YWwvaW5kZXguanNcIikpO1xudmFyIF9OYXRpdmVTY3JpcHRNYW5hZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvTmF0aXZlU2NyaXB0TWFuYWdlci5qc1wiKTtcbnZhciBTY3JpcHQgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIGZ1bmN0aW9uIFNjcmlwdChzY3JpcHRJZCwgY2FsbGVyLCBsb2NhdG9yLCByZWYpIHtcbiAgICAgICAgdmFyIGNhY2hlID0gcmVmID09PSB2b2lkIDAgPyB0cnVlIDogcmVmO1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFNjcmlwdCk7XG4gICAgICAgIHRoaXMuc2NyaXB0SWQgPSBzY3JpcHRJZDtcbiAgICAgICAgdGhpcy5jYWxsZXIgPSBjYWxsZXI7XG4gICAgICAgIHRoaXMubG9jYXRvciA9IGxvY2F0b3I7XG4gICAgICAgIHRoaXMuY2FjaGUgPSBjYWNoZTtcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFNjcmlwdCwgW1xuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIHNjcmlwdCB3YXMgYWxyZWFkeSBjYWNoZWQgYW5kIGNhY2hlIHNob3VsZCBiZSB1cGRhdGVkIHdpdGggbmV3IGRhdGEuXG4gICAqXG4gICAqIEBwYXJhbSBjYWNoZWREYXRhIENhY2hlZCBkYXRhIGZvciB0aGUgc2FtZSBzY3JpcHQuXG4gICAqXG4gICAqIEBpbnRlcm5hbFxuICAgKi8ga2V5OiBcInNob3VsZFVwZGF0ZUNhY2hlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdWxkVXBkYXRlQ2FjaGUoY2FjaGVkRGF0YSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZSB8fCAhY2FjaGVkRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNoZWNrSWZDYWNoZURhdGFPdXRkYXRlZChjYWNoZWREYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIENoZWNrIGlmIHRoZSBzY3JpcHQgc2hvdWxkIGJlIGZldGNoZWQgYWdhaW4gb3IgcmV1c2VkLFxuICAgKiBiYXNlZCBvbiBwcmV2aW91cyBjYWNoZWQgZGF0YS5cbiAgICpcbiAgICogQHBhcmFtIGNhY2hlZERhdGEgQ2FjaGVkIGRhdGEgZm9yIHRoZSBzYW1lIHNjcmlwdC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwic2hvdWxkUmVmZXRjaFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNob3VsZFJlZmV0Y2goY2FjaGVkRGF0YSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkKGNhY2hlZERhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogQ2hlY2sgaWYgcHJldmlvdXMgY2FjaGVkIGRhdGEgaXMgdGhlIHNhbWUgYXMgdGhlIG5ldyBvbmUuXG4gICAqXG4gICAqIEBwYXJhbSBjYWNoZWREYXRhIENhY2hlZCBkYXRhIGZvciB0aGUgc2FtZSBzY3JpcHQuXG4gICAqXG4gICAqIEBpbnRlcm5hbFxuICAgKi8ga2V5OiBcImNoZWNrSWZDYWNoZURhdGFPdXRkYXRlZFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNoZWNrSWZDYWNoZURhdGFPdXRkYXRlZChjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZERhdGEubWV0aG9kICE9PSB0aGlzLmxvY2F0b3IubWV0aG9kIHx8IGNhY2hlZERhdGEudXJsICE9PSB0aGlzLmxvY2F0b3IudXJsIHx8IGNhY2hlZERhdGEucXVlcnkgIT09IHRoaXMubG9jYXRvci5xdWVyeSB8fCAhKDAsIF9zaGFsbG93ZXF1YWwuZGVmYXVsdCkoY2FjaGVkRGF0YS5oZWFkZXJzLCB0aGlzLmxvY2F0b3IuaGVhZGVycykgfHwgY2FjaGVkRGF0YS5ib2R5ICE9PSB0aGlzLmxvY2F0b3IuYm9keTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIEdldCBvYmplY3QgdG8gc3RvcmUgaW4gY2FjaGUuXG4gICAqXG4gICAqIEBpbnRlcm5hbFxuICAgKi8ga2V5OiBcImdldENhY2hlRGF0YVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENhY2hlRGF0YSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IHRoaXMubG9jYXRvci5tZXRob2QsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdGhpcy5sb2NhdG9yLnVybCxcbiAgICAgICAgICAgICAgICAgICAgcXVlcnk6IHRoaXMubG9jYXRvci5xdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogdGhpcy5sb2NhdG9yLmhlYWRlcnMsXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IHRoaXMubG9jYXRvci5ib2R5XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInRvT2JqZWN0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdG9PYmplY3QoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc2NyaXB0SWQ6IHRoaXMuc2NyaXB0SWQsXG4gICAgICAgICAgICAgICAgICAgIGNhbGxlcjogdGhpcy5jYWxsZXIsXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0b3I6IHRoaXMubG9jYXRvcixcbiAgICAgICAgICAgICAgICAgICAgY2FjaGU6IHRoaXMuY2FjaGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZ2V0RGV2U2VydmVyVVJMXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIEdldCBVUkwgb2YgYSBzY3JpcHQgaG9zdGVkIG9uIGRldmVsb3BtZW50IHNlcnZlci5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQuXG4gICAqLyBmdW5jdGlvbiBnZXREZXZTZXJ2ZXJVUkwoc2NyaXB0SWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHdlYnBhY2tDb250ZXh0KT0+YCR7d2VicGFja0NvbnRleHQucH0ke3dlYnBhY2tDb250ZXh0LnUoc2NyaXB0SWQpfWA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRGaWxlU3lzdGVtVVJMXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIEdldCBVUkwgb2YgYSBzY3JpcHQgc3RvcmVkIG9uIGZpbGVzeXN0ZW0gb24gdGhlIHRhcmdldCBtb2JpbGUgZGV2aWNlLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdC5cbiAgICovIGZ1bmN0aW9uIGdldEZpbGVTeXN0ZW1VUkwoc2NyaXB0SWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHdlYnBhY2tDb250ZXh0KT0+d2VicGFja0NvbnRleHQudShgZmlsZTovLy8ke3NjcmlwdElkfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZ2V0UmVtb3RlVVJMXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIEdldCBVUkwgb2YgYSBzY3JpcHQgaG9zdGVkIG9uIGEgcmVtb3RlIHNlcnZlci5cbiAgICpcbiAgICogQnkgZGVmYXVsdCBgLmNodW5rLmJ1bmRsZWAgZXh0ZW5zaW9uIHdpbGwgYmUgYWRkZWQgdG8gdGhlIFVSTC5cbiAgICogSWYgeW91ciBzY3JpcHQgaGFzIGRpZmZlcmVudCBleHRlbnNpb24sIHlvdSBzaG91bGQgcGFzcyBgeyBleGNsdWRlRXh0ZW5zaW9uOiB0cnVlIH1gIGFzIDJuZCBhcmd1bWVudC5cbiAgICpcbiAgICogQHBhcmFtIHVybCBBIFVSTCB0byByZW1vdGUgbG9jYXRpb24gd2hlcmUgdGhlIHNjcmlwdCBpcyBzdG9yZWQuXG4gICAqIEBwYXJhbSBvcHRpb25zIEFkZGl0aW9uYWwgb3B0aW9ucy5cbiAgICovIGZ1bmN0aW9uIGdldFJlbW90ZVVSTCh1cmwsIHJlZikge1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5leGNsdWRlRXh0ZW5zaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT53ZWJwYWNrQ29udGV4dC51KHVybCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRTY3JpcHRVbmlxdWVJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IC8qKlxuICAgKiBHZXQgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBzY3JpcHQuXG4gICAqXG4gICAqIFVzZWQgdG8gY3JlYXRlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgc2NyaXB0LCB3aGljaCBzZXJ2ZXMgYXMgaXRzIGtleSBpbiB0aGUgY2FjaGUuXG4gICAqXG4gICAqIEBwYXJhbSBzY3JpcHRJZCBJZCBvZiB0aGUgc2NyaXB0LlxuICAgKiBAcGFyYW0gY2FsbGVyIE9wdGlvbmFsIGNhbGxlciBuYW1lIHRvIHByZWZpeCB0aGUgc2NyaXB0IGlkLlxuICAgKi8gZnVuY3Rpb24gZ2V0U2NyaXB0VW5pcXVlSWQoc2NyaXB0SWQsIGNhbGxlcikge1xuICAgICAgICAgICAgICAgIHZhciBwcmVmaXggPSBjYWxsZXIgPyBjYWxsZXIgKyAnXycgOiAnJztcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJlZml4ICsgc2NyaXB0SWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJmcm9tXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIENyZWF0ZSBuZXcgaW5zdGFuY2Ugb2YgYFNjcmlwdGAgZnJvbSBub24tbm9ybWFsaXplZCBzY3JpcHQgbG9jYXRvciBkYXRhLlxuICAgKlxuICAgKiBAcGFyYW0gbG9jYXRvciBOb24tbm9ybWFsaXplZCBsb2NhdG9yIGRhdGEuXG4gICAqIEBwYXJhbSBmZXRjaCBJbml0aWFsIGZsYWcgZm9yIHdoZXRoZXIgc2NyaXB0IHNob3VsZCBiZSBmZXRjaGVkIG9yIG5vdC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBmdW5jdGlvbiBmcm9tKGtleSwgbG9jYXRvciwgZmV0Y2gpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IHt9O1xuICAgICAgICAgICAgICAgIG5ldyBIZWFkZXJzKGxvY2F0b3IuaGVhZGVycykuZm9yRWFjaCgodmFsdWUsIGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1trZXkudG9Mb3dlckNhc2UoKV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgdW5pcXVlSWQgPSBTY3JpcHQuZ2V0U2NyaXB0VW5pcXVlSWQoa2V5LnNjcmlwdElkLCBrZXkuY2FsbGVyKTtcbiAgICAgICAgICAgICAgICB2YXIgYm9keTtcbiAgICAgICAgICAgICAgICBpZiAobG9jYXRvci5ib2R5IGluc3RhbmNlb2YgRm9ybURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJvZHlPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRvci5ib2R5LmZvckVhY2goKHZhbHVlLCBrZXkpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHlPYmplY3Rba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1NjcmlwdCBkb2VzIG5vdCBzdXBwb3J0IEZpbGUgYXMgRm9ybURhdGEga2V5IGluIGJvZHknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJvZHkgPSBKU09OLnN0cmluZ2lmeShib2R5T2JqZWN0KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxvY2F0b3IuYm9keSBpbnN0YW5jZW9mIFVSTFNlYXJjaFBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm9keU9iamVjdDEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRvci5ib2R5LmZvckVhY2goKHZhbHVlLCBrZXkpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBib2R5T2JqZWN0MVtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBib2R5ID0gSlNPTi5zdHJpbmdpZnkoYm9keU9iamVjdDEpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGJvZHkgPSBsb2NhdG9yLmJvZHkgPz8gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGxvY2F0b3IudXJsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUHJvcGVydHkgdXJsIGFzIGEgZnVuY3Rpb24gaXMgbm90IHN1cHBvcnQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHQoa2V5LnNjcmlwdElkLCBrZXkuY2FsbGVyLCB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZUlkLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IGxvY2F0b3IubWV0aG9kID8/IF9OYXRpdmVTY3JpcHRNYW5hZ2VyLk5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZC5HRVQsXG4gICAgICAgICAgICAgICAgICAgIHVybDogbG9jYXRvci51cmwsXG4gICAgICAgICAgICAgICAgICAgIGFic29sdXRlOiBsb2NhdG9yLmFic29sdXRlID8/IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiBsb2NhdG9yLnRpbWVvdXQgPz8gU2NyaXB0LkRFRkFVTFRfVElNRU9VVCxcbiAgICAgICAgICAgICAgICAgICAgcmV0cnk6IGxvY2F0b3IucmV0cnksXG4gICAgICAgICAgICAgICAgICAgIHJldHJ5RGVsYXk6IGxvY2F0b3IucmV0cnlEZWxheSxcbiAgICAgICAgICAgICAgICAgICAgcXVlcnk6IG5ldyBVUkxTZWFyY2hQYXJhbXMobG9jYXRvci5xdWVyeSkudG9TdHJpbmcoKSB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGJvZHksXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IE9iamVjdC5rZXlzKGhlYWRlcnMpLmxlbmd0aCA/IGhlYWRlcnMgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGZldGNoOiBsb2NhdG9yLmNhY2hlID09PSBmYWxzZSA/IHRydWUgOiBmZXRjaCxcbiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5U2NyaXB0U2lnbmF0dXJlOiBsb2NhdG9yLnZlcmlmeVNjcmlwdFNpZ25hdHVyZSA/PyBfTmF0aXZlU2NyaXB0TWFuYWdlci5Ob3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGUuT0ZGXG4gICAgICAgICAgICAgICAgfSwgbG9jYXRvci5jYWNoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gU2NyaXB0O1xufSAvLyMgc291cmNlTWFwcGluZ1VSTD1TY3JpcHQuanMubWFwXG4oKTtcblNjcmlwdC5ERUZBVUxUX1RJTUVPVVQgPSAzMDAwMCAvLyAzMHNcbjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0TWFuYWdlci5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHRNYW5hZ2VyLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4vLyBiaW9tZS1pZ25vcmUgbGludC9zdHlsZS91c2VOb2RlanNJbXBvcnRQcm90b2NvbDogdXNlICdldmVudHMnIG1vZHVsZSBpbnN0ZWFkIG9mIG5vZGUgYnVpbHRpblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJTY3JpcHRNYW5hZ2VyXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gU2NyaXB0TWFuYWdlcjtcbiAgICB9XG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIF9jYWxsX3N1cGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NhbGxfc3VwZXIgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jYWxsX3N1cGVyLmNqc1wiKTtcbnZhciBfY2xhc3NfY2FsbF9jaGVjayA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jbGFzc19jYWxsX2NoZWNrICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janNcIik7XG52YXIgX2NyZWF0ZV9jbGFzcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jcmVhdGVfY2xhc3MgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzXCIpO1xudmFyIF9pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbmhlcml0cyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2luaGVyaXRzLmNqc1wiKTtcbnZhciBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janNcIik7XG52YXIgX3NsaWNlZF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19zbGljZWRfdG9fYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19jb25zdW1hYmxlX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2NvbnN1bWFibGVfYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqc1wiKTtcbnZhciBfZXZlbnRzID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBldmVudHMgKi8gXCIuL25vZGVfbW9kdWxlcy9ldmVudHMvZXZlbnRzLmpzXCIpKTtcbnZhciBfTmF0aXZlU2NyaXB0TWFuYWdlciA9IC8qI19fUFVSRV9fKi8gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0Ll8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvTmF0aXZlU2NyaXB0TWFuYWdlci5qc1wiKSk7XG52YXIgX1NjcmlwdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vU2NyaXB0LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0LmpzXCIpO1xudmFyIF9nZXRXZWJwYWNrQ29udGV4dCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZ2V0V2VicGFja0NvbnRleHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9nZXRXZWJwYWNrQ29udGV4dC5qc1wiKTtcbnZhciBERUZBVUxUX1JFU09MVkVSX1BSSU9SSVRZID0gMjtcbnZhciBERUZBVUxUX1JFU09MVkVSX0tFWSA9ICdfX2RlZmF1bHRfXyc7XG52YXIgQ0FDSEVfTkFNRSA9ICdSZXBhY2suU2NyaXB0TWFuYWdlci5DYWNoZSc7XG52YXIgQ0FDSEVfVkVSU0lPTiA9ICd2NCc7XG52YXIgQ0FDSEVfRU5WID0gIHRydWUgPyAnZGVidWcnIDogMDtcbnZhciBDQUNIRV9LRVkgPSBbXG4gICAgQ0FDSEVfTkFNRSxcbiAgICBDQUNIRV9WRVJTSU9OLFxuICAgIENBQ0hFX0VOVlxuXS5qb2luKCcuJyk7XG52YXIgTE9BRElOR19FUlJPUl9DT0RFUyA9IFtcbiAgICAvLyBhbmRyb2lkXG4gICAgJ05ldHdvcmtGYWlsdXJlJyxcbiAgICAnUmVxdWVzdEZhaWx1cmUnLFxuICAgIC8vIGlvc1xuICAgICdTY3JpcHREb3dubG9hZEZhaWx1cmUnXG5dO1xudmFyIFNjcmlwdE1hbmFnZXIgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKEV2ZW50RW1pdHRlcikge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIF9pbmhlcml0cy5fKFNjcmlwdE1hbmFnZXIsIEV2ZW50RW1pdHRlcik7XG4gICAgZnVuY3Rpb24gU2NyaXB0TWFuYWdlcihyZWYpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVNjcmlwdE1hbmFnZXIgPSByZWYgPT09IHZvaWQgMCA/IF9OYXRpdmVTY3JpcHRNYW5hZ2VyLmRlZmF1bHQgOiByZWY7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU2NyaXB0TWFuYWdlcik7XG4gICAgICAgIHZhciBfdGhpcztcbiAgICAgICAgX3RoaXMgPSBfY2FsbF9zdXBlci5fKHRoaXMsIFNjcmlwdE1hbmFnZXIpLCBfdGhpcy5jYWNoZSA9IHt9LCBfdGhpcy5zY3JpcHRzUHJvbWlzZXMgPSB7fSwgX3RoaXMuY2FjaGVJbml0aWFsaXplZCA9IGZhbHNlLCBfdGhpcy5yZXNvbHZlcnMgPSBbXTtcbiAgICAgICAgX3RoaXMubmF0aXZlU2NyaXB0TWFuYWdlciA9IG5hdGl2ZVNjcmlwdE1hbmFnZXI7XG4gICAgICAgIGlmICghbmF0aXZlU2NyaXB0TWFuYWdlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdyZXBhY2sgcmVhY3QtbmF0aXZlIG1vZHVsZSB3YXMgbm90IGZvdW5kLicgKyAoIHRydWUgPyAnIERpZCB5b3UgZm9yZ2V0IHRvIHVwZGF0ZSBuYXRpdmUgZGVwZW5kZW5jaWVzPycgOiAwKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NjcmlwdE1hbmFnZXIgd2FzIGFscmVhZHkgaW5zdGFudGlhdGVkLiBVc2UgU2NyaXB0TWFuYWdlci5zaGFyZWQgaW5zdGVhZC4nKTtcbiAgICAgICAgfVxuICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlciA9IF90aGlzO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTY3JpcHRNYW5hZ2VyLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBTZXRzIGEgc3RvcmFnZSBiYWNrZW5kIHRvIGNhY2hlIHJlc29sdmVkIHNjcmlwdHMgbG9jYXRvciBkYXRhLlxuICAgKlxuICAgKiBUaGUgc3RvcmVkIGRhdGEgaXMgdXNlZCB0byBkZXRlY3QgaWYgc2NyaXB0cyBsb2NhdG9yIGRhdGEgb2YgcHJldmlvdXNseSBkb3dubG9hZGVkXG4gICAqIHNjcmlwdCBoYXNuJ3QgY2hhbmdlZCB0byBhdm9pZCBvdmVyLWZldGNoaW5nIHRoZSBzY3JpcHQuXG4gICAqXG4gICAqIEBwYXJhbSBzdG9yYWdlIEltcGxlbWVudGF0aW9uIG9mIHN0b3JhZ2UgZnVuY3Rpb25zLlxuICAgKi8ga2V5OiBcInNldFN0b3JhZ2VcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTdG9yYWdlKHN0b3JhZ2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3JhZ2UgPSBzdG9yYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogQWRkcyBuZXcgc2NyaXB0IGxvY2F0b3IgcmVzb2x2ZXIuXG4gICAqXG4gICAqIFJlc29sdmVyIGlzIGFuIGFzeW5jIGZ1bmN0aW9uIHRvIHJlc29sdmUgc2NyaXB0IGxvY2F0b3IgZGF0YSAtIGluIG90aGVyIHdvcmRzLCBpdCdzIGEgZnVuY3Rpb24gdG9cbiAgICogdGVsbCB0aGUge0BsaW5rIFNjcmlwdE1hbmFnZXJ9IGhvdyB0byBmZXRjaCB0aGUgc2NyaXB0LlxuICAgKlxuICAgKiBUaGVyZSdzIG5vIGxpbWl0YXRpb24gb24gd2hhdCBsb2dpYyB5b3UgY2FuIHJ1biBpbnNpZGUgdGhpcyBmdW5jdGlvbiAtIGl0IGNhbiBpbmNsdWRlOlxuICAgKiAtIGZldGNoaW5nL2xvYWRpbmcgcmVtb3RlIGNvbmZpZ1xuICAgKiAtIGZldGNoaW5nL2xvYWRpbmcgZmVhdHVyZSBmbGFnc1xuICAgKiAtIGZldGNoaW5nL2xvYWRpbmcgQS9CIHRlc3RpbmcgZGF0YVxuICAgKiAtIGNhbGxpbmcgbmF0aXZlIG1vZHVsZXNcbiAgICogLSBydW5uaW5nIGFyYml0cmFyeSBsb2dpY1xuICAgKlxuICAgKiBAcGFyYW0gcmVzb2x2ZXIgUmVzb2x2ZXIgZnVuY3Rpb24gdG8gYWRkLlxuICAgKiBAcGFyYW0gb3B0aW9ucyBSZXNvbHZlciBvcHRpb25zLlxuICAgKi8ga2V5OiBcImFkZFJlc29sdmVyXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkUmVzb2x2ZXIocmVzb2x2ZXIsIHJlZikge1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICAgICAgICAgICAgICB2YXIgcHJpb3JpdHkgPSBvcHRpb25zLnByaW9yaXR5ID8/IERFRkFVTFRfUkVTT0xWRVJfUFJJT1JJVFk7XG4gICAgICAgICAgICAgICAgdmFyIHVuaXF1ZUtleSA9IG9wdGlvbnMua2V5O1xuICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZXJzID0gdGhpcy5yZXNvbHZlcnMuZmlsdGVyKChyZWYpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMSksIGtleSA9IF9yZWZbMF07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXkgIT09IHVuaXF1ZUtleTtcbiAgICAgICAgICAgICAgICB9KS5jb25jYXQoW1xuICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICB1bmlxdWVLZXkgPz8gREVGQVVMVF9SRVNPTFZFUl9LRVksXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmlvcml0eSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVyXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICBdKS5zb3J0KChyZWYsIHJlZjEpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMiksIGEgPSBfcmVmWzFdLCBfcmVmMSA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYxLCAyKSwgYiA9IF9yZWYxWzFdO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYiAtIGE7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBSZW1vdmVzIHByZXZpb3VzbHkgYWRkZWQgcmVzb2x2ZXIuXG4gICAqXG4gICAqIEBwYXJhbSByZXNvbHZlciBSZXNvbHZlciBmdW5jdGlvbiBvciByZXNvbHZlcidzIGB1bmlxdWVLZXlgIHRvIHJlbW92ZS5cbiAgICogQHJldHVybnMgYHRydWVgIGlmIHJlc29sdmVyIHdhcyBmb3VuZCBhbmQgcmVtb3ZlZCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAqLyBrZXk6IFwicmVtb3ZlUmVzb2x2ZXJcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVSZXNvbHZlcihyZXNvbHZlcikge1xuICAgICAgICAgICAgICAgIHZhciBpbmRleDtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc29sdmVyID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IHRoaXMucmVzb2x2ZXJzLmZpbmRJbmRleCgocmVmKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAxKSwga2V5ID0gX3JlZlswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXkgPT09IHJlc29sdmVyO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IHRoaXMucmVzb2x2ZXJzLmZpbmRJbmRleCgocmVmKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAzKSwgaXRlbSA9IF9yZWZbMl07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbSA9PT0gcmVzb2x2ZXI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc29sdmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogUmVtb3ZlcyBhbGwgcHJldmlvdXNseSBhZGRlZCByZXNvbHZlcnMuXG4gICAqLyBrZXk6IFwicmVtb3ZlQWxsUmVzb2x2ZXJzXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlQWxsUmVzb2x2ZXJzKCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZXJzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0Q2FjaGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0Q2FjaGUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZUluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXNfc3RvcmFnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWNoZUVudHJ5ID0geWllbGQgKF90aGlzX3N0b3JhZ2UgPSB0aGlzLnN0b3JhZ2UpID09PSBudWxsIHx8IF90aGlzX3N0b3JhZ2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzX3N0b3JhZ2UuZ2V0SXRlbShDQUNIRV9LRVkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZSA9IGNhY2hlRW50cnkgPyBKU09OLnBhcnNlKGNhY2hlRW50cnkpIDoge307XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInNhdmVDYWNoZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmVDYWNoZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzX3N0b3JhZ2U7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIChfdGhpc19zdG9yYWdlID0gdGhpcy5zdG9yYWdlKSA9PT0gbnVsbCB8fCBfdGhpc19zdG9yYWdlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpc19zdG9yYWdlLnNldEl0ZW0oQ0FDSEVfS0VZLCBKU09OLnN0cmluZ2lmeSh0aGlzLmNhY2hlKSk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImhhbmRsZUVycm9yXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlRXJyb3IoZXJyb3IsIG1lc3NhZ2UsIC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkuZXJyb3IuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncyksIFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxFcnJvcjogZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF0pKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2Vycm9yJywge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICBhcmdzLFxuICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEVycm9yOiBlcnJvclxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVzb2x2ZVNjcmlwdFwiLFxuICAgICAgICAgICAgdmFsdWU6IC8qKlxuICAgKiBSZXNvbHZlcyBhIHtAbGluayBTY3JpcHR9IGluc3RhbmNlIHdpdGggbm9ybWFsaXplZCBsb2NhdG9yIGRhdGEuXG4gICAqXG4gICAqIFJlc29sdXRpb24gd2lsbCB1c2UgcHJldmlvdXNseSBhZGRlZCAodmlhIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlciguLi4pYCkgcmVzb2x2ZXJzXG4gICAqIGluIHNlcmllcywgdXRpbCBvbmUgcmV0dXJucyBhIGxvY2F0b3IgZGF0YSBvciB3aWxsIHRocm93IGlmIG5vIHJlc29sdmVyIGhhbmRsZWQgdGhlIHJlcXVlc3QuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ3Jlc29sdmluZycsICh7IHNjcmlwdElkLCBjYWxsZXIgfSkgPT4geyB9KWAgdG8gbGlzdGVuIGZvciB3aGVuXG4gICAqIHRoZSBzY3JpcHQgcmVzb2x1dGlvbiBiZWdpbnMuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ3Jlc29sdmVkJywgKHNjcmlwdCkgPT4geyB9KWAgdG8gbGlzdGVuIGZvciB3aGVuXG4gICAqIHRoZSBzY3JpcHQncyBsb2NhdG9yIGRhdGEgaXMgcmVzb2x2ZWQuXG4gICAqXG4gICAqIEBwYXJhbSBzY3JpcHRJZCBJZCBvZiB0aGUgc2NyaXB0IHRvIHJlc29sdmUuXG4gICAqIEBwYXJhbSBjYWxsZXIgTmFtZSBvZiB0aGUgY2FsbGluZyBzY3JpcHQgLSBpdCBjYW4gYmUgZm9yIGV4YW1wbGU6IG5hbWUgb2YgdGhlIGJ1bmRsZSwgY2h1bmsgb3IgY29udGFpbmVyLlxuICAgKi8gZnVuY3Rpb24gcmVzb2x2ZVNjcmlwdChfMCwgXzEsIF8yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooc2NyaXB0SWQsIGNhbGxlciwgcmVmLCByZWZlcmVuY2VVcmwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdlYnBhY2tDb250ZXh0ID0gcmVmID09PSB2b2lkIDAgPyAoMCwgX2dldFdlYnBhY2tDb250ZXh0LmdldFdlYnBhY2tDb250ZXh0KSgpIDogcmVmO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmluaXRDYWNoZSgpO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnJlc29sdmVycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHNjcmlwdCByZXNvbHZlcnMgd2VyZSBhZGRlZC4gRGlkIHlvdSBmb3JnZXQgdG8gY2FsbCBgU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoLi4uKWA/Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ3Jlc29sdmluZycsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfJHJlZiBvZiB0aGlzLnJlc29sdmVycyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8oXyRyZWYsIDMpLCByZXNvbHZlID0gX3JlZlsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdG9yID0geWllbGQgcmVzb2x2ZShzY3JpcHRJZCwgY2FsbGVyLCByZWZlcmVuY2VVcmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbG9jYXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gcmVzb2x2ZXIgd2FzIGFibGUgdG8gcmVzb2x2ZSBzY3JpcHQgJHtzY3JpcHRJZH1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbG9jYXRvci51cmwgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdG9yLnVybCA9IGxvY2F0b3IudXJsKHdlYnBhY2tDb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzY3JpcHQgPSBfU2NyaXB0LlNjcmlwdC5mcm9tKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGxvY2F0b3IsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWNoZUtleSA9IHNjcmlwdC5sb2NhdG9yLnVuaXF1ZUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdXNlciBwcm92aWRlZCBhIGN1c3RvbSBzaG91bGRVcGRhdGVTY3JpcHQgZnVuY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdG9yLnNob3VsZFVwZGF0ZVNjcmlwdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHNvLCB3ZSBuZWVkIHRvIHdhaXQgZm9yIGl0IHRvIHJlc29sdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmV0Y2ggPSB5aWVsZCBsb2NhdG9yLnNob3VsZFVwZGF0ZVNjcmlwdChzY3JpcHRJZCwgY2FsbGVyLCBzY3JpcHQuc2hvdWxkVXBkYXRlQ2FjaGUodGhpcy5jYWNoZVtjYWNoZUtleV0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBpdCByZXR1cm5zIHRydWUsIHdlIG5lZWQgdG8gZmV0Y2ggdGhlIHNjcmlwdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmZXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHQubG9jYXRvci5mZXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgncmVzb2x2ZWQnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQgcmV0dXJucyBmYWxzZSwgd2UgZG9uJ3QgbmVlZCB0byBmZXRjaCB0aGUgc2NyaXB0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjcmlwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIG5vIGN1c3RvbSBzaG91bGRVcGRhdGVTY3JpcHQgZnVuY3Rpb24gd2FzIHByb3ZpZGVkLCB3ZSB1c2UgdGhlIGRlZmF1bHQgYmVoYXZpb3VyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FjaGVbY2FjaGVLZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyaXB0LmxvY2F0b3IuZmV0Y2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzY3JpcHQuc2hvdWxkUmVmZXRjaCh0aGlzLmNhY2hlW2NhY2hlS2V5XSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHQubG9jYXRvci5mZXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ3Jlc29sdmVkJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjcmlwdDtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdbU2NyaXB0TWFuYWdlcl0gRmFpbGVkIHdoaWxlIHJlc29sdmluZyBzY3JpcHQgbG9jYXRvcjonLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NyaXB0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJ1cGRhdGVDYWNoZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUNhY2hlKHNjcmlwdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2NyaXB0LmxvY2F0b3IuZmV0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWNoZUtleSA9IHNjcmlwdC5sb2NhdG9yLnVuaXF1ZUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZVtjYWNoZUtleV0gPSBzY3JpcHQuZ2V0Q2FjaGVEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnNhdmVDYWNoZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTY3JpcHRcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogUmVzb2x2ZXMgZ2l2ZW4gc2NyaXB0J3MgbG9jYXRpb24sIGRvd25sb2FkcyBhbmQgZXhlY3V0ZXMgaXQuXG4gICAqIFRoZSBleGVjdXRpb24gb2YgdGhlIGNvZGUgaXMgaGFuZGxlZCBpbnRlcm5hbGx5IGJ5IHRocmVhZGluZyBpbiBSZWFjdCBOYXRpdmUuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ2xvYWRpbmcnLCAoc2NyaXB0KSA9PiB7IH0pYCB0byBsaXN0ZW4gZm9yIHdoZW5cbiAgICogdGhlIHNjcmlwdCBpcyBhYm91dCB0byBiZSBsb2FkZWQuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ2xvYWRlZCcsIChzY3JpcHQpID0+IHsgfSlgIHRvIGxpc3RlbiBmb3Igd2hlblxuICAgKiB0aGUgc2NyaXB0IGlzIGxvYWRlZC5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQgdG8gbG9hZC5cbiAgICogQHBhcmFtIGNhbGxlciBOYW1lIG9mIHRoZSBjYWxsaW5nIHNjcmlwdCAtIGl0IGNhbiBiZSBmb3IgZXhhbXBsZTogbmFtZSBvZiB0aGUgYnVuZGxlLCBjaHVuayBvciBjb250YWluZXIuXG4gICAqLyBmdW5jdGlvbiBsb2FkU2NyaXB0KF8wLCBfMSwgXzIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihzY3JpcHRJZCwgY2FsbGVyLCByZWYsIHJlZmVyZW5jZVVybCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgd2VicGFja0NvbnRleHQgPSByZWYgPT09IHZvaWQgMCA/ICgwLCBfZ2V0V2VicGFja0NvbnRleHQuZ2V0V2VicGFja0NvbnRleHQpKCkgOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1bmlxdWVJZCA9IF9TY3JpcHQuU2NyaXB0LmdldFNjcmlwdFVuaXF1ZUlkKHNjcmlwdElkLCBjYWxsZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNQcmVmZXRjaCA9IHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXS5pc1ByZWZldGNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJlZmV0Y2ggaXMgbm90IGV4ZWN1dGUgdGhlIHNjcmlwdCBzbyB3ZSBuZWVkIHRvIHJ1biBsb2FkU2NyaXB0IGlmIHByb21pc2UgaXMgZm9yIHByZWZldGNoXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNQcmVmZXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFByb2Nlc3MgPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2NyaXB0ID0geWllbGQgdGhpcy5yZXNvbHZlU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIHdlYnBhY2tDb250ZXh0LCByZWZlcmVuY2VVcmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnbG9hZGluZycsIHNjcmlwdC50b09iamVjdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5sb2FkU2NyaXB0V2l0aFJldHJ5KHNjcmlwdElkLCBzY3JpcHQubG9jYXRvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnbG9hZGVkJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnVwZGF0ZUNhY2hlKHNjcmlwdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBlcnJvci5jb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCAnW1NjcmlwdE1hbmFnZXJdIEZhaWxlZCB0byBsb2FkIHNjcmlwdDonLCBjb2RlID8gYFske2NvZGV9XWAgOiAnJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2hvdWxkIGRlbGV0ZSBzY3JpcHQgcHJvbWlzZSBldmVuIHNjcmlwdCBmYWlsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0gPSBsb2FkUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2FkU2NyaXB0V2l0aFJldHJ5XCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIExvYWRzIGEgc2NyaXB0IHdpdGggcmV0cnkgbG9naWMuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb24gYXR0ZW1wdHMgdG8gbG9hZCBhIHNjcmlwdCB1c2luZyB0aGUgbmF0aXZlU2NyaXB0TWFuYWdlci5cbiAgICogSWYgdGhlIGluaXRpYWwgYXR0ZW1wdCBmYWlscywgaXQgcmV0cmllcyB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lc1xuICAgKiB3aXRoIGFuIG9wdGlvbmFsIGRlbGF5IGJldHdlZW4gcmV0cmllcy5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNjcmlwdElkIC0gVGhlIElEIG9mIHRoZSBzY3JpcHQgdG8gbG9hZC5cbiAgICogQHBhcmFtIHtOb3JtYWxpemVkU2NyaXB0TG9jYXRvcn0gbG9jYXRvciAtIEFuIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yIGNvbnRhaW5pbmcgcmV0cnkgY29uZmlndXJhdGlvbi5cbiAgICogQHBhcmFtIHtudW1iZXJ9IFtsb2NhdG9yLnJldHJ5PTBdIC0gVGhlIG51bWJlciBvZiByZXRyeSBhdHRlbXB0cy5cbiAgICogQHBhcmFtIHtudW1iZXJ9IFtsb2NhdG9yLnJldHJ5RGVsYXk9MF0gLSBUaGUgZGVsYXkgaW4gbWlsbGlzZWNvbmRzIGJldHdlZW4gcmV0cmllcy5cbiAgICogQHRocm93cyB7RXJyb3J9IFRocm93cyBhbiBlcnJvciBpZiBhbGwgcmV0cnkgYXR0ZW1wdHMgZmFpbC5cbiAgICovIGZ1bmN0aW9uIGxvYWRTY3JpcHRXaXRoUmV0cnkoc2NyaXB0SWQsIGxvY2F0b3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9sb2NhdG9yX3JldHJ5ID0gbG9jYXRvci5yZXRyeSwgcmV0cnkgPSBfbG9jYXRvcl9yZXRyeSA9PT0gdm9pZCAwID8gMCA6IF9sb2NhdG9yX3JldHJ5LCBfbG9jYXRvcl9yZXRyeURlbGF5ID0gbG9jYXRvci5yZXRyeURlbGF5LCByZXRyeURlbGF5ID0gX2xvY2F0b3JfcmV0cnlEZWxheSA9PT0gdm9pZCAwID8gMCA6IF9sb2NhdG9yX3JldHJ5RGVsYXk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhdHRlbXB0cyA9IHJldHJ5ICsgMTsgLy8gSW5jbHVkZSB0aGUgaW5pdGlhbCBhdHRlbXB0XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlKGF0dGVtcHRzID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMubmF0aXZlU2NyaXB0TWFuYWdlci5sb2FkU2NyaXB0KHNjcmlwdElkLCBsb2NhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47IC8vIFN1Y2Nlc3NmdWxseSBsb2FkZWQgdGhlIHNjcmlwdCwgZXhpdCB0aGUgbG9vcFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRlbXB0cy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZXJyb3IuY29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ZW1wdHMgPiAwICYmIExPQURJTkdfRVJST1JfQ09ERVMuaW5jbHVkZXMoY29kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJldHJ5RGVsYXkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBuZXcgUHJvbWlzZSgocmVzb2x2ZSk9PnNldFRpbWVvdXQocmVzb2x2ZSwgcmV0cnlEZWxheSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7IC8vIE5vIG1vcmUgcmV0cmllcywgdGhyb3cgdGhlIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInByZWZldGNoU2NyaXB0XCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIFJlc29sdmVzIGdpdmVuIHNjcmlwdCdzIGxvY2F0aW9uIGFuZCBkb3dubG9hZHMgaXQgd2l0aG91dCBleGVjdXRpbmcuXG4gICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGF3YWl0ZWQgdG8gZGV0ZWN0IGlmIHRoZSBzY3JpcHQgd2FzIGRvd25sb2FkZWQgYW5kIGZvciBlcnJvciBoYW5kbGluZy5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbigncHJlZmV0Y2hpbmcnLCAoc2NyaXB0KSA9PiB7IH0pYCB0byBsaXN0ZW4gZm9yIHdoZW5cbiAgICogdGhlIHNjcmlwdCdzIHByZWZldGNoIGJlaW5ncy5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQgdG8gcHJlZmV0Y2guXG4gICAqIEBwYXJhbSBjYWxsZXIgTmFtZSBvZiB0aGUgY2FsbGluZyBzY3JpcHQgLSBpdCBjYW4gYmUgZm9yIGV4YW1wbGU6IG5hbWUgb2YgdGhlIGJ1bmRsZSwgY2h1bmsgb3IgY29udGFpbmVyLlxuICAgKi8gZnVuY3Rpb24gcHJlZmV0Y2hTY3JpcHQoXzAsIF8xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooc2NyaXB0SWQsIGNhbGxlciwgcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB3ZWJwYWNrQ29udGV4dCA9IHJlZiA9PT0gdm9pZCAwID8gKDAsIF9nZXRXZWJwYWNrQ29udGV4dC5nZXRXZWJwYWNrQ29udGV4dCkoKSA6IHJlZjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVuaXF1ZUlkID0gX1NjcmlwdC5TY3JpcHQuZ2V0U2NyaXB0VW5pcXVlSWQoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRQcm9jZXNzID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdCA9IHlpZWxkIHRoaXMucmVzb2x2ZVNjcmlwdChzY3JpcHRJZCwgY2FsbGVyLCB3ZWJwYWNrQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdwcmVmZXRjaGluZycsIHNjcmlwdC50b09iamVjdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5uYXRpdmVTY3JpcHRNYW5hZ2VyLnByZWZldGNoU2NyaXB0KHNjcmlwdElkLCBzY3JpcHQubG9jYXRvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMudXBkYXRlQ2FjaGUoc2NyaXB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29kZSA9IGVycm9yLmNvZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdbU2NyaXB0TWFuYWdlcl0gRmFpbGVkIHRvIHByZWZldGNoIHNjcmlwdDonLCBjb2RlID8gYFske2NvZGV9XWAgOiAnJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2hvdWxkIGRlbGV0ZSBzY3JpcHQgcHJvbWlzZSBldmVuIHNjcmlwdCBmYWlsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0gPSBsb2FkUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0uaXNQcmVmZXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF07XG4gICAgICAgICAgICAgICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImludmFsaWRhdGVTY3JpcHRzXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIENsZWFycyB0aGUgY2FjaGUgKGlmIGNvbmZpZ3VyZWQgaW4ge0BsaW5rIFNjcmlwdE1hbmFnZXIuc2V0U3RvcmFnZX0pIGFuZCByZW1vdmVzIGRvd25sb2FkZWRcbiAgICogZmlsZXMgZm9yIGdpdmVuIHNjcmlwdHMgZnJvbSB0aGUgZmlsZXN5c3RlbS4gVGhpcyBmdW5jdGlvbiBjYW4gYmUgYXdhaXRlZCB0byBkZXRlY3QgaWYgdGhlXG4gICAqIHNjcmlwdHMgd2VyZSBpbnZhbGlkYXRlZCBhbmQgZm9yIGVycm9yIGhhbmRsaW5nLlxuICAgKlxuICAgKiBVc2UgYFNjcmlwdE1hbmFnZXIuc2hhcmVkLm9uKCdpbnZhbGlkYXRlZCcsIChzY3JpcHRJZHMpID0+IHsgfSlgIHRvIGxpc3RlbiBmb3Igd2hlblxuICAgKiB0aGUgaW52YWxpZGF0aW9uIGNvbXBsZXRlcy5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkcyBBcnJheSBvZiBzY3JpcHQgaWRzIHRvIGNsZWFyIGZyb20gY2FjaGUgYW5kIHJlbW92ZSBmcm9tIGZpbGVzeXN0ZW0uXG4gICAqIEByZXR1cm5zIEFycmF5IG9mIHNjcmlwdCBpZHMgdGhhdCB3ZXJlIGludmFsaWRhdGVkLlxuICAgKi8gZnVuY3Rpb24gaW52YWxpZGF0ZVNjcmlwdHMoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzY3JpcHRJZHMgPSByZWYgPT09IHZvaWQgMCA/IFtdIDogcmVmO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5pbml0Q2FjaGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHMgPSBzY3JpcHRJZHMubGVuZ3RoID8gc2NyaXB0SWRzIDogT2JqZWN0LmtleXModGhpcy5jYWNoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZHMuZm9yRWFjaCgoc2NyaXB0SWQpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuY2FjaGVbc2NyaXB0SWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNjcmlwdHNQcm9taXNlc1tzY3JpcHRJZF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2F2ZUNhY2hlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLm5hdGl2ZVNjcmlwdE1hbmFnZXIuaW52YWxpZGF0ZVNjcmlwdHMoc2NyaXB0SWRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnaW52YWxpZGF0ZWQnLCBpZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlkcztcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZXJyb3IuY29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdbU2NyaXB0TWFuYWdlcl0gRmFpbGVkIHRvIGludmFsaWRhdGUgc2NyaXB0czonLCBjb2RlID8gYFske2NvZGV9XWAgOiAnJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogRXZhbHVhdGVzIGEgc2NyaXB0IHN5bmNocm9ub3VzbHkuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb24gc2VuZHMgdGhlIHNjcmlwdCBzb3VyY2UgYW5kIGl0cyBVUkwgdG8gdGhlIG5hdGl2ZSBzY3JpcHQgbWFuYWdlciBmb3IgZXZhbHVhdGlvbi5cbiAgICogSXQgaXMgZnVuY3Rpb25hbGx5IGlkZW50aWNhbCB0byBgZ2xvYmFsRXZhbFdpdGhTb3VyY2VVcmxgLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0U291cmNlIFRoZSBzb3VyY2UgY29kZSBvZiB0aGUgc2NyaXB0IHRvIGV2YWx1YXRlLlxuICAgKiBAcGFyYW0gc2NyaXB0U291cmNlVXJsIFRoZSBVUkwgb2YgdGhlIHNjcmlwdCBzb3VyY2UsIHVzZWQgZm9yIGRlYnVnZ2luZyBwdXJwb3Nlcy5cbiAgICovIGtleTogXCJ1bnN0YWJsZV9ldmFsdWF0ZVNjcmlwdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVuc3RhYmxlX2V2YWx1YXRlU2NyaXB0KHNjcmlwdFNvdXJjZSwgc2NyaXB0U291cmNlVXJsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVTY3JpcHRNYW5hZ2VyLnVuc3RhYmxlX2V2YWx1YXRlU2NyaXB0KHNjcmlwdFNvdXJjZSwgc2NyaXB0U291cmNlVXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImluaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgICAgIGlmICghX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIgPSBuZXcgU2NyaXB0TWFuYWdlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInNoYXJlZFwiLFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gU2NyaXB0TWFuYWdlcjtcbn0gLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2NyaXB0TWFuYWdlci5qcy5tYXBcbihfZXZlbnRzLmRlZmF1bHQpO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9mZWRlcmF0ZWQuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9mZWRlcmF0ZWQuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJGZWRlcmF0ZWRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBGZWRlcmF0ZWQ7XG4gICAgfVxufSkpO1xudmFyIF9hc3luY190b19nZW5lcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fYXN5bmNfdG9fZ2VuZXJhdG9yICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiKTtcbnZhciBfU2NyaXB0TWFuYWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vU2NyaXB0TWFuYWdlci5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL1NjcmlwdE1hbmFnZXIuanNcIik7XG52YXIgRmVkZXJhdGVkO1xuKGZ1bmN0aW9uKF9GZWRlcmF0ZWQpIHtcbiAgICAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICpcbiAgICogUmVzb2x2ZXMgVVJMIHRvIGEgY29udGFpbmVyIG9yIGEgY2h1bmsgd2hlbiB1c2luZyBNb2R1bGUgRmVkZXJhdGlvbixcbiAgICogYmFzZWQgb24gZ2l2ZW4gYHNjcmlwdElkYCBhbmQgYGNhbGxlcmAuXG4gICAqLyAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICpcbiAgICogQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB7QGxpbmsgY3JlYXRlVVJMUmVzb2x2ZXJ9IGZvciBNb2R1bGUgRmVkZXJhdGlvbi5cbiAgICogQWxsb3dzIHRvIGNvbmZpZ3VyZSBob3cgY3JlYXRlZCB7QGxpbmsgVVJMUmVzb2x2ZXJ9IHdpbGwgYmVoYXZlLlxuICAgKi8gLyoqXG4gICAqIEBkZXByZWNhdGVkXG4gICAqXG4gICAqIENyZWF0ZXMgVVJMIHJlc29sdmVyIGZvciBNb2R1bGUgRmVkZXJhdGlvbiBmcm9tIHByb3ZpZGVkIGNvbmZpZy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHNcbiAgICogaW1wb3J0IHsgU2NyaXB0TWFuYWdlciwgU2NyaXB0LCBGZWRlcmF0ZWQgfSBmcm9tICdAY2FsbHN0YWNrL3JlcGFjay9jbGllbnQnO1xuICAgKlxuICAgKiBjb25zdCByZXNvbHZlVVJMID0gRmVkZXJhdGVkLmNyZWF0ZVVSTFJlc29sdmVyKHtcbiAgICogICBjb250YWluZXJzOiB7XG4gICAqICAgICBhcHAxOiAnaHR0cDovL2xvY2FsaG9zdDo5MDAxL1tuYW1lXVtleHRdJyxcbiAgICogICAgIGFwcDI6ICdodHRwOi8vbG9jYWxob3N0OjkwMDIvW25hbWVdLmNvbnRhaW5lci5qcycsXG4gICAqICAgfSxcbiAgICogICBjaHVua3M6IHtcbiAgICogICAgIGFwcDI6ICdodHRwOi8vbG9jYWxob3N0OjkwMDIvY2h1bmtzL1tuYW1lXVtleHRdJyxcbiAgICogICB9LFxuICAgKiB9KTtcbiAgICpcbiAgICogU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoYXN5bmMgKHNjcmlwdElkLCBjYWxsZXIpID0+IHtcbiAgICogICBsZXQgdXJsO1xuICAgKiAgIGlmIChjYWxsZXIgPT09ICdtYWluJykge1xuICAgKiAgICAgdXJsID0gX19ERVZfX1xuICAgKiAgICAgICA/IFNjcmlwdC5nZXREZXZTZXJ2ZXJVUkwoc2NyaXB0SWQpXG4gICAqICAgICAgIDogU2NyaXB0LmdldFJlbW90ZVVSTChgaHR0cDovL2xvY2FsaG9zdDo5MDAwLyR7c2NyaXB0SWR9YCk7XG4gICAqICAgfSBlbHNlIHtcbiAgICogICAgIHVybCA9IHJlc29sdmVVUkwoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAqICAgfVxuICAgKlxuICAgKiAgIGlmICghdXJsKSB7XG4gICAqICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgKiAgIH1cbiAgICpcbiAgICogICByZXR1cm4ge1xuICAgKiAgICAgdXJsLFxuICAgKiAgICAgcXVlcnk6IHtcbiAgICogICAgICAgcGxhdGZvcm06IFBsYXRmb3JtLk9TLFxuICAgKiAgICAgfSxcbiAgICogICB9O1xuICAgKiB9KTtcbiAgICogYGBgXG4gICAqXG4gICAqIGBjcmVhdGVVUkxSZXNvbHZlcmAgaXMgYSBhYnN0cmFjdGlvbiBvdmVyIHtAbGluayBTY3JpcHQuZ2V0UmVtb3RlVVJMfSxcbiAgICogZm9yIGV4YW1wbGU6XG4gICAqIGBgYHRzXG4gICAqIGltcG9ydCB7IFNjcmlwdE1hbmFnZXIsIEZlZGVyYXRlZCB9IGZyb20gJ0BjYWxsc3RhY2svcmVwYWNrL2NsaWVudCc7XG4gICAqXG4gICAqIFNjcmlwdE1hbmFnZXIuc2hhcmVkLmFkZFJlc29sdmVyKChzY3JpcHRJZCwgY2FsbGVyKSA9PiB7XG4gICAqICAgY29uc3QgcmVzb2x2ZVVSTCA9IEZlZGVyYXRlZC5jcmVhdGVVUkxSZXNvbHZlcih7XG4gICAqICAgICBjb250YWluZXJzOiB7XG4gICAqICAgICAgIGFwcDE6ICdodHRwOi8vbG9jYWxob3N0OjkwMDAvW25hbWVdW2V4dF0nLFxuICAgKiAgICAgfSxcbiAgICogICB9KTtcbiAgICpcbiAgICogICByZXR1cm4ge1xuICAgKiAgICAgdXJsOiByZXNvbHZlVVJMKHNjcmlwdElkLCBjYWxsZXIpO1xuICAgKiAgIH07XG4gICAqIH0pO1xuICAgKiBgYGBcbiAgICogaXMgZXF1aXZhbGVudCB0bzpcbiAgICogYGBgdHNcbiAgICogaW1wb3J0IHsgU2NyaXB0TWFuYWdlciwgU2NyaXB0IH0gZnJvbSAnQGNhbGxzdGFjay9yZXBhY2svY2xpZW50JztcbiAgICpcbiAgICogU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoYXN5bmMgKHNjcmlwdElkLCBjYWxsZXIpID0+IHtcbiAgICogICBpZiAoc2NyaXB0SWQgPT09ICdhcHAxJykge1xuICAgKiAgICAgcmV0dXJuIHtcbiAgICogICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo5MDAwL2FwcDEuY29udGFpbmVyLmJ1bmRsZScsXG4gICAqICAgICB9O1xuICAgKiAgIH1cbiAgICpcbiAgICogICBpZiAoY2FsbGVyID09PSAnYXBwMScpIHtcbiAgICogICAgIHJldHVybiB7XG4gICAqICAgICAgIHVybDogU2NyaXB0LmdldFJlbW90ZVVSTChgaHR0cDovL2xvY2FsaG9zdDo5MDAwLyR7c2NyaXB0SWR9YCksXG4gICAqICAgICB9O1xuICAgKiAgIH1cbiAgICogfSk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gY29uZmlnIENvbmZpZ3VyYXRpb24gZm9yIHRoZSByZXNvbHZlci5cbiAgICogQHBhcmFtIGNvbnRhaW5lckV4dCBFeHRlbnNpb24gb2YgY29udGFpbmVyIGJ1bmRsZXMuIERlZmF1bHRzIHRvIGAuY29udGFpbmVyLmJ1bmRsZWAuXG4gICAqIEByZXR1cm5zIEEgcmVzb2x2ZXIgZnVuY3Rpb24gd2hpY2ggd2lsbCB0cnkgdG8gcmVzb2x2ZSBVUkwgYmFzZWQgb24gZ2l2ZW4gYHNjcmlwdElkYCBhbmQgYGNhbGxlcmAuXG4gICAqLyBmdW5jdGlvbiBjcmVhdGVVUkxSZXNvbHZlcihjb25maWcsIHJlZikge1xuICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIHJlc29sdmVyc1trZXldID0gKHNjcmlwdElkLCBjYWxsZXIpPT57XG4gICAgICAgICAgICAgICAgaWYgKHNjcmlwdElkID09PSBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGNvbmZpZy5jb250YWluZXJzW2tleV0ucmVwbGFjZSgvXFxbbmFtZVxcXS9nLCBzY3JpcHRJZCkucmVwbGFjZSgvXFxbZXh0XFxdL2csIGNvbnRhaW5lckV4dCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjYWxsZXIgPT09IGtleSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2NvbmZpZ19jaHVua3M7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwxID0gKCgoX2NvbmZpZ19jaHVua3MgPSBjb25maWcuY2h1bmtzKSA9PT0gbnVsbCB8fCBfY29uZmlnX2NodW5rcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NvbmZpZ19jaHVua3Nba2V5XSkgPz8gY29uZmlnLmNvbnRhaW5lcnNba2V5XSkucmVwbGFjZSgvXFxbbmFtZVxcXS9nLCBzY3JpcHRJZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cmwxLmluY2x1ZGVzKCdbZXh0XScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHdlYnBhY2tDb250ZXh0KT0+d2VicGFja0NvbnRleHQudSh1cmwxLnJlcGxhY2UoL1xcW2V4dFxcXS9nLCAnJykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmwxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGNvbnRhaW5lckV4dCA9IHJlZiA9PT0gdm9pZCAwID8gJy5jb250YWluZXIuYnVuZGxlJyA6IHJlZjtcbiAgICAgICAgdmFyIHJlc29sdmVycyA9IHt9O1xuICAgICAgICBmb3IodmFyIGtleSBpbiBjb25maWcuY29udGFpbmVycylfbG9vcChrZXkpO1xuICAgICAgICByZXR1cm4gKHNjcmlwdElkLCBjYWxsZXIpPT57XG4gICAgICAgICAgICB2YXIgcmVzb2x2ZXIgPSAoY2FsbGVyID8gcmVzb2x2ZXJzW2NhbGxlcl0gOiB1bmRlZmluZWQpID8/IHJlc29sdmVyc1tzY3JpcHRJZF07XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZXIoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAgICAgIH07XG4gICAgfVxuICAgIF9GZWRlcmF0ZWQuY3JlYXRlVVJMUmVzb2x2ZXIgPSBjcmVhdGVVUkxSZXNvbHZlcjtcbiAgICAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICpcbiAgICogRHluYW1pY2FsbHkgaW1wb3J0cyBtb2R1bGUgZnJvbSBhIE1vZHVsZSBGZWRlcmF0aW9uIGNvbnRhaW5lci4gU2ltaWxhciB0byBgaW1wb3J0KCdmaWxlJylgLCBidXRcbiAgICogc3BlY2lmaWMgdG8gTW9kdWxlIEZlZGVyYXRpb24uIENhbGxpbmcgYGltcG9ydE1vZHVsZWAgd2lsbCBjcmVhdGUgYW4gYXN5bmMgYm91bmRhcnkuXG4gICAqXG4gICAqIENvbnRhaW5lciB3aWxsIGJlIGV2YWx1YXRlZCBvbmx5IG9uY2UuIElmIHlvdSB1c2UgYGltcG9ydE1vZHVsZWAgZm9yIHRoZSBzYW1lIGNvbnRhaW5lciB0d2ljZSxcbiAgICogdGhlIGNvbnRhaW5lciB3aWxsIGJlIGxvYWRlZCBhbmQgZXZhbHVhdGVkIG9ubHkgb24gdGhlIGZpcnN0IGltcG9ydC5cbiAgICpcbiAgICogVW5kZXIgdGhlIGhvb2QsIGBpbXBvcnRNb2R1bGVgIHdpbGwgY2FsbCBgU2NyaXB0TWFuYWdlci5zaGFyZWQubG9hZFNjcmlwdChjb250YWluZXJOYW1lKWAuXG4gICAqIFRoaXMgbWVhbnMsIGEgcmVzb2x2ZXIgbXVzdCBiZSBhZGRlZCB3aXRoIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlciguLi4pYCBiZWZvcmVoYW5kIGFuZCBwcm92aWRlZCBwcm9wZXJcbiAgICogcmVzb2x1dGlvbiBsb2dpYyB0byByZXNvbHZlIFVSTCBiYXNlZCBvbiB0aGUgYGNvbnRhaW5lck5hbWVgLlxuICAgKlxuICAgKiBAcGFyYW0gY29udGFpbmVyTmFtZSBOYW1lIG9mIHRoZSBjb250YWluZXIgLSBzaG91bGQgYmUgdGhlIHNhbWUgbmFtZSBwcm92aWRlZCB0b1xuICAgKiBgd2VicGFjay5jb250YWluZXIuTW9kdWxlRmVkZXJhdGlvblBsdWdpbmAgaW4gYGxpYnJhcnkubmFtZWAuXG4gICAqIEBwYXJhbSBtb2R1bGUgRnVsbCBuYW1lIHdpdGggZXh0ZW5zaW9uIG9mIHRoZSBtb2R1bGUgdG8gaW1wb3J0IGZyb20gdGhlIGNvbnRhaW5lciAtIG9ubHkgbW9kdWxlc1xuICAgKiBleHBvc2VkIGluIGBleHBvc2VzYCBpbiBgd2VicGFjay5jb250YWluZXIuTW9kdWxlRmVkZXJhdGlvblBsdWdpbmAgY2FuIGJlIHVzZWQuXG4gICAqIEBwYXJhbSBzY29wZSBPcHRpb25hbCwgc2NvcGUgZm9yIHNoYXJpbmcgbW9kdWxlcyBiZXR3ZWVuIGNvbnRhaW5lcnMuIERlZmF1bHRzIHRvIGAnZGVmYXVsdCdgLlxuICAgKiBAcmV0dXJucyBFeHBvcnRzIG9mIGdpdmVuIGBtb2R1bGVgIGZyb20gZ2l2ZW4gY29udGFpbmVyLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG4gICAqIGltcG9ydCB7IEZlZGVyYXRlZCB9IGZyb20gJ0BjYWxsc3RhY2svcmVwYWNrL2NsaWVudCc7XG4gICAqXG4gICAqIGNvbnN0IEJ1dHRvbiA9IFJlYWN0LmxhenkoKCkgPT4gRmVkZXJhdGVkLmltcG9ydE1vZHVsZSgnbXktY29tcG9uZW50cycsICcuL0J1dHRvbi5qcycpKTtcbiAgICpcbiAgICogY29uc3QgbXlVdGlsID0gYXdhaXQgRmVkZXJhdGVkLmltcG9ydE1vZHVsZSgnbXktbGliJywgJy4vbXlVdGlsLmpzJyk7XG4gICAqIGBgYFxuICAgKi8gZnVuY3Rpb24gaW1wb3J0TW9kdWxlKGNvbnRhaW5lck5hbWUsIG1vZHVsZSwgcmVmKSB7XG4gICAgICAgIHZhciBzY29wZSA9IHJlZiA9PT0gdm9pZCAwID8gJ2RlZmF1bHQnIDogcmVmO1xuICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgIHZhciBfX3dlYnBhY2tfc2hhcmVfc2NvcGVzX19fc2NvcGU7XG4gICAgICAgICAgICBpZiAoISgoX193ZWJwYWNrX3NoYXJlX3Njb3Blc19fX3Njb3BlID0gX193ZWJwYWNrX3JlcXVpcmVfXy5TW3Njb3BlXSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3NoYXJlX3Njb3Blc19fX3Njb3BlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfc2hhcmVfc2NvcGVzX19fc2NvcGUuX19pc0luaXRpYWxpemVkKSkge1xuICAgICAgICAgICAgICAgIC8vIEluaXRpYWxpemVzIHRoZSBzaGFyZSBzY29wZS5cbiAgICAgICAgICAgICAgICAvLyBUaGlzIGZpbGxzIGl0IHdpdGgga25vd24gcHJvdmlkZWQgbW9kdWxlcyBmcm9tIHRoaXMgYnVpbGQgYW5kIGFsbCByZW1vdGVzLlxuICAgICAgICAgICAgICAgIHlpZWxkIF9fd2VicGFja19yZXF1aXJlX18uSShzY29wZSk7XG4gICAgICAgICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5TW3Njb3BlXS5fX2lzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRG8gbm90IHVzZSBgY29uc3QgY29udGFpbmVyID0gc2VsZltjb250YWluZXJOYW1lXTtgIGhlcmUuIE9uY2UgY29udGFpbmVyIGlzIGxvYWRlZFxuICAgICAgICAgICAgLy8gYGNvbnRhaW5lcmAgcmVmZXJlbmNlIGlzIG5vdCB1cGRhdGVkLCBzbyBgY29udGFpbmVyLl9faXNJbml0aWFsaXplZGBcbiAgICAgICAgICAgIC8vIHdpbGwgY3Jhc2ggdGhlIGFwcGxpY2F0aW9uLCBiZWNhdXNlIG9mIHJlYWRpbmcgcHJvcGVydHkgZnJvbSBgdW5kZWZpbmVkYC5cbiAgICAgICAgICAgIGlmICghc2VsZltjb250YWluZXJOYW1lXSkge1xuICAgICAgICAgICAgICAgIC8vIERvd25sb2FkIGFuZCBleGVjdXRlIGNvbnRhaW5lclxuICAgICAgICAgICAgICAgIHlpZWxkIF9TY3JpcHRNYW5hZ2VyLlNjcmlwdE1hbmFnZXIuc2hhcmVkLmxvYWRTY3JpcHQoY29udGFpbmVyTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY29udGFpbmVyID0gc2VsZltjb250YWluZXJOYW1lXTtcbiAgICAgICAgICAgIGlmICghY29udGFpbmVyLl9faXNJbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5fX2lzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGNvbnRhaW5lciwgaXQgbWF5IHByb3ZpZGUgc2hhcmVkIG1vZHVsZXNcbiAgICAgICAgICAgICAgICB5aWVsZCBjb250YWluZXIuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLlNbc2NvcGVdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmYWN0b3J5ID0geWllbGQgY29udGFpbmVyLmdldChtb2R1bGUpO1xuICAgICAgICAgICAgdmFyIGV4cG9ydHMxID0gZmFjdG9yeSgpO1xuICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMxO1xuICAgICAgICB9KSgpO1xuICAgIH1cbiAgICBfRmVkZXJhdGVkLmltcG9ydE1vZHVsZSA9IGltcG9ydE1vZHVsZTtcbn0pKEZlZGVyYXRlZCB8fCAoRmVkZXJhdGVkID0ge30pKTsgLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmVkZXJhdGVkLmpzLm1hcFxuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9nZXRXZWJwYWNrQ29udGV4dC5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvZ2V0V2VicGFja0NvbnRleHQuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG4vKipcbiAqIEdldCBXZWJwYWNrIHJ1bnRpbWUgY29udGV4dCBmb3JtIGN1cnJlbnQgSmF2YVNjcmlwdCBzY29wZS5cbiAqXG4gKiBfX1lvdSBsaWtlbHkgZG9uJ3QgbmVlZCB0byB1c2UgaXQuX19cbiAqLyBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImdldFdlYnBhY2tDb250ZXh0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gZ2V0V2VicGFja0NvbnRleHQ7XG4gICAgfVxufSkpO1xuZnVuY3Rpb24gZ2V0V2VicGFja0NvbnRleHQoKSB7XG4gICAgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX187XG59IC8vIyBzb3VyY2VNYXBwaW5nVVJMPWdldFdlYnBhY2tDb250ZXh0LmpzLm1hcFxuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9pbmRleC5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvaW5kZXguanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkZlZGVyYXRlZFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9mZWRlcmF0ZWQuRmVkZXJhdGVkO1xuICAgIH1cbn0pKTtcbnZhciBfZXhwb3J0X3N0YXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fZXhwb3J0X3N0YXIgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19leHBvcnRfc3Rhci5janNcIik7XG5fZXhwb3J0X3N0YXIuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL1NjcmlwdE1hbmFnZXIuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHRNYW5hZ2VyLmpzXCIpLCBleHBvcnRzKTtcbl9leHBvcnRfc3Rhci5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vU2NyaXB0LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0LmpzXCIpLCBleHBvcnRzKTtcbl9leHBvcnRfc3Rhci5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdHlwZXMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci90eXBlcy5qc1wiKSwgZXhwb3J0cyk7XG5fZXhwb3J0X3N0YXIuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL2dldFdlYnBhY2tDb250ZXh0LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvZ2V0V2VicGFja0NvbnRleHQuanNcIiksIGV4cG9ydHMpO1xudmFyIF9mZWRlcmF0ZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL2ZlZGVyYXRlZC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2ZlZGVyYXRlZC5qc1wiKTtcbiAvLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvdHlwZXMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL3R5cGVzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG4gLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHlwZXMuanMubWFwXG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZGVmYXVsdFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9Db3JlUGx1Z2luLmRlZmF1bHQ7XG4gICAgfVxufSkpO1xudmFyIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiKTtcbnZhciBfQ29yZVBsdWdpbiA9IC8qI19fUFVSRV9fKi8gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0Ll8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vZGlzdC9tb2R1bGVzL0ZlZGVyYXRpb25SdW50aW1lUGx1Z2lucy9Db3JlUGx1Z2luLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL0ZlZGVyYXRpb25SdW50aW1lUGx1Z2lucy9Db3JlUGx1Z2luLmpzXCIpKTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZGVmYXVsdFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9SZXNvbHZlclBsdWdpbi5kZWZhdWx0O1xuICAgIH1cbn0pKTtcbnZhciBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janNcIik7XG52YXIgX1Jlc29sdmVyUGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL1Jlc29sdmVyUGx1Z2luLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL0ZlZGVyYXRpb25SdW50aW1lUGx1Z2lucy9SZXNvbHZlclBsdWdpbi5qc1wiKSk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9lcnJvci1jb2Rlcy9kaXN0L2luZGV4LmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9lcnJvci1jb2Rlcy9kaXN0L2luZGV4LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIFJVTlRJTUVfMDAxID0gJ1JVTlRJTUUtMDAxJztcbnZhciBSVU5USU1FXzAwMiA9ICdSVU5USU1FLTAwMic7XG52YXIgUlVOVElNRV8wMDMgPSAnUlVOVElNRS0wMDMnO1xudmFyIFJVTlRJTUVfMDA0ID0gJ1JVTlRJTUUtMDA0JztcbnZhciBSVU5USU1FXzAwNSA9ICdSVU5USU1FLTAwNSc7XG52YXIgUlVOVElNRV8wMDYgPSAnUlVOVElNRS0wMDYnO1xudmFyIFJVTlRJTUVfMDA3ID0gJ1JVTlRJTUUtMDA3JztcbnZhciBSVU5USU1FXzAwOCA9ICdSVU5USU1FLTAwOCc7XG52YXIgVFlQRV8wMDEgPSAnVFlQRS0wMDEnO1xudmFyIEJVSUxEXzAwMSA9ICdCVUlMRC0wMDEnO1xudmFyIGdldERvY3NVcmwgPSAoZXJyb3JDb2RlKT0+e1xuICAgIHZhciB0eXBlID0gZXJyb3JDb2RlLnNwbGl0KCctJylbMF0udG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gYGh0dHBzOi8vbW9kdWxlLWZlZGVyYXRpb24uaW8vZ3VpZGUvdHJvdWJsZXNob290aW5nLyR7dHlwZX0vJHtlcnJvckNvZGV9YDtcbn07XG52YXIgZ2V0U2hvcnRFcnJvck1zZyA9IChlcnJvckNvZGUsIGVycm9yRGVzY01hcCwgYXJncywgb3JpZ2luYWxFcnJvck1zZyk9PntcbiAgICB2YXIgbXNnID0gW1xuICAgICAgICBgJHtbXG4gICAgICAgICAgICBlcnJvckRlc2NNYXBbZXJyb3JDb2RlXVxuICAgICAgICBdfSAjJHtlcnJvckNvZGV9YFxuICAgIF07XG4gICAgYXJncyAmJiBtc2cucHVzaChgYXJnczogJHtKU09OLnN0cmluZ2lmeShhcmdzKX1gKTtcbiAgICBtc2cucHVzaChnZXREb2NzVXJsKGVycm9yQ29kZSkpO1xuICAgIG9yaWdpbmFsRXJyb3JNc2cgJiYgbXNnLnB1c2goYE9yaWdpbmFsIEVycm9yIE1lc3NhZ2U6XFxuICR7b3JpZ2luYWxFcnJvck1zZ31gKTtcbiAgICByZXR1cm4gbXNnLmpvaW4oJ1xcbicpO1xufTtcbmZ1bmN0aW9uIF9leHRlbmRzKCkge1xuICAgIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0KSB7XG4gICAgICAgIGZvcih2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGZvcih2YXIga2V5IGluIHNvdXJjZSlpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH07XG4gICAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG52YXIgcnVudGltZURlc2NNYXAgPSB7XG4gICAgW1JVTlRJTUVfMDAxXTogJ0ZhaWxlZCB0byBnZXQgcmVtb3RlRW50cnkgZXhwb3J0cy4nLFxuICAgIFtSVU5USU1FXzAwMl06ICdUaGUgcmVtb3RlIGVudHJ5IGludGVyZmFjZSBkb2VzIG5vdCBjb250YWluIFwiaW5pdFwiJyxcbiAgICBbUlVOVElNRV8wMDNdOiAnRmFpbGVkIHRvIGdldCBtYW5pZmVzdC4nLFxuICAgIFtSVU5USU1FXzAwNF06ICdGYWlsZWQgdG8gbG9jYXRlIHJlbW90ZS4nLFxuICAgIFtSVU5USU1FXzAwNV06ICdJbnZhbGlkIGxvYWRTaGFyZVN5bmMgZnVuY3Rpb24gY2FsbCBmcm9tIGJ1bmRsZXIgcnVudGltZScsXG4gICAgW1JVTlRJTUVfMDA2XTogJ0ludmFsaWQgbG9hZFNoYXJlU3luYyBmdW5jdGlvbiBjYWxsIGZyb20gcnVudGltZScsXG4gICAgW1JVTlRJTUVfMDA3XTogJ0ZhaWxlZCB0byBnZXQgcmVtb3RlIHNuYXBzaG90LicsXG4gICAgW1JVTlRJTUVfMDA4XTogJ0ZhaWxlZCB0byBsb2FkIHNjcmlwdCByZXNvdXJjZXMuJ1xufTtcbnZhciB0eXBlRGVzY01hcCA9IHtcbiAgICBbVFlQRV8wMDFdOiAnRmFpbGVkIHRvIGdlbmVyYXRlIHR5cGUgZGVjbGFyYXRpb24uJ1xufTtcbnZhciBidWlsZERlc2NNYXAgPSB7XG4gICAgW0JVSUxEXzAwMV06ICdGYWlsZWQgdG8gZmluZCBleHBvc2UgbW9kdWxlLidcbn07XG52YXIgZXJyb3JEZXNjTWFwID0gX2V4dGVuZHMoe30sIHJ1bnRpbWVEZXNjTWFwLCB0eXBlRGVzY01hcCwgYnVpbGREZXNjTWFwKTtcbmV4cG9ydHMuQlVJTERfMDAxID0gQlVJTERfMDAxO1xuZXhwb3J0cy5SVU5USU1FXzAwMSA9IFJVTlRJTUVfMDAxO1xuZXhwb3J0cy5SVU5USU1FXzAwMiA9IFJVTlRJTUVfMDAyO1xuZXhwb3J0cy5SVU5USU1FXzAwMyA9IFJVTlRJTUVfMDAzO1xuZXhwb3J0cy5SVU5USU1FXzAwNCA9IFJVTlRJTUVfMDA0O1xuZXhwb3J0cy5SVU5USU1FXzAwNSA9IFJVTlRJTUVfMDA1O1xuZXhwb3J0cy5SVU5USU1FXzAwNiA9IFJVTlRJTUVfMDA2O1xuZXhwb3J0cy5SVU5USU1FXzAwNyA9IFJVTlRJTUVfMDA3O1xuZXhwb3J0cy5SVU5USU1FXzAwOCA9IFJVTlRJTUVfMDA4O1xuZXhwb3J0cy5UWVBFXzAwMSA9IFRZUEVfMDAxO1xuZXhwb3J0cy5idWlsZERlc2NNYXAgPSBidWlsZERlc2NNYXA7XG5leHBvcnRzLmVycm9yRGVzY01hcCA9IGVycm9yRGVzY01hcDtcbmV4cG9ydHMuZ2V0U2hvcnRFcnJvck1zZyA9IGdldFNob3J0RXJyb3JNc2c7XG5leHBvcnRzLnJ1bnRpbWVEZXNjTWFwID0gcnVudGltZURlc2NNYXA7XG5leHBvcnRzLnR5cGVEZXNjTWFwID0gdHlwZURlc2NNYXA7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lLWNvcmUvZGlzdC9pbmRleC5janMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L2luZGV4LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xudmFyIF9hc3luY190b19nZW5lcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fYXN5bmNfdG9fZ2VuZXJhdG9yICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiKTtcbnZhciBfY2FsbF9zdXBlciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jYWxsX3N1cGVyICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2FsbF9zdXBlci5janNcIik7XG52YXIgX2NsYXNzX2NhbGxfY2hlY2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY2xhc3NfY2FsbF9jaGVjayAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NsYXNzX2NhbGxfY2hlY2suY2pzXCIpO1xudmFyIF9jcmVhdGVfY2xhc3MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY3JlYXRlX2NsYXNzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY3JlYXRlX2NsYXNzLmNqc1wiKTtcbnZhciBfaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9faW5oZXJpdHMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbmhlcml0cy5janNcIik7XG52YXIgX3NsaWNlZF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19zbGljZWRfdG9fYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19jb25zdW1hYmxlX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2NvbnN1bWFibGVfYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqc1wiKTtcbnZhciBfdHlwZV9vZiA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL190eXBlX29mICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdHlwZV9vZi5janNcIik7XG52YXIgcG9seWZpbGxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9wb2x5ZmlsbHMuY2pzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L3BvbHlmaWxscy5janMuanNcIik7XG52YXIgc2RrID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQG1vZHVsZS1mZWRlcmF0aW9uL3NkayAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9zZGsvZGlzdC9pbmRleC5janMuanNcIik7XG52YXIgZXJyb3JDb2RlcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBtb2R1bGUtZmVkZXJhdGlvbi9lcnJvci1jb2RlcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9lcnJvci1jb2Rlcy9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbnZhciBMT0dfQ0FURUdPUlkgPSAnWyBGZWRlcmF0aW9uIFJ1bnRpbWUgXSc7XG4vLyBGSVhNRTogcHJlLWJ1bmRsZSA/XG52YXIgbG9nZ2VyID0gc2RrLmNyZWF0ZUxvZ2dlcihMT0dfQ0FURUdPUlkpO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXNcbmZ1bmN0aW9uIGFzc2VydChjb25kaXRpb24sIG1zZykge1xuICAgIGlmICghY29uZGl0aW9uKSB7XG4gICAgICAgIGVycm9yKG1zZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXJyb3IobXNnKSB7XG4gICAgaWYgKG1zZyBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIG1zZy5tZXNzYWdlID0gYCR7TE9HX0NBVEVHT1JZfTogJHttc2cubWVzc2FnZX1gO1xuICAgICAgICB0aHJvdyBtc2c7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihgJHtMT0dfQ0FURUdPUll9OiAke21zZ31gKTtcbn1cbmZ1bmN0aW9uIHdhcm4obXNnKSB7XG4gICAgaWYgKG1zZyBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIG1zZy5tZXNzYWdlID0gYCR7TE9HX0NBVEVHT1JZfTogJHttc2cubWVzc2FnZX1gO1xuICAgICAgICBsb2dnZXIud2Fybihtc2cpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZ2dlci53YXJuKG1zZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gYWRkVW5pcXVlSXRlbShhcnIsIGl0ZW0pIHtcbiAgICBpZiAoYXJyLmZpbmRJbmRleCgobmFtZTEpPT5uYW1lMSA9PT0gaXRlbSkgPT09IC0xKSB7XG4gICAgICAgIGFyci5wdXNoKGl0ZW0pO1xuICAgIH1cbiAgICByZXR1cm4gYXJyO1xufVxuZnVuY3Rpb24gZ2V0Rk1JZChyZW1vdGVJbmZvKSB7XG4gICAgaWYgKCd2ZXJzaW9uJyBpbiByZW1vdGVJbmZvICYmIHJlbW90ZUluZm8udmVyc2lvbikge1xuICAgICAgICByZXR1cm4gYCR7cmVtb3RlSW5mby5uYW1lfToke3JlbW90ZUluZm8udmVyc2lvbn1gO1xuICAgIH0gZWxzZSBpZiAoJ2VudHJ5JyBpbiByZW1vdGVJbmZvICYmIHJlbW90ZUluZm8uZW50cnkpIHtcbiAgICAgICAgcmV0dXJuIGAke3JlbW90ZUluZm8ubmFtZX06JHtyZW1vdGVJbmZvLmVudHJ5fWA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGAke3JlbW90ZUluZm8ubmFtZX1gO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGlzUmVtb3RlSW5mb1dpdGhFbnRyeShyZW1vdGUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHJlbW90ZS5lbnRyeSAhPT0gJ3VuZGVmaW5lZCc7XG59XG5mdW5jdGlvbiBpc1B1cmVSZW1vdGVFbnRyeShyZW1vdGUpIHtcbiAgICByZXR1cm4gIXJlbW90ZS5lbnRyeS5pbmNsdWRlcygnLmpzb24nKSAmJiByZW1vdGUuZW50cnkuaW5jbHVkZXMoJy5qcycpO1xufVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmZ1bmN0aW9uIHNhZmVXcmFwcGVyKGNhbGxiYWNrLCBkaXNhYmxlV2Fybikge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAhZGlzYWJsZVdhcm4gJiYgd2FybihlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pKCk7XG59XG5mdW5jdGlvbiBpc09iamVjdCh2YWwpIHtcbiAgICByZXR1cm4gdmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnO1xufVxudmFyIG9iamVjdFRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXG5mdW5jdGlvbiBpc1BsYWluT2JqZWN0KHZhbCkge1xuICAgIHJldHVybiBvYmplY3RUb1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IE9iamVjdF0nO1xufVxuZnVuY3Rpb24gaXNTdGF0aWNSZXNvdXJjZXNFcXVhbCh1cmwxLCB1cmwyKSB7XG4gICAgdmFyIFJFR19FWFAgPSAvXihodHRwcz86KT9cXC9cXC8vaTtcbiAgICAvLyBUcmFuc2Zvcm0gdXJsMSBhbmQgdXJsMiBpbnRvIHJlbGF0aXZlIHBhdGhzXG4gICAgdmFyIHJlbGF0aXZlVXJsMSA9IHVybDEucmVwbGFjZShSRUdfRVhQLCAnJykucmVwbGFjZSgvXFwvJC8sICcnKTtcbiAgICB2YXIgcmVsYXRpdmVVcmwyID0gdXJsMi5yZXBsYWNlKFJFR19FWFAsICcnKS5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgIC8vIENoZWNrIGlmIHRoZSByZWxhdGl2ZSBwYXRocyBhcmUgaWRlbnRpY2FsXG4gICAgcmV0dXJuIHJlbGF0aXZlVXJsMSA9PT0gcmVsYXRpdmVVcmwyO1xufVxuZnVuY3Rpb24gYXJyYXlPcHRpb25zKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShvcHRpb25zKSA/IG9wdGlvbnMgOiBbXG4gICAgICAgIG9wdGlvbnNcbiAgICBdO1xufVxuZnVuY3Rpb24gZ2V0UmVtb3RlRW50cnlJbmZvRnJvbVNuYXBzaG90KHNuYXBzaG90KSB7XG4gICAgdmFyIGRlZmF1bHRSZW1vdGVFbnRyeUluZm8gPSB7XG4gICAgICAgIHVybDogJycsXG4gICAgICAgIHR5cGU6ICdnbG9iYWwnLFxuICAgICAgICBnbG9iYWxOYW1lOiAnJ1xuICAgIH07XG4gICAgaWYgKHNkay5pc0Jyb3dzZXJFbnYoKSkge1xuICAgICAgICByZXR1cm4gJ3JlbW90ZUVudHJ5JyBpbiBzbmFwc2hvdCA/IHtcbiAgICAgICAgICAgIHVybDogc25hcHNob3QucmVtb3RlRW50cnksXG4gICAgICAgICAgICB0eXBlOiBzbmFwc2hvdC5yZW1vdGVFbnRyeVR5cGUsXG4gICAgICAgICAgICBnbG9iYWxOYW1lOiBzbmFwc2hvdC5nbG9iYWxOYW1lXG4gICAgICAgIH0gOiBkZWZhdWx0UmVtb3RlRW50cnlJbmZvO1xuICAgIH1cbiAgICBpZiAoJ3NzclJlbW90ZUVudHJ5JyBpbiBzbmFwc2hvdCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdXJsOiBzbmFwc2hvdC5zc3JSZW1vdGVFbnRyeSB8fCBkZWZhdWx0UmVtb3RlRW50cnlJbmZvLnVybCxcbiAgICAgICAgICAgIHR5cGU6IHNuYXBzaG90LnNzclJlbW90ZUVudHJ5VHlwZSB8fCBkZWZhdWx0UmVtb3RlRW50cnlJbmZvLnR5cGUsXG4gICAgICAgICAgICBnbG9iYWxOYW1lOiBzbmFwc2hvdC5nbG9iYWxOYW1lXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBkZWZhdWx0UmVtb3RlRW50cnlJbmZvO1xufVxudmFyIHByb2Nlc3NNb2R1bGVBbGlhcyA9IChuYW1lMSwgc3ViUGF0aCk9PntcbiAgICAvLyBAaG9zdC8gLi9idXR0b24gLT4gQGhvc3QvYnV0dG9uXG4gICAgdmFyIG1vZHVsZU5hbWU7XG4gICAgaWYgKG5hbWUxLmVuZHNXaXRoKCcvJykpIHtcbiAgICAgICAgbW9kdWxlTmFtZSA9IG5hbWUxLnNsaWNlKDAsIC0xKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBtb2R1bGVOYW1lID0gbmFtZTE7XG4gICAgfVxuICAgIGlmIChzdWJQYXRoLnN0YXJ0c1dpdGgoJy4nKSkge1xuICAgICAgICBzdWJQYXRoID0gc3ViUGF0aC5zbGljZSgxKTtcbiAgICB9XG4gICAgbW9kdWxlTmFtZSA9IG1vZHVsZU5hbWUgKyBzdWJQYXRoO1xuICAgIHJldHVybiBtb2R1bGVOYW1lO1xufTtcbnZhciBDdXJyZW50R2xvYmFsID0gdHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnID8gZ2xvYmFsVGhpcyA6IHdpbmRvdztcbnZhciBuYXRpdmVHbG9iYWwgPSAoKCk9PntcbiAgICB0cnkge1xuICAgICAgICAvLyBnZXQgcmVhbCB3aW5kb3cgKGluY2FzZSBvZiBzYW5kYm94KVxuICAgICAgICByZXR1cm4gZG9jdW1lbnQuZGVmYXVsdFZpZXc7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBub2RlIGVudlxuICAgICAgICByZXR1cm4gQ3VycmVudEdsb2JhbDtcbiAgICB9XG59KSgpO1xudmFyIEdsb2JhbCA9IG5hdGl2ZUdsb2JhbDtcbmZ1bmN0aW9uIGRlZmluZVByb3BlcnR5R2xvYmFsVmFsKHRhcmdldCwga2V5LCB2YWwpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHtcbiAgICAgICAgdmFsdWU6IHZhbCxcbiAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGluY2x1ZGVPd25Qcm9wZXJ0eSh0YXJnZXQsIGtleSkge1xuICAgIHJldHVybiBPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbCh0YXJnZXQsIGtleSk7XG59XG4vLyBUaGlzIHNlY3Rpb24gaXMgdG8gcHJldmVudCBlbmNhcHN1bGF0aW9uIGJ5IGNlcnRhaW4gbWljcm9mcm9udGVuZCBmcmFtZXdvcmtzLiBEdWUgdG8gcmV1c2UgcG9saWNpZXMsIHNhbmRib3ggZXNjYXBlcy5cbi8vIFRoZSBzYW5kYm94IGluIHRoZSBtaWNyb2Zyb250ZW5kIGRvZXMgbm90IHJlcGxpY2F0ZSB0aGUgdmFsdWUgb2YgJ2NvbmZpZ3VyYWJsZScuXG4vLyBJZiB0aGVyZSBpcyBubyBsb2FkaW5nIGNvbnRlbnQgb24gdGhlIGdsb2JhbCBvYmplY3QsIHRoaXMgc2VjdGlvbiBkZWZpbmVzIHRoZSBsb2FkaW5nIG9iamVjdC5cbmlmICghaW5jbHVkZU93blByb3BlcnR5KEN1cnJlbnRHbG9iYWwsICdfX0dMT0JBTF9MT0FESU5HX1JFTU9URV9FTlRSWV9fJykpIHtcbiAgICBkZWZpbmVQcm9wZXJ0eUdsb2JhbFZhbChDdXJyZW50R2xvYmFsLCAnX19HTE9CQUxfTE9BRElOR19SRU1PVEVfRU5UUllfXycsIHt9KTtcbn1cbnZhciBnbG9iYWxMb2FkaW5nID0gQ3VycmVudEdsb2JhbC5fX0dMT0JBTF9MT0FESU5HX1JFTU9URV9FTlRSWV9fO1xuZnVuY3Rpb24gc2V0R2xvYmFsRGVmYXVsdFZhbCh0YXJnZXQpIHtcbiAgICB2YXIgX3RhcmdldF9fX0ZFREVSQVRJT05fXywgX3RhcmdldF9fX0ZFREVSQVRJT05fXzEsIF90YXJnZXRfX19GRURFUkFUSU9OX18yLCBfdGFyZ2V0X19fRkVERVJBVElPTl9fMywgX3RhcmdldF9fX0ZFREVSQVRJT05fXzQsIF90YXJnZXRfX19GRURFUkFUSU9OX181O1xuICAgIGlmIChpbmNsdWRlT3duUHJvcGVydHkodGFyZ2V0LCAnX19WTU9LX18nKSAmJiAhaW5jbHVkZU93blByb3BlcnR5KHRhcmdldCwgJ19fRkVERVJBVElPTl9fJykpIHtcbiAgICAgICAgZGVmaW5lUHJvcGVydHlHbG9iYWxWYWwodGFyZ2V0LCAnX19GRURFUkFUSU9OX18nLCB0YXJnZXQuX19WTU9LX18pO1xuICAgIH1cbiAgICBpZiAoIWluY2x1ZGVPd25Qcm9wZXJ0eSh0YXJnZXQsICdfX0ZFREVSQVRJT05fXycpKSB7XG4gICAgICAgIGRlZmluZVByb3BlcnR5R2xvYmFsVmFsKHRhcmdldCwgJ19fRkVERVJBVElPTl9fJywge1xuICAgICAgICAgICAgX19HTE9CQUxfUExVR0lOX186IFtdLFxuICAgICAgICAgICAgX19JTlNUQU5DRVNfXzogW10sXG4gICAgICAgICAgICBtb2R1bGVJbmZvOiB7fSxcbiAgICAgICAgICAgIF9fU0hBUkVfXzoge30sXG4gICAgICAgICAgICBfX01BTklGRVNUX0xPQURJTkdfXzoge30sXG4gICAgICAgICAgICBfX1BSRUxPQURFRF9NQVBfXzogbmV3IE1hcCgpXG4gICAgICAgIH0pO1xuICAgICAgICBkZWZpbmVQcm9wZXJ0eUdsb2JhbFZhbCh0YXJnZXQsICdfX1ZNT0tfXycsIHRhcmdldC5fX0ZFREVSQVRJT05fXyk7XG4gICAgfVxuICAgIHZhciBfX19HTE9CQUxfUExVR0lOX187XG4gICAgKF9fX0dMT0JBTF9QTFVHSU5fXyA9IChfdGFyZ2V0X19fRkVERVJBVElPTl9fID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5fX0dMT0JBTF9QTFVHSU5fXykgIT0gbnVsbCA/IF9fX0dMT0JBTF9QTFVHSU5fXyA6IF90YXJnZXRfX19GRURFUkFUSU9OX18uX19HTE9CQUxfUExVR0lOX18gPSBbXTtcbiAgICB2YXIgX19fSU5TVEFOQ0VTX187XG4gICAgKF9fX0lOU1RBTkNFU19fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX18xID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5fX0lOU1RBTkNFU19fKSAhPSBudWxsID8gX19fSU5TVEFOQ0VTX18gOiBfdGFyZ2V0X19fRkVERVJBVElPTl9fMS5fX0lOU1RBTkNFU19fID0gW107XG4gICAgdmFyIF9tb2R1bGVJbmZvO1xuICAgIChfbW9kdWxlSW5mbyA9IChfdGFyZ2V0X19fRkVERVJBVElPTl9fMiA9IHRhcmdldC5fX0ZFREVSQVRJT05fXykubW9kdWxlSW5mbykgIT0gbnVsbCA/IF9tb2R1bGVJbmZvIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXzIubW9kdWxlSW5mbyA9IHt9O1xuICAgIHZhciBfX19TSEFSRV9fO1xuICAgIChfX19TSEFSRV9fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX18zID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5fX1NIQVJFX18pICE9IG51bGwgPyBfX19TSEFSRV9fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXzMuX19TSEFSRV9fID0ge307XG4gICAgdmFyIF9fX01BTklGRVNUX0xPQURJTkdfXztcbiAgICAoX19fTUFOSUZFU1RfTE9BRElOR19fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX180ID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5fX01BTklGRVNUX0xPQURJTkdfXykgIT0gbnVsbCA/IF9fX01BTklGRVNUX0xPQURJTkdfXyA6IF90YXJnZXRfX19GRURFUkFUSU9OX180Ll9fTUFOSUZFU1RfTE9BRElOR19fID0ge307XG4gICAgdmFyIF9fX1BSRUxPQURFRF9NQVBfXztcbiAgICAoX19fUFJFTE9BREVEX01BUF9fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX181ID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5fX1BSRUxPQURFRF9NQVBfXykgIT0gbnVsbCA/IF9fX1BSRUxPQURFRF9NQVBfXyA6IF90YXJnZXRfX19GRURFUkFUSU9OX181Ll9fUFJFTE9BREVEX01BUF9fID0gbmV3IE1hcCgpO1xufVxuc2V0R2xvYmFsRGVmYXVsdFZhbChDdXJyZW50R2xvYmFsKTtcbnNldEdsb2JhbERlZmF1bHRWYWwobmF0aXZlR2xvYmFsKTtcbmZ1bmN0aW9uIHJlc2V0RmVkZXJhdGlvbkdsb2JhbEluZm8oKSB7XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXyA9IFtdO1xuICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19JTlNUQU5DRVNfXyA9IFtdO1xuICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbyA9IHt9O1xuICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19TSEFSRV9fID0ge307XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX01BTklGRVNUX0xPQURJTkdfXyA9IHt9O1xuICAgIE9iamVjdC5rZXlzKGdsb2JhbExvYWRpbmcpLmZvckVhY2goKGtleSk9PntcbiAgICAgICAgZGVsZXRlIGdsb2JhbExvYWRpbmdba2V5XTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIHNldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZShGZWRlcmF0aW9uSW5zdGFuY2UpIHtcbiAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX18ucHVzaChGZWRlcmF0aW9uSW5zdGFuY2UpO1xufVxuZnVuY3Rpb24gZ2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yKCkge1xuICAgIHJldHVybiBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fREVCVUdfQ09OU1RSVUNUT1JfXztcbn1cbmZ1bmN0aW9uIHNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcihGZWRlcmF0aW9uQ29uc3RydWN0b3IsIHJlZikge1xuICAgIHZhciBpc0RlYnVnID0gcmVmID09PSB2b2lkIDAgPyBzZGsuaXNEZWJ1Z01vZGUoKSA6IHJlZjtcbiAgICBpZiAoaXNEZWJ1Zykge1xuICAgICAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fREVCVUdfQ09OU1RSVUNUT1JfXyA9IEZlZGVyYXRpb25Db25zdHJ1Y3RvcjtcbiAgICAgICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0RFQlVHX0NPTlNUUlVDVE9SX1ZFUlNJT05fXyA9IFwiMC4xMC4wXCI7XG4gICAgfVxufVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcbmZ1bmN0aW9uIGdldEluZm9XaXRob3V0VHlwZSh0YXJnZXQsIGtleSkge1xuICAgIGlmICh0eXBlb2Yga2V5ID09PSAnc3RyaW5nJykge1xuICAgICAgICB2YXIga2V5UmVzID0gdGFyZ2V0W2tleV07XG4gICAgICAgIGlmIChrZXlSZXMpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHRhcmdldFtrZXldLFxuICAgICAgICAgICAgICAgIGtleToga2V5XG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHRhcmdldEtleXMgPSBPYmplY3Qua2V5cyh0YXJnZXQpO1xuICAgICAgICAgICAgZm9yICh2YXIgdGFyZ2V0S2V5IG9mIHRhcmdldEtleXMpe1xuICAgICAgICAgICAgICAgIHZhciBfdGFyZ2V0S2V5X3NwbGl0ID0gX3NsaWNlZF90b19hcnJheS5fKHRhcmdldEtleS5zcGxpdCgnOicpLCAyKSwgdGFyZ2V0VHlwZU9yTmFtZSA9IF90YXJnZXRLZXlfc3BsaXRbMF0sIF8gPSBfdGFyZ2V0S2V5X3NwbGl0WzFdO1xuICAgICAgICAgICAgICAgIHZhciBuS2V5ID0gYCR7dGFyZ2V0VHlwZU9yTmFtZX06JHtrZXl9YDtcbiAgICAgICAgICAgICAgICB2YXIgdHlwZVdpdGhLZXlSZXMgPSB0YXJnZXRbbktleV07XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVXaXRoS2V5UmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdHlwZVdpdGhLZXlSZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk6IG5LZXlcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAga2V5OiBrZXlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2tleSBtdXN0IGJlIHN0cmluZycpO1xuICAgIH1cbn1cbnZhciBnZXRHbG9iYWxTbmFwc2hvdCA9ICgpPT5uYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbztcbnZhciBnZXRUYXJnZXRTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8gPSAobW9kdWxlSW5mbywgc25hcHNob3QpPT57XG4gICAgLy8gQ2hlY2sgaWYgdGhlIHJlbW90ZSBpcyBpbmNsdWRlZCBpbiB0aGUgaG9zdFNuYXBzaG90XG4gICAgdmFyIG1vZHVsZUtleSA9IGdldEZNSWQobW9kdWxlSW5mbyk7XG4gICAgdmFyIGdldE1vZHVsZUluZm8gPSBnZXRJbmZvV2l0aG91dFR5cGUoc25hcHNob3QsIG1vZHVsZUtleSkudmFsdWU7XG4gICAgLy8gVGhlIHJlbW90ZVNuYXBzaG90IG1pZ2h0IG5vdCBpbmNsdWRlIGEgdmVyc2lvblxuICAgIGlmIChnZXRNb2R1bGVJbmZvICYmICFnZXRNb2R1bGVJbmZvLnZlcnNpb24gJiYgJ3ZlcnNpb24nIGluIG1vZHVsZUluZm8gJiYgbW9kdWxlSW5mb1sndmVyc2lvbiddKSB7XG4gICAgICAgIGdldE1vZHVsZUluZm8udmVyc2lvbiA9IG1vZHVsZUluZm9bJ3ZlcnNpb24nXTtcbiAgICB9XG4gICAgaWYgKGdldE1vZHVsZUluZm8pIHtcbiAgICAgICAgcmV0dXJuIGdldE1vZHVsZUluZm87XG4gICAgfVxuICAgIC8vIElmIHRoZSByZW1vdGUgaXMgbm90IGluY2x1ZGVkIGluIHRoZSBob3N0U25hcHNob3QsIGRlcGxveSBhIG1pY3JvIGFwcCBzbmFwc2hvdFxuICAgIGlmICgndmVyc2lvbicgaW4gbW9kdWxlSW5mbyAmJiBtb2R1bGVJbmZvWyd2ZXJzaW9uJ10pIHtcbiAgICAgICAgdmFyIHZlcnNpb24gPSBtb2R1bGVJbmZvLnZlcnNpb24sIHJlc01vZHVsZUluZm8gPSBwb2x5ZmlsbHMuX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2UobW9kdWxlSW5mbywgW1xuICAgICAgICAgICAgXCJ2ZXJzaW9uXCJcbiAgICAgICAgXSk7XG4gICAgICAgIHZhciBtb2R1bGVLZXlXaXRob3V0VmVyc2lvbiA9IGdldEZNSWQocmVzTW9kdWxlSW5mbyk7XG4gICAgICAgIHZhciBnZXRNb2R1bGVJbmZvV2l0aG91dFZlcnNpb24gPSBnZXRJbmZvV2l0aG91dFR5cGUobmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm8sIG1vZHVsZUtleVdpdGhvdXRWZXJzaW9uKS52YWx1ZTtcbiAgICAgICAgaWYgKChnZXRNb2R1bGVJbmZvV2l0aG91dFZlcnNpb24gPT0gbnVsbCA/IHZvaWQgMCA6IGdldE1vZHVsZUluZm9XaXRob3V0VmVyc2lvbi52ZXJzaW9uKSA9PT0gdmVyc2lvbikge1xuICAgICAgICAgICAgcmV0dXJuIGdldE1vZHVsZUluZm9XaXRob3V0VmVyc2lvbjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm47XG59O1xudmFyIGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyA9IChtb2R1bGVJbmZvKT0+Z2V0VGFyZ2V0U25hcHNob3RJbmZvQnlNb2R1bGVJbmZvKG1vZHVsZUluZm8sIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvKTtcbnZhciBzZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8gPSAocmVtb3RlSW5mbywgbW9kdWxlRGV0YWlsSW5mbyk9PntcbiAgICB2YXIgbW9kdWxlS2V5ID0gZ2V0Rk1JZChyZW1vdGVJbmZvKTtcbiAgICBuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mb1ttb2R1bGVLZXldID0gbW9kdWxlRGV0YWlsSW5mbztcbiAgICByZXR1cm4gbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm87XG59O1xudmFyIGFkZEdsb2JhbFNuYXBzaG90ID0gKG1vZHVsZUluZm9zKT0+e1xuICAgIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbywgbW9kdWxlSW5mb3MpO1xuICAgIHJldHVybiAoKT0+e1xuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG1vZHVsZUluZm9zKTtcbiAgICAgICAgZm9yICh2YXIga2V5IG9mIGtleXMpe1xuICAgICAgICAgICAgZGVsZXRlIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvW2tleV07XG4gICAgICAgIH1cbiAgICB9O1xufTtcbnZhciBnZXRSZW1vdGVFbnRyeUV4cG9ydHMgPSAobmFtZTEsIGdsb2JhbE5hbWUpPT57XG4gICAgdmFyIHJlbW90ZUVudHJ5S2V5ID0gZ2xvYmFsTmFtZSB8fCBgX19GRURFUkFUSU9OXyR7bmFtZTF9OmN1c3RvbV9fYDtcbiAgICB2YXIgZW50cnlFeHBvcnRzID0gQ3VycmVudEdsb2JhbFtyZW1vdGVFbnRyeUtleV07XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVtb3RlRW50cnlLZXksXG4gICAgICAgIGVudHJ5RXhwb3J0c1xuICAgIH07XG59O1xuLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHJlZ2lzdGVyIGdsb2JhbCBwbHVnaW5zLlxuLy8gSXQgaXRlcmF0ZXMgb3ZlciB0aGUgcHJvdmlkZWQgcGx1Z2lucyBhbmQgY2hlY2tzIGlmIHRoZXkgYXJlIGFscmVhZHkgcmVnaXN0ZXJlZC5cbi8vIElmIGEgcGx1Z2luIGlzIG5vdCByZWdpc3RlcmVkLCBpdCBpcyBhZGRlZCB0byB0aGUgZ2xvYmFsIHBsdWdpbnMuXG4vLyBJZiBhIHBsdWdpbiBpcyBhbHJlYWR5IHJlZ2lzdGVyZWQsIGEgd2FybmluZyBtZXNzYWdlIGlzIGxvZ2dlZC5cbnZhciByZWdpc3Rlckdsb2JhbFBsdWdpbnMgPSAocGx1Z2lucyk9PntcbiAgICB2YXIgX19HTE9CQUxfUExVR0lOX18gPSBuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18uX19HTE9CQUxfUExVR0lOX187XG4gICAgcGx1Z2lucy5mb3JFYWNoKChwbHVnaW4pPT57XG4gICAgICAgIGlmIChfX0dMT0JBTF9QTFVHSU5fXy5maW5kSW5kZXgoKHApPT5wLm5hbWUgPT09IHBsdWdpbi5uYW1lKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIF9fR0xPQkFMX1BMVUdJTl9fLnB1c2gocGx1Z2luKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHdhcm4oYFRoZSBwbHVnaW4gJHtwbHVnaW4ubmFtZX0gaGFzIGJlZW4gcmVnaXN0ZXJlZC5gKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcbnZhciBnZXRHbG9iYWxIb3N0UGx1Z2lucyA9ICgpPT5uYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18uX19HTE9CQUxfUExVR0lOX187XG52YXIgZ2V0UHJlbG9hZGVkID0gKGlkKT0+Q3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1BSRUxPQURFRF9NQVBfXy5nZXQoaWQpO1xudmFyIHNldFByZWxvYWRlZCA9IChpZCk9PkN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19QUkVMT0FERURfTUFQX18uc2V0KGlkLCB0cnVlKTtcbnZhciBERUZBVUxUX1NDT1BFID0gJ2RlZmF1bHQnO1xudmFyIERFRkFVTFRfUkVNT1RFX1RZUEUgPSAnZ2xvYmFsJztcbi8vIGZvcmsgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vb3JpZ2luanMvdml0ZS1wbHVnaW4tZmVkZXJhdGlvbi9ibG9iL3YxLjEuMTIvcGFja2FnZXMvbGliL3NyYy91dGlscy9zZW12ZXIvaW5kZXgudHNcbi8vIHRob3NlIGNvbnN0YW50cyBhcmUgYmFzZWQgb24gaHR0cHM6Ly93d3cucnVieWRvYy5pbmZvL2dlbXMvc2VtYW50aWNfcmFuZ2UvMy4wLjAvU2VtYW50aWNSYW5nZSNCVUlMRElERU5USUZJRVItY29uc3RhbnRcbi8vIENvcHlyaWdodCAoYylcbi8vIHZpdGUtcGx1Z2luLWZlZGVyYXRpb24gaXMgbGljZW5zZWQgdW5kZXIgTXVsYW4gUFNMIHYyLlxuLy8gWW91IGNhbiB1c2UgdGhpcyBzb2Z0d2FyZSBhY2NvcmRpbmcgdG8gdGhlIHRlcm1zIGFuZCBjb25kaXRpb25zIG9mIHRoZSBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgTXVsYW4gUFNMIHYyIGF0OlxuLy8gICAgICBodHRwOi8vbGljZW5zZS5jb3NjbC5vcmcuY24vTXVsYW5QU0wyXG4vLyBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIE9OIEFOIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9GIEFOWSBLSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIE5PTi1JTkZSSU5HRU1FTlQsIE1FUkNIQU5UQUJJTElUWSBPUiBGSVQgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLlxuLy8gU2VlIHRoZSBNdWxhbiBQU0wgdjIgZm9yIG1vcmUgZGV0YWlscy5cbnZhciBidWlsZElkZW50aWZpZXIgPSAnWzAtOUEtWmEtei1dKyc7XG52YXIgYnVpbGQgPSBgKD86XFxcXCsoJHtidWlsZElkZW50aWZpZXJ9KD86XFxcXC4ke2J1aWxkSWRlbnRpZmllcn0pKikpYDtcbnZhciBudW1lcmljSWRlbnRpZmllciA9ICcwfFsxLTldXFxcXGQqJztcbnZhciBudW1lcmljSWRlbnRpZmllckxvb3NlID0gJ1swLTldKyc7XG52YXIgbm9uTnVtZXJpY0lkZW50aWZpZXIgPSAnXFxcXGQqW2EtekEtWi1dW2EtekEtWjAtOS1dKic7XG52YXIgcHJlUmVsZWFzZUlkZW50aWZpZXJMb29zZSA9IGAoPzoke251bWVyaWNJZGVudGlmaWVyTG9vc2V9fCR7bm9uTnVtZXJpY0lkZW50aWZpZXJ9KWA7XG52YXIgcHJlUmVsZWFzZUxvb3NlID0gYCg/Oi0/KCR7cHJlUmVsZWFzZUlkZW50aWZpZXJMb29zZX0oPzpcXFxcLiR7cHJlUmVsZWFzZUlkZW50aWZpZXJMb29zZX0pKikpYDtcbnZhciBwcmVSZWxlYXNlSWRlbnRpZmllciA9IGAoPzoke251bWVyaWNJZGVudGlmaWVyfXwke25vbk51bWVyaWNJZGVudGlmaWVyfSlgO1xudmFyIHByZVJlbGVhc2UgPSBgKD86LSgke3ByZVJlbGVhc2VJZGVudGlmaWVyfSg/OlxcXFwuJHtwcmVSZWxlYXNlSWRlbnRpZmllcn0pKikpYDtcbnZhciB4UmFuZ2VJZGVudGlmaWVyID0gYCR7bnVtZXJpY0lkZW50aWZpZXJ9fHh8WHxcXFxcKmA7XG52YXIgeFJhbmdlUGxhaW4gPSBgW3Y9XFxcXHNdKigke3hSYW5nZUlkZW50aWZpZXJ9KSg/OlxcXFwuKCR7eFJhbmdlSWRlbnRpZmllcn0pKD86XFxcXC4oJHt4UmFuZ2VJZGVudGlmaWVyfSkoPzoke3ByZVJlbGVhc2V9KT8ke2J1aWxkfT8pPyk/YDtcbnZhciBoeXBoZW5SYW5nZSA9IGBeXFxcXHMqKCR7eFJhbmdlUGxhaW59KVxcXFxzKy1cXFxccysoJHt4UmFuZ2VQbGFpbn0pXFxcXHMqJGA7XG52YXIgbWFpblZlcnNpb25Mb29zZSA9IGAoJHtudW1lcmljSWRlbnRpZmllckxvb3NlfSlcXFxcLigke251bWVyaWNJZGVudGlmaWVyTG9vc2V9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJMb29zZX0pYDtcbnZhciBsb29zZVBsYWluID0gYFt2PVxcXFxzXSoke21haW5WZXJzaW9uTG9vc2V9JHtwcmVSZWxlYXNlTG9vc2V9PyR7YnVpbGR9P2A7XG52YXIgZ3RsdCA9ICcoKD86PHw+KT89PyknO1xudmFyIGNvbXBhcmF0b3JUcmltID0gYChcXFxccyopJHtndGx0fVxcXFxzKigke2xvb3NlUGxhaW59fCR7eFJhbmdlUGxhaW59KWA7XG52YXIgbG9uZVRpbGRlID0gJyg/On4+PyknO1xudmFyIHRpbGRlVHJpbSA9IGAoXFxcXHMqKSR7bG9uZVRpbGRlfVxcXFxzK2A7XG52YXIgbG9uZUNhcmV0ID0gJyg/OlxcXFxeKSc7XG52YXIgY2FyZXRUcmltID0gYChcXFxccyopJHtsb25lQ2FyZXR9XFxcXHMrYDtcbnZhciBzdGFyID0gJyg8fD4pPz0/XFxcXHMqXFxcXConO1xudmFyIGNhcmV0ID0gYF4ke2xvbmVDYXJldH0ke3hSYW5nZVBsYWlufSRgO1xudmFyIG1haW5WZXJzaW9uID0gYCgke251bWVyaWNJZGVudGlmaWVyfSlcXFxcLigke251bWVyaWNJZGVudGlmaWVyfSlcXFxcLigke251bWVyaWNJZGVudGlmaWVyfSlgO1xudmFyIGZ1bGxQbGFpbiA9IGB2PyR7bWFpblZlcnNpb259JHtwcmVSZWxlYXNlfT8ke2J1aWxkfT9gO1xudmFyIHRpbGRlID0gYF4ke2xvbmVUaWxkZX0ke3hSYW5nZVBsYWlufSRgO1xudmFyIHhSYW5nZSA9IGBeJHtndGx0fVxcXFxzKiR7eFJhbmdlUGxhaW59JGA7XG52YXIgY29tcGFyYXRvciA9IGBeJHtndGx0fVxcXFxzKigke2Z1bGxQbGFpbn0pJHxeJGA7XG4vLyBjb3B5IGZyb20gc2VtdmVyIHBhY2thZ2VcbnZhciBndGUwID0gJ15cXFxccyo+PVxcXFxzKjAuMC4wXFxcXHMqJCc7XG4vLyBmb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL29yaWdpbmpzL3ZpdGUtcGx1Z2luLWZlZGVyYXRpb24vYmxvYi92MS4xLjEyL3BhY2thZ2VzL2xpYi9zcmMvdXRpbHMvc2VtdmVyL2luZGV4LnRzXG4vLyBDb3B5cmlnaHQgKGMpXG4vLyB2aXRlLXBsdWdpbi1mZWRlcmF0aW9uIGlzIGxpY2Vuc2VkIHVuZGVyIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBjYW4gdXNlIHRoaXMgc29mdHdhcmUgYWNjb3JkaW5nIHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgTXVsYW4gUFNMIHYyLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIE11bGFuIFBTTCB2MiBhdDpcbi8vICAgICAgaHR0cDovL2xpY2Vuc2UuY29zY2wub3JnLmNuL011bGFuUFNMMlxuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBOT04tSU5GUklOR0VNRU5ULCBNRVJDSEFOVEFCSUxJVFkgT1IgRklUIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cbi8vIFNlZSB0aGUgTXVsYW4gUFNMIHYyIGZvciBtb3JlIGRldGFpbHMuXG5mdW5jdGlvbiBwYXJzZVJlZ2V4KHNvdXJjZSkge1xuICAgIHJldHVybiBuZXcgUmVnRXhwKHNvdXJjZSk7XG59XG5mdW5jdGlvbiBpc1hWZXJzaW9uKHZlcnNpb24pIHtcbiAgICByZXR1cm4gIXZlcnNpb24gfHwgdmVyc2lvbi50b0xvd2VyQ2FzZSgpID09PSAneCcgfHwgdmVyc2lvbiA9PT0gJyonO1xufVxuZnVuY3Rpb24gcGlwZSguLi5mbnMpIHtcbiAgICByZXR1cm4gKHgpPT5mbnMucmVkdWNlKCh2LCBmKT0+Zih2KSwgeCk7XG59XG5mdW5jdGlvbiBleHRyYWN0Q29tcGFyYXRvcihjb21wYXJhdG9yU3RyaW5nKSB7XG4gICAgcmV0dXJuIGNvbXBhcmF0b3JTdHJpbmcubWF0Y2gocGFyc2VSZWdleChjb21wYXJhdG9yKSk7XG59XG5mdW5jdGlvbiBjb21iaW5lVmVyc2lvbihtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKSB7XG4gICAgdmFyIG1haW5WZXJzaW9uID0gYCR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9YDtcbiAgICBpZiAocHJlUmVsZWFzZSkge1xuICAgICAgICByZXR1cm4gYCR7bWFpblZlcnNpb259LSR7cHJlUmVsZWFzZX1gO1xuICAgIH1cbiAgICByZXR1cm4gbWFpblZlcnNpb247XG59XG4vLyBmb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL29yaWdpbmpzL3ZpdGUtcGx1Z2luLWZlZGVyYXRpb24vYmxvYi92MS4xLjEyL3BhY2thZ2VzL2xpYi9zcmMvdXRpbHMvc2VtdmVyL2luZGV4LnRzXG4vLyBDb3B5cmlnaHQgKGMpXG4vLyB2aXRlLXBsdWdpbi1mZWRlcmF0aW9uIGlzIGxpY2Vuc2VkIHVuZGVyIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBjYW4gdXNlIHRoaXMgc29mdHdhcmUgYWNjb3JkaW5nIHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgTXVsYW4gUFNMIHYyLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIE11bGFuIFBTTCB2MiBhdDpcbi8vICAgICAgaHR0cDovL2xpY2Vuc2UuY29zY2wub3JnLmNuL011bGFuUFNMMlxuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBOT04tSU5GUklOR0VNRU5ULCBNRVJDSEFOVEFCSUxJVFkgT1IgRklUIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cbi8vIFNlZSB0aGUgTXVsYW4gUFNMIHYyIGZvciBtb3JlIGRldGFpbHMuXG5mdW5jdGlvbiBwYXJzZUh5cGhlbihyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS5yZXBsYWNlKHBhcnNlUmVnZXgoaHlwaGVuUmFuZ2UpLCAoX3JhbmdlLCBmcm9tLCBmcm9tTWFqb3IsIGZyb21NaW5vciwgZnJvbVBhdGNoLCBfZnJvbVByZVJlbGVhc2UsIF9mcm9tQnVpbGQsIHRvLCB0b01ham9yLCB0b01pbm9yLCB0b1BhdGNoLCB0b1ByZVJlbGVhc2UpPT57XG4gICAgICAgIGlmIChpc1hWZXJzaW9uKGZyb21NYWpvcikpIHtcbiAgICAgICAgICAgIGZyb20gPSAnJztcbiAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKGZyb21NaW5vcikpIHtcbiAgICAgICAgICAgIGZyb20gPSBgPj0ke2Zyb21NYWpvcn0uMC4wYDtcbiAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKGZyb21QYXRjaCkpIHtcbiAgICAgICAgICAgIGZyb20gPSBgPj0ke2Zyb21NYWpvcn0uJHtmcm9tTWlub3J9LjBgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZnJvbSA9IGA+PSR7ZnJvbX1gO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1hWZXJzaW9uKHRvTWFqb3IpKSB7XG4gICAgICAgICAgICB0byA9ICcnO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24odG9NaW5vcikpIHtcbiAgICAgICAgICAgIHRvID0gYDwke051bWJlcih0b01ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKHRvUGF0Y2gpKSB7XG4gICAgICAgICAgICB0byA9IGA8JHt0b01ham9yfS4ke051bWJlcih0b01pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgIH0gZWxzZSBpZiAodG9QcmVSZWxlYXNlKSB7XG4gICAgICAgICAgICB0byA9IGA8PSR7dG9NYWpvcn0uJHt0b01pbm9yfS4ke3RvUGF0Y2h9LSR7dG9QcmVSZWxlYXNlfWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0byA9IGA8PSR7dG99YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7ZnJvbX0gJHt0b31gLnRyaW0oKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlQ29tcGFyYXRvclRyaW0ocmFuZ2UpIHtcbiAgICByZXR1cm4gcmFuZ2UucmVwbGFjZShwYXJzZVJlZ2V4KGNvbXBhcmF0b3JUcmltKSwgJyQxJDIkMycpO1xufVxuZnVuY3Rpb24gcGFyc2VUaWxkZVRyaW0ocmFuZ2UpIHtcbiAgICByZXR1cm4gcmFuZ2UucmVwbGFjZShwYXJzZVJlZ2V4KHRpbGRlVHJpbSksICckMX4nKTtcbn1cbmZ1bmN0aW9uIHBhcnNlQ2FyZXRUcmltKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnJlcGxhY2UocGFyc2VSZWdleChjYXJldFRyaW0pLCAnJDFeJyk7XG59XG5mdW5jdGlvbiBwYXJzZUNhcmV0cyhyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS50cmltKCkuc3BsaXQoL1xccysvKS5tYXAoKHJhbmdlVmVyc2lvbik9PnJhbmdlVmVyc2lvbi5yZXBsYWNlKHBhcnNlUmVnZXgoY2FyZXQpLCAoXywgbWFqb3IsIG1pbm9yLCBwYXRjaCwgcHJlUmVsZWFzZSk9PntcbiAgICAgICAgICAgIGlmIChpc1hWZXJzaW9uKG1ham9yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbihtaW5vcikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uMC4wIDwke051bWJlcihtYWpvcikgKyAxfS4wLjAtMGA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24ocGF0Y2gpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1ham9yID09PSAnMCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LjAgPCR7bWFqb3J9LiR7TnVtYmVyKG1pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LjAgPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByZVJlbGVhc2UpIHtcbiAgICAgICAgICAgICAgICBpZiAobWFqb3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWlub3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9LSR7cHJlUmVsZWFzZX0gPCR7bWFqb3J9LiR7bWlub3J9LiR7TnVtYmVyKHBhdGNoKSArIDF9LTBgO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9LSR7cHJlUmVsZWFzZX0gPCR7bWFqb3J9LiR7TnVtYmVyKG1pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0tJHtwcmVSZWxlYXNlfSA8JHtOdW1iZXIobWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG1ham9yID09PSAnMCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1pbm9yID09PSAnMCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofSA8JHttYWpvcn0uJHttaW5vcn0uJHtOdW1iZXIocGF0Y2gpICsgMX0tMGA7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0gPCR7bWFqb3J9LiR7TnVtYmVyKG1pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9IDwke051bWJlcihtYWpvcikgKyAxfS4wLjAtMGA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKS5qb2luKCcgJyk7XG59XG5mdW5jdGlvbiBwYXJzZVRpbGRlcyhyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS50cmltKCkuc3BsaXQoL1xccysvKS5tYXAoKHJhbmdlVmVyc2lvbik9PnJhbmdlVmVyc2lvbi5yZXBsYWNlKHBhcnNlUmVnZXgodGlsZGUpLCAoXywgbWFqb3IsIG1pbm9yLCBwYXRjaCwgcHJlUmVsZWFzZSk9PntcbiAgICAgICAgICAgIGlmIChpc1hWZXJzaW9uKG1ham9yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbihtaW5vcikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uMC4wIDwke051bWJlcihtYWpvcikgKyAxfS4wLjAtMGA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24ocGF0Y2gpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LjAgPCR7bWFqb3J9LiR7TnVtYmVyKG1pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByZVJlbGVhc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0tJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgfSkpLmpvaW4oJyAnKTtcbn1cbmZ1bmN0aW9uIHBhcnNlWFJhbmdlcyhyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS5zcGxpdCgvXFxzKy8pLm1hcCgocmFuZ2VWZXJzaW9uKT0+cmFuZ2VWZXJzaW9uLnRyaW0oKS5yZXBsYWNlKHBhcnNlUmVnZXgoeFJhbmdlKSwgKHJldCwgZ3RsdCwgbWFqb3IsIG1pbm9yLCBwYXRjaCwgcHJlUmVsZWFzZSk9PntcbiAgICAgICAgICAgIHZhciBpc1hNYWpvciA9IGlzWFZlcnNpb24obWFqb3IpO1xuICAgICAgICAgICAgdmFyIGlzWE1pbm9yID0gaXNYTWFqb3IgfHwgaXNYVmVyc2lvbihtaW5vcik7XG4gICAgICAgICAgICB2YXIgaXNYUGF0Y2ggPSBpc1hNaW5vciB8fCBpc1hWZXJzaW9uKHBhdGNoKTtcbiAgICAgICAgICAgIGlmIChndGx0ID09PSAnPScgJiYgaXNYUGF0Y2gpIHtcbiAgICAgICAgICAgICAgICBndGx0ID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcmVSZWxlYXNlID0gJyc7XG4gICAgICAgICAgICBpZiAoaXNYTWFqb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZ3RsdCA9PT0gJz4nIHx8IGd0bHQgPT09ICc8Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyBub3RoaW5nIGlzIGFsbG93ZWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8MC4wLjAtMCc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbm90aGluZyBpcyBmb3JiaWRkZW5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcqJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGd0bHQgJiYgaXNYUGF0Y2gpIHtcbiAgICAgICAgICAgICAgICAvLyByZXBsYWNlIFggd2l0aCAwXG4gICAgICAgICAgICAgICAgaWYgKGlzWE1pbm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG1pbm9yID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcGF0Y2ggPSAwO1xuICAgICAgICAgICAgICAgIGlmIChndGx0ID09PSAnPicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gPjEgPT4gPj0yLjAuMFxuICAgICAgICAgICAgICAgICAgICAvLyA+MS4yID0+ID49MS4zLjBcbiAgICAgICAgICAgICAgICAgICAgZ3RsdCA9ICc+PSc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1hNaW5vcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFqb3IgPSBOdW1iZXIobWFqb3IpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbm9yID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbm9yID0gTnVtYmVyKG1pbm9yKSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRjaCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGd0bHQgPT09ICc8PScpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gPD0wLjcueCBpcyBhY3R1YWxseSA8MC44LjAsIHNpbmNlIGFueSAwLjcueCBzaG91bGQgcGFzc1xuICAgICAgICAgICAgICAgICAgICAvLyBTaW1pbGFybHksIDw9Ny54IGlzIGFjdHVhbGx5IDw4LjAuMCwgZXRjLlxuICAgICAgICAgICAgICAgICAgICBndGx0ID0gJzwnO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNYTWlub3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ham9yID0gTnVtYmVyKG1ham9yKSArIDE7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtaW5vciA9IE51bWJlcihtaW5vcikgKyAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChndGx0ID09PSAnPCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJlUmVsZWFzZSA9ICctMCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBgJHtndGx0ICsgbWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9JHtwcmVSZWxlYXNlfWA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzWE1pbm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LjAuMCR7cHJlUmVsZWFzZX0gPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYUGF0Y2gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCR7cHJlUmVsZWFzZX0gPCR7bWFqb3J9LiR7TnVtYmVyKG1pbm9yKSArIDF9LjAtMGA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9KSkuam9pbignICcpO1xufVxuZnVuY3Rpb24gcGFyc2VTdGFyKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnRyaW0oKS5yZXBsYWNlKHBhcnNlUmVnZXgoc3RhciksICcnKTtcbn1cbmZ1bmN0aW9uIHBhcnNlR1RFMChjb21wYXJhdG9yU3RyaW5nKSB7XG4gICAgcmV0dXJuIGNvbXBhcmF0b3JTdHJpbmcudHJpbSgpLnJlcGxhY2UocGFyc2VSZWdleChndGUwKSwgJycpO1xufVxuLy8gZm9yayBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9vcmlnaW5qcy92aXRlLXBsdWdpbi1mZWRlcmF0aW9uL2Jsb2IvdjEuMS4xMi9wYWNrYWdlcy9saWIvc3JjL3V0aWxzL3NlbXZlci9pbmRleC50c1xuLy8gQ29weXJpZ2h0IChjKVxuLy8gdml0ZS1wbHVnaW4tZmVkZXJhdGlvbiBpcyBsaWNlbnNlZCB1bmRlciBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgY2FuIHVzZSB0aGlzIHNvZnR3YXJlIGFjY29yZGluZyB0byB0aGUgdGVybXMgYW5kIGNvbmRpdGlvbnMgb2YgdGhlIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiBNdWxhbiBQU0wgdjIgYXQ6XG4vLyAgICAgIGh0dHA6Ly9saWNlbnNlLmNvc2NsLm9yZy5jbi9NdWxhblBTTDJcbi8vIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgT04gQU4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT0YgQU5ZIEtJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gTk9OLUlORlJJTkdFTUVOVCwgTUVSQ0hBTlRBQklMSVRZIE9SIEZJVCBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuXG4vLyBTZWUgdGhlIE11bGFuIFBTTCB2MiBmb3IgbW9yZSBkZXRhaWxzLlxuZnVuY3Rpb24gY29tcGFyZUF0b20ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkge1xuICAgIHJhbmdlQXRvbSA9IE51bWJlcihyYW5nZUF0b20pIHx8IHJhbmdlQXRvbTtcbiAgICB2ZXJzaW9uQXRvbSA9IE51bWJlcih2ZXJzaW9uQXRvbSkgfHwgdmVyc2lvbkF0b207XG4gICAgaWYgKHJhbmdlQXRvbSA+IHZlcnNpb25BdG9tKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBpZiAocmFuZ2VBdG9tID09PSB2ZXJzaW9uQXRvbSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIC0xO1xufVxuZnVuY3Rpb24gY29tcGFyZVByZVJlbGVhc2UocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkge1xuICAgIHZhciByYW5nZVByZVJlbGVhc2UgPSByYW5nZUF0b20ucHJlUmVsZWFzZTtcbiAgICB2YXIgdmVyc2lvblByZVJlbGVhc2UgPSB2ZXJzaW9uQXRvbS5wcmVSZWxlYXNlO1xuICAgIGlmIChyYW5nZVByZVJlbGVhc2UgPT09IHVuZGVmaW5lZCAmJiBCb29sZWFuKHZlcnNpb25QcmVSZWxlYXNlKSkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgaWYgKEJvb2xlYW4ocmFuZ2VQcmVSZWxlYXNlKSAmJiB2ZXJzaW9uUHJlUmVsZWFzZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaWYgKHJhbmdlUHJlUmVsZWFzZSA9PT0gdW5kZWZpbmVkICYmIHZlcnNpb25QcmVSZWxlYXNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGZvcih2YXIgaSA9IDAsIG4gPSByYW5nZVByZVJlbGVhc2UubGVuZ3RoOyBpIDw9IG47IGkrKyl7XG4gICAgICAgIHZhciByYW5nZUVsZW1lbnQgPSByYW5nZVByZVJlbGVhc2VbaV07XG4gICAgICAgIHZhciB2ZXJzaW9uRWxlbWVudCA9IHZlcnNpb25QcmVSZWxlYXNlW2ldO1xuICAgICAgICBpZiAocmFuZ2VFbGVtZW50ID09PSB2ZXJzaW9uRWxlbWVudCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJhbmdlRWxlbWVudCA9PT0gdW5kZWZpbmVkICYmIHZlcnNpb25FbGVtZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmFuZ2VFbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZlcnNpb25FbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbXBhcmVBdG9tKHJhbmdlRWxlbWVudCwgdmVyc2lvbkVsZW1lbnQpO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbmZ1bmN0aW9uIGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHtcbiAgICByZXR1cm4gY29tcGFyZUF0b20ocmFuZ2VBdG9tLm1ham9yLCB2ZXJzaW9uQXRvbS5tYWpvcikgfHwgY29tcGFyZUF0b20ocmFuZ2VBdG9tLm1pbm9yLCB2ZXJzaW9uQXRvbS5taW5vcikgfHwgY29tcGFyZUF0b20ocmFuZ2VBdG9tLnBhdGNoLCB2ZXJzaW9uQXRvbS5wYXRjaCkgfHwgY29tcGFyZVByZVJlbGVhc2UocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSk7XG59XG5mdW5jdGlvbiBlcShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB7XG4gICAgcmV0dXJuIHJhbmdlQXRvbS52ZXJzaW9uID09PSB2ZXJzaW9uQXRvbS52ZXJzaW9uO1xufVxuZnVuY3Rpb24gY29tcGFyZShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB7XG4gICAgc3dpdGNoKHJhbmdlQXRvbS5vcGVyYXRvcil7XG4gICAgICAgIGNhc2UgJyc6XG4gICAgICAgIGNhc2UgJz0nOlxuICAgICAgICAgICAgcmV0dXJuIGVxKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pO1xuICAgICAgICBjYXNlICc+JzpcbiAgICAgICAgICAgIHJldHVybiBjb21wYXJlVmVyc2lvbihyYW5nZUF0b20sIHZlcnNpb25BdG9tKSA8IDA7XG4gICAgICAgIGNhc2UgJz49JzpcbiAgICAgICAgICAgIHJldHVybiBlcShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB8fCBjb21wYXJlVmVyc2lvbihyYW5nZUF0b20sIHZlcnNpb25BdG9tKSA8IDA7XG4gICAgICAgIGNhc2UgJzwnOlxuICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pID4gMDtcbiAgICAgICAgY2FzZSAnPD0nOlxuICAgICAgICAgICAgcmV0dXJuIGVxKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHx8IGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pID4gMDtcbiAgICAgICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gbWVhbiAqIG9yIHggLT4gYWxsIHZlcnNpb25zXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuLy8gZm9yayBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9vcmlnaW5qcy92aXRlLXBsdWdpbi1mZWRlcmF0aW9uL2Jsb2IvdjEuMS4xMi9wYWNrYWdlcy9saWIvc3JjL3V0aWxzL3NlbXZlci9pbmRleC50c1xuLy8gQ29weXJpZ2h0IChjKVxuLy8gdml0ZS1wbHVnaW4tZmVkZXJhdGlvbiBpcyBsaWNlbnNlZCB1bmRlciBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgY2FuIHVzZSB0aGlzIHNvZnR3YXJlIGFjY29yZGluZyB0byB0aGUgdGVybXMgYW5kIGNvbmRpdGlvbnMgb2YgdGhlIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiBNdWxhbiBQU0wgdjIgYXQ6XG4vLyAgICAgIGh0dHA6Ly9saWNlbnNlLmNvc2NsLm9yZy5jbi9NdWxhblBTTDJcbi8vIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgT04gQU4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT0YgQU5ZIEtJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gTk9OLUlORlJJTkdFTUVOVCwgTUVSQ0hBTlRBQklMSVRZIE9SIEZJVCBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuXG4vLyBTZWUgdGhlIE11bGFuIFBTTCB2MiBmb3IgbW9yZSBkZXRhaWxzLlxuZnVuY3Rpb24gcGFyc2VDb21wYXJhdG9yU3RyaW5nKHJhbmdlKSB7XG4gICAgcmV0dXJuIHBpcGUoLy8gXiAtLT4gKiAoYW55LCBraW5kYSBzaWxseSlcbiAgICAvLyBeMiwgXjIueCwgXjIueC54IC0tPiA+PTIuMC4wIDwzLjAuMC0wXG4gICAgLy8gXjIuMCwgXjIuMC54IC0tPiA+PTIuMC4wIDwzLjAuMC0wXG4gICAgLy8gXjEuMiwgXjEuMi54IC0tPiA+PTEuMi4wIDwyLjAuMC0wXG4gICAgLy8gXjEuMi4zIC0tPiA+PTEuMi4zIDwyLjAuMC0wXG4gICAgLy8gXjEuMi4wIC0tPiA+PTEuMi4wIDwyLjAuMC0wXG4gICAgcGFyc2VDYXJldHMsIC8vIH4sIH4+IC0tPiAqIChhbnksIGtpbmRhIHNpbGx5KVxuICAgIC8vIH4yLCB+Mi54LCB+Mi54LngsIH4+Miwgfj4yLnggfj4yLngueCAtLT4gPj0yLjAuMCA8My4wLjAtMFxuICAgIC8vIH4yLjAsIH4yLjAueCwgfj4yLjAsIH4+Mi4wLnggLS0+ID49Mi4wLjAgPDIuMS4wLTBcbiAgICAvLyB+MS4yLCB+MS4yLngsIH4+MS4yLCB+PjEuMi54IC0tPiA+PTEuMi4wIDwxLjMuMC0wXG4gICAgLy8gfjEuMi4zLCB+PjEuMi4zIC0tPiA+PTEuMi4zIDwxLjMuMC0wXG4gICAgLy8gfjEuMi4wLCB+PjEuMi4wIC0tPiA+PTEuMi4wIDwxLjMuMC0wXG4gICAgcGFyc2VUaWxkZXMsIHBhcnNlWFJhbmdlcywgcGFyc2VTdGFyKShyYW5nZSk7XG59XG5mdW5jdGlvbiBwYXJzZVJhbmdlKHJhbmdlKSB7XG4gICAgcmV0dXJuIHBpcGUoLy8gYDEuMi4zIC0gMS4yLjRgID0+IGA+PTEuMi4zIDw9MS4yLjRgXG4gICAgcGFyc2VIeXBoZW4sIC8vIGA+IDEuMi4zIDwgMS4yLjVgID0+IGA+MS4yLjMgPDEuMi41YFxuICAgIHBhcnNlQ29tcGFyYXRvclRyaW0sIC8vIGB+IDEuMi4zYCA9PiBgfjEuMi4zYFxuICAgIHBhcnNlVGlsZGVUcmltLCAvLyBgXiAxLjIuM2AgPT4gYF4xLjIuM2BcbiAgICBwYXJzZUNhcmV0VHJpbSkocmFuZ2UudHJpbSgpKS5zcGxpdCgvXFxzKy8pLmpvaW4oJyAnKTtcbn1cbmZ1bmN0aW9uIHNhdGlzZnkodmVyc2lvbiwgcmFuZ2UpIHtcbiAgICBpZiAoIXZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgcGFyc2VkUmFuZ2UgPSBwYXJzZVJhbmdlKHJhbmdlKTtcbiAgICB2YXIgcGFyc2VkQ29tcGFyYXRvciA9IHBhcnNlZFJhbmdlLnNwbGl0KCcgJykubWFwKChyYW5nZVZlcnNpb24pPT5wYXJzZUNvbXBhcmF0b3JTdHJpbmcocmFuZ2VWZXJzaW9uKSkuam9pbignICcpO1xuICAgIHZhciBjb21wYXJhdG9ycyA9IHBhcnNlZENvbXBhcmF0b3Iuc3BsaXQoL1xccysvKS5tYXAoKGNvbXBhcmF0b3IpPT5wYXJzZUdURTAoY29tcGFyYXRvcikpO1xuICAgIHZhciBleHRyYWN0ZWRWZXJzaW9uID0gZXh0cmFjdENvbXBhcmF0b3IodmVyc2lvbik7XG4gICAgaWYgKCFleHRyYWN0ZWRWZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIF9leHRyYWN0ZWRWZXJzaW9uID0gX3NsaWNlZF90b19hcnJheS5fKGV4dHJhY3RlZFZlcnNpb24sIDcpLCB2ZXJzaW9uT3BlcmF0b3IgPSBfZXh0cmFjdGVkVmVyc2lvblsxXSwgdmVyc2lvbk1ham9yID0gX2V4dHJhY3RlZFZlcnNpb25bM10sIHZlcnNpb25NaW5vciA9IF9leHRyYWN0ZWRWZXJzaW9uWzRdLCB2ZXJzaW9uUGF0Y2ggPSBfZXh0cmFjdGVkVmVyc2lvbls1XSwgdmVyc2lvblByZVJlbGVhc2UgPSBfZXh0cmFjdGVkVmVyc2lvbls2XTtcbiAgICB2YXIgdmVyc2lvbkF0b20gPSB7XG4gICAgICAgIG9wZXJhdG9yOiB2ZXJzaW9uT3BlcmF0b3IsXG4gICAgICAgIHZlcnNpb246IGNvbWJpbmVWZXJzaW9uKHZlcnNpb25NYWpvciwgdmVyc2lvbk1pbm9yLCB2ZXJzaW9uUGF0Y2gsIHZlcnNpb25QcmVSZWxlYXNlKSxcbiAgICAgICAgbWFqb3I6IHZlcnNpb25NYWpvcixcbiAgICAgICAgbWlub3I6IHZlcnNpb25NaW5vcixcbiAgICAgICAgcGF0Y2g6IHZlcnNpb25QYXRjaCxcbiAgICAgICAgcHJlUmVsZWFzZTogdmVyc2lvblByZVJlbGVhc2UgPT0gbnVsbCA/IHZvaWQgMCA6IHZlcnNpb25QcmVSZWxlYXNlLnNwbGl0KCcuJylcbiAgICB9O1xuICAgIGZvciAodmFyIGNvbXBhcmF0b3Igb2YgY29tcGFyYXRvcnMpe1xuICAgICAgICB2YXIgZXh0cmFjdGVkQ29tcGFyYXRvciA9IGV4dHJhY3RDb21wYXJhdG9yKGNvbXBhcmF0b3IpO1xuICAgICAgICBpZiAoIWV4dHJhY3RlZENvbXBhcmF0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX2V4dHJhY3RlZENvbXBhcmF0b3IgPSBfc2xpY2VkX3RvX2FycmF5Ll8oZXh0cmFjdGVkQ29tcGFyYXRvciwgNyksIHJhbmdlT3BlcmF0b3IgPSBfZXh0cmFjdGVkQ29tcGFyYXRvclsxXSwgcmFuZ2VNYWpvciA9IF9leHRyYWN0ZWRDb21wYXJhdG9yWzNdLCByYW5nZU1pbm9yID0gX2V4dHJhY3RlZENvbXBhcmF0b3JbNF0sIHJhbmdlUGF0Y2ggPSBfZXh0cmFjdGVkQ29tcGFyYXRvcls1XSwgcmFuZ2VQcmVSZWxlYXNlID0gX2V4dHJhY3RlZENvbXBhcmF0b3JbNl07XG4gICAgICAgIHZhciByYW5nZUF0b20gPSB7XG4gICAgICAgICAgICBvcGVyYXRvcjogcmFuZ2VPcGVyYXRvcixcbiAgICAgICAgICAgIHZlcnNpb246IGNvbWJpbmVWZXJzaW9uKHJhbmdlTWFqb3IsIHJhbmdlTWlub3IsIHJhbmdlUGF0Y2gsIHJhbmdlUHJlUmVsZWFzZSksXG4gICAgICAgICAgICBtYWpvcjogcmFuZ2VNYWpvcixcbiAgICAgICAgICAgIG1pbm9yOiByYW5nZU1pbm9yLFxuICAgICAgICAgICAgcGF0Y2g6IHJhbmdlUGF0Y2gsXG4gICAgICAgICAgICBwcmVSZWxlYXNlOiByYW5nZVByZVJlbGVhc2UgPT0gbnVsbCA/IHZvaWQgMCA6IHJhbmdlUHJlUmVsZWFzZS5zcGxpdCgnLicpXG4gICAgICAgIH07XG4gICAgICAgIGlmICghY29tcGFyZShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBlYXJseSByZXR1cm5cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIGZvcm1hdFNoYXJlKHNoYXJlQXJncywgZnJvbSwgbmFtZTEsIHNoYXJlU3RyYXRlZ3kpIHtcbiAgICB2YXIgZ2V0O1xuICAgIGlmICgnZ2V0JyBpbiBzaGFyZUFyZ3MpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1kZXN0cnVjdHVyaW5nXG4gICAgICAgIGdldCA9IHNoYXJlQXJncy5nZXQ7XG4gICAgfSBlbHNlIGlmICgnbGliJyBpbiBzaGFyZUFyZ3MpIHtcbiAgICAgICAgZ2V0ID0gKCk9PlByb21pc2UucmVzb2x2ZShzaGFyZUFyZ3MubGliKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBnZXQgPSAoKT0+UHJvbWlzZS5yZXNvbHZlKCgpPT57XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW4gbm90IGdldCBzaGFyZWQgJyR7bmFtZTF9JyFgKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoc2hhcmVBcmdzLnN0cmF0ZWd5KSB7XG4gICAgICAgIHdhcm4oYFwic2hhcmVkLnN0cmF0ZWd5IGlzIGRlcHJlY2F0ZWQsIHBsZWFzZSBzZXQgaW4gaW5pdE9wdGlvbnMuc2hhcmVTdHJhdGVneSBpbnN0ZWFkIVwiYCk7XG4gICAgfVxuICAgIHZhciBfc2hhcmVBcmdzX3ZlcnNpb24sIF9zaGFyZUFyZ3Nfc2NvcGUsIF9zaGFyZUFyZ3Nfc3RyYXRlZ3k7XG4gICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7XG4gICAgICAgIGRlcHM6IFtdLFxuICAgICAgICB1c2VJbjogW10sXG4gICAgICAgIGZyb20sXG4gICAgICAgIGxvYWRpbmc6IG51bGxcbiAgICB9LCBzaGFyZUFyZ3MsIHtcbiAgICAgICAgc2hhcmVDb25maWc6IHBvbHlmaWxscy5fZXh0ZW5kcyh7XG4gICAgICAgICAgICByZXF1aXJlZFZlcnNpb246IGBeJHtzaGFyZUFyZ3MudmVyc2lvbn1gLFxuICAgICAgICAgICAgc2luZ2xldG9uOiBmYWxzZSxcbiAgICAgICAgICAgIGVhZ2VyOiBmYWxzZSxcbiAgICAgICAgICAgIHN0cmljdFZlcnNpb246IGZhbHNlXG4gICAgICAgIH0sIHNoYXJlQXJncy5zaGFyZUNvbmZpZyksXG4gICAgICAgIGdldCxcbiAgICAgICAgbG9hZGVkOiAoc2hhcmVBcmdzID09IG51bGwgPyB2b2lkIDAgOiBzaGFyZUFyZ3MubG9hZGVkKSB8fCAnbGliJyBpbiBzaGFyZUFyZ3MgPyB0cnVlIDogdW5kZWZpbmVkLFxuICAgICAgICB2ZXJzaW9uOiAoX3NoYXJlQXJnc192ZXJzaW9uID0gc2hhcmVBcmdzLnZlcnNpb24pICE9IG51bGwgPyBfc2hhcmVBcmdzX3ZlcnNpb24gOiAnMCcsXG4gICAgICAgIHNjb3BlOiBBcnJheS5pc0FycmF5KHNoYXJlQXJncy5zY29wZSkgPyBzaGFyZUFyZ3Muc2NvcGUgOiBbXG4gICAgICAgICAgICAoX3NoYXJlQXJnc19zY29wZSA9IHNoYXJlQXJncy5zY29wZSkgIT0gbnVsbCA/IF9zaGFyZUFyZ3Nfc2NvcGUgOiAnZGVmYXVsdCdcbiAgICAgICAgXSxcbiAgICAgICAgc3RyYXRlZ3k6ICgoX3NoYXJlQXJnc19zdHJhdGVneSA9IHNoYXJlQXJncy5zdHJhdGVneSkgIT0gbnVsbCA/IF9zaGFyZUFyZ3Nfc3RyYXRlZ3kgOiBzaGFyZVN0cmF0ZWd5KSB8fCAndmVyc2lvbi1maXJzdCdcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGZvcm1hdFNoYXJlQ29uZmlncyhnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucykge1xuICAgIHZhciBzaGFyZUFyZ3MgPSB1c2VyT3B0aW9ucy5zaGFyZWQgfHwge307XG4gICAgdmFyIGZyb20gPSB1c2VyT3B0aW9ucy5uYW1lO1xuICAgIHZhciBzaGFyZUluZm9zID0gT2JqZWN0LmtleXMoc2hhcmVBcmdzKS5yZWR1Y2UoKHJlcywgcGtnTmFtZSk9PntcbiAgICAgICAgdmFyIGFycmF5U2hhcmVBcmdzID0gYXJyYXlPcHRpb25zKHNoYXJlQXJnc1twa2dOYW1lXSk7XG4gICAgICAgIHJlc1twa2dOYW1lXSA9IHJlc1twa2dOYW1lXSB8fCBbXTtcbiAgICAgICAgYXJyYXlTaGFyZUFyZ3MuZm9yRWFjaCgoc2hhcmVDb25maWcpPT57XG4gICAgICAgICAgICByZXNbcGtnTmFtZV0ucHVzaChmb3JtYXRTaGFyZShzaGFyZUNvbmZpZywgZnJvbSwgcGtnTmFtZSwgdXNlck9wdGlvbnMuc2hhcmVTdHJhdGVneSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9LCB7fSk7XG4gICAgdmFyIHNoYXJlZCA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgZ2xvYmFsT3B0aW9ucy5zaGFyZWQpO1xuICAgIE9iamVjdC5rZXlzKHNoYXJlSW5mb3MpLmZvckVhY2goKHNoYXJlS2V5KT0+e1xuICAgICAgICBpZiAoIXNoYXJlZFtzaGFyZUtleV0pIHtcbiAgICAgICAgICAgIHNoYXJlZFtzaGFyZUtleV0gPSBzaGFyZUluZm9zW3NoYXJlS2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNoYXJlSW5mb3Nbc2hhcmVLZXldLmZvckVhY2goKG5ld1VzZXJTaGFyZWRPcHRpb25zKT0+e1xuICAgICAgICAgICAgICAgIHZhciBpc1NhbWVWZXJzaW9uID0gc2hhcmVkW3NoYXJlS2V5XS5maW5kKChzaGFyZWRWYWwpPT5zaGFyZWRWYWwudmVyc2lvbiA9PT0gbmV3VXNlclNoYXJlZE9wdGlvbnMudmVyc2lvbik7XG4gICAgICAgICAgICAgICAgaWYgKCFpc1NhbWVWZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZFtzaGFyZUtleV0ucHVzaChuZXdVc2VyU2hhcmVkT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzaGFyZWQsXG4gICAgICAgIHNoYXJlSW5mb3NcbiAgICB9O1xufVxuZnVuY3Rpb24gdmVyc2lvbkx0KGEsIGIpIHtcbiAgICB2YXIgdHJhbnNmb3JtSW52YWxpZFZlcnNpb24gPSAodmVyc2lvbik9PntcbiAgICAgICAgdmFyIGlzTnVtYmVyVmVyc2lvbiA9ICFOdW1iZXIuaXNOYU4oTnVtYmVyKHZlcnNpb24pKTtcbiAgICAgICAgaWYgKGlzTnVtYmVyVmVyc2lvbikge1xuICAgICAgICAgICAgdmFyIHNwbGl0QXJyID0gdmVyc2lvbi5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIHZhbGlkVmVyc2lvbiA9IHZlcnNpb247XG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgMyAtIHNwbGl0QXJyLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICB2YWxpZFZlcnNpb24gKz0gJy4wJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWxpZFZlcnNpb247XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZlcnNpb247XG4gICAgfTtcbiAgICBpZiAoc2F0aXNmeSh0cmFuc2Zvcm1JbnZhbGlkVmVyc2lvbihhKSwgYDw9JHt0cmFuc2Zvcm1JbnZhbGlkVmVyc2lvbihiKX1gKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxudmFyIGZpbmRWZXJzaW9uID0gKHNoYXJlVmVyc2lvbk1hcCwgY2IpPT57XG4gICAgdmFyIGNhbGxiYWNrID0gY2IgfHwgZnVuY3Rpb24ocHJldiwgY3VyKSB7XG4gICAgICAgIHJldHVybiB2ZXJzaW9uTHQocHJldiwgY3VyKTtcbiAgICB9O1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhzaGFyZVZlcnNpb25NYXApLnJlZHVjZSgocHJldiwgY3VyKT0+e1xuICAgICAgICBpZiAoIXByZXYpIHtcbiAgICAgICAgICAgIHJldHVybiBjdXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhbGxiYWNrKHByZXYsIGN1cikpIHtcbiAgICAgICAgICAgIHJldHVybiBjdXI7XG4gICAgICAgIH1cbiAgICAgICAgLy8gZGVmYXVsdCB2ZXJzaW9uIGlzICcwJyBodHRwczovL2dpdGh1Yi5jb20vd2VicGFjay93ZWJwYWNrL2Jsb2IvbWFpbi9saWIvc2hhcmluZy9Qcm92aWRlU2hhcmVkTW9kdWxlLmpzI0wxMzZcbiAgICAgICAgaWYgKHByZXYgPT09ICcwJykge1xuICAgICAgICAgICAgcmV0dXJuIGN1cjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJldjtcbiAgICB9LCAwKTtcbn07XG52YXIgaXNMb2FkZWQgPSAoc2hhcmVkKT0+e1xuICAgIHJldHVybiBCb29sZWFuKHNoYXJlZC5sb2FkZWQpIHx8IHR5cGVvZiBzaGFyZWQubGliID09PSAnZnVuY3Rpb24nO1xufTtcbnZhciBpc0xvYWRpbmcgPSAoc2hhcmVkKT0+e1xuICAgIHJldHVybiBCb29sZWFuKHNoYXJlZC5sb2FkaW5nKTtcbn07XG5mdW5jdGlvbiBmaW5kU2luZ2xldG9uVmVyc2lvbk9yZGVyQnlWZXJzaW9uKHNoYXJlU2NvcGVNYXAsIHNjb3BlLCBwa2dOYW1lKSB7XG4gICAgdmFyIHZlcnNpb25zID0gc2hhcmVTY29wZU1hcFtzY29wZV1bcGtnTmFtZV07XG4gICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24ocHJldiwgY3VyKSB7XG4gICAgICAgIHJldHVybiAhaXNMb2FkZWQodmVyc2lvbnNbcHJldl0pICYmIHZlcnNpb25MdChwcmV2LCBjdXIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZpbmRWZXJzaW9uKHNoYXJlU2NvcGVNYXBbc2NvcGVdW3BrZ05hbWVdLCBjYWxsYmFjayk7XG59XG5mdW5jdGlvbiBmaW5kU2luZ2xldG9uVmVyc2lvbk9yZGVyQnlMb2FkZWQoc2hhcmVTY29wZU1hcCwgc2NvcGUsIHBrZ05hbWUpIHtcbiAgICB2YXIgdmVyc2lvbnMgPSBzaGFyZVNjb3BlTWFwW3Njb3BlXVtwa2dOYW1lXTtcbiAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgdmFyIGlzTG9hZGluZ09yTG9hZGVkID0gKHNoYXJlZCk9PntcbiAgICAgICAgICAgIHJldHVybiBpc0xvYWRlZChzaGFyZWQpIHx8IGlzTG9hZGluZyhzaGFyZWQpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoaXNMb2FkaW5nT3JMb2FkZWQodmVyc2lvbnNbY3VyXSkpIHtcbiAgICAgICAgICAgIGlmIChpc0xvYWRpbmdPckxvYWRlZCh2ZXJzaW9uc1twcmV2XSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbih2ZXJzaW9uTHQocHJldiwgY3VyKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpc0xvYWRpbmdPckxvYWRlZCh2ZXJzaW9uc1twcmV2XSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmVyc2lvbkx0KHByZXYsIGN1cik7XG4gICAgfTtcbiAgICByZXR1cm4gZmluZFZlcnNpb24oc2hhcmVTY29wZU1hcFtzY29wZV1bcGtnTmFtZV0sIGNhbGxiYWNrKTtcbn1cbmZ1bmN0aW9uIGdldEZpbmRTaGFyZUZ1bmN0aW9uKHN0cmF0ZWd5KSB7XG4gICAgaWYgKHN0cmF0ZWd5ID09PSAnbG9hZGVkLWZpcnN0Jykge1xuICAgICAgICByZXR1cm4gZmluZFNpbmdsZXRvblZlcnNpb25PcmRlckJ5TG9hZGVkO1xuICAgIH1cbiAgICByZXR1cm4gZmluZFNpbmdsZXRvblZlcnNpb25PcmRlckJ5VmVyc2lvbjtcbn1cbmZ1bmN0aW9uIGdldFJlZ2lzdGVyZWRTaGFyZShsb2NhbFNoYXJlU2NvcGVNYXAsIHBrZ05hbWUsIHNoYXJlSW5mbywgcmVzb2x2ZVNoYXJlKSB7XG4gICAgdmFyIF9sb29wID0gZnVuY3Rpb24oc2MpIHtcbiAgICAgICAgaWYgKHNoYXJlQ29uZmlnICYmIGxvY2FsU2hhcmVTY29wZU1hcFtzY10gJiYgbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXSkge1xuICAgICAgICAgICAgdmFyIHJlcXVpcmVkVmVyc2lvbiA9IHNoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbjtcbiAgICAgICAgICAgIHZhciBmaW5kU2hhcmVGdW5jdGlvbiA9IGdldEZpbmRTaGFyZUZ1bmN0aW9uKHN0cmF0ZWd5KTtcbiAgICAgICAgICAgIHZhciBtYXhPclNpbmdsZXRvblZlcnNpb24gPSBmaW5kU2hhcmVGdW5jdGlvbihsb2NhbFNoYXJlU2NvcGVNYXAsIHNjLCBwa2dOYW1lKTtcbiAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgdmFyIGRlZmF1bHRSZXNvbHZlciA9ICgpPT57XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlQ29uZmlnLnNpbmdsZXRvbikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlcXVpcmVkVmVyc2lvbiA9PT0gJ3N0cmluZycgJiYgIXNhdGlzZnkobWF4T3JTaW5nbGV0b25WZXJzaW9uLCByZXF1aXJlZFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXNnID0gYFZlcnNpb24gJHttYXhPclNpbmdsZXRvblZlcnNpb259IGZyb20gJHttYXhPclNpbmdsZXRvblZlcnNpb24gJiYgbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVttYXhPclNpbmdsZXRvblZlcnNpb25dLmZyb219IG9mIHNoYXJlZCBzaW5nbGV0b24gbW9kdWxlICR7cGtnTmFtZX0gZG9lcyBub3Qgc2F0aXNmeSB0aGUgcmVxdWlyZW1lbnQgb2YgJHtzaGFyZUluZm8uZnJvbX0gd2hpY2ggbmVlZHMgJHtyZXF1aXJlZFZlcnNpb259KWA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKG1zZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4obXNnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVttYXhPclNpbmdsZXRvblZlcnNpb25dO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXF1aXJlZFZlcnNpb24gPT09IGZhbHNlIHx8IHJlcXVpcmVkVmVyc2lvbiA9PT0gJyonKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVttYXhPclNpbmdsZXRvblZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzYXRpc2Z5KG1heE9yU2luZ2xldG9uVmVyc2lvbiwgcmVxdWlyZWRWZXJzaW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsU2hhcmVTY29wZU1hcFtzY11bcGtnTmFtZV1bbWF4T3JTaW5nbGV0b25WZXJzaW9uXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMobG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXSkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgdmVyc2lvbktleSA9IF9yZWZbMF0sIHZlcnNpb25WYWx1ZSA9IF9yZWZbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2F0aXNmeSh2ZXJzaW9uS2V5LCByZXF1aXJlZFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZlcnNpb25WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIHNoYXJlU2NvcGVNYXA6IGxvY2FsU2hhcmVTY29wZU1hcCxcbiAgICAgICAgICAgICAgICBzY29wZTogc2MsXG4gICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBtYXhPclNpbmdsZXRvblZlcnNpb24sXG4gICAgICAgICAgICAgICAgR2xvYmFsRmVkZXJhdGlvbjogR2xvYmFsLl9fRkVERVJBVElPTl9fLFxuICAgICAgICAgICAgICAgIHJlc29sdmVyOiBkZWZhdWx0UmVzb2x2ZXJcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcmVzb2x2ZVNoYXJlZCA9IHJlc29sdmVTaGFyZS5lbWl0KHBhcmFtcykgfHwgcGFyYW1zO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2OiByZXNvbHZlU2hhcmVkLnJlc29sdmVyKClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGlmICghbG9jYWxTaGFyZVNjb3BlTWFwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHNoYXJlQ29uZmlnID0gc2hhcmVJbmZvLnNoYXJlQ29uZmlnLCBfc2hhcmVJbmZvX3Njb3BlID0gc2hhcmVJbmZvLnNjb3BlLCBzY29wZSA9IF9zaGFyZUluZm9fc2NvcGUgPT09IHZvaWQgMCA/IERFRkFVTFRfU0NPUEUgOiBfc2hhcmVJbmZvX3Njb3BlLCBzdHJhdGVneSA9IHNoYXJlSW5mby5zdHJhdGVneTtcbiAgICB2YXIgc2NvcGVzID0gQXJyYXkuaXNBcnJheShzY29wZSkgPyBzY29wZSA6IFtcbiAgICAgICAgc2NvcGVcbiAgICBdO1xuICAgIGZvciAodmFyIHNjIG9mIHNjb3Blcyl7XG4gICAgICAgIHZhciBfcmV0ID0gX2xvb3Aoc2MpO1xuICAgICAgICBpZiAoX3R5cGVfb2YuXyhfcmV0KSA9PT0gXCJvYmplY3RcIikgcmV0dXJuIF9yZXQudjtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRHbG9iYWxTaGFyZVNjb3BlKCkge1xuICAgIHJldHVybiBHbG9iYWwuX19GRURFUkFUSU9OX18uX19TSEFSRV9fO1xufVxuZnVuY3Rpb24gZ2V0VGFyZ2V0U2hhcmVkT3B0aW9ucyhvcHRpb25zKSB7XG4gICAgdmFyIHBrZ05hbWUgPSBvcHRpb25zLnBrZ05hbWUsIGV4dHJhT3B0aW9ucyA9IG9wdGlvbnMuZXh0cmFPcHRpb25zLCBzaGFyZUluZm9zID0gb3B0aW9ucy5zaGFyZUluZm9zO1xuICAgIHZhciBkZWZhdWx0UmVzb2x2ZXIgPSAoc2hhcmVkT3B0aW9ucyk9PntcbiAgICAgICAgaWYgKCFzaGFyZWRPcHRpb25zKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzaGFyZVZlcnNpb25NYXAgPSB7fTtcbiAgICAgICAgc2hhcmVkT3B0aW9ucy5mb3JFYWNoKChzaGFyZWQpPT57XG4gICAgICAgICAgICBzaGFyZVZlcnNpb25NYXBbc2hhcmVkLnZlcnNpb25dID0gc2hhcmVkO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24ocHJldiwgY3VyKSB7XG4gICAgICAgICAgICByZXR1cm4gIWlzTG9hZGVkKHNoYXJlVmVyc2lvbk1hcFtwcmV2XSkgJiYgdmVyc2lvbkx0KHByZXYsIGN1cik7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBtYXhWZXJzaW9uID0gZmluZFZlcnNpb24oc2hhcmVWZXJzaW9uTWFwLCBjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiBzaGFyZVZlcnNpb25NYXBbbWF4VmVyc2lvbl07XG4gICAgfTtcbiAgICB2YXIgX2V4dHJhT3B0aW9uc19yZXNvbHZlcjtcbiAgICB2YXIgcmVzb2x2ZXIgPSAoX2V4dHJhT3B0aW9uc19yZXNvbHZlciA9IGV4dHJhT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZXh0cmFPcHRpb25zLnJlc29sdmVyKSAhPSBudWxsID8gX2V4dHJhT3B0aW9uc19yZXNvbHZlciA6IGRlZmF1bHRSZXNvbHZlcjtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgcmVzb2x2ZXIoc2hhcmVJbmZvc1twa2dOYW1lXSksIGV4dHJhT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZXh0cmFPcHRpb25zLmN1c3RvbVNoYXJlSW5mbyk7XG59XG52YXIgU2hhcmVVdGlscyA9IHtcbiAgICBnZXRSZWdpc3RlcmVkU2hhcmUsXG4gICAgZ2V0R2xvYmFsU2hhcmVTY29wZVxufTtcbnZhciBHbG9iYWxVdGlscyA9IHtcbiAgICBHbG9iYWwsXG4gICAgbmF0aXZlR2xvYmFsLFxuICAgIHJlc2V0RmVkZXJhdGlvbkdsb2JhbEluZm8sXG4gICAgc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlLFxuICAgIGdldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcixcbiAgICBzZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IsXG4gICAgZ2V0SW5mb1dpdGhvdXRUeXBlLFxuICAgIGdldEdsb2JhbFNuYXBzaG90LFxuICAgIGdldFRhcmdldFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyxcbiAgICBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8sXG4gICAgc2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvLFxuICAgIGFkZEdsb2JhbFNuYXBzaG90LFxuICAgIGdldFJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICByZWdpc3Rlckdsb2JhbFBsdWdpbnMsXG4gICAgZ2V0R2xvYmFsSG9zdFBsdWdpbnMsXG4gICAgZ2V0UHJlbG9hZGVkLFxuICAgIHNldFByZWxvYWRlZFxufTtcbnZhciBoZWxwZXJzID0ge1xuICAgIGdsb2JhbDogR2xvYmFsVXRpbHMsXG4gICAgc2hhcmU6IFNoYXJlVXRpbHNcbn07XG5mdW5jdGlvbiBnZXRCdWlsZGVySWQoKSB7XG4gICAgLy9AdHMtaWdub3JlXG4gICAgcmV0dXJuICB0cnVlID8gXCJzcG9ydHM6MS4wLjBcIiA6IDA7XG59XG4vLyBGdW5jdGlvbiB0byBtYXRjaCBhIHJlbW90ZSB3aXRoIGl0cyBuYW1lIGFuZCBleHBvc2Vcbi8vIGlkOiBwa2dOYW1lKEBmZWRlcmF0aW9uL2FwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBAZmVkZXJhdGlvbi9hcHAxL2J1dHRvblxuLy8gaWQ6IGFsaWFzKGFwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBhcHAxL2J1dHRvblxuLy8gaWQ6IGFsaWFzKGFwcDEvdXRpbHMpICsgZXhwb3NlKGxvYWRhc2gvc29ydCkgPSBhcHAxL3V0aWxzL2xvYWRhc2gvc29ydFxuZnVuY3Rpb24gbWF0Y2hSZW1vdGVXaXRoTmFtZUFuZEV4cG9zZShyZW1vdGVzLCBpZCkge1xuICAgIGZvciAodmFyIHJlbW90ZSBvZiByZW1vdGVzKXtcbiAgICAgICAgLy8gbWF0Y2ggcGtnTmFtZVxuICAgICAgICB2YXIgaXNOYW1lTWF0Y2hlZCA9IGlkLnN0YXJ0c1dpdGgocmVtb3RlLm5hbWUpO1xuICAgICAgICB2YXIgZXhwb3NlID0gaWQucmVwbGFjZShyZW1vdGUubmFtZSwgJycpO1xuICAgICAgICBpZiAoaXNOYW1lTWF0Y2hlZCkge1xuICAgICAgICAgICAgaWYgKGV4cG9zZS5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGtnTmFtZU9yQWxpYXMgPSByZW1vdGUubmFtZTtcbiAgICAgICAgICAgICAgICBleHBvc2UgPSBgLiR7ZXhwb3NlfWA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcGtnTmFtZU9yQWxpYXMsXG4gICAgICAgICAgICAgICAgICAgIGV4cG9zZSxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhwb3NlID09PSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzOiByZW1vdGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlOiAnLicsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gbWF0Y2ggYWxpYXNcbiAgICAgICAgdmFyIGlzQWxpYXNNYXRjaGVkID0gcmVtb3RlLmFsaWFzICYmIGlkLnN0YXJ0c1dpdGgocmVtb3RlLmFsaWFzKTtcbiAgICAgICAgdmFyIGV4cG9zZVdpdGhBbGlhcyA9IHJlbW90ZS5hbGlhcyAmJiBpZC5yZXBsYWNlKHJlbW90ZS5hbGlhcywgJycpO1xuICAgICAgICBpZiAocmVtb3RlLmFsaWFzICYmIGlzQWxpYXNNYXRjaGVkKSB7XG4gICAgICAgICAgICBpZiAoZXhwb3NlV2l0aEFsaWFzICYmIGV4cG9zZVdpdGhBbGlhcy5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGtnTmFtZU9yQWxpYXMxID0gcmVtb3RlLmFsaWFzO1xuICAgICAgICAgICAgICAgIGV4cG9zZVdpdGhBbGlhcyA9IGAuJHtleHBvc2VXaXRoQWxpYXN9YDtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwa2dOYW1lT3JBbGlhczogcGtnTmFtZU9yQWxpYXMxLFxuICAgICAgICAgICAgICAgICAgICBleHBvc2U6IGV4cG9zZVdpdGhBbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhwb3NlV2l0aEFsaWFzID09PSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzOiByZW1vdGUuYWxpYXMsXG4gICAgICAgICAgICAgICAgICAgIGV4cG9zZTogJy4nLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybjtcbn1cbi8vIEZ1bmN0aW9uIHRvIG1hdGNoIGEgcmVtb3RlIHdpdGggaXRzIG5hbWUgb3IgYWxpYXNcbmZ1bmN0aW9uIG1hdGNoUmVtb3RlKHJlbW90ZXMsIG5hbWVPckFsaWFzKSB7XG4gICAgZm9yICh2YXIgcmVtb3RlIG9mIHJlbW90ZXMpe1xuICAgICAgICB2YXIgaXNOYW1lTWF0Y2hlZCA9IG5hbWVPckFsaWFzID09PSByZW1vdGUubmFtZTtcbiAgICAgICAgaWYgKGlzTmFtZU1hdGNoZWQpIHtcbiAgICAgICAgICAgIHJldHVybiByZW1vdGU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlzQWxpYXNNYXRjaGVkID0gcmVtb3RlLmFsaWFzICYmIG5hbWVPckFsaWFzID09PSByZW1vdGUuYWxpYXM7XG4gICAgICAgIGlmIChpc0FsaWFzTWF0Y2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm47XG59XG5mdW5jdGlvbiByZWdpc3RlclBsdWdpbnMocGx1Z2lucywgaG9va0luc3RhbmNlcykge1xuICAgIHZhciBnbG9iYWxQbHVnaW5zID0gZ2V0R2xvYmFsSG9zdFBsdWdpbnMoKTtcbiAgICAvLyBJbmNvcnBvcmF0ZSBnbG9iYWwgcGx1Z2luc1xuICAgIGlmIChnbG9iYWxQbHVnaW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZ2xvYmFsUGx1Z2lucy5mb3JFYWNoKChwbHVnaW4pPT57XG4gICAgICAgICAgICBpZiAocGx1Z2lucyA9PSBudWxsID8gdm9pZCAwIDogcGx1Z2lucy5maW5kKChpdGVtKT0+aXRlbS5uYW1lICE9PSBwbHVnaW4ubmFtZSkpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW5zLnB1c2gocGx1Z2luKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChwbHVnaW5zICYmIHBsdWdpbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBwbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgICAgIGhvb2tJbnN0YW5jZXMuZm9yRWFjaCgoaG9va0luc3RhbmNlKT0+e1xuICAgICAgICAgICAgICAgIGhvb2tJbnN0YW5jZS5hcHBseVBsdWdpbihwbHVnaW4pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcGx1Z2lucztcbn1cbmZ1bmN0aW9uIGxvYWRFc21FbnRyeShfMCkge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKHJlZikge1xuICAgICAgICB2YXIgZW50cnkgPSByZWYuZW50cnksIHJlbW90ZUVudHJ5RXhwb3J0cyA9IHJlZi5yZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+e1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoIXJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEZ1bmN0aW9uKCdjYWxsYmFja3MnLCBgaW1wb3J0KFwiJHtlbnRyeX1cIikudGhlbihjYWxsYmFja3NbMF0pLmNhdGNoKGNhbGxiYWNrc1sxXSlgKShbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge31cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlbW90ZUVudHJ5RXhwb3J0cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIGxvYWRTeXN0ZW1Kc0VudHJ5KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHJlZi5lbnRyeSwgcmVtb3RlRW50cnlFeHBvcnRzID0gcmVmLnJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpPT57XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghcmVtb3RlRW50cnlFeHBvcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmFsc2UpIHt9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEZ1bmN0aW9uKCdjYWxsYmFja3MnLCBgU3lzdGVtLmltcG9ydChcIiR7ZW50cnl9XCIpLnRoZW4oY2FsbGJhY2tzWzBdKS5jYXRjaChjYWxsYmFja3NbMV0pYCkoW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVtb3RlRW50cnlFeHBvcnRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gbG9hZEVudHJ5U2NyaXB0KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBuYW1lMSA9IHJlZi5uYW1lLCBnbG9iYWxOYW1lID0gcmVmLmdsb2JhbE5hbWUsIGVudHJ5ID0gcmVmLmVudHJ5LCBsb2FkZXJIb29rID0gcmVmLmxvYWRlckhvb2s7XG4gICAgICAgIHZhciBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzID0gZ2V0UmVtb3RlRW50cnlFeHBvcnRzKG5hbWUxLCBnbG9iYWxOYW1lKSwgcmVtb3RlRW50cnlFeHBvcnRzID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5lbnRyeUV4cG9ydHM7XG4gICAgICAgIGlmIChyZW1vdGVFbnRyeUV4cG9ydHMpIHtcbiAgICAgICAgICAgIHJldHVybiByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNkay5sb2FkU2NyaXB0KGVudHJ5LCB7XG4gICAgICAgICAgICBhdHRyczoge30sXG4gICAgICAgICAgICBjcmVhdGVTY3JpcHRIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gbG9hZGVySG9vay5saWZlY3ljbGUuY3JlYXRlU2NyaXB0LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXMpIHJldHVybjtcbiAgICAgICAgICAgICAgICBpZiAocmVzIGluc3RhbmNlb2YgSFRNTFNjcmlwdEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCdzY3JpcHQnIGluIHJlcyB8fCAndGltZW91dCcgaW4gcmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkudGhlbigoKT0+e1xuICAgICAgICAgICAgdmFyIF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMgPSBnZXRSZW1vdGVFbnRyeUV4cG9ydHMobmFtZTEsIGdsb2JhbE5hbWUpLCByZW1vdGVFbnRyeUtleSA9IF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMucmVtb3RlRW50cnlLZXksIGVudHJ5RXhwb3J0cyA9IF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMuZW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgYXNzZXJ0KGVudHJ5RXhwb3J0cywgZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDEsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICByZW1vdGVOYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICByZW1vdGVFbnRyeVVybDogZW50cnksXG4gICAgICAgICAgICAgICAgcmVtb3RlRW50cnlLZXlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJldHVybiBlbnRyeUV4cG9ydHM7XG4gICAgICAgIH0pLmNhdGNoKChlKT0+e1xuICAgICAgICAgICAgYXNzZXJ0KHVuZGVmaW5lZCwgZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDgsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICByZW1vdGVOYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICByZXNvdXJjZVVybDogZW50cnlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgIH0pO1xuICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBsb2FkRW50cnlEb20oXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSByZWYucmVtb3RlSW5mbywgcmVtb3RlRW50cnlFeHBvcnRzID0gcmVmLnJlbW90ZUVudHJ5RXhwb3J0cywgbG9hZGVySG9vayA9IHJlZi5sb2FkZXJIb29rO1xuICAgICAgICB2YXIgZW50cnkgPSByZW1vdGVJbmZvLmVudHJ5LCBnbG9iYWxOYW1lID0gcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUsIG5hbWUxID0gcmVtb3RlSW5mby5uYW1lLCB0eXBlID0gcmVtb3RlSW5mby50eXBlO1xuICAgICAgICBzd2l0Y2godHlwZSl7XG4gICAgICAgICAgICBjYXNlICdlc20nOlxuICAgICAgICAgICAgY2FzZSAnbW9kdWxlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZEVzbUVudHJ5KHtcbiAgICAgICAgICAgICAgICAgICAgZW50cnksXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0c1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY2FzZSAnc3lzdGVtJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZFN5c3RlbUpzRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICBlbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkRW50cnlTY3JpcHQoe1xuICAgICAgICAgICAgICAgICAgICBlbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgICAgIGxvYWRlckhvb2tcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBsb2FkRW50cnlOb2RlKF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciByZW1vdGVJbmZvID0gcmVmLnJlbW90ZUluZm8sIGxvYWRlckhvb2sgPSByZWYubG9hZGVySG9vaztcbiAgICAgICAgdmFyIGVudHJ5ID0gcmVtb3RlSW5mby5lbnRyeSwgZ2xvYmFsTmFtZSA9IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lLCBuYW1lMSA9IHJlbW90ZUluZm8ubmFtZSwgdHlwZSA9IHJlbW90ZUluZm8udHlwZTtcbiAgICAgICAgdmFyIF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMgPSBnZXRSZW1vdGVFbnRyeUV4cG9ydHMobmFtZTEsIGdsb2JhbE5hbWUpLCByZW1vdGVFbnRyeUV4cG9ydHMgPSBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzLmVudHJ5RXhwb3J0cztcbiAgICAgICAgaWYgKHJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2RrLmxvYWRTY3JpcHROb2RlKGVudHJ5LCB7XG4gICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIGdsb2JhbE5hbWUsXG4gICAgICAgICAgICAgICAgdHlwZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxvYWRlckhvb2s6IHtcbiAgICAgICAgICAgICAgICBjcmVhdGVTY3JpcHRIb29rOiAodXJsLCByZWYpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBhdHRycyA9IHJlZiA9PT0gdm9pZCAwID8ge30gOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBsb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVTY3JpcHQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyc1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXMpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCd1cmwnIGluIHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KS50aGVuKCgpPT57XG4gICAgICAgICAgICB2YXIgX2dldFJlbW90ZUVudHJ5RXhwb3J0cyA9IGdldFJlbW90ZUVudHJ5RXhwb3J0cyhuYW1lMSwgZ2xvYmFsTmFtZSksIHJlbW90ZUVudHJ5S2V5ID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5yZW1vdGVFbnRyeUtleSwgZW50cnlFeHBvcnRzID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5lbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICBhc3NlcnQoZW50cnlFeHBvcnRzLCBlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwMSwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgIHJlbW90ZU5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5VXJsOiBlbnRyeSxcbiAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUtleVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIGVudHJ5RXhwb3J0cztcbiAgICAgICAgfSkuY2F0Y2goKGUpPT57XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9KTtcbiAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gZ2V0UmVtb3RlRW50cnlVbmlxdWVLZXkocmVtb3RlSW5mbykge1xuICAgIHZhciBlbnRyeSA9IHJlbW90ZUluZm8uZW50cnksIG5hbWUxID0gcmVtb3RlSW5mby5uYW1lO1xuICAgIHJldHVybiBzZGsuY29tcG9zZUtleVdpdGhTZXBhcmF0b3IobmFtZTEsIGVudHJ5KTtcbn1cbmZ1bmN0aW9uIGdldFJlbW90ZUVudHJ5KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBvcmlnaW4gPSByZWYub3JpZ2luLCByZW1vdGVFbnRyeUV4cG9ydHMgPSByZWYucmVtb3RlRW50cnlFeHBvcnRzLCByZW1vdGVJbmZvID0gcmVmLnJlbW90ZUluZm87XG4gICAgICAgIHZhciB1bmlxdWVLZXkgPSBnZXRSZW1vdGVFbnRyeVVuaXF1ZUtleShyZW1vdGVJbmZvKTtcbiAgICAgICAgaWYgKHJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWdsb2JhbExvYWRpbmdbdW5pcXVlS2V5XSkge1xuICAgICAgICAgICAgdmFyIGxvYWRFbnRyeUhvb2sgPSBvcmlnaW4ucmVtb3RlSGFuZGxlci5ob29rcy5saWZlY3ljbGUubG9hZEVudHJ5O1xuICAgICAgICAgICAgdmFyIGxvYWRlckhvb2sgPSBvcmlnaW4ubG9hZGVySG9vaztcbiAgICAgICAgICAgIGdsb2JhbExvYWRpbmdbdW5pcXVlS2V5XSA9IGxvYWRFbnRyeUhvb2suZW1pdCh7XG4gICAgICAgICAgICAgICAgbG9hZGVySG9vayxcbiAgICAgICAgICAgICAgICByZW1vdGVJbmZvLFxuICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0c1xuICAgICAgICAgICAgfSkudGhlbigocmVzKT0+e1xuICAgICAgICAgICAgICAgIGlmIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNkay5pc0Jyb3dzZXJFbnYoKSA/IGxvYWRFbnRyeURvbSh7XG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVySG9va1xuICAgICAgICAgICAgICAgIH0pIDogbG9hZEVudHJ5Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIGxvYWRlckhvb2tcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBnbG9iYWxMb2FkaW5nW3VuaXF1ZUtleV07XG4gICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIGdldFJlbW90ZUluZm8ocmVtb3RlKSB7XG4gICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgcmVtb3RlLCB7XG4gICAgICAgIGVudHJ5OiAnZW50cnknIGluIHJlbW90ZSA/IHJlbW90ZS5lbnRyeSA6ICcnLFxuICAgICAgICB0eXBlOiByZW1vdGUudHlwZSB8fCBERUZBVUxUX1JFTU9URV9UWVBFLFxuICAgICAgICBlbnRyeUdsb2JhbE5hbWU6IHJlbW90ZS5lbnRyeUdsb2JhbE5hbWUgfHwgcmVtb3RlLm5hbWUsXG4gICAgICAgIHNoYXJlU2NvcGU6IHJlbW90ZS5zaGFyZVNjb3BlIHx8IERFRkFVTFRfU0NPUEVcbiAgICB9KTtcbn1cbnZhciBNb2R1bGUgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIE1vZHVsZShyZWYpIHtcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSByZWYucmVtb3RlSW5mbywgaG9zdCA9IHJlZi5ob3N0O1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIE1vZHVsZSk7XG4gICAgICAgIHRoaXMuaW5pdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubGliID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJlbW90ZUluZm8gPSByZW1vdGVJbmZvO1xuICAgICAgICB0aGlzLmhvc3QgPSBob3N0O1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oTW9kdWxlLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRFbnRyeVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEVudHJ5KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yZW1vdGVFbnRyeUV4cG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgZ2V0UmVtb3RlRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogdGhpcy5ob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IHRoaXMucmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHM6IHRoaXMucmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdW5pcXVlS2V5ID0gZ2V0UmVtb3RlRW50cnlVbmlxdWVLZXkodGhpcy5yZW1vdGVJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0cyA9IHlpZWxkIHRoaXMuaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5sb2FkRW50cnlFcnJvci5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRSZW1vdGVFbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMuaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvOiB0aGlzLnJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzOiB0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxMb2FkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXF1ZUtleVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHJlbW90ZUVudHJ5RXhwb3J0cywgYHJlbW90ZUVudHJ5RXhwb3J0cyBpcyB1bmRlZmluZWQgXFxuICR7c2RrLnNhZmVUb1N0cmluZyh0aGlzLnJlbW90ZUluZm8pfWApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cyA9IHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0KGlkLCBleHBvc2UsIG9wdGlvbnMsIHJlbW90ZVNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gb3B0aW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkRmFjdG9yeTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9LCBfcmVmX2xvYWRGYWN0b3J5ID0gX3JlZi5sb2FkRmFjdG9yeSwgbG9hZEZhY3RvcnkgPSBfcmVmX2xvYWRGYWN0b3J5ID09PSB2b2lkIDAgPyB0cnVlIDogX3JlZl9sb2FkRmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHJlbW90ZUVudHJ5LmpzXG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVFbnRyeUV4cG9ydHMgPSB5aWVsZCB0aGlzLmdldEVudHJ5KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbml0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbFNoYXJlU2NvcGVNYXAgPSB0aGlzLmhvc3Quc2hhcmVTY29wZU1hcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVTaGFyZVNjb3BlID0gdGhpcy5yZW1vdGVJbmZvLnNoYXJlU2NvcGUgfHwgJ2RlZmF1bHQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsb2NhbFNoYXJlU2NvcGVNYXBbcmVtb3RlU2hhcmVTY29wZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFNoYXJlU2NvcGVNYXBbcmVtb3RlU2hhcmVTY29wZV0gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlID0gbG9jYWxTaGFyZVNjb3BlTWFwW3JlbW90ZVNoYXJlU2NvcGVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRTY29wZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5yZW1vdGVJbmZvLnZlcnNpb24gfHwgJydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIZWxwIHRvIGZpbmQgaG9zdCBpbnN0YW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsICdzaGFyZVNjb3BlTWFwJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBsb2NhbFNoYXJlU2NvcGVNYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3RlRW50cnlJbml0T3B0aW9ucyB3aWxsIGJlIHRyYXZlcnNlZCBhbmQgYXNzaWduZWQgZHVyaW5nIGNvbnRhaW5lciBpbml0LCAsc28gdGhpcyBhdHRyaWJ1dGUgaXMgbm90IGFsbG93ZWQgdG8gYmUgdHJhdmVyc2VkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRDb250YWluZXJPcHRpb25zID0geWllbGQgdGhpcy5ob3N0Lmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVJbml0Q29udGFpbmVyLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSBzaGFyZVNjb3BlTWFwIHdpbGwgYmUgc2V0IGJ5IE9iamVjdC5kZWZpbmVQcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdFNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IHRoaXMucmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMuaG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIChyZW1vdGVFbnRyeUV4cG9ydHMgPT0gbnVsbCA/IHZvaWQgMCA6IHJlbW90ZUVudHJ5RXhwb3J0cy5pbml0KSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcihlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwMiwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVOYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeVVybDogdGhpcy5yZW1vdGVJbmZvLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUtleTogdGhpcy5yZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHJlbW90ZUVudHJ5RXhwb3J0cy5pbml0KGluaXRDb250YWluZXJPcHRpb25zLnNoYXJlU2NvcGUsIGluaXRDb250YWluZXJPcHRpb25zLmluaXRTY29wZSwgaW5pdENvbnRhaW5lck9wdGlvbnMucmVtb3RlRW50cnlJbml0T3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhvc3QuaG9va3MubGlmZWN5Y2xlLmluaXRDb250YWluZXIuZW1pdChwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGluaXRDb250YWluZXJPcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saWIgPSByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZUZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZUZhY3RvcnkgPSB5aWVsZCB0aGlzLmhvc3QubG9hZGVySG9vay5saWZlY3ljbGUuZ2V0TW9kdWxlRmFjdG9yeS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm86IHRoaXMucmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGV4cG9zZUdldHRlclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZHVsZUZhY3RvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUZhY3RvcnkgPSB5aWVsZCByZW1vdGVFbnRyeUV4cG9ydHMuZ2V0KGV4cG9zZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1vZHVsZUZhY3RvcnksIGAke2dldEZNSWQodGhpcy5yZW1vdGVJbmZvKX0gcmVtb3RlIGRvbid0IGV4cG9ydCAke2V4cG9zZX0uYCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGtlZXAgc3ltYm9sIGZvciBtb2R1bGUgbmFtZSBhbHdheXMgb25lIGZvcm1hdFxuICAgICAgICAgICAgICAgICAgICB2YXIgc3ltYm9sTmFtZSA9IHByb2Nlc3NNb2R1bGVBbGlhcyh0aGlzLnJlbW90ZUluZm8ubmFtZSwgZXhwb3NlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdyYXBNb2R1bGVGYWN0b3J5ID0gdGhpcy53cmFwZXJGYWN0b3J5KG1vZHVsZUZhY3RvcnksIHN5bWJvbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWxvYWRGYWN0b3J5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gd3JhcE1vZHVsZUZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4cG9zZUNvbnRlbnQgPSB5aWVsZCB3cmFwTW9kdWxlRmFjdG9yeSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhwb3NlQ29udGVudDtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwid3JhcGVyRmFjdG9yeVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdyYXBlckZhY3RvcnkobW9kdWxlRmFjdG9yeSwgaWQpIHtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZWZpbmVNb2R1bGVJZChyZXMsIGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgdHlwZW9mIHJlcyA9PT0gJ29iamVjdCcgJiYgT2JqZWN0LmlzRXh0ZW5zaWJsZShyZXMpICYmICFPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHJlcywgU3ltYm9sLmZvcignbWZfbW9kdWxlX2lkJykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVzLCBTeW1ib2wuZm9yKCdtZl9tb2R1bGVfaWQnKSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1vZHVsZUZhY3RvcnkgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0geWllbGQgbW9kdWxlRmFjdG9yeSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgcGFyYW1ldGVyIGlzIHVzZWQgZm9yIGJyaWRnZSBkZWJ1Z2dpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZpbmVNb2R1bGVJZChyZXMsIGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBtb2R1bGVGYWN0b3J5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHBhcmFtZXRlciBpcyB1c2VkIGZvciBicmlkZ2UgZGVidWdnaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZpbmVNb2R1bGVJZChyZXMsIGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIE1vZHVsZTtcbn0oKTtcbnZhciBTeW5jSG9vayA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gU3luY0hvb2sodHlwZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFN5bmNIb29rKTtcbiAgICAgICAgdGhpcy50eXBlID0gJyc7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gbmV3IFNldCgpO1xuICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oU3luY0hvb2ssIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcIm9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb24oZm4pIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLmFkZChmbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwib25jZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uY2UoZm4pIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXNcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5vbihmdW5jdGlvbiB3cmFwcGVyKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZW1vdmUod3JhcHBlcik7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImVtaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlbWl0KC4uLmRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxpc3RlbmVycy5zaXplID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLXNwcmVhZFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5mb3JFYWNoKChmbik9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZuLmFwcGx5KHZvaWQgMCwgX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhkYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVtb3ZlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlKGZuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnMuZGVsZXRlKGZuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlbW92ZUFsbFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUFsbCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5jbGVhcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFN5bmNIb29rO1xufSgpO1xudmFyIEFzeW5jSG9vayA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oU3luY0hvb2spIHtcbiAgICBfaW5oZXJpdHMuXyhBc3luY0hvb2ssIFN5bmNIb29rKTtcbiAgICBmdW5jdGlvbiBBc3luY0hvb2soKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgQXN5bmNIb29rKTtcbiAgICAgICAgcmV0dXJuIF9jYWxsX3N1cGVyLl8odGhpcywgQXN5bmNIb29rLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oQXN5bmNIb29rLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJlbWl0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZW1pdCguLi5kYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB2YXIgbHMgPSBBcnJheS5mcm9tKHRoaXMubGlzdGVuZXJzKTtcbiAgICAgICAgICAgICAgICBpZiAobHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjYWxsID0gKHByZXYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldiA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIEFib3J0IHByb2Nlc3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA8IGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobHNbaSsrXS5hcHBseShudWxsLCBkYXRhKSkudGhlbihjYWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNhbGwoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIEFzeW5jSG9vaztcbn0oU3luY0hvb2spO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXNcbmZ1bmN0aW9uIGNoZWNrUmV0dXJuRGF0YShvcmlnaW5hbERhdGEsIHJldHVybmVkRGF0YSkge1xuICAgIGlmICghaXNPYmplY3QocmV0dXJuZWREYXRhKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChvcmlnaW5hbERhdGEgIT09IHJldHVybmVkRGF0YSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1zeW50YXhcbiAgICAgICAgZm9yKHZhciBrZXkgaW4gb3JpZ2luYWxEYXRhKXtcbiAgICAgICAgICAgIGlmICghKGtleSBpbiByZXR1cm5lZERhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxudmFyIFN5bmNXYXRlcmZhbGxIb29rID0gLyojX19QVVJFX18qLyBmdW5jdGlvbihTeW5jSG9vaykge1xuICAgIF9pbmhlcml0cy5fKFN5bmNXYXRlcmZhbGxIb29rLCBTeW5jSG9vayk7XG4gICAgZnVuY3Rpb24gU3luY1dhdGVyZmFsbEhvb2sodHlwZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFN5bmNXYXRlcmZhbGxIb29rKTtcbiAgICAgICAgdmFyIF90aGlzO1xuICAgICAgICBfdGhpcyA9IF9jYWxsX3N1cGVyLl8odGhpcywgU3luY1dhdGVyZmFsbEhvb2spLCBfdGhpcy5vbmVycm9yID0gZXJyb3I7XG4gICAgICAgIF90aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTeW5jV2F0ZXJmYWxsSG9vaywgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZW1pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGVtaXQoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmICghaXNPYmplY3QoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IoYFRoZSBkYXRhIGZvciB0aGUgXCIke3RoaXMudHlwZX1cIiBob29rIHNob3VsZCBiZSBhbiBvYmplY3QuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGZuIG9mIHRoaXMubGlzdGVuZXJzKXtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wRGF0YSA9IGZuKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrUmV0dXJuRGF0YShkYXRhLCB0ZW1wRGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGVtcERhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25lcnJvcihgQSBwbHVnaW4gcmV0dXJuZWQgYW4gdW5hY2NlcHRhYmxlIHZhbHVlIGZvciB0aGUgXCIke3RoaXMudHlwZX1cIiB0eXBlLmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFN5bmNXYXRlcmZhbGxIb29rO1xufShTeW5jSG9vayk7XG52YXIgQXN5bmNXYXRlcmZhbGxIb29rID0gLyojX19QVVJFX18qLyBmdW5jdGlvbihTeW5jSG9vaykge1xuICAgIF9pbmhlcml0cy5fKEFzeW5jV2F0ZXJmYWxsSG9vaywgU3luY0hvb2spO1xuICAgIGZ1bmN0aW9uIEFzeW5jV2F0ZXJmYWxsSG9vayh0eXBlKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgQXN5bmNXYXRlcmZhbGxIb29rKTtcbiAgICAgICAgdmFyIF90aGlzO1xuICAgICAgICBfdGhpcyA9IF9jYWxsX3N1cGVyLl8odGhpcywgQXN5bmNXYXRlcmZhbGxIb29rKSwgX3RoaXMub25lcnJvciA9IGVycm9yO1xuICAgICAgICBfdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oQXN5bmNXYXRlcmZhbGxIb29rLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJlbWl0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZW1pdChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc09iamVjdChkYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcihgVGhlIHJlc3BvbnNlIGRhdGEgZm9yIHRoZSBcIiR7dGhpcy50eXBlfVwiIGhvb2sgbXVzdCBiZSBhbiBvYmplY3QuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBscyA9IEFycmF5LmZyb20odGhpcy5saXN0ZW5lcnMpO1xuICAgICAgICAgICAgICAgIGlmIChscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NFcnJvciA9IChlKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgd2FybihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25lcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FsbCA9IChwcmV2RGF0YSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGVja1JldHVybkRhdGEoZGF0YSwgcHJldkRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHByZXZEYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpIDwgbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGxzW2krK10oZGF0YSkpLnRoZW4oY2FsbCwgcHJvY2Vzc0Vycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NFcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGBBIHBsdWdpbiByZXR1cm5lZCBhbiBpbmNvcnJlY3QgdmFsdWUgZm9yIHRoZSBcIiR7dGhpcy50eXBlfVwiIHR5cGUuYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjYWxsKGRhdGEpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBBc3luY1dhdGVyZmFsbEhvb2s7XG59KFN5bmNIb29rKTtcbnZhciBQbHVnaW5TeXN0ZW0gPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIFBsdWdpblN5c3RlbShsaWZlY3ljbGUpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBQbHVnaW5TeXN0ZW0pO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyUGx1Z2lucyA9IHt9O1xuICAgICAgICB0aGlzLmxpZmVjeWNsZSA9IGxpZmVjeWNsZTtcbiAgICAgICAgdGhpcy5saWZlY3ljbGVLZXlzID0gT2JqZWN0LmtleXMobGlmZWN5Y2xlKTtcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFBsdWdpblN5c3RlbSwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiYXBwbHlQbHVnaW5cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseVBsdWdpbihwbHVnaW4pIHtcbiAgICAgICAgICAgICAgICBhc3NlcnQoaXNQbGFpbk9iamVjdChwbHVnaW4pLCAnUGx1Z2luIGNvbmZpZ3VyYXRpb24gaXMgaW52YWxpZC4nKTtcbiAgICAgICAgICAgICAgICAvLyBUaGUgcGx1Z2luJ3MgbmFtZSBpcyBtYW5kYXRvcnkgYW5kIG11c3QgYmUgdW5pcXVlXG4gICAgICAgICAgICAgICAgdmFyIHBsdWdpbk5hbWUgPSBwbHVnaW4ubmFtZTtcbiAgICAgICAgICAgICAgICBhc3NlcnQocGx1Z2luTmFtZSwgJ0EgbmFtZSBtdXN0IGJlIHByb3ZpZGVkIGJ5IHRoZSBwbHVnaW4uJyk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXSA9IHBsdWdpbjtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5saWZlY3ljbGUpLmZvckVhY2goKGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbHVnaW5MaWZlID0gcGx1Z2luW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGx1Z2luTGlmZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlmZWN5Y2xlW2tleV0ub24ocGx1Z2luTGlmZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlbW92ZVBsdWdpblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVBsdWdpbihwbHVnaW5OYW1lKSB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0KHBsdWdpbk5hbWUsICdBIG5hbWUgaXMgcmVxdWlyZWQuJyk7XG4gICAgICAgICAgICAgICAgdmFyIHBsdWdpbiA9IHRoaXMucmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdO1xuICAgICAgICAgICAgICAgIGFzc2VydChwbHVnaW4sIGBUaGUgcGx1Z2luIFwiJHtwbHVnaW5OYW1lfVwiIGlzIG5vdCByZWdpc3RlcmVkLmApO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHBsdWdpbikuZm9yRWFjaCgoa2V5KT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSAnbmFtZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlmZWN5Y2xlW2tleV0ucmVtb3ZlKHBsdWdpbltrZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXNoYWRvd1xuICAgICAgICAgICAga2V5OiBcImluaGVyaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbmhlcml0KHJlZikge1xuICAgICAgICAgICAgICAgIHZhciBsaWZlY3ljbGUgPSByZWYubGlmZWN5Y2xlLCByZWdpc3RlclBsdWdpbnMgPSByZWYucmVnaXN0ZXJQbHVnaW5zO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGxpZmVjeWNsZSkuZm9yRWFjaCgoaG9va05hbWUpPT57XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydCghdGhpcy5saWZlY3ljbGVbaG9va05hbWVdLCBgVGhlIGhvb2sgXCIke2hvb2tOYW1lfVwiIGhhcyBhIGNvbmZsaWN0IGFuZCBjYW5ub3QgYmUgaW5oZXJpdGVkLmApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpZmVjeWNsZVtob29rTmFtZV0gPSBsaWZlY3ljbGVbaG9va05hbWVdO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlZ2lzdGVyUGx1Z2lucykuZm9yRWFjaCgocGx1Z2luTmFtZSk9PntcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCF0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXSwgYFRoZSBwbHVnaW4gXCIke3BsdWdpbk5hbWV9XCIgaGFzIGEgY29uZmxpY3QgYW5kIGNhbm5vdCBiZSBpbmhlcml0ZWQuYCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlQbHVnaW4ocmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBQbHVnaW5TeXN0ZW07XG59KCk7XG5mdW5jdGlvbiBkZWZhdWx0UHJlbG9hZEFyZ3MocHJlbG9hZENvbmZpZykge1xuICAgIHJldHVybiBwb2x5ZmlsbHMuX2V4dGVuZHMoe1xuICAgICAgICByZXNvdXJjZUNhdGVnb3J5OiAnc3luYycsXG4gICAgICAgIHNoYXJlOiB0cnVlLFxuICAgICAgICBkZXBzUmVtb3RlOiB0cnVlLFxuICAgICAgICBwcmVmZXRjaEludGVyZmFjZTogZmFsc2VcbiAgICB9LCBwcmVsb2FkQ29uZmlnKTtcbn1cbmZ1bmN0aW9uIGZvcm1hdFByZWxvYWRBcmdzKHJlbW90ZXMsIHByZWxvYWRBcmdzKSB7XG4gICAgcmV0dXJuIHByZWxvYWRBcmdzLm1hcCgoYXJncyk9PntcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBtYXRjaFJlbW90ZShyZW1vdGVzLCBhcmdzLm5hbWVPckFsaWFzKTtcbiAgICAgICAgYXNzZXJ0KHJlbW90ZUluZm8sIGBVbmFibGUgdG8gcHJlbG9hZCAke2FyZ3MubmFtZU9yQWxpYXN9IGFzIGl0IGlzIG5vdCBpbmNsdWRlZCBpbiAkeyFyZW1vdGVJbmZvICYmIHNkay5zYWZlVG9TdHJpbmcoe1xuICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgIHJlbW90ZXNcbiAgICAgICAgfSl9YCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZW1vdGU6IHJlbW90ZUluZm8sXG4gICAgICAgICAgICBwcmVsb2FkQ29uZmlnOiBkZWZhdWx0UHJlbG9hZEFyZ3MoYXJncylcbiAgICAgICAgfTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZVByZWxvYWRFeHBvc2VzKGV4cG9zZXMpIHtcbiAgICBpZiAoIWV4cG9zZXMpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICByZXR1cm4gZXhwb3Nlcy5tYXAoKGV4cG9zZSk9PntcbiAgICAgICAgaWYgKGV4cG9zZSA9PT0gJy4nKSB7XG4gICAgICAgICAgICByZXR1cm4gZXhwb3NlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChleHBvc2Uuc3RhcnRzV2l0aCgnLi8nKSkge1xuICAgICAgICAgICAgcmV0dXJuIGV4cG9zZS5yZXBsYWNlKCcuLycsICcnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXhwb3NlO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gcHJlbG9hZEFzc2V0cyhyZW1vdGVJbmZvLCBob3N0LCBhc3NldHMsIHJlZikge1xuICAgIHZhciB1c2VMaW5rUHJlbG9hZCA9IHJlZiA9PT0gdm9pZCAwID8gdHJ1ZSA6IHJlZjtcbiAgICB2YXIgY3NzQXNzZXRzID0gYXNzZXRzLmNzc0Fzc2V0cywganNBc3NldHNXaXRob3V0RW50cnkgPSBhc3NldHMuanNBc3NldHNXaXRob3V0RW50cnksIGVudHJ5QXNzZXRzID0gYXNzZXRzLmVudHJ5QXNzZXRzO1xuICAgIGlmIChob3N0Lm9wdGlvbnMuaW5Ccm93c2VyKSB7XG4gICAgICAgIGVudHJ5QXNzZXRzLmZvckVhY2goKGFzc2V0KT0+e1xuICAgICAgICAgICAgdmFyIG1vZHVsZUluZm8gPSBhc3NldC5tb2R1bGVJbmZvO1xuICAgICAgICAgICAgdmFyIG1vZHVsZSA9IGhvc3QubW9kdWxlQ2FjaGUuZ2V0KHJlbW90ZUluZm8ubmFtZSk7XG4gICAgICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgZ2V0UmVtb3RlRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0czogbW9kdWxlLnJlbW90ZUVudHJ5RXhwb3J0c1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBnZXRSZW1vdGVFbnRyeSh7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbzogbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh1c2VMaW5rUHJlbG9hZCkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRBdHRycyA9IHtcbiAgICAgICAgICAgICAgICByZWw6ICdwcmVsb2FkJyxcbiAgICAgICAgICAgICAgICBhczogJ3N0eWxlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNzc0Fzc2V0cy5mb3JFYWNoKChjc3NVcmwpPT57XG4gICAgICAgICAgICAgICAgdmFyIF9zZGtfY3JlYXRlTGluayA9IHNkay5jcmVhdGVMaW5rKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBjc3NVcmwsXG4gICAgICAgICAgICAgICAgICAgIGNiOiAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAvLyBub29wXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzOiBkZWZhdWx0QXR0cnMsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxpbmtIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZUxpbmsuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MTGlua0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksIGNzc0VsID0gX3Nka19jcmVhdGVMaW5rLmxpbmssIG5lZWRBdHRhY2ggPSBfc2RrX2NyZWF0ZUxpbmsubmVlZEF0dGFjaDtcbiAgICAgICAgICAgICAgICBuZWVkQXR0YWNoICYmIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoY3NzRWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdEF0dHJzMSA9IHtcbiAgICAgICAgICAgICAgICByZWw6ICdzdHlsZXNoZWV0JyxcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dC9jc3MnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY3NzQXNzZXRzLmZvckVhY2goKGNzc1VybCk9PntcbiAgICAgICAgICAgICAgICB2YXIgX3Nka19jcmVhdGVMaW5rID0gc2RrLmNyZWF0ZUxpbmsoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGNzc1VybCxcbiAgICAgICAgICAgICAgICAgICAgY2I6ICgpPT57XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vb3BcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYXR0cnM6IGRlZmF1bHRBdHRyczEsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxpbmtIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZUxpbmsuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MTGlua0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBuZWVkRGVsZXRlTGluazogZmFsc2VcbiAgICAgICAgICAgICAgICB9KSwgY3NzRWwgPSBfc2RrX2NyZWF0ZUxpbmsubGluaywgbmVlZEF0dGFjaCA9IF9zZGtfY3JlYXRlTGluay5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjc3NFbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXNlTGlua1ByZWxvYWQpIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0QXR0cnMyID0ge1xuICAgICAgICAgICAgICAgIHJlbDogJ3ByZWxvYWQnLFxuICAgICAgICAgICAgICAgIGFzOiAnc2NyaXB0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5LmZvckVhY2goKGpzVXJsKT0+e1xuICAgICAgICAgICAgICAgIHZhciBfc2RrX2NyZWF0ZUxpbmsgPSBzZGsuY3JlYXRlTGluayh7XG4gICAgICAgICAgICAgICAgICAgIHVybDoganNVcmwsXG4gICAgICAgICAgICAgICAgICAgIGNiOiAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAvLyBub29wXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzOiBkZWZhdWx0QXR0cnMyLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVMaW5rSG9vazogKHVybCwgYXR0cnMpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVMaW5rLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyc1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzIGluc3RhbmNlb2YgSFRNTExpbmtFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLCBsaW5rRWwgPSBfc2RrX2NyZWF0ZUxpbmsubGluaywgbmVlZEF0dGFjaCA9IF9zZGtfY3JlYXRlTGluay5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChsaW5rRWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdEF0dHJzMyA9IHtcbiAgICAgICAgICAgICAgICBmZXRjaHByaW9yaXR5OiAnaGlnaCcsXG4gICAgICAgICAgICAgICAgdHlwZTogKHJlbW90ZUluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IHJlbW90ZUluZm8udHlwZSkgPT09ICdtb2R1bGUnID8gJ21vZHVsZScgOiAndGV4dC9qYXZhc2NyaXB0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5LmZvckVhY2goKGpzVXJsKT0+e1xuICAgICAgICAgICAgICAgIHZhciBfc2RrX2NyZWF0ZVNjcmlwdCA9IHNkay5jcmVhdGVTY3JpcHQoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGpzVXJsLFxuICAgICAgICAgICAgICAgICAgICBjYjogKCk9PntcbiAgICAgICAgICAgICAgICAgICAgLy8gbm9vcFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhdHRyczogZGVmYXVsdEF0dHJzMyxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2NyaXB0SG9vazogKHVybCwgYXR0cnMpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVTY3JpcHQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MU2NyaXB0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVTY3JpcHQ6IHRydWVcbiAgICAgICAgICAgICAgICB9KSwgc2NyaXB0RWwgPSBfc2RrX2NyZWF0ZVNjcmlwdC5zY3JpcHQsIG5lZWRBdHRhY2ggPSBfc2RrX2NyZWF0ZVNjcmlwdC5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHRFbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGFzc2lnblJlbW90ZUluZm8ocmVtb3RlSW5mbywgcmVtb3RlU25hcHNob3QpIHtcbiAgICB2YXIgcmVtb3RlRW50cnlJbmZvID0gZ2V0UmVtb3RlRW50cnlJbmZvRnJvbVNuYXBzaG90KHJlbW90ZVNuYXBzaG90KTtcbiAgICBpZiAoIXJlbW90ZUVudHJ5SW5mby51cmwpIHtcbiAgICAgICAgZXJyb3IoYFRoZSBhdHRyaWJ1dGUgcmVtb3RlRW50cnkgb2YgJHtyZW1vdGVJbmZvLm5hbWV9IG11c3Qgbm90IGJlIHVuZGVmaW5lZC5gKTtcbiAgICB9XG4gICAgdmFyIGVudHJ5VXJsID0gc2RrLmdldFJlc291cmNlVXJsKHJlbW90ZVNuYXBzaG90LCByZW1vdGVFbnRyeUluZm8udXJsKTtcbiAgICBpZiAoIXNkay5pc0Jyb3dzZXJFbnYoKSAmJiAhZW50cnlVcmwuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XG4gICAgICAgIGVudHJ5VXJsID0gYGh0dHBzOiR7ZW50cnlVcmx9YDtcbiAgICB9XG4gICAgcmVtb3RlSW5mby50eXBlID0gcmVtb3RlRW50cnlJbmZvLnR5cGU7XG4gICAgcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUgPSByZW1vdGVFbnRyeUluZm8uZ2xvYmFsTmFtZTtcbiAgICByZW1vdGVJbmZvLmVudHJ5ID0gZW50cnlVcmw7XG4gICAgcmVtb3RlSW5mby52ZXJzaW9uID0gcmVtb3RlU25hcHNob3QudmVyc2lvbjtcbiAgICByZW1vdGVJbmZvLmJ1aWxkVmVyc2lvbiA9IHJlbW90ZVNuYXBzaG90LmJ1aWxkVmVyc2lvbjtcbn1cbmZ1bmN0aW9uIHNuYXBzaG90UGx1Z2luKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6ICdzbmFwc2hvdC1wbHVnaW4nLFxuICAgICAgICBhZnRlclJlc29sdmUgKGFyZ3MpIHtcbiAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSBhcmdzLnJlbW90ZSwgcGtnTmFtZU9yQWxpYXMgPSBhcmdzLnBrZ05hbWVPckFsaWFzLCBleHBvc2UgPSBhcmdzLmV4cG9zZSwgb3JpZ2luID0gYXJncy5vcmlnaW4sIHJlbW90ZUluZm8gPSBhcmdzLnJlbW90ZUluZm87XG4gICAgICAgICAgICAgICAgaWYgKCFpc1JlbW90ZUluZm9XaXRoRW50cnkocmVtb3RlKSB8fCAhaXNQdXJlUmVtb3RlRW50cnkocmVtb3RlKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IHlpZWxkIG9yaWdpbi5zbmFwc2hvdEhhbmRsZXIubG9hZFJlbW90ZVNuYXBzaG90SW5mbyhyZW1vdGUpLCByZW1vdGVTbmFwc2hvdCA9IF9yZWYucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90ID0gX3JlZi5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgYXNzaWduUmVtb3RlSW5mbyhyZW1vdGVJbmZvLCByZW1vdGVTbmFwc2hvdCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHByZWxvYWRpbmcgYXNzZXRzXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmVsb2FkT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRDb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lT3JBbGlhczogcGtnTmFtZU9yQWxpYXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlQ2F0ZWdvcnk6ICdzeW5jJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwc1JlbW90ZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2V0cyA9IHlpZWxkIG9yaWdpbi5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5nZW5lcmF0ZVByZWxvYWRBc3NldHMuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVsb2FkT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXNzZXRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVsb2FkQXNzZXRzKHJlbW90ZUluZm8sIG9yaWdpbiwgYXNzZXRzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgYXJncywge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhcmdzO1xuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgfVxuICAgIH07XG59XG4vLyBuYW1lXG4vLyBuYW1lOnZlcnNpb25cbmZ1bmN0aW9uIHNwbGl0SWQoaWQpIHtcbiAgICB2YXIgc3BsaXRJbmZvID0gaWQuc3BsaXQoJzonKTtcbiAgICBpZiAoc3BsaXRJbmZvLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogc3BsaXRJbmZvWzBdLFxuICAgICAgICAgICAgdmVyc2lvbjogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmIChzcGxpdEluZm8ubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBzcGxpdEluZm9bMF0sXG4gICAgICAgICAgICB2ZXJzaW9uOiBzcGxpdEluZm9bMV1cbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogc3BsaXRJbmZvWzFdLFxuICAgICAgICAgICAgdmVyc2lvbjogc3BsaXRJbmZvWzJdXG4gICAgICAgIH07XG4gICAgfVxufVxuLy8gVHJhdmVyc2UgYWxsIG5vZGVzIGluIG1vZHVsZUluZm8gYW5kIHRyYXZlcnNlIHRoZSBlbnRpcmUgc25hcHNob3RcbmZ1bmN0aW9uIHRyYXZlcnNlTW9kdWxlSW5mbyhnbG9iYWxTbmFwc2hvdCwgcmVtb3RlSW5mbywgdHJhdmVyc2UsIGlzUm9vdCwgcmVmLCByZW1vdGVTbmFwc2hvdCkge1xuICAgIHZhciBtZW1vID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICB2YXIgaWQgPSBnZXRGTUlkKHJlbW90ZUluZm8pO1xuICAgIHZhciBfZ2V0SW5mb1dpdGhvdXRUeXBlID0gZ2V0SW5mb1dpdGhvdXRUeXBlKGdsb2JhbFNuYXBzaG90LCBpZCksIHNuYXBzaG90VmFsdWUgPSBfZ2V0SW5mb1dpdGhvdXRUeXBlLnZhbHVlO1xuICAgIHZhciBlZmZlY3RpdmVSZW1vdGVTbmFwc2hvdCA9IHJlbW90ZVNuYXBzaG90IHx8IHNuYXBzaG90VmFsdWU7XG4gICAgaWYgKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90ICYmICFzZGsuaXNNYW5pZmVzdFByb3ZpZGVyKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90KSkge1xuICAgICAgICB0cmF2ZXJzZShlZmZlY3RpdmVSZW1vdGVTbmFwc2hvdCwgcmVtb3RlSW5mbywgaXNSb290KTtcbiAgICAgICAgaWYgKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LnJlbW90ZXNJbmZvKSB7XG4gICAgICAgICAgICB2YXIgcmVtb3RlS2V5cyA9IE9iamVjdC5rZXlzKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LnJlbW90ZXNJbmZvKTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBvZiByZW1vdGVLZXlzKXtcbiAgICAgICAgICAgICAgICBpZiAobWVtb1trZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtZW1vW2tleV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBzdWJSZW1vdGVJbmZvID0gc3BsaXRJZChrZXkpO1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVWYWx1ZSA9IGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LnJlbW90ZXNJbmZvW2tleV07XG4gICAgICAgICAgICAgICAgdHJhdmVyc2VNb2R1bGVJbmZvKGdsb2JhbFNuYXBzaG90LCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHN1YlJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogcmVtb3RlVmFsdWUubWF0Y2hlZFZlcnNpb25cbiAgICAgICAgICAgICAgICB9LCB0cmF2ZXJzZSwgZmFsc2UsIG1lbW8sIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvblxuZnVuY3Rpb24gZ2VuZXJhdGVQcmVsb2FkQXNzZXRzKG9yaWdpbiwgcHJlbG9hZE9wdGlvbnMsIHJlbW90ZSwgZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90KSB7XG4gICAgdmFyIGNzc0Fzc2V0cyA9IFtdO1xuICAgIHZhciBqc0Fzc2V0cyA9IFtdO1xuICAgIHZhciBlbnRyeUFzc2V0cyA9IFtdO1xuICAgIHZhciBsb2FkZWRTaGFyZWRKc0Fzc2V0cyA9IG5ldyBTZXQoKTtcbiAgICB2YXIgbG9hZGVkU2hhcmVkQ3NzQXNzZXRzID0gbmV3IFNldCgpO1xuICAgIHZhciBvcHRpb25zID0gb3JpZ2luLm9wdGlvbnM7XG4gICAgdmFyIHJvb3RQcmVsb2FkQ29uZmlnID0gcHJlbG9hZE9wdGlvbnMucHJlbG9hZENvbmZpZztcbiAgICB2YXIgZGVwc1JlbW90ZSA9IHJvb3RQcmVsb2FkQ29uZmlnLmRlcHNSZW1vdGU7XG4gICAgdmFyIG1lbW8gPSB7fTtcbiAgICB0cmF2ZXJzZU1vZHVsZUluZm8oZ2xvYmFsU25hcHNob3QsIHJlbW90ZSwgKG1vZHVsZUluZm9TbmFwc2hvdCwgcmVtb3RlSW5mbywgaXNSb290KT0+e1xuICAgICAgICB2YXIgcHJlbG9hZENvbmZpZztcbiAgICAgICAgaWYgKGlzUm9vdCkge1xuICAgICAgICAgICAgcHJlbG9hZENvbmZpZyA9IHJvb3RQcmVsb2FkQ29uZmlnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZGVwc1JlbW90ZSkpIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgYXJyYXktY2FsbGJhY2stcmV0dXJuXG4gICAgICAgICAgICAgICAgdmFyIGZpbmRQcmVsb2FkQ29uZmlnID0gZGVwc1JlbW90ZS5maW5kKChyZW1vdGVDb25maWcpPT57XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdGVDb25maWcubmFtZU9yQWxpYXMgPT09IHJlbW90ZUluZm8ubmFtZSB8fCByZW1vdGVDb25maWcubmFtZU9yQWxpYXMgPT09IHJlbW90ZUluZm8uYWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIWZpbmRQcmVsb2FkQ29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJlbG9hZENvbmZpZyA9IGRlZmF1bHRQcmVsb2FkQXJncyhmaW5kUHJlbG9hZENvbmZpZyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRlcHNSZW1vdGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBwcmVsb2FkQ29uZmlnID0gcm9vdFByZWxvYWRDb25maWc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVtb3RlRW50cnlVcmwgPSBzZGsuZ2V0UmVzb3VyY2VVcmwobW9kdWxlSW5mb1NuYXBzaG90LCBnZXRSZW1vdGVFbnRyeUluZm9Gcm9tU25hcHNob3QobW9kdWxlSW5mb1NuYXBzaG90KS51cmwpO1xuICAgICAgICBpZiAocmVtb3RlRW50cnlVcmwpIHtcbiAgICAgICAgICAgIGVudHJ5QXNzZXRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICBtb2R1bGVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZW50cnk6IHJlbW90ZUVudHJ5VXJsLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAncmVtb3RlRW50cnlUeXBlJyBpbiBtb2R1bGVJbmZvU25hcHNob3QgPyBtb2R1bGVJbmZvU25hcHNob3QucmVtb3RlRW50cnlUeXBlIDogJ2dsb2JhbCcsXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5R2xvYmFsTmFtZTogJ2dsb2JhbE5hbWUnIGluIG1vZHVsZUluZm9TbmFwc2hvdCA/IG1vZHVsZUluZm9TbmFwc2hvdC5nbG9iYWxOYW1lIDogcmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZVNjb3BlOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogJ3ZlcnNpb24nIGluIG1vZHVsZUluZm9TbmFwc2hvdCA/IG1vZHVsZUluZm9TbmFwc2hvdC52ZXJzaW9uIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1cmw6IHJlbW90ZUVudHJ5VXJsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbW9kdWxlQXNzZXRzSW5mbyA9ICdtb2R1bGVzJyBpbiBtb2R1bGVJbmZvU25hcHNob3QgPyBtb2R1bGVJbmZvU25hcHNob3QubW9kdWxlcyA6IFtdO1xuICAgICAgICB2YXIgbm9ybWFsaXplZFByZWxvYWRFeHBvc2VzID0gbm9ybWFsaXplUHJlbG9hZEV4cG9zZXMocHJlbG9hZENvbmZpZy5leHBvc2VzKTtcbiAgICAgICAgaWYgKG5vcm1hbGl6ZWRQcmVsb2FkRXhwb3Nlcy5sZW5ndGggJiYgJ21vZHVsZXMnIGluIG1vZHVsZUluZm9TbmFwc2hvdCkge1xuICAgICAgICAgICAgdmFyIF9tb2R1bGVJbmZvU25hcHNob3RfbW9kdWxlcztcbiAgICAgICAgICAgIG1vZHVsZUFzc2V0c0luZm8gPSBtb2R1bGVJbmZvU25hcHNob3QgPT0gbnVsbCA/IHZvaWQgMCA6IChfbW9kdWxlSW5mb1NuYXBzaG90X21vZHVsZXMgPSBtb2R1bGVJbmZvU25hcHNob3QubW9kdWxlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9tb2R1bGVJbmZvU25hcHNob3RfbW9kdWxlcy5yZWR1Y2UoKGFzc2V0cywgbW9kdWxlQXNzZXRJbmZvKT0+e1xuICAgICAgICAgICAgICAgIGlmICgobm9ybWFsaXplZFByZWxvYWRFeHBvc2VzID09IG51bGwgPyB2b2lkIDAgOiBub3JtYWxpemVkUHJlbG9hZEV4cG9zZXMuaW5kZXhPZihtb2R1bGVBc3NldEluZm8ubW9kdWxlTmFtZSkpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBhc3NldHMucHVzaChtb2R1bGVBc3NldEluZm8pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXRzO1xuICAgICAgICAgICAgfSwgW10pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZUFzc2V0cyhhc3NldHMpIHtcbiAgICAgICAgICAgIHZhciBhc3NldHNSZXMgPSBhc3NldHMubWFwKChhc3NldCk9PnNkay5nZXRSZXNvdXJjZVVybChtb2R1bGVJbmZvU25hcHNob3QsIGFzc2V0KSk7XG4gICAgICAgICAgICBpZiAocHJlbG9hZENvbmZpZy5maWx0ZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXRzUmVzLmZpbHRlcihwcmVsb2FkQ29uZmlnLmZpbHRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYXNzZXRzUmVzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb2R1bGVBc3NldHNJbmZvKSB7XG4gICAgICAgICAgICB2YXIgYXNzZXRzTGVuZ3RoID0gbW9kdWxlQXNzZXRzSW5mby5sZW5ndGg7XG4gICAgICAgICAgICBmb3IodmFyIGluZGV4ID0gMDsgaW5kZXggPCBhc3NldHNMZW5ndGg7IGluZGV4Kyspe1xuICAgICAgICAgICAgICAgIHZhciBhc3NldHNJbmZvID0gbW9kdWxlQXNzZXRzSW5mb1tpbmRleF07XG4gICAgICAgICAgICAgICAgdmFyIGV4cG9zZUZ1bGxQYXRoID0gYCR7cmVtb3RlSW5mby5uYW1lfS8ke2Fzc2V0c0luZm8ubW9kdWxlTmFtZX1gO1xuICAgICAgICAgICAgICAgIG9yaWdpbi5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5oYW5kbGVQcmVsb2FkTW9kdWxlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBpZDogYXNzZXRzSW5mby5tb2R1bGVOYW1lID09PSAnLicgPyByZW1vdGVJbmZvLm5hbWUgOiBleHBvc2VGdWxsUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdDogbW9kdWxlSW5mb1NuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICBwcmVsb2FkQ29uZmlnLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGU6IHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwcmVsb2FkZWQgPSBnZXRQcmVsb2FkZWQoZXhwb3NlRnVsbFBhdGgpO1xuICAgICAgICAgICAgICAgIGlmIChwcmVsb2FkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwcmVsb2FkQ29uZmlnLnJlc291cmNlQ2F0ZWdvcnkgPT09ICdhbGwnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY3NzQXNzZXRzLCBfY3NzQXNzZXRzMSwgX2pzQXNzZXRzLCBfanNBc3NldHMxO1xuICAgICAgICAgICAgICAgICAgICAoX2Nzc0Fzc2V0cyA9IGNzc0Fzc2V0cykucHVzaC5hcHBseShfY3NzQXNzZXRzLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5jc3MuYXN5bmMpKSk7XG4gICAgICAgICAgICAgICAgICAgIChfY3NzQXNzZXRzMSA9IGNzc0Fzc2V0cykucHVzaC5hcHBseShfY3NzQXNzZXRzMSwgX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhoYW5kbGVBc3NldHMoYXNzZXRzSW5mby5hc3NldHMuY3NzLnN5bmMpKSk7XG4gICAgICAgICAgICAgICAgICAgIChfanNBc3NldHMgPSBqc0Fzc2V0cykucHVzaC5hcHBseShfanNBc3NldHMsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmpzLmFzeW5jKSkpO1xuICAgICAgICAgICAgICAgICAgICAoX2pzQXNzZXRzMSA9IGpzQXNzZXRzKS5wdXNoLmFwcGx5KF9qc0Fzc2V0czEsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmpzLnN5bmMpKSk7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlbG9hZENvbmZpZy5yZXNvdXJjZUNhdGVnb3J5ID0gJ3N5bmMnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY3NzQXNzZXRzMiwgX2pzQXNzZXRzMjtcbiAgICAgICAgICAgICAgICAgICAgKF9jc3NBc3NldHMyID0gY3NzQXNzZXRzKS5wdXNoLmFwcGx5KF9jc3NBc3NldHMyLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5jc3Muc3luYykpKTtcbiAgICAgICAgICAgICAgICAgICAgKF9qc0Fzc2V0czIgPSBqc0Fzc2V0cykucHVzaC5hcHBseShfanNBc3NldHMyLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5qcy5zeW5jKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZXRQcmVsb2FkZWQoZXhwb3NlRnVsbFBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgdHJ1ZSwgbWVtbywgcmVtb3RlU25hcHNob3QpO1xuICAgIGlmIChyZW1vdGVTbmFwc2hvdC5zaGFyZWQpIHtcbiAgICAgICAgdmFyIGNvbGxlY3RTaGFyZWRBc3NldHMgPSAoc2hhcmVJbmZvLCBzbmFwc2hvdFNoYXJlZCk9PntcbiAgICAgICAgICAgIHZhciByZWdpc3RlcmVkU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKG9yaWdpbi5zaGFyZVNjb3BlTWFwLCBzbmFwc2hvdFNoYXJlZC5zaGFyZWROYW1lLCBzaGFyZUluZm8sIG9yaWdpbi5zaGFyZWRIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5yZXNvbHZlU2hhcmUpO1xuICAgICAgICAgICAgLy8gSWYgdGhlIGdsb2JhbCBzaGFyZSBkb2VzIG5vdCBleGlzdCwgb3IgdGhlIGxpYiBmdW5jdGlvbiBkb2VzIG5vdCBleGlzdCwgaXQgbWVhbnMgdGhhdCB0aGUgc2hhcmVkIGhhcyBub3QgYmVlbiBsb2FkZWQgeWV0IGFuZCBjYW4gYmUgcHJlbG9hZGVkLlxuICAgICAgICAgICAgaWYgKHJlZ2lzdGVyZWRTaGFyZWQgJiYgdHlwZW9mIHJlZ2lzdGVyZWRTaGFyZWQubGliID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgc25hcHNob3RTaGFyZWQuYXNzZXRzLmpzLnN5bmMuZm9yRWFjaCgoYXNzZXQpPT57XG4gICAgICAgICAgICAgICAgICAgIGxvYWRlZFNoYXJlZEpzQXNzZXRzLmFkZChhc3NldCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgc25hcHNob3RTaGFyZWQuYXNzZXRzLmNzcy5zeW5jLmZvckVhY2goKGFzc2V0KT0+e1xuICAgICAgICAgICAgICAgICAgICBsb2FkZWRTaGFyZWRDc3NBc3NldHMuYWRkKGFzc2V0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmVtb3RlU25hcHNob3Quc2hhcmVkLmZvckVhY2goKHNoYXJlZCk9PntcbiAgICAgICAgICAgIHZhciBfb3B0aW9uc19zaGFyZWQ7XG4gICAgICAgICAgICB2YXIgc2hhcmVJbmZvcyA9IChfb3B0aW9uc19zaGFyZWQgPSBvcHRpb25zLnNoYXJlZCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9vcHRpb25zX3NoYXJlZFtzaGFyZWQuc2hhcmVkTmFtZV07XG4gICAgICAgICAgICBpZiAoIXNoYXJlSW5mb3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiBubyB2ZXJzaW9uLCBwcmVsb2FkIGFsbCBzaGFyZWRcbiAgICAgICAgICAgIHZhciBzaGFyZWRPcHRpb25zID0gc2hhcmVkLnZlcnNpb24gPyBzaGFyZUluZm9zLmZpbmQoKHMpPT5zLnZlcnNpb24gPT09IHNoYXJlZC52ZXJzaW9uKSA6IHNoYXJlSW5mb3M7XG4gICAgICAgICAgICBpZiAoIXNoYXJlZE9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYXJyYXlTaGFyZUluZm8gPSBhcnJheU9wdGlvbnMoc2hhcmVkT3B0aW9ucyk7XG4gICAgICAgICAgICBhcnJheVNoYXJlSW5mby5mb3JFYWNoKChzKT0+e1xuICAgICAgICAgICAgICAgIGNvbGxlY3RTaGFyZWRBc3NldHMocywgc2hhcmVkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgdmFyIG5lZWRQcmVsb2FkSnNBc3NldHMgPSBqc0Fzc2V0cy5maWx0ZXIoKGFzc2V0KT0+IWxvYWRlZFNoYXJlZEpzQXNzZXRzLmhhcyhhc3NldCkpO1xuICAgIHZhciBuZWVkUHJlbG9hZENzc0Fzc2V0cyA9IGNzc0Fzc2V0cy5maWx0ZXIoKGFzc2V0KT0+IWxvYWRlZFNoYXJlZENzc0Fzc2V0cy5oYXMoYXNzZXQpKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjc3NBc3NldHM6IG5lZWRQcmVsb2FkQ3NzQXNzZXRzLFxuICAgICAgICBqc0Fzc2V0c1dpdGhvdXRFbnRyeTogbmVlZFByZWxvYWRKc0Fzc2V0cyxcbiAgICAgICAgZW50cnlBc3NldHNcbiAgICB9O1xufVxudmFyIGdlbmVyYXRlUHJlbG9hZEFzc2V0c1BsdWdpbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6ICdnZW5lcmF0ZS1wcmVsb2FkLWFzc2V0cy1wbHVnaW4nLFxuICAgICAgICBnZW5lcmF0ZVByZWxvYWRBc3NldHMgKGFyZ3MpIHtcbiAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIHZhciBvcmlnaW4gPSBhcmdzLm9yaWdpbiwgcHJlbG9hZE9wdGlvbnMgPSBhcmdzLnByZWxvYWRPcHRpb25zLCByZW1vdGVJbmZvID0gYXJncy5yZW1vdGVJbmZvLCByZW1vdGUgPSBhcmdzLnJlbW90ZSwgZ2xvYmFsU25hcHNob3QgPSBhcmdzLmdsb2JhbFNuYXBzaG90LCByZW1vdGVTbmFwc2hvdCA9IGFyZ3MucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgaWYgKGlzUmVtb3RlSW5mb1dpdGhFbnRyeShyZW1vdGUpICYmIGlzUHVyZVJlbW90ZUVudHJ5KHJlbW90ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzc0Fzc2V0czogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBqc0Fzc2V0c1dpdGhvdXRFbnRyeTogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRyeUFzc2V0czogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogcmVtb3RlLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGVJbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeTogcmVtb3RlLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogcmVtb3RlSW5mby50eXBlIHx8ICdnbG9iYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlHbG9iYWxOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGU6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFzc2lnblJlbW90ZUluZm8ocmVtb3RlSW5mbywgcmVtb3RlU25hcHNob3QpO1xuICAgICAgICAgICAgICAgIHZhciBhc3NldHMgPSBnZW5lcmF0ZVByZWxvYWRBc3NldHMob3JpZ2luLCBwcmVsb2FkT3B0aW9ucywgcmVtb3RlSW5mbywgZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXRzO1xuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuZnVuY3Rpb24gZ2V0R2xvYmFsUmVtb3RlSW5mbyhtb2R1bGVJbmZvLCBvcmlnaW4pIHtcbiAgICB2YXIgaG9zdEdsb2JhbFNuYXBzaG90ID0gZ2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvKHtcbiAgICAgICAgbmFtZTogb3JpZ2luLm9wdGlvbnMubmFtZSxcbiAgICAgICAgdmVyc2lvbjogb3JpZ2luLm9wdGlvbnMudmVyc2lvblxuICAgIH0pO1xuICAgIC8vIGdldCByZW1vdGUgZGV0YWlsIGluZm8gZnJvbSBnbG9iYWxcbiAgICB2YXIgZ2xvYmFsUmVtb3RlSW5mbyA9IGhvc3RHbG9iYWxTbmFwc2hvdCAmJiAncmVtb3Rlc0luZm8nIGluIGhvc3RHbG9iYWxTbmFwc2hvdCAmJiBob3N0R2xvYmFsU25hcHNob3QucmVtb3Rlc0luZm8gJiYgZ2V0SW5mb1dpdGhvdXRUeXBlKGhvc3RHbG9iYWxTbmFwc2hvdC5yZW1vdGVzSW5mbywgbW9kdWxlSW5mby5uYW1lKS52YWx1ZTtcbiAgICBpZiAoZ2xvYmFsUmVtb3RlSW5mbyAmJiBnbG9iYWxSZW1vdGVJbmZvLm1hdGNoZWRWZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBob3N0R2xvYmFsU25hcHNob3QsXG4gICAgICAgICAgICBnbG9iYWxTbmFwc2hvdDogZ2V0R2xvYmFsU25hcHNob3QoKSxcbiAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICAgICAgICAgIG5hbWU6IG1vZHVsZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBnbG9iYWxSZW1vdGVJbmZvLm1hdGNoZWRWZXJzaW9uXG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBob3N0R2xvYmFsU25hcHNob3Q6IHVuZGVmaW5lZCxcbiAgICAgICAgZ2xvYmFsU25hcHNob3Q6IGdldEdsb2JhbFNuYXBzaG90KCksXG4gICAgICAgIHJlbW90ZVNuYXBzaG90OiBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICAgICAgbmFtZTogbW9kdWxlSW5mby5uYW1lLFxuICAgICAgICAgICAgdmVyc2lvbjogJ3ZlcnNpb24nIGluIG1vZHVsZUluZm8gPyBtb2R1bGVJbmZvLnZlcnNpb24gOiB1bmRlZmluZWRcbiAgICAgICAgfSlcbiAgICB9O1xufVxudmFyIFNuYXBzaG90SGFuZGxlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gU25hcHNob3RIYW5kbGVyKEhvc3RJbnN0YW5jZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFNuYXBzaG90SGFuZGxlcik7XG4gICAgICAgIHRoaXMubG9hZGluZ0hvc3RTbmFwc2hvdCA9IG51bGw7XG4gICAgICAgIHRoaXMubWFuaWZlc3RDYWNoZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5ob29rcyA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYmVmb3JlTG9hZFJlbW90ZVNuYXBzaG90OiBuZXcgQXN5bmNIb29rKCdiZWZvcmVMb2FkUmVtb3RlU25hcHNob3QnKSxcbiAgICAgICAgICAgIGxvYWRTbmFwc2hvdDogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnbG9hZEdsb2JhbFNuYXBzaG90JyksXG4gICAgICAgICAgICBsb2FkUmVtb3RlU25hcHNob3Q6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2xvYWRSZW1vdGVTbmFwc2hvdCcpLFxuICAgICAgICAgICAgYWZ0ZXJMb2FkU25hcHNob3Q6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2FmdGVyTG9hZFNuYXBzaG90JylcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubWFuaWZlc3RMb2FkaW5nID0gR2xvYmFsLl9fRkVERVJBVElPTl9fLl9fTUFOSUZFU1RfTE9BRElOR19fO1xuICAgICAgICB0aGlzLkhvc3RJbnN0YW5jZSA9IEhvc3RJbnN0YW5jZTtcbiAgICAgICAgdGhpcy5sb2FkZXJIb29rID0gSG9zdEluc3RhbmNlLmxvYWRlckhvb2s7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTbmFwc2hvdEhhbmRsZXIsIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTbmFwc2hvdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTbmFwc2hvdChtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8gPSB0aGlzLmdldEdsb2JhbFJlbW90ZUluZm8obW9kdWxlSW5mbyksIGhvc3RHbG9iYWxTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8uaG9zdEdsb2JhbFNuYXBzaG90LCByZW1vdGVTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8ucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90ID0gX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mby5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5sb2FkU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RHbG9iYWxTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfSksIGdsb2JhbFJlbW90ZVNuYXBzaG90ID0gX3JlZi5yZW1vdGVTbmFwc2hvdCwgZ2xvYmFsU25hcHNob3RSZXMgPSBfcmVmLmdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IGdsb2JhbFJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3Q6IGdsb2JhbFNuYXBzaG90UmVzXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRSZW1vdGVTbmFwc2hvdEluZm9cIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvblxuICAgICAgICAgICAgZnVuY3Rpb24gbG9hZFJlbW90ZVNuYXBzaG90SW5mbyhtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlTG9hZFJlbW90ZVNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm9cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob3N0U25hcHNob3QgPSBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucy52ZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWhvc3RTbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFNuYXBzaG90ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IHRoaXMuSG9zdEluc3RhbmNlLm9wdGlvbnMudmVyc2lvbiB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeTogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3Rlc0luZm86IHt9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkR2xvYmFsU25hcHNob3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLm5hbWVdOiBob3N0U25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEluIGR5bmFtaWMgbG9hZFJlbW90ZSBzY2VuYXJpb3MsIGluY29tcGxldGUgcmVtb3Rlc0luZm8gZGVsaXZlcnkgbWF5IG9jY3VyLiBJbiBzdWNoIGNhc2VzLCB0aGUgcmVtb3Rlc0luZm8gaW4gdGhlIGhvc3QgbmVlZHMgdG8gYmUgY29tcGxldGVkIGluIHRoZSBzbmFwc2hvdCBhdCBydW50aW1lLlxuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGVuc3VyZXMgdGhlIHNuYXBzaG90J3MgaW50ZWdyaXR5IGFuZCBoZWxwcyB0aGUgY2hyb21lIHBsdWdpbiBjb3JyZWN0bHkgaWRlbnRpZnkgYWxsIHByb2R1Y2VyIG1vZHVsZXMsIGVuc3VyaW5nIHRoYXQgcHJveHlhYmxlIHByb2R1Y2VyIG1vZHVsZXMgd2lsbCBub3QgYmUgbWlzc2luZy5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGhvc3RTbmFwc2hvdCAmJiAncmVtb3Rlc0luZm8nIGluIGhvc3RTbmFwc2hvdCAmJiAhZ2V0SW5mb1dpdGhvdXRUeXBlKGhvc3RTbmFwc2hvdC5yZW1vdGVzSW5mbywgbW9kdWxlSW5mby5uYW1lKS52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCd2ZXJzaW9uJyBpbiBtb2R1bGVJbmZvIHx8ICdlbnRyeScgaW4gbW9kdWxlSW5mbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RTbmFwc2hvdC5yZW1vdGVzSW5mbyA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgaG9zdFNuYXBzaG90ID09IG51bGwgPyB2b2lkIDAgOiBob3N0U25hcHNob3QucmVtb3Rlc0luZm8sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW21vZHVsZUluZm8ubmFtZV06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uOiAndmVyc2lvbicgaW4gbW9kdWxlSW5mbyA/IG1vZHVsZUluZm8udmVyc2lvbiA6IG1vZHVsZUluZm8uZW50cnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvID0gdGhpcy5nZXRHbG9iYWxSZW1vdGVJbmZvKG1vZHVsZUluZm8pLCBob3N0R2xvYmFsU25hcHNob3QgPSBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvLmhvc3RHbG9iYWxTbmFwc2hvdCwgcmVtb3RlU25hcHNob3QgPSBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvLnJlbW90ZVNuYXBzaG90LCBnbG9iYWxTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8uZ2xvYmFsU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUubG9hZFNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0R2xvYmFsU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH0pLCBnbG9iYWxSZW1vdGVTbmFwc2hvdCA9IF9yZWYucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90UmVzID0gX3JlZi5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1TbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgLy8gZ2xvYmFsIHNuYXBzaG90IGluY2x1ZGVzIG1hbmlmZXN0IG9yIG1vZHVsZSBpbmZvIGluY2x1ZGVzIG1hbmlmZXN0XG4gICAgICAgICAgICAgICAgICAgIGlmIChnbG9iYWxSZW1vdGVTbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNkay5pc01hbmlmZXN0UHJvdmlkZXIoZ2xvYmFsUmVtb3RlU25hcHNob3QpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5ID0gc2RrLmlzQnJvd3NlckVudigpID8gZ2xvYmFsUmVtb3RlU25hcHNob3QucmVtb3RlRW50cnkgOiBnbG9iYWxSZW1vdGVTbmFwc2hvdC5zc3JSZW1vdGVFbnRyeSB8fCBnbG9iYWxSZW1vdGVTbmFwc2hvdC5yZW1vdGVFbnRyeSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlU25hcHNob3QgPSB5aWVsZCB0aGlzLmdldE1hbmlmZXN0SnNvbihyZW1vdGVFbnRyeSwgbW9kdWxlSW5mbywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tc2hhZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNuYXBzaG90UmVzMSA9IHNldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyhwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIG1vZHVsZUluZm8sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGdsb2JhbCByZW1vdGUgbWF5IGJlIG92ZXJyaWRkZW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmVmb3JlLCBzZXQgdGhlIHNuYXBzaG90IGtleSB0byB0aGUgZ2xvYmFsIGFkZHJlc3Mgb2YgdGhlIGFjdHVhbCByZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5OiByZW1vdGVFbnRyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBtb2R1bGVTbmFwc2hvdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbVNuYXBzaG90ID0gbW9kdWxlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NuYXBzaG90ID0gZ2xvYmFsU25hcHNob3RSZXMxO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjEgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5sb2FkUmVtb3RlU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuSG9zdEluc3RhbmNlLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBnbG9iYWxSZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ2dsb2JhbCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgcmVtb3RlU25hcHNob3RSZXMgPSBfcmVmMS5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtU25hcHNob3QgPSByZW1vdGVTbmFwc2hvdFJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU25hcHNob3QgPSBnbG9iYWxTbmFwc2hvdFJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1JlbW90ZUluZm9XaXRoRW50cnkobW9kdWxlSW5mbykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZnJvbSBtYW5pZmVzdC5qc29uIGFuZCBtZXJnZSByZW1vdGUgaW5mbyBmcm9tIHJlbW90ZSBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlU25hcHNob3QxID0geWllbGQgdGhpcy5nZXRNYW5pZmVzdEpzb24obW9kdWxlSW5mby5lbnRyeSwgbW9kdWxlSW5mbywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tc2hhZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNuYXBzaG90UmVzMiA9IHNldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyhtb2R1bGVJbmZvLCBtb2R1bGVTbmFwc2hvdDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMiA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmxvYWRSZW1vdGVTbmFwc2hvdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IG1vZHVsZVNuYXBzaG90MSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ2dsb2JhbCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgcmVtb3RlU25hcHNob3RSZXMxID0gX3JlZjIucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbVNuYXBzaG90ID0gcmVtb3RlU25hcHNob3RSZXMxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdTbmFwc2hvdCA9IGdsb2JhbFNuYXBzaG90UmVzMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDcsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdE5hbWU6IG1vZHVsZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFZlcnNpb246IG1vZHVsZUluZm8udmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3Q6IEpTT04uc3RyaW5naWZ5KGdsb2JhbFNuYXBzaG90UmVzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5hZnRlckxvYWRTbmFwc2hvdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IG1TbmFwc2hvdFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBtU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdDogZ1NuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldEdsb2JhbFJlbW90ZUluZm9cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRHbG9iYWxSZW1vdGVJbmZvMShtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEdsb2JhbFJlbW90ZUluZm8obW9kdWxlSW5mbywgdGhpcy5Ib3N0SW5zdGFuY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZ2V0TWFuaWZlc3RKc29uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWFuaWZlc3RKc29uKG1hbmlmZXN0VXJsLCBtb2R1bGVJbmZvLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdldE1hbmlmZXN0ID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hbmlmZXN0SnNvbiA9IHRoaXMubWFuaWZlc3RDYWNoZS5nZXQobWFuaWZlc3RVcmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYW5pZmVzdEpzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hbmlmZXN0SnNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIHRoaXMubG9hZGVySG9vay5saWZlY3ljbGUuZmV0Y2guZW1pdChtYW5pZmVzdFVybCwge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlcyB8fCAhKHJlcyBpbnN0YW5jZW9mIFJlc3BvbnNlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0geWllbGQgZmV0Y2gobWFuaWZlc3RVcmwsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdEpzb24gPSB5aWVsZCByZXMuanNvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdEpzb24gPSB5aWVsZCB0aGlzLkhvc3RJbnN0YW5jZS5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5lcnJvckxvYWRSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogbWFuaWZlc3RVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJ2FmdGVyUmVzb2x2ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMuSG9zdEluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1hbmlmZXN0SnNvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMubWFuaWZlc3RMb2FkaW5nW21hbmlmZXN0VXJsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDAzLCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3RVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlTmFtZTogbW9kdWxlSW5mby5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBgJHtlcnJ9YCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydChtYW5pZmVzdEpzb24ubWV0YURhdGEgJiYgbWFuaWZlc3RKc29uLmV4cG9zZXMgJiYgbWFuaWZlc3RKc29uLnNoYXJlZCwgYCR7bWFuaWZlc3RVcmx9IGlzIG5vdCBhIGZlZGVyYXRpb24gbWFuaWZlc3RgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0Q2FjaGUuc2V0KG1hbmlmZXN0VXJsLCBtYW5pZmVzdEpzb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYW5pZmVzdEpzb247XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXN5bmNMb2FkUHJvY2VzcyA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYW5pZmVzdEpzb24gPSB5aWVsZCBnZXRNYW5pZmVzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVTbmFwc2hvdCA9IHNkay5nZW5lcmF0ZVNuYXBzaG90RnJvbU1hbmlmZXN0KG1hbmlmZXN0SnNvbiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiBtYW5pZmVzdFVybFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUubG9hZFJlbW90ZVNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdEpzb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdFVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ21hbmlmZXN0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCByZW1vdGVTbmFwc2hvdFJlcyA9IF9yZWYucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbW90ZVNuYXBzaG90UmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLm1hbmlmZXN0TG9hZGluZ1ttYW5pZmVzdFVybF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFuaWZlc3RMb2FkaW5nW21hbmlmZXN0VXJsXSA9IGFzeW5jTG9hZFByb2Nlc3MoKS50aGVuKChyZXMpPT5yZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1hbmlmZXN0TG9hZGluZ1ttYW5pZmVzdFVybF07XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBTbmFwc2hvdEhhbmRsZXI7XG59KCk7XG52YXIgU2hhcmVkSGFuZGxlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gU2hhcmVkSGFuZGxlcihob3N0KSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU2hhcmVkSGFuZGxlcik7XG4gICAgICAgIHRoaXMuaG9va3MgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIGFmdGVyUmVzb2x2ZTogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYWZ0ZXJSZXNvbHZlJyksXG4gICAgICAgICAgICBiZWZvcmVMb2FkU2hhcmU6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZUxvYWRTaGFyZScpLFxuICAgICAgICAgICAgLy8gbm90IHVzZWQgeWV0XG4gICAgICAgICAgICBsb2FkU2hhcmU6IG5ldyBBc3luY0hvb2soKSxcbiAgICAgICAgICAgIHJlc29sdmVTaGFyZTogbmV3IFN5bmNXYXRlcmZhbGxIb29rKCdyZXNvbHZlU2hhcmUnKSxcbiAgICAgICAgICAgIC8vIG1heWJlIHdpbGwgY2hhbmdlLCB0ZW1wb3JhcmlseSBmb3IgaW50ZXJuYWwgdXNlIG9ubHlcbiAgICAgICAgICAgIGluaXRDb250YWluZXJTaGFyZVNjb3BlTWFwOiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ2luaXRDb250YWluZXJTaGFyZVNjb3BlTWFwJylcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XG4gICAgICAgIHRoaXMuc2hhcmVTY29wZU1hcCA9IHt9O1xuICAgICAgICB0aGlzLmluaXRUb2tlbnMgPSB7fTtcbiAgICAgICAgdGhpcy5fc2V0R2xvYmFsU2hhcmVTY29wZU1hcChob3N0Lm9wdGlvbnMpO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oU2hhcmVkSGFuZGxlciwgW1xuICAgICAgICB7XG4gICAgICAgICAgICAvLyByZWdpc3RlciBzaGFyZWQgaW4gc2hhcmVTY29wZU1hcFxuICAgICAgICAgICAga2V5OiBcInJlZ2lzdGVyU2hhcmVkXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJTaGFyZWQoZ2xvYmFsT3B0aW9ucywgdXNlck9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2Zvcm1hdFNoYXJlQ29uZmlncyA9IGZvcm1hdFNoYXJlQ29uZmlncyhnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucyksIHNoYXJlSW5mb3MgPSBfZm9ybWF0U2hhcmVDb25maWdzLnNoYXJlSW5mb3MsIHNoYXJlZCA9IF9mb3JtYXRTaGFyZUNvbmZpZ3Muc2hhcmVkO1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZWRLZXlzID0gT2JqZWN0LmtleXMoc2hhcmVJbmZvcyk7XG4gICAgICAgICAgICAgICAgc2hhcmVkS2V5cy5mb3JFYWNoKChzaGFyZWRLZXkpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWRWYWxzID0gc2hhcmVJbmZvc1tzaGFyZWRLZXldO1xuICAgICAgICAgICAgICAgICAgICBzaGFyZWRWYWxzLmZvckVhY2goKHNoYXJlZFZhbCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWdpc3RlcmVkU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKHRoaXMuc2hhcmVTY29wZU1hcCwgc2hhcmVkS2V5LCBzaGFyZWRWYWwsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlZ2lzdGVyZWRTaGFyZWQgJiYgc2hhcmVkVmFsICYmIHNoYXJlZFZhbC5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNoYXJlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWU6IHNoYXJlZEtleSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliOiBzaGFyZWRWYWwubGliLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXQ6IHNoYXJlZFZhbC5nZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkOiBzaGFyZWRWYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IHVzZXJPcHRpb25zLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvcyxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTaGFyZShwa2dOYW1lLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZnVuY3Rpb24gcGVyZm9ybXMgdGhlIGZvbGxvd2luZyBzdGVwczpcbiAgICAgICAgICAgICAgICAgICAgLy8gMS4gQ2hlY2tzIGlmIHRoZSBjdXJyZW50bHkgbG9hZGVkIHNoYXJlIGFscmVhZHkgZXhpc3RzLCBpZiBub3QsIGl0IHRocm93cyBhbiBlcnJvclxuICAgICAgICAgICAgICAgICAgICAvLyAyLiBTZWFyY2hlcyBnbG9iYWxseSBmb3IgYSBtYXRjaGluZyBzaGFyZSwgaWYgZm91bmQsIGl0IHVzZXMgaXQgZGlyZWN0bHlcbiAgICAgICAgICAgICAgICAgICAgLy8gMy4gSWYgbm90IGZvdW5kLCBpdCByZXRyaWV2ZXMgaXQgZnJvbSB0aGUgY3VycmVudCBzaGFyZSBhbmQgc3RvcmVzIHRoZSBvYnRhaW5lZCBzaGFyZSBnbG9iYWxseS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlSW5mbyA9IGdldFRhcmdldFNoYXJlZE9wdGlvbnMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb3M6IGhvc3Qub3B0aW9ucy5zaGFyZWRcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZUluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IHNoYXJlSW5mby5zY29wZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgUHJvbWlzZS5hbGwoc2hhcmVJbmZvLnNjb3BlLm1hcCgoc2hhcmVTY29wZSk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIFByb21pc2UuYWxsKHRoaXMuaW5pdGlhbGl6ZVNoYXJpbmcoc2hhcmVTY29wZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3k6IHNoYXJlSW5mby5zdHJhdGVneVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRTaGFyZVJlcyA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZUxvYWRTaGFyZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IGhvc3Qub3B0aW9ucy5zaGFyZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZUluZm9SZXMgPSBsb2FkU2hhcmVSZXMuc2hhcmVJbmZvO1xuICAgICAgICAgICAgICAgICAgICAvLyBBc3NlcnQgdGhhdCBzaGFyZUluZm9SZXMgZXhpc3RzLCBpZiBub3QsIHRocm93IGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChzaGFyZUluZm9SZXMsIGBDYW5ub3QgZmluZCAke3BrZ05hbWV9IFNoYXJlIGluIHRoZSAke2hvc3Qub3B0aW9ucy5uYW1lfS4gUGxlYXNlIGVuc3VyZSB0aGF0IHRoZSAke3BrZ05hbWV9IFNoYXJlIHBhcmFtZXRlcnMgaGF2ZSBiZWVuIGluamVjdGVkYCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJldHJpZXZlIGZyb20gY2FjaGVcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUodGhpcy5zaGFyZVNjb3BlTWFwLCBwa2dOYW1lLCBzaGFyZUluZm9SZXMsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhZGRVc2VJbiA9IChzaGFyZWQpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNoYXJlZC51c2VJbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZC51c2VJbiA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVW5pcXVlSXRlbShzaGFyZWQudXNlSW4sIGhvc3Qub3B0aW9ucy5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlZ2lzdGVyZWRTaGFyZWQgJiYgcmVnaXN0ZXJlZFNoYXJlZC5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHJlZ2lzdGVyZWRTaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2lzdGVyZWRTaGFyZWQubGliO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlZ2lzdGVyZWRTaGFyZWQgJiYgcmVnaXN0ZXJlZFNoYXJlZC5sb2FkaW5nICYmICFyZWdpc3RlcmVkU2hhcmVkLmxvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhY3RvcnkgPSB5aWVsZCByZWdpc3RlcmVkU2hhcmVkLmxvYWRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpc3RlcmVkU2hhcmVkLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlZ2lzdGVyZWRTaGFyZWQubGliKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJlZFNoYXJlZC5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4ocmVnaXN0ZXJlZFNoYXJlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWdpc3RlcmVkU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXN5bmNMb2FkUHJvY2VzcyA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFjdG9yeSA9IHlpZWxkIHJlZ2lzdGVyZWRTaGFyZWQuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb1Jlcy5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9SZXMubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4oc2hhcmVJbmZvUmVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUodGhpcy5zaGFyZVNjb3BlTWFwLCBwa2dOYW1lLCBzaGFyZUluZm9SZXMsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU2hhcmVkLmxpYiA9IGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU2hhcmVkLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2FkaW5nID0gYXN5bmNMb2FkUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTaGFyZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHJlZ2lzdGVyZWRTaGFyZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRpbmc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuY3VzdG9tU2hhcmVJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzeW5jTG9hZFByb2Nlc3MxID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWN0b3J5ID0geWllbGQgc2hhcmVJbmZvUmVzLmdldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9SZXMubGliID0gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvUmVzLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHNoYXJlSW5mb1Jlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKHRoaXMuc2hhcmVTY29wZU1hcCwgcGtnTmFtZSwgc2hhcmVJbmZvUmVzLCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5yZXNvbHZlU2hhcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ1NoYXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NoYXJlZC5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NoYXJlZC5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZGluZzEgPSBhc3luY0xvYWRQcm9jZXNzMSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTaGFyZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHNoYXJlSW5mb1JlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWI6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZzogbG9hZGluZzFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRpbmcxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIFRoaXMgZnVuY3Rpb24gaW5pdGlhbGl6ZXMgdGhlIHNoYXJpbmcgc2VxdWVuY2UgKGV4ZWN1dGVkIG9ubHkgb25jZSBwZXIgc2hhcmUgc2NvcGUpLlxuICAgKiBJdCBhY2NlcHRzIG9uZSBhcmd1bWVudCwgdGhlIG5hbWUgb2YgdGhlIHNoYXJlIHNjb3BlLlxuICAgKiBJZiB0aGUgc2hhcmUgc2NvcGUgZG9lcyBub3QgZXhpc3QsIGl0IGNyZWF0ZXMgb25lLlxuICAgKi8gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9tZW1iZXItb3JkZXJpbmdcbiAgICAgICAgICAgIGtleTogXCJpbml0aWFsaXplU2hhcmluZ1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemVTaGFyaW5nKHJlZiwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGVOYW1lID0gcmVmID09PSB2b2lkIDAgPyBERUZBVUxUX1NDT1BFIDogcmVmO1xuICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgIHZhciBmcm9tID0gZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuZnJvbTtcbiAgICAgICAgICAgICAgICB2YXIgc3RyYXRlZ3kgPSBleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5zdHJhdGVneTtcbiAgICAgICAgICAgICAgICB2YXIgaW5pdFNjb3BlID0gZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuaW5pdFNjb3BlO1xuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChmcm9tICE9PSAnYnVpbGQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbml0VG9rZW5zID0gdGhpcy5pbml0VG9rZW5zO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWluaXRTY29wZSkgaW5pdFNjb3BlID0gW107XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbml0VG9rZW4gPSBpbml0VG9rZW5zW3NoYXJlU2NvcGVOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpbml0VG9rZW4pIGluaXRUb2tlbiA9IGluaXRUb2tlbnNbc2hhcmVTY29wZU5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogdGhpcy5ob3N0Lm5hbWVcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluaXRTY29wZS5pbmRleE9mKGluaXRUb2tlbikgPj0gMCkgcmV0dXJuIHByb21pc2VzO1xuICAgICAgICAgICAgICAgICAgICBpbml0U2NvcGUucHVzaChpbml0VG9rZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2hhcmVTY29wZSA9IHRoaXMuc2hhcmVTY29wZU1hcDtcbiAgICAgICAgICAgICAgICB2YXIgaG9zdE5hbWUgPSBob3N0Lm9wdGlvbnMubmFtZTtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGVzIGEgbmV3IHNoYXJlIHNjb3BlIGlmIG5lY2Vzc2FyeVxuICAgICAgICAgICAgICAgIGlmICghc2hhcmVTY29wZVtzaGFyZVNjb3BlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZVtzaGFyZVNjb3BlTmFtZV0gPSB7fTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRXhlY3V0ZXMgYWxsIGluaXRpYWxpemF0aW9uIHNuaXBwZXRzIGZyb20gYWxsIGFjY2Vzc2libGUgbW9kdWxlc1xuICAgICAgICAgICAgICAgIHZhciBzY29wZSA9IHNoYXJlU2NvcGVbc2hhcmVTY29wZU5hbWVdO1xuICAgICAgICAgICAgICAgIHZhciByZWdpc3RlciA9IChuYW1lMSwgc2hhcmVkKT0+e1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2FjdGl2ZVZlcnNpb25fc2hhcmVDb25maWc7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gc2hhcmVkLnZlcnNpb24sIGVhZ2VyID0gc2hhcmVkLmVhZ2VyO1xuICAgICAgICAgICAgICAgICAgICBzY29wZVtuYW1lMV0gPSBzY29wZVtuYW1lMV0gfHwge307XG4gICAgICAgICAgICAgICAgICAgIHZhciB2ZXJzaW9ucyA9IHNjb3BlW25hbWUxXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVZlcnNpb24gPSB2ZXJzaW9uc1t2ZXJzaW9uXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVZlcnNpb25FYWdlciA9IEJvb2xlYW4oYWN0aXZlVmVyc2lvbiAmJiAoYWN0aXZlVmVyc2lvbi5lYWdlciB8fCAoKF9hY3RpdmVWZXJzaW9uX3NoYXJlQ29uZmlnID0gYWN0aXZlVmVyc2lvbi5zaGFyZUNvbmZpZykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hY3RpdmVWZXJzaW9uX3NoYXJlQ29uZmlnLmVhZ2VyKSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWFjdGl2ZVZlcnNpb24gfHwgYWN0aXZlVmVyc2lvbi5zdHJhdGVneSAhPT0gJ2xvYWRlZC1maXJzdCcgJiYgIWFjdGl2ZVZlcnNpb24ubG9hZGVkICYmIChCb29sZWFuKCFlYWdlcikgIT09ICFhY3RpdmVWZXJzaW9uRWFnZXIgPyBlYWdlciA6IGhvc3ROYW1lID4gYWN0aXZlVmVyc2lvbi5mcm9tKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbnNbdmVyc2lvbl0gPSBzaGFyZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBpbml0Rm4gPSAobW9kKT0+bW9kICYmIG1vZC5pbml0ICYmIG1vZC5pbml0KHNoYXJlU2NvcGVbc2hhcmVTY29wZU5hbWVdLCBpbml0U2NvcGUpO1xuICAgICAgICAgICAgICAgIHZhciBpbml0UmVtb3RlTW9kdWxlID0gKGtleSk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gKHlpZWxkIGhvc3QucmVtb3RlSGFuZGxlci5nZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDoga2V5XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSkubW9kdWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZHVsZS5nZXRFbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgbW9kdWxlLmdldEVudHJ5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgaG9zdC5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5lcnJvckxvYWRSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDoga2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAncnVudGltZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZlY3ljbGU6ICdiZWZvcmVMb2FkU2hhcmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZHVsZS5pbml0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgaW5pdEZuKHJlbW90ZUVudHJ5RXhwb3J0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZS5pbml0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhob3N0Lm9wdGlvbnMuc2hhcmVkKS5mb3JFYWNoKChzaGFyZU5hbWUpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWRBcnIgPSBob3N0Lm9wdGlvbnMuc2hhcmVkW3NoYXJlTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZEFyci5mb3JFYWNoKChzaGFyZWQpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hhcmVkLnNjb3BlLmluY2x1ZGVzKHNoYXJlU2NvcGVOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyKHNoYXJlTmFtZSwgc2hhcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogc3RyYXRlZ3k9PT0ndmVyc2lvbi1maXJzdCcgbmVlZCB0byBiZSByZW1vdmVkIGluIHRoZSBmdXR1cmVcbiAgICAgICAgICAgICAgICBpZiAoaG9zdC5vcHRpb25zLnNoYXJlU3RyYXRlZ3kgPT09ICd2ZXJzaW9uLWZpcnN0JyB8fCBzdHJhdGVneSA9PT0gJ3ZlcnNpb24tZmlyc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGhvc3Qub3B0aW9ucy5yZW1vdGVzLmZvckVhY2goKHJlbW90ZSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdGUuc2hhcmVTY29wZSA9PT0gc2hhcmVTY29wZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGluaXRSZW1vdGVNb2R1bGUocmVtb3RlLm5hbWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVGhlIGxpYiBmdW5jdGlvbiB3aWxsIG9ubHkgYmUgYXZhaWxhYmxlIGlmIHRoZSBzaGFyZWQgc2V0IGJ5IGVhZ2VyIG9yIHJ1bnRpbWUgaW5pdCBpcyBzZXQgb3IgdGhlIHNoYXJlZCBpcyBzdWNjZXNzZnVsbHkgbG9hZGVkLlxuICAgICAgICAgICAgLy8gMS4gSWYgdGhlIGxvYWRlZCBzaGFyZWQgYWxyZWFkeSBleGlzdHMgZ2xvYmFsbHksIHRoZW4gaXQgd2lsbCBiZSByZXVzZWRcbiAgICAgICAgICAgIC8vIDIuIElmIGxpYiBleGlzdHMgaW4gbG9jYWwgc2hhcmVkLCBpdCB3aWxsIGJlIHVzZWQgZGlyZWN0bHlcbiAgICAgICAgICAgIC8vIDMuIElmIHRoZSBsb2NhbCBnZXQgcmV0dXJucyBzb21ldGhpbmcgb3RoZXIgdGhhbiBQcm9taXNlLCB0aGVuIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseVxuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVN5bmNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkU2hhcmVTeW5jKHBrZ05hbWUsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZUluZm8gPSBnZXRUYXJnZXRTaGFyZWRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZXh0cmFPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9zOiBob3N0Lm9wdGlvbnMuc2hhcmVkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mbyA9PSBudWxsID8gdm9pZCAwIDogc2hhcmVJbmZvLnNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mby5zY29wZS5mb3JFYWNoKChzaGFyZVNjb3BlKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplU2hhcmluZyhzaGFyZVNjb3BlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3k6IHNoYXJlSW5mby5zdHJhdGVneVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVnaXN0ZXJlZFNoYXJlZCA9IGdldFJlZ2lzdGVyZWRTaGFyZSh0aGlzLnNoYXJlU2NvcGVNYXAsIHBrZ05hbWUsIHNoYXJlSW5mbywgdGhpcy5ob29rcy5saWZlY3ljbGUucmVzb2x2ZVNoYXJlKTtcbiAgICAgICAgICAgICAgICB2YXIgYWRkVXNlSW4gPSAoc2hhcmVkKT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNoYXJlZC51c2VJbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkLnVzZUluID0gW107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYWRkVW5pcXVlSXRlbShzaGFyZWQudXNlSW4sIGhvc3Qub3B0aW9ucy5uYW1lKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChyZWdpc3RlcmVkU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVnaXN0ZXJlZFNoYXJlZC5saWIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHJlZ2lzdGVyZWRTaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZWdpc3RlcmVkU2hhcmVkLmxvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyZWRTaGFyZWQubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVnaXN0ZXJlZFNoYXJlZC5mcm9tID09PSBob3N0Lm9wdGlvbnMubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm8ubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnaXN0ZXJlZFNoYXJlZC5saWI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZWdpc3RlcmVkU2hhcmVkLmdldCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZSA9IHJlZ2lzdGVyZWRTaGFyZWQuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShtb2R1bGUgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHJlZ2lzdGVyZWRTaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2hhcmVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliOiBtb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogcmVnaXN0ZXJlZFNoYXJlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mby5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzaGFyZUluZm8ubG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm8ubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hhcmVJbmZvLmxpYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mby5nZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZTEgPSBzaGFyZUluZm8uZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb2R1bGUxIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yQ29kZSA9IChleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5mcm9tKSA9PT0gJ2J1aWxkJyA/IGVycm9yQ29kZXMuUlVOVElNRV8wMDUgOiBlcnJvckNvZGVzLlJVTlRJTUVfMDA2O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGUsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkUGtnTmFtZTogcGtnTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mby5saWIgPSBtb2R1bGUxO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNoYXJlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaWI6IHNoYXJlSW5mby5saWIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHNoYXJlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNoYXJlSW5mby5saWI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwNiwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZFBrZ05hbWU6IHBrZ05hbWVcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0U2hhcmVTY29wZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRTaGFyZVNjb3BlTWFwKHNjb3BlTmFtZSwgc2hhcmVTY29wZSwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4dHJhT3B0aW9ucyA9IHJlZiA9PT0gdm9pZCAwID8ge30gOiByZWY7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwW3Njb3BlTmFtZV0gPSBzaGFyZVNjb3BlO1xuICAgICAgICAgICAgICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmluaXRDb250YWluZXJTaGFyZVNjb3BlTWFwLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBzaGFyZVNjb3BlLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVOYW1lLFxuICAgICAgICAgICAgICAgICAgICBob3N0U2hhcmVTY29wZU1hcDogZXh0cmFPcHRpb25zLmhvc3RTaGFyZVNjb3BlTWFwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJzZXRTaGFyZWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTaGFyZWQocmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBrZ05hbWUgPSByZWYucGtnTmFtZSwgc2hhcmVkID0gcmVmLnNoYXJlZCwgZnJvbSA9IHJlZi5mcm9tLCBsaWIgPSByZWYubGliLCBsb2FkaW5nID0gcmVmLmxvYWRpbmcsIGxvYWRlZCA9IHJlZi5sb2FkZWQsIGdldCA9IHJlZi5nZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHZlcnNpb24gPSBzaGFyZWQudmVyc2lvbiwgX3NoYXJlZF9zY29wZSA9IHNoYXJlZC5zY29wZSwgc2NvcGUgPSBfc2hhcmVkX3Njb3BlID09PSB2b2lkIDAgPyAnZGVmYXVsdCcgOiBfc2hhcmVkX3Njb3BlLCBzaGFyZUluZm8gPSBwb2x5ZmlsbHMuX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2Uoc2hhcmVkLCBbXG4gICAgICAgICAgICAgICAgICAgIFwidmVyc2lvblwiLFxuICAgICAgICAgICAgICAgICAgICBcInNjb3BlXCJcbiAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NvcGVzID0gQXJyYXkuaXNBcnJheShzY29wZSkgPyBzY29wZSA6IFtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIHNjb3Blcy5mb3JFYWNoKChzYyk9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNoYXJlU2NvcGVNYXBbc2NdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdID0ge307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdID0ge307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dID0gcG9seWZpbGxzLl9leHRlbmRzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkZWZhdWx0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHNoYXJlSW5mbywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVt2ZXJzaW9uXS5nZXQgPSBnZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRTaGFyZWQgPSB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGluZyAmJiAhcmVnaXN0ZXJlZFNoYXJlZC5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpc3RlcmVkU2hhcmVkLmxvYWRpbmcgPSBsb2FkaW5nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJfc2V0R2xvYmFsU2hhcmVTY29wZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRHbG9iYWxTaGFyZVNjb3BlTWFwKGhvc3RPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNoYXJlU2NvcGVNYXAgPSBnZXRHbG9iYWxTaGFyZVNjb3BlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGlkZW50aWZpZXIgPSBob3N0T3B0aW9ucy5pZCB8fCBob3N0T3B0aW9ucy5uYW1lO1xuICAgICAgICAgICAgICAgIGlmIChpZGVudGlmaWVyICYmICFnbG9iYWxTaGFyZVNjb3BlTWFwW2lkZW50aWZpZXJdKSB7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbFNoYXJlU2NvcGVNYXBbaWRlbnRpZmllcl0gPSB0aGlzLnNoYXJlU2NvcGVNYXA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFNoYXJlZEhhbmRsZXI7XG59KCk7XG52YXIgUmVtb3RlSGFuZGxlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gUmVtb3RlSGFuZGxlcihob3N0KSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgUmVtb3RlSGFuZGxlcik7XG4gICAgICAgIHRoaXMuaG9va3MgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIGJlZm9yZVJlZ2lzdGVyUmVtb3RlOiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZVJlZ2lzdGVyUmVtb3RlJyksXG4gICAgICAgICAgICByZWdpc3RlclJlbW90ZTogbmV3IFN5bmNXYXRlcmZhbGxIb29rKCdyZWdpc3RlclJlbW90ZScpLFxuICAgICAgICAgICAgYmVmb3JlUmVxdWVzdDogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYmVmb3JlUmVxdWVzdCcpLFxuICAgICAgICAgICAgb25Mb2FkOiBuZXcgQXN5bmNIb29rKCdvbkxvYWQnKSxcbiAgICAgICAgICAgIGhhbmRsZVByZWxvYWRNb2R1bGU6IG5ldyBTeW5jSG9vaygnaGFuZGxlUHJlbG9hZE1vZHVsZScpLFxuICAgICAgICAgICAgZXJyb3JMb2FkUmVtb3RlOiBuZXcgQXN5bmNIb29rKCdlcnJvckxvYWRSZW1vdGUnKSxcbiAgICAgICAgICAgIGJlZm9yZVByZWxvYWRSZW1vdGU6IG5ldyBBc3luY0hvb2soJ2JlZm9yZVByZWxvYWRSZW1vdGUnKSxcbiAgICAgICAgICAgIGdlbmVyYXRlUHJlbG9hZEFzc2V0czogbmV3IEFzeW5jSG9vaygnZ2VuZXJhdGVQcmVsb2FkQXNzZXRzJyksXG4gICAgICAgICAgICAvLyBub3QgdXNlZCB5ZXRcbiAgICAgICAgICAgIGFmdGVyUHJlbG9hZFJlbW90ZTogbmV3IEFzeW5jSG9vaygpLFxuICAgICAgICAgICAgbG9hZEVudHJ5OiBuZXcgQXN5bmNIb29rKClcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XG4gICAgICAgIHRoaXMuaWRUb1JlbW90ZU1hcCA9IHt9O1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oUmVtb3RlSGFuZGxlciwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZm9ybWF0QW5kUmVnaXN0ZXJSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JtYXRBbmRSZWdpc3RlclJlbW90ZShnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciB1c2VyUmVtb3RlcyA9IHVzZXJPcHRpb25zLnJlbW90ZXMgfHwgW107XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJSZW1vdGVzLnJlZHVjZSgocmVzLCByZW1vdGUpPT57XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJSZW1vdGUocmVtb3RlLCByZXMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9LCBnbG9iYWxPcHRpb25zLnJlbW90ZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic2V0SWRUb1JlbW90ZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldElkVG9SZW1vdGVNYXAoaWQsIHJlbW90ZU1hdGNoSW5mbykge1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSByZW1vdGVNYXRjaEluZm8ucmVtb3RlLCBleHBvc2UgPSByZW1vdGVNYXRjaEluZm8uZXhwb3NlO1xuICAgICAgICAgICAgICAgIHZhciBuYW1lMSA9IHJlbW90ZS5uYW1lLCBhbGlhcyA9IHJlbW90ZS5hbGlhcztcbiAgICAgICAgICAgICAgICB0aGlzLmlkVG9SZW1vdGVNYXBbaWRdID0ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoYWxpYXMgJiYgaWQuc3RhcnRzV2l0aChuYW1lMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkV2l0aEFsaWFzID0gaWQucmVwbGFjZShuYW1lMSwgYWxpYXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlkVG9SZW1vdGVNYXBbaWRXaXRoQWxpYXNdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWxpYXMgJiYgaWQuc3RhcnRzV2l0aChhbGlhcykpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkV2l0aE5hbWUgPSBpZC5yZXBsYWNlKGFsaWFzLCBuYW1lMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaWRUb1JlbW90ZU1hcFtpZFdpdGhOYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGluZXMtcGVyLWZ1bmN0aW9uXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAgZnVuY3Rpb24gbG9hZFJlbW90ZShpZCwgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gb3B0aW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZEZhY3Rvcnk6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9yZWZfbG9hZEZhY3RvcnkgPSBfcmVmLmxvYWRGYWN0b3J5LCBsb2FkRmFjdG9yeSA9IF9yZWZfbG9hZEZhY3RvcnkgPT09IHZvaWQgMCA/IHRydWUgOiBfcmVmX2xvYWRGYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMS4gVmFsaWRhdGUgdGhlIHBhcmFtZXRlcnMgb2YgdGhlIHJldHJpZXZlZCBtb2R1bGUuIFRoZXJlIGFyZSB0d28gbW9kdWxlIHJlcXVlc3QgbWV0aG9kczogcGtnTmFtZSArIGV4cG9zZSBhbmQgYWxpYXMgKyBleHBvc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAyLiBSZXF1ZXN0IHRoZSBzbmFwc2hvdCBpbmZvcm1hdGlvbiBvZiB0aGUgY3VycmVudCBob3N0IGFuZCBnbG9iYWxseSBzdG9yZSB0aGUgb2J0YWluZWQgc25hcHNob3QgaW5mb3JtYXRpb24uIFRoZSByZXRyaWV2ZWQgbW9kdWxlIGluZm9ybWF0aW9uIGlzIHBhcnRpYWxseSBvZmZsaW5lIGFuZCBwYXJ0aWFsbHkgb25saW5lLiBUaGUgb25saW5lIG1vZHVsZSBpbmZvcm1hdGlvbiB3aWxsIHJldHJpZXZlIHRoZSBtb2R1bGVzIHVzZWQgb25saW5lLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMy4gUmV0cmlldmUgdGhlIGRldGFpbGVkIGluZm9ybWF0aW9uIG9mIHRoZSBjdXJyZW50IG1vZHVsZSBmcm9tIGdsb2JhbCAocmVtb3RlRW50cnkgYWRkcmVzcywgZXhwb3NlIHJlc291cmNlIGFkZHJlc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA0LiBBZnRlciByZXRyaWV2aW5nIHJlbW90ZUVudHJ5LCBjYWxsIHRoZSBpbml0IG9mIHRoZSBtb2R1bGUsIGFuZCB0aGVuIHJldHJpZXZlIHRoZSBleHBvcnRlZCBjb250ZW50IG9mIHRoZSBtb2R1bGUgdGhyb3VnaCBnZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlkOiBwa2dOYW1lKEBmZWRlcmF0aW9uL2FwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBAZmVkZXJhdGlvbi9hcHAxL2J1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWQ6IGFsaWFzKGFwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBhcHAxL2J1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWQ6IGFsaWFzKGFwcDEvdXRpbHMpICsgZXhwb3NlKGxvYWRhc2gvc29ydCkgPSBhcHAxL3V0aWxzL2xvYWRhc2gvc29ydFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYxID0geWllbGQgdGhpcy5nZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSksIG1vZHVsZSA9IF9yZWYxLm1vZHVsZSwgbW9kdWxlT3B0aW9ucyA9IF9yZWYxLm1vZHVsZU9wdGlvbnMsIHJlbW90ZU1hdGNoSW5mbyA9IF9yZWYxLnJlbW90ZU1hdGNoSW5mbztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwa2dOYW1lT3JBbGlhcyA9IHJlbW90ZU1hdGNoSW5mby5wa2dOYW1lT3JBbGlhcywgcmVtb3RlID0gcmVtb3RlTWF0Y2hJbmZvLnJlbW90ZSwgZXhwb3NlID0gcmVtb3RlTWF0Y2hJbmZvLmV4cG9zZSwgaWRSZXMgPSByZW1vdGVNYXRjaEluZm8uaWQsIHJlbW90ZVNuYXBzaG90ID0gcmVtb3RlTWF0Y2hJbmZvLnJlbW90ZVNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZU9yRmFjdG9yeSA9IHlpZWxkIG1vZHVsZS5nZXQoaWRSZXMsIGV4cG9zZSwgb3B0aW9ucywgcmVtb3RlU25hcHNob3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZVdyYXBwZXIgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5vbkxvYWQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkUmVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VNb2R1bGU6IGxvYWRGYWN0b3J5ID8gbW9kdWxlT3JGYWN0b3J5IDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZU1vZHVsZUZhY3Rvcnk6IGxvYWRGYWN0b3J5ID8gdW5kZWZpbmVkIDogbW9kdWxlT3JGYWN0b3J5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBtb2R1bGVPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluc3RhbmNlOiBtb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0SWRUb1JlbW90ZU1hcChpZCwgcmVtb3RlTWF0Y2hJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbW9kdWxlV3JhcHBlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGVXcmFwcGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZU9yRmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMiA9IG9wdGlvbnMgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgX3JlZl9mcm9tID0gX3JlZjIuZnJvbSwgZnJvbSA9IF9yZWZfZnJvbSA9PT0gdm9pZCAwID8gJ3J1bnRpbWUnIDogX3JlZl9mcm9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWxPdmVyID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuZXJyb3JMb2FkUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb20sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlmZWN5Y2xlOiAnb25Mb2FkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmYWlsT3Zlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhaWxPdmVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInByZWxvYWRSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAgZnVuY3Rpb24gcHJlbG9hZFJlbW90ZShwcmVsb2FkT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlUHJlbG9hZFJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRPcHM6IHByZWxvYWRPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogaG9zdC5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJlbG9hZE9wcyA9IGZvcm1hdFByZWxvYWRBcmdzKGhvc3Qub3B0aW9ucy5yZW1vdGVzLCBwcmVsb2FkT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIFByb21pc2UuYWxsKHByZWxvYWRPcHMubWFwKChvcHMpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSBvcHMucmVtb3RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gZ2V0UmVtb3RlSW5mbyhyZW1vdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgaG9zdC5zbmFwc2hvdEhhbmRsZXIubG9hZFJlbW90ZVNuYXBzaG90SW5mbyhyZW1vdGUpLCBnbG9iYWxTbmFwc2hvdCA9IF9yZWYuZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90ID0gX3JlZi5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzZXRzID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuZ2VuZXJhdGVQcmVsb2FkQXNzZXRzLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRPcHRpb25zOiBvcHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhc3NldHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVsb2FkQXNzZXRzKHJlbW90ZUluZm8sIGhvc3QsIGFzc2V0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpKSk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlZ2lzdGVyUmVtb3Rlc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyUmVtb3RlcyhyZW1vdGVzLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgcmVtb3Rlcy5mb3JFYWNoKChyZW1vdGUpPT57XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJSZW1vdGUocmVtb3RlLCBob3N0Lm9wdGlvbnMucmVtb3Rlcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2U6IG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuZm9yY2VcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVtb3RlTW9kdWxlQW5kT3B0aW9ucyhvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBvcHRpb25zLmlkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFJlbW90ZUFyZ3M7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkUmVtb3RlQXJncyA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZVJlcXVlc3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogaG9zdC5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkUmVtb3RlQXJncyA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmVycm9yTG9hZFJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZlY3ljbGU6ICdiZWZvcmVSZXF1ZXN0J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxvYWRSZW1vdGVBcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkUmVzID0gbG9hZFJlbW90ZUFyZ3MuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVTcGxpdEluZm8gPSBtYXRjaFJlbW90ZVdpdGhOYW1lQW5kRXhwb3NlKGhvc3Qub3B0aW9ucy5yZW1vdGVzLCBpZFJlcyk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChyZW1vdGVTcGxpdEluZm8sIGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDA0LCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0SWQ6IGlkUmVzXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhd1JlbW90ZSA9IHJlbW90ZVNwbGl0SW5mby5yZW1vdGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gZ2V0UmVtb3RlSW5mbyhyYXdSZW1vdGUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hJbmZvID0geWllbGQgaG9zdC5zaGFyZWRIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5hZnRlclJlc29sdmUuZW1pdChwb2x5ZmlsbHMuX2V4dGVuZHMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkUmVzXG4gICAgICAgICAgICAgICAgICAgIH0sIHJlbW90ZVNwbGl0SW5mbywge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogaG9zdC5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSBtYXRjaEluZm8ucmVtb3RlLCBleHBvc2UgPSBtYXRjaEluZm8uZXhwb3NlO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQocmVtb3RlICYmIGV4cG9zZSwgYFRoZSAnYmVmb3JlUmVxdWVzdCcgaG9vayB3YXMgZXhlY3V0ZWQsIGJ1dCBpdCBmYWlsZWQgdG8gcmV0dXJuIHRoZSBjb3JyZWN0ICdyZW1vdGUnIGFuZCAnZXhwb3NlJyB2YWx1ZXMgd2hpbGUgbG9hZGluZyAke2lkUmVzfS5gKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZSA9IGhvc3QubW9kdWxlQ2FjaGUuZ2V0KHJlbW90ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZU9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0OiBob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlID0gbmV3IE1vZHVsZShtb2R1bGVPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QubW9kdWxlQ2FjaGUuc2V0KHJlbW90ZS5uYW1lLCBtb2R1bGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlTWF0Y2hJbmZvOiBtYXRjaEluZm9cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVnaXN0ZXJSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlclJlbW90ZShyZW1vdGUsIHRhcmdldFJlbW90ZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICB2YXIgbm9ybWFsaXplUmVtb3RlID0gKCk9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZS5hbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVmFsaWRhdGUgaWYgYWxpYXMgZXF1YWxzIHRoZSBwcmVmaXggb2YgcmVtb3RlLm5hbWUgYW5kIHJlbW90ZS5hbGlhcywgaWYgc28sIHRocm93IGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcyBtdWx0aS1sZXZlbCBwYXRoIHJlZmVyZW5jZXMgY2Fubm90IGd1YXJhbnRlZSB1bmlxdWUgbmFtZXMsIGFsaWFzIGJlaW5nIGEgcHJlZml4IG9mIHJlbW90ZS5uYW1lIGlzIG5vdCBzdXBwb3J0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaW5kRXF1YWwgPSB0YXJnZXRSZW1vdGVzLmZpbmQoKGl0ZW0pPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9pdGVtX2FsaWFzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZW1vdGUuYWxpYXMgJiYgKGl0ZW0ubmFtZS5zdGFydHNXaXRoKHJlbW90ZS5hbGlhcykgfHwgKChfaXRlbV9hbGlhcyA9IGl0ZW0uYWxpYXMpID09IG51bGwgPyB2b2lkIDAgOiBfaXRlbV9hbGlhcy5zdGFydHNXaXRoKHJlbW90ZS5hbGlhcykpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCFmaW5kRXF1YWwsIGBUaGUgYWxpYXMgJHtyZW1vdGUuYWxpYXN9IG9mIHJlbW90ZSAke3JlbW90ZS5uYW1lfSBpcyBub3QgYWxsb3dlZCB0byBiZSB0aGUgcHJlZml4IG9mICR7ZmluZEVxdWFsICYmIGZpbmRFcXVhbC5uYW1lfSBuYW1lIG9yIGFsaWFzYCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSByZW1vdGUgZW50cnkgdG8gYSBjb21wbGV0ZSBwYXRoXG4gICAgICAgICAgICAgICAgICAgIGlmICgnZW50cnknIGluIHJlbW90ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNkay5pc0Jyb3dzZXJFbnYoKSAmJiAhcmVtb3RlLmVudHJ5LnN0YXJ0c1dpdGgoJ2h0dHAnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZS5lbnRyeSA9IG5ldyBVUkwocmVtb3RlLmVudHJ5LCB3aW5kb3cubG9jYXRpb24ub3JpZ2luKS5ocmVmO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVtb3RlLnNoYXJlU2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZS5zaGFyZVNjb3BlID0gREVGQVVMVF9TQ09QRTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlbW90ZS50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUudHlwZSA9IERFRkFVTFRfUkVNT1RFX1RZUEU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZVJlZ2lzdGVyUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciByZWdpc3RlcmVkUmVtb3RlID0gdGFyZ2V0UmVtb3Rlcy5maW5kKChpdGVtKT0+aXRlbS5uYW1lID09PSByZW1vdGUubmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZWdpc3RlcmVkUmVtb3RlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZVJlbW90ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRSZW1vdGVzLnB1c2gocmVtb3RlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUucmVnaXN0ZXJSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VzID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgYFRoZSByZW1vdGUgXCIke3JlbW90ZS5uYW1lfVwiIGlzIGFscmVhZHkgcmVnaXN0ZXJlZC5gLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ1BsZWFzZSBub3RlIHRoYXQgb3ZlcnJpZGluZyBpdCBtYXkgY2F1c2UgdW5leHBlY3RlZCBlcnJvcnMuJ1xuICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5mb3JjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHJlZ2lzdGVyZWQgcmVtb3RlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVJlbW90ZShyZWdpc3RlcmVkUmVtb3RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZVJlbW90ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UmVtb3Rlcy5wdXNoKHJlbW90ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5yZWdpc3RlclJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNkay53YXJuKG1lc3NhZ2VzLmpvaW4oJyAnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZW1vdmVSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVSZW1vdGUocmVtb3RlKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lMSA9IHJlbW90ZS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5kZXggPSBob3N0Lm9wdGlvbnMucmVtb3Rlcy5maW5kSW5kZXgoKGl0ZW0pPT5pdGVtLm5hbWUgPT09IG5hbWUxKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5vcHRpb25zLnJlbW90ZXMuc3BsaWNlKHJlbW90ZUluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZGVkTW9kdWxlID0gaG9zdC5tb2R1bGVDYWNoZS5nZXQocmVtb3RlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGVkTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IGxvYWRlZE1vZHVsZS5yZW1vdGVJbmZvO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEN1cnJlbnRHbG9iYWxba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfT2JqZWN0X2dldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKF9PYmplY3RfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihDdXJyZW50R2xvYmFsLCBrZXkpKSA9PSBudWxsID8gdm9pZCAwIDogX09iamVjdF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IuY29uZmlndXJhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBDdXJyZW50R2xvYmFsW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDdXJyZW50R2xvYmFsW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5VW5pcXVlS2V5ID0gZ2V0UmVtb3RlRW50cnlVbmlxdWVLZXkobG9hZGVkTW9kdWxlLnJlbW90ZUluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdsb2JhbExvYWRpbmdbcmVtb3RlRW50cnlVbmlxdWVLZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGdsb2JhbExvYWRpbmdbcmVtb3RlRW50cnlVbmlxdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5zbmFwc2hvdEhhbmRsZXIubWFuaWZlc3RDYWNoZS5kZWxldGUocmVtb3RlSW5mby5lbnRyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkZWxldGUgdW5sb2FkZWQgc2hhcmVkIGFuZCBpbnN0YW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluc0lkID0gcmVtb3RlSW5mby5idWlsZFZlcnNpb24gPyBzZGsuY29tcG9zZUtleVdpdGhTZXBhcmF0b3IocmVtb3RlSW5mby5uYW1lLCByZW1vdGVJbmZvLmJ1aWxkVmVyc2lvbikgOiByZW1vdGVJbmZvLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5zSW5kZXggPSBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX18uZmluZEluZGV4KChpbnMpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUluZm8uYnVpbGRWZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnMub3B0aW9ucy5pZCA9PT0gcmVtb3RlSW5zSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlucy5uYW1lID09PSByZW1vdGVJbnNJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdGVJbnNJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5zID0gQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0lOU1RBTkNFU19fW3JlbW90ZUluc0luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbnNJZCA9IHJlbW90ZUlucy5vcHRpb25zLmlkIHx8IHJlbW90ZUluc0lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnbG9iYWxTaGFyZVNjb3BlTWFwID0gZ2V0R2xvYmFsU2hhcmVTY29wZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0FsbFNoYXJlZE5vdFVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZWVkRGVsZXRlS2V5cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGdsb2JhbFNoYXJlU2NvcGVNYXApLmZvckVhY2goKGluc3RJZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGVNYXAgPSBnbG9iYWxTaGFyZVNjb3BlTWFwW2luc3RJZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGVNYXAgJiYgT2JqZWN0LmtleXMoc2hhcmVTY29wZU1hcCkuZm9yRWFjaCgoc2hhcmVTY29wZSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlVmFsID0gc2hhcmVTY29wZU1hcFtzaGFyZVNjb3BlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGVWYWwgJiYgT2JqZWN0LmtleXMoc2hhcmVTY29wZVZhbCkuZm9yRWFjaCgoc2hhcmVOYW1lKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWRQa2dzID0gc2hhcmVTY29wZVZhbFtzaGFyZU5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZFBrZ3MgJiYgT2JqZWN0LmtleXMoc2hhcmVkUGtncykuZm9yRWFjaCgoc2hhcmVWZXJzaW9uKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2hhcmVkID0gc2hhcmVkUGtnc1tzaGFyZVZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hhcmVkICYmIHR5cGVvZiBzaGFyZWQgPT09ICdvYmplY3QnICYmIHNoYXJlZC5mcm9tID09PSByZW1vdGVJbmZvLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWQubG9hZGVkIHx8IHNoYXJlZC5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkLnVzZUluID0gc2hhcmVkLnVzZUluLmZpbHRlcigodXNlZEhvc3ROYW1lKT0+dXNlZEhvc3ROYW1lICE9PSByZW1vdGVJbmZvLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWQudXNlSW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQWxsU2hhcmVkTm90VXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVLZXlzLnB1c2goW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlVmVyc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVLZXlzLnB1c2goW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVWZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBbGxTaGFyZWROb3RVc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUlucy5zaGFyZVNjb3BlTWFwID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBnbG9iYWxTaGFyZVNjb3BlTWFwW3JlbW90ZUluc0lkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZERlbGV0ZUtleXMuZm9yRWFjaCgocmVmKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDQpLCBpbnNJZCA9IF9yZWZbMF0sIHNoYXJlU2NvcGUgPSBfcmVmWzFdLCBzaGFyZU5hbWUgPSBfcmVmWzJdLCBzaGFyZVZlcnNpb24gPSBfcmVmWzNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZV9zaGFyZU5hbWUsIF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkX3NoYXJlU2NvcGUsIF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWQgPSBnbG9iYWxTaGFyZVNjb3BlTWFwW2luc0lkXSkgPT0gbnVsbCA/IHRydWUgOiAoX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZSA9IF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkW3NoYXJlU2NvcGVdKSA9PSBudWxsID8gdHJ1ZSA6IChfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZF9zaGFyZVNjb3BlX3NoYXJlTmFtZSA9IF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkX3NoYXJlU2NvcGVbc2hhcmVOYW1lXSkgPT0gbnVsbCA/IHRydWUgOiBkZWxldGUgX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZV9zaGFyZU5hbWVbc2hhcmVWZXJzaW9uXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX18uc3BsaWNlKHJlbW90ZUluc0luZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBob3N0R2xvYmFsU25hcHNob3QgPSBnZXRHbG9iYWxSZW1vdGVJbmZvKHJlbW90ZSwgaG9zdCkuaG9zdEdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhvc3RHbG9iYWxTbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVLZXkgPSBob3N0R2xvYmFsU25hcHNob3QgJiYgJ3JlbW90ZXNJbmZvJyBpbiBob3N0R2xvYmFsU25hcHNob3QgJiYgaG9zdEdsb2JhbFNuYXBzaG90LnJlbW90ZXNJbmZvICYmIGdldEluZm9XaXRob3V0VHlwZShob3N0R2xvYmFsU25hcHNob3QucmVtb3Rlc0luZm8sIHJlbW90ZS5uYW1lKS5rZXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgaG9zdEdsb2JhbFNuYXBzaG90LnJlbW90ZXNJbmZvW3JlbW90ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX01BTklGRVNUX0xPQURJTkdfX1tyZW1vdGVLZXldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX01BTklGRVNUX0xPQURJTkdfX1tyZW1vdGVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5tb2R1bGVDYWNoZS5kZWxldGUocmVtb3RlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coJ3JlbW92ZVJlbW90ZSBmYWlsOiAnLCBlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBSZW1vdGVIYW5kbGVyO1xufSgpO1xudmFyIEZlZGVyYXRpb25Ib3N0ID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBGZWRlcmF0aW9uSG9zdCh1c2VyT3B0aW9ucykge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIEZlZGVyYXRpb25Ib3N0KTtcbiAgICAgICAgdGhpcy5ob29rcyA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYmVmb3JlSW5pdDogbmV3IFN5bmNXYXRlcmZhbGxIb29rKCdiZWZvcmVJbml0JyksXG4gICAgICAgICAgICBpbml0OiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIC8vIG1heWJlIHdpbGwgY2hhbmdlLCB0ZW1wb3JhcmlseSBmb3IgaW50ZXJuYWwgdXNlIG9ubHlcbiAgICAgICAgICAgIGJlZm9yZUluaXRDb250YWluZXI6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZUluaXRDb250YWluZXInKSxcbiAgICAgICAgICAgIC8vIG1heWJlIHdpbGwgY2hhbmdlLCB0ZW1wb3JhcmlseSBmb3IgaW50ZXJuYWwgdXNlIG9ubHlcbiAgICAgICAgICAgIGluaXRDb250YWluZXI6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2luaXRDb250YWluZXInKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gXCIwLjEwLjBcIjtcbiAgICAgICAgdGhpcy5tb2R1bGVDYWNoZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5sb2FkZXJIb29rID0gbmV3IFBsdWdpblN5c3RlbSh7XG4gICAgICAgICAgICAvLyBGSVhNRTogbWF5IG5vdCBiZSBzdWl0YWJsZSAsIG5vdCBvcGVuIHRvIHRoZSBwdWJsaWMgeWV0XG4gICAgICAgICAgICBnZXRNb2R1bGVJbmZvOiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGNyZWF0ZVNjcmlwdDogbmV3IFN5bmNIb29rKCksXG4gICAgICAgICAgICBjcmVhdGVMaW5rOiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGZldGNoOiBuZXcgQXN5bmNIb29rKCksXG4gICAgICAgICAgICBsb2FkRW50cnlFcnJvcjogbmV3IEFzeW5jSG9vaygpLFxuICAgICAgICAgICAgZ2V0TW9kdWxlRmFjdG9yeTogbmV3IEFzeW5jSG9vaygpXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJyaWRnZUhvb2sgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIGJlZm9yZUJyaWRnZVJlbmRlcjogbmV3IFN5bmNIb29rKCksXG4gICAgICAgICAgICBhZnRlckJyaWRnZVJlbmRlcjogbmV3IFN5bmNIb29rKCksXG4gICAgICAgICAgICBiZWZvcmVCcmlkZ2VEZXN0cm95OiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGFmdGVyQnJpZGdlRGVzdHJveTogbmV3IFN5bmNIb29rKClcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFRPRE86IFZhbGlkYXRlIHRoZSBkZXRhaWxzIG9mIHRoZSBvcHRpb25zXG4gICAgICAgIC8vIEluaXRpYWxpemUgb3B0aW9ucyB3aXRoIGRlZmF1bHQgdmFsdWVzXG4gICAgICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgICAgICAgIGlkOiBnZXRCdWlsZGVySWQoKSxcbiAgICAgICAgICAgIG5hbWU6IHVzZXJPcHRpb25zLm5hbWUsXG4gICAgICAgICAgICBwbHVnaW5zOiBbXG4gICAgICAgICAgICAgICAgc25hcHNob3RQbHVnaW4oKSxcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZVByZWxvYWRBc3NldHNQbHVnaW4oKVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHJlbW90ZXM6IFtdLFxuICAgICAgICAgICAgc2hhcmVkOiB7fSxcbiAgICAgICAgICAgIGluQnJvd3Nlcjogc2RrLmlzQnJvd3NlckVudigpXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubmFtZSA9IHVzZXJPcHRpb25zLm5hbWU7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICB0aGlzLnNuYXBzaG90SGFuZGxlciA9IG5ldyBTbmFwc2hvdEhhbmRsZXIodGhpcyk7XG4gICAgICAgIHRoaXMuc2hhcmVkSGFuZGxlciA9IG5ldyBTaGFyZWRIYW5kbGVyKHRoaXMpO1xuICAgICAgICB0aGlzLnJlbW90ZUhhbmRsZXIgPSBuZXcgUmVtb3RlSGFuZGxlcih0aGlzKTtcbiAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwID0gdGhpcy5zaGFyZWRIYW5kbGVyLnNoYXJlU2NvcGVNYXA7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJQbHVnaW5zKF90b19jb25zdW1hYmxlX2FycmF5Ll8oZGVmYXVsdE9wdGlvbnMucGx1Z2lucykuY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8odXNlck9wdGlvbnMucGx1Z2lucyB8fCBbXSkpKTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gdGhpcy5mb3JtYXRPcHRpb25zKGRlZmF1bHRPcHRpb25zLCB1c2VyT3B0aW9ucyk7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhGZWRlcmF0aW9uSG9zdCwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdE9wdGlvbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0T3B0aW9ucyh1c2VyT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJQbHVnaW5zKHVzZXJPcHRpb25zLnBsdWdpbnMpO1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5mb3JtYXRPcHRpb25zKHRoaXMub3B0aW9ucywgdXNlck9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2FkU2hhcmVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkU2hhcmUocGtnTmFtZSwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNoYXJlZEhhbmRsZXIubG9hZFNoYXJlKHBrZ05hbWUsIGV4dHJhT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVGhlIGxpYiBmdW5jdGlvbiB3aWxsIG9ubHkgYmUgYXZhaWxhYmxlIGlmIHRoZSBzaGFyZWQgc2V0IGJ5IGVhZ2VyIG9yIHJ1bnRpbWUgaW5pdCBpcyBzZXQgb3IgdGhlIHNoYXJlZCBpcyBzdWNjZXNzZnVsbHkgbG9hZGVkLlxuICAgICAgICAgICAgLy8gMS4gSWYgdGhlIGxvYWRlZCBzaGFyZWQgYWxyZWFkeSBleGlzdHMgZ2xvYmFsbHksIHRoZW4gaXQgd2lsbCBiZSByZXVzZWRcbiAgICAgICAgICAgIC8vIDIuIElmIGxpYiBleGlzdHMgaW4gbG9jYWwgc2hhcmVkLCBpdCB3aWxsIGJlIHVzZWQgZGlyZWN0bHlcbiAgICAgICAgICAgIC8vIDMuIElmIHRoZSBsb2NhbCBnZXQgcmV0dXJucyBzb21ldGhpbmcgb3RoZXIgdGhhbiBQcm9taXNlLCB0aGVuIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseVxuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVN5bmNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkU2hhcmVTeW5jKHBrZ05hbWUsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNoYXJlZEhhbmRsZXIubG9hZFNoYXJlU3luYyhwa2dOYW1lLCBleHRyYU9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdGlhbGl6ZVNoYXJpbmdcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplU2hhcmluZyhyZWYsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlTmFtZSA9IHJlZiA9PT0gdm9pZCAwID8gREVGQVVMVF9TQ09QRSA6IHJlZjtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zaGFyZWRIYW5kbGVyLmluaXRpYWxpemVTaGFyaW5nKHNoYXJlU2NvcGVOYW1lLCBleHRyYU9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFJhd0NvbnRhaW5lclwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRSYXdDb250YWluZXIobmFtZTEsIHVybCwgY29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBnZXRSZW1vdGVJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5OiB1cmxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gbmV3IE1vZHVsZSh7XG4gICAgICAgICAgICAgICAgICAgIGhvc3Q6IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm9cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBtb2R1bGUucmVtb3RlRW50cnlFeHBvcnRzID0gY29udGFpbmVyO1xuICAgICAgICAgICAgICAgIHRoaXMubW9kdWxlQ2FjaGUuc2V0KG5hbWUxLCBtb2R1bGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2FkUmVtb3RlXCIsXG4gICAgICAgICAgICB2YWx1ZTogLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1saW5lcy1wZXItZnVuY3Rpb25cbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbWVtYmVyLW9yZGVyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2FkUmVtb3RlKGlkLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZUhhbmRsZXIubG9hZFJlbW90ZShpZCwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInByZWxvYWRSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAgZnVuY3Rpb24gcHJlbG9hZFJlbW90ZShwcmVsb2FkT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVIYW5kbGVyLnByZWxvYWRSZW1vdGUocHJlbG9hZE9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0U2hhcmVTY29wZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRTaGFyZVNjb3BlTWFwKHNjb3BlTmFtZSwgc2hhcmVTY29wZSwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4dHJhT3B0aW9ucyA9IHJlZiA9PT0gdm9pZCAwID8ge30gOiByZWY7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRIYW5kbGVyLmluaXRTaGFyZVNjb3BlTWFwKHNjb3BlTmFtZSwgc2hhcmVTY29wZSwgZXh0cmFPcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImZvcm1hdE9wdGlvbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JtYXRPcHRpb25zKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlZCA9IGZvcm1hdFNoYXJlQ29uZmlncyhnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucykuc2hhcmVkO1xuICAgICAgICAgICAgICAgIHZhciBfdGhpc19ob29rc19saWZlY3ljbGVfYmVmb3JlSW5pdF9lbWl0ID0gdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlSW5pdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICB1c2VyT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogZ2xvYmFsT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvOiBzaGFyZWRcbiAgICAgICAgICAgICAgICB9KSwgdXNlck9wdGlvbnNSZXMgPSBfdGhpc19ob29rc19saWZlY3ljbGVfYmVmb3JlSW5pdF9lbWl0LnVzZXJPcHRpb25zLCBnbG9iYWxPcHRpb25zUmVzID0gX3RoaXNfaG9va3NfbGlmZWN5Y2xlX2JlZm9yZUluaXRfZW1pdC5vcHRpb25zO1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVzID0gdGhpcy5yZW1vdGVIYW5kbGVyLmZvcm1hdEFuZFJlZ2lzdGVyUmVtb3RlKGdsb2JhbE9wdGlvbnNSZXMsIHVzZXJPcHRpb25zUmVzKTtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXNfc2hhcmVkSGFuZGxlcl9yZWdpc3RlclNoYXJlZCA9IHRoaXMuc2hhcmVkSGFuZGxlci5yZWdpc3RlclNoYXJlZChnbG9iYWxPcHRpb25zUmVzLCB1c2VyT3B0aW9uc1JlcyksIGhhbmRsZWRTaGFyZWQgPSBfdGhpc19zaGFyZWRIYW5kbGVyX3JlZ2lzdGVyU2hhcmVkLnNoYXJlZDtcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2lucyA9IF90b19jb25zdW1hYmxlX2FycmF5Ll8oZ2xvYmFsT3B0aW9uc1Jlcy5wbHVnaW5zKTtcbiAgICAgICAgICAgICAgICBpZiAodXNlck9wdGlvbnNSZXMucGx1Z2lucykge1xuICAgICAgICAgICAgICAgICAgICB1c2VyT3B0aW9uc1Jlcy5wbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGx1Z2lucy5pbmNsdWRlcyhwbHVnaW4pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2lucy5wdXNoKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uc1JlcyA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgZ2xvYmFsT3B0aW9ucywgdXNlck9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2lucyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlcyxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkOiBoYW5kbGVkU2hhcmVkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuaW5pdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zUmVzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnNSZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZWdpc3RlclBsdWdpbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlclBsdWdpbnMxKHBsdWdpbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2luUmVzID0gcmVnaXN0ZXJQbHVnaW5zKHBsdWdpbnMsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ob29rcyxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdGVIYW5kbGVyLmhvb2tzLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZEhhbmRsZXIuaG9va3MsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc25hcHNob3RIYW5kbGVyLmhvb2tzLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRlckhvb2ssXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnJpZGdlSG9va1xuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIC8vIE1lcmdlIHBsdWdpblxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wbHVnaW5zID0gdGhpcy5vcHRpb25zLnBsdWdpbnMucmVkdWNlKChyZXMsIHBsdWdpbik9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwbHVnaW4pIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgIXJlcy5maW5kKChpdGVtKT0+aXRlbS5uYW1lID09PSBwbHVnaW4ubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9LCBwbHVnaW5SZXMgfHwgW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVnaXN0ZXJSZW1vdGVzXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJSZW1vdGVzKHJlbW90ZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVIYW5kbGVyLnJlZ2lzdGVyUmVtb3RlcyhyZW1vdGVzLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBGZWRlcmF0aW9uSG9zdDtcbn0oKTtcbnZhciBpbmRleCA9IC8qI19fUFVSRV9fKi8gT2JqZWN0LmZyZWV6ZSh7XG4gICAgX19wcm90b19fOiBudWxsXG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImxvYWRTY3JpcHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBzZGsubG9hZFNjcmlwdDtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJsb2FkU2NyaXB0Tm9kZVwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHNkay5sb2FkU2NyaXB0Tm9kZTtcbiAgICB9XG59KSk7XG5leHBvcnRzLkN1cnJlbnRHbG9iYWwgPSBDdXJyZW50R2xvYmFsO1xuZXhwb3J0cy5GZWRlcmF0aW9uSG9zdCA9IEZlZGVyYXRpb25Ib3N0O1xuZXhwb3J0cy5HbG9iYWwgPSBHbG9iYWw7XG5leHBvcnRzLk1vZHVsZSA9IE1vZHVsZTtcbmV4cG9ydHMuYWRkR2xvYmFsU25hcHNob3QgPSBhZGRHbG9iYWxTbmFwc2hvdDtcbmV4cG9ydHMuYXNzZXJ0ID0gYXNzZXJ0O1xuZXhwb3J0cy5nZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IgPSBnZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3I7XG5leHBvcnRzLmdldEdsb2JhbFNuYXBzaG90ID0gZ2V0R2xvYmFsU25hcHNob3Q7XG5leHBvcnRzLmdldEluZm9XaXRob3V0VHlwZSA9IGdldEluZm9XaXRob3V0VHlwZTtcbmV4cG9ydHMuZ2V0UmVnaXN0ZXJlZFNoYXJlID0gZ2V0UmVnaXN0ZXJlZFNoYXJlO1xuZXhwb3J0cy5nZXRSZW1vdGVFbnRyeSA9IGdldFJlbW90ZUVudHJ5O1xuZXhwb3J0cy5nZXRSZW1vdGVJbmZvID0gZ2V0UmVtb3RlSW5mbztcbmV4cG9ydHMuaGVscGVycyA9IGhlbHBlcnM7XG5leHBvcnRzLmlzU3RhdGljUmVzb3VyY2VzRXF1YWwgPSBpc1N0YXRpY1Jlc291cmNlc0VxdWFsO1xuZXhwb3J0cy5tYXRjaFJlbW90ZVdpdGhOYW1lQW5kRXhwb3NlID0gbWF0Y2hSZW1vdGVXaXRoTmFtZUFuZEV4cG9zZTtcbmV4cG9ydHMucmVnaXN0ZXJHbG9iYWxQbHVnaW5zID0gcmVnaXN0ZXJHbG9iYWxQbHVnaW5zO1xuZXhwb3J0cy5yZXNldEZlZGVyYXRpb25HbG9iYWxJbmZvID0gcmVzZXRGZWRlcmF0aW9uR2xvYmFsSW5mbztcbmV4cG9ydHMuc2FmZVdyYXBwZXIgPSBzYWZlV3JhcHBlcjtcbmV4cG9ydHMuc2F0aXNmeSA9IHNhdGlzZnk7XG5leHBvcnRzLnNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvciA9IHNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcjtcbmV4cG9ydHMuc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlID0gc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlO1xuZXhwb3J0cy50eXBlcyA9IGluZGV4O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvcG9seWZpbGxzLmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L3BvbHlmaWxscy5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gICAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQpIHtcbiAgICAgICAgZm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gc291cmNlKWlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbiAgICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIF9vYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzX2xvb3NlKHNvdXJjZSwgZXhjbHVkZWQpIHtcbiAgICBpZiAoc291cmNlID09IG51bGwpIHJldHVybiB7fTtcbiAgICB2YXIgdGFyZ2V0ID0ge307XG4gICAgdmFyIHNvdXJjZUtleXMgPSBPYmplY3Qua2V5cyhzb3VyY2UpO1xuICAgIHZhciBrZXksIGk7XG4gICAgZm9yKGkgPSAwOyBpIDwgc291cmNlS2V5cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIGtleSA9IHNvdXJjZUtleXNbaV07XG4gICAgICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7XG4gICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5leHBvcnRzLl9leHRlbmRzID0gX2V4dGVuZHM7XG5leHBvcnRzLl9vYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzX2xvb3NlID0gX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2U7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L2luZGV4LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgcnVudGltZUNvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbnZhciB1dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdXRpbHMuY2pzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvZGlzdC91dGlscy5janMuanNcIik7XG52YXIgRmVkZXJhdGlvbkluc3RhbmNlID0gbnVsbDtcbmZ1bmN0aW9uIGluaXQob3B0aW9ucykge1xuICAgIC8vIFJldHJpZXZlIHRoZSBzYW1lIGluc3RhbmNlIHdpdGggdGhlIHNhbWUgbmFtZVxuICAgIHZhciBpbnN0YW5jZSA9IHV0aWxzLmdldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZShvcHRpb25zLm5hbWUsIG9wdGlvbnMudmVyc2lvbik7XG4gICAgaWYgKCFpbnN0YW5jZSkge1xuICAgICAgICAvLyBSZXRyaWV2ZSBkZWJ1ZyBjb25zdHJ1Y3RvclxuICAgICAgICB2YXIgRmVkZXJhdGlvbkNvbnN0cnVjdG9yID0gcnVudGltZUNvcmUuZ2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yKCkgfHwgcnVudGltZUNvcmUuRmVkZXJhdGlvbkhvc3Q7XG4gICAgICAgIEZlZGVyYXRpb25JbnN0YW5jZSA9IG5ldyBGZWRlcmF0aW9uQ29uc3RydWN0b3Iob3B0aW9ucyk7XG4gICAgICAgIHJ1bnRpbWVDb3JlLnNldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZShGZWRlcmF0aW9uSW5zdGFuY2UpO1xuICAgICAgICByZXR1cm4gRmVkZXJhdGlvbkluc3RhbmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE1lcmdlIG9wdGlvbnNcbiAgICAgICAgaW5zdGFuY2UuaW5pdE9wdGlvbnMob3B0aW9ucyk7XG4gICAgICAgIGlmICghRmVkZXJhdGlvbkluc3RhbmNlKSB7XG4gICAgICAgICAgICBGZWRlcmF0aW9uSW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfVxufVxuZnVuY3Rpb24gbG9hZFJlbW90ZSguLi5hcmdzKSB7XG4gICAgcnVudGltZUNvcmUuYXNzZXJ0KEZlZGVyYXRpb25JbnN0YW5jZSwgJ1BsZWFzZSBjYWxsIGluaXQgZmlyc3QnKTtcbiAgICB2YXIgbG9hZFJlbW90ZTEgPSBGZWRlcmF0aW9uSW5zdGFuY2UubG9hZFJlbW90ZTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLXNwcmVhZFxuICAgIHJldHVybiBsb2FkUmVtb3RlMS5hcHBseShGZWRlcmF0aW9uSW5zdGFuY2UsIGFyZ3MpO1xufVxuZnVuY3Rpb24gbG9hZFNoYXJlKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgdmFyIGxvYWRTaGFyZTEgPSBGZWRlcmF0aW9uSW5zdGFuY2UubG9hZFNoYXJlO1xuICAgIHJldHVybiBsb2FkU2hhcmUxLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiBsb2FkU2hhcmVTeW5jKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIHZhciBsb2FkU2hhcmVTeW5jMSA9IEZlZGVyYXRpb25JbnN0YW5jZS5sb2FkU2hhcmVTeW5jO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIGxvYWRTaGFyZVN5bmMxLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiBwcmVsb2FkUmVtb3RlKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIEZlZGVyYXRpb25JbnN0YW5jZS5wcmVsb2FkUmVtb3RlLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiByZWdpc3RlclJlbW90ZXMoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICByZXR1cm4gRmVkZXJhdGlvbkluc3RhbmNlLnJlZ2lzdGVyUmVtb3Rlcy5hcHBseShGZWRlcmF0aW9uSW5zdGFuY2UsIGFyZ3MpO1xufVxuZnVuY3Rpb24gcmVnaXN0ZXJQbHVnaW5zKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIEZlZGVyYXRpb25JbnN0YW5jZS5yZWdpc3RlclBsdWdpbnMuYXBwbHkoRmVkZXJhdGlvbkluc3RhbmNlLCBhcmdzKTtcbn1cbmZ1bmN0aW9uIGdldEluc3RhbmNlKCkge1xuICAgIHJldHVybiBGZWRlcmF0aW9uSW5zdGFuY2U7XG59XG4vLyBJbmplY3QgZm9yIGRlYnVnXG5ydW50aW1lQ29yZS5zZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IocnVudGltZUNvcmUuRmVkZXJhdGlvbkhvc3QpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiRmVkZXJhdGlvbkhvc3RcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5GZWRlcmF0aW9uSG9zdDtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJNb2R1bGVcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5Nb2R1bGU7XG4gICAgfVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZ2V0UmVtb3RlRW50cnlcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5nZXRSZW1vdGVFbnRyeTtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJnZXRSZW1vdGVJbmZvXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcnVudGltZUNvcmUuZ2V0UmVtb3RlSW5mbztcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJsb2FkU2NyaXB0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcnVudGltZUNvcmUubG9hZFNjcmlwdDtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJsb2FkU2NyaXB0Tm9kZVwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLmxvYWRTY3JpcHROb2RlO1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInJlZ2lzdGVyR2xvYmFsUGx1Z2luc1wiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLnJlZ2lzdGVyR2xvYmFsUGx1Z2lucztcbiAgICB9XG59KSk7XG5leHBvcnRzLmdldEluc3RhbmNlID0gZ2V0SW5zdGFuY2U7XG5leHBvcnRzLmluaXQgPSBpbml0O1xuZXhwb3J0cy5sb2FkUmVtb3RlID0gbG9hZFJlbW90ZTtcbmV4cG9ydHMubG9hZFNoYXJlID0gbG9hZFNoYXJlO1xuZXhwb3J0cy5sb2FkU2hhcmVTeW5jID0gbG9hZFNoYXJlU3luYztcbmV4cG9ydHMucHJlbG9hZFJlbW90ZSA9IHByZWxvYWRSZW1vdGU7XG5leHBvcnRzLnJlZ2lzdGVyUGx1Z2lucyA9IHJlZ2lzdGVyUGx1Z2lucztcbmV4cG9ydHMucmVnaXN0ZXJSZW1vdGVzID0gcmVnaXN0ZXJSZW1vdGVzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L3V0aWxzLmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvZGlzdC91dGlscy5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIHJ1bnRpbWVDb3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lLWNvcmUvZGlzdC9pbmRleC5janMuanNcIik7XG4vLyBpbmplY3RlZCBieSBidW5kbGVyLCBzbyBpdCBjYW4gbm90IHVzZSBydW50aW1lLWNvcmUgc3R1ZmZcbmZ1bmN0aW9uIGdldEJ1aWxkZXJJZCgpIHtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICByZXR1cm4gIHRydWUgPyBcInNwb3J0czoxLjAuMFwiIDogMDtcbn1cbmZ1bmN0aW9uIGdldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZShuYW1lLCB2ZXJzaW9uKSB7XG4gICAgdmFyIGJ1aWxkSWQgPSBnZXRCdWlsZGVySWQoKTtcbiAgICByZXR1cm4gcnVudGltZUNvcmUuQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0lOU1RBTkNFU19fLmZpbmQoKEdNSW5zdGFuY2UpPT57XG4gICAgICAgIGlmIChidWlsZElkICYmIEdNSW5zdGFuY2Uub3B0aW9ucy5pZCA9PT0gZ2V0QnVpbGRlcklkKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChHTUluc3RhbmNlLm9wdGlvbnMubmFtZSA9PT0gbmFtZSAmJiAhR01JbnN0YW5jZS5vcHRpb25zLnZlcnNpb24gJiYgIXZlcnNpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChHTUluc3RhbmNlLm9wdGlvbnMubmFtZSA9PT0gbmFtZSAmJiB2ZXJzaW9uICYmIEdNSW5zdGFuY2Uub3B0aW9ucy52ZXJzaW9uID09PSB2ZXJzaW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG59XG5leHBvcnRzLmdldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZSA9IGdldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L2luZGV4LmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vc2RrL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIF9jbGFzc19jYWxsX2NoZWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NsYXNzX2NhbGxfY2hlY2sgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqc1wiKTtcbnZhciBfY3JlYXRlX2NsYXNzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NyZWF0ZV9jbGFzcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janNcIik7XG52YXIgX3NsaWNlZF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19zbGljZWRfdG9fYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL190b19hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2FycmF5LmNqc1wiKTtcbnZhciBfdG9fY29uc3VtYWJsZV9hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL190b19jb25zdW1hYmxlX2FycmF5ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fY29uc3VtYWJsZV9hcnJheS5janNcIik7XG52YXIgcG9seWZpbGxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9wb2x5ZmlsbHMuY2pzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L3BvbHlmaWxscy5janMuanNcIik7XG52YXIgRmVkZXJhdGlvbk1vZHVsZU1hbmlmZXN0ID0gJ2ZlZGVyYXRpb24tbWFuaWZlc3QuanNvbic7XG52YXIgTUFOSUZFU1RfRVhUID0gJy5qc29uJztcbnZhciBCUk9XU0VSX0xPR19LRVkgPSAnRkVERVJBVElPTl9ERUJVRyc7XG52YXIgQlJPV1NFUl9MT0dfVkFMVUUgPSAnMSc7XG52YXIgTmFtZVRyYW5zZm9ybVN5bWJvbCA9IHtcbiAgICBBVDogJ0AnLFxuICAgIEhZUEhFTjogJy0nLFxuICAgIFNMQVNIOiAnLydcbn07XG52YXIgTmFtZVRyYW5zZm9ybU1hcCA9IHtcbiAgICBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF06ICdzY29wZV8nLFxuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl06ICdfJyxcbiAgICBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF06ICdfXydcbn07XG52YXIgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXAgPSB7XG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF1dOiBOYW1lVHJhbnNmb3JtU3ltYm9sLkFULFxuICAgIFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXV06IE5hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOLFxuICAgIFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdXTogTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSFxufTtcbnZhciBTRVBBUkFUT1IgPSAnOic7XG52YXIgTWFuaWZlc3RGaWxlTmFtZSA9ICdtZi1tYW5pZmVzdC5qc29uJztcbnZhciBTdGF0c0ZpbGVOYW1lID0gJ21mLXN0YXRzLmpzb24nO1xudmFyIE1GTW9kdWxlVHlwZSA9IHtcbiAgICBOUE06ICducG0nLFxuICAgIEFQUDogJ2FwcCdcbn07XG52YXIgTU9EVUxFX0RFVlRPT0xfSURFTlRJRklFUiA9ICdfX01GX0RFVlRPT0xTX01PRFVMRV9JTkZPX18nO1xudmFyIEVOQ09ERV9OQU1FX1BSRUZJWCA9ICdFTkNPREVfTkFNRV9QUkVGSVgnO1xudmFyIFRFTVBfRElSID0gJy5mZWRlcmF0aW9uJztcbnZhciBNRlByZWZldGNoQ29tbW9uID0ge1xuICAgIGlkZW50aWZpZXI6ICdNRkRhdGFQcmVmZXRjaCcsXG4gICAgZ2xvYmFsS2V5OiAnX19QUkVGRVRDSF9fJyxcbiAgICBsaWJyYXJ5OiAnbWYtZGF0YS1wcmVmZXRjaCcsXG4gICAgZXhwb3J0c0tleTogJ19fUFJFRkVUQ0hfRVhQT1JUU19fJyxcbiAgICBmaWxlTmFtZTogJ2Jvb3RzdHJhcC5qcydcbn07XG52YXIgQ29udGFpbmVyUGx1Z2luID0gLyojX19QVVJFX18qLyBPYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGxcbn0pO1xudmFyIENvbnRhaW5lclJlZmVyZW5jZVBsdWdpbiA9IC8qI19fUFVSRV9fKi8gT2JqZWN0LmZyZWV6ZSh7XG4gICAgX19wcm90b19fOiBudWxsXG59KTtcbnZhciBNb2R1bGVGZWRlcmF0aW9uUGx1Z2luID0gLyojX19QVVJFX18qLyBPYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGxcbn0pO1xudmFyIFNoYXJlUGx1Z2luID0gLyojX19QVVJFX18qLyBPYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGxcbn0pO1xuZnVuY3Rpb24gaXNCcm93c2VyRW52KCkge1xuICAgIHJldHVybiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJztcbn1cbmZ1bmN0aW9uIGlzQnJvd3NlckRlYnVnKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmIChpc0Jyb3dzZXJFbnYoKSAmJiB3aW5kb3cubG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oQlJPV1NFUl9MT0dfS0VZKSA9PT0gQlJPV1NFUl9MT0dfVkFMVUU7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcjEpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBpc0RlYnVnTW9kZSgpIHtcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52WydGRURFUkFUSU9OX0RFQlVHJ10pIHtcbiAgICAgICAgcmV0dXJuIEJvb2xlYW4ocHJvY2Vzcy5lbnZbJ0ZFREVSQVRJT05fREVCVUcnXSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgRkVERVJBVElPTl9ERUJVRyAhPT0gJ3VuZGVmaW5lZCcgJiYgQm9vbGVhbihGRURFUkFUSU9OX0RFQlVHKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGlzQnJvd3NlckRlYnVnKCk7XG59XG52YXIgZ2V0UHJvY2Vzc0VudiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgcHJvY2Vzcy5lbnYgPyBwcm9jZXNzLmVudiA6IHt9O1xufTtcbnZhciBMT0dfQ0FURUdPUlkgPSAnWyBGZWRlcmF0aW9uIFJ1bnRpbWUgXSc7XG4vLyBlbnRyeTogbmFtZTp2ZXJzaW9uICAgdmVyc2lvbiA6IDEuMC4wIHwgXjEuMi4zXG4vLyBlbnRyeTogbmFtZTplbnRyeSAgZW50cnk6ICBodHRwczovL2xvY2FsaG9zdDo5MDAwL2ZlZGVyYXRpb24tbWFuaWZlc3QuanNvblxudmFyIHBhcnNlRW50cnkgPSAoc3RyLCBkZXZWZXJPclVybCwgcmVmKT0+e1xuICAgIHZhciBzZXBhcmF0b3IgPSByZWYgPT09IHZvaWQgMCA/IFNFUEFSQVRPUiA6IHJlZjtcbiAgICB2YXIgc3RyU3BsaXQgPSBzdHIuc3BsaXQoc2VwYXJhdG9yKTtcbiAgICB2YXIgZGV2VmVyc2lvbk9yVXJsID0gZ2V0UHJvY2Vzc0VudigpWydOT0RFX0VOViddID09PSAnZGV2ZWxvcG1lbnQnICYmIGRldlZlck9yVXJsO1xuICAgIHZhciBkZWZhdWx0VmVyc2lvbiA9ICcqJztcbiAgICB2YXIgaXNFbnRyeSA9IChzKT0+cy5zdGFydHNXaXRoKCdodHRwJykgfHwgcy5pbmNsdWRlcyhNQU5JRkVTVF9FWFQpO1xuICAgIC8vIENoZWNrIGlmIHRoZSBzdHJpbmcgc3RhcnRzIHdpdGggYSB0eXBlXG4gICAgaWYgKHN0clNwbGl0Lmxlbmd0aCA+PSAyKSB7XG4gICAgICAgIHZhciBfc3RyU3BsaXQgPSBfdG9fYXJyYXkuXyhzdHJTcGxpdCksIG5hbWUgPSBfc3RyU3BsaXRbMF0sIHZlcnNpb25PckVudHJ5QXJyID0gX3N0clNwbGl0LnNsaWNlKDEpO1xuICAgICAgICAvLyBAbmFtZUBtYW5pZmVzdC11cmwuanNvblxuICAgICAgICBpZiAoc3RyLnN0YXJ0c1dpdGgoc2VwYXJhdG9yKSkge1xuICAgICAgICAgICAgbmFtZSA9IHN0clNwbGl0LnNsaWNlKDAsIDIpLmpvaW4oc2VwYXJhdG9yKTtcbiAgICAgICAgICAgIHZlcnNpb25PckVudHJ5QXJyID0gW1xuICAgICAgICAgICAgICAgIGRldlZlcnNpb25PclVybCB8fCBzdHJTcGxpdC5zbGljZSgyKS5qb2luKHNlcGFyYXRvcilcbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZlcnNpb25PckVudHJ5ID0gZGV2VmVyc2lvbk9yVXJsIHx8IHZlcnNpb25PckVudHJ5QXJyLmpvaW4oc2VwYXJhdG9yKTtcbiAgICAgICAgaWYgKGlzRW50cnkodmVyc2lvbk9yRW50cnkpKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgZW50cnk6IHZlcnNpb25PckVudHJ5XG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gQXBwbHkgdmVyc2lvbiBydWxlXG4gICAgICAgICAgICAvLyBkZXZWZXJzaW9uT3JVcmwgPT4gaW5wdXRWZXJzaW9uID0+IGRlZmF1bHRWZXJzaW9uXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogdmVyc2lvbk9yRW50cnkgfHwgZGVmYXVsdFZlcnNpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHN0clNwbGl0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICB2YXIgX3N0clNwbGl0MSA9IF9zbGljZWRfdG9fYXJyYXkuXyhzdHJTcGxpdCwgMSksIG5hbWUxID0gX3N0clNwbGl0MVswXTtcbiAgICAgICAgaWYgKGRldlZlcnNpb25PclVybCAmJiBpc0VudHJ5KGRldlZlcnNpb25PclVybCkpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgZW50cnk6IGRldlZlcnNpb25PclVybFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICB2ZXJzaW9uOiBkZXZWZXJzaW9uT3JVcmwgfHwgZGVmYXVsdFZlcnNpb25cbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBgSW52YWxpZCBlbnRyeSB2YWx1ZTogJHtzdHJ9YDtcbiAgICB9XG59O1xudmFyIGNvbXBvc2VLZXlXaXRoU2VwYXJhdG9yID0gZnVuY3Rpb24oLi4uYXJncykge1xuICAgIGlmICghYXJncy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICByZXR1cm4gYXJncy5yZWR1Y2UoKHN1bSwgY3VyKT0+e1xuICAgICAgICBpZiAoIWN1cikge1xuICAgICAgICAgICAgcmV0dXJuIHN1bTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN1bSkge1xuICAgICAgICAgICAgcmV0dXJuIGN1cjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7c3VtfSR7U0VQQVJBVE9SfSR7Y3VyfWA7XG4gICAgfSwgJycpO1xufTtcbnZhciBlbmNvZGVOYW1lID0gZnVuY3Rpb24obmFtZSwgcmVmLCByZWYxKSB7XG4gICAgdmFyIHByZWZpeCA9IHJlZiA9PT0gdm9pZCAwID8gJycgOiByZWYsIHdpdGhFeHQgPSByZWYxID09PSB2b2lkIDAgPyBmYWxzZSA6IHJlZjE7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIGV4dCA9IHdpdGhFeHQgPyAnLmpzJyA6ICcnO1xuICAgICAgICByZXR1cm4gYCR7cHJlZml4fSR7bmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybVN5bWJvbC5BVH1gLCAnZycpLCBOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU59YCwgJ2cnKSwgTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIfWAsICdnJyksIE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF0pfSR7ZXh0fWA7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICB9XG59O1xudmFyIGRlY29kZU5hbWUgPSBmdW5jdGlvbihuYW1lLCBwcmVmaXgsIHdpdGhFeHQpIHtcbiAgICB0cnkge1xuICAgICAgICB2YXIgZGVjb2RlZE5hbWUgPSBuYW1lO1xuICAgICAgICBpZiAocHJlZml4KSB7XG4gICAgICAgICAgICBpZiAoIWRlY29kZWROYW1lLnN0YXJ0c1dpdGgocHJlZml4KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWNvZGVkTmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlY29kZWROYW1lID0gZGVjb2RlZE5hbWUucmVwbGFjZShuZXcgUmVnRXhwKHByZWZpeCwgJ2cnKSwgJycpO1xuICAgICAgICB9XG4gICAgICAgIGRlY29kZWROYW1lID0gZGVjb2RlZE5hbWUucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXV0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdfWAsICdnJyksIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF1dKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl1dKTtcbiAgICAgICAgaWYgKHdpdGhFeHQpIHtcbiAgICAgICAgICAgIGRlY29kZWROYW1lID0gZGVjb2RlZE5hbWUucmVwbGFjZSgnLmpzJywgJycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWNvZGVkTmFtZTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbn07XG52YXIgZ2VuZXJhdGVFeHBvc2VGaWxlbmFtZSA9IChleHBvc2VOYW1lLCB3aXRoRXh0KT0+e1xuICAgIGlmICghZXhwb3NlTmFtZSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIHZhciBleHBvc2UgPSBleHBvc2VOYW1lO1xuICAgIGlmIChleHBvc2UgPT09ICcuJykge1xuICAgICAgICBleHBvc2UgPSAnZGVmYXVsdF9leHBvcnQnO1xuICAgIH1cbiAgICBpZiAoZXhwb3NlLnN0YXJ0c1dpdGgoJy4vJykpIHtcbiAgICAgICAgZXhwb3NlID0gZXhwb3NlLnJlcGxhY2UoJy4vJywgJycpO1xuICAgIH1cbiAgICByZXR1cm4gZW5jb2RlTmFtZShleHBvc2UsICdfX2ZlZGVyYXRpb25fZXhwb3NlXycsIHdpdGhFeHQpO1xufTtcbnZhciBnZW5lcmF0ZVNoYXJlRmlsZW5hbWUgPSAocGtnTmFtZSwgd2l0aEV4dCk9PntcbiAgICBpZiAoIXBrZ05hbWUpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICByZXR1cm4gZW5jb2RlTmFtZShwa2dOYW1lLCAnX19mZWRlcmF0aW9uX3NoYXJlZF8nLCB3aXRoRXh0KTtcbn07XG52YXIgZ2V0UmVzb3VyY2VVcmwgPSAobW9kdWxlLCBzb3VyY2VVcmwpPT57XG4gICAgaWYgKCdnZXRQdWJsaWNQYXRoJyBpbiBtb2R1bGUpIHtcbiAgICAgICAgdmFyIHB1YmxpY1BhdGg7XG4gICAgICAgIGlmICghbW9kdWxlLmdldFB1YmxpY1BhdGguc3RhcnRzV2l0aCgnZnVuY3Rpb24nKSkge1xuICAgICAgICAgICAgcHVibGljUGF0aCA9IG5ldyBGdW5jdGlvbihtb2R1bGUuZ2V0UHVibGljUGF0aCkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHB1YmxpY1BhdGggPSBuZXcgRnVuY3Rpb24oJ3JldHVybiAnICsgbW9kdWxlLmdldFB1YmxpY1BhdGgpKCkoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7cHVibGljUGF0aH0ke3NvdXJjZVVybH1gO1xuICAgIH0gZWxzZSBpZiAoJ3B1YmxpY1BhdGgnIGluIG1vZHVsZSkge1xuICAgICAgICByZXR1cm4gYCR7bW9kdWxlLnB1YmxpY1BhdGh9JHtzb3VyY2VVcmx9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0Nhbm5vdCBnZXQgcmVzb3VyY2UgVVJMLiBJZiBpbiBkZWJ1ZyBtb2RlLCBwbGVhc2UgaWdub3JlLicsIG1vZHVsZSwgc291cmNlVXJsKTtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbn07XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xudmFyIGFzc2VydCA9IChjb25kaXRpb24sIG1zZyk9PntcbiAgICBpZiAoIWNvbmRpdGlvbikge1xuICAgICAgICBlcnJvcihtc2cpO1xuICAgIH1cbn07XG52YXIgZXJyb3IgPSAobXNnKT0+e1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtMT0dfQ0FURUdPUll9OiAke21zZ31gKTtcbn07XG52YXIgd2FybiA9IChtc2cpPT57XG4gICAgY29uc29sZS53YXJuKGAke0xPR19DQVRFR09SWX06ICR7bXNnfWApO1xufTtcbmZ1bmN0aW9uIHNhZmVUb1N0cmluZyhpbmZvKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGluZm8sIG51bGwsIDIpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbn1cbi8vIFJlZ0V4cCBmb3IgdmVyc2lvbiBzdHJpbmdcbnZhciBWRVJTSU9OX1BBVFRFUk5fUkVHRVhQID0gL14oW1xcZF49djw+fl18Wyp4WF0kKS87XG5mdW5jdGlvbiBpc1JlcXVpcmVkVmVyc2lvbihzdHIpIHtcbiAgICByZXR1cm4gVkVSU0lPTl9QQVRURVJOX1JFR0VYUC50ZXN0KHN0cik7XG59XG52YXIgc2ltcGxlSm9pblJlbW90ZUVudHJ5ID0gKHJQYXRoLCByTmFtZSk9PntcbiAgICBpZiAoIXJQYXRoKSB7XG4gICAgICAgIHJldHVybiByTmFtZTtcbiAgICB9XG4gICAgdmFyIHRyYW5zZm9ybVBhdGggPSAoc3RyKT0+e1xuICAgICAgICBpZiAoc3RyID09PSAnLicpIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyLnN0YXJ0c1dpdGgoJy4vJykpIHtcbiAgICAgICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgnLi8nLCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ci5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgIHZhciBzdHJXaXRob3V0U2xhc2ggPSBzdHIuc2xpY2UoMSk7XG4gICAgICAgICAgICBpZiAoc3RyV2l0aG91dFNsYXNoLmVuZHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyV2l0aG91dFNsYXNoLnNsaWNlKDAsIC0xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzdHJXaXRob3V0U2xhc2g7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICB9O1xuICAgIHZhciB0cmFuc2Zvcm1lZFBhdGggPSB0cmFuc2Zvcm1QYXRoKHJQYXRoKTtcbiAgICBpZiAoIXRyYW5zZm9ybWVkUGF0aCkge1xuICAgICAgICByZXR1cm4gck5hbWU7XG4gICAgfVxuICAgIGlmICh0cmFuc2Zvcm1lZFBhdGguZW5kc1dpdGgoJy8nKSkge1xuICAgICAgICByZXR1cm4gYCR7dHJhbnNmb3JtZWRQYXRofSR7ck5hbWV9YDtcbiAgICB9XG4gICAgcmV0dXJuIGAke3RyYW5zZm9ybWVkUGF0aH0vJHtyTmFtZX1gO1xufTtcbmZ1bmN0aW9uIGluZmVyQXV0b1B1YmxpY1BhdGgodXJsKSB7XG4gICAgcmV0dXJuIHVybC5yZXBsYWNlKC8jLiokLywgJycpLnJlcGxhY2UoL1xcPy4qJC8sICcnKS5yZXBsYWNlKC9cXC9bXlxcL10rJC8sICcvJyk7XG59XG4vLyBQcmlvcml0eTogb3ZlcnJpZGVzID4gcmVtb3Rlc1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1saW5lcy1wZXItZnVuY3Rpb25cbmZ1bmN0aW9uIGdlbmVyYXRlU25hcHNob3RGcm9tTWFuaWZlc3QobWFuaWZlc3QsIHJlZikge1xuICAgIHZhciBvcHRpb25zID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICB2YXIgX21hbmlmZXN0X21ldGFEYXRhLCBfbWFuaWZlc3RfbWV0YURhdGExO1xuICAgIHZhciBfb3B0aW9uc19yZW1vdGVzID0gb3B0aW9ucy5yZW1vdGVzLCByZW1vdGVzID0gX29wdGlvbnNfcmVtb3RlcyA9PT0gdm9pZCAwID8ge30gOiBfb3B0aW9uc19yZW1vdGVzLCBfb3B0aW9uc19vdmVycmlkZXMgPSBvcHRpb25zLm92ZXJyaWRlcywgb3ZlcnJpZGVzID0gX29wdGlvbnNfb3ZlcnJpZGVzID09PSB2b2lkIDAgPyB7fSA6IF9vcHRpb25zX292ZXJyaWRlcywgdmVyc2lvbiA9IG9wdGlvbnMudmVyc2lvbjtcbiAgICB2YXIgcmVtb3RlU25hcHNob3Q7XG4gICAgdmFyIGdldFB1YmxpY1BhdGggPSAoKT0+e1xuICAgICAgICBpZiAoJ3B1YmxpY1BhdGgnIGluIG1hbmlmZXN0Lm1ldGFEYXRhKSB7XG4gICAgICAgICAgICBpZiAobWFuaWZlc3QubWV0YURhdGEucHVibGljUGF0aCA9PT0gJ2F1dG8nICYmIHZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAvLyB1c2Ugc2FtZSBpbXBsZW1lbnRhdGlvbiBhcyBwdWJsaWNQYXRoIGF1dG8gcnVudGltZSBtb2R1bGUgaW1wbGVtZW50c1xuICAgICAgICAgICAgICAgIHJldHVybiBpbmZlckF1dG9QdWJsaWNQYXRoKHZlcnNpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG1hbmlmZXN0Lm1ldGFEYXRhLnB1YmxpY1BhdGg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbWFuaWZlc3QubWV0YURhdGEuZ2V0UHVibGljUGF0aDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmFyIG92ZXJyaWRlc0tleXMgPSBPYmplY3Qua2V5cyhvdmVycmlkZXMpO1xuICAgIHZhciByZW1vdGVzSW5mbyA9IHt9O1xuICAgIC8vIElmIHJlbW90ZXMgYXJlIG5vdCBwcm92aWRlZCwgb25seSB0aGUgcmVtb3RlcyBpbiB0aGUgbWFuaWZlc3Qgd2lsbCBiZSByZWFkXG4gICAgaWYgKCFPYmplY3Qua2V5cyhyZW1vdGVzKS5sZW5ndGgpIHtcbiAgICAgICAgdmFyIF9tYW5pZmVzdF9yZW1vdGVzO1xuICAgICAgICByZW1vdGVzSW5mbyA9ICgoX21hbmlmZXN0X3JlbW90ZXMgPSBtYW5pZmVzdC5yZW1vdGVzKSA9PSBudWxsID8gdm9pZCAwIDogX21hbmlmZXN0X3JlbW90ZXMucmVkdWNlKChyZXMsIG5leHQpPT57XG4gICAgICAgICAgICB2YXIgbWF0Y2hlZFZlcnNpb247XG4gICAgICAgICAgICB2YXIgbmFtZSA9IG5leHQuZmVkZXJhdGlvbkNvbnRhaW5lck5hbWU7XG4gICAgICAgICAgICAvLyBvdmVycmlkZXMgaGF2ZSBoaWdoZXIgcHJpb3JpdHlcbiAgICAgICAgICAgIGlmIChvdmVycmlkZXNLZXlzLmluY2x1ZGVzKG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgbWF0Y2hlZFZlcnNpb24gPSBvdmVycmlkZXNbbmFtZV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICgndmVyc2lvbicgaW4gbmV4dCkge1xuICAgICAgICAgICAgICAgICAgICBtYXRjaGVkVmVyc2lvbiA9IG5leHQudmVyc2lvbjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtYXRjaGVkVmVyc2lvbiA9IG5leHQuZW50cnk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzW25hbWVdID0ge1xuICAgICAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSwge30pKSB8fCB7fTtcbiAgICB9XG4gICAgLy8gSWYgcmVtb3RlcyAoZGVwbG95IHNjZW5hcmlvKSBhcmUgc3BlY2lmaWVkLCB0aGV5IG5lZWQgdG8gYmUgdHJhdmVyc2VkIGFnYWluXG4gICAgT2JqZWN0LmtleXMocmVtb3RlcykuZm9yRWFjaCgoa2V5KT0+cmVtb3Rlc0luZm9ba2V5XSA9IHtcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlcyB3aWxsIG92ZXJyaWRlIGRlcGVuZGVuY2llc1xuICAgICAgICAgICAgbWF0Y2hlZFZlcnNpb246IG92ZXJyaWRlc0tleXMuaW5jbHVkZXMoa2V5KSA/IG92ZXJyaWRlc1trZXldIDogcmVtb3Rlc1trZXldXG4gICAgICAgIH0pO1xuICAgIHZhciBfbWFuaWZlc3RfbWV0YURhdGEyID0gbWFuaWZlc3QubWV0YURhdGEsIF9tYW5pZmVzdF9tZXRhRGF0YV9yZW1vdGVFbnRyeSA9IF9tYW5pZmVzdF9tZXRhRGF0YTIucmVtb3RlRW50cnksIHJlbW90ZUVudHJ5UGF0aCA9IF9tYW5pZmVzdF9tZXRhRGF0YV9yZW1vdGVFbnRyeS5wYXRoLCByZW1vdGVFbnRyeU5hbWUgPSBfbWFuaWZlc3RfbWV0YURhdGFfcmVtb3RlRW50cnkubmFtZSwgcmVtb3RlRW50cnlUeXBlID0gX21hbmlmZXN0X21ldGFEYXRhX3JlbW90ZUVudHJ5LnR5cGUsIHJlbW90ZVR5cGVzID0gX21hbmlmZXN0X21ldGFEYXRhMi50eXBlcywgYnVpbGRWZXJzaW9uID0gX21hbmlmZXN0X21ldGFEYXRhMi5idWlsZEluZm8uYnVpbGRWZXJzaW9uLCBnbG9iYWxOYW1lID0gX21hbmlmZXN0X21ldGFEYXRhMi5nbG9iYWxOYW1lLCBzc3JSZW1vdGVFbnRyeSA9IF9tYW5pZmVzdF9tZXRhRGF0YTIuc3NyUmVtb3RlRW50cnk7XG4gICAgdmFyIGV4cG9zZXMgPSBtYW5pZmVzdC5leHBvc2VzO1xuICAgIHZhciBiYXNpY1JlbW90ZVNuYXBzaG90ID0ge1xuICAgICAgICB2ZXJzaW9uOiB2ZXJzaW9uID8gdmVyc2lvbiA6ICcnLFxuICAgICAgICBidWlsZFZlcnNpb24sXG4gICAgICAgIGdsb2JhbE5hbWUsXG4gICAgICAgIHJlbW90ZUVudHJ5OiBzaW1wbGVKb2luUmVtb3RlRW50cnkocmVtb3RlRW50cnlQYXRoLCByZW1vdGVFbnRyeU5hbWUpLFxuICAgICAgICByZW1vdGVFbnRyeVR5cGUsXG4gICAgICAgIHJlbW90ZVR5cGVzOiBzaW1wbGVKb2luUmVtb3RlRW50cnkocmVtb3RlVHlwZXMucGF0aCwgcmVtb3RlVHlwZXMubmFtZSksXG4gICAgICAgIHJlbW90ZVR5cGVzWmlwOiByZW1vdGVUeXBlcy56aXAgfHwgJycsXG4gICAgICAgIHJlbW90ZVR5cGVzQVBJOiByZW1vdGVUeXBlcy5hcGkgfHwgJycsXG4gICAgICAgIHJlbW90ZXNJbmZvLFxuICAgICAgICBzaGFyZWQ6IG1hbmlmZXN0ID09IG51bGwgPyB2b2lkIDAgOiBtYW5pZmVzdC5zaGFyZWQubWFwKChpdGVtKT0+KHtcbiAgICAgICAgICAgICAgICBhc3NldHM6IGl0ZW0uYXNzZXRzLFxuICAgICAgICAgICAgICAgIHNoYXJlZE5hbWU6IGl0ZW0ubmFtZSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBpdGVtLnZlcnNpb25cbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgbW9kdWxlczogZXhwb3NlcyA9PSBudWxsID8gdm9pZCAwIDogZXhwb3Nlcy5tYXAoKGV4cG9zZSk9Pih7XG4gICAgICAgICAgICAgICAgbW9kdWxlTmFtZTogZXhwb3NlLm5hbWUsXG4gICAgICAgICAgICAgICAgbW9kdWxlUGF0aDogZXhwb3NlLnBhdGgsXG4gICAgICAgICAgICAgICAgYXNzZXRzOiBleHBvc2UuYXNzZXRzXG4gICAgICAgICAgICB9KSlcbiAgICB9O1xuICAgIGlmICgoX21hbmlmZXN0X21ldGFEYXRhID0gbWFuaWZlc3QubWV0YURhdGEpID09IG51bGwgPyB2b2lkIDAgOiBfbWFuaWZlc3RfbWV0YURhdGEucHJlZmV0Y2hJbnRlcmZhY2UpIHtcbiAgICAgICAgdmFyIHByZWZldGNoSW50ZXJmYWNlID0gbWFuaWZlc3QubWV0YURhdGEucHJlZmV0Y2hJbnRlcmZhY2U7XG4gICAgICAgIGJhc2ljUmVtb3RlU25hcHNob3QgPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGJhc2ljUmVtb3RlU25hcHNob3QsIHtcbiAgICAgICAgICAgIHByZWZldGNoSW50ZXJmYWNlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoKF9tYW5pZmVzdF9tZXRhRGF0YTEgPSBtYW5pZmVzdC5tZXRhRGF0YSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9tYW5pZmVzdF9tZXRhRGF0YTEucHJlZmV0Y2hFbnRyeSkge1xuICAgICAgICB2YXIgX21hbmlmZXN0X21ldGFEYXRhX3ByZWZldGNoRW50cnkgPSBtYW5pZmVzdC5tZXRhRGF0YS5wcmVmZXRjaEVudHJ5LCBwYXRoID0gX21hbmlmZXN0X21ldGFEYXRhX3ByZWZldGNoRW50cnkucGF0aCwgbmFtZSA9IF9tYW5pZmVzdF9tZXRhRGF0YV9wcmVmZXRjaEVudHJ5Lm5hbWUsIHR5cGUgPSBfbWFuaWZlc3RfbWV0YURhdGFfcHJlZmV0Y2hFbnRyeS50eXBlO1xuICAgICAgICBiYXNpY1JlbW90ZVNuYXBzaG90ID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBiYXNpY1JlbW90ZVNuYXBzaG90LCB7XG4gICAgICAgICAgICBwcmVmZXRjaEVudHJ5OiBzaW1wbGVKb2luUmVtb3RlRW50cnkocGF0aCwgbmFtZSksXG4gICAgICAgICAgICBwcmVmZXRjaEVudHJ5VHlwZTogdHlwZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCdwdWJsaWNQYXRoJyBpbiBtYW5pZmVzdC5tZXRhRGF0YSkge1xuICAgICAgICByZW1vdGVTbmFwc2hvdCA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgYmFzaWNSZW1vdGVTbmFwc2hvdCwge1xuICAgICAgICAgICAgcHVibGljUGF0aDogZ2V0UHVibGljUGF0aCgpXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJlbW90ZVNuYXBzaG90ID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBiYXNpY1JlbW90ZVNuYXBzaG90LCB7XG4gICAgICAgICAgICBnZXRQdWJsaWNQYXRoOiBnZXRQdWJsaWNQYXRoKClcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChzc3JSZW1vdGVFbnRyeSkge1xuICAgICAgICB2YXIgZnVsbFNTUlJlbW90ZUVudHJ5ID0gc2ltcGxlSm9pblJlbW90ZUVudHJ5KHNzclJlbW90ZUVudHJ5LnBhdGgsIHNzclJlbW90ZUVudHJ5Lm5hbWUpO1xuICAgICAgICByZW1vdGVTbmFwc2hvdC5zc3JSZW1vdGVFbnRyeSA9IGZ1bGxTU1JSZW1vdGVFbnRyeTtcbiAgICAgICAgcmVtb3RlU25hcHNob3Quc3NyUmVtb3RlRW50cnlUeXBlID0gc3NyUmVtb3RlRW50cnkudHlwZSB8fCAnY29tbW9uanMtbW9kdWxlJztcbiAgICB9XG4gICAgcmV0dXJuIHJlbW90ZVNuYXBzaG90O1xufVxuZnVuY3Rpb24gaXNNYW5pZmVzdFByb3ZpZGVyKG1vZHVsZUluZm8pIHtcbiAgICBpZiAoJ3JlbW90ZUVudHJ5JyBpbiBtb2R1bGVJbmZvICYmIG1vZHVsZUluZm8ucmVtb3RlRW50cnkuaW5jbHVkZXMoTUFOSUZFU1RfRVhUKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxudmFyIFBSRUZJWCA9ICdbIE1vZHVsZSBGZWRlcmF0aW9uIF0nO1xudmFyIExvZ2dlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gTG9nZ2VyMShwcmVmaXgpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBMb2dnZXIxKTtcbiAgICAgICAgdGhpcy5wcmVmaXggPSBwcmVmaXg7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhMb2dnZXIxLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2dcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2coLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJ3YXJuXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd2FybjEoLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJlcnJvclwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGVycm9yMSguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInN1Y2Nlc3NcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdWNjZXNzKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5mb1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluZm8oLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZWFkeVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWR5KC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZGVidWdcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZWJ1ZyguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzRGVidWdNb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdKTtcbiAgICByZXR1cm4gTG9nZ2VyMTtcbn0oKTtcbmZ1bmN0aW9uIGNyZWF0ZUxvZ2dlcihwcmVmaXgpIHtcbiAgICByZXR1cm4gbmV3IExvZ2dlcihwcmVmaXgpO1xufVxudmFyIGxvZ2dlciA9IGNyZWF0ZUxvZ2dlcihQUkVGSVgpO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmZ1bmN0aW9uIHNhZmVXcmFwcGVyKGNhbGxiYWNrLCBkaXNhYmxlV2Fybikge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAhZGlzYWJsZVdhcm4gJiYgd2FybihlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pKCk7XG59XG5mdW5jdGlvbiBpc1N0YXRpY1Jlc291cmNlc0VxdWFsKHVybDEsIHVybDIpIHtcbiAgICB2YXIgUkVHX0VYUCA9IC9eKGh0dHBzPzopP1xcL1xcLy9pO1xuICAgIC8vIFRyYW5zZm9ybSB1cmwxIGFuZCB1cmwyIGludG8gcmVsYXRpdmUgcGF0aHNcbiAgICB2YXIgcmVsYXRpdmVVcmwxID0gdXJsMS5yZXBsYWNlKFJFR19FWFAsICcnKS5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgIHZhciByZWxhdGl2ZVVybDIgPSB1cmwyLnJlcGxhY2UoUkVHX0VYUCwgJycpLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gICAgLy8gQ2hlY2sgaWYgdGhlIHJlbGF0aXZlIHBhdGhzIGFyZSBpZGVudGljYWxcbiAgICByZXR1cm4gcmVsYXRpdmVVcmwxID09PSByZWxhdGl2ZVVybDI7XG59XG5mdW5jdGlvbiBjcmVhdGVTY3JpcHQoaW5mbykge1xuICAgIC8vIFJldHJpZXZlIHRoZSBleGlzdGluZyBzY3JpcHQgZWxlbWVudCBieSBpdHMgc3JjIGF0dHJpYnV0ZVxuICAgIHZhciBzY3JpcHQgPSBudWxsO1xuICAgIHZhciBuZWVkQXR0YWNoID0gdHJ1ZTtcbiAgICB2YXIgdGltZW91dCA9IDIwMDAwO1xuICAgIHZhciB0aW1lb3V0SWQ7XG4gICAgdmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0Jyk7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHNjcmlwdHMubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgcyA9IHNjcmlwdHNbaV07XG4gICAgICAgIHZhciBzY3JpcHRTcmMgPSBzLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgICAgIGlmIChzY3JpcHRTcmMgJiYgaXNTdGF0aWNSZXNvdXJjZXNFcXVhbChzY3JpcHRTcmMsIGluZm8udXJsKSkge1xuICAgICAgICAgICAgc2NyaXB0ID0gcztcbiAgICAgICAgICAgIG5lZWRBdHRhY2ggPSBmYWxzZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghc2NyaXB0KSB7XG4gICAgICAgIHZhciBhdHRycyA9IGluZm8uYXR0cnM7XG4gICAgICAgIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICBzY3JpcHQudHlwZSA9IChhdHRycyA9PSBudWxsID8gdm9pZCAwIDogYXR0cnNbJ3R5cGUnXSkgPT09ICdtb2R1bGUnID8gJ21vZHVsZScgOiAndGV4dC9qYXZhc2NyaXB0JztcbiAgICAgICAgdmFyIGNyZWF0ZVNjcmlwdFJlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGluZm8uY3JlYXRlU2NyaXB0SG9vaykge1xuICAgICAgICAgICAgY3JlYXRlU2NyaXB0UmVzID0gaW5mby5jcmVhdGVTY3JpcHRIb29rKGluZm8udXJsLCBpbmZvLmF0dHJzKTtcbiAgICAgICAgICAgIGlmIChjcmVhdGVTY3JpcHRSZXMgaW5zdGFuY2VvZiBIVE1MU2NyaXB0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHNjcmlwdCA9IGNyZWF0ZVNjcmlwdFJlcztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNyZWF0ZVNjcmlwdFJlcyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoJ3NjcmlwdCcgaW4gY3JlYXRlU2NyaXB0UmVzICYmIGNyZWF0ZVNjcmlwdFJlcy5zY3JpcHQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NyaXB0ID0gY3JlYXRlU2NyaXB0UmVzLnNjcmlwdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCd0aW1lb3V0JyBpbiBjcmVhdGVTY3JpcHRSZXMgJiYgY3JlYXRlU2NyaXB0UmVzLnRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IGNyZWF0ZVNjcmlwdFJlcy50aW1lb3V0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNjcmlwdC5zcmMpIHtcbiAgICAgICAgICAgIHNjcmlwdC5zcmMgPSBpbmZvLnVybDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXR0cnMgJiYgIWNyZWF0ZVNjcmlwdFJlcykge1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoYXR0cnMpLmZvckVhY2goKG5hbWUpPT57XG4gICAgICAgICAgICAgICAgaWYgKHNjcmlwdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gJ2FzeW5jJyB8fCBuYW1lID09PSAnZGVmZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRbbmFtZV0gPSBhdHRyc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQXR0cmlidXRlcyB0aGF0IGRvIG5vdCBleGlzdCBhcmUgY29uc2lkZXJlZCBvdmVycmlkZGVuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXNjcmlwdC5nZXRBdHRyaWJ1dGUobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdC5zZXRBdHRyaWJ1dGUobmFtZSwgYXR0cnNbbmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIG9uU2NyaXB0Q29tcGxldGUgPSAocHJldiwgZXZlbnQpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICAgICAgICB2YXIgb25TY3JpcHRDb21wbGV0ZUNhbGxiYWNrID0gKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoKGV2ZW50ID09IG51bGwgPyB2b2lkIDAgOiBldmVudC50eXBlKSA9PT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgICAgICAgICAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5vbkVycm9yQ2FsbGJhY2spICYmIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLm9uRXJyb3JDYWxsYmFjayhldmVudCkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLmNiKSAmJiAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5jYigpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gUHJldmVudCBtZW1vcnkgbGVha3MgaW4gSUUuXG4gICAgICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgc2NyaXB0Lm9uZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIHNjcmlwdC5vbmxvYWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHNhZmVXcmFwcGVyKCgpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBfaW5mb19uZWVkRGVsZXRlU2NyaXB0ID0gaW5mby5uZWVkRGVsZXRlU2NyaXB0LCBuZWVkRGVsZXRlU2NyaXB0ID0gX2luZm9fbmVlZERlbGV0ZVNjcmlwdCA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9pbmZvX25lZWREZWxldGVTY3JpcHQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZWVkRGVsZXRlU2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAoc2NyaXB0ID09IG51bGwgPyB2b2lkIDAgOiBzY3JpcHQucGFyZW50Tm9kZSkgJiYgc2NyaXB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2ICYmIHR5cGVvZiBwcmV2ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBwcmV2KGV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSB5aWVsZCByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBvblNjcmlwdENvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgb25TY3JpcHRDb21wbGV0ZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb25TY3JpcHRDb21wbGV0ZUNhbGxiYWNrKCk7XG4gICAgICAgIH0pKCk7XG4gICAgc2NyaXB0Lm9uZXJyb3IgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9uZXJyb3IpO1xuICAgIHNjcmlwdC5vbmxvYWQgPSBvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgc2NyaXB0Lm9ubG9hZCk7XG4gICAgdGltZW91dElkID0gc2V0VGltZW91dCgoKT0+e1xuICAgICAgICBvblNjcmlwdENvbXBsZXRlKG51bGwsIG5ldyBFcnJvcihgUmVtb3RlIHNjcmlwdCBcIiR7aW5mby51cmx9XCIgdGltZS1vdXRlZC5gKSk7XG4gICAgfSwgdGltZW91dCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2NyaXB0LFxuICAgICAgICBuZWVkQXR0YWNoXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUxpbmsoaW5mbykge1xuICAgIC8vIDxsaW5rIHJlbD1cInByZWxvYWRcIiBocmVmPVwic2NyaXB0LmpzXCIgYXM9XCJzY3JpcHRcIj5cbiAgICAvLyBSZXRyaWV2ZSB0aGUgZXhpc3Rpbmcgc2NyaXB0IGVsZW1lbnQgYnkgaXRzIHNyYyBhdHRyaWJ1dGVcbiAgICB2YXIgbGluayA9IG51bGw7XG4gICAgdmFyIG5lZWRBdHRhY2ggPSB0cnVlO1xuICAgIHZhciBsaW5rcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdsaW5rJyk7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgdmFyIGwgPSBsaW5rc1tpXTtcbiAgICAgICAgdmFyIGxpbmtIcmVmID0gbC5nZXRBdHRyaWJ1dGUoJ2hyZWYnKTtcbiAgICAgICAgdmFyIGxpbmtSZWwgPSBsLmdldEF0dHJpYnV0ZSgncmVsJyk7XG4gICAgICAgIGlmIChsaW5rSHJlZiAmJiBpc1N0YXRpY1Jlc291cmNlc0VxdWFsKGxpbmtIcmVmLCBpbmZvLnVybCkgJiYgbGlua1JlbCA9PT0gaW5mby5hdHRyc1sncmVsJ10pIHtcbiAgICAgICAgICAgIGxpbmsgPSBsO1xuICAgICAgICAgICAgbmVlZEF0dGFjaCA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFsaW5rKSB7XG4gICAgICAgIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7XG4gICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgaW5mby51cmwpO1xuICAgICAgICB2YXIgY3JlYXRlTGlua1JlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIGF0dHJzID0gaW5mby5hdHRycztcbiAgICAgICAgaWYgKGluZm8uY3JlYXRlTGlua0hvb2spIHtcbiAgICAgICAgICAgIGNyZWF0ZUxpbmtSZXMgPSBpbmZvLmNyZWF0ZUxpbmtIb29rKGluZm8udXJsLCBhdHRycyk7XG4gICAgICAgICAgICBpZiAoY3JlYXRlTGlua1JlcyBpbnN0YW5jZW9mIEhUTUxMaW5rRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGxpbmsgPSBjcmVhdGVMaW5rUmVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChhdHRycyAmJiAhY3JlYXRlTGlua1Jlcykge1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoYXR0cnMpLmZvckVhY2goKG5hbWUpPT57XG4gICAgICAgICAgICAgICAgaWYgKGxpbmsgJiYgIWxpbmsuZ2V0QXR0cmlidXRlKG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKG5hbWUsIGF0dHJzW25hbWVdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgb25MaW5rQ29tcGxldGUgPSAocHJldiwgZXZlbnQpPT57XG4gICAgICAgIHZhciBvbkxpbmtDb21wbGV0ZUNhbGxiYWNrID0gKCk9PntcbiAgICAgICAgICAgIGlmICgoZXZlbnQgPT0gbnVsbCA/IHZvaWQgMCA6IGV2ZW50LnR5cGUpID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgICAgICAgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8ub25FcnJvckNhbGxiYWNrKSAmJiAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5vbkVycm9yQ2FsbGJhY2soZXZlbnQpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8uY2IpICYmIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLmNiKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBQcmV2ZW50IG1lbW9yeSBsZWFrcyBpbiBJRS5cbiAgICAgICAgaWYgKGxpbmspIHtcbiAgICAgICAgICAgIGxpbmsub25lcnJvciA9IG51bGw7XG4gICAgICAgICAgICBsaW5rLm9ubG9hZCA9IG51bGw7XG4gICAgICAgICAgICBzYWZlV3JhcHBlcigoKT0+e1xuICAgICAgICAgICAgICAgIHZhciBfaW5mb19uZWVkRGVsZXRlTGluayA9IGluZm8ubmVlZERlbGV0ZUxpbmssIG5lZWREZWxldGVMaW5rID0gX2luZm9fbmVlZERlbGV0ZUxpbmsgPT09IHZvaWQgMCA/IHRydWUgOiBfaW5mb19uZWVkRGVsZXRlTGluaztcbiAgICAgICAgICAgICAgICBpZiAobmVlZERlbGV0ZUxpbmspIHtcbiAgICAgICAgICAgICAgICAgICAgKGxpbmsgPT0gbnVsbCA/IHZvaWQgMCA6IGxpbmsucGFyZW50Tm9kZSkgJiYgbGluay5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGxpbmspO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHByZXYpIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgIHZhciByZXMgPSBwcmV2KGV2ZW50KTtcbiAgICAgICAgICAgICAgICBvbkxpbmtDb21wbGV0ZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBvbkxpbmtDb21wbGV0ZUNhbGxiYWNrKCk7XG4gICAgfTtcbiAgICBsaW5rLm9uZXJyb3IgPSBvbkxpbmtDb21wbGV0ZS5iaW5kKG51bGwsIGxpbmsub25lcnJvcik7XG4gICAgbGluay5vbmxvYWQgPSBvbkxpbmtDb21wbGV0ZS5iaW5kKG51bGwsIGxpbmsub25sb2FkKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBsaW5rLFxuICAgICAgICBuZWVkQXR0YWNoXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGxvYWRTY3JpcHQodXJsLCBpbmZvKSB7XG4gICAgdmFyIF9pbmZvX2F0dHJzID0gaW5mby5hdHRycywgYXR0cnMgPSBfaW5mb19hdHRycyA9PT0gdm9pZCAwID8ge30gOiBfaW5mb19hdHRycywgY3JlYXRlU2NyaXB0SG9vayA9IGluZm8uY3JlYXRlU2NyaXB0SG9vaztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCk9PntcbiAgICAgICAgdmFyIF9jcmVhdGVTY3JpcHQgPSBjcmVhdGVTY3JpcHQoe1xuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgY2I6IHJlc29sdmUsXG4gICAgICAgICAgICBvbkVycm9yQ2FsbGJhY2s6IHJlamVjdCxcbiAgICAgICAgICAgIGF0dHJzOiBwb2x5ZmlsbHMuX2V4dGVuZHMoe1xuICAgICAgICAgICAgICAgIGZldGNocHJpb3JpdHk6ICdoaWdoJ1xuICAgICAgICAgICAgfSwgYXR0cnMpLFxuICAgICAgICAgICAgY3JlYXRlU2NyaXB0SG9vayxcbiAgICAgICAgICAgIG5lZWREZWxldGVTY3JpcHQ6IHRydWVcbiAgICAgICAgfSksIHNjcmlwdCA9IF9jcmVhdGVTY3JpcHQuc2NyaXB0LCBuZWVkQXR0YWNoID0gX2NyZWF0ZVNjcmlwdC5uZWVkQXR0YWNoO1xuICAgICAgICBuZWVkQXR0YWNoICYmIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGltcG9ydE5vZGVNb2R1bGUobmFtZSkge1xuICAgIGlmICghbmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ltcG9ydCBzcGVjaWZpZXIgaXMgcmVxdWlyZWQnKTtcbiAgICB9XG4gICAgdmFyIGltcG9ydE1vZHVsZSA9IG5ldyBGdW5jdGlvbignbmFtZScsIGByZXR1cm4gaW1wb3J0KG5hbWUpYCk7XG4gICAgcmV0dXJuIGltcG9ydE1vZHVsZShuYW1lKS50aGVuKChyZXMpPT5yZXMpLmNhdGNoKChlcnJvcjEpPT57XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGltcG9ydGluZyBtb2R1bGUgJHtuYW1lfTpgLCBlcnJvcjEpO1xuICAgICAgICB0aHJvdyBlcnJvcjE7XG4gICAgfSk7XG59XG52YXIgbG9hZE5vZGVGZXRjaCA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICB2YXIgZmV0Y2hNb2R1bGUgPSB5aWVsZCBpbXBvcnROb2RlTW9kdWxlKCdub2RlLWZldGNoJyk7XG4gICAgICAgIHJldHVybiBmZXRjaE1vZHVsZS5kZWZhdWx0IHx8IGZldGNoTW9kdWxlO1xuICAgIH0pKCk7XG52YXIgbGF6eUxvYWRlckhvb2tGZXRjaCA9IChpbnB1dCwgaW5pdCwgbG9hZGVySG9vayk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHZhciBob29rID0gKHVybCwgaW5pdCk9PntcbiAgICAgICAgICAgIHJldHVybiBsb2FkZXJIb29rLmxpZmVjeWNsZS5mZXRjaC5lbWl0KHVybCwgaW5pdCk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXMgPSB5aWVsZCBob29rKGlucHV0LCBpbml0IHx8IHt9KTtcbiAgICAgICAgaWYgKCFyZXMgfHwgIShyZXMgaW5zdGFuY2VvZiBSZXNwb25zZSkpIHtcbiAgICAgICAgICAgIHZhciBmZXRjaEZ1bmN0aW9uID0gdHlwZW9mIGZldGNoID09PSAndW5kZWZpbmVkJyA/IHlpZWxkIGxvYWROb2RlRmV0Y2goKSA6IGZldGNoO1xuICAgICAgICAgICAgcmV0dXJuIGZldGNoRnVuY3Rpb24oaW5wdXQsIGluaXQgfHwge30pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfSkoKTtcbmZ1bmN0aW9uIGNyZWF0ZVNjcmlwdE5vZGUodXJsLCBjYiwgYXR0cnMsIGxvYWRlckhvb2spIHtcbiAgICBpZiAobG9hZGVySG9vayA9PSBudWxsID8gdm9pZCAwIDogbG9hZGVySG9vay5jcmVhdGVTY3JpcHRIb29rKSB7XG4gICAgICAgIHZhciBob29rUmVzdWx0ID0gbG9hZGVySG9vay5jcmVhdGVTY3JpcHRIb29rKHVybCk7XG4gICAgICAgIGlmIChob29rUmVzdWx0ICYmIHR5cGVvZiBob29rUmVzdWx0ID09PSAnb2JqZWN0JyAmJiAndXJsJyBpbiBob29rUmVzdWx0KSB7XG4gICAgICAgICAgICB1cmwgPSBob29rUmVzdWx0LnVybDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgdXJsT2JqO1xuICAgIHRyeSB7XG4gICAgICAgIHVybE9iaiA9IG5ldyBVUkwodXJsKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNvbnN0cnVjdGluZyBVUkw6JywgZSk7XG4gICAgICAgIGNiKG5ldyBFcnJvcihgSW52YWxpZCBVUkw6ICR7ZX1gKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGdldEZldGNoID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICBpZiAobG9hZGVySG9vayA9PSBudWxsID8gdm9pZCAwIDogbG9hZGVySG9vay5mZXRjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoaW5wdXQsIGluaXQpPT5sYXp5TG9hZGVySG9va0ZldGNoKGlucHV0LCBpbml0LCBsb2FkZXJIb29rKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgZmV0Y2ggPT09ICd1bmRlZmluZWQnID8gbG9hZE5vZGVGZXRjaCgpIDogZmV0Y2g7XG4gICAgICAgIH0pKCk7XG4gICAgdmFyIGhhbmRsZVNjcmlwdEZldGNoID0gKGYsIHVybE9iaik9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBfdm1fY29uc3RhbnRzO1xuICAgICAgICAgICAgICAgIHZhciByZXMgPSB5aWVsZCBmKHVybE9iai5ocmVmKTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHlpZWxkIHJlcy50ZXh0KCk7XG4gICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8oKHlpZWxkIFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgICAgICAgICAgaW1wb3J0Tm9kZU1vZHVsZSgncGF0aCcpLFxuICAgICAgICAgICAgICAgICAgICBpbXBvcnROb2RlTW9kdWxlKCd2bScpXG4gICAgICAgICAgICAgICAgXSkpLCAyKSwgcGF0aCA9IF9yZWZbMF0sIHZtID0gX3JlZlsxXTtcbiAgICAgICAgICAgICAgICB2YXIgc2NyaXB0Q29udGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgZXhwb3J0czoge30sXG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0czoge31cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHVybERpcm5hbWUgPSB1cmxPYmoucGF0aG5hbWUuc3BsaXQoJy8nKS5zbGljZSgwLCAtMSkuam9pbignLycpO1xuICAgICAgICAgICAgICAgIHZhciBmaWxlbmFtZSA9IHBhdGguYmFzZW5hbWUodXJsT2JqLnBhdGhuYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgX3ZtX2NvbnN0YW50c19VU0VfTUFJTl9DT05URVhUX0RFRkFVTFRfTE9BREVSO1xuICAgICAgICAgICAgICAgIHZhciBzY3JpcHQgPSBuZXcgdm0uU2NyaXB0KGAoZnVuY3Rpb24oZXhwb3J0cywgbW9kdWxlLCByZXF1aXJlLCBfX2Rpcm5hbWUsIF9fZmlsZW5hbWUpIHske2RhdGF9XFxufSlgLCB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lLFxuICAgICAgICAgICAgICAgICAgICBpbXBvcnRNb2R1bGVEeW5hbWljYWxseTogKF92bV9jb25zdGFudHNfVVNFX01BSU5fQ09OVEVYVF9ERUZBVUxUX0xPQURFUiA9IChfdm1fY29uc3RhbnRzID0gdm0uY29uc3RhbnRzKSA9PSBudWxsID8gdm9pZCAwIDogX3ZtX2NvbnN0YW50cy5VU0VfTUFJTl9DT05URVhUX0RFRkFVTFRfTE9BREVSKSAhPSBudWxsID8gX3ZtX2NvbnN0YW50c19VU0VfTUFJTl9DT05URVhUX0RFRkFVTFRfTE9BREVSIDogaW1wb3J0Tm9kZU1vZHVsZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHNjcmlwdC5ydW5JblRoaXNDb250ZXh0KCkoc2NyaXB0Q29udGV4dC5leHBvcnRzLCBzY3JpcHRDb250ZXh0Lm1vZHVsZSwgZXZhbCgncmVxdWlyZScpLCB1cmxEaXJuYW1lLCBmaWxlbmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIGV4cG9ydGVkSW50ZXJmYWNlID0gc2NyaXB0Q29udGV4dC5tb2R1bGUuZXhwb3J0cyB8fCBzY3JpcHRDb250ZXh0LmV4cG9ydHM7XG4gICAgICAgICAgICAgICAgaWYgKGF0dHJzICYmIGV4cG9ydGVkSW50ZXJmYWNlICYmIGF0dHJzWydnbG9iYWxOYW1lJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IGV4cG9ydGVkSW50ZXJmYWNlW2F0dHJzWydnbG9iYWxOYW1lJ11dIHx8IGV4cG9ydGVkSW50ZXJmYWNlO1xuICAgICAgICAgICAgICAgICAgICBjYih1bmRlZmluZWQsIGNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2IodW5kZWZpbmVkLCBleHBvcnRlZEludGVyZmFjZSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY2IoZSBpbnN0YW5jZW9mIEVycm9yID8gZSA6IG5ldyBFcnJvcihgU2NyaXB0IGV4ZWN1dGlvbiBlcnJvcjogJHtlfWApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKTtcbiAgICBnZXRGZXRjaCgpLnRoZW4oKGYpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgaWYgKChhdHRycyA9PSBudWxsID8gdm9pZCAwIDogYXR0cnNbJ3R5cGUnXSkgPT09ICdlc20nIHx8IChhdHRycyA9PSBudWxsID8gdm9pZCAwIDogYXR0cnNbJ3R5cGUnXSkgPT09ICdtb2R1bGUnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRNb2R1bGUodXJsT2JqLmhyZWYsIHtcbiAgICAgICAgICAgICAgICAgICAgZmV0Y2g6IGYsXG4gICAgICAgICAgICAgICAgICAgIHZtOiB5aWVsZCBpbXBvcnROb2RlTW9kdWxlKCd2bScpXG4gICAgICAgICAgICAgICAgfSkudGhlbigobW9kdWxlKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIG1vZHVsZS5ldmFsdWF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2IodW5kZWZpbmVkLCBtb2R1bGUubmFtZXNwYWNlKTtcbiAgICAgICAgICAgICAgICAgICAgfSkoKSkuY2F0Y2goKGUpPT57XG4gICAgICAgICAgICAgICAgICAgIGNiKGUgaW5zdGFuY2VvZiBFcnJvciA/IGUgOiBuZXcgRXJyb3IoYFNjcmlwdCBleGVjdXRpb24gZXJyb3I6ICR7ZX1gKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoYW5kbGVTY3JpcHRGZXRjaChmLCB1cmxPYmopO1xuICAgICAgICB9KSgpKS5jYXRjaCgoZXJyKT0+e1xuICAgICAgICBjYihlcnIpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gbG9hZFNjcmlwdE5vZGUodXJsLCBpbmZvKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpPT57XG4gICAgICAgIGNyZWF0ZVNjcmlwdE5vZGUodXJsLCAoZXJyb3IxLCBzY3JpcHRDb250ZXh0KT0+e1xuICAgICAgICAgICAgaWYgKGVycm9yMSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcjEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgX2luZm9fYXR0cnMsIF9pbmZvX2F0dHJzMTtcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnlLZXkgPSAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogKF9pbmZvX2F0dHJzID0gaW5mby5hdHRycykgPT0gbnVsbCA/IHZvaWQgMCA6IF9pbmZvX2F0dHJzWydnbG9iYWxOYW1lJ10pIHx8IGBfX0ZFREVSQVRJT05fJHtpbmZvID09IG51bGwgPyB2b2lkIDAgOiAoX2luZm9fYXR0cnMxID0gaW5mby5hdHRycykgPT0gbnVsbCA/IHZvaWQgMCA6IF9pbmZvX2F0dHJzMVsnbmFtZSddfTpjdXN0b21fX2A7XG4gICAgICAgICAgICAgICAgdmFyIGVudHJ5RXhwb3J0cyA9IGdsb2JhbFRoaXNbcmVtb3RlRW50cnlLZXldID0gc2NyaXB0Q29udGV4dDtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGVudHJ5RXhwb3J0cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGluZm8uYXR0cnMsIGluZm8ubG9hZGVySG9vayk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBsb2FkTW9kdWxlKHVybCwgb3B0aW9ucykge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICB2YXIgZmV0Y2gxID0gb3B0aW9ucy5mZXRjaCwgdm0gPSBvcHRpb25zLnZtO1xuICAgICAgICB2YXIgcmVzcG9uc2UgPSB5aWVsZCBmZXRjaDEodXJsKTtcbiAgICAgICAgdmFyIGNvZGUgPSB5aWVsZCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIHZhciBtb2R1bGUgPSBuZXcgdm0uU291cmNlVGV4dE1vZHVsZShjb2RlLCB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBpbXBvcnRNb2R1bGVEeW5hbWljYWxseTogKHNwZWNpZmllciwgc2NyaXB0KT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc29sdmVkVXJsID0gbmV3IFVSTChzcGVjaWZpZXIsIHVybCkuaHJlZjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRNb2R1bGUocmVzb2x2ZWRVcmwsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIH0pKClcbiAgICAgICAgfSk7XG4gICAgICAgIHlpZWxkIG1vZHVsZS5saW5rKChzcGVjaWZpZXIpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIHZhciByZXNvbHZlZFVybCA9IG5ldyBVUkwoc3BlY2lmaWVyLCB1cmwpLmhyZWY7XG4gICAgICAgICAgICAgICAgdmFyIG1vZHVsZSA9IHlpZWxkIGxvYWRNb2R1bGUocmVzb2x2ZWRVcmwsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgICAgICAgICB9KSgpKTtcbiAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICB9KSgpO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplT3B0aW9ucyhlbmFibGVEZWZhdWx0LCBkZWZhdWx0T3B0aW9ucywga2V5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgaWYgKGVuYWJsZURlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRPcHRpb25zO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zICYmIHR5cGVvZiBvcHRpb25zID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCB0eXBlIGZvciBcXGAke2tleX1cXGAsIGV4cGVjdCBib29sZWFuL3VuZGVmaW5lZC9vYmplY3QsIGdvdDogJHt0eXBlb2Ygb3B0aW9uc31gKTtcbiAgICB9O1xufVxuZXhwb3J0cy5CUk9XU0VSX0xPR19LRVkgPSBCUk9XU0VSX0xPR19LRVk7XG5leHBvcnRzLkJST1dTRVJfTE9HX1ZBTFVFID0gQlJPV1NFUl9MT0dfVkFMVUU7XG5leHBvcnRzLkVOQ09ERV9OQU1FX1BSRUZJWCA9IEVOQ09ERV9OQU1FX1BSRUZJWDtcbmV4cG9ydHMuRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXAgPSBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcDtcbmV4cG9ydHMuRmVkZXJhdGlvbk1vZHVsZU1hbmlmZXN0ID0gRmVkZXJhdGlvbk1vZHVsZU1hbmlmZXN0O1xuZXhwb3J0cy5NQU5JRkVTVF9FWFQgPSBNQU5JRkVTVF9FWFQ7XG5leHBvcnRzLk1GTW9kdWxlVHlwZSA9IE1GTW9kdWxlVHlwZTtcbmV4cG9ydHMuTUZQcmVmZXRjaENvbW1vbiA9IE1GUHJlZmV0Y2hDb21tb247XG5leHBvcnRzLk1PRFVMRV9ERVZUT09MX0lERU5USUZJRVIgPSBNT0RVTEVfREVWVE9PTF9JREVOVElGSUVSO1xuZXhwb3J0cy5NYW5pZmVzdEZpbGVOYW1lID0gTWFuaWZlc3RGaWxlTmFtZTtcbmV4cG9ydHMuTmFtZVRyYW5zZm9ybU1hcCA9IE5hbWVUcmFuc2Zvcm1NYXA7XG5leHBvcnRzLk5hbWVUcmFuc2Zvcm1TeW1ib2wgPSBOYW1lVHJhbnNmb3JtU3ltYm9sO1xuZXhwb3J0cy5TRVBBUkFUT1IgPSBTRVBBUkFUT1I7XG5leHBvcnRzLlN0YXRzRmlsZU5hbWUgPSBTdGF0c0ZpbGVOYW1lO1xuZXhwb3J0cy5URU1QX0RJUiA9IFRFTVBfRElSO1xuZXhwb3J0cy5hc3NlcnQgPSBhc3NlcnQ7XG5leHBvcnRzLmNvbXBvc2VLZXlXaXRoU2VwYXJhdG9yID0gY29tcG9zZUtleVdpdGhTZXBhcmF0b3I7XG5leHBvcnRzLmNvbnRhaW5lclBsdWdpbiA9IENvbnRhaW5lclBsdWdpbjtcbmV4cG9ydHMuY29udGFpbmVyUmVmZXJlbmNlUGx1Z2luID0gQ29udGFpbmVyUmVmZXJlbmNlUGx1Z2luO1xuZXhwb3J0cy5jcmVhdGVMaW5rID0gY3JlYXRlTGluaztcbmV4cG9ydHMuY3JlYXRlTG9nZ2VyID0gY3JlYXRlTG9nZ2VyO1xuZXhwb3J0cy5jcmVhdGVTY3JpcHQgPSBjcmVhdGVTY3JpcHQ7XG5leHBvcnRzLmNyZWF0ZVNjcmlwdE5vZGUgPSBjcmVhdGVTY3JpcHROb2RlO1xuZXhwb3J0cy5kZWNvZGVOYW1lID0gZGVjb2RlTmFtZTtcbmV4cG9ydHMuZW5jb2RlTmFtZSA9IGVuY29kZU5hbWU7XG5leHBvcnRzLmVycm9yID0gZXJyb3I7XG5leHBvcnRzLmdlbmVyYXRlRXhwb3NlRmlsZW5hbWUgPSBnZW5lcmF0ZUV4cG9zZUZpbGVuYW1lO1xuZXhwb3J0cy5nZW5lcmF0ZVNoYXJlRmlsZW5hbWUgPSBnZW5lcmF0ZVNoYXJlRmlsZW5hbWU7XG5leHBvcnRzLmdlbmVyYXRlU25hcHNob3RGcm9tTWFuaWZlc3QgPSBnZW5lcmF0ZVNuYXBzaG90RnJvbU1hbmlmZXN0O1xuZXhwb3J0cy5nZXRQcm9jZXNzRW52ID0gZ2V0UHJvY2Vzc0VudjtcbmV4cG9ydHMuZ2V0UmVzb3VyY2VVcmwgPSBnZXRSZXNvdXJjZVVybDtcbmV4cG9ydHMuaW5mZXJBdXRvUHVibGljUGF0aCA9IGluZmVyQXV0b1B1YmxpY1BhdGg7XG5leHBvcnRzLmlzQnJvd3NlckVudiA9IGlzQnJvd3NlckVudjtcbmV4cG9ydHMuaXNEZWJ1Z01vZGUgPSBpc0RlYnVnTW9kZTtcbmV4cG9ydHMuaXNNYW5pZmVzdFByb3ZpZGVyID0gaXNNYW5pZmVzdFByb3ZpZGVyO1xuZXhwb3J0cy5pc1JlcXVpcmVkVmVyc2lvbiA9IGlzUmVxdWlyZWRWZXJzaW9uO1xuZXhwb3J0cy5pc1N0YXRpY1Jlc291cmNlc0VxdWFsID0gaXNTdGF0aWNSZXNvdXJjZXNFcXVhbDtcbmV4cG9ydHMubG9hZFNjcmlwdCA9IGxvYWRTY3JpcHQ7XG5leHBvcnRzLmxvYWRTY3JpcHROb2RlID0gbG9hZFNjcmlwdE5vZGU7XG5leHBvcnRzLmxvZ2dlciA9IGxvZ2dlcjtcbmV4cG9ydHMubW9kdWxlRmVkZXJhdGlvblBsdWdpbiA9IE1vZHVsZUZlZGVyYXRpb25QbHVnaW47XG5leHBvcnRzLm5vcm1hbGl6ZU9wdGlvbnMgPSBub3JtYWxpemVPcHRpb25zO1xuZXhwb3J0cy5wYXJzZUVudHJ5ID0gcGFyc2VFbnRyeTtcbmV4cG9ydHMuc2FmZVRvU3RyaW5nID0gc2FmZVRvU3RyaW5nO1xuZXhwb3J0cy5zYWZlV3JhcHBlciA9IHNhZmVXcmFwcGVyO1xuZXhwb3J0cy5zaGFyZVBsdWdpbiA9IFNoYXJlUGx1Z2luO1xuZXhwb3J0cy5zaW1wbGVKb2luUmVtb3RlRW50cnkgPSBzaW1wbGVKb2luUmVtb3RlRW50cnk7XG5leHBvcnRzLndhcm4gPSB3YXJuO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vc2RrL2Rpc3QvcG9seWZpbGxzLmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L3BvbHlmaWxscy5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gICAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQpIHtcbiAgICAgICAgZm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gc291cmNlKWlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbiAgICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmV4cG9ydHMuX2V4dGVuZHMgPSBfZXh0ZW5kcztcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvY29uc3RhbnQuY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvY29uc3RhbnQuY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgRkVERVJBVElPTl9TVVBQT1JURURfVFlQRVMgPSBbXG4gICAgJ3NjcmlwdCdcbl07XG5leHBvcnRzLkZFREVSQVRJT05fU1VQUE9SVEVEX1RZUEVTID0gRkVERVJBVElPTl9TVVBQT1JURURfVFlQRVM7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xudmFyIF9vYmplY3Rfc3ByZWFkID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX29iamVjdF9zcHJlYWQgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19vYmplY3Rfc3ByZWFkLmNqc1wiKTtcbnZhciBydW50aW1lID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbnZhciBjb25zdGFudCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vY29uc3RhbnQuY2pzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvY29uc3RhbnQuY2pzLmpzXCIpO1xuZnVuY3Rpb24gX2ludGVyb3BOYW1lc3BhY2VEZWZhdWx0KGUpIHtcbiAgICB2YXIgbiA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgaWYgKGUpIHtcbiAgICAgICAgT2JqZWN0LmtleXMoZSkuZm9yRWFjaChmdW5jdGlvbihrKSB7XG4gICAgICAgICAgICBpZiAoayAhPT0gJ2RlZmF1bHQnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIGspO1xuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLCBrLCBkLmdldCA/IGQgOiB7XG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZVtrXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgbi5kZWZhdWx0ID0gZTtcbiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZShuKTtcbn1cbnZhciBydW50aW1lX19uYW1lc3BhY2UgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wTmFtZXNwYWNlRGVmYXVsdChydW50aW1lKTtcbmZ1bmN0aW9uIGF0dGFjaFNoYXJlU2NvcGVNYXAod2VicGFja1JlcXVpcmUpIHtcbiAgICBpZiAoIXdlYnBhY2tSZXF1aXJlLlMgfHwgd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5oYXNBdHRhY2hTaGFyZVNjb3BlTWFwIHx8ICF3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlIHx8ICF3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlLnNoYXJlU2NvcGVNYXApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB3ZWJwYWNrUmVxdWlyZS5TID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZS5zaGFyZVNjb3BlTWFwO1xuICAgIHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaGFzQXR0YWNoU2hhcmVTY29wZU1hcCA9IHRydWU7XG59XG52YXIgTmFtZVRyYW5zZm9ybVN5bWJvbCA9IHtcbiAgICBBVDogJ0AnLFxuICAgIEhZUEhFTjogJy0nLFxuICAgIFNMQVNIOiAnLydcbn07XG52YXIgTmFtZVRyYW5zZm9ybU1hcCA9IHtcbiAgICBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF06ICdzY29wZV8nLFxuICAgIFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl06ICdfJyxcbiAgICBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF06ICdfXydcbn07XG52YXIgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXAgPSB7XG4gICAgW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF1dOiBOYW1lVHJhbnNmb3JtU3ltYm9sLkFULFxuICAgIFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXV06IE5hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOLFxuICAgIFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdXTogTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSFxufTtcbnZhciBFTkNPREVfTkFNRV9QUkVGSVggPSAnRU5DT0RFX05BTUVfUFJFRklYJztcbnZhciBkZWNvZGVOYW1lID0gZnVuY3Rpb24obmFtZSwgcHJlZml4LCB3aXRoRXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIGRlY29kZWROYW1lID0gbmFtZTtcbiAgICAgICAgaWYgKHByZWZpeCkge1xuICAgICAgICAgICAgaWYgKCFkZWNvZGVkTmFtZS5zdGFydHNXaXRoKHByZWZpeCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjb2RlZE5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWNvZGVkTmFtZSA9IGRlY29kZWROYW1lLnJlcGxhY2UobmV3IFJlZ0V4cChwcmVmaXgsICdnJyksICcnKTtcbiAgICAgICAgfVxuICAgICAgICBkZWNvZGVkTmFtZSA9IGRlY29kZWROYW1lLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdfWAsICdnJyksIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF1dKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXX1gLCAnZycpLCBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdXSkucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dfWAsICdnJyksIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dXSk7XG4gICAgICAgIGlmICh3aXRoRXh0KSA7XG4gICAgICAgIHJldHVybiBkZWNvZGVkTmFtZTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbn07XG5mdW5jdGlvbiByZW1vdGVzKG9wdGlvbnMpIHtcbiAgICB2YXIgY2h1bmtJZCA9IG9wdGlvbnMuY2h1bmtJZCwgcHJvbWlzZXMgPSBvcHRpb25zLnByb21pc2VzLCBjaHVua01hcHBpbmcgPSBvcHRpb25zLmNodW5rTWFwcGluZywgaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcgPSBvcHRpb25zLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nLCB3ZWJwYWNrUmVxdWlyZSA9IG9wdGlvbnMud2VicGFja1JlcXVpcmUsIGlkVG9SZW1vdGVNYXAgPSBvcHRpb25zLmlkVG9SZW1vdGVNYXA7XG4gICAgYXR0YWNoU2hhcmVTY29wZU1hcCh3ZWJwYWNrUmVxdWlyZSk7XG4gICAgaWYgKHdlYnBhY2tSZXF1aXJlLm8oY2h1bmtNYXBwaW5nLCBjaHVua0lkKSkge1xuICAgICAgICBjaHVua01hcHBpbmdbY2h1bmtJZF0uZm9yRWFjaCgoaWQpPT57XG4gICAgICAgICAgICB2YXIgZ2V0U2NvcGUgPSB3ZWJwYWNrUmVxdWlyZS5SO1xuICAgICAgICAgICAgaWYgKCFnZXRTY29wZSkge1xuICAgICAgICAgICAgICAgIGdldFNjb3BlID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nW2lkXTtcbiAgICAgICAgICAgIHZhciByZW1vdGVJbmZvcyA9IGlkVG9SZW1vdGVNYXBbaWRdO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSBzZWVtcyBub3Qgd29ya1xuICAgICAgICAgICAgaWYgKGdldFNjb3BlLmluZGV4T2YoZGF0YSkgPj0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgc2VlbXMgbm90IHdvcmtcbiAgICAgICAgICAgIGdldFNjb3BlLnB1c2goZGF0YSk7XG4gICAgICAgICAgICBpZiAoZGF0YS5wKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzLnB1c2goZGF0YS5wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbkVycm9yID0gKGVycm9yKT0+e1xuICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBuZXcgRXJyb3IoJ0NvbnRhaW5lciBtaXNzaW5nJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyb3IubWVzc2FnZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZSArPSBgXFxud2hpbGUgbG9hZGluZyBcIiR7ZGF0YVsxXX1cIiBmcm9tICR7ZGF0YVsyXX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZS5tW2lkXSA9ICgpPT57XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZGF0YS5wID0gMDtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgaGFuZGxlRnVuY3Rpb24gPSAoZm4sIGFyZzEsIGFyZzIsIGQsIG5leHQsIGZpcnN0KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gZm4oYXJnMSwgYXJnMik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9taXNlICYmIHByb21pc2UudGhlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBwcm9taXNlLnRoZW4oKHJlc3VsdCk9Pm5leHQocmVzdWx0LCBkKSwgb25FcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGRhdGEucCA9IHApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0KHByb21pc2UsIGQsIGZpcnN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgb25FeHRlcm5hbCA9IChleHRlcm5hbCwgXywgZmlyc3QpPT5leHRlcm5hbCA/IGhhbmRsZUZ1bmN0aW9uKHdlYnBhY2tSZXF1aXJlLkksIGRhdGFbMF0sIDAsIGV4dGVybmFsLCBvbkluaXRpYWxpemVkLCBmaXJzdCkgOiBvbkVycm9yKCk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdmFyXG4gICAgICAgICAgICB2YXIgb25Jbml0aWFsaXplZCA9IChfLCBleHRlcm5hbCwgZmlyc3QpPT5oYW5kbGVGdW5jdGlvbihleHRlcm5hbC5nZXQsIGRhdGFbMV0sIGdldFNjb3BlLCAwLCBvbkZhY3RvcnksIGZpcnN0KTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgICAgICAgICAgIHZhciBvbkZhY3RvcnkgPSAoZmFjdG9yeSk9PntcbiAgICAgICAgICAgICAgICBkYXRhLnAgPSAxO1xuICAgICAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlLm1baWRdID0gKG1vZHVsZTEpPT57XG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZTEuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBvblJlbW90ZUxvYWRlZCA9ICgpPT57XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZU5hbWUgPSBkZWNvZGVOYW1lKHJlbW90ZUluZm9zWzBdLm5hbWUsIEVOQ09ERV9OQU1FX1BSRUZJWCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVNb2R1bGVOYW1lID0gcmVtb3RlTmFtZSArIGRhdGFbMV0uc2xpY2UoMSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkUmVtb3RlID0gKCk9PndlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2UubG9hZFJlbW90ZShyZW1vdGVNb2R1bGVOYW1lLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZEZhY3Rvcnk6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdidWlsZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2Uub3B0aW9ucy5zaGFyZVN0cmF0ZWd5ID09PSAndmVyc2lvbi1maXJzdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChpbnN0YW5jZS5zaGFyZWRIYW5kbGVyLmluaXRpYWxpemVTaGFyaW5nKGRhdGFbMF0pKS50aGVuKCgpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRSZW1vdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2FkUmVtb3RlKCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciB1c2VSdW50aW1lTG9hZCA9IHJlbW90ZUluZm9zLmxlbmd0aCA9PT0gMSAmJiBjb25zdGFudC5GRURFUkFUSU9OX1NVUFBPUlRFRF9UWVBFUy5pbmNsdWRlcyhyZW1vdGVJbmZvc1swXS5leHRlcm5hbFR5cGUpICYmIHJlbW90ZUluZm9zWzBdLm5hbWU7XG4gICAgICAgICAgICBpZiAodXNlUnVudGltZUxvYWQpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVGdW5jdGlvbihvblJlbW90ZUxvYWRlZCwgZGF0YVsyXSwgMCwgMCwgb25GYWN0b3J5LCAxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlRnVuY3Rpb24od2VicGFja1JlcXVpcmUsIGRhdGFbMl0sIDAsIDAsIG9uRXh0ZXJuYWwsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBjb25zdW1lcyhvcHRpb25zKSB7XG4gICAgdmFyIGNodW5rSWQgPSBvcHRpb25zLmNodW5rSWQsIHByb21pc2VzID0gb3B0aW9ucy5wcm9taXNlcywgY2h1bmtNYXBwaW5nID0gb3B0aW9ucy5jaHVua01hcHBpbmcsIGluc3RhbGxlZE1vZHVsZXMgPSBvcHRpb25zLmluc3RhbGxlZE1vZHVsZXMsIG1vZHVsZVRvSGFuZGxlck1hcHBpbmcgPSBvcHRpb25zLm1vZHVsZVRvSGFuZGxlck1hcHBpbmcsIHdlYnBhY2tSZXF1aXJlID0gb3B0aW9ucy53ZWJwYWNrUmVxdWlyZTtcbiAgICBhdHRhY2hTaGFyZVNjb3BlTWFwKHdlYnBhY2tSZXF1aXJlKTtcbiAgICBpZiAod2VicGFja1JlcXVpcmUubyhjaHVua01hcHBpbmcsIGNodW5rSWQpKSB7XG4gICAgICAgIGNodW5rTWFwcGluZ1tjaHVua0lkXS5mb3JFYWNoKChpZCk9PntcbiAgICAgICAgICAgIGlmICh3ZWJwYWNrUmVxdWlyZS5vKGluc3RhbGxlZE1vZHVsZXMsIGlkKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlcy5wdXNoKGluc3RhbGxlZE1vZHVsZXNbaWRdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbkZhY3RvcnkgPSAoZmFjdG9yeSk9PntcbiAgICAgICAgICAgICAgICBpbnN0YWxsZWRNb2R1bGVzW2lkXSA9IDA7XG4gICAgICAgICAgICAgICAgd2VicGFja1JlcXVpcmUubVtpZF0gPSAobW9kdWxlMSk9PntcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdlYnBhY2tSZXF1aXJlLmNbaWRdO1xuICAgICAgICAgICAgICAgICAgICBtb2R1bGUxLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgb25FcnJvciA9IChlcnJvcik9PntcbiAgICAgICAgICAgICAgICBkZWxldGUgaW5zdGFsbGVkTW9kdWxlc1tpZF07XG4gICAgICAgICAgICAgICAgd2VicGFja1JlcXVpcmUubVtpZF0gPSAobW9kdWxlMSk9PntcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdlYnBhY2tSZXF1aXJlLmNbaWRdO1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGZlZGVyYXRpb25JbnN0YW5jZSA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgaWYgKCFmZWRlcmF0aW9uSW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGZWRlcmF0aW9uIGluc3RhbmNlIG5vdCBmb3VuZCEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX2lkID0gbW9kdWxlVG9IYW5kbGVyTWFwcGluZ1tpZF0sIHNoYXJlS2V5ID0gX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfaWQuc2hhcmVLZXksIGdldHRlciA9IF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX2lkLmdldHRlciwgc2hhcmVJbmZvID0gX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfaWQuc2hhcmVJbmZvO1xuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gZmVkZXJhdGlvbkluc3RhbmNlLmxvYWRTaGFyZShzaGFyZUtleSwge1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21TaGFyZUluZm86IHNoYXJlSW5mb1xuICAgICAgICAgICAgICAgIH0pLnRoZW4oKGZhY3RvcnkpPT57XG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWN0b3J5ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldHRlcigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWN0b3J5O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChwcm9taXNlLnRoZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChpbnN0YWxsZWRNb2R1bGVzW2lkXSA9IHByb21pc2UudGhlbihvbkZhY3RvcnkpLmNhdGNoKG9uRXJyb3IpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIG1haW50YWluIHByZXZpb3VzIGxvZ2ljXG4gICAgICAgICAgICAgICAgICAgIG9uRmFjdG9yeShwcm9taXNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuZnVuY3Rpb24gaW5pdGlhbGl6ZVNoYXJpbmcocmVmKSB7XG4gICAgdmFyIHNoYXJlU2NvcGVOYW1lID0gcmVmLnNoYXJlU2NvcGVOYW1lLCB3ZWJwYWNrUmVxdWlyZSA9IHJlZi53ZWJwYWNrUmVxdWlyZSwgaW5pdFByb21pc2VzID0gcmVmLmluaXRQcm9taXNlcywgaW5pdFRva2VucyA9IHJlZi5pbml0VG9rZW5zLCBpbml0U2NvcGUgPSByZWYuaW5pdFNjb3BlO1xuICAgIGlmICghaW5pdFNjb3BlKSBpbml0U2NvcGUgPSBbXTtcbiAgICB2YXIgbWZJbnN0YW5jZSA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2U7XG4gICAgLy8gaGFuZGxpbmcgY2lyY3VsYXIgaW5pdCBjYWxsc1xuICAgIHZhciBpbml0VG9rZW4gPSBpbml0VG9rZW5zW3NoYXJlU2NvcGVOYW1lXTtcbiAgICBpZiAoIWluaXRUb2tlbikgaW5pdFRva2VuID0gaW5pdFRva2Vuc1tzaGFyZVNjb3BlTmFtZV0gPSB7XG4gICAgICAgIGZyb206IG1mSW5zdGFuY2UubmFtZVxuICAgIH07XG4gICAgaWYgKGluaXRTY29wZS5pbmRleE9mKGluaXRUb2tlbikgPj0gMCkgcmV0dXJuO1xuICAgIGluaXRTY29wZS5wdXNoKGluaXRUb2tlbik7XG4gICAgdmFyIHByb21pc2UgPSBpbml0UHJvbWlzZXNbc2hhcmVTY29wZU5hbWVdO1xuICAgIGlmIChwcm9taXNlKSByZXR1cm4gcHJvbWlzZTtcbiAgICB2YXIgd2FybiA9IChtc2cpPT50eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYgY29uc29sZS53YXJuICYmIGNvbnNvbGUud2Fybihtc2cpO1xuICAgIHZhciBpbml0RXh0ZXJuYWwgPSAoaWQpPT57XG4gICAgICAgIHZhciBoYW5kbGVFcnJvciA9IChlcnIpPT53YXJuKCdJbml0aWFsaXphdGlvbiBvZiBzaGFyaW5nIGV4dGVybmFsIGZhaWxlZDogJyArIGVycik7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgXyRtb2R1bGUgPSB3ZWJwYWNrUmVxdWlyZShpZCk7XG4gICAgICAgICAgICBpZiAoIV8kbW9kdWxlKSByZXR1cm47XG4gICAgICAgICAgICB2YXIgaW5pdEZuID0gKG1vZHVsZTEpPT5tb2R1bGUxICYmIG1vZHVsZTEuaW5pdCAmJiAvLyBAdHMtaWdub3JlIGNvbXBhdCBsZWdhY3kgbWYgc2hhcmVkIGJlaGF2aW9yXG4gICAgICAgICAgICAgICAgbW9kdWxlMS5pbml0KHdlYnBhY2tSZXF1aXJlLlNbc2hhcmVTY29wZU5hbWVdLCBpbml0U2NvcGUpO1xuICAgICAgICAgICAgaWYgKF8kbW9kdWxlLnRoZW4pIHJldHVybiBwcm9taXNlcy5wdXNoKF8kbW9kdWxlLnRoZW4oaW5pdEZuLCBoYW5kbGVFcnJvcikpO1xuICAgICAgICAgICAgdmFyIGluaXRSZXN1bHQgPSBpbml0Rm4oXyRtb2R1bGUpO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgaWYgKGluaXRSZXN1bHQgJiYgdHlwZW9mIGluaXRSZXN1bHQgIT09ICdib29sZWFuJyAmJiBpbml0UmVzdWx0LnRoZW4pIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlcy5wdXNoKGluaXRSZXN1bHRbJ2NhdGNoJ10oaGFuZGxlRXJyb3IpKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBoYW5kbGVFcnJvcihlcnIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgcHJvbWlzZXMgPSBtZkluc3RhbmNlLmluaXRpYWxpemVTaGFyaW5nKHNoYXJlU2NvcGVOYW1lLCB7XG4gICAgICAgIHN0cmF0ZWd5OiBtZkluc3RhbmNlLm9wdGlvbnMuc2hhcmVTdHJhdGVneSxcbiAgICAgICAgaW5pdFNjb3BlLFxuICAgICAgICBmcm9tOiAnYnVpbGQnXG4gICAgfSk7XG4gICAgYXR0YWNoU2hhcmVTY29wZU1hcCh3ZWJwYWNrUmVxdWlyZSk7XG4gICAgdmFyIGJ1bmRsZXJSdW50aW1lUmVtb3Rlc09wdGlvbnMgPSB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzO1xuICAgIGlmIChidW5kbGVyUnVudGltZVJlbW90ZXNPcHRpb25zKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKGJ1bmRsZXJSdW50aW1lUmVtb3Rlc09wdGlvbnMuaWRUb1JlbW90ZU1hcCkuZm9yRWFjaCgobW9kdWxlSWQpPT57XG4gICAgICAgICAgICB2YXIgaW5mbyA9IGJ1bmRsZXJSdW50aW1lUmVtb3Rlc09wdGlvbnMuaWRUb1JlbW90ZU1hcFttb2R1bGVJZF07XG4gICAgICAgICAgICB2YXIgZXh0ZXJuYWxNb2R1bGVJZCA9IGJ1bmRsZXJSdW50aW1lUmVtb3Rlc09wdGlvbnMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdbbW9kdWxlSWRdWzJdO1xuICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGluaXRFeHRlcm5hbChleHRlcm5hbE1vZHVsZUlkKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IGluZm9bMF07XG4gICAgICAgICAgICAgICAgaWYgKCFjb25zdGFudC5GRURFUkFUSU9OX1NVUFBPUlRFRF9UWVBFUy5pbmNsdWRlcyhyZW1vdGVJbmZvLmV4dGVybmFsVHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5pdEV4dGVybmFsKGV4dGVybmFsTW9kdWxlSWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmICghcHJvbWlzZXMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBpbml0UHJvbWlzZXNbc2hhcmVTY29wZU5hbWVdID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGluaXRQcm9taXNlc1tzaGFyZVNjb3BlTmFtZV0gPSBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbigoKT0+aW5pdFByb21pc2VzW3NoYXJlU2NvcGVOYW1lXSA9IHRydWUpO1xufVxuZnVuY3Rpb24gaGFuZGxlSW5pdGlhbENvbnN1bWVzKG9wdGlvbnMpIHtcbiAgICB2YXIgbW9kdWxlSWQgPSBvcHRpb25zLm1vZHVsZUlkLCBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nID0gb3B0aW9ucy5tb2R1bGVUb0hhbmRsZXJNYXBwaW5nLCB3ZWJwYWNrUmVxdWlyZSA9IG9wdGlvbnMud2VicGFja1JlcXVpcmU7XG4gICAgdmFyIGZlZGVyYXRpb25JbnN0YW5jZSA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2U7XG4gICAgaWYgKCFmZWRlcmF0aW9uSW5zdGFuY2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGZWRlcmF0aW9uIGluc3RhbmNlIG5vdCBmb3VuZCEnKTtcbiAgICB9XG4gICAgdmFyIF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX21vZHVsZUlkID0gbW9kdWxlVG9IYW5kbGVyTWFwcGluZ1ttb2R1bGVJZF0sIHNoYXJlS2V5ID0gX21vZHVsZVRvSGFuZGxlck1hcHBpbmdfbW9kdWxlSWQuc2hhcmVLZXksIHNoYXJlSW5mbyA9IF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX21vZHVsZUlkLnNoYXJlSW5mbztcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gZmVkZXJhdGlvbkluc3RhbmNlLmxvYWRTaGFyZVN5bmMoc2hhcmVLZXksIHtcbiAgICAgICAgICAgIGN1c3RvbVNoYXJlSW5mbzogc2hhcmVJbmZvXG4gICAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdsb2FkU2hhcmVTeW5jIGZhaWxlZCEgVGhlIGZ1bmN0aW9uIHNob3VsZCBub3QgYmUgY2FsbGVkIHVubGVzcyB5b3Ugc2V0IFwiZWFnZXI6dHJ1ZVwiLiBJZiB5b3UgZG8gbm90IHNldCBpdCwgYW5kIGVuY291bnRlciB0aGlzIGlzc3VlLCB5b3UgY2FuIGNoZWNrIHdoZXRoZXIgYW4gYXN5bmMgYm91bmRhcnkgaXMgaW1wbGVtZW50ZWQuJyk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RoZSBvcmlnaW5hbCBlcnJvciBtZXNzYWdlIGlzIGFzIGZvbGxvd3M6ICcpO1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgfVxufVxuZnVuY3Rpb24gaW5zdGFsbEluaXRpYWxDb25zdW1lcyhvcHRpb25zKSB7XG4gICAgdmFyIG1vZHVsZVRvSGFuZGxlck1hcHBpbmcgPSBvcHRpb25zLm1vZHVsZVRvSGFuZGxlck1hcHBpbmcsIHdlYnBhY2tSZXF1aXJlID0gb3B0aW9ucy53ZWJwYWNrUmVxdWlyZSwgaW5zdGFsbGVkTW9kdWxlcyA9IG9wdGlvbnMuaW5zdGFsbGVkTW9kdWxlcywgaW5pdGlhbENvbnN1bWVzID0gb3B0aW9ucy5pbml0aWFsQ29uc3VtZXM7XG4gICAgaW5pdGlhbENvbnN1bWVzLmZvckVhY2goKGlkKT0+e1xuICAgICAgICB3ZWJwYWNrUmVxdWlyZS5tW2lkXSA9IChtb2R1bGUxKT0+e1xuICAgICAgICAgICAgLy8gSGFuZGxlIHNjZW5hcmlvIHdoZW4gbW9kdWxlIGlzIHVzZWQgc3luY2hyb25vdXNseVxuICAgICAgICAgICAgaW5zdGFsbGVkTW9kdWxlc1tpZF0gPSAwO1xuICAgICAgICAgICAgZGVsZXRlIHdlYnBhY2tSZXF1aXJlLmNbaWRdO1xuICAgICAgICAgICAgdmFyIGZhY3RvcnkgPSBoYW5kbGVJbml0aWFsQ29uc3VtZXMoe1xuICAgICAgICAgICAgICAgIG1vZHVsZUlkOiBpZCxcbiAgICAgICAgICAgICAgICBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nLFxuICAgICAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZmFjdG9yeSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgU2hhcmVkIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlIGZvciBlYWdlciBjb25zdW1wdGlvbjogJHtpZH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1vZHVsZTEuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICAgICAgfTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGluaXRDb250YWluZXJFbnRyeShvcHRpb25zKSB7XG4gICAgdmFyIHdlYnBhY2tSZXF1aXJlID0gb3B0aW9ucy53ZWJwYWNrUmVxdWlyZSwgc2hhcmVTY29wZSA9IG9wdGlvbnMuc2hhcmVTY29wZSwgaW5pdFNjb3BlID0gb3B0aW9ucy5pbml0U2NvcGUsIHNoYXJlU2NvcGVLZXkgPSBvcHRpb25zLnNoYXJlU2NvcGVLZXksIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMgPSBvcHRpb25zLnJlbW90ZUVudHJ5SW5pdE9wdGlvbnM7XG4gICAgaWYgKCF3ZWJwYWNrUmVxdWlyZS5TKSByZXR1cm47XG4gICAgaWYgKCF3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uIHx8ICF3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlIHx8ICF3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluaXRPcHRpb25zKSByZXR1cm47XG4gICAgdmFyIGZlZGVyYXRpb25JbnN0YW5jZSA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2U7XG4gICAgdmFyIG5hbWUgPSBzaGFyZVNjb3BlS2V5IHx8ICdkZWZhdWx0JztcbiAgICBmZWRlcmF0aW9uSW5zdGFuY2UuaW5pdE9wdGlvbnMoX29iamVjdF9zcHJlYWQuXyh7XG4gICAgICAgIG5hbWU6IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMubmFtZSxcbiAgICAgICAgcmVtb3RlczogW11cbiAgICB9LCByZW1vdGVFbnRyeUluaXRPcHRpb25zKSk7XG4gICAgZmVkZXJhdGlvbkluc3RhbmNlLmluaXRTaGFyZVNjb3BlTWFwKG5hbWUsIHNoYXJlU2NvcGUsIHtcbiAgICAgICAgaG9zdFNoYXJlU2NvcGVNYXA6IChyZW1vdGVFbnRyeUluaXRPcHRpb25zID09PSBudWxsIHx8IHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMuc2hhcmVTY29wZU1hcCkgfHwge31cbiAgICB9KTtcbiAgICBpZiAod2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKSB7XG4gICAgICAgIHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCh3ZWJwYWNrUmVxdWlyZSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5wcmVmZXRjaCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLnByZWZldGNoKCk7XG4gICAgfVxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICByZXR1cm4gd2VicGFja1JlcXVpcmUuSShuYW1lLCBpbml0U2NvcGUpO1xufVxudmFyIGZlZGVyYXRpb24gPSB7XG4gICAgcnVudGltZTogcnVudGltZV9fbmFtZXNwYWNlLFxuICAgIGluc3RhbmNlOiB1bmRlZmluZWQsXG4gICAgaW5pdE9wdGlvbnM6IHVuZGVmaW5lZCxcbiAgICBidW5kbGVyUnVudGltZToge1xuICAgICAgICByZW1vdGVzLFxuICAgICAgICBjb25zdW1lcyxcbiAgICAgICAgSTogaW5pdGlhbGl6ZVNoYXJpbmcsXG4gICAgICAgIFM6IHt9LFxuICAgICAgICBpbnN0YWxsSW5pdGlhbENvbnN1bWVzLFxuICAgICAgICBpbml0Q29udGFpbmVyRW50cnlcbiAgICB9LFxuICAgIGF0dGFjaFNoYXJlU2NvcGVNYXAsXG4gICAgYnVuZGxlclJ1bnRpbWVPcHRpb25zOiB7fVxufTtcbm1vZHVsZS5leHBvcnRzID0gZmVkZXJhdGlvbjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfbGlrZV90b19hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X2xpa2VfdG9fYXJyYXkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9hcnJheV9saWtlX3RvX2FycmF5KGFyciwgbGVuKSB7XG4gICAgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7XG4gICAgZm9yKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspYXJyMltpXSA9IGFycltpXTtcbiAgICByZXR1cm4gYXJyMjtcbn1cbmV4cG9ydHMuXyA9IF9hcnJheV9saWtlX3RvX2FycmF5O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRoX2hvbGVzLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aF9ob2xlcy5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2FycmF5X3dpdGhfaG9sZXMoYXJyKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjtcbn1cbmV4cG9ydHMuXyA9IF9hcnJheV93aXRoX2hvbGVzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRob3V0X2hvbGVzLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aG91dF9ob2xlcy5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9hcnJheV9saWtlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fYXJyYXlfbGlrZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV9saWtlX3RvX2FycmF5LmNqc1wiKTtcbmZ1bmN0aW9uIF9hcnJheV93aXRob3V0X2hvbGVzKGFycikge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlfbGlrZV90b19hcnJheS5fKGFycik7XG59XG5leHBvcnRzLl8gPSBfYXJyYXlfd2l0aG91dF9ob2xlcztcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQoc2VsZikge1xuICAgIGlmIChzZWxmID09PSB2b2lkIDApIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTtcbiAgICByZXR1cm4gc2VsZjtcbn1cbmV4cG9ydHMuXyA9IF9hc3NlcnRfdGhpc19pbml0aWFsaXplZDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykge1xuICAgIHRyeSB7XG4gICAgICAgIHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTtcbiAgICAgICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChpbmZvLmRvbmUpIHJlc29sdmUodmFsdWUpO1xuICAgIGVsc2UgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpO1xufVxuZnVuY3Rpb24gX2FzeW5jX3RvX2dlbmVyYXRvcihmbikge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgICAgICAgICBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgXCJuZXh0XCIsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIF90aHJvdyhlcnIpIHtcbiAgICAgICAgICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIFwidGhyb3dcIiwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9uZXh0KHVuZGVmaW5lZCk7XG4gICAgICAgIH0pO1xuICAgIH07XG59XG5leHBvcnRzLl8gPSBfYXN5bmNfdG9fZ2VuZXJhdG9yO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jYWxsX3N1cGVyLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2FsbF9zdXBlci5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9nZXRfcHJvdG90eXBlX29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fZ2V0X3Byb3RvdHlwZV9vZi5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19nZXRfcHJvdG90eXBlX29mLmNqc1wiKTtcbnZhciBfaXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9faXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdC5janNcIik7XG52YXIgX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybiA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybi5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4uY2pzXCIpO1xuZnVuY3Rpb24gX2NhbGxfc3VwZXIoX3RoaXMsIGRlcml2ZWQsIGFyZ3MpIHtcbiAgICAvLyBTdXBlclxuICAgIGRlcml2ZWQgPSBfZ2V0X3Byb3RvdHlwZV9vZi5fKGRlcml2ZWQpO1xuICAgIHJldHVybiBfcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuLl8oX3RoaXMsIF9pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QuXygpID8gUmVmbGVjdC5jb25zdHJ1Y3QoZGVyaXZlZCwgYXJncyB8fCBbXSwgX2dldF9wcm90b3R5cGVfb2YuXyhfdGhpcykuY29uc3RydWN0b3IpIDogZGVyaXZlZC5hcHBseShfdGhpcywgYXJncykpO1xufVxuZXhwb3J0cy5fID0gX2NhbGxfc3VwZXI7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NsYXNzX2NhbGxfY2hlY2suY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfY2xhc3NfY2FsbF9jaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcbiAgICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbn1cbmV4cG9ydHMuXyA9IF9jbGFzc19jYWxsX2NoZWNrO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTtcbiAgICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgICAgIGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTtcbiAgICB9XG59XG5mdW5jdGlvbiBfY3JlYXRlX2NsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykge1xuICAgIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xuICAgIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgICByZXR1cm4gQ29uc3RydWN0b3I7XG59XG5leHBvcnRzLl8gPSBfY3JlYXRlX2NsYXNzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19kZWZpbmVfcHJvcGVydHkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2RlZmluZV9wcm9wZXJ0eS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfZGVmaW5lX3Byb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkge1xuICAgIGlmIChrZXkgaW4gb2JqKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwge1xuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSBvYmpba2V5XSA9IHZhbHVlO1xuICAgIHJldHVybiBvYmo7XG59XG5leHBvcnRzLl8gPSBfZGVmaW5lX3Byb3BlcnR5O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19leHBvcnRfc3Rhci5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19leHBvcnRfc3Rhci5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9leHBvcnRfc3Rhcihmcm9tLCB0bykge1xuICAgIE9iamVjdC5rZXlzKGZyb20pLmZvckVhY2goZnVuY3Rpb24oaykge1xuICAgICAgICBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0bywgaykpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0bywgaywge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZyb21ba107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZnJvbTtcbn1cbmV4cG9ydHMuXyA9IF9leHBvcnRfc3RhcjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZ2V0X3Byb3RvdHlwZV9vZi5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2dldF9wcm90b3R5cGVfb2YuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9nZXRfcHJvdG90eXBlX29mKG8pIHtcbiAgICBleHBvcnRzLl8gPSBfZ2V0X3Byb3RvdHlwZV9vZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKG8pIHtcbiAgICAgICAgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTtcbiAgICB9O1xuICAgIHJldHVybiBfZ2V0X3Byb3RvdHlwZV9vZihvKTtcbn1cbmV4cG9ydHMuXyA9IF9nZXRfcHJvdG90eXBlX29mO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbmhlcml0cy5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbmhlcml0cy5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfc2V0X3Byb3RvdHlwZV9vZiA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3NldF9wcm90b3R5cGVfb2YuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2V0X3Byb3RvdHlwZV9vZi5janNcIik7XG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHtcbiAgICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICAgICAgICB2YWx1ZTogc3ViQ2xhc3MsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRfcHJvdG90eXBlX29mLl8oc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpO1xufVxuZXhwb3J0cy5fID0gX2luaGVyaXRzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdChvYmopIHtcbiAgICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDoge1xuICAgICAgICBkZWZhdWx0OiBvYmpcbiAgICB9O1xufVxuZXhwb3J0cy5fID0gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfaXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0KCkge1xuICAgIC8vIFNpbmNlIFJlZmxlY3QuY29uc3RydWN0IGNhbid0IGJlIHByb3Blcmx5IHBvbHlmaWxsZWQsIHNvbWVcbiAgICAvLyBpbXBsZW1lbnRhdGlvbnMgKGUuZy4gY29yZS1qc0AyKSBkb24ndCBzZXQgdGhlIGNvcnJlY3QgaW50ZXJuYWwgc2xvdHMuXG4gICAgLy8gVGhvc2UgcG9seWZpbGxzIGRvbid0IGFsbG93IHVzIHRvIHN1YmNsYXNzIGJ1aWx0LWlucywgc28gd2UgbmVlZCB0b1xuICAgIC8vIHVzZSBvdXIgZmFsbGJhY2sgaW1wbGVtZW50YXRpb24uXG4gICAgdHJ5IHtcbiAgICAgICAgLy8gSWYgdGhlIGludGVybmFsIHNsb3RzIGFyZW4ndCBzZXQsIHRoaXMgdGhyb3dzIGFuIGVycm9yIHNpbWlsYXIgdG9cbiAgICAgICAgLy8gICBUeXBlRXJyb3I6IHRoaXMgaXMgbm90IGEgQm9vbGVhbiBvYmplY3QuXG4gICAgICAgIHZhciByZXN1bHQgPSAhQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbigpIHt9KSk7XG4gICAgfSBjYXRjaCAoXykge31cbiAgICByZXR1cm4gKGV4cG9ydHMuXyA9IF9pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICEhcmVzdWx0O1xuICAgIH0pKCk7XG59XG5leHBvcnRzLl8gPSBfaXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pdGVyYWJsZV90b19hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pdGVyYWJsZV90b19hcnJheS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9pdGVyYWJsZV90b19hcnJheShpdGVyKSB7XG4gICAgaWYgKHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgaXRlcltTeW1ib2wuaXRlcmF0b3JdICE9IG51bGwgfHwgaXRlcltcIkBAaXRlcmF0b3JcIl0gIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTtcbiAgICB9XG59XG5leHBvcnRzLl8gPSBfaXRlcmFibGVfdG9fYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0KGFyciwgaSkge1xuICAgIHZhciBfaSA9IGFyciA9PSBudWxsID8gbnVsbCA6IHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgYXJyW1N5bWJvbC5pdGVyYXRvcl0gfHwgYXJyW1wiQEBpdGVyYXRvclwiXTtcbiAgICBpZiAoX2kgPT0gbnVsbCkgcmV0dXJuO1xuICAgIHZhciBfYXJyID0gW107XG4gICAgdmFyIF9uID0gdHJ1ZTtcbiAgICB2YXIgX2QgPSBmYWxzZTtcbiAgICB2YXIgX3MsIF9lO1xuICAgIHRyeSB7XG4gICAgICAgIGZvcihfaSA9IF9pLmNhbGwoYXJyKTsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSl7XG4gICAgICAgICAgICBfYXJyLnB1c2goX3MudmFsdWUpO1xuICAgICAgICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIF9kID0gdHJ1ZTtcbiAgICAgICAgX2UgPSBlcnI7XG4gICAgfSBmaW5hbGx5e1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCFfbiAmJiBfaVtcInJldHVyblwiXSAhPSBudWxsKSBfaVtcInJldHVyblwiXSgpO1xuICAgICAgICB9IGZpbmFsbHl7XG4gICAgICAgICAgICBpZiAoX2QpIHRocm93IF9lO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBfYXJyO1xufVxuZXhwb3J0cy5fID0gX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfcmVzdC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfcmVzdC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9ub25faXRlcmFibGVfcmVzdCgpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xufVxuZXhwb3J0cy5fID0gX25vbl9pdGVyYWJsZV9yZXN0O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfc3ByZWFkLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fbm9uX2l0ZXJhYmxlX3NwcmVhZC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX25vbl9pdGVyYWJsZV9zcHJlYWQoKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7XG59XG5leHBvcnRzLl8gPSBfbm9uX2l0ZXJhYmxlX3NwcmVhZDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fb2JqZWN0X3NwcmVhZC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX29iamVjdF9zcHJlYWQuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfZGVmaW5lX3Byb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fZGVmaW5lX3Byb3BlcnR5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2RlZmluZV9wcm9wZXJ0eS5janNcIik7XG5mdW5jdGlvbiBfb2JqZWN0X3NwcmVhZCh0YXJnZXQpIHtcbiAgICBmb3IodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307XG4gICAgICAgIHZhciBvd25LZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcbiAgICAgICAgaWYgKHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIG93bktleXMgPSBvd25LZXlzLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHNvdXJjZSkuZmlsdGVyKGZ1bmN0aW9uKHN5bSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwgc3ltKS5lbnVtZXJhYmxlO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIG93bktleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIF9kZWZpbmVfcHJvcGVydHkuXyh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbn1cbmV4cG9ydHMuXyA9IF9vYmplY3Rfc3ByZWFkO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4uY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybi5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2Fzc2VydF90aGlzX2luaXRpYWxpemVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQuY2pzXCIpO1xudmFyIF90eXBlX29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fdHlwZV9vZi5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190eXBlX29mLmNqc1wiKTtcbmZ1bmN0aW9uIF9wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4oc2VsZiwgY2FsbCkge1xuICAgIGlmIChjYWxsICYmIChfdHlwZV9vZi5fKGNhbGwpID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpKSByZXR1cm4gY2FsbDtcbiAgICByZXR1cm4gX2Fzc2VydF90aGlzX2luaXRpYWxpemVkLl8oc2VsZik7XG59XG5leHBvcnRzLl8gPSBfcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zZXRfcHJvdG90eXBlX29mLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2V0X3Byb3RvdHlwZV9vZi5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX3NldF9wcm90b3R5cGVfb2YobywgcCkge1xuICAgIGV4cG9ydHMuXyA9IF9zZXRfcHJvdG90eXBlX29mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKG8sIHApIHtcbiAgICAgICAgby5fX3Byb3RvX18gPSBwO1xuICAgICAgICByZXR1cm4gbztcbiAgICB9O1xuICAgIHJldHVybiBfc2V0X3Byb3RvdHlwZV9vZihvLCBwKTtcbn1cbmV4cG9ydHMuXyA9IF9zZXRfcHJvdG90eXBlX29mO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2FycmF5X3dpdGhfaG9sZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hcnJheV93aXRoX2hvbGVzLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhfaG9sZXMuY2pzXCIpO1xudmFyIF9pdGVyYWJsZV90b19hcnJheV9saW1pdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5X2xpbWl0LmNqc1wiKTtcbnZhciBfbm9uX2l0ZXJhYmxlX3Jlc3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19ub25faXRlcmFibGVfcmVzdC5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfcmVzdC5janNcIik7XG52YXIgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzXCIpO1xuZnVuY3Rpb24gX3NsaWNlZF90b19hcnJheShhcnIsIGkpIHtcbiAgICByZXR1cm4gX2FycmF5X3dpdGhfaG9sZXMuXyhhcnIpIHx8IF9pdGVyYWJsZV90b19hcnJheV9saW1pdC5fKGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5Ll8oYXJyLCBpKSB8fCBfbm9uX2l0ZXJhYmxlX3Jlc3QuXygpO1xufVxuZXhwb3J0cy5fID0gX3NsaWNlZF90b19hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fYXJyYXkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fYXJyYXkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2FycmF5X3dpdGhfaG9sZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hcnJheV93aXRoX2hvbGVzLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhfaG9sZXMuY2pzXCIpO1xudmFyIF9pdGVyYWJsZV90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiKTtcbnZhciBfbm9uX2l0ZXJhYmxlX3Jlc3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19ub25faXRlcmFibGVfcmVzdC5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19ub25faXRlcmFibGVfcmVzdC5janNcIik7XG52YXIgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzXCIpO1xuZnVuY3Rpb24gX3RvX2FycmF5KGFycikge1xuICAgIHJldHVybiBfYXJyYXlfd2l0aF9ob2xlcy5fKGFycikgfHwgX2l0ZXJhYmxlX3RvX2FycmF5Ll8oYXJyKSB8fCBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuXyhhcnIpIHx8IF9ub25faXRlcmFibGVfcmVzdC5fKCk7XG59XG5leHBvcnRzLl8gPSBfdG9fYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2FycmF5X3dpdGhvdXRfaG9sZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19hcnJheV93aXRob3V0X2hvbGVzLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhvdXRfaG9sZXMuY2pzXCIpO1xudmFyIF9pdGVyYWJsZV90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiKTtcbnZhciBfbm9uX2l0ZXJhYmxlX3NwcmVhZCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX25vbl9pdGVyYWJsZV9zcHJlYWQuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fbm9uX2l0ZXJhYmxlX3NwcmVhZC5janNcIik7XG52YXIgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuY2pzXCIpO1xuZnVuY3Rpb24gX3RvX2NvbnN1bWFibGVfYXJyYXkoYXJyKSB7XG4gICAgcmV0dXJuIF9hcnJheV93aXRob3V0X2hvbGVzLl8oYXJyKSB8fCBfaXRlcmFibGVfdG9fYXJyYXkuXyhhcnIpIHx8IF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5fKGFycikgfHwgX25vbl9pdGVyYWJsZV9zcHJlYWQuXygpO1xufVxuZXhwb3J0cy5fID0gX3RvX2NvbnN1bWFibGVfYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3R5cGVfb2YuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190eXBlX29mLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfdHlwZV9vZihvYmopIHtcbiAgICBcIkBzd2MvaGVscGVycyAtIHR5cGVvZlwiO1xuICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqO1xufVxuZXhwb3J0cy5fID0gX3R5cGVfb2Y7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9hcnJheV9saWtlX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fYXJyYXlfbGlrZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV9saWtlX3RvX2FycmF5LmNqc1wiKTtcbmZ1bmN0aW9uIF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheShvLCBtaW5MZW4pIHtcbiAgICBpZiAoIW8pIHJldHVybjtcbiAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlfbGlrZV90b19hcnJheS5fKG8sIG1pbkxlbik7XG4gICAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xuICAgIGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obik7XG4gICAgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlfbGlrZV90b19hcnJheS5fKG8sIG1pbkxlbik7XG59XG5leHBvcnRzLl8gPSBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL05hdGl2ZVNjcmlwdE1hbmFnZXIuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvTmF0aXZlU2NyaXB0TWFuYWdlci5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5mdW5jdGlvbiBfZXhwb3J0KHRhcmdldCwgYWxsKSB7XG4gICAgZm9yKHZhciBuYW1lIGluIGFsbClPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBuYW1lLCB7XG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGdldDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihhbGwsIG5hbWUpLmdldFxuICAgIH0pO1xufVxuX2V4cG9ydChleHBvcnRzLCB7XG4gICAgZ2V0IE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZCAoKSB7XG4gICAgICAgIHJldHVybiBOb3JtYWxpemVkU2NyaXB0TG9jYXRvckhUVFBNZXRob2Q7XG4gICAgfSxcbiAgICBnZXQgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlICgpIHtcbiAgICAgICAgcmV0dXJuIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZTtcbiAgICB9LFxuICAgIGdldCBkZWZhdWx0ICgpIHtcbiAgICAgICAgcmV0dXJuIF9kZWZhdWx0O1xuICAgIH1cbn0pO1xudmFyIF9yZWFjdG5hdGl2ZSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZSAqLyBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT8xYWZlXCIpO1xudmFyIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZCA9IGZ1bmN0aW9uKE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZCkge1xuICAgIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZFtcIkdFVFwiXSA9IFwiR0VUXCI7XG4gICAgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kW1wiUE9TVFwiXSA9IFwiUE9TVFwiO1xuICAgIHJldHVybiBOb3JtYWxpemVkU2NyaXB0TG9jYXRvckhUVFBNZXRob2Q7XG59KHt9KTtcbnZhciBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGUgPSBmdW5jdGlvbihOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGUpIHtcbiAgICBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGVbXCJTVFJJQ1RcIl0gPSBcInN0cmljdFwiO1xuICAgIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZVtcIkxBWFwiXSA9IFwibGF4XCI7XG4gICAgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlW1wiT0ZGXCJdID0gXCJvZmZcIjtcbiAgICByZXR1cm4gTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlO1xufSh7fSk7XG52YXIgX2RlZmF1bHQgPSBfcmVhY3RuYXRpdmUuVHVyYm9Nb2R1bGVSZWdpc3RyeS5nZXQoJ1NjcmlwdE1hbmFnZXInKTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvZXZlbnRzL2V2ZW50cy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9ldmVudHMvZXZlbnRzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKG1vZHVsZSkge1xuXCJ1c2Ugc3RyaWN0XCI7XG4vLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIFIgPSB0eXBlb2YgUmVmbGVjdCA9PT0gJ29iamVjdCcgPyBSZWZsZWN0IDogbnVsbDtcbnZhciBSZWZsZWN0QXBwbHkgPSBSICYmIHR5cGVvZiBSLmFwcGx5ID09PSAnZnVuY3Rpb24nID8gUi5hcHBseSA6IGZ1bmN0aW9uIFJlZmxlY3RBcHBseSh0YXJnZXQsIHJlY2VpdmVyLCBhcmdzKSB7XG4gICAgcmV0dXJuIEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseS5jYWxsKHRhcmdldCwgcmVjZWl2ZXIsIGFyZ3MpO1xufTtcbnZhciBSZWZsZWN0T3duS2V5cztcbmlmIChSICYmIHR5cGVvZiBSLm93bktleXMgPT09ICdmdW5jdGlvbicpIHtcbiAgICBSZWZsZWN0T3duS2V5cyA9IFIub3duS2V5cztcbn0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykge1xuICAgIFJlZmxlY3RPd25LZXlzID0gZnVuY3Rpb24gUmVmbGVjdE93bktleXModGFyZ2V0KSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0YXJnZXQpLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHRhcmdldCkpO1xuICAgIH07XG59IGVsc2Uge1xuICAgIFJlZmxlY3RPd25LZXlzID0gZnVuY3Rpb24gUmVmbGVjdE93bktleXModGFyZ2V0KSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0YXJnZXQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBQcm9jZXNzRW1pdFdhcm5pbmcod2FybmluZykge1xuICAgIGlmIChjb25zb2xlICYmIGNvbnNvbGUud2FybikgY29uc29sZS53YXJuKHdhcm5pbmcpO1xufVxudmFyIE51bWJlcklzTmFOID0gTnVtYmVyLmlzTmFOIHx8IGZ1bmN0aW9uIE51bWJlcklzTmFOKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICE9PSB2YWx1ZTtcbn07XG5mdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XG4gICAgRXZlbnRFbWl0dGVyLmluaXQuY2FsbCh0aGlzKTtcbn1cbm1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyO1xubW9kdWxlLmV4cG9ydHMub25jZSA9IG9uY2U7XG4vLyBCYWNrd2FyZHMtY29tcGF0IHdpdGggbm9kZSAwLjEwLnhcbkV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLl9ldmVudHMgPSB1bmRlZmluZWQ7XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLl9ldmVudHNDb3VudCA9IDA7XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLl9tYXhMaXN0ZW5lcnMgPSB1bmRlZmluZWQ7XG4vLyBCeSBkZWZhdWx0IEV2ZW50RW1pdHRlcnMgd2lsbCBwcmludCBhIHdhcm5pbmcgaWYgbW9yZSB0aGFuIDEwIGxpc3RlbmVycyBhcmVcbi8vIGFkZGVkIHRvIGl0LiBUaGlzIGlzIGEgdXNlZnVsIGRlZmF1bHQgd2hpY2ggaGVscHMgZmluZGluZyBtZW1vcnkgbGVha3MuXG52YXIgZGVmYXVsdE1heExpc3RlbmVycyA9IDEwO1xuZnVuY3Rpb24gY2hlY2tMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIFwibGlzdGVuZXJcIiBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGUgRnVuY3Rpb24uIFJlY2VpdmVkIHR5cGUgJyArIHR5cGVvZiBsaXN0ZW5lcik7XG4gICAgfVxufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KEV2ZW50RW1pdHRlciwgJ2RlZmF1bHRNYXhMaXN0ZW5lcnMnLCB7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdE1heExpc3RlbmVycztcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24oYXJnKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYXJnICE9PSAnbnVtYmVyJyB8fCBhcmcgPCAwIHx8IE51bWJlcklzTmFOKGFyZykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdUaGUgdmFsdWUgb2YgXCJkZWZhdWx0TWF4TGlzdGVuZXJzXCIgaXMgb3V0IG9mIHJhbmdlLiBJdCBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlci4gUmVjZWl2ZWQgJyArIGFyZyArICcuJyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmYXVsdE1heExpc3RlbmVycyA9IGFyZztcbiAgICB9XG59KTtcbkV2ZW50RW1pdHRlci5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX2V2ZW50cyA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuX2V2ZW50cyA9PT0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLl9ldmVudHMpIHtcbiAgICAgICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgdGhpcy5fZXZlbnRzQ291bnQgPSAwO1xuICAgIH1cbiAgICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkO1xufTtcbi8vIE9idmlvdXNseSBub3QgYWxsIEVtaXR0ZXJzIHNob3VsZCBiZSBsaW1pdGVkIHRvIDEwLiBUaGlzIGZ1bmN0aW9uIGFsbG93c1xuLy8gdGhhdCB0byBiZSBpbmNyZWFzZWQuIFNldCB0byB6ZXJvIGZvciB1bmxpbWl0ZWQuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnNldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uIHNldE1heExpc3RlbmVycyhuKSB7XG4gICAgaWYgKHR5cGVvZiBuICE9PSAnbnVtYmVyJyB8fCBuIDwgMCB8fCBOdW1iZXJJc05hTihuKSkge1xuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignVGhlIHZhbHVlIG9mIFwiblwiIGlzIG91dCBvZiByYW5nZS4gSXQgbXVzdCBiZSBhIG5vbi1uZWdhdGl2ZSBudW1iZXIuIFJlY2VpdmVkICcgKyBuICsgJy4nKTtcbiAgICB9XG4gICAgdGhpcy5fbWF4TGlzdGVuZXJzID0gbjtcbiAgICByZXR1cm4gdGhpcztcbn07XG5mdW5jdGlvbiBfZ2V0TWF4TGlzdGVuZXJzKHRoYXQpIHtcbiAgICBpZiAodGhhdC5fbWF4TGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHJldHVybiBFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycztcbiAgICByZXR1cm4gdGhhdC5fbWF4TGlzdGVuZXJzO1xufVxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5nZXRNYXhMaXN0ZW5lcnMgPSBmdW5jdGlvbiBnZXRNYXhMaXN0ZW5lcnMoKSB7XG4gICAgcmV0dXJuIF9nZXRNYXhMaXN0ZW5lcnModGhpcyk7XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gZW1pdCh0eXBlKSB7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKWFyZ3MucHVzaChhcmd1bWVudHNbaV0pO1xuICAgIHZhciBkb0Vycm9yID0gdHlwZSA9PT0gJ2Vycm9yJztcbiAgICB2YXIgZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgIT09IHVuZGVmaW5lZCkgZG9FcnJvciA9IGRvRXJyb3IgJiYgZXZlbnRzLmVycm9yID09PSB1bmRlZmluZWQ7XG4gICAgZWxzZSBpZiAoIWRvRXJyb3IpIHJldHVybiBmYWxzZTtcbiAgICAvLyBJZiB0aGVyZSBpcyBubyAnZXJyb3InIGV2ZW50IGxpc3RlbmVyIHRoZW4gdGhyb3cuXG4gICAgaWYgKGRvRXJyb3IpIHtcbiAgICAgICAgdmFyIGVyO1xuICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAwKSBlciA9IGFyZ3NbMF07XG4gICAgICAgIGlmIChlciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAvLyBOb3RlOiBUaGUgY29tbWVudHMgb24gdGhlIGB0aHJvd2AgbGluZXMgYXJlIGludGVudGlvbmFsLCB0aGV5IHNob3dcbiAgICAgICAgICAgIC8vIHVwIGluIE5vZGUncyBvdXRwdXQgaWYgdGhpcyByZXN1bHRzIGluIGFuIHVuaGFuZGxlZCBleGNlcHRpb24uXG4gICAgICAgICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICAgICAgfVxuICAgICAgICAvLyBBdCBsZWFzdCBnaXZlIHNvbWUga2luZCBvZiBjb250ZXh0IHRvIHRoZSB1c2VyXG4gICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ1VuaGFuZGxlZCBlcnJvci4nICsgKGVyID8gJyAoJyArIGVyLm1lc3NhZ2UgKyAnKScgOiAnJykpO1xuICAgICAgICBlcnIuY29udGV4dCA9IGVyO1xuICAgICAgICB0aHJvdyBlcnI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50XG4gICAgfVxuICAgIHZhciBoYW5kbGVyID0gZXZlbnRzW3R5cGVdO1xuICAgIGlmIChoYW5kbGVyID09PSB1bmRlZmluZWQpIHJldHVybiBmYWxzZTtcbiAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgUmVmbGVjdEFwcGx5KGhhbmRsZXIsIHRoaXMsIGFyZ3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBsZW4gPSBoYW5kbGVyLmxlbmd0aDtcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IGFycmF5Q2xvbmUoaGFuZGxlciwgbGVuKTtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKVJlZmxlY3RBcHBseShsaXN0ZW5lcnNbaV0sIHRoaXMsIGFyZ3MpO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5mdW5jdGlvbiBfYWRkTGlzdGVuZXIodGFyZ2V0LCB0eXBlLCBsaXN0ZW5lciwgcHJlcGVuZCkge1xuICAgIHZhciBtO1xuICAgIHZhciBldmVudHM7XG4gICAgdmFyIGV4aXN0aW5nO1xuICAgIGNoZWNrTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIGV2ZW50cyA9IHRhcmdldC5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBldmVudHMgPSB0YXJnZXQuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIHRhcmdldC5fZXZlbnRzQ291bnQgPSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRvIGF2b2lkIHJlY3Vyc2lvbiBpbiB0aGUgY2FzZSB0aGF0IHR5cGUgPT09IFwibmV3TGlzdGVuZXJcIiEgQmVmb3JlXG4gICAgICAgIC8vIGFkZGluZyBpdCB0byB0aGUgbGlzdGVuZXJzLCBmaXJzdCBlbWl0IFwibmV3TGlzdGVuZXJcIi5cbiAgICAgICAgaWYgKGV2ZW50cy5uZXdMaXN0ZW5lciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0YXJnZXQuZW1pdCgnbmV3TGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lci5saXN0ZW5lciA/IGxpc3RlbmVyLmxpc3RlbmVyIDogbGlzdGVuZXIpO1xuICAgICAgICAgICAgLy8gUmUtYXNzaWduIGBldmVudHNgIGJlY2F1c2UgYSBuZXdMaXN0ZW5lciBoYW5kbGVyIGNvdWxkIGhhdmUgY2F1c2VkIHRoZVxuICAgICAgICAgICAgLy8gdGhpcy5fZXZlbnRzIHRvIGJlIGFzc2lnbmVkIHRvIGEgbmV3IG9iamVjdFxuICAgICAgICAgICAgZXZlbnRzID0gdGFyZ2V0Ll9ldmVudHM7XG4gICAgICAgIH1cbiAgICAgICAgZXhpc3RpbmcgPSBldmVudHNbdHlwZV07XG4gICAgfVxuICAgIGlmIChleGlzdGluZyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIE9wdGltaXplIHRoZSBjYXNlIG9mIG9uZSBsaXN0ZW5lci4gRG9uJ3QgbmVlZCB0aGUgZXh0cmEgYXJyYXkgb2JqZWN0LlxuICAgICAgICBleGlzdGluZyA9IGV2ZW50c1t0eXBlXSA9IGxpc3RlbmVyO1xuICAgICAgICArK3RhcmdldC5fZXZlbnRzQ291bnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHR5cGVvZiBleGlzdGluZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgLy8gQWRkaW5nIHRoZSBzZWNvbmQgZWxlbWVudCwgbmVlZCB0byBjaGFuZ2UgdG8gYXJyYXkuXG4gICAgICAgICAgICBleGlzdGluZyA9IGV2ZW50c1t0eXBlXSA9IHByZXBlbmQgPyBbXG4gICAgICAgICAgICAgICAgbGlzdGVuZXIsXG4gICAgICAgICAgICAgICAgZXhpc3RpbmdcbiAgICAgICAgICAgIF0gOiBbXG4gICAgICAgICAgICAgICAgZXhpc3RpbmcsXG4gICAgICAgICAgICAgICAgbGlzdGVuZXJcbiAgICAgICAgICAgIF07XG4gICAgICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgZ290IGFuIGFycmF5LCBqdXN0IGFwcGVuZC5cbiAgICAgICAgfSBlbHNlIGlmIChwcmVwZW5kKSB7XG4gICAgICAgICAgICBleGlzdGluZy51bnNoaWZ0KGxpc3RlbmVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGV4aXN0aW5nLnB1c2gobGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENoZWNrIGZvciBsaXN0ZW5lciBsZWFrXG4gICAgICAgIG0gPSBfZ2V0TWF4TGlzdGVuZXJzKHRhcmdldCk7XG4gICAgICAgIGlmIChtID4gMCAmJiBleGlzdGluZy5sZW5ndGggPiBtICYmICFleGlzdGluZy53YXJuZWQpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nLndhcm5lZCA9IHRydWU7XG4gICAgICAgICAgICAvLyBObyBlcnJvciBjb2RlIGZvciB0aGlzIHNpbmNlIGl0IGlzIGEgV2FybmluZ1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtc3ludGF4XG4gICAgICAgICAgICB2YXIgdyA9IG5ldyBFcnJvcignUG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSBsZWFrIGRldGVjdGVkLiAnICsgZXhpc3RpbmcubGVuZ3RoICsgJyAnICsgU3RyaW5nKHR5cGUpICsgJyBsaXN0ZW5lcnMgJyArICdhZGRlZC4gVXNlIGVtaXR0ZXIuc2V0TWF4TGlzdGVuZXJzKCkgdG8gJyArICdpbmNyZWFzZSBsaW1pdCcpO1xuICAgICAgICAgICAgdy5uYW1lID0gJ01heExpc3RlbmVyc0V4Y2VlZGVkV2FybmluZyc7XG4gICAgICAgICAgICB3LmVtaXR0ZXIgPSB0YXJnZXQ7XG4gICAgICAgICAgICB3LnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdy5jb3VudCA9IGV4aXN0aW5nLmxlbmd0aDtcbiAgICAgICAgICAgIFByb2Nlc3NFbWl0V2FybmluZyh3KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uIGFkZExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgcmV0dXJuIF9hZGRMaXN0ZW5lcih0aGlzLCB0eXBlLCBsaXN0ZW5lciwgZmFsc2UpO1xufTtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub24gPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyO1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5wcmVwZW5kTGlzdGVuZXIgPSBmdW5jdGlvbiBwcmVwZW5kTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICByZXR1cm4gX2FkZExpc3RlbmVyKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCB0cnVlKTtcbn07XG5mdW5jdGlvbiBvbmNlV3JhcHBlcigpIHtcbiAgICBpZiAoIXRoaXMuZmlyZWQpIHtcbiAgICAgICAgdGhpcy50YXJnZXQucmVtb3ZlTGlzdGVuZXIodGhpcy50eXBlLCB0aGlzLndyYXBGbik7XG4gICAgICAgIHRoaXMuZmlyZWQgPSB0cnVlO1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHRoaXMubGlzdGVuZXIuY2FsbCh0aGlzLnRhcmdldCk7XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3RlbmVyLmFwcGx5KHRoaXMudGFyZ2V0LCBhcmd1bWVudHMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIF9vbmNlV3JhcCh0YXJnZXQsIHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIHN0YXRlID0ge1xuICAgICAgICBmaXJlZDogZmFsc2UsXG4gICAgICAgIHdyYXBGbjogdW5kZWZpbmVkLFxuICAgICAgICB0YXJnZXQ6IHRhcmdldCxcbiAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgbGlzdGVuZXI6IGxpc3RlbmVyXG4gICAgfTtcbiAgICB2YXIgd3JhcHBlZCA9IG9uY2VXcmFwcGVyLmJpbmQoc3RhdGUpO1xuICAgIHdyYXBwZWQubGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICBzdGF0ZS53cmFwRm4gPSB3cmFwcGVkO1xuICAgIHJldHVybiB3cmFwcGVkO1xufVxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24gb25jZSh0eXBlLCBsaXN0ZW5lcikge1xuICAgIGNoZWNrTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIHRoaXMub24odHlwZSwgX29uY2VXcmFwKHRoaXMsIHR5cGUsIGxpc3RlbmVyKSk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5wcmVwZW5kT25jZUxpc3RlbmVyID0gZnVuY3Rpb24gcHJlcGVuZE9uY2VMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikge1xuICAgIGNoZWNrTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIHRoaXMucHJlcGVuZExpc3RlbmVyKHR5cGUsIF9vbmNlV3JhcCh0aGlzLCB0eXBlLCBsaXN0ZW5lcikpO1xuICAgIHJldHVybiB0aGlzO1xufTtcbi8vIEVtaXRzIGEgJ3JlbW92ZUxpc3RlbmVyJyBldmVudCBpZiBhbmQgb25seSBpZiB0aGUgbGlzdGVuZXIgd2FzIHJlbW92ZWQuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24gcmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgbGlzdCwgZXZlbnRzLCBwb3NpdGlvbiwgaSwgb3JpZ2luYWxMaXN0ZW5lcjtcbiAgICBjaGVja0xpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdGhpcztcbiAgICBsaXN0ID0gZXZlbnRzW3R5cGVdO1xuICAgIGlmIChsaXN0ID09PSB1bmRlZmluZWQpIHJldHVybiB0aGlzO1xuICAgIGlmIChsaXN0ID09PSBsaXN0ZW5lciB8fCBsaXN0Lmxpc3RlbmVyID09PSBsaXN0ZW5lcikge1xuICAgICAgICBpZiAoLS10aGlzLl9ldmVudHNDb3VudCA9PT0gMCkgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgZXZlbnRzW3R5cGVdO1xuICAgICAgICAgICAgaWYgKGV2ZW50cy5yZW1vdmVMaXN0ZW5lcikgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3QubGlzdGVuZXIgfHwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbGlzdCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBwb3NpdGlvbiA9IC0xO1xuICAgICAgICBmb3IoaSA9IGxpc3QubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xuICAgICAgICAgICAgaWYgKGxpc3RbaV0gPT09IGxpc3RlbmVyIHx8IGxpc3RbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxMaXN0ZW5lciA9IGxpc3RbaV0ubGlzdGVuZXI7XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSBpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwb3NpdGlvbiA8IDApIHJldHVybiB0aGlzO1xuICAgICAgICBpZiAocG9zaXRpb24gPT09IDApIGxpc3Quc2hpZnQoKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzcGxpY2VPbmUobGlzdCwgcG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMSkgZXZlbnRzW3R5cGVdID0gbGlzdFswXTtcbiAgICAgICAgaWYgKGV2ZW50cy5yZW1vdmVMaXN0ZW5lciAhPT0gdW5kZWZpbmVkKSB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgb3JpZ2luYWxMaXN0ZW5lciB8fCBsaXN0ZW5lcik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub2ZmID0gRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcjtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gZnVuY3Rpb24gcmVtb3ZlQWxsTGlzdGVuZXJzKHR5cGUpIHtcbiAgICB2YXIgbGlzdGVuZXJzLCBldmVudHMsIGk7XG4gICAgZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXM7XG4gICAgLy8gbm90IGxpc3RlbmluZyBmb3IgcmVtb3ZlTGlzdGVuZXIsIG5vIG5lZWQgdG8gZW1pdFxuICAgIGlmIChldmVudHMucmVtb3ZlTGlzdGVuZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgICAgIHRoaXMuX2V2ZW50c0NvdW50ID0gMDtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudHNbdHlwZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKC0tdGhpcy5fZXZlbnRzQ291bnQgPT09IDApIHRoaXMuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgICAgICBlbHNlIGRlbGV0ZSBldmVudHNbdHlwZV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8vIGVtaXQgcmVtb3ZlTGlzdGVuZXIgZm9yIGFsbCBsaXN0ZW5lcnMgb24gYWxsIGV2ZW50c1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZXZlbnRzKTtcbiAgICAgICAgdmFyIGtleTtcbiAgICAgICAgZm9yKGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7ICsraSl7XG4gICAgICAgICAgICBrZXkgPSBrZXlzW2ldO1xuICAgICAgICAgICAgaWYgKGtleSA9PT0gJ3JlbW92ZUxpc3RlbmVyJykgY29udGludWU7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycyhrZXkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCdyZW1vdmVMaXN0ZW5lcicpO1xuICAgICAgICB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICB0aGlzLl9ldmVudHNDb3VudCA9IDA7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBsaXN0ZW5lcnMgPSBldmVudHNbdHlwZV07XG4gICAgaWYgKHR5cGVvZiBsaXN0ZW5lcnMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpO1xuICAgIH0gZWxzZSBpZiAobGlzdGVuZXJzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gTElGTyBvcmRlclxuICAgICAgICBmb3IoaSA9IGxpc3RlbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyc1tpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuZnVuY3Rpb24gX2xpc3RlbmVycyh0YXJnZXQsIHR5cGUsIHVud3JhcCkge1xuICAgIHZhciBldmVudHMgPSB0YXJnZXQuX2V2ZW50cztcbiAgICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpIHJldHVybiBbXTtcbiAgICB2YXIgZXZsaXN0ZW5lciA9IGV2ZW50c1t0eXBlXTtcbiAgICBpZiAoZXZsaXN0ZW5lciA9PT0gdW5kZWZpbmVkKSByZXR1cm4gW107XG4gICAgaWYgKHR5cGVvZiBldmxpc3RlbmVyID09PSAnZnVuY3Rpb24nKSByZXR1cm4gdW53cmFwID8gW1xuICAgICAgICBldmxpc3RlbmVyLmxpc3RlbmVyIHx8IGV2bGlzdGVuZXJcbiAgICBdIDogW1xuICAgICAgICBldmxpc3RlbmVyXG4gICAgXTtcbiAgICByZXR1cm4gdW53cmFwID8gdW53cmFwTGlzdGVuZXJzKGV2bGlzdGVuZXIpIDogYXJyYXlDbG9uZShldmxpc3RlbmVyLCBldmxpc3RlbmVyLmxlbmd0aCk7XG59XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uIGxpc3RlbmVycyh0eXBlKSB7XG4gICAgcmV0dXJuIF9saXN0ZW5lcnModGhpcywgdHlwZSwgdHJ1ZSk7XG59O1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yYXdMaXN0ZW5lcnMgPSBmdW5jdGlvbiByYXdMaXN0ZW5lcnModHlwZSkge1xuICAgIHJldHVybiBfbGlzdGVuZXJzKHRoaXMsIHR5cGUsIGZhbHNlKTtcbn07XG5FdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUpIHtcbiAgICBpZiAodHlwZW9mIGVtaXR0ZXIubGlzdGVuZXJDb3VudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBsaXN0ZW5lckNvdW50LmNhbGwoZW1pdHRlciwgdHlwZSk7XG4gICAgfVxufTtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJDb3VudCA9IGxpc3RlbmVyQ291bnQ7XG5mdW5jdGlvbiBsaXN0ZW5lckNvdW50KHR5cGUpIHtcbiAgICB2YXIgZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgZXZsaXN0ZW5lciA9IGV2ZW50c1t0eXBlXTtcbiAgICAgICAgaWYgKHR5cGVvZiBldmxpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfSBlbHNlIGlmIChldmxpc3RlbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZXZlbnROYW1lcyA9IGZ1bmN0aW9uIGV2ZW50TmFtZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2V2ZW50c0NvdW50ID4gMCA/IFJlZmxlY3RPd25LZXlzKHRoaXMuX2V2ZW50cykgOiBbXTtcbn07XG5mdW5jdGlvbiBhcnJheUNsb25lKGFyciwgbikge1xuICAgIHZhciBjb3B5ID0gbmV3IEFycmF5KG4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBuOyArK2kpY29weVtpXSA9IGFycltpXTtcbiAgICByZXR1cm4gY29weTtcbn1cbmZ1bmN0aW9uIHNwbGljZU9uZShsaXN0LCBpbmRleCkge1xuICAgIGZvcig7IGluZGV4ICsgMSA8IGxpc3QubGVuZ3RoOyBpbmRleCsrKWxpc3RbaW5kZXhdID0gbGlzdFtpbmRleCArIDFdO1xuICAgIGxpc3QucG9wKCk7XG59XG5mdW5jdGlvbiB1bndyYXBMaXN0ZW5lcnMoYXJyKSB7XG4gICAgdmFyIHJldCA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgcmV0Lmxlbmd0aDsgKytpKXtcbiAgICAgICAgcmV0W2ldID0gYXJyW2ldLmxpc3RlbmVyIHx8IGFycltpXTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cbmZ1bmN0aW9uIG9uY2UoZW1pdHRlciwgbmFtZSkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZXJyb3JMaXN0ZW5lcihlcnIpIHtcbiAgICAgICAgICAgIGVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIobmFtZSwgcmVzb2x2ZXIpO1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVzb2x2ZXIoKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBlbWl0dGVyLnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIGVycm9yTGlzdGVuZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb2x2ZShbXS5zbGljZS5jYWxsKGFyZ3VtZW50cykpO1xuICAgICAgICB9XG4gICAgICAgIDtcbiAgICAgICAgZXZlbnRUYXJnZXRBZ25vc3RpY0FkZExpc3RlbmVyKGVtaXR0ZXIsIG5hbWUsIHJlc29sdmVyLCB7XG4gICAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobmFtZSAhPT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgYWRkRXJyb3JIYW5kbGVySWZFdmVudEVtaXR0ZXIoZW1pdHRlciwgZXJyb3JMaXN0ZW5lciwge1xuICAgICAgICAgICAgICAgIG9uY2U6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5mdW5jdGlvbiBhZGRFcnJvckhhbmRsZXJJZkV2ZW50RW1pdHRlcihlbWl0dGVyLCBoYW5kbGVyLCBmbGFncykge1xuICAgIGlmICh0eXBlb2YgZW1pdHRlci5vbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBldmVudFRhcmdldEFnbm9zdGljQWRkTGlzdGVuZXIoZW1pdHRlciwgJ2Vycm9yJywgaGFuZGxlciwgZmxhZ3MpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGV2ZW50VGFyZ2V0QWdub3N0aWNBZGRMaXN0ZW5lcihlbWl0dGVyLCBuYW1lLCBsaXN0ZW5lciwgZmxhZ3MpIHtcbiAgICBpZiAodHlwZW9mIGVtaXR0ZXIub24gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgaWYgKGZsYWdzLm9uY2UpIHtcbiAgICAgICAgICAgIGVtaXR0ZXIub25jZShuYW1lLCBsaXN0ZW5lcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbWl0dGVyLm9uKG5hbWUsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGVtaXR0ZXIuYWRkRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBFdmVudFRhcmdldCBkb2VzIG5vdCBoYXZlIGBlcnJvcmAgZXZlbnQgc2VtYW50aWNzIGxpa2UgTm9kZVxuICAgICAgICAvLyBFdmVudEVtaXR0ZXJzLCB3ZSBkbyBub3QgbGlzdGVuIGZvciBgZXJyb3JgIGV2ZW50cyBoZXJlLlxuICAgICAgICBlbWl0dGVyLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgZnVuY3Rpb24gd3JhcExpc3RlbmVyKGFyZykge1xuICAgICAgICAgICAgLy8gSUUgZG9lcyBub3QgaGF2ZSBidWlsdGluIGB7IG9uY2U6IHRydWUgfWAgc3VwcG9ydCBzbyB3ZVxuICAgICAgICAgICAgLy8gaGF2ZSB0byBkbyBpdCBtYW51YWxseS5cbiAgICAgICAgICAgIGlmIChmbGFncy5vbmNlKSB7XG4gICAgICAgICAgICAgICAgZW1pdHRlci5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIHdyYXBMaXN0ZW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsaXN0ZW5lcihhcmcpO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJlbWl0dGVyXCIgYXJndW1lbnQgbXVzdCBiZSBvZiB0eXBlIEV2ZW50RW1pdHRlci4gUmVjZWl2ZWQgdHlwZSAnICsgdHlwZW9mIGVtaXR0ZXIpO1xuICAgIH1cbn1cblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvc2hhbGxvd2VxdWFsL2luZGV4LmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvc2hhbGxvd2VxdWFsL2luZGV4LmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAobW9kdWxlKSB7XG4vL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzaGFsbG93RXF1YWwob2JqQSwgb2JqQiwgY29tcGFyZSwgY29tcGFyZUNvbnRleHQpIHtcbiAgICB2YXIgcmV0ID0gY29tcGFyZSA/IGNvbXBhcmUuY2FsbChjb21wYXJlQ29udGV4dCwgb2JqQSwgb2JqQikgOiB2b2lkIDA7XG4gICAgaWYgKHJldCAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHJldHVybiAhIXJldDtcbiAgICB9XG4gICAgaWYgKG9iakEgPT09IG9iakIpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb2JqQSAhPT0gXCJvYmplY3RcIiB8fCAhb2JqQSB8fCB0eXBlb2Ygb2JqQiAhPT0gXCJvYmplY3RcIiB8fCAhb2JqQikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBrZXlzQSA9IE9iamVjdC5rZXlzKG9iakEpO1xuICAgIHZhciBrZXlzQiA9IE9iamVjdC5rZXlzKG9iakIpO1xuICAgIGlmIChrZXlzQS5sZW5ndGggIT09IGtleXNCLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBiSGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmJpbmQob2JqQik7XG4gICAgLy8gVGVzdCBmb3IgQSdzIGtleXMgZGlmZmVyZW50IGZyb20gQi5cbiAgICBmb3IodmFyIGlkeCA9IDA7IGlkeCA8IGtleXNBLmxlbmd0aDsgaWR4Kyspe1xuICAgICAgICB2YXIga2V5ID0ga2V5c0FbaWR4XTtcbiAgICAgICAgaWYgKCFiSGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWx1ZUEgPSBvYmpBW2tleV07XG4gICAgICAgIHZhciB2YWx1ZUIgPSBvYmpCW2tleV07XG4gICAgICAgIHJldCA9IGNvbXBhcmUgPyBjb21wYXJlLmNhbGwoY29tcGFyZUNvbnRleHQsIHZhbHVlQSwgdmFsdWVCLCBrZXkpIDogdm9pZCAwO1xuICAgICAgICBpZiAocmV0ID09PSBmYWxzZSB8fCByZXQgPT09IHZvaWQgMCAmJiB2YWx1ZUEgIT09IHZhbHVlQikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcblxuXG59KSxcblwiQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvcnNwYWNrLmpzIT0hZGF0YTp0ZXh0L2phdmFzY3JpcHQsaW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fYnVuZGxlcl9ydW50aW1lX18gZnJvbSBcXFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvc3BvcnRzL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanNcXFwiO2ltcG9ydCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXyBmcm9tIFxcXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9zcG9ydHMvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL3Jlc29sdmVyLXBsdWdpbi5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3Nwb3J0cy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanNcXFwiO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18gPSBbX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8wX18oKSwgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18oKV07Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXyA9IHt9O2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyA9IFxcXCJzcG9ydHNcXFwiO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyA9IFxcXCJsb2FkZWQtZmlyc3RcXFwiO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YXx8X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpJiZfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24pe3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMjtjb25zdCBvdmVycmlkZT0ob2JqLGtleSx2YWx1ZSk9PntpZighb2JqKXJldHVybjtpZihvYmpba2V5XSlvYmpba2V5XT12YWx1ZX07Y29uc3QgbWVyZ2U9KG9iaixrZXksZm4pPT57Y29uc3QgdmFsdWU9Zm4oKTtpZihBcnJheS5pc0FycmF5KHZhbHVlKSl7dmFyIF9vYmosX2tleTt2YXIgXzsoXz0oX29iaj1vYmopW19rZXk9a2V5XSkhPT1udWxsJiZfIT09dm9pZCAwP186X29ialtfa2V5XT1bXTtvYmpba2V5XS5wdXNoKC4uLnZhbHVlKX1lbHNlIGlmKHR5cGVvZiB2YWx1ZT09PVxcXCJvYmplY3RcXFwiJiZ2YWx1ZSE9PW51bGwpe3ZhciBfb2JqMSxfa2V5MTt2YXIgXzE7KF8xPShfb2JqMT1vYmopW19rZXkxPWtleV0pIT09bnVsbCYmXzEhPT12b2lkIDA/XzE6X29iajFbX2tleTFdPXt9O09iamVjdC5hc3NpZ24ob2JqW2tleV0sdmFsdWUpfX07Y29uc3QgZWFybHk9KG9iaixrZXksaW5pdGlhbCk9Pnt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPWluaXRpYWwoKX07dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCByZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZztjb25zdCByZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9X193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEubW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc7Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEuc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLmNodW5rTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nO2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nOnt9O2NvbnN0IGNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXM9e307Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdJbml0UHJvbWlzZXM9W107Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zPXt9O2NvbnN0IGNvbnRhaW5lclNoYXJlU2NvcGU9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YS5zaGFyZVNjb3BlO2Zvcihjb25zdCBrZXkgaW4gX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uW2tleV09X19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfX1trZXldfWVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1xcXCIsKCk9Pntjb25zdCBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nPXt9O2ZvcihsZXRbbW9kdWxlSWQsZGF0YV1vZiBPYmplY3QuZW50cmllcyhjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZykpe2NvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdbbW9kdWxlSWRdPXtnZXR0ZXI6ZGF0YS5mYWxsYmFjayxzaGFyZUluZm86e3NoYXJlQ29uZmlnOntmaXhlZERlcGVuZGVuY2llczpmYWxzZSxyZXF1aXJlZFZlcnNpb246ZGF0YS5yZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbjpkYXRhLnN0cmljdFZlcnNpb24sc2luZ2xldG9uOmRhdGEuc2luZ2xldG9uLGVhZ2VyOmRhdGEuZWFnZXJ9LHNjb3BlOltkYXRhLnNoYXJlU2NvcGVdfSxzaGFyZUtleTpkYXRhLnNoYXJlS2V5fX1yZXR1cm4gY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiaW5pdE9wdGlvbnNcXFwiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXFxcIm5hbWVcXFwiLCgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwic2hhcmVTdHJhdGVneVxcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJzaGFyZWRcXFwiLCgpPT57Y29uc3Qgc2hhcmVkPXt9O2ZvcihsZXRbc2NvcGUsc3RhZ2VzXW9mIE9iamVjdC5lbnRyaWVzKGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZykpe2ZvcihsZXQgc3RhZ2Ugb2Ygc3RhZ2VzKXtpZih0eXBlb2Ygc3RhZ2U9PT1cXFwib2JqZWN0XFxcIiYmc3RhZ2UhPT1udWxsKXtjb25zdHtuYW1lLHZlcnNpb24sZmFjdG9yeSxlYWdlcixzaW5nbGV0b24scmVxdWlyZWRWZXJzaW9uLHN0cmljdFZlcnNpb259PXN0YWdlO2NvbnN0IHNoYXJlQ29uZmlnPXt9O2NvbnN0IGlzVmFsaWRWYWx1ZT1mdW5jdGlvbih2YWwpe3JldHVybiB0eXBlb2YgdmFsIT09XFxcInVuZGVmaW5lZFxcXCJ9O2lmKGlzVmFsaWRWYWx1ZShzaW5nbGV0b24pKXtzaGFyZUNvbmZpZy5zaW5nbGV0b249c2luZ2xldG9ufWlmKGlzVmFsaWRWYWx1ZShyZXF1aXJlZFZlcnNpb24pKXtzaGFyZUNvbmZpZy5yZXF1aXJlZFZlcnNpb249cmVxdWlyZWRWZXJzaW9ufWlmKGlzVmFsaWRWYWx1ZShlYWdlcikpe3NoYXJlQ29uZmlnLmVhZ2VyPWVhZ2VyfWlmKGlzVmFsaWRWYWx1ZShzdHJpY3RWZXJzaW9uKSl7c2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbj1zdHJpY3RWZXJzaW9ufWNvbnN0IG9wdGlvbnM9e3ZlcnNpb24sc2NvcGU6W3Njb3BlXSxzaGFyZUNvbmZpZyxnZXQ6ZmFjdG9yeX07aWYoc2hhcmVkW25hbWVdKXtzaGFyZWRbbmFtZV0ucHVzaChvcHRpb25zKX1lbHNle3NoYXJlZFtuYW1lXT1bb3B0aW9uc119fX19cmV0dXJuIHNoYXJlZH0pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwicmVtb3Rlc1xcXCIsKCk9Pk9iamVjdC52YWx1ZXMoX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXykuZmxhdCgpLmZpbHRlcihyZW1vdGU9PnJlbW90ZS5leHRlcm5hbFR5cGU9PT1cXFwic2NyaXB0XFxcIikpO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwicGx1Z2luc1xcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiYnVuZGxlclJ1bnRpbWVPcHRpb25zXFxcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucyxcXFwicmVtb3Rlc1xcXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiY2h1bmtNYXBwaW5nXFxcIiwoKT0+cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdcXFwiLCgpPT57Y29uc3QgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7cmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmdbbW9kdWxlSWRdPVtkYXRhLnNoYXJlU2NvcGUsZGF0YS5uYW1lLGRhdGEuZXh0ZXJuYWxNb2R1bGVJZCxkYXRhLnJlbW90ZU5hbWVdfXJldHVybiByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwid2VicGFja1JlcXVpcmVcXFwiLCgpPT5fX3dlYnBhY2tfcmVxdWlyZV9fKTttZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsXFxcImlkVG9SZW1vdGVNYXBcXFwiLCgpPT57Y29uc3QgaWRUb1JlbW90ZU1hcD17fTtmb3IobGV0W2lkLHJlbW90ZURhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtjb25zdCBpbmZvPV9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX19bcmVtb3RlRGF0YS5yZW1vdGVOYW1lXTtpZihpbmZvKWlkVG9SZW1vdGVNYXBbaWRdPWluZm99cmV0dXJuIGlkVG9SZW1vdGVNYXB9KTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJTXFxcIixfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuUyk7aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKF9fd2VicGFja19yZXF1aXJlX18pfW92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcXFwicmVtb3Rlc1xcXCIsKGNodW5rSWQscHJvbWlzZXMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUucmVtb3Rlcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcsaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nLGlkVG9SZW1vdGVNYXA6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9SZW1vdGVNYXAsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLmYsXFxcImNvbnN1bWVzXFxcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5jb25zdW1lcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6Y29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmcsaW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcXFwiSVxcXCIsKG5hbWUsaW5pdFNjb3BlKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLkkoe3NoYXJlU2NvcGVOYW1lOm5hbWUsaW5pdFNjb3BlLGluaXRQcm9taXNlczppbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcyxpbml0VG9rZW5zOmluaXRpYWxpemVTaGFyaW5nSW5pdFRva2Vucyx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcImluaXRDb250YWluZXJcXFwiLChzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluaXRDb250YWluZXJFbnRyeSh7c2hhcmVTY29wZSxpbml0U2NvcGUscmVtb3RlRW50cnlJbml0T3B0aW9ucyxzaGFyZVNjb3BlS2V5OmNvbnRhaW5lclNoYXJlU2NvcGUsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJnZXRDb250YWluZXJcXFwiLChtb2R1bGUxLGdldFNjb3BlKT0+e3ZhciBtb2R1bGVNYXA9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEubW9kdWxlTWFwO19fd2VicGFja19yZXF1aXJlX18uUj1nZXRTY29wZTtnZXRTY29wZT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kdWxlTWFwLG1vZHVsZTEpP21vZHVsZU1hcFttb2R1bGUxXSgpOlByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCk9Pnt0aHJvdyBuZXcgRXJyb3IoJ01vZHVsZSBcXFwiJyttb2R1bGUxKydcXFwiIGRvZXMgbm90IGV4aXN0IGluIGNvbnRhaW5lci4nKX0pO19fd2VicGFja19yZXF1aXJlX18uUj11bmRlZmluZWQ7cmV0dXJuIGdldFNjb3BlfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluc3RhbmNlPV9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5ydW50aW1lLmluaXQoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zKTtpZigoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMi5pbml0aWFsQ29uc3VtZXMpe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbnN0YWxsSW5pdGlhbENvbnN1bWVzKHt3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9fLGluc3RhbGxlZE1vZHVsZXM6Y29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyxpbml0aWFsQ29uc3VtZXM6X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhLmluaXRpYWxDb25zdW1lcyxtb2R1bGVUb0hhbmRsZXJNYXBwaW5nOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSl9fVwiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiBAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9yc3BhY2suanMhPSFkYXRhOnRleHQvamF2YXNjcmlwdCxpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyBmcm9tIFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvc3BvcnRzL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanNcIjtpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8wX18gZnJvbSBcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3Nwb3J0cy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fIGZyb20gXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9zcG9ydHMvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyA9IFtfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXygpLCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzFfXygpXTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fID0ge307Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fID0gXCJzcG9ydHNcIjtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3NoYXJlX3N0cmF0ZWd5X18gPSBcImxvYWRlZC1maXJzdFwiO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YXx8X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpJiZfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24pe3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMjtjb25zdCBvdmVycmlkZT0ob2JqLGtleSx2YWx1ZSk9PntpZighb2JqKXJldHVybjtpZihvYmpba2V5XSlvYmpba2V5XT12YWx1ZX07Y29uc3QgbWVyZ2U9KG9iaixrZXksZm4pPT57Y29uc3QgdmFsdWU9Zm4oKTtpZihBcnJheS5pc0FycmF5KHZhbHVlKSl7dmFyIF9vYmosX2tleTt2YXIgXzsoXz0oX29iaj1vYmopW19rZXk9a2V5XSkhPT1udWxsJiZfIT09dm9pZCAwP186X29ialtfa2V5XT1bXTtvYmpba2V5XS5wdXNoKC4uLnZhbHVlKX1lbHNlIGlmKHR5cGVvZiB2YWx1ZT09PVwib2JqZWN0XCImJnZhbHVlIT09bnVsbCl7dmFyIF9vYmoxLF9rZXkxO3ZhciBfMTsoXzE9KF9vYmoxPW9iailbX2tleTE9a2V5XSkhPT1udWxsJiZfMSE9PXZvaWQgMD9fMTpfb2JqMVtfa2V5MV09e307T2JqZWN0LmFzc2lnbihvYmpba2V5XSx2YWx1ZSl9fTtjb25zdCBlYXJseT0ob2JqLGtleSxpbml0aWFsKT0+e3ZhciBfb2JqLF9rZXk7dmFyIF87KF89KF9vYmo9b2JqKVtfa2V5PWtleV0pIT09bnVsbCYmXyE9PXZvaWQgMD9fOl9vYmpbX2tleV09aW5pdGlhbCgpfTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZztjb25zdCBpbml0aWFsaXplU2hhcmluZ1Njb3BlVG9Jbml0RGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCBjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc6e307Y29uc3QgY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcz17fTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcz1bXTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRUb2tlbnM9e307Y29uc3QgY29udGFpbmVyU2hhcmVTY29wZT0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLnNoYXJlU2NvcGU7Zm9yKGNvbnN0IGtleSBpbiBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fKXtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb25ba2V5XT1fX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fW2tleV19ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFwiY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1wiLCgpPT57Y29uc3QgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZz17fTtmb3IobGV0W21vZHVsZUlkLGRhdGFdb2YgT2JqZWN0LmVudHJpZXMoY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmcpKXtjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nW21vZHVsZUlkXT17Z2V0dGVyOmRhdGEuZmFsbGJhY2ssc2hhcmVJbmZvOntzaGFyZUNvbmZpZzp7Zml4ZWREZXBlbmRlbmNpZXM6ZmFsc2UscmVxdWlyZWRWZXJzaW9uOmRhdGEucmVxdWlyZWRWZXJzaW9uLHN0cmljdFZlcnNpb246ZGF0YS5zdHJpY3RWZXJzaW9uLHNpbmdsZXRvbjpkYXRhLnNpbmdsZXRvbixlYWdlcjpkYXRhLmVhZ2VyfSxzY29wZTpbZGF0YS5zaGFyZVNjb3BlXX0sc2hhcmVLZXk6ZGF0YS5zaGFyZUtleX19cmV0dXJuIGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmd9KTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sXCJpbml0T3B0aW9uc1wiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXCJuYW1lXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFwic2hhcmVTdHJhdGVneVwiLCgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX3NoYXJlX3N0cmF0ZWd5X18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcInNoYXJlZFwiLCgpPT57Y29uc3Qgc2hhcmVkPXt9O2ZvcihsZXRbc2NvcGUsc3RhZ2VzXW9mIE9iamVjdC5lbnRyaWVzKGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZykpe2ZvcihsZXQgc3RhZ2Ugb2Ygc3RhZ2VzKXtpZih0eXBlb2Ygc3RhZ2U9PT1cIm9iamVjdFwiJiZzdGFnZSE9PW51bGwpe2NvbnN0e25hbWUsdmVyc2lvbixmYWN0b3J5LGVhZ2VyLHNpbmdsZXRvbixyZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbn09c3RhZ2U7Y29uc3Qgc2hhcmVDb25maWc9e307Y29uc3QgaXNWYWxpZFZhbHVlPWZ1bmN0aW9uKHZhbCl7cmV0dXJuIHR5cGVvZiB2YWwhPT1cInVuZGVmaW5lZFwifTtpZihpc1ZhbGlkVmFsdWUoc2luZ2xldG9uKSl7c2hhcmVDb25maWcuc2luZ2xldG9uPXNpbmdsZXRvbn1pZihpc1ZhbGlkVmFsdWUocmVxdWlyZWRWZXJzaW9uKSl7c2hhcmVDb25maWcucmVxdWlyZWRWZXJzaW9uPXJlcXVpcmVkVmVyc2lvbn1pZihpc1ZhbGlkVmFsdWUoZWFnZXIpKXtzaGFyZUNvbmZpZy5lYWdlcj1lYWdlcn1pZihpc1ZhbGlkVmFsdWUoc3RyaWN0VmVyc2lvbikpe3NoYXJlQ29uZmlnLnN0cmljdFZlcnNpb249c3RyaWN0VmVyc2lvbn1jb25zdCBvcHRpb25zPXt2ZXJzaW9uLHNjb3BlOltzY29wZV0sc2hhcmVDb25maWcsZ2V0OmZhY3Rvcnl9O2lmKHNoYXJlZFtuYW1lXSl7c2hhcmVkW25hbWVdLnB1c2gob3B0aW9ucyl9ZWxzZXtzaGFyZWRbbmFtZV09W29wdGlvbnNdfX19fXJldHVybiBzaGFyZWR9KTttZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXCJyZW1vdGVzXCIsKCk9Pk9iamVjdC52YWx1ZXMoX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXykuZmxhdCgpLmZpbHRlcihyZW1vdGU9PnJlbW90ZS5leHRlcm5hbFR5cGU9PT1cInNjcmlwdFwiKSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFwicGx1Z2luc1wiLCgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luc19fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sXCJidW5kbGVyUnVudGltZU9wdGlvbnNcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucyxcInJlbW90ZXNcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFwiY2h1bmtNYXBwaW5nXCIsKCk9PnJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1wiLCgpPT57Y29uc3QgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7cmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmdbbW9kdWxlSWRdPVtkYXRhLnNoYXJlU2NvcGUsZGF0YS5uYW1lLGRhdGEuZXh0ZXJuYWxNb2R1bGVJZCxkYXRhLnJlbW90ZU5hbWVdfXJldHVybiByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcIndlYnBhY2tSZXF1aXJlXCIsKCk9Pl9fd2VicGFja19yZXF1aXJlX18pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcImlkVG9SZW1vdGVNYXBcIiwoKT0+e2NvbnN0IGlkVG9SZW1vdGVNYXA9e307Zm9yKGxldFtpZCxyZW1vdGVEYXRhXW9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7Y29uc3QgaW5mbz1fX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fW3JlbW90ZURhdGEucmVtb3RlTmFtZV07aWYoaW5mbylpZFRvUmVtb3RlTWFwW2lkXT1pbmZvfXJldHVybiBpZFRvUmVtb3RlTWFwfSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcIlNcIixfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuUyk7aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKF9fd2VicGFja19yZXF1aXJlX18pfW92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcInJlbW90ZXNcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpyZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyxpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsaWRUb1JlbW90ZU1hcDpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb1JlbW90ZU1hcCx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcImNvbnN1bWVzXCIsKGNodW5rSWQscHJvbWlzZXMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuY29uc3VtZXMoe2NodW5rSWQscHJvbWlzZXMsY2h1bmtNYXBwaW5nOmNvbnN1bWVzTG9hZGluZ0NodW5rTWFwcGluZyxtb2R1bGVUb0hhbmRsZXJNYXBwaW5nOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nLGluc3RhbGxlZE1vZHVsZXM6Y29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXCJJXCIsKG5hbWUsaW5pdFNjb3BlKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLkkoe3NoYXJlU2NvcGVOYW1lOm5hbWUsaW5pdFNjb3BlLGluaXRQcm9taXNlczppbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcyxpbml0VG9rZW5zOmluaXRpYWxpemVTaGFyaW5nSW5pdFRva2Vucyx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXCJpbml0Q29udGFpbmVyXCIsKHNoYXJlU2NvcGUsaW5pdFNjb3BlLHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5pdENvbnRhaW5lckVudHJ5KHtzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zLHNoYXJlU2NvcGVLZXk6Y29udGFpbmVyU2hhcmVTY29wZSx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXCJnZXRDb250YWluZXJcIiwobW9kdWxlMSxnZXRTY29wZSk9Pnt2YXIgbW9kdWxlTWFwPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhLm1vZHVsZU1hcDtfX3dlYnBhY2tfcmVxdWlyZV9fLlI9Z2V0U2NvcGU7Z2V0U2NvcGU9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZHVsZU1hcCxtb2R1bGUxKT9tb2R1bGVNYXBbbW9kdWxlMV0oKTpQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpPT57dGhyb3cgbmV3IEVycm9yKCdNb2R1bGUgXCInK21vZHVsZTErJ1wiIGRvZXMgbm90IGV4aXN0IGluIGNvbnRhaW5lci4nKX0pO19fd2VicGFja19yZXF1aXJlX18uUj11bmRlZmluZWQ7cmV0dXJuIGdldFNjb3BlfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluc3RhbmNlPV9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5ydW50aW1lLmluaXQoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zKTtpZigoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMi5pbml0aWFsQ29uc3VtZXMpe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbnN0YWxsSW5pdGlhbENvbnN1bWVzKHt3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9fLGluc3RhbGxlZE1vZHVsZXM6Y29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyxpbml0aWFsQ29uc3VtZXM6X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhLmluaXRpYWxDb25zdW1lcyxtb2R1bGVUb0hhbmRsZXJNYXBwaW5nOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSl9fSAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG52YXIgX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuY2pzXCIpO1xudmFyIF9zbGljZWRfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fc2xpY2VkX3RvX2FycmF5ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2xpY2VkX3RvX2FycmF5LmNqc1wiKTtcbnZhciBfdG9fY29uc3VtYWJsZV9hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL190b19jb25zdW1hYmxlX2FycmF5ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fY29uc3VtYWJsZV9hcnJheS5janNcIik7XG52YXIgX2luZGV4Y2pzID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanNcIikpO1xudmFyIF9yZXNvbHZlcnBsdWdpbiA9IC8qI19fUFVSRV9fKi8gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0Ll8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvcmVzb2x2ZXItcGx1Z2luLmpzXCIpKTtcbnZhciBfY29yZXBsdWdpbiA9IC8qI19fUFVSRV9fKi8gX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0Ll8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qc1wiKSk7XG52YXIgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyA9IFtcbiAgICAoMCwgX3Jlc29sdmVycGx1Z2luLmRlZmF1bHQpKCksXG4gICAgKDAsIF9jb3JlcGx1Z2luLmRlZmF1bHQpKClcbl07XG52YXIgX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXyA9IHt9O1xudmFyIF9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyA9IFwic3BvcnRzXCI7XG52YXIgX19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fID0gXCJsb2FkZWQtZmlyc3RcIjtcbmlmICgoX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEgfHwgX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpICYmIF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbikge1xuICAgIHZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YSwgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMjtcbiAgICB2YXIgb3ZlcnJpZGUgPSAob2JqLCBrZXksIHZhbHVlKT0+e1xuICAgICAgICBpZiAoIW9iaikgcmV0dXJuO1xuICAgICAgICBpZiAob2JqW2tleV0pIG9ialtrZXldID0gdmFsdWU7XG4gICAgfTtcbiAgICB2YXIgbWVyZ2UgPSAob2JqLCBrZXksIGZuKT0+e1xuICAgICAgICB2YXIgdmFsdWUgPSBmbigpO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHZhciBfb2JqX2tleTtcbiAgICAgICAgICAgIHZhciBfb2JqLCBfa2V5O1xuICAgICAgICAgICAgdmFyIF87XG4gICAgICAgICAgICAoXyA9IChfb2JqID0gb2JqKVtfa2V5ID0ga2V5XSkgIT09IG51bGwgJiYgXyAhPT0gdm9pZCAwID8gXyA6IF9vYmpbX2tleV0gPSBbXTtcbiAgICAgICAgICAgIChfb2JqX2tleSA9IG9ialtrZXldKS5wdXNoLmFwcGx5KF9vYmpfa2V5LCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKHZhbHVlKSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgX29iajEsIF9rZXkxO1xuICAgICAgICAgICAgdmFyIF8xO1xuICAgICAgICAgICAgKF8xID0gKF9vYmoxID0gb2JqKVtfa2V5MSA9IGtleV0pICE9PSBudWxsICYmIF8xICE9PSB2b2lkIDAgPyBfMSA6IF9vYmoxW19rZXkxXSA9IHt9O1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihvYmpba2V5XSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgZWFybHkgPSAob2JqLCBrZXksIGluaXRpYWwpPT57XG4gICAgICAgIHZhciBfb2JqLCBfa2V5O1xuICAgICAgICB2YXIgXztcbiAgICAgICAgKF8gPSAoX29iaiA9IG9iailbX2tleSA9IGtleV0pICE9PSBudWxsICYmIF8gIT09IHZvaWQgMCA/IF8gOiBfb2JqW19rZXldID0gaW5pdGlhbCgpO1xuICAgIH07XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztcbiAgICB2YXIgcmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZyAhPT0gdm9pZCAwID8gX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZztcbiAgICB2YXIgcmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSA9IF9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZyAhPT0gdm9pZCAwID8gX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc7XG4gICAgdmFyIGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSAhPT0gbnVsbCAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc7XG4gICAgdmFyIGNvbnN1bWVzTG9hZGluZ0NodW5rTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YSA9IF9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSAhPT0gbnVsbCAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nO1xuICAgIHZhciBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExID0gX193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZyA6IHt9O1xuICAgIHZhciBjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzID0ge307XG4gICAgdmFyIGluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzID0gW107XG4gICAgdmFyIGluaXRpYWxpemVTaGFyaW5nSW5pdFRva2VucyA9IHt9O1xuICAgIHZhciBjb250YWluZXJTaGFyZVNjb3BlID0gKF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YS5zaGFyZVNjb3BlO1xuICAgIGZvcih2YXIga2V5IGluIF9pbmRleGNqcy5kZWZhdWx0KXtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uW2tleV0gPSBfaW5kZXhjanMuZGVmYXVsdFtrZXldO1xuICAgIH1cbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sIFwiY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1wiLCAoKT0+e1xuICAgICAgICB2YXIgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZyA9IHt9O1xuICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMoY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmcpKXtcbiAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMiksIG1vZHVsZUlkID0gX3JlZlswXSwgZGF0YSA9IF9yZWZbMV07XG4gICAgICAgICAgICBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nW21vZHVsZUlkXSA9IHtcbiAgICAgICAgICAgICAgICBnZXR0ZXI6IGRhdGEuZmFsbGJhY2ssXG4gICAgICAgICAgICAgICAgc2hhcmVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZERlcGVuZGVuY2llczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZFZlcnNpb246IGRhdGEucmVxdWlyZWRWZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaWN0VmVyc2lvbjogZGF0YS5zdHJpY3RWZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2luZ2xldG9uOiBkYXRhLnNpbmdsZXRvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGVhZ2VyOiBkYXRhLmVhZ2VyXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnNoYXJlU2NvcGVcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2hhcmVLZXk6IGRhdGEuc2hhcmVLZXlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmc7XG4gICAgfSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLCBcImluaXRPcHRpb25zXCIsICgpPT4oe30pKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwibmFtZVwiLCAoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwic2hhcmVTdHJhdGVneVwiLCAoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwic2hhcmVkXCIsICgpPT57XG4gICAgICAgIHZhciBzaGFyZWQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgcmVmIG9mIE9iamVjdC5lbnRyaWVzKGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZykpe1xuICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgc2NvcGUgPSBfcmVmWzBdLCBzdGFnZXMgPSBfcmVmWzFdO1xuICAgICAgICAgICAgZm9yICh2YXIgc3RhZ2Ugb2Ygc3RhZ2VzKXtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0YWdlID09PSBcIm9iamVjdFwiICYmIHN0YWdlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gc3RhZ2UubmFtZSwgdmVyc2lvbiA9IHN0YWdlLnZlcnNpb24sIGZhY3RvcnkgPSBzdGFnZS5mYWN0b3J5LCBlYWdlciA9IHN0YWdlLmVhZ2VyLCBzaW5nbGV0b24gPSBzdGFnZS5zaW5nbGV0b24sIHJlcXVpcmVkVmVyc2lvbiA9IHN0YWdlLnJlcXVpcmVkVmVyc2lvbiwgc3RyaWN0VmVyc2lvbiA9IHN0YWdlLnN0cmljdFZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZUNvbmZpZyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNWYWxpZFZhbHVlID0gZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbCAhPT0gXCJ1bmRlZmluZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShzaW5nbGV0b24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUNvbmZpZy5zaW5nbGV0b24gPSBzaW5nbGV0b247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShyZXF1aXJlZFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUNvbmZpZy5yZXF1aXJlZFZlcnNpb24gPSByZXF1aXJlZFZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShlYWdlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnLmVhZ2VyID0gZWFnZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShzdHJpY3RWZXJzaW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbiA9IHN0cmljdFZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZVxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0OiBmYWN0b3J5XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWRbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZFtuYW1lXS5wdXNoKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkW25hbWVdID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNoYXJlZDtcbiAgICB9KTtcbiAgICBtZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwicmVtb3Rlc1wiLCAoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKChyZW1vdGUpPT5yZW1vdGUuZXh0ZXJuYWxUeXBlID09PSBcInNjcmlwdFwiKSk7XG4gICAgbWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLCBcInBsdWdpbnNcIiwgKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18pO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbiwgXCJidW5kbGVyUnVudGltZU9wdGlvbnNcIiwgKCk9Pih7fSkpO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMsIFwicmVtb3Rlc1wiLCAoKT0+KHt9KSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLCBcImNodW5rTWFwcGluZ1wiLCAoKT0+cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcpO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcywgXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1wiLCAoKT0+e1xuICAgICAgICB2YXIgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmcgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgcmVmIG9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7XG4gICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDIpLCBtb2R1bGVJZCA9IF9yZWZbMF0sIGRhdGEgPSBfcmVmWzFdO1xuICAgICAgICAgICAgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmdbbW9kdWxlSWRdID0gW1xuICAgICAgICAgICAgICAgIGRhdGEuc2hhcmVTY29wZSxcbiAgICAgICAgICAgICAgICBkYXRhLm5hbWUsXG4gICAgICAgICAgICAgICAgZGF0YS5leHRlcm5hbE1vZHVsZUlkLFxuICAgICAgICAgICAgICAgIGRhdGEucmVtb3RlTmFtZVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmc7XG4gICAgfSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLCBcIndlYnBhY2tSZXF1aXJlXCIsICgpPT5fX3dlYnBhY2tfcmVxdWlyZV9fKTtcbiAgICBtZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsIFwiaWRUb1JlbW90ZU1hcFwiLCAoKT0+e1xuICAgICAgICB2YXIgaWRUb1JlbW90ZU1hcCA9IHt9O1xuICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtcbiAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMiksIGlkID0gX3JlZlswXSwgcmVtb3RlRGF0YSA9IF9yZWZbMV07XG4gICAgICAgICAgICB2YXIgaW5mbyA9IF9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX19bcmVtb3RlRGF0YS5yZW1vdGVOYW1lXTtcbiAgICAgICAgICAgIGlmIChpbmZvKSBpZFRvUmVtb3RlTWFwW2lkXSA9IGluZm87XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlkVG9SZW1vdGVNYXA7XG4gICAgfSk7XG4gICAgb3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXywgXCJTXCIsIF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtcbiAgICBpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApIHtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4gICAgfVxuICAgIG92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZiwgXCJyZW1vdGVzXCIsIChjaHVua0lkLCBwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtcbiAgICAgICAgICAgIGNodW5rSWQsXG4gICAgICAgICAgICBwcm9taXNlcyxcbiAgICAgICAgICAgIGNodW5rTWFwcGluZzogcmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcsXG4gICAgICAgICAgICBpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nLFxuICAgICAgICAgICAgaWRUb1JlbW90ZU1hcDogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9SZW1vdGVNYXAsXG4gICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZTogX193ZWJwYWNrX3JlcXVpcmVfX1xuICAgICAgICB9KSk7XG4gICAgb3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLCBcImNvbnN1bWVzXCIsIChjaHVua0lkLCBwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5jb25zdW1lcyh7XG4gICAgICAgICAgICBjaHVua0lkLFxuICAgICAgICAgICAgcHJvbWlzZXMsXG4gICAgICAgICAgICBjaHVua01hcHBpbmc6IGNvbnN1bWVzTG9hZGluZ0NodW5rTWFwcGluZyxcbiAgICAgICAgICAgIG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6IF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nLFxuICAgICAgICAgICAgaW5zdGFsbGVkTW9kdWxlczogY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyxcbiAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlOiBfX3dlYnBhY2tfcmVxdWlyZV9fXG4gICAgICAgIH0pKTtcbiAgICBvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLCBcIklcIiwgKG5hbWUsIGluaXRTY29wZSk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5JKHtcbiAgICAgICAgICAgIHNoYXJlU2NvcGVOYW1lOiBuYW1lLFxuICAgICAgICAgICAgaW5pdFNjb3BlLFxuICAgICAgICAgICAgaW5pdFByb21pc2VzOiBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcyxcbiAgICAgICAgICAgIGluaXRUb2tlbnM6IGluaXRpYWxpemVTaGFyaW5nSW5pdFRva2VucyxcbiAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlOiBfX3dlYnBhY2tfcmVxdWlyZV9fXG4gICAgICAgIH0pKTtcbiAgICBvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLCBcImluaXRDb250YWluZXJcIiwgKHNoYXJlU2NvcGUsIGluaXRTY29wZSwgcmVtb3RlRW50cnlJbml0T3B0aW9ucyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbml0Q29udGFpbmVyRW50cnkoe1xuICAgICAgICAgICAgc2hhcmVTY29wZSxcbiAgICAgICAgICAgIGluaXRTY29wZSxcbiAgICAgICAgICAgIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsXG4gICAgICAgICAgICBzaGFyZVNjb3BlS2V5OiBjb250YWluZXJTaGFyZVNjb3BlLFxuICAgICAgICAgICAgd2VicGFja1JlcXVpcmU6IF9fd2VicGFja19yZXF1aXJlX19cbiAgICAgICAgfSkpO1xuICAgIG92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sIFwiZ2V0Q29udGFpbmVyXCIsIChtb2R1bGUxLCBnZXRTY29wZSk9PntcbiAgICAgICAgdmFyIG1vZHVsZU1hcCA9IF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhLm1vZHVsZU1hcDtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5SID0gZ2V0U2NvcGU7XG4gICAgICAgIGdldFNjb3BlID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZHVsZU1hcCwgbW9kdWxlMSkgPyBtb2R1bGVNYXBbbW9kdWxlMV0oKSA6IFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCk9PntcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTW9kdWxlIFwiJyArIG1vZHVsZTEgKyAnXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpO1xuICAgICAgICB9KTtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5SID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gZ2V0U2NvcGU7XG4gICAgfSk7XG4gICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluc3RhbmNlID0gX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO1xuICAgIGlmICgoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMiA9IF9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMi5pbml0aWFsQ29uc3VtZXMpIHtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe1xuICAgICAgICAgICAgd2VicGFja1JlcXVpcmU6IF9fd2VicGFja19yZXF1aXJlX18sXG4gICAgICAgICAgICBpbnN0YWxsZWRNb2R1bGVzOiBjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLFxuICAgICAgICAgICAgaW5pdGlhbENvbnN1bWVzOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLFxuICAgICAgICAgICAgbW9kdWxlVG9IYW5kbGVyTWFwcGluZzogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5cbn0pLFxuXCJ3ZWJwYWNrL2NvbnRhaW5lci9lbnRyeS9zcG9ydHNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiBjb250YWluZXIgZW50cnkgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbl9fd2VicGFja19yZXF1aXJlX18uZChleHBvcnRzLCB7XG5cdGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmdldENvbnRhaW5lcjsgfSxcblx0aW5pdDogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRDb250YWluZXI7IH1cbn0pO1xuXG59KSxcblxufSk7XG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4vLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbnZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuaWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5yZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG59XG4vLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxudmFyIG1vZHVsZSA9IChfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuaWQ6IG1vZHVsZUlkLFxubG9hZGVkOiBmYWxzZSxcbmV4cG9ydHM6IHt9XG59KTtcbi8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuX193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbi8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbm1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbnJldHVybiBtb2R1bGUuZXhwb3J0cztcblxufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbl9fd2VicGFja19yZXF1aXJlX18uYyA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfXztcblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8vIG1vZHVsZV9mZWRlcmF0aW9uL3J1bnRpbWVcbiFmdW5jdGlvbigpIHtcblxuaWYoIV9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbil7XG4gICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uID0ge1xuICAgICAgICBcbmNodW5rTWF0Y2hlcjogZnVuY3Rpb24oY2h1bmtJZCkge1xuICAgIHJldHVybiAhL14oXFwtd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdFxcLV8oNjYwY3w3YzI0KXx3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0XFwtbmF0aXZlXyhhc3NldHNcXC1yZWdpc3RyeV8ocGF0aFxcLXN1cHBvcnRfcmVhY3RcXC1uYXRpdmVfYXNzZXRzXFwtMzVmMTU0fHJlZ2lzdHJ5X3JlYWN0XFwtbmF0aXZlX2Fzc2V0c1xcLXJlZ1xcLTVkMWVhZSl8TGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsXFwtOTZhNjk2fG5vcm1hbGl6ZVxcLWNvbG9yc19yZWFjdFxcLW5hdGl2ZV9ub3JtYWxpemVcXC1jb2xvcnN8cmVhY3RcXC1uYXRpdmV8c3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXFwtZmQzMDkwfHZpcnR1YWxpemVkXFwtbGlzdHNfcmVhY3RcXC1uYXRpdmVfdmlydHVhbGl6ZWRcXC1saXN0c1xcLWY2MTM3OSkpJC8udGVzdChjaHVua0lkKTtcbn0sXG5yb290T3V0cHV0RGlyOiBcIlwiLFxuXG4gICAgfTtcbn1cblxufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2RlZmluZV9wcm9wZXJ0eV9nZXR0ZXJzXG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBkZWZpbml0aW9uKSB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcbiAgICAgICAgaWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuICAgICAgICB9XG4gICAgfVxufTtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9lbnN1cmVfY2h1bmtcbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18uZiA9IHt9O1xuLy8gVGhpcyBmaWxlIGNvbnRhaW5zIG9ubHkgdGhlIGVudHJ5IGNodW5rLlxuLy8gVGhlIGNodW5rIGxvYWRpbmcgZnVuY3Rpb24gZm9yIGFkZGl0aW9uYWwgY2h1bmtzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmUgPSBmdW5jdGlvbihjaHVua0lkKSB7XG5cdHJldHVybiBQcm9taXNlLmFsbChcblx0XHRPYmplY3Qua2V5cyhfX3dlYnBhY2tfcmVxdWlyZV9fLmYpLnJlZHVjZShmdW5jdGlvbihwcm9taXNlcywga2V5KSB7XG5cdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmZba2V5XShjaHVua0lkLCBwcm9taXNlcyk7XG5cdFx0XHRyZXR1cm4gcHJvbWlzZXM7XG5cdFx0fSwgW10pXG5cdCk7XG59O1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2dldCBqYXZhc2NyaXB0IGNodW5rIGZpbGVuYW1lXG4hZnVuY3Rpb24oKSB7XG4vLyBUaGlzIGZ1bmN0aW9uIGFsbG93IHRvIHJlZmVyZW5jZSBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18udSA9IGZ1bmN0aW9uKGNodW5rSWQpIHtcbiAgLy8gcmV0dXJuIHVybCBmb3IgZmlsZW5hbWVzIG5vdCBiYXNlZCBvbiB0ZW1wbGF0ZVxuICBcbiAgLy8gcmV0dXJuIHVybCBmb3IgZmlsZW5hbWVzIGJhc2VkIG9uIHRlbXBsYXRlXG4gIHJldHVybiBcIlwiICsgY2h1bmtJZCArIFwiLmNodW5rLmJ1bmRsZVwiXG59XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsXG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpO1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2hhc19vd25fcHJvcGVydHlcbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH1cbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9sb2FkX3NjcmlwdFxuIWZ1bmN0aW9uKCkge1xuICBmdW5jdGlvbiBsb2FkU2NyaXB0SGFuZGxlcihuYW1lLCBjYWxsZXIsIGRvbmUsIHJlZmVyZW5jZVVybCkge1xuICAgIGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlcikge1xuICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIubG9hZFNjcmlwdChuYW1lLCBjYWxsZXIsIF9fd2VicGFja19yZXF1aXJlX18sIHJlZmVyZW5jZVVybCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRvbmUoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbUmVwYWNrUnVudGltZV0gTG9hZGluZyBzY3JpcHQgZmFpbGVkOicsIHJlYXNvbik7XG4gICAgICAgIGRvbmUoe1xuICAgICAgICAgIHR5cGU6ICdleGVjJyxcbiAgICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICAgIHNyYzogbmFtZVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5lcnJvcignW1JlcGFja1J1bnRpbWVdIFNjcmlwdCBtYW5hZ2VyIHdhcyBub3QgcHJvdmlkZWQnKTtcbiAgICAgIGRvbmUoe1xuICAgICAgICB0eXBlOiAnZXhlYycsXG4gICAgICAgIHRhcmdldDoge1xuICAgICAgICAgIHNyYzogbmFtZVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gbG9hZEhvdFVwZGF0ZUhhbmRsZXIodXJsLCBkb25lKSB7XG4gICAgaWYgKCFmYWxzZSkge1xuICAgICAgY29uc29sZS5lcnJvcignW1JlcGFja1J1bnRpbWVdIExvYWRpbmcgSE1SIHVwZGF0ZSBjaHVua3MgaXMgZGlzYWJsZWQnKTtcbiAgICAgIGRvbmUoe1xuICAgICAgICB0eXBlOiAnZGlzYWJsZWQnLFxuICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICBzcmM6IHVybFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZmV0Y2godXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbUmVwYWNrUnVudGltZV0gTG9hZGluZyBITVIgdXBkYXRlIGZhaWxlZDonLCByZXNwb25zZS5zdGF0dXNUZXh0KTtcbiAgICAgICAgZG9uZSh7XG4gICAgICAgICAgdHlwZTogcmVzcG9uc2Uuc3RhdHVzVGV4dCxcbiAgICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICAgIHNyYzogdXJsXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTtcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChzY3JpcHQpIHtcbiAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgaWYgKF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyKSB7XG4gICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIudW5zdGFibGVfZXZhbHVhdGVTY3JpcHQoc2NyaXB0LCB1cmwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGV2YWwoc2NyaXB0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZXBhY2tSdW50aW1lXSBMb2FkaW5nIEhNUiB1cGRhdGUgY2h1bmsgZmFpbGVkOicsIHJlYXNvbik7XG4gICAgICBkb25lKHtcbiAgICAgICAgdHlwZTogJ2V4ZWMnLFxuICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICBzcmM6IHVybFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICBfX3dlYnBhY2tfcmVxdWlyZV9fLmwgPSBmdW5jdGlvbiBsb2FkU2NyaXB0KHVybCwgZG9uZSwga2V5LCBjaHVua0lkKSB7XG4gICAgaWYgKGtleSAmJiBjaHVua0lkKSB7XG4gICAgICBsb2FkU2NyaXB0SGFuZGxlcihjaHVua0lkLCAnc3BvcnRzJywgZG9uZSwgdXJsKTtcbiAgICB9IGVsc2UgaWYgKGtleSkge1xuICAgICAgbG9hZFNjcmlwdEhhbmRsZXIoa2V5LCB1bmRlZmluZWQsIGRvbmUsIHVybCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvYWRIb3RVcGRhdGVIYW5kbGVyKHVybCwgZG9uZSk7XG4gICAgfVxuICB9O1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL25vZGVfbW9kdWxlX2RlY29yYXRvclxuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5ubWQgPSBmdW5jdGlvbihtb2R1bGUpIHtcbiAgbW9kdWxlLnBhdGhzID0gW107XG4gIGlmICghbW9kdWxlLmNoaWxkcmVuKSBtb2R1bGUuY2hpbGRyZW4gPSBbXTtcbiAgcmV0dXJuIG1vZHVsZTtcbn07XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvcHVibGljX3BhdGhcbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwibm9vcDovLy9cIjtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9yZXBhY2svZ3VhcmRlZCByZXF1aXJlXG4hZnVuY3Rpb24oKSB7XG4gIHZhciBpbkd1YXJkID0gZmFsc2U7XG4gIHZhciBvcmlnaW5hbFdlYnBhY2tSZXF1aXJlID0gX193ZWJwYWNrX3JlcXVpcmVfXztcbiAgZnVuY3Rpb24gZ3VhcmRlZFdlYnBhY2tSZXF1aXJlKG1vZHVsZUlkKSB7XG4gICAgaWYgKCFpbkd1YXJkICYmIHNlbGYuRXJyb3JVdGlscykge1xuICAgICAgaW5HdWFyZCA9IHRydWU7XG4gICAgICBsZXQgZXhwb3J0cztcbiAgICAgIHRyeSB7XG4gICAgICAgIGV4cG9ydHMgPSBvcmlnaW5hbFdlYnBhY2tSZXF1aXJlKG1vZHVsZUlkKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgc2VsZi5FcnJvclV0aWxzLnJlcG9ydEZhdGFsRXJyb3IoZSk7XG4gICAgICB9XG4gICAgICBpbkd1YXJkID0gZmFsc2U7XG4gICAgICByZXR1cm4gZXhwb3J0cztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG9yaWdpbmFsV2VicGFja1JlcXVpcmUobW9kdWxlSWQpO1xuICAgIH1cbiAgfVxuICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvcmlnaW5hbFdlYnBhY2tSZXF1aXJlKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgZ3VhcmRlZFdlYnBhY2tSZXF1aXJlW2tleV0gPSBvcmlnaW5hbFdlYnBhY2tSZXF1aXJlW2tleV07XG4gIH0pO1xuICBfX3dlYnBhY2tfcmVxdWlyZV9fID0gZ3VhcmRlZFdlYnBhY2tSZXF1aXJlO1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL3JlcGFjay9pbml0XG4hZnVuY3Rpb24oKSB7XG4gIHZhciByZXBhY2tSdW50aW1lID0ge1xuICAgIHNoYXJlZDogc2VsZi5fX3JlcGFja19fICYmIHNlbGYuX19yZXBhY2tfXy5zaGFyZWQgfHwgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2sgJiYgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkIHx8IHtcbiAgICAgIHNjcmlwdE1hbmFnZXI6IHVuZGVmaW5lZFxuICAgIH1cbiAgfTtcbiAgX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2sgPSBzZWxmLl9fcmVwYWNrX18gPSByZXBhY2tSdW50aW1lO1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL3JzcGFja192ZXJzaW9uXG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLnJ2ID0gZnVuY3Rpb24oKSB7IHJldHVybiBcIjEuMy4xNVwiOyB9XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvc2hhcmluZ1xuIWZ1bmN0aW9uKCkge1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLlMgPSB7fTtcbl9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhID0geyBzY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nOiB7IFwiZGVmYXVsdFwiOiBbeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydFwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnNcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMvaW5kZXguanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzXCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV82NjBjXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9yZWFjdC1uYXRpdmVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy1mZDMwOTBcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2dldF9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkXy1kZDI1N2VcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzL2luZGV4LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0cy9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV83YzI0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X3JlYWN0LW5hdGl2ZV9hc3NldHMtMzVmMTU0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19jbGFzc19wcml2YXRlX2ZpZWxkX2xvb3NlX2Jhc2VfY2pzLW5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janMtMzEyMjdiXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmVcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X1ZpZXdDb24tOTkxYzhhXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHlcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fN2MyNFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzY2MGNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHkuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19jYWxsc3RhY2tfcmVwYWNrX2Rpc3RfbW9kdWxlc19FbXB0eU1vZHVsZV9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRW1wdHlNb2R1bGUuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRW1wdHlNb2R1bGUuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fN2MyNFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzY2MGNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yXCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1N0eWxlU2hlZXRfcHJvY2Vzc0NvbG9yX2pzXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvci5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3IuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXlcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3ItZTg2ZWU2XCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5LmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc1wiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2ludGVyb3BfcmVxdWlyZV93aWxkY2FyZF9janMtbm9kZV9tb2R1bGVzX2ludmFyaWFudF9icm93c2VyX2pzXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmVcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fN2MyNFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzY2MGNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxIH0sIHsgbmFtZTogXCJyZWFjdFwiLCB2ZXJzaW9uOiBcIjE5LjAuMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0L2luZGV4LmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QvaW5kZXguanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxIH1dIH0sIHVuaXF1ZU5hbWU6IFwic3BvcnRzXCIgfTtcbl9fd2VicGFja19yZXF1aXJlX18uSSA9IF9fd2VicGFja19yZXF1aXJlX18uSSB8fCBmdW5jdGlvbigpIHsgdGhyb3cgbmV3IEVycm9yKFwic2hvdWxkIGhhdmUgX193ZWJwYWNrX3JlcXVpcmVfXy5JXCIpIH1cblxufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2NvbnN1bWVzX2xvYWRpbmdcbiFmdW5jdGlvbigpIHtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhID0geyBjaHVua01hcHBpbmc6IHtcInNwb3J0c1wiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT8xYWZlXCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9yc1wiXSxcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV83YzI0XCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD83YzI0XCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnlcIl0sXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fNjYwY1wiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QvcmVhY3Q/NjYwY1wiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmUvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVcIl0sXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9yZWFjdC1uYXRpdmVcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/NWE4YVwiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy1mZDMwOTBcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc1wiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnRcIl0sXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHMtZjYxMzc5XCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeVwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzL0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHNcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eVwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5XCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3IvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvclwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmVcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheVwiXSxcIl9fZmVkZXJhdGlvbl9leHBvc2VfQXBwXCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD8yNWFjXCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/Y2Y1YlwiXX0sIG1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc6IHsgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc1wiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvci9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3IgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yLmpzXCIpOyB9OyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD83YzI0XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0XCIsIGltcG9ydDogXCJyZWFjdFwiLCByZXF1aXJlZFZlcnNpb246IFwiXjE5LjAuMFwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5ICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkuanNcIik7IH07IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5XCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MFwiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnkgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnkuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlP2NmNWJcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmVcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIjAuNzguMFwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MThcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzdjMjRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydFwiLCBpbXBvcnQ6IFwiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIEByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydCAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnNcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwiQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzXCIsIGltcG9ydDogXCJAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnNcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD82NjBjXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0XCIsIGltcG9ydDogXCJyZWFjdFwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkuanNcIik7IH07IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/NWE4YVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmVcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfQ29tcG9uZW50c19BY2Nlc3NpYmlsaXR5SW5mb19sZWdhY3lTZW5kQWNjZXNzaWJpbC1mOTI3MThcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzdjMjRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlPzFhZmVcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmVcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIj49MC43NFwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV83YzI0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fNjYwY1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzLWY2MTM3OVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0c1wiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzXCIsIGltcG9ydDogXCJAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfcmVhY3QtbmF0aXZlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MtZmQzMDkwXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0cyAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmUgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZS5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5XCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eS5qc1wiKTsgfTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QvcmVhY3Q/MjVhY1wiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdFwiLCBpbXBvcnQ6IFwicmVhY3RcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIjE5LjAuMFwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmVcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUuanNcIik7IH07IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5XCIsIGltcG9ydDogXCJAcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeVwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIEByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5ICovIFwiLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkuanNcIik7IH07IH0pOyB9IH0gfSwgaW5pdGlhbENvbnN1bWVzOiBbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/MWFmZVwiXSB9O1xuX193ZWJwYWNrX3JlcXVpcmVfXy5mLmNvbnN1bWVzID0gX193ZWJwYWNrX3JlcXVpcmVfXy5mLmNvbnN1bWVzIHx8IGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJzaG91bGQgaGF2ZSBfX3dlYnBhY2tfcmVxdWlyZV9fLmYuY29uc3VtZXNcIikgfVxufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2luaXRpYWxpemVfZXhwb3Nlc1xuIWZ1bmN0aW9uKCkge1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSA9IHtcbiAgbW9kdWxlTWFwOiB7XG4gIFwiLi9BcHBcIjogZnVuY3Rpb24oKSB7XG5yZXR1cm4gUHJvbWlzZS5hbGwoLyohICB8IF9fZmVkZXJhdGlvbl9leHBvc2VfQXBwICovIFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfc2hvcGlmeV9yZWFjdC1uYXRpdmUtcGVyZm9ybWFuY2VfZGlzdF9pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzY2MGNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3JlYWN0LW5hdGl2ZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiX19mZWRlcmF0aW9uX2V4cG9zZV9BcHBcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL0FwcC5qcyAqLyBcIi4vQXBwLmpzXCIpOyB9OyB9KTtcbn0sXG59LFxuICBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIixcbn07XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmdldENvbnRhaW5lciA9IF9fd2VicGFja19yZXF1aXJlX18uZ2V0Q29udGFpbmVyIHx8IGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJzaG91bGQgaGF2ZSBfX3dlYnBhY2tfcmVxdWlyZV9fLmdldENvbnRhaW5lclwiKSB9O19fd2VicGFja19yZXF1aXJlX18uaW5pdENvbnRhaW5lciA9IF9fd2VicGFja19yZXF1aXJlX18uaW5pdENvbnRhaW5lciB8fCBmdW5jdGlvbigpIHsgdGhyb3cgbmV3IEVycm9yKFwic2hvdWxkIGhhdmUgX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0Q29udGFpbmVyXCIpIH07XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvanNvbnBfY2h1bmtfbG9hZGluZ1xuIWZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuICAgICAgLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4gICAgICAvLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbiAgICAgIHZhciBpbnN0YWxsZWRDaHVua3MgPSB7XCJzcG9ydHNcIjogMCx9O1xuICAgICAgXG4gICAgICAgIF9fd2VicGFja19yZXF1aXJlX18uZi5qID0gZnVuY3Rpb24gKGNodW5rSWQsIHByb21pc2VzKSB7XG4gICAgICAgICAgLy8gSlNPTlAgY2h1bmsgbG9hZGluZyBmb3IgamF2YXNjcmlwdFxudmFyIGluc3RhbGxlZENodW5rRGF0YSA9IF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpXG5cdD8gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdXG5cdDogdW5kZWZpbmVkO1xuaWYgKGluc3RhbGxlZENodW5rRGF0YSAhPT0gMCkge1xuXHQvLyAwIG1lYW5zIFwiYWxyZWFkeSBpbnN0YWxsZWRcIi5cblxuXHQvLyBhIFByb21pc2UgbWVhbnMgXCJjdXJyZW50bHkgbG9hZGluZ1wiLlxuXHRpZiAoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0cHJvbWlzZXMucHVzaChpbnN0YWxsZWRDaHVua0RhdGFbMl0pO1xuXHR9IGVsc2Uge1xuXHRcdGlmICghL14oXFwtd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdFxcLV8oNjYwY3w3YzI0KXx3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0XFwtbmF0aXZlXyhhc3NldHNcXC1yZWdpc3RyeV8ocGF0aFxcLXN1cHBvcnRfcmVhY3RcXC1uYXRpdmVfYXNzZXRzXFwtMzVmMTU0fHJlZ2lzdHJ5X3JlYWN0XFwtbmF0aXZlX2Fzc2V0c1xcLXJlZ1xcLTVkMWVhZSl8TGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsXFwtOTZhNjk2fG5vcm1hbGl6ZVxcLWNvbG9yc19yZWFjdFxcLW5hdGl2ZV9ub3JtYWxpemVcXC1jb2xvcnN8cmVhY3RcXC1uYXRpdmV8c3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXFwtZmQzMDkwfHZpcnR1YWxpemVkXFwtbGlzdHNfcmVhY3RcXC1uYXRpdmVfdmlydHVhbGl6ZWRcXC1saXN0c1xcLWY2MTM3OSkpJC8udGVzdChjaHVua0lkKSkge1xuXHRcdFx0Ly8gc2V0dXAgUHJvbWlzZSBpbiBjaHVuayBjYWNoZVxuXHRcdFx0dmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsgaW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gW3Jlc29sdmUsIHJlamVjdF07IH0pO1xuXHRcdFx0cHJvbWlzZXMucHVzaCgoaW5zdGFsbGVkQ2h1bmtEYXRhWzJdID0gcHJvbWlzZSkpO1xuXG5cdFx0XHQvLyBzdGFydCBjaHVuayBsb2FkaW5nXG5cdFx0XHR2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXy5wICsgX193ZWJwYWNrX3JlcXVpcmVfXy51KGNodW5rSWQpO1xuXHRcdFx0Ly8gY3JlYXRlIGVycm9yIGJlZm9yZSBzdGFjayB1bndvdW5kIHRvIGdldCB1c2VmdWwgc3RhY2t0cmFjZSBsYXRlclxuXHRcdFx0dmFyIGVycm9yID0gbmV3IEVycm9yKCk7XG5cdFx0XHR2YXIgbG9hZGluZ0VuZGVkID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSkge1xuXHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXTtcblx0XHRcdFx0XHRpZiAoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0aWYgKGluc3RhbGxlZENodW5rRGF0YSkge1xuXHRcdFx0XHRcdFx0dmFyIGVycm9yVHlwZSA9XG5cdFx0XHRcdFx0XHRcdGV2ZW50ICYmIChldmVudC50eXBlID09PSAnbG9hZCcgPyAnbWlzc2luZycgOiBldmVudC50eXBlKTtcblx0XHRcdFx0XHRcdHZhciByZWFsU3JjID0gZXZlbnQgJiYgZXZlbnQudGFyZ2V0ICYmIGV2ZW50LnRhcmdldC5zcmM7XG5cdFx0XHRcdFx0XHRlcnJvci5tZXNzYWdlID1cblx0XHRcdFx0XHRcdFx0J0xvYWRpbmcgY2h1bmsgJyArXG5cdFx0XHRcdFx0XHRcdGNodW5rSWQgK1xuXHRcdFx0XHRcdFx0XHQnIGZhaWxlZC5cXG4oJyArXG5cdFx0XHRcdFx0XHRcdGVycm9yVHlwZSArXG5cdFx0XHRcdFx0XHRcdCc6ICcgK1xuXHRcdFx0XHRcdFx0XHRyZWFsU3JjICtcblx0XHRcdFx0XHRcdFx0JyknO1xuXHRcdFx0XHRcdFx0ZXJyb3IubmFtZSA9ICdDaHVua0xvYWRFcnJvcic7XG5cdFx0XHRcdFx0XHRlcnJvci50eXBlID0gZXJyb3JUeXBlO1xuXHRcdFx0XHRcdFx0ZXJyb3IucmVxdWVzdCA9IHJlYWxTcmM7XG5cdFx0XHRcdFx0XHRpbnN0YWxsZWRDaHVua0RhdGFbMV0oZXJyb3IpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubCh1cmwsIGxvYWRpbmdFbmRlZCwgXCJjaHVuay1cIiArIGNodW5rSWQsIGNodW5rSWQpO1xuXHRcdH0gZWxzZSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXG5cdH1cbn1cblxuICAgICAgICB9XG4gICAgICAgIC8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xudmFyIHdlYnBhY2tKc29ucENhbGxiYWNrID0gZnVuY3Rpb24ocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24sIGRhdGEpIHtcblx0dmFyIGNodW5rSWRzID0gZGF0YVswXTtcbnZhciBtb3JlTW9kdWxlcyA9IGRhdGFbMV07XG52YXIgcnVudGltZSA9IGRhdGFbMl07XG5cdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuXHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcblx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMDtcblx0aWYgKGNodW5rSWRzLnNvbWUoZnVuY3Rpb24oaWQpIHsgcmV0dXJuIGluc3RhbGxlZENodW5rc1tpZF0gIT09IDA7IH0pKSB7XG5cdFx0Zm9yIChtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubyhtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubVttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChydW50aW1lKSB2YXIgcmVzdWx0ID0gcnVudGltZShfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblx0fVxuXHRpZiAocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24pIHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKGRhdGEpO1xuXHRmb3IgKDsgaSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuXHRcdGlmIChcblx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpICYmXG5cdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1cblx0XHQpIHtcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSgpO1xuXHRcdH1cblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXHR9XG5cdFxufTtcblxudmFyIGNodW5rTG9hZGluZ0dsb2JhbCA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmtzcG9ydHNcIl0gPSBzZWxmW1wid2VicGFja0NodW5rc3BvcnRzXCJdIHx8IFtdO1xuY2h1bmtMb2FkaW5nR2xvYmFsLmZvckVhY2god2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCAwKSk7XG5jaHVua0xvYWRpbmdHbG9iYWwucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2guYmluZChjaHVua0xvYWRpbmdHbG9iYWwpKTtcblxufSgpO1xuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8vIG1vZHVsZSBjYWNoZSBhcmUgdXNlZCBzbyBlbnRyeSBpbmxpbmluZyBpcyBkaXNhYmxlZFxuLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fKFwiQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvcnNwYWNrLmpzIT0hZGF0YTp0ZXh0L2phdmFzY3JpcHQsaW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fYnVuZGxlcl9ydW50aW1lX18gZnJvbSBcXFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvc3BvcnRzL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanNcXFwiO2ltcG9ydCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXyBmcm9tIFxcXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS9zcG9ydHMvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL3Jlc29sdmVyLXBsdWdpbi5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3Nwb3J0cy9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanNcXFwiO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18gPSBbX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8wX18oKSwgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18oKV07Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXyA9IHt9O2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyA9IFxcXCJzcG9ydHNcXFwiO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyA9IFxcXCJsb2FkZWQtZmlyc3RcXFwiO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YXx8X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpJiZfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24pe3ZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTEsX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMjtjb25zdCBvdmVycmlkZT0ob2JqLGtleSx2YWx1ZSk9PntpZighb2JqKXJldHVybjtpZihvYmpba2V5XSlvYmpba2V5XT12YWx1ZX07Y29uc3QgbWVyZ2U9KG9iaixrZXksZm4pPT57Y29uc3QgdmFsdWU9Zm4oKTtpZihBcnJheS5pc0FycmF5KHZhbHVlKSl7dmFyIF9vYmosX2tleTt2YXIgXzsoXz0oX29iaj1vYmopW19rZXk9a2V5XSkhPT1udWxsJiZfIT09dm9pZCAwP186X29ialtfa2V5XT1bXTtvYmpba2V5XS5wdXNoKC4uLnZhbHVlKX1lbHNlIGlmKHR5cGVvZiB2YWx1ZT09PVxcXCJvYmplY3RcXFwiJiZ2YWx1ZSE9PW51bGwpe3ZhciBfb2JqMSxfa2V5MTt2YXIgXzE7KF8xPShfb2JqMT1vYmopW19rZXkxPWtleV0pIT09bnVsbCYmXzEhPT12b2lkIDA/XzE6X29iajFbX2tleTFdPXt9O09iamVjdC5hc3NpZ24ob2JqW2tleV0sdmFsdWUpfX07Y29uc3QgZWFybHk9KG9iaixrZXksaW5pdGlhbCk9Pnt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPWluaXRpYWwoKX07dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCByZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZztjb25zdCByZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9X193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEubW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc7Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEuc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLmNodW5rTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nO2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nOnt9O2NvbnN0IGNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXM9e307Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdJbml0UHJvbWlzZXM9W107Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zPXt9O2NvbnN0IGNvbnRhaW5lclNoYXJlU2NvcGU9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YS5zaGFyZVNjb3BlO2Zvcihjb25zdCBrZXkgaW4gX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uW2tleV09X19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfX1trZXldfWVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1xcXCIsKCk9Pntjb25zdCBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nPXt9O2ZvcihsZXRbbW9kdWxlSWQsZGF0YV1vZiBPYmplY3QuZW50cmllcyhjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZykpe2NvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdbbW9kdWxlSWRdPXtnZXR0ZXI6ZGF0YS5mYWxsYmFjayxzaGFyZUluZm86e3NoYXJlQ29uZmlnOntmaXhlZERlcGVuZGVuY2llczpmYWxzZSxyZXF1aXJlZFZlcnNpb246ZGF0YS5yZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbjpkYXRhLnN0cmljdFZlcnNpb24sc2luZ2xldG9uOmRhdGEuc2luZ2xldG9uLGVhZ2VyOmRhdGEuZWFnZXJ9LHNjb3BlOltkYXRhLnNoYXJlU2NvcGVdfSxzaGFyZUtleTpkYXRhLnNoYXJlS2V5fX1yZXR1cm4gY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiaW5pdE9wdGlvbnNcXFwiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXFxcIm5hbWVcXFwiLCgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwic2hhcmVTdHJhdGVneVxcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fc2hhcmVfc3RyYXRlZ3lfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJzaGFyZWRcXFwiLCgpPT57Y29uc3Qgc2hhcmVkPXt9O2ZvcihsZXRbc2NvcGUsc3RhZ2VzXW9mIE9iamVjdC5lbnRyaWVzKGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZykpe2ZvcihsZXQgc3RhZ2Ugb2Ygc3RhZ2VzKXtpZih0eXBlb2Ygc3RhZ2U9PT1cXFwib2JqZWN0XFxcIiYmc3RhZ2UhPT1udWxsKXtjb25zdHtuYW1lLHZlcnNpb24sZmFjdG9yeSxlYWdlcixzaW5nbGV0b24scmVxdWlyZWRWZXJzaW9uLHN0cmljdFZlcnNpb259PXN0YWdlO2NvbnN0IHNoYXJlQ29uZmlnPXt9O2NvbnN0IGlzVmFsaWRWYWx1ZT1mdW5jdGlvbih2YWwpe3JldHVybiB0eXBlb2YgdmFsIT09XFxcInVuZGVmaW5lZFxcXCJ9O2lmKGlzVmFsaWRWYWx1ZShzaW5nbGV0b24pKXtzaGFyZUNvbmZpZy5zaW5nbGV0b249c2luZ2xldG9ufWlmKGlzVmFsaWRWYWx1ZShyZXF1aXJlZFZlcnNpb24pKXtzaGFyZUNvbmZpZy5yZXF1aXJlZFZlcnNpb249cmVxdWlyZWRWZXJzaW9ufWlmKGlzVmFsaWRWYWx1ZShlYWdlcikpe3NoYXJlQ29uZmlnLmVhZ2VyPWVhZ2VyfWlmKGlzVmFsaWRWYWx1ZShzdHJpY3RWZXJzaW9uKSl7c2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbj1zdHJpY3RWZXJzaW9ufWNvbnN0IG9wdGlvbnM9e3ZlcnNpb24sc2NvcGU6W3Njb3BlXSxzaGFyZUNvbmZpZyxnZXQ6ZmFjdG9yeX07aWYoc2hhcmVkW25hbWVdKXtzaGFyZWRbbmFtZV0ucHVzaChvcHRpb25zKX1lbHNle3NoYXJlZFtuYW1lXT1bb3B0aW9uc119fX19cmV0dXJuIHNoYXJlZH0pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwicmVtb3Rlc1xcXCIsKCk9Pk9iamVjdC52YWx1ZXMoX19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfXykuZmxhdCgpLmZpbHRlcihyZW1vdGU9PnJlbW90ZS5leHRlcm5hbFR5cGU9PT1cXFwic2NyaXB0XFxcIikpO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwicGx1Z2luc1xcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcXFwiYnVuZGxlclJ1bnRpbWVPcHRpb25zXFxcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucyxcXFwicmVtb3Rlc1xcXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiY2h1bmtNYXBwaW5nXFxcIiwoKT0+cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdcXFwiLCgpPT57Y29uc3QgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7cmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmdbbW9kdWxlSWRdPVtkYXRhLnNoYXJlU2NvcGUsZGF0YS5uYW1lLGRhdGEuZXh0ZXJuYWxNb2R1bGVJZCxkYXRhLnJlbW90ZU5hbWVdfXJldHVybiByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ30pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwid2VicGFja1JlcXVpcmVcXFwiLCgpPT5fX3dlYnBhY2tfcmVxdWlyZV9fKTttZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsXFxcImlkVG9SZW1vdGVNYXBcXFwiLCgpPT57Y29uc3QgaWRUb1JlbW90ZU1hcD17fTtmb3IobGV0W2lkLHJlbW90ZURhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtjb25zdCBpbmZvPV9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX19bcmVtb3RlRGF0YS5yZW1vdGVOYW1lXTtpZihpbmZvKWlkVG9SZW1vdGVNYXBbaWRdPWluZm99cmV0dXJuIGlkVG9SZW1vdGVNYXB9KTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJTXFxcIixfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuUyk7aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKF9fd2VicGFja19yZXF1aXJlX18pfW92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcXFwicmVtb3Rlc1xcXCIsKGNodW5rSWQscHJvbWlzZXMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUucmVtb3Rlcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcsaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nLGlkVG9SZW1vdGVNYXA6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9SZW1vdGVNYXAsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLmYsXFxcImNvbnN1bWVzXFxcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5jb25zdW1lcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6Y29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmcsaW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcXFwiSVxcXCIsKG5hbWUsaW5pdFNjb3BlKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLkkoe3NoYXJlU2NvcGVOYW1lOm5hbWUsaW5pdFNjb3BlLGluaXRQcm9taXNlczppbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcyxpbml0VG9rZW5zOmluaXRpYWxpemVTaGFyaW5nSW5pdFRva2Vucyx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcImluaXRDb250YWluZXJcXFwiLChzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluaXRDb250YWluZXJFbnRyeSh7c2hhcmVTY29wZSxpbml0U2NvcGUscmVtb3RlRW50cnlJbml0T3B0aW9ucyxzaGFyZVNjb3BlS2V5OmNvbnRhaW5lclNoYXJlU2NvcGUsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJnZXRDb250YWluZXJcXFwiLChtb2R1bGUxLGdldFNjb3BlKT0+e3ZhciBtb2R1bGVNYXA9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEubW9kdWxlTWFwO19fd2VicGFja19yZXF1aXJlX18uUj1nZXRTY29wZTtnZXRTY29wZT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kdWxlTWFwLG1vZHVsZTEpP21vZHVsZU1hcFttb2R1bGUxXSgpOlByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCk9Pnt0aHJvdyBuZXcgRXJyb3IoJ01vZHVsZSBcXFwiJyttb2R1bGUxKydcXFwiIGRvZXMgbm90IGV4aXN0IGluIGNvbnRhaW5lci4nKX0pO19fd2VicGFja19yZXF1aXJlX18uUj11bmRlZmluZWQ7cmV0dXJuIGdldFNjb3BlfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluc3RhbmNlPV9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5ydW50aW1lLmluaXQoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zKTtpZigoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMj09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMi5pbml0aWFsQ29uc3VtZXMpe19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbnN0YWxsSW5pdGlhbENvbnN1bWVzKHt3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9fLGluc3RhbGxlZE1vZHVsZXM6Y29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyxpbml0aWFsQ29uc3VtZXM6X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhLmluaXRpYWxDb25zdW1lcyxtb2R1bGVUb0hhbmRsZXJNYXBwaW5nOl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSl9fVwiKTtcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcIndlYnBhY2svY29udGFpbmVyL2VudHJ5L3Nwb3J0c1wiKTtcbnNwb3J0cyA9IF9fd2VicGFja19leHBvcnRzX187XG59KSgpXG47Ly8jIHNvdXJjZU1hcHBpbmdVUkw9c3BvcnRzLmNvbnRhaW5lci5idW5kbGUubWFwP3BsYXRmb3JtPWFuZHJvaWQiLCJyZXNwb25zZVRpbWUiOjc5MjAsImlzSHRtbCI6ZmFsc2V9LCJlcnJvciI6bnVsbCwic3RhdHVzIjoicGFzcyIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjo4LjkyMzYwNzY1NywibmFtZSI6Ii9zcG9ydHMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9zcG9ydHMuY29udGFpbmVyLmJ1bmRsZSIsInBhdGgiOiJzcG9ydHMtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC1zcG9ydHMuY29udGFpbmVyLmJ1bmRsZSIsIml0ZXJhdGlvbkluZGV4IjoxfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJ0cmF2ZWxzLWxlYXN0LWFuZHJvaWQtZGV2ZWxvcG1lbnQtbWYtbWFuaWZlc3QuanNvbi5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvYXJ0aWZhY3RzL3RyYXZlbHMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9tZi1tYW5pZmVzdC5qc29uIiwiaGVhZGVycyI6eyJVc2VyLUFnZW50IjoiaW5zb21uaWEvMTEuMi4wIn0sImlzSHRtbCI6ZmFsc2V9LCJyZXNwb25zZSI6eyJzdGF0dXMiOiJlcnJvciIsInN0YXR1c1RleHQiOm51bGwsImhlYWRlcnMiOm51bGwsImRhdGEiOm51bGwsInJlc3BvbnNlVGltZSI6MCwiaXNIdG1sIjpmYWxzZX0sImVycm9yIjoiY29ubmVjdCBFVElNRURPVVQgMTMuMjE1LjIzOS4yMTk6NDQzIiwic3RhdHVzIjoiZXJyb3IiLCJhc3NlcnRpb25SZXN1bHRzIjpbXSwidGVzdFJlc3VsdHMiOltdLCJwcmVSZXF1ZXN0VGVzdFJlc3VsdHMiOltdLCJwb3N0UmVzcG9uc2VUZXN0UmVzdWx0cyI6W10sInNob3VsZFN0b3BSdW5uZXJFeGVjdXRpb24iOmZhbHNlLCJydW5EdXJhdGlvbiI6MS41MDkyNjE1MTIwMDAwMDAxLCJuYW1lIjoiL3RyYXZlbHMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC9tZi1tYW5pZmVzdC5qc29uIiwicGF0aCI6InRyYXZlbHMtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC1tZi1tYW5pZmVzdC5qc29uIiwiaXRlcmF0aW9uSW5kZXgiOjF9LHsidGVzdCI6eyJmaWxlbmFtZSI6InRyYXZlbHMtbGVhc3QtYW5kcm9pZC1kZXZlbG9wbWVudC10cmF2ZWxzLmNvbnRhaW5lci5idW5kbGUuYnJ1In0sInJlcXVlc3QiOnsibWV0aG9kIjoiR0VUIiwidXJsIjoiaHR0cHM6Ly9yZWFjdC1uYXRpdmUtYXJ0aWZhY3RzLm5ldGxpZnkuYXBwL2FydGlmYWN0cy90cmF2ZWxzL2xlYXN0L2FuZHJvaWQvZGV2ZWxvcG1lbnQvdHJhdmVscy5jb250YWluZXIuYnVuZGxlIiwiaGVhZGVycyI6eyJVc2VyLUFnZW50IjoiaW5zb21uaWEvMTEuMi4wIn0sImlzSHRtbCI6ZmFsc2V9LCJyZXNwb25zZSI6eyJzdGF0dXMiOjIwMCwic3RhdHVzVGV4dCI6Ik9LIiwiaGVhZGVycyI6eyJhY2NlcHQtcmFuZ2VzIjoiYnl0ZXMiLCJhZ2UiOiIxIiwiY2FjaGUtY29udHJvbCI6InB1YmxpYyxtYXgtYWdlPTAsbXVzdC1yZXZhbGlkYXRlIiwiY2FjaGUtc3RhdHVzIjoiXCJOZXRsaWZ5IEVkZ2VcIjsgZndkPW1pc3MiLCJjb250ZW50LXR5cGUiOiJ0ZXh0L2phdmFzY3JpcHQiLCJkYXRlIjoiVGh1LCAxNyBKdWwgMjAyNSAxNjoyMTowOCBHTVQiLCJldGFnIjoiXCJhYWViZjQ1NjM5MDdmMDY2YTQwNDlhMWJjZTY0MDRhYS1zc2wtZGZcIiIsInNlcnZlciI6Ik5ldGxpZnkiLCJzdHJpY3QtdHJhbnNwb3J0LXNlY3VyaXR5IjoibWF4LWFnZT0zMTUzNjAwMDsgaW5jbHVkZVN1YkRvbWFpbnM7IHByZWxvYWQiLCJ2YXJ5IjoiQWNjZXB0LUVuY29kaW5nIiwieC1uZi1yZXF1ZXN0LWlkIjoiMDFLMENLMTIwMDJHMjVSSkNDOTE3NzBaQkgiLCJjb25uZWN0aW9uIjoiY2xvc2UiLCJ0cmFuc2Zlci1lbmNvZGluZyI6ImNodW5rZWQifSwiZGF0YSI6Ii8qKioqKiovIHZhciBzZWxmID0gc2VsZiB8fCB0aGlzIHx8IG5ldyBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCkgfHwgKHt9KTsgLy8gcmVwYWNrR2xvYmFsJ1xuLyoqKioqKi9cbnZhciB0cmF2ZWxzO1xuKGZ1bmN0aW9uKCkgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG52YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7XG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvQ29yZVBsdWdpbi5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvQ29yZVBsdWdpbi5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImRlZmF1bHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBfZGVmYXVsdDtcbiAgICB9XG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIFJlcGFja0NvcmVQbHVnaW4gPSAoKT0+KHtcbiAgICAgICAgbmFtZTogJ3JlcGFjay1jb3JlLXBsdWdpbicsXG4gICAgICAgIGxvYWRFbnRyeTogKHJlZik9PntcbiAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gcmVmLnJlbW90ZUluZm87XG4gICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2xpZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vU2NyaXB0TWFuYWdlci9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzXCIpO1xuICAgICAgICAgICAgICAgIHZhciBTY3JpcHRNYW5hZ2VyID0gY2xpZW50LlNjcmlwdE1hbmFnZXIsIGdldFdlYnBhY2tDb250ZXh0ID0gY2xpZW50LmdldFdlYnBhY2tDb250ZXh0O1xuICAgICAgICAgICAgICAgIHZhciBlbnRyeSA9IHJlbW90ZUluZm8uZW50cnksIGVudHJ5R2xvYmFsTmFtZSA9IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIFNjcmlwdE1hbmFnZXIuc2hhcmVkLmxvYWRTY3JpcHQoZW50cnlHbG9iYWxOYW1lLCB1bmRlZmluZWQsIGdldFdlYnBhY2tDb250ZXh0KCksIGVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBpZiAoIWdsb2JhbFRoaXNbZW50cnlHbG9iYWxOYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2xvYmFsVGhpc1tlbnRyeUdsb2JhbE5hbWVdO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGxvYWQgcmVtb3RlIGVudHJ5OiAke2VudHJ5R2xvYmFsTmFtZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSgpO1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZVByZWxvYWRBc3NldHM6ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIC8vIG5vb3AgZm9yIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgY3NzQXNzZXRzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAganNBc3NldHNXaXRob3V0RW50cnk6IFtdLFxuICAgICAgICAgICAgICAgICAgICBlbnRyeUFzc2V0czogW11cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pKClcbiAgICB9KTtcbnZhciBfZGVmYXVsdCA9IFJlcGFja0NvcmVQbHVnaW47XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvUmVzb2x2ZXJQbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL0ZlZGVyYXRpb25SdW50aW1lUGx1Z2lucy9SZXNvbHZlclBsdWdpbi5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX2RlZmF1bHQ7XG4gICAgfVxufSkpO1xudmFyIF9hc3luY190b19nZW5lcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fYXN5bmNfdG9fZ2VuZXJhdG9yICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiKTtcbnZhciBfb2JqZWN0X3NwcmVhZCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19vYmplY3Rfc3ByZWFkICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fb2JqZWN0X3NwcmVhZC5janNcIik7XG52YXIgY3JlYXRlU2NyaXB0TG9jYXRvciA9IChlbnRyeVVybCwgY29uZmlnKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHZhciBsb2NhdG9yID0geWllbGQgY29uZmlnKGVudHJ5VXJsKTtcbiAgICAgICAgICAgIHJldHVybiBsb2NhdG9yO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIF9vYmplY3Rfc3ByZWFkLl8oe1xuICAgICAgICAgICAgICAgIHVybDogZW50cnlVcmxcbiAgICAgICAgICAgIH0sIGNvbmZpZyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVybDogZW50cnlVcmxcbiAgICAgICAgfTtcbiAgICB9KSgpO1xudmFyIFJlcGFja1Jlc29sdmVyUGx1Z2luID0gKGNvbmZpZyk9Pih7XG4gICAgICAgIG5hbWU6ICdyZXBhY2stcmVzb2x2ZXItcGx1Z2luJyxcbiAgICAgICAgYWZ0ZXJSZXNvbHZlIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgU2NyaXB0TWFuYWdlciA9IChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvaW5kZXguanNcIikvKiAuU2NyaXB0TWFuYWdlciAqLy5TY3JpcHRNYW5hZ2VyKTtcbiAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gYXJncy5yZW1vdGVJbmZvO1xuICAgICAgICAgICAgU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoKHNjcmlwdElkLCBjYWxsZXIsIHJlZmVyZW5jZVVybCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVudHJ5IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NyaXB0SWQgPT09IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRvciA9IHlpZWxkIGNyZWF0ZVNjcmlwdExvY2F0b3IocmVtb3RlSW5mby5lbnRyeSwgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhdG9yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGVudHJ5IGNodW5rc1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVmZXJlbmNlVXJsICYmIGNhbGxlciA9PT0gcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwdWJsaWNQYXRoID0gcmVtb3RlSW5mby5lbnRyeS5zcGxpdCgnLycpLnNsaWNlKDAsIC0xKS5qb2luKCcvJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnVuZGxlUGF0aCA9IHNjcmlwdElkICsgcmVmZXJlbmNlVXJsLnNwbGl0KHNjcmlwdElkKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBwdWJsaWNQYXRoICsgJy8nICsgYnVuZGxlUGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdG9yMSA9IHlpZWxkIGNyZWF0ZVNjcmlwdExvY2F0b3IodXJsLCBjb25maWcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvY2F0b3IxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkoKSwge1xuICAgICAgICAgICAgICAgIGtleTogcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgICAgIH1cbiAgICB9KTtcbnZhciBfZGVmYXVsdCA9IFJlcGFja1Jlc29sdmVyUGx1Z2luO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJTY3JpcHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBTY3JpcHQ7XG4gICAgfVxufSkpO1xudmFyIF9jbGFzc19jYWxsX2NoZWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NsYXNzX2NhbGxfY2hlY2sgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqc1wiKTtcbnZhciBfY3JlYXRlX2NsYXNzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NyZWF0ZV9jbGFzcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janNcIik7XG52YXIgX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuY2pzXCIpO1xudmFyIF9zaGFsbG93ZXF1YWwgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIHNoYWxsb3dlcXVhbCAqLyBcIi4vbm9kZV9tb2R1bGVzL3NoYWxsb3dlcXVhbC9pbmRleC5qc1wiKSk7XG52YXIgX05hdGl2ZVNjcmlwdE1hbmFnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL05hdGl2ZVNjcmlwdE1hbmFnZXIuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzXCIpO1xudmFyIFNjcmlwdCA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgZnVuY3Rpb24gU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIGxvY2F0b3IsIHJlZikge1xuICAgICAgICB2YXIgY2FjaGUgPSByZWYgPT09IHZvaWQgMCA/IHRydWUgOiByZWY7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU2NyaXB0KTtcbiAgICAgICAgdGhpcy5zY3JpcHRJZCA9IHNjcmlwdElkO1xuICAgICAgICB0aGlzLmNhbGxlciA9IGNhbGxlcjtcbiAgICAgICAgdGhpcy5sb2NhdG9yID0gbG9jYXRvcjtcbiAgICAgICAgdGhpcy5jYWNoZSA9IGNhY2hlO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oU2NyaXB0LCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBDaGVjayBpZiB0aGUgc2NyaXB0IHdhcyBhbHJlYWR5IGNhY2hlZCBhbmQgY2FjaGUgc2hvdWxkIGJlIHVwZGF0ZWQgd2l0aCBuZXcgZGF0YS5cbiAgICpcbiAgICogQHBhcmFtIGNhY2hlZERhdGEgQ2FjaGVkIGRhdGEgZm9yIHRoZSBzYW1lIHNjcmlwdC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwic2hvdWxkVXBkYXRlQ2FjaGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzaG91bGRVcGRhdGVDYWNoZShjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhY2hlIHx8ICFjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkKGNhY2hlZERhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIHNjcmlwdCBzaG91bGQgYmUgZmV0Y2hlZCBhZ2FpbiBvciByZXVzZWQsXG4gICAqIGJhc2VkIG9uIHByZXZpb3VzIGNhY2hlZCBkYXRhLlxuICAgKlxuICAgKiBAcGFyYW0gY2FjaGVkRGF0YSBDYWNoZWQgZGF0YSBmb3IgdGhlIHNhbWUgc2NyaXB0LlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICovIGtleTogXCJzaG91bGRSZWZldGNoXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdWxkUmVmZXRjaChjYWNoZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhY2hlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jaGVja0lmQ2FjaGVEYXRhT3V0ZGF0ZWQoY2FjaGVkRGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBDaGVjayBpZiBwcmV2aW91cyBjYWNoZWQgZGF0YSBpcyB0aGUgc2FtZSBhcyB0aGUgbmV3IG9uZS5cbiAgICpcbiAgICogQHBhcmFtIGNhY2hlZERhdGEgQ2FjaGVkIGRhdGEgZm9yIHRoZSBzYW1lIHNjcmlwdC5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwiY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2hlY2tJZkNhY2hlRGF0YU91dGRhdGVkKGNhY2hlZERhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVkRGF0YS5tZXRob2QgIT09IHRoaXMubG9jYXRvci5tZXRob2QgfHwgY2FjaGVkRGF0YS51cmwgIT09IHRoaXMubG9jYXRvci51cmwgfHwgY2FjaGVkRGF0YS5xdWVyeSAhPT0gdGhpcy5sb2NhdG9yLnF1ZXJ5IHx8ICEoMCwgX3NoYWxsb3dlcXVhbC5kZWZhdWx0KShjYWNoZWREYXRhLmhlYWRlcnMsIHRoaXMubG9jYXRvci5oZWFkZXJzKSB8fCBjYWNoZWREYXRhLmJvZHkgIT09IHRoaXMubG9jYXRvci5ib2R5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvKipcbiAgICogR2V0IG9iamVjdCB0byBzdG9yZSBpbiBjYWNoZS5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqLyBrZXk6IFwiZ2V0Q2FjaGVEYXRhXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2FjaGVEYXRhKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogdGhpcy5sb2NhdG9yLm1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLmxvY2F0b3IudXJsLFxuICAgICAgICAgICAgICAgICAgICBxdWVyeTogdGhpcy5sb2NhdG9yLnF1ZXJ5LFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmxvY2F0b3IuaGVhZGVycyxcbiAgICAgICAgICAgICAgICAgICAgYm9keTogdGhpcy5sb2NhdG9yLmJvZHlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwidG9PYmplY3RcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b09iamVjdCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzY3JpcHRJZDogdGhpcy5zY3JpcHRJZCxcbiAgICAgICAgICAgICAgICAgICAgY2FsbGVyOiB0aGlzLmNhbGxlcixcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRvcjogdGhpcy5sb2NhdG9yLFxuICAgICAgICAgICAgICAgICAgICBjYWNoZTogdGhpcy5jYWNoZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXREZXZTZXJ2ZXJVUkxcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogR2V0IFVSTCBvZiBhIHNjcmlwdCBob3N0ZWQgb24gZGV2ZWxvcG1lbnQgc2VydmVyLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdC5cbiAgICovIGZ1bmN0aW9uIGdldERldlNlcnZlclVSTChzY3JpcHRJZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT5gJHt3ZWJwYWNrQ29udGV4dC5wfSR7d2VicGFja0NvbnRleHQudShzY3JpcHRJZCl9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldEZpbGVTeXN0ZW1VUkxcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogR2V0IFVSTCBvZiBhIHNjcmlwdCBzdG9yZWQgb24gZmlsZXN5c3RlbSBvbiB0aGUgdGFyZ2V0IG1vYmlsZSBkZXZpY2UuXG4gICAqXG4gICAqIEBwYXJhbSBzY3JpcHRJZCBJZCBvZiB0aGUgc2NyaXB0LlxuICAgKi8gZnVuY3Rpb24gZ2V0RmlsZVN5c3RlbVVSTChzY3JpcHRJZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT53ZWJwYWNrQ29udGV4dC51KGBmaWxlOi8vLyR7c2NyaXB0SWR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRSZW1vdGVVUkxcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogR2V0IFVSTCBvZiBhIHNjcmlwdCBob3N0ZWQgb24gYSByZW1vdGUgc2VydmVyLlxuICAgKlxuICAgKiBCeSBkZWZhdWx0IGAuY2h1bmsuYnVuZGxlYCBleHRlbnNpb24gd2lsbCBiZSBhZGRlZCB0byB0aGUgVVJMLlxuICAgKiBJZiB5b3VyIHNjcmlwdCBoYXMgZGlmZmVyZW50IGV4dGVuc2lvbiwgeW91IHNob3VsZCBwYXNzIGB7IGV4Y2x1ZGVFeHRlbnNpb246IHRydWUgfWAgYXMgMm5kIGFyZ3VtZW50LlxuICAgKlxuICAgKiBAcGFyYW0gdXJsIEEgVVJMIHRvIHJlbW90ZSBsb2NhdGlvbiB3aGVyZSB0aGUgc2NyaXB0IGlzIHN0b3JlZC5cbiAgICogQHBhcmFtIG9wdGlvbnMgQWRkaXRpb25hbCBvcHRpb25zLlxuICAgKi8gZnVuY3Rpb24gZ2V0UmVtb3RlVVJMKHVybCwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSByZWYgPT09IHZvaWQgMCA/IHt9IDogcmVmO1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmV4Y2x1ZGVFeHRlbnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICh3ZWJwYWNrQ29udGV4dCk9PndlYnBhY2tDb250ZXh0LnUodXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldFNjcmlwdFVuaXF1ZUlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIEdldCB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHNjcmlwdC5cbiAgICpcbiAgICogVXNlZCB0byBjcmVhdGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBzY3JpcHQsIHdoaWNoIHNlcnZlcyBhcyBpdHMga2V5IGluIHRoZSBjYWNoZS5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQuXG4gICAqIEBwYXJhbSBjYWxsZXIgT3B0aW9uYWwgY2FsbGVyIG5hbWUgdG8gcHJlZml4IHRoZSBzY3JpcHQgaWQuXG4gICAqLyBmdW5jdGlvbiBnZXRTY3JpcHRVbmlxdWVJZChzY3JpcHRJZCwgY2FsbGVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByZWZpeCA9IGNhbGxlciA/IGNhbGxlciArICdfJyA6ICcnO1xuICAgICAgICAgICAgICAgIHJldHVybiBwcmVmaXggKyBzY3JpcHRJZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImZyb21cIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogQ3JlYXRlIG5ldyBpbnN0YW5jZSBvZiBgU2NyaXB0YCBmcm9tIG5vbi1ub3JtYWxpemVkIHNjcmlwdCBsb2NhdG9yIGRhdGEuXG4gICAqXG4gICAqIEBwYXJhbSBsb2NhdG9yIE5vbi1ub3JtYWxpemVkIGxvY2F0b3IgZGF0YS5cbiAgICogQHBhcmFtIGZldGNoIEluaXRpYWwgZmxhZyBmb3Igd2hldGhlciBzY3JpcHQgc2hvdWxkIGJlIGZldGNoZWQgb3Igbm90LlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICovIGZ1bmN0aW9uIGZyb20oa2V5LCBsb2NhdG9yLCBmZXRjaCkge1xuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0ge307XG4gICAgICAgICAgICAgICAgbmV3IEhlYWRlcnMobG9jYXRvci5oZWFkZXJzKS5mb3JFYWNoKCh2YWx1ZSwga2V5KT0+e1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW2tleS50b0xvd2VyQ2FzZSgpXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciB1bmlxdWVJZCA9IFNjcmlwdC5nZXRTY3JpcHRVbmlxdWVJZChrZXkuc2NyaXB0SWQsIGtleS5jYWxsZXIpO1xuICAgICAgICAgICAgICAgIHZhciBib2R5O1xuICAgICAgICAgICAgICAgIGlmIChsb2NhdG9yLmJvZHkgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYm9keU9iamVjdCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBsb2NhdG9yLmJvZHkuZm9yRWFjaCgodmFsdWUsIGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keU9iamVjdFtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignU2NyaXB0IGRvZXMgbm90IHN1cHBvcnQgRmlsZSBhcyBGb3JtRGF0YSBrZXkgaW4gYm9keScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KGJvZHlPYmplY3QpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobG9jYXRvci5ib2R5IGluc3RhbmNlb2YgVVJMU2VhcmNoUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBib2R5T2JqZWN0MSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBsb2NhdG9yLmJvZHkuZm9yRWFjaCgodmFsdWUsIGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHlPYmplY3QxW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJvZHkgPSBKU09OLnN0cmluZ2lmeShib2R5T2JqZWN0MSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYm9keSA9IGxvY2F0b3IuYm9keSA/PyB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbG9jYXRvci51cmwgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQcm9wZXJ0eSB1cmwgYXMgYSBmdW5jdGlvbiBpcyBub3Qgc3VwcG9ydCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdChrZXkuc2NyaXB0SWQsIGtleS5jYWxsZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlSWQsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogbG9jYXRvci5tZXRob2QgPz8gX05hdGl2ZVNjcmlwdE1hbmFnZXIuTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kLkdFVCxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBsb2NhdG9yLnVybCxcbiAgICAgICAgICAgICAgICAgICAgYWJzb2x1dGU6IGxvY2F0b3IuYWJzb2x1dGUgPz8gZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IGxvY2F0b3IudGltZW91dCA/PyBTY3JpcHQuREVGQVVMVF9USU1FT1VULFxuICAgICAgICAgICAgICAgICAgICByZXRyeTogbG9jYXRvci5yZXRyeSxcbiAgICAgICAgICAgICAgICAgICAgcmV0cnlEZWxheTogbG9jYXRvci5yZXRyeURlbGF5LFxuICAgICAgICAgICAgICAgICAgICBxdWVyeTogbmV3IFVSTFNlYXJjaFBhcmFtcyhsb2NhdG9yLnF1ZXJ5KS50b1N0cmluZygpIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgYm9keSxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogT2JqZWN0LmtleXMoaGVhZGVycykubGVuZ3RoID8gaGVhZGVycyA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgZmV0Y2g6IGxvY2F0b3IuY2FjaGUgPT09IGZhbHNlID8gdHJ1ZSA6IGZldGNoLFxuICAgICAgICAgICAgICAgICAgICB2ZXJpZnlTY3JpcHRTaWduYXR1cmU6IGxvY2F0b3IudmVyaWZ5U2NyaXB0U2lnbmF0dXJlID8/IF9OYXRpdmVTY3JpcHRNYW5hZ2VyLk5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZS5PRkZcbiAgICAgICAgICAgICAgICB9LCBsb2NhdG9yLmNhY2hlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBTY3JpcHQ7XG59IC8vIyBzb3VyY2VNYXBwaW5nVVJMPVNjcmlwdC5qcy5tYXBcbigpO1xuU2NyaXB0LkRFRkFVTFRfVElNRU9VVCA9IDMwMDAwIC8vIDMwc1xuO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHRNYW5hZ2VyLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL1NjcmlwdE1hbmFnZXIuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbi8vIGJpb21lLWlnbm9yZSBsaW50L3N0eWxlL3VzZU5vZGVqc0ltcG9ydFByb3RvY29sOiB1c2UgJ2V2ZW50cycgbW9kdWxlIGluc3RlYWQgb2Ygbm9kZSBidWlsdGluXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIlNjcmlwdE1hbmFnZXJcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBTY3JpcHRNYW5hZ2VyO1xuICAgIH1cbn0pKTtcbnZhciBfYXN5bmNfdG9fZ2VuZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2FzeW5jX3RvX2dlbmVyYXRvciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FzeW5jX3RvX2dlbmVyYXRvci5janNcIik7XG52YXIgX2NhbGxfc3VwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fY2FsbF9zdXBlciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NhbGxfc3VwZXIuY2pzXCIpO1xudmFyIF9jbGFzc19jYWxsX2NoZWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NsYXNzX2NhbGxfY2hlY2sgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqc1wiKTtcbnZhciBfY3JlYXRlX2NsYXNzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NyZWF0ZV9jbGFzcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NyZWF0ZV9jbGFzcy5janNcIik7XG52YXIgX2luaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2luaGVyaXRzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW5oZXJpdHMuY2pzXCIpO1xudmFyIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiKTtcbnZhciBfc2xpY2VkX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3NsaWNlZF90b19hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janNcIik7XG52YXIgX3RvX2NvbnN1bWFibGVfYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fdG9fY29uc3VtYWJsZV9hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzXCIpO1xudmFyIF9ldmVudHMgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIGV2ZW50cyAqLyBcIi4vbm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanNcIikpO1xudmFyIF9OYXRpdmVTY3JpcHRNYW5hZ2VyID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL05hdGl2ZVNjcmlwdE1hbmFnZXIuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzXCIpKTtcbnZhciBfU2NyaXB0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9TY3JpcHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanNcIik7XG52YXIgX2dldFdlYnBhY2tDb250ZXh0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9nZXRXZWJwYWNrQ29udGV4dC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2dldFdlYnBhY2tDb250ZXh0LmpzXCIpO1xudmFyIERFRkFVTFRfUkVTT0xWRVJfUFJJT1JJVFkgPSAyO1xudmFyIERFRkFVTFRfUkVTT0xWRVJfS0VZID0gJ19fZGVmYXVsdF9fJztcbnZhciBDQUNIRV9OQU1FID0gJ1JlcGFjay5TY3JpcHRNYW5hZ2VyLkNhY2hlJztcbnZhciBDQUNIRV9WRVJTSU9OID0gJ3Y0JztcbnZhciBDQUNIRV9FTlYgPSAgdHJ1ZSA/ICdkZWJ1ZycgOiAwO1xudmFyIENBQ0hFX0tFWSA9IFtcbiAgICBDQUNIRV9OQU1FLFxuICAgIENBQ0hFX1ZFUlNJT04sXG4gICAgQ0FDSEVfRU5WXG5dLmpvaW4oJy4nKTtcbnZhciBMT0FESU5HX0VSUk9SX0NPREVTID0gW1xuICAgIC8vIGFuZHJvaWRcbiAgICAnTmV0d29ya0ZhaWx1cmUnLFxuICAgICdSZXF1ZXN0RmFpbHVyZScsXG4gICAgLy8gaW9zXG4gICAgJ1NjcmlwdERvd25sb2FkRmFpbHVyZSdcbl07XG52YXIgU2NyaXB0TWFuYWdlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oRXZlbnRFbWl0dGVyKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgX2luaGVyaXRzLl8oU2NyaXB0TWFuYWdlciwgRXZlbnRFbWl0dGVyKTtcbiAgICBmdW5jdGlvbiBTY3JpcHRNYW5hZ2VyKHJlZikge1xuICAgICAgICB2YXIgbmF0aXZlU2NyaXB0TWFuYWdlciA9IHJlZiA9PT0gdm9pZCAwID8gX05hdGl2ZVNjcmlwdE1hbmFnZXIuZGVmYXVsdCA6IHJlZjtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBTY3JpcHRNYW5hZ2VyKTtcbiAgICAgICAgdmFyIF90aGlzO1xuICAgICAgICBfdGhpcyA9IF9jYWxsX3N1cGVyLl8odGhpcywgU2NyaXB0TWFuYWdlciksIF90aGlzLmNhY2hlID0ge30sIF90aGlzLnNjcmlwdHNQcm9taXNlcyA9IHt9LCBfdGhpcy5jYWNoZUluaXRpYWxpemVkID0gZmFsc2UsIF90aGlzLnJlc29sdmVycyA9IFtdO1xuICAgICAgICBfdGhpcy5uYXRpdmVTY3JpcHRNYW5hZ2VyID0gbmF0aXZlU2NyaXB0TWFuYWdlcjtcbiAgICAgICAgaWYgKCFuYXRpdmVTY3JpcHRNYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3JlcGFjayByZWFjdC1uYXRpdmUgbW9kdWxlIHdhcyBub3QgZm91bmQuJyArICggdHJ1ZSA/ICcgRGlkIHlvdSBmb3JnZXQgdG8gdXBkYXRlIG5hdGl2ZSBkZXBlbmRlbmNpZXM/JyA6IDApKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2NyaXB0TWFuYWdlciB3YXMgYWxyZWFkeSBpbnN0YW50aWF0ZWQuIFVzZSBTY3JpcHRNYW5hZ2VyLnNoYXJlZCBpbnN0ZWFkLicpO1xuICAgICAgICB9XG4gICAgICAgIF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyID0gX3RoaXM7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFNjcmlwdE1hbmFnZXIsIFtcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIFNldHMgYSBzdG9yYWdlIGJhY2tlbmQgdG8gY2FjaGUgcmVzb2x2ZWQgc2NyaXB0cyBsb2NhdG9yIGRhdGEuXG4gICAqXG4gICAqIFRoZSBzdG9yZWQgZGF0YSBpcyB1c2VkIHRvIGRldGVjdCBpZiBzY3JpcHRzIGxvY2F0b3IgZGF0YSBvZiBwcmV2aW91c2x5IGRvd25sb2FkZWRcbiAgICogc2NyaXB0IGhhc24ndCBjaGFuZ2VkIHRvIGF2b2lkIG92ZXItZmV0Y2hpbmcgdGhlIHNjcmlwdC5cbiAgICpcbiAgICogQHBhcmFtIHN0b3JhZ2UgSW1wbGVtZW50YXRpb24gb2Ygc3RvcmFnZSBmdW5jdGlvbnMuXG4gICAqLyBrZXk6IFwic2V0U3RvcmFnZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFN0b3JhZ2Uoc3RvcmFnZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBBZGRzIG5ldyBzY3JpcHQgbG9jYXRvciByZXNvbHZlci5cbiAgICpcbiAgICogUmVzb2x2ZXIgaXMgYW4gYXN5bmMgZnVuY3Rpb24gdG8gcmVzb2x2ZSBzY3JpcHQgbG9jYXRvciBkYXRhIC0gaW4gb3RoZXIgd29yZHMsIGl0J3MgYSBmdW5jdGlvbiB0b1xuICAgKiB0ZWxsIHRoZSB7QGxpbmsgU2NyaXB0TWFuYWdlcn0gaG93IHRvIGZldGNoIHRoZSBzY3JpcHQuXG4gICAqXG4gICAqIFRoZXJlJ3Mgbm8gbGltaXRhdGlvbiBvbiB3aGF0IGxvZ2ljIHlvdSBjYW4gcnVuIGluc2lkZSB0aGlzIGZ1bmN0aW9uIC0gaXQgY2FuIGluY2x1ZGU6XG4gICAqIC0gZmV0Y2hpbmcvbG9hZGluZyByZW1vdGUgY29uZmlnXG4gICAqIC0gZmV0Y2hpbmcvbG9hZGluZyBmZWF0dXJlIGZsYWdzXG4gICAqIC0gZmV0Y2hpbmcvbG9hZGluZyBBL0IgdGVzdGluZyBkYXRhXG4gICAqIC0gY2FsbGluZyBuYXRpdmUgbW9kdWxlc1xuICAgKiAtIHJ1bm5pbmcgYXJiaXRyYXJ5IGxvZ2ljXG4gICAqXG4gICAqIEBwYXJhbSByZXNvbHZlciBSZXNvbHZlciBmdW5jdGlvbiB0byBhZGQuXG4gICAqIEBwYXJhbSBvcHRpb25zIFJlc29sdmVyIG9wdGlvbnMuXG4gICAqLyBrZXk6IFwiYWRkUmVzb2x2ZXJcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRSZXNvbHZlcihyZXNvbHZlciwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSByZWYgPT09IHZvaWQgMCA/IHt9IDogcmVmO1xuICAgICAgICAgICAgICAgIHZhciBwcmlvcml0eSA9IG9wdGlvbnMucHJpb3JpdHkgPz8gREVGQVVMVF9SRVNPTFZFUl9QUklPUklUWTtcbiAgICAgICAgICAgICAgICB2YXIgdW5pcXVlS2V5ID0gb3B0aW9ucy5rZXk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlcnMgPSB0aGlzLnJlc29sdmVycy5maWx0ZXIoKHJlZik9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAxKSwga2V5ID0gX3JlZlswXTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleSAhPT0gdW5pcXVlS2V5O1xuICAgICAgICAgICAgICAgIH0pLmNvbmNhdChbXG4gICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXF1ZUtleSA/PyBERUZBVUxUX1JFU09MVkVSX0tFWSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW9yaXR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZXJcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIF0pLnNvcnQoKHJlZiwgcmVmMSk9PntcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgYSA9IF9yZWZbMV0sIF9yZWYxID0gX3NsaWNlZF90b19hcnJheS5fKHJlZjEsIDIpLCBiID0gX3JlZjFbMV07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiIC0gYTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIFJlbW92ZXMgcHJldmlvdXNseSBhZGRlZCByZXNvbHZlci5cbiAgICpcbiAgICogQHBhcmFtIHJlc29sdmVyIFJlc29sdmVyIGZ1bmN0aW9uIG9yIHJlc29sdmVyJ3MgYHVuaXF1ZUtleWAgdG8gcmVtb3ZlLlxuICAgKiBAcmV0dXJucyBgdHJ1ZWAgaWYgcmVzb2x2ZXIgd2FzIGZvdW5kIGFuZCByZW1vdmVkLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICovIGtleTogXCJyZW1vdmVSZXNvbHZlclwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVJlc29sdmVyKHJlc29sdmVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4O1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzb2x2ZXIgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5yZXNvbHZlcnMuZmluZEluZGV4KChyZWYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDEpLCBrZXkgPSBfcmVmWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleSA9PT0gcmVzb2x2ZXI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5yZXNvbHZlcnMuZmluZEluZGV4KChyZWYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDMpLCBpdGVtID0gX3JlZlsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtID09PSByZXNvbHZlcjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBSZW1vdmVzIGFsbCBwcmV2aW91c2x5IGFkZGVkIHJlc29sdmVycy5cbiAgICovIGtleTogXCJyZW1vdmVBbGxSZXNvbHZlcnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVBbGxSZXNvbHZlcnMoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlcnMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImluaXRDYWNoZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRDYWNoZSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhY2hlSW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfdGhpc19zdG9yYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlRW50cnkgPSB5aWVsZCAoX3RoaXNfc3RvcmFnZSA9IHRoaXMuc3RvcmFnZSkgPT09IG51bGwgfHwgX3RoaXNfc3RvcmFnZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXNfc3RvcmFnZS5nZXRJdGVtKENBQ0hFX0tFWSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlID0gY2FjaGVFbnRyeSA/IEpTT04ucGFyc2UoY2FjaGVFbnRyeSkgOiB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic2F2ZUNhY2hlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2F2ZUNhY2hlKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXNfc3RvcmFnZTtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgKF90aGlzX3N0b3JhZ2UgPSB0aGlzLnN0b3JhZ2UpID09PSBudWxsIHx8IF90aGlzX3N0b3JhZ2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzX3N0b3JhZ2Uuc2V0SXRlbShDQUNIRV9LRVksIEpTT04uc3RyaW5naWZ5KHRoaXMuY2FjaGUpKTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaGFuZGxlRXJyb3JcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSwgLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5lcnJvci5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlXG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSwgW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEVycm9yOiBlcnJvclxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXSkpO1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgIGFyZ3MsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsRXJyb3I6IGVycm9yXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZXNvbHZlU2NyaXB0XCIsXG4gICAgICAgICAgICB2YWx1ZTogLyoqXG4gICAqIFJlc29sdmVzIGEge0BsaW5rIFNjcmlwdH0gaW5zdGFuY2Ugd2l0aCBub3JtYWxpemVkIGxvY2F0b3IgZGF0YS5cbiAgICpcbiAgICogUmVzb2x1dGlvbiB3aWxsIHVzZSBwcmV2aW91c2x5IGFkZGVkICh2aWEgYFNjcmlwdE1hbmFnZXIuc2hhcmVkLmFkZFJlc29sdmVyKC4uLilgKSByZXNvbHZlcnNcbiAgICogaW4gc2VyaWVzLCB1dGlsIG9uZSByZXR1cm5zIGEgbG9jYXRvciBkYXRhIG9yIHdpbGwgdGhyb3cgaWYgbm8gcmVzb2x2ZXIgaGFuZGxlZCB0aGUgcmVxdWVzdC5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbigncmVzb2x2aW5nJywgKHsgc2NyaXB0SWQsIGNhbGxlciB9KSA9PiB7IH0pYCB0byBsaXN0ZW4gZm9yIHdoZW5cbiAgICogdGhlIHNjcmlwdCByZXNvbHV0aW9uIGJlZ2lucy5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbigncmVzb2x2ZWQnLCAoc2NyaXB0KSA9PiB7IH0pYCB0byBsaXN0ZW4gZm9yIHdoZW5cbiAgICogdGhlIHNjcmlwdCdzIGxvY2F0b3IgZGF0YSBpcyByZXNvbHZlZC5cbiAgICpcbiAgICogQHBhcmFtIHNjcmlwdElkIElkIG9mIHRoZSBzY3JpcHQgdG8gcmVzb2x2ZS5cbiAgICogQHBhcmFtIGNhbGxlciBOYW1lIG9mIHRoZSBjYWxsaW5nIHNjcmlwdCAtIGl0IGNhbiBiZSBmb3IgZXhhbXBsZTogbmFtZSBvZiB0aGUgYnVuZGxlLCBjaHVuayBvciBjb250YWluZXIuXG4gICAqLyBmdW5jdGlvbiByZXNvbHZlU2NyaXB0KF8wLCBfMSwgXzIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihzY3JpcHRJZCwgY2FsbGVyLCByZWYsIHJlZmVyZW5jZVVybCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgd2VicGFja0NvbnRleHQgPSByZWYgPT09IHZvaWQgMCA/ICgwLCBfZ2V0V2VicGFja0NvbnRleHQuZ2V0V2VicGFja0NvbnRleHQpKCkgOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaW5pdENhY2hlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmVzb2x2ZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc2NyaXB0IHJlc29sdmVycyB3ZXJlIGFkZGVkLiBEaWQgeW91IGZvcmdldCB0byBjYWxsIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlciguLi4pYD8nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgncmVzb2x2aW5nJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF8kcmVmIG9mIHRoaXMucmVzb2x2ZXJzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhfJHJlZiwgMyksIHJlc29sdmUgPSBfcmVmWzJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0b3IgPSB5aWVsZCByZXNvbHZlKHNjcmlwdElkLCBjYWxsZXIsIHJlZmVyZW5jZVVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsb2NhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyByZXNvbHZlciB3YXMgYWJsZSB0byByZXNvbHZlIHNjcmlwdCAke3NjcmlwdElkfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBsb2NhdG9yLnVybCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0b3IudXJsID0gbG9jYXRvci51cmwod2VicGFja0NvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdCA9IF9TY3JpcHQuU2NyaXB0LmZyb20oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgbG9jYXRvciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gc2NyaXB0LmxvY2F0b3IudW5pcXVlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB1c2VyIHByb3ZpZGVkIGEgY3VzdG9tIHNob3VsZFVwZGF0ZVNjcmlwdCBmdW5jdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0b3Iuc2hvdWxkVXBkYXRlU2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgc28sIHdlIG5lZWQgdG8gd2FpdCBmb3IgaXQgdG8gcmVzb2x2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmZXRjaCA9IHlpZWxkIGxvY2F0b3Iuc2hvdWxkVXBkYXRlU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIHNjcmlwdC5zaG91bGRVcGRhdGVDYWNoZSh0aGlzLmNhY2hlW2NhY2hlS2V5XSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGl0IHJldHVybnMgdHJ1ZSwgd2UgbmVlZCB0byBmZXRjaCB0aGUgc2NyaXB0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZldGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdC5sb2NhdG9yLmZldGNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdyZXNvbHZlZCcsIHNjcmlwdC50b09iamVjdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCByZXR1cm5zIGZhbHNlLCB3ZSBkb24ndCBuZWVkIHRvIGZldGNoIHRoZSBzY3JpcHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NyaXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgbm8gY3VzdG9tIHNob3VsZFVwZGF0ZVNjcmlwdCBmdW5jdGlvbiB3YXMgcHJvdmlkZWQsIHdlIHVzZSB0aGUgZGVmYXVsdCBiZWhhdmlvdXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZVtjYWNoZUtleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHQubG9jYXRvci5mZXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNjcmlwdC5zaG91bGRSZWZldGNoKHRoaXMuY2FjaGVbY2FjaGVLZXldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdC5sb2NhdG9yLmZldGNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgncmVzb2x2ZWQnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NyaXB0O1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1tTY3JpcHRNYW5hZ2VyXSBGYWlsZWQgd2hpbGUgcmVzb2x2aW5nIHNjcmlwdCBsb2NhdG9yOicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInVwZGF0ZUNhY2hlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQ2FjaGUoc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY3JpcHQubG9jYXRvci5mZXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gc2NyaXB0LmxvY2F0b3IudW5pcXVlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlW2NhY2hlS2V5XSA9IHNjcmlwdC5nZXRDYWNoZURhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2F2ZUNhY2hlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFNjcmlwdFwiLFxuICAgICAgICAgICAgdmFsdWU6IC8qKlxuICAgKiBSZXNvbHZlcyBnaXZlbiBzY3JpcHQncyBsb2NhdGlvbiwgZG93bmxvYWRzIGFuZCBleGVjdXRlcyBpdC5cbiAgICogVGhlIGV4ZWN1dGlvbiBvZiB0aGUgY29kZSBpcyBoYW5kbGVkIGludGVybmFsbHkgYnkgdGhyZWFkaW5nIGluIFJlYWN0IE5hdGl2ZS5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbignbG9hZGluZycsIChzY3JpcHQpID0+IHsgfSlgIHRvIGxpc3RlbiBmb3Igd2hlblxuICAgKiB0aGUgc2NyaXB0IGlzIGFib3V0IHRvIGJlIGxvYWRlZC5cbiAgICpcbiAgICogVXNlIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5vbignbG9hZGVkJywgKHNjcmlwdCkgPT4geyB9KWAgdG8gbGlzdGVuIGZvciB3aGVuXG4gICAqIHRoZSBzY3JpcHQgaXMgbG9hZGVkLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdCB0byBsb2FkLlxuICAgKiBAcGFyYW0gY2FsbGVyIE5hbWUgb2YgdGhlIGNhbGxpbmcgc2NyaXB0IC0gaXQgY2FuIGJlIGZvciBleGFtcGxlOiBuYW1lIG9mIHRoZSBidW5kbGUsIGNodW5rIG9yIGNvbnRhaW5lci5cbiAgICovIGZ1bmN0aW9uIGxvYWRTY3JpcHQoXzAsIF8xLCBfMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKHNjcmlwdElkLCBjYWxsZXIsIHJlZiwgcmVmZXJlbmNlVXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB3ZWJwYWNrQ29udGV4dCA9IHJlZiA9PT0gdm9pZCAwID8gKDAsIF9nZXRXZWJwYWNrQ29udGV4dC5nZXRXZWJwYWNrQ29udGV4dCkoKSA6IHJlZjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVuaXF1ZUlkID0gX1NjcmlwdC5TY3JpcHQuZ2V0U2NyaXB0VW5pcXVlSWQoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1ByZWZldGNoID0gdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdLmlzUHJlZmV0Y2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmVmZXRjaCBpcyBub3QgZXhlY3V0ZSB0aGUgc2NyaXB0IHNvIHdlIG5lZWQgdG8gcnVuIGxvYWRTY3JpcHQgaWYgcHJvbWlzZSBpcyBmb3IgcHJlZmV0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1ByZWZldGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkUHJvY2VzcyA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzY3JpcHQgPSB5aWVsZCB0aGlzLnJlc29sdmVTY3JpcHQoc2NyaXB0SWQsIGNhbGxlciwgd2VicGFja0NvbnRleHQsIHJlZmVyZW5jZVVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdsb2FkaW5nJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmxvYWRTY3JpcHRXaXRoUmV0cnkoc2NyaXB0SWQsIHNjcmlwdC5sb2NhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdsb2FkZWQnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMudXBkYXRlQ2FjaGUoc2NyaXB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29kZSA9IGVycm9yLmNvZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdbU2NyaXB0TWFuYWdlcl0gRmFpbGVkIHRvIGxvYWQgc2NyaXB0OicsIGNvZGUgPyBgWyR7Y29kZX1dYCA6ICcnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgZGVsZXRlIHNjcmlwdCBwcm9taXNlIGV2ZW4gc2NyaXB0IGZhaWxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXSA9IGxvYWRQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcmlwdHNQcm9taXNlc1t1bmlxdWVJZF07XG4gICAgICAgICAgICAgICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTY3JpcHRXaXRoUmV0cnlcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogTG9hZHMgYSBzY3JpcHQgd2l0aCByZXRyeSBsb2dpYy5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbiBhdHRlbXB0cyB0byBsb2FkIGEgc2NyaXB0IHVzaW5nIHRoZSBuYXRpdmVTY3JpcHRNYW5hZ2VyLlxuICAgKiBJZiB0aGUgaW5pdGlhbCBhdHRlbXB0IGZhaWxzLCBpdCByZXRyaWVzIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzXG4gICAqIHdpdGggYW4gb3B0aW9uYWwgZGVsYXkgYmV0d2VlbiByZXRyaWVzLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2NyaXB0SWQgLSBUaGUgSUQgb2YgdGhlIHNjcmlwdCB0byBsb2FkLlxuICAgKiBAcGFyYW0ge05vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yfSBsb2NhdG9yIC0gQW4gTm9ybWFsaXplZFNjcmlwdExvY2F0b3IgY29udGFpbmluZyByZXRyeSBjb25maWd1cmF0aW9uLlxuICAgKiBAcGFyYW0ge251bWJlcn0gW2xvY2F0b3IucmV0cnk9MF0gLSBUaGUgbnVtYmVyIG9mIHJldHJ5IGF0dGVtcHRzLlxuICAgKiBAcGFyYW0ge251bWJlcn0gW2xvY2F0b3IucmV0cnlEZWxheT0wXSAtIFRoZSBkZWxheSBpbiBtaWxsaXNlY29uZHMgYmV0d2VlbiByZXRyaWVzLlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhyb3dzIGFuIGVycm9yIGlmIGFsbCByZXRyeSBhdHRlbXB0cyBmYWlsLlxuICAgKi8gZnVuY3Rpb24gbG9hZFNjcmlwdFdpdGhSZXRyeShzY3JpcHRJZCwgbG9jYXRvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2xvY2F0b3JfcmV0cnkgPSBsb2NhdG9yLnJldHJ5LCByZXRyeSA9IF9sb2NhdG9yX3JldHJ5ID09PSB2b2lkIDAgPyAwIDogX2xvY2F0b3JfcmV0cnksIF9sb2NhdG9yX3JldHJ5RGVsYXkgPSBsb2NhdG9yLnJldHJ5RGVsYXksIHJldHJ5RGVsYXkgPSBfbG9jYXRvcl9yZXRyeURlbGF5ID09PSB2b2lkIDAgPyAwIDogX2xvY2F0b3JfcmV0cnlEZWxheTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0dGVtcHRzID0gcmV0cnkgKyAxOyAvLyBJbmNsdWRlIHRoZSBpbml0aWFsIGF0dGVtcHRcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUoYXR0ZW1wdHMgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5uYXRpdmVTY3JpcHRNYW5hZ2VyLmxvYWRTY3JpcHQoc2NyaXB0SWQsIGxvY2F0b3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gU3VjY2Vzc2Z1bGx5IGxvYWRlZCB0aGUgc2NyaXB0LCBleGl0IHRoZSBsb29wXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGVtcHRzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBlcnJvci5jb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRlbXB0cyA+IDAgJiYgTE9BRElOR19FUlJPUl9DT0RFUy5pbmNsdWRlcyhjb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0cnlEZWxheSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKT0+c2V0VGltZW91dChyZXNvbHZlLCByZXRyeURlbGF5KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjsgLy8gTm8gbW9yZSByZXRyaWVzLCB0aHJvdyB0aGUgZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicHJlZmV0Y2hTY3JpcHRcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogUmVzb2x2ZXMgZ2l2ZW4gc2NyaXB0J3MgbG9jYXRpb24gYW5kIGRvd25sb2FkcyBpdCB3aXRob3V0IGV4ZWN1dGluZy5cbiAgICogVGhpcyBmdW5jdGlvbiBjYW4gYmUgYXdhaXRlZCB0byBkZXRlY3QgaWYgdGhlIHNjcmlwdCB3YXMgZG93bmxvYWRlZCBhbmQgZm9yIGVycm9yIGhhbmRsaW5nLlxuICAgKlxuICAgKiBVc2UgYFNjcmlwdE1hbmFnZXIuc2hhcmVkLm9uKCdwcmVmZXRjaGluZycsIChzY3JpcHQpID0+IHsgfSlgIHRvIGxpc3RlbiBmb3Igd2hlblxuICAgKiB0aGUgc2NyaXB0J3MgcHJlZmV0Y2ggYmVpbmdzLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWQgSWQgb2YgdGhlIHNjcmlwdCB0byBwcmVmZXRjaC5cbiAgICogQHBhcmFtIGNhbGxlciBOYW1lIG9mIHRoZSBjYWxsaW5nIHNjcmlwdCAtIGl0IGNhbiBiZSBmb3IgZXhhbXBsZTogbmFtZSBvZiB0aGUgYnVuZGxlLCBjaHVuayBvciBjb250YWluZXIuXG4gICAqLyBmdW5jdGlvbiBwcmVmZXRjaFNjcmlwdChfMCwgXzEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihzY3JpcHRJZCwgY2FsbGVyLCByZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdlYnBhY2tDb250ZXh0ID0gcmVmID09PSB2b2lkIDAgPyAoMCwgX2dldFdlYnBhY2tDb250ZXh0LmdldFdlYnBhY2tDb250ZXh0KSgpIDogcmVmO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdW5pcXVlSWQgPSBfU2NyaXB0LlNjcmlwdC5nZXRTY3JpcHRVbmlxdWVJZChzY3JpcHRJZCwgY2FsbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFByb2Nlc3MgPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2NyaXB0ID0geWllbGQgdGhpcy5yZXNvbHZlU2NyaXB0KHNjcmlwdElkLCBjYWxsZXIsIHdlYnBhY2tDb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ3ByZWZldGNoaW5nJywgc2NyaXB0LnRvT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLm5hdGl2ZVNjcmlwdE1hbmFnZXIucHJlZmV0Y2hTY3JpcHQoc2NyaXB0SWQsIHNjcmlwdC5sb2NhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy51cGRhdGVDYWNoZShzY3JpcHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZXJyb3IuY29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1tTY3JpcHRNYW5hZ2VyXSBGYWlsZWQgdG8gcHJlZmV0Y2ggc2NyaXB0OicsIGNvZGUgPyBgWyR7Y29kZX1dYCA6ICcnLCBzY3JpcHQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgZGVsZXRlIHNjcmlwdCBwcm9taXNlIGV2ZW4gc2NyaXB0IGZhaWxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5zY3JpcHRzUHJvbWlzZXNbdW5pcXVlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXSA9IGxvYWRQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXS5pc1ByZWZldGNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyaXB0c1Byb21pc2VzW3VuaXF1ZUlkXTtcbiAgICAgICAgICAgICAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW52YWxpZGF0ZVNjcmlwdHNcIixcbiAgICAgICAgICAgIHZhbHVlOiAvKipcbiAgICogQ2xlYXJzIHRoZSBjYWNoZSAoaWYgY29uZmlndXJlZCBpbiB7QGxpbmsgU2NyaXB0TWFuYWdlci5zZXRTdG9yYWdlfSkgYW5kIHJlbW92ZXMgZG93bmxvYWRlZFxuICAgKiBmaWxlcyBmb3IgZ2l2ZW4gc2NyaXB0cyBmcm9tIHRoZSBmaWxlc3lzdGVtLiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBhd2FpdGVkIHRvIGRldGVjdCBpZiB0aGVcbiAgICogc2NyaXB0cyB3ZXJlIGludmFsaWRhdGVkIGFuZCBmb3IgZXJyb3IgaGFuZGxpbmcuXG4gICAqXG4gICAqIFVzZSBgU2NyaXB0TWFuYWdlci5zaGFyZWQub24oJ2ludmFsaWRhdGVkJywgKHNjcmlwdElkcykgPT4geyB9KWAgdG8gbGlzdGVuIGZvciB3aGVuXG4gICAqIHRoZSBpbnZhbGlkYXRpb24gY29tcGxldGVzLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0SWRzIEFycmF5IG9mIHNjcmlwdCBpZHMgdG8gY2xlYXIgZnJvbSBjYWNoZSBhbmQgcmVtb3ZlIGZyb20gZmlsZXN5c3RlbS5cbiAgICogQHJldHVybnMgQXJyYXkgb2Ygc2NyaXB0IGlkcyB0aGF0IHdlcmUgaW52YWxpZGF0ZWQuXG4gICAqLyBmdW5jdGlvbiBpbnZhbGlkYXRlU2NyaXB0cygpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdElkcyA9IHJlZiA9PT0gdm9pZCAwID8gW10gOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmluaXRDYWNoZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkcyA9IHNjcmlwdElkcy5sZW5ndGggPyBzY3JpcHRJZHMgOiBPYmplY3Qua2V5cyh0aGlzLmNhY2hlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkcy5mb3JFYWNoKChzY3JpcHRJZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5jYWNoZVtzY3JpcHRJZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2NyaXB0c1Byb21pc2VzW3NjcmlwdElkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zYXZlQ2FjaGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMubmF0aXZlU2NyaXB0TWFuYWdlci5pbnZhbGlkYXRlU2NyaXB0cyhzY3JpcHRJZHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdpbnZhbGlkYXRlZCcsIGlkcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaWRzO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBlcnJvci5jb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1tTY3JpcHRNYW5hZ2VyXSBGYWlsZWQgdG8gaW52YWxpZGF0ZSBzY3JpcHRzOicsIGNvZGUgPyBgWyR7Y29kZX1dYCA6ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qKlxuICAgKiBFdmFsdWF0ZXMgYSBzY3JpcHQgc3luY2hyb25vdXNseS5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbiBzZW5kcyB0aGUgc2NyaXB0IHNvdXJjZSBhbmQgaXRzIFVSTCB0byB0aGUgbmF0aXZlIHNjcmlwdCBtYW5hZ2VyIGZvciBldmFsdWF0aW9uLlxuICAgKiBJdCBpcyBmdW5jdGlvbmFsbHkgaWRlbnRpY2FsIHRvIGBnbG9iYWxFdmFsV2l0aFNvdXJjZVVybGAuXG4gICAqXG4gICAqIEBwYXJhbSBzY3JpcHRTb3VyY2UgVGhlIHNvdXJjZSBjb2RlIG9mIHRoZSBzY3JpcHQgdG8gZXZhbHVhdGUuXG4gICAqIEBwYXJhbSBzY3JpcHRTb3VyY2VVcmwgVGhlIFVSTCBvZiB0aGUgc2NyaXB0IHNvdXJjZSwgdXNlZCBmb3IgZGVidWdnaW5nIHB1cnBvc2VzLlxuICAgKi8ga2V5OiBcInVuc3RhYmxlX2V2YWx1YXRlU2NyaXB0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdGFibGVfZXZhbHVhdGVTY3JpcHQoc2NyaXB0U291cmNlLCBzY3JpcHRTb3VyY2VVcmwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVNjcmlwdE1hbmFnZXIudW5zdGFibGVfZXZhbHVhdGVTY3JpcHQoc2NyaXB0U291cmNlLCBzY3JpcHRTb3VyY2VVcmwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlcikge1xuICAgICAgICAgICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlciA9IG5ldyBTY3JpcHRNYW5hZ2VyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic2hhcmVkXCIsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBTY3JpcHRNYW5hZ2VyO1xufSAvLyMgc291cmNlTWFwcGluZ1VSTD1TY3JpcHRNYW5hZ2VyLmpzLm1hcFxuKF9ldmVudHMuZGVmYXVsdCk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2ZlZGVyYXRlZC5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2ZlZGVyYXRlZC5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIkZlZGVyYXRlZFwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIEZlZGVyYXRlZDtcbiAgICB9XG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIF9TY3JpcHRNYW5hZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9TY3JpcHRNYW5hZ2VyLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvU2NyaXB0TWFuYWdlci5qc1wiKTtcbnZhciBGZWRlcmF0ZWQ7XG4oZnVuY3Rpb24oX0ZlZGVyYXRlZCkge1xuICAgIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKlxuICAgKiBSZXNvbHZlcyBVUkwgdG8gYSBjb250YWluZXIgb3IgYSBjaHVuayB3aGVuIHVzaW5nIE1vZHVsZSBGZWRlcmF0aW9uLFxuICAgKiBiYXNlZCBvbiBnaXZlbiBgc2NyaXB0SWRgIGFuZCBgY2FsbGVyYC5cbiAgICovIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKlxuICAgKiBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHtAbGluayBjcmVhdGVVUkxSZXNvbHZlcn0gZm9yIE1vZHVsZSBGZWRlcmF0aW9uLlxuICAgKiBBbGxvd3MgdG8gY29uZmlndXJlIGhvdyBjcmVhdGVkIHtAbGluayBVUkxSZXNvbHZlcn0gd2lsbCBiZWhhdmUuXG4gICAqLyAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICpcbiAgICogQ3JlYXRlcyBVUkwgcmVzb2x2ZXIgZm9yIE1vZHVsZSBGZWRlcmF0aW9uIGZyb20gcHJvdmlkZWQgY29uZmlnLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgeyBTY3JpcHRNYW5hZ2VyLCBTY3JpcHQsIEZlZGVyYXRlZCB9IGZyb20gJ0BjYWxsc3RhY2svcmVwYWNrL2NsaWVudCc7XG4gICAqXG4gICAqIGNvbnN0IHJlc29sdmVVUkwgPSBGZWRlcmF0ZWQuY3JlYXRlVVJMUmVzb2x2ZXIoe1xuICAgKiAgIGNvbnRhaW5lcnM6IHtcbiAgICogICAgIGFwcDE6ICdodHRwOi8vbG9jYWxob3N0OjkwMDEvW25hbWVdW2V4dF0nLFxuICAgKiAgICAgYXBwMjogJ2h0dHA6Ly9sb2NhbGhvc3Q6OTAwMi9bbmFtZV0uY29udGFpbmVyLmpzJyxcbiAgICogICB9LFxuICAgKiAgIGNodW5rczoge1xuICAgKiAgICAgYXBwMjogJ2h0dHA6Ly9sb2NhbGhvc3Q6OTAwMi9jaHVua3MvW25hbWVdW2V4dF0nLFxuICAgKiAgIH0sXG4gICAqIH0pO1xuICAgKlxuICAgKiBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlcihhc3luYyAoc2NyaXB0SWQsIGNhbGxlcikgPT4ge1xuICAgKiAgIGxldCB1cmw7XG4gICAqICAgaWYgKGNhbGxlciA9PT0gJ21haW4nKSB7XG4gICAqICAgICB1cmwgPSBfX0RFVl9fXG4gICAqICAgICAgID8gU2NyaXB0LmdldERldlNlcnZlclVSTChzY3JpcHRJZClcbiAgICogICAgICAgOiBTY3JpcHQuZ2V0UmVtb3RlVVJMKGBodHRwOi8vbG9jYWxob3N0OjkwMDAvJHtzY3JpcHRJZH1gKTtcbiAgICogICB9IGVsc2Uge1xuICAgKiAgICAgdXJsID0gcmVzb2x2ZVVSTChzY3JpcHRJZCwgY2FsbGVyKTtcbiAgICogICB9XG4gICAqXG4gICAqICAgaWYgKCF1cmwpIHtcbiAgICogICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAqICAgfVxuICAgKlxuICAgKiAgIHJldHVybiB7XG4gICAqICAgICB1cmwsXG4gICAqICAgICBxdWVyeToge1xuICAgKiAgICAgICBwbGF0Zm9ybTogUGxhdGZvcm0uT1MsXG4gICAqICAgICB9LFxuICAgKiAgIH07XG4gICAqIH0pO1xuICAgKiBgYGBcbiAgICpcbiAgICogYGNyZWF0ZVVSTFJlc29sdmVyYCBpcyBhIGFic3RyYWN0aW9uIG92ZXIge0BsaW5rIFNjcmlwdC5nZXRSZW1vdGVVUkx9LFxuICAgKiBmb3IgZXhhbXBsZTpcbiAgICogYGBgdHNcbiAgICogaW1wb3J0IHsgU2NyaXB0TWFuYWdlciwgRmVkZXJhdGVkIH0gZnJvbSAnQGNhbGxzdGFjay9yZXBhY2svY2xpZW50JztcbiAgICpcbiAgICogU2NyaXB0TWFuYWdlci5zaGFyZWQuYWRkUmVzb2x2ZXIoKHNjcmlwdElkLCBjYWxsZXIpID0+IHtcbiAgICogICBjb25zdCByZXNvbHZlVVJMID0gRmVkZXJhdGVkLmNyZWF0ZVVSTFJlc29sdmVyKHtcbiAgICogICAgIGNvbnRhaW5lcnM6IHtcbiAgICogICAgICAgYXBwMTogJ2h0dHA6Ly9sb2NhbGhvc3Q6OTAwMC9bbmFtZV1bZXh0XScsXG4gICAqICAgICB9LFxuICAgKiAgIH0pO1xuICAgKlxuICAgKiAgIHJldHVybiB7XG4gICAqICAgICB1cmw6IHJlc29sdmVVUkwoc2NyaXB0SWQsIGNhbGxlcik7XG4gICAqICAgfTtcbiAgICogfSk7XG4gICAqIGBgYFxuICAgKiBpcyBlcXVpdmFsZW50IHRvOlxuICAgKiBgYGB0c1xuICAgKiBpbXBvcnQgeyBTY3JpcHRNYW5hZ2VyLCBTY3JpcHQgfSBmcm9tICdAY2FsbHN0YWNrL3JlcGFjay9jbGllbnQnO1xuICAgKlxuICAgKiBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5hZGRSZXNvbHZlcihhc3luYyAoc2NyaXB0SWQsIGNhbGxlcikgPT4ge1xuICAgKiAgIGlmIChzY3JpcHRJZCA9PT0gJ2FwcDEnKSB7XG4gICAqICAgICByZXR1cm4ge1xuICAgKiAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjkwMDAvYXBwMS5jb250YWluZXIuYnVuZGxlJyxcbiAgICogICAgIH07XG4gICAqICAgfVxuICAgKlxuICAgKiAgIGlmIChjYWxsZXIgPT09ICdhcHAxJykge1xuICAgKiAgICAgcmV0dXJuIHtcbiAgICogICAgICAgdXJsOiBTY3JpcHQuZ2V0UmVtb3RlVVJMKGBodHRwOi8vbG9jYWxob3N0OjkwMDAvJHtzY3JpcHRJZH1gKSxcbiAgICogICAgIH07XG4gICAqICAgfVxuICAgKiB9KTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSBjb25maWcgQ29uZmlndXJhdGlvbiBmb3IgdGhlIHJlc29sdmVyLlxuICAgKiBAcGFyYW0gY29udGFpbmVyRXh0IEV4dGVuc2lvbiBvZiBjb250YWluZXIgYnVuZGxlcy4gRGVmYXVsdHMgdG8gYC5jb250YWluZXIuYnVuZGxlYC5cbiAgICogQHJldHVybnMgQSByZXNvbHZlciBmdW5jdGlvbiB3aGljaCB3aWxsIHRyeSB0byByZXNvbHZlIFVSTCBiYXNlZCBvbiBnaXZlbiBgc2NyaXB0SWRgIGFuZCBgY2FsbGVyYC5cbiAgICovIGZ1bmN0aW9uIGNyZWF0ZVVSTFJlc29sdmVyKGNvbmZpZywgcmVmKSB7XG4gICAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgcmVzb2x2ZXJzW2tleV0gPSAoc2NyaXB0SWQsIGNhbGxlcik9PntcbiAgICAgICAgICAgICAgICBpZiAoc2NyaXB0SWQgPT09IGtleSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gY29uZmlnLmNvbnRhaW5lcnNba2V5XS5yZXBsYWNlKC9cXFtuYW1lXFxdL2csIHNjcmlwdElkKS5yZXBsYWNlKC9cXFtleHRcXF0vZywgY29udGFpbmVyRXh0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxlciA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY29uZmlnX2NodW5rcztcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybDEgPSAoKChfY29uZmlnX2NodW5rcyA9IGNvbmZpZy5jaHVua3MpID09PSBudWxsIHx8IF9jb25maWdfY2h1bmtzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY29uZmlnX2NodW5rc1trZXldKSA/PyBjb25maWcuY29udGFpbmVyc1trZXldKS5yZXBsYWNlKC9cXFtuYW1lXFxdL2csIHNjcmlwdElkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVybDEuaW5jbHVkZXMoJ1tleHRdJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAod2VicGFja0NvbnRleHQpPT53ZWJwYWNrQ29udGV4dC51KHVybDEucmVwbGFjZSgvXFxbZXh0XFxdL2csICcnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICB2YXIgY29udGFpbmVyRXh0ID0gcmVmID09PSB2b2lkIDAgPyAnLmNvbnRhaW5lci5idW5kbGUnIDogcmVmO1xuICAgICAgICB2YXIgcmVzb2x2ZXJzID0ge307XG4gICAgICAgIGZvcih2YXIga2V5IGluIGNvbmZpZy5jb250YWluZXJzKV9sb29wKGtleSk7XG4gICAgICAgIHJldHVybiAoc2NyaXB0SWQsIGNhbGxlcik9PntcbiAgICAgICAgICAgIHZhciByZXNvbHZlciA9IChjYWxsZXIgPyByZXNvbHZlcnNbY2FsbGVyXSA6IHVuZGVmaW5lZCkgPz8gcmVzb2x2ZXJzW3NjcmlwdElkXTtcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlcihzY3JpcHRJZCwgY2FsbGVyKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgX0ZlZGVyYXRlZC5jcmVhdGVVUkxSZXNvbHZlciA9IGNyZWF0ZVVSTFJlc29sdmVyO1xuICAgIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKlxuICAgKiBEeW5hbWljYWxseSBpbXBvcnRzIG1vZHVsZSBmcm9tIGEgTW9kdWxlIEZlZGVyYXRpb24gY29udGFpbmVyLiBTaW1pbGFyIHRvIGBpbXBvcnQoJ2ZpbGUnKWAsIGJ1dFxuICAgKiBzcGVjaWZpYyB0byBNb2R1bGUgRmVkZXJhdGlvbi4gQ2FsbGluZyBgaW1wb3J0TW9kdWxlYCB3aWxsIGNyZWF0ZSBhbiBhc3luYyBib3VuZGFyeS5cbiAgICpcbiAgICogQ29udGFpbmVyIHdpbGwgYmUgZXZhbHVhdGVkIG9ubHkgb25jZS4gSWYgeW91IHVzZSBgaW1wb3J0TW9kdWxlYCBmb3IgdGhlIHNhbWUgY29udGFpbmVyIHR3aWNlLFxuICAgKiB0aGUgY29udGFpbmVyIHdpbGwgYmUgbG9hZGVkIGFuZCBldmFsdWF0ZWQgb25seSBvbiB0aGUgZmlyc3QgaW1wb3J0LlxuICAgKlxuICAgKiBVbmRlciB0aGUgaG9vZCwgYGltcG9ydE1vZHVsZWAgd2lsbCBjYWxsIGBTY3JpcHRNYW5hZ2VyLnNoYXJlZC5sb2FkU2NyaXB0KGNvbnRhaW5lck5hbWUpYC5cbiAgICogVGhpcyBtZWFucywgYSByZXNvbHZlciBtdXN0IGJlIGFkZGVkIHdpdGggYFNjcmlwdE1hbmFnZXIuc2hhcmVkLmFkZFJlc29sdmVyKC4uLilgIGJlZm9yZWhhbmQgYW5kIHByb3ZpZGVkIHByb3BlclxuICAgKiByZXNvbHV0aW9uIGxvZ2ljIHRvIHJlc29sdmUgVVJMIGJhc2VkIG9uIHRoZSBgY29udGFpbmVyTmFtZWAuXG4gICAqXG4gICAqIEBwYXJhbSBjb250YWluZXJOYW1lIE5hbWUgb2YgdGhlIGNvbnRhaW5lciAtIHNob3VsZCBiZSB0aGUgc2FtZSBuYW1lIHByb3ZpZGVkIHRvXG4gICAqIGB3ZWJwYWNrLmNvbnRhaW5lci5Nb2R1bGVGZWRlcmF0aW9uUGx1Z2luYCBpbiBgbGlicmFyeS5uYW1lYC5cbiAgICogQHBhcmFtIG1vZHVsZSBGdWxsIG5hbWUgd2l0aCBleHRlbnNpb24gb2YgdGhlIG1vZHVsZSB0byBpbXBvcnQgZnJvbSB0aGUgY29udGFpbmVyIC0gb25seSBtb2R1bGVzXG4gICAqIGV4cG9zZWQgaW4gYGV4cG9zZXNgIGluIGB3ZWJwYWNrLmNvbnRhaW5lci5Nb2R1bGVGZWRlcmF0aW9uUGx1Z2luYCBjYW4gYmUgdXNlZC5cbiAgICogQHBhcmFtIHNjb3BlIE9wdGlvbmFsLCBzY29wZSBmb3Igc2hhcmluZyBtb2R1bGVzIGJldHdlZW4gY29udGFpbmVycy4gRGVmYXVsdHMgdG8gYCdkZWZhdWx0J2AuXG4gICAqIEByZXR1cm5zIEV4cG9ydHMgb2YgZ2l2ZW4gYG1vZHVsZWAgZnJvbSBnaXZlbiBjb250YWluZXIuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHRzXG4gICAqIGltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbiAgICogaW1wb3J0IHsgRmVkZXJhdGVkIH0gZnJvbSAnQGNhbGxzdGFjay9yZXBhY2svY2xpZW50JztcbiAgICpcbiAgICogY29uc3QgQnV0dG9uID0gUmVhY3QubGF6eSgoKSA9PiBGZWRlcmF0ZWQuaW1wb3J0TW9kdWxlKCdteS1jb21wb25lbnRzJywgJy4vQnV0dG9uLmpzJykpO1xuICAgKlxuICAgKiBjb25zdCBteVV0aWwgPSBhd2FpdCBGZWRlcmF0ZWQuaW1wb3J0TW9kdWxlKCdteS1saWInLCAnLi9teVV0aWwuanMnKTtcbiAgICogYGBgXG4gICAqLyBmdW5jdGlvbiBpbXBvcnRNb2R1bGUoY29udGFpbmVyTmFtZSwgbW9kdWxlLCByZWYpIHtcbiAgICAgICAgdmFyIHNjb3BlID0gcmVmID09PSB2b2lkIDAgPyAnZGVmYXVsdCcgOiByZWY7XG4gICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgdmFyIF9fd2VicGFja19zaGFyZV9zY29wZXNfX19zY29wZTtcbiAgICAgICAgICAgIGlmICghKChfX3dlYnBhY2tfc2hhcmVfc2NvcGVzX19fc2NvcGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLlNbc2NvcGVdKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfc2hhcmVfc2NvcGVzX19fc2NvcGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19zaGFyZV9zY29wZXNfX19zY29wZS5fX2lzSW5pdGlhbGl6ZWQpKSB7XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZXMgdGhlIHNoYXJlIHNjb3BlLlxuICAgICAgICAgICAgICAgIC8vIFRoaXMgZmlsbHMgaXQgd2l0aCBrbm93biBwcm92aWRlZCBtb2R1bGVzIGZyb20gdGhpcyBidWlsZCBhbmQgYWxsIHJlbW90ZXMuXG4gICAgICAgICAgICAgICAgeWllbGQgX193ZWJwYWNrX3JlcXVpcmVfXy5JKHNjb3BlKTtcbiAgICAgICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLlNbc2NvcGVdLl9faXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBEbyBub3QgdXNlIGBjb25zdCBjb250YWluZXIgPSBzZWxmW2NvbnRhaW5lck5hbWVdO2AgaGVyZS4gT25jZSBjb250YWluZXIgaXMgbG9hZGVkXG4gICAgICAgICAgICAvLyBgY29udGFpbmVyYCByZWZlcmVuY2UgaXMgbm90IHVwZGF0ZWQsIHNvIGBjb250YWluZXIuX19pc0luaXRpYWxpemVkYFxuICAgICAgICAgICAgLy8gd2lsbCBjcmFzaCB0aGUgYXBwbGljYXRpb24sIGJlY2F1c2Ugb2YgcmVhZGluZyBwcm9wZXJ0eSBmcm9tIGB1bmRlZmluZWRgLlxuICAgICAgICAgICAgaWYgKCFzZWxmW2NvbnRhaW5lck5hbWVdKSB7XG4gICAgICAgICAgICAgICAgLy8gRG93bmxvYWQgYW5kIGV4ZWN1dGUgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgeWllbGQgX1NjcmlwdE1hbmFnZXIuU2NyaXB0TWFuYWdlci5zaGFyZWQubG9hZFNjcmlwdChjb250YWluZXJOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBzZWxmW2NvbnRhaW5lck5hbWVdO1xuICAgICAgICAgICAgaWYgKCFjb250YWluZXIuX19pc0luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLl9faXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgY29udGFpbmVyLCBpdCBtYXkgcHJvdmlkZSBzaGFyZWQgbW9kdWxlc1xuICAgICAgICAgICAgICAgIHlpZWxkIGNvbnRhaW5lci5pbml0KF9fd2VicGFja19yZXF1aXJlX18uU1tzY29wZV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZhY3RvcnkgPSB5aWVsZCBjb250YWluZXIuZ2V0KG1vZHVsZSk7XG4gICAgICAgICAgICB2YXIgZXhwb3J0czEgPSBmYWN0b3J5KCk7XG4gICAgICAgICAgICByZXR1cm4gZXhwb3J0czE7XG4gICAgICAgIH0pKCk7XG4gICAgfVxuICAgIF9GZWRlcmF0ZWQuaW1wb3J0TW9kdWxlID0gaW1wb3J0TW9kdWxlO1xufSkoRmVkZXJhdGVkIHx8IChGZWRlcmF0ZWQgPSB7fSkpOyAvLyMgc291cmNlTWFwcGluZ1VSTD1mZWRlcmF0ZWQuanMubWFwXG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2dldFdlYnBhY2tDb250ZXh0LmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9nZXRXZWJwYWNrQ29udGV4dC5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbi8qKlxuICogR2V0IFdlYnBhY2sgcnVudGltZSBjb250ZXh0IGZvcm0gY3VycmVudCBKYXZhU2NyaXB0IHNjb3BlLlxuICpcbiAqIF9fWW91IGxpa2VseSBkb24ndCBuZWVkIHRvIHVzZSBpdC5fX1xuICovIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZ2V0V2VicGFja0NvbnRleHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBnZXRXZWJwYWNrQ29udGV4dDtcbiAgICB9XG59KSk7XG5mdW5jdGlvbiBnZXRXZWJwYWNrQ29udGV4dCgpIHtcbiAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXztcbn0gLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2V0V2VicGFja0NvbnRleHQuanMubWFwXG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL2luZGV4LmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9pbmRleC5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiRmVkZXJhdGVkXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX2ZlZGVyYXRlZC5GZWRlcmF0ZWQ7XG4gICAgfVxufSkpO1xudmFyIF9leHBvcnRfc3RhciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19leHBvcnRfc3RhciAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2V4cG9ydF9zdGFyLmNqc1wiKTtcbl9leHBvcnRfc3Rhci5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vU2NyaXB0TWFuYWdlci5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL1NjcmlwdE1hbmFnZXIuanNcIiksIGV4cG9ydHMpO1xuX2V4cG9ydF9zdGFyLl8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9TY3JpcHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9TY3JpcHQuanNcIiksIGV4cG9ydHMpO1xuX2V4cG9ydF9zdGFyLl8oX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi90eXBlcy5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL3R5cGVzLmpzXCIpLCBleHBvcnRzKTtcbl9leHBvcnRfc3Rhci5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZ2V0V2VicGFja0NvbnRleHQuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9nZXRXZWJwYWNrQ29udGV4dC5qc1wiKSwgZXhwb3J0cyk7XG52YXIgX2ZlZGVyYXRlZCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vZmVkZXJhdGVkLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvZmVkZXJhdGVkLmpzXCIpO1xuIC8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci90eXBlcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svZGlzdC9tb2R1bGVzL1NjcmlwdE1hbmFnZXIvdHlwZXMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbiAvLyMgc291cmNlTWFwcGluZ1VSTD10eXBlcy5qcy5tYXBcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQGNhbGxzdGFjay9yZXBhY2svbWYvY29yZS1wbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX0NvcmVQbHVnaW4uZGVmYXVsdDtcbiAgICB9XG59KSk7XG52YXIgX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuY2pzXCIpO1xudmFyIF9Db3JlUGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuLi9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL0NvcmVQbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL0NvcmVQbHVnaW4uanNcIikpO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJkZWZhdWx0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX1Jlc29sdmVyUGx1Z2luLmRlZmF1bHQ7XG4gICAgfVxufSkpO1xudmFyIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdCAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2ludGVyb3BfcmVxdWlyZV9kZWZhdWx0LmNqc1wiKTtcbnZhciBfUmVzb2x2ZXJQbHVnaW4gPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4uL2Rpc3QvbW9kdWxlcy9GZWRlcmF0aW9uUnVudGltZVBsdWdpbnMvUmVzb2x2ZXJQbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvRmVkZXJhdGlvblJ1bnRpbWVQbHVnaW5zL1Jlc29sdmVyUGx1Z2luLmpzXCIpKTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzL2Rpc3QvaW5kZXguY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgUlVOVElNRV8wMDEgPSAnUlVOVElNRS0wMDEnO1xudmFyIFJVTlRJTUVfMDAyID0gJ1JVTlRJTUUtMDAyJztcbnZhciBSVU5USU1FXzAwMyA9ICdSVU5USU1FLTAwMyc7XG52YXIgUlVOVElNRV8wMDQgPSAnUlVOVElNRS0wMDQnO1xudmFyIFJVTlRJTUVfMDA1ID0gJ1JVTlRJTUUtMDA1JztcbnZhciBSVU5USU1FXzAwNiA9ICdSVU5USU1FLTAwNic7XG52YXIgUlVOVElNRV8wMDcgPSAnUlVOVElNRS0wMDcnO1xudmFyIFJVTlRJTUVfMDA4ID0gJ1JVTlRJTUUtMDA4JztcbnZhciBUWVBFXzAwMSA9ICdUWVBFLTAwMSc7XG52YXIgQlVJTERfMDAxID0gJ0JVSUxELTAwMSc7XG52YXIgZ2V0RG9jc1VybCA9IChlcnJvckNvZGUpPT57XG4gICAgdmFyIHR5cGUgPSBlcnJvckNvZGUuc3BsaXQoJy0nKVswXS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBgaHR0cHM6Ly9tb2R1bGUtZmVkZXJhdGlvbi5pby9ndWlkZS90cm91Ymxlc2hvb3RpbmcvJHt0eXBlfS8ke2Vycm9yQ29kZX1gO1xufTtcbnZhciBnZXRTaG9ydEVycm9yTXNnID0gKGVycm9yQ29kZSwgZXJyb3JEZXNjTWFwLCBhcmdzLCBvcmlnaW5hbEVycm9yTXNnKT0+e1xuICAgIHZhciBtc2cgPSBbXG4gICAgICAgIGAke1tcbiAgICAgICAgICAgIGVycm9yRGVzY01hcFtlcnJvckNvZGVdXG4gICAgICAgIF19ICMke2Vycm9yQ29kZX1gXG4gICAgXTtcbiAgICBhcmdzICYmIG1zZy5wdXNoKGBhcmdzOiAke0pTT04uc3RyaW5naWZ5KGFyZ3MpfWApO1xuICAgIG1zZy5wdXNoKGdldERvY3NVcmwoZXJyb3JDb2RlKSk7XG4gICAgb3JpZ2luYWxFcnJvck1zZyAmJiBtc2cucHVzaChgT3JpZ2luYWwgRXJyb3IgTWVzc2FnZTpcXG4gJHtvcmlnaW5hbEVycm9yTXNnfWApO1xuICAgIHJldHVybiBtc2cuam9pbignXFxuJyk7XG59O1xuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gICAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQpIHtcbiAgICAgICAgZm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gc291cmNlKWlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbiAgICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbnZhciBydW50aW1lRGVzY01hcCA9IHtcbiAgICBbUlVOVElNRV8wMDFdOiAnRmFpbGVkIHRvIGdldCByZW1vdGVFbnRyeSBleHBvcnRzLicsXG4gICAgW1JVTlRJTUVfMDAyXTogJ1RoZSByZW1vdGUgZW50cnkgaW50ZXJmYWNlIGRvZXMgbm90IGNvbnRhaW4gXCJpbml0XCInLFxuICAgIFtSVU5USU1FXzAwM106ICdGYWlsZWQgdG8gZ2V0IG1hbmlmZXN0LicsXG4gICAgW1JVTlRJTUVfMDA0XTogJ0ZhaWxlZCB0byBsb2NhdGUgcmVtb3RlLicsXG4gICAgW1JVTlRJTUVfMDA1XTogJ0ludmFsaWQgbG9hZFNoYXJlU3luYyBmdW5jdGlvbiBjYWxsIGZyb20gYnVuZGxlciBydW50aW1lJyxcbiAgICBbUlVOVElNRV8wMDZdOiAnSW52YWxpZCBsb2FkU2hhcmVTeW5jIGZ1bmN0aW9uIGNhbGwgZnJvbSBydW50aW1lJyxcbiAgICBbUlVOVElNRV8wMDddOiAnRmFpbGVkIHRvIGdldCByZW1vdGUgc25hcHNob3QuJyxcbiAgICBbUlVOVElNRV8wMDhdOiAnRmFpbGVkIHRvIGxvYWQgc2NyaXB0IHJlc291cmNlcy4nXG59O1xudmFyIHR5cGVEZXNjTWFwID0ge1xuICAgIFtUWVBFXzAwMV06ICdGYWlsZWQgdG8gZ2VuZXJhdGUgdHlwZSBkZWNsYXJhdGlvbi4nXG59O1xudmFyIGJ1aWxkRGVzY01hcCA9IHtcbiAgICBbQlVJTERfMDAxXTogJ0ZhaWxlZCB0byBmaW5kIGV4cG9zZSBtb2R1bGUuJ1xufTtcbnZhciBlcnJvckRlc2NNYXAgPSBfZXh0ZW5kcyh7fSwgcnVudGltZURlc2NNYXAsIHR5cGVEZXNjTWFwLCBidWlsZERlc2NNYXApO1xuZXhwb3J0cy5CVUlMRF8wMDEgPSBCVUlMRF8wMDE7XG5leHBvcnRzLlJVTlRJTUVfMDAxID0gUlVOVElNRV8wMDE7XG5leHBvcnRzLlJVTlRJTUVfMDAyID0gUlVOVElNRV8wMDI7XG5leHBvcnRzLlJVTlRJTUVfMDAzID0gUlVOVElNRV8wMDM7XG5leHBvcnRzLlJVTlRJTUVfMDA0ID0gUlVOVElNRV8wMDQ7XG5leHBvcnRzLlJVTlRJTUVfMDA1ID0gUlVOVElNRV8wMDU7XG5leHBvcnRzLlJVTlRJTUVfMDA2ID0gUlVOVElNRV8wMDY7XG5leHBvcnRzLlJVTlRJTUVfMDA3ID0gUlVOVElNRV8wMDc7XG5leHBvcnRzLlJVTlRJTUVfMDA4ID0gUlVOVElNRV8wMDg7XG5leHBvcnRzLlRZUEVfMDAxID0gVFlQRV8wMDE7XG5leHBvcnRzLmJ1aWxkRGVzY01hcCA9IGJ1aWxkRGVzY01hcDtcbmV4cG9ydHMuZXJyb3JEZXNjTWFwID0gZXJyb3JEZXNjTWFwO1xuZXhwb3J0cy5nZXRTaG9ydEVycm9yTXNnID0gZ2V0U2hvcnRFcnJvck1zZztcbmV4cG9ydHMucnVudGltZURlc2NNYXAgPSBydW50aW1lRGVzY01hcDtcbmV4cG9ydHMudHlwZURlc2NNYXAgPSB0eXBlRGVzY01hcDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L2luZGV4LmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvaW5kZXguY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoe1xuICAgIHZhbHVlOiB0cnVlXG59KSk7XG52YXIgX2FzeW5jX3RvX2dlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19hc3luY190b19nZW5lcmF0b3IgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hc3luY190b19nZW5lcmF0b3IuY2pzXCIpO1xudmFyIF9jYWxsX3N1cGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX2NhbGxfc3VwZXIgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jYWxsX3N1cGVyLmNqc1wiKTtcbnZhciBfY2xhc3NfY2FsbF9jaGVjayA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jbGFzc19jYWxsX2NoZWNrICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janNcIik7XG52YXIgX2NyZWF0ZV9jbGFzcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jcmVhdGVfY2xhc3MgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzXCIpO1xudmFyIF9pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19pbmhlcml0cyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2luaGVyaXRzLmNqc1wiKTtcbnZhciBfc2xpY2VkX3RvX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3NsaWNlZF90b19hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NsaWNlZF90b19hcnJheS5janNcIik7XG52YXIgX3RvX2NvbnN1bWFibGVfYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fdG9fY29uc3VtYWJsZV9hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzXCIpO1xudmFyIF90eXBlX29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3R5cGVfb2YgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190eXBlX29mLmNqc1wiKTtcbnZhciBwb2x5ZmlsbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL3BvbHlmaWxscy5janMuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvcG9seWZpbGxzLmNqcy5qc1wiKTtcbnZhciBzZGsgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAbW9kdWxlLWZlZGVyYXRpb24vc2RrICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbnZhciBlcnJvckNvZGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL2Vycm9yLWNvZGVzL2Rpc3QvaW5kZXguY2pzLmpzXCIpO1xudmFyIExPR19DQVRFR09SWSA9ICdbIEZlZGVyYXRpb24gUnVudGltZSBdJztcbi8vIEZJWE1FOiBwcmUtYnVuZGxlID9cbnZhciBsb2dnZXIgPSBzZGsuY3JlYXRlTG9nZ2VyKExPR19DQVRFR09SWSk7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xuZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgbXNnKSB7XG4gICAgaWYgKCFjb25kaXRpb24pIHtcbiAgICAgICAgZXJyb3IobXNnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBlcnJvcihtc2cpIHtcbiAgICBpZiAobXNnIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgbXNnLm1lc3NhZ2UgPSBgJHtMT0dfQ0FURUdPUll9OiAke21zZy5tZXNzYWdlfWA7XG4gICAgICAgIHRocm93IG1zZztcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGAke0xPR19DQVRFR09SWX06ICR7bXNnfWApO1xufVxuZnVuY3Rpb24gd2Fybihtc2cpIHtcbiAgICBpZiAobXNnIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgbXNnLm1lc3NhZ2UgPSBgJHtMT0dfQ0FURUdPUll9OiAke21zZy5tZXNzYWdlfWA7XG4gICAgICAgIGxvZ2dlci53YXJuKG1zZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbG9nZ2VyLndhcm4obXNnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhZGRVbmlxdWVJdGVtKGFyciwgaXRlbSkge1xuICAgIGlmIChhcnIuZmluZEluZGV4KChuYW1lMSk9Pm5hbWUxID09PSBpdGVtKSA9PT0gLTEpIHtcbiAgICAgICAgYXJyLnB1c2goaXRlbSk7XG4gICAgfVxuICAgIHJldHVybiBhcnI7XG59XG5mdW5jdGlvbiBnZXRGTUlkKHJlbW90ZUluZm8pIHtcbiAgICBpZiAoJ3ZlcnNpb24nIGluIHJlbW90ZUluZm8gJiYgcmVtb3RlSW5mby52ZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiBgJHtyZW1vdGVJbmZvLm5hbWV9OiR7cmVtb3RlSW5mby52ZXJzaW9ufWA7XG4gICAgfSBlbHNlIGlmICgnZW50cnknIGluIHJlbW90ZUluZm8gJiYgcmVtb3RlSW5mby5lbnRyeSkge1xuICAgICAgICByZXR1cm4gYCR7cmVtb3RlSW5mby5uYW1lfToke3JlbW90ZUluZm8uZW50cnl9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYCR7cmVtb3RlSW5mby5uYW1lfWA7XG4gICAgfVxufVxuZnVuY3Rpb24gaXNSZW1vdGVJbmZvV2l0aEVudHJ5KHJlbW90ZSkge1xuICAgIHJldHVybiB0eXBlb2YgcmVtb3RlLmVudHJ5ICE9PSAndW5kZWZpbmVkJztcbn1cbmZ1bmN0aW9uIGlzUHVyZVJlbW90ZUVudHJ5KHJlbW90ZSkge1xuICAgIHJldHVybiAhcmVtb3RlLmVudHJ5LmluY2x1ZGVzKCcuanNvbicpICYmIHJlbW90ZS5lbnRyeS5pbmNsdWRlcygnLmpzJyk7XG59XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZnVuY3Rpb24gc2FmZVdyYXBwZXIoY2FsbGJhY2ssIGRpc2FibGVXYXJuKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgcmVzID0geWllbGQgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICFkaXNhYmxlV2FybiAmJiB3YXJuKGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSkoKTtcbn1cbmZ1bmN0aW9uIGlzT2JqZWN0KHZhbCkge1xuICAgIHJldHVybiB2YWwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCc7XG59XG52YXIgb2JqZWN0VG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcbmZ1bmN0aW9uIGlzUGxhaW5PYmplY3QodmFsKSB7XG4gICAgcmV0dXJuIG9iamVjdFRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgT2JqZWN0XSc7XG59XG5mdW5jdGlvbiBpc1N0YXRpY1Jlc291cmNlc0VxdWFsKHVybDEsIHVybDIpIHtcbiAgICB2YXIgUkVHX0VYUCA9IC9eKGh0dHBzPzopP1xcL1xcLy9pO1xuICAgIC8vIFRyYW5zZm9ybSB1cmwxIGFuZCB1cmwyIGludG8gcmVsYXRpdmUgcGF0aHNcbiAgICB2YXIgcmVsYXRpdmVVcmwxID0gdXJsMS5yZXBsYWNlKFJFR19FWFAsICcnKS5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgIHZhciByZWxhdGl2ZVVybDIgPSB1cmwyLnJlcGxhY2UoUkVHX0VYUCwgJycpLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gICAgLy8gQ2hlY2sgaWYgdGhlIHJlbGF0aXZlIHBhdGhzIGFyZSBpZGVudGljYWxcbiAgICByZXR1cm4gcmVsYXRpdmVVcmwxID09PSByZWxhdGl2ZVVybDI7XG59XG5mdW5jdGlvbiBhcnJheU9wdGlvbnMob3B0aW9ucykge1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KG9wdGlvbnMpID8gb3B0aW9ucyA6IFtcbiAgICAgICAgb3B0aW9uc1xuICAgIF07XG59XG5mdW5jdGlvbiBnZXRSZW1vdGVFbnRyeUluZm9Gcm9tU25hcHNob3Qoc25hcHNob3QpIHtcbiAgICB2YXIgZGVmYXVsdFJlbW90ZUVudHJ5SW5mbyA9IHtcbiAgICAgICAgdXJsOiAnJyxcbiAgICAgICAgdHlwZTogJ2dsb2JhbCcsXG4gICAgICAgIGdsb2JhbE5hbWU6ICcnXG4gICAgfTtcbiAgICBpZiAoc2RrLmlzQnJvd3NlckVudigpKSB7XG4gICAgICAgIHJldHVybiAncmVtb3RlRW50cnknIGluIHNuYXBzaG90ID8ge1xuICAgICAgICAgICAgdXJsOiBzbmFwc2hvdC5yZW1vdGVFbnRyeSxcbiAgICAgICAgICAgIHR5cGU6IHNuYXBzaG90LnJlbW90ZUVudHJ5VHlwZSxcbiAgICAgICAgICAgIGdsb2JhbE5hbWU6IHNuYXBzaG90Lmdsb2JhbE5hbWVcbiAgICAgICAgfSA6IGRlZmF1bHRSZW1vdGVFbnRyeUluZm87XG4gICAgfVxuICAgIGlmICgnc3NyUmVtb3RlRW50cnknIGluIHNuYXBzaG90KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cmw6IHNuYXBzaG90LnNzclJlbW90ZUVudHJ5IHx8IGRlZmF1bHRSZW1vdGVFbnRyeUluZm8udXJsLFxuICAgICAgICAgICAgdHlwZTogc25hcHNob3Quc3NyUmVtb3RlRW50cnlUeXBlIHx8IGRlZmF1bHRSZW1vdGVFbnRyeUluZm8udHlwZSxcbiAgICAgICAgICAgIGdsb2JhbE5hbWU6IHNuYXBzaG90Lmdsb2JhbE5hbWVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmF1bHRSZW1vdGVFbnRyeUluZm87XG59XG52YXIgcHJvY2Vzc01vZHVsZUFsaWFzID0gKG5hbWUxLCBzdWJQYXRoKT0+e1xuICAgIC8vIEBob3N0LyAuL2J1dHRvbiAtPiBAaG9zdC9idXR0b25cbiAgICB2YXIgbW9kdWxlTmFtZTtcbiAgICBpZiAobmFtZTEuZW5kc1dpdGgoJy8nKSkge1xuICAgICAgICBtb2R1bGVOYW1lID0gbmFtZTEuc2xpY2UoMCwgLTEpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZHVsZU5hbWUgPSBuYW1lMTtcbiAgICB9XG4gICAgaWYgKHN1YlBhdGguc3RhcnRzV2l0aCgnLicpKSB7XG4gICAgICAgIHN1YlBhdGggPSBzdWJQYXRoLnNsaWNlKDEpO1xuICAgIH1cbiAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZSArIHN1YlBhdGg7XG4gICAgcmV0dXJuIG1vZHVsZU5hbWU7XG59O1xudmFyIEN1cnJlbnRHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcgPyBnbG9iYWxUaGlzIDogd2luZG93O1xudmFyIG5hdGl2ZUdsb2JhbCA9ICgoKT0+e1xuICAgIHRyeSB7XG4gICAgICAgIC8vIGdldCByZWFsIHdpbmRvdyAoaW5jYXNlIG9mIHNhbmRib3gpXG4gICAgICAgIHJldHVybiBkb2N1bWVudC5kZWZhdWx0VmlldztcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIG5vZGUgZW52XG4gICAgICAgIHJldHVybiBDdXJyZW50R2xvYmFsO1xuICAgIH1cbn0pKCk7XG52YXIgR2xvYmFsID0gbmF0aXZlR2xvYmFsO1xuZnVuY3Rpb24gZGVmaW5lUHJvcGVydHlHbG9iYWxWYWwodGFyZ2V0LCBrZXksIHZhbCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwge1xuICAgICAgICB2YWx1ZTogdmFsLFxuICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xufVxuZnVuY3Rpb24gaW5jbHVkZU93blByb3BlcnR5KHRhcmdldCwga2V5KSB7XG4gICAgcmV0dXJuIE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRhcmdldCwga2V5KTtcbn1cbi8vIFRoaXMgc2VjdGlvbiBpcyB0byBwcmV2ZW50IGVuY2Fwc3VsYXRpb24gYnkgY2VydGFpbiBtaWNyb2Zyb250ZW5kIGZyYW1ld29ya3MuIER1ZSB0byByZXVzZSBwb2xpY2llcywgc2FuZGJveCBlc2NhcGVzLlxuLy8gVGhlIHNhbmRib3ggaW4gdGhlIG1pY3JvZnJvbnRlbmQgZG9lcyBub3QgcmVwbGljYXRlIHRoZSB2YWx1ZSBvZiAnY29uZmlndXJhYmxlJy5cbi8vIElmIHRoZXJlIGlzIG5vIGxvYWRpbmcgY29udGVudCBvbiB0aGUgZ2xvYmFsIG9iamVjdCwgdGhpcyBzZWN0aW9uIGRlZmluZXMgdGhlIGxvYWRpbmcgb2JqZWN0LlxuaWYgKCFpbmNsdWRlT3duUHJvcGVydHkoQ3VycmVudEdsb2JhbCwgJ19fR0xPQkFMX0xPQURJTkdfUkVNT1RFX0VOVFJZX18nKSkge1xuICAgIGRlZmluZVByb3BlcnR5R2xvYmFsVmFsKEN1cnJlbnRHbG9iYWwsICdfX0dMT0JBTF9MT0FESU5HX1JFTU9URV9FTlRSWV9fJywge30pO1xufVxudmFyIGdsb2JhbExvYWRpbmcgPSBDdXJyZW50R2xvYmFsLl9fR0xPQkFMX0xPQURJTkdfUkVNT1RFX0VOVFJZX187XG5mdW5jdGlvbiBzZXRHbG9iYWxEZWZhdWx0VmFsKHRhcmdldCkge1xuICAgIHZhciBfdGFyZ2V0X19fRkVERVJBVElPTl9fLCBfdGFyZ2V0X19fRkVERVJBVElPTl9fMSwgX3RhcmdldF9fX0ZFREVSQVRJT05fXzIsIF90YXJnZXRfX19GRURFUkFUSU9OX18zLCBfdGFyZ2V0X19fRkVERVJBVElPTl9fNCwgX3RhcmdldF9fX0ZFREVSQVRJT05fXzU7XG4gICAgaWYgKGluY2x1ZGVPd25Qcm9wZXJ0eSh0YXJnZXQsICdfX1ZNT0tfXycpICYmICFpbmNsdWRlT3duUHJvcGVydHkodGFyZ2V0LCAnX19GRURFUkFUSU9OX18nKSkge1xuICAgICAgICBkZWZpbmVQcm9wZXJ0eUdsb2JhbFZhbCh0YXJnZXQsICdfX0ZFREVSQVRJT05fXycsIHRhcmdldC5fX1ZNT0tfXyk7XG4gICAgfVxuICAgIGlmICghaW5jbHVkZU93blByb3BlcnR5KHRhcmdldCwgJ19fRkVERVJBVElPTl9fJykpIHtcbiAgICAgICAgZGVmaW5lUHJvcGVydHlHbG9iYWxWYWwodGFyZ2V0LCAnX19GRURFUkFUSU9OX18nLCB7XG4gICAgICAgICAgICBfX0dMT0JBTF9QTFVHSU5fXzogW10sXG4gICAgICAgICAgICBfX0lOU1RBTkNFU19fOiBbXSxcbiAgICAgICAgICAgIG1vZHVsZUluZm86IHt9LFxuICAgICAgICAgICAgX19TSEFSRV9fOiB7fSxcbiAgICAgICAgICAgIF9fTUFOSUZFU1RfTE9BRElOR19fOiB7fSxcbiAgICAgICAgICAgIF9fUFJFTE9BREVEX01BUF9fOiBuZXcgTWFwKClcbiAgICAgICAgfSk7XG4gICAgICAgIGRlZmluZVByb3BlcnR5R2xvYmFsVmFsKHRhcmdldCwgJ19fVk1PS19fJywgdGFyZ2V0Ll9fRkVERVJBVElPTl9fKTtcbiAgICB9XG4gICAgdmFyIF9fX0dMT0JBTF9QTFVHSU5fXztcbiAgICAoX19fR0xPQkFMX1BMVUdJTl9fID0gKF90YXJnZXRfX19GRURFUkFUSU9OX18gPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fR0xPQkFMX1BMVUdJTl9fKSAhPSBudWxsID8gX19fR0xPQkFMX1BMVUdJTl9fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXyA9IFtdO1xuICAgIHZhciBfX19JTlNUQU5DRVNfXztcbiAgICAoX19fSU5TVEFOQ0VTX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzEgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fSU5TVEFOQ0VTX18pICE9IG51bGwgPyBfX19JTlNUQU5DRVNfXyA6IF90YXJnZXRfX19GRURFUkFUSU9OX18xLl9fSU5TVEFOQ0VTX18gPSBbXTtcbiAgICB2YXIgX21vZHVsZUluZm87XG4gICAgKF9tb2R1bGVJbmZvID0gKF90YXJnZXRfX19GRURFUkFUSU9OX18yID0gdGFyZ2V0Ll9fRkVERVJBVElPTl9fKS5tb2R1bGVJbmZvKSAhPSBudWxsID8gX21vZHVsZUluZm8gOiBfdGFyZ2V0X19fRkVERVJBVElPTl9fMi5tb2R1bGVJbmZvID0ge307XG4gICAgdmFyIF9fX1NIQVJFX187XG4gICAgKF9fX1NIQVJFX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzMgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fU0hBUkVfXykgIT0gbnVsbCA/IF9fX1NIQVJFX18gOiBfdGFyZ2V0X19fRkVERVJBVElPTl9fMy5fX1NIQVJFX18gPSB7fTtcbiAgICB2YXIgX19fTUFOSUZFU1RfTE9BRElOR19fO1xuICAgIChfX19NQU5JRkVTVF9MT0FESU5HX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzQgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fTUFOSUZFU1RfTE9BRElOR19fKSAhPSBudWxsID8gX19fTUFOSUZFU1RfTE9BRElOR19fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXzQuX19NQU5JRkVTVF9MT0FESU5HX18gPSB7fTtcbiAgICB2YXIgX19fUFJFTE9BREVEX01BUF9fO1xuICAgIChfX19QUkVMT0FERURfTUFQX18gPSAoX3RhcmdldF9fX0ZFREVSQVRJT05fXzUgPSB0YXJnZXQuX19GRURFUkFUSU9OX18pLl9fUFJFTE9BREVEX01BUF9fKSAhPSBudWxsID8gX19fUFJFTE9BREVEX01BUF9fIDogX3RhcmdldF9fX0ZFREVSQVRJT05fXzUuX19QUkVMT0FERURfTUFQX18gPSBuZXcgTWFwKCk7XG59XG5zZXRHbG9iYWxEZWZhdWx0VmFsKEN1cnJlbnRHbG9iYWwpO1xuc2V0R2xvYmFsRGVmYXVsdFZhbChuYXRpdmVHbG9iYWwpO1xuZnVuY3Rpb24gcmVzZXRGZWRlcmF0aW9uR2xvYmFsSW5mbygpIHtcbiAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fR0xPQkFMX1BMVUdJTl9fID0gW107XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0lOU1RBTkNFU19fID0gW107XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvID0ge307XG4gICAgQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1NIQVJFX18gPSB7fTtcbiAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fTUFOSUZFU1RfTE9BRElOR19fID0ge307XG4gICAgT2JqZWN0LmtleXMoZ2xvYmFsTG9hZGluZykuZm9yRWFjaCgoa2V5KT0+e1xuICAgICAgICBkZWxldGUgZ2xvYmFsTG9hZGluZ1trZXldO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlKEZlZGVyYXRpb25JbnN0YW5jZSkge1xuICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19JTlNUQU5DRVNfXy5wdXNoKEZlZGVyYXRpb25JbnN0YW5jZSk7XG59XG5mdW5jdGlvbiBnZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IoKSB7XG4gICAgcmV0dXJuIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19ERUJVR19DT05TVFJVQ1RPUl9fO1xufVxuZnVuY3Rpb24gc2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yKEZlZGVyYXRpb25Db25zdHJ1Y3RvciwgcmVmKSB7XG4gICAgdmFyIGlzRGVidWcgPSByZWYgPT09IHZvaWQgMCA/IHNkay5pc0RlYnVnTW9kZSgpIDogcmVmO1xuICAgIGlmIChpc0RlYnVnKSB7XG4gICAgICAgIEN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19ERUJVR19DT05TVFJVQ1RPUl9fID0gRmVkZXJhdGlvbkNvbnN0cnVjdG9yO1xuICAgICAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fREVCVUdfQ09OU1RSVUNUT1JfVkVSU0lPTl9fID0gXCIwLjEwLjBcIjtcbiAgICB9XG59XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xuZnVuY3Rpb24gZ2V0SW5mb1dpdGhvdXRUeXBlKHRhcmdldCwga2V5KSB7XG4gICAgaWYgKHR5cGVvZiBrZXkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHZhciBrZXlSZXMgPSB0YXJnZXRba2V5XTtcbiAgICAgICAgaWYgKGtleVJlcykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGFyZ2V0W2tleV0sXG4gICAgICAgICAgICAgICAga2V5OiBrZXlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0S2V5cyA9IE9iamVjdC5rZXlzKHRhcmdldCk7XG4gICAgICAgICAgICBmb3IgKHZhciB0YXJnZXRLZXkgb2YgdGFyZ2V0S2V5cyl7XG4gICAgICAgICAgICAgICAgdmFyIF90YXJnZXRLZXlfc3BsaXQgPSBfc2xpY2VkX3RvX2FycmF5Ll8odGFyZ2V0S2V5LnNwbGl0KCc6JyksIDIpLCB0YXJnZXRUeXBlT3JOYW1lID0gX3RhcmdldEtleV9zcGxpdFswXSwgXyA9IF90YXJnZXRLZXlfc3BsaXRbMV07XG4gICAgICAgICAgICAgICAgdmFyIG5LZXkgPSBgJHt0YXJnZXRUeXBlT3JOYW1lfToke2tleX1gO1xuICAgICAgICAgICAgICAgIHZhciB0eXBlV2l0aEtleVJlcyA9IHRhcmdldFtuS2V5XTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZVdpdGhLZXlSZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0eXBlV2l0aEtleVJlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTogbktleVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBrZXk6IGtleVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigna2V5IG11c3QgYmUgc3RyaW5nJyk7XG4gICAgfVxufVxudmFyIGdldEdsb2JhbFNuYXBzaG90ID0gKCk9Pm5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvO1xudmFyIGdldFRhcmdldFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyA9IChtb2R1bGVJbmZvLCBzbmFwc2hvdCk9PntcbiAgICAvLyBDaGVjayBpZiB0aGUgcmVtb3RlIGlzIGluY2x1ZGVkIGluIHRoZSBob3N0U25hcHNob3RcbiAgICB2YXIgbW9kdWxlS2V5ID0gZ2V0Rk1JZChtb2R1bGVJbmZvKTtcbiAgICB2YXIgZ2V0TW9kdWxlSW5mbyA9IGdldEluZm9XaXRob3V0VHlwZShzbmFwc2hvdCwgbW9kdWxlS2V5KS52YWx1ZTtcbiAgICAvLyBUaGUgcmVtb3RlU25hcHNob3QgbWlnaHQgbm90IGluY2x1ZGUgYSB2ZXJzaW9uXG4gICAgaWYgKGdldE1vZHVsZUluZm8gJiYgIWdldE1vZHVsZUluZm8udmVyc2lvbiAmJiAndmVyc2lvbicgaW4gbW9kdWxlSW5mbyAmJiBtb2R1bGVJbmZvWyd2ZXJzaW9uJ10pIHtcbiAgICAgICAgZ2V0TW9kdWxlSW5mby52ZXJzaW9uID0gbW9kdWxlSW5mb1sndmVyc2lvbiddO1xuICAgIH1cbiAgICBpZiAoZ2V0TW9kdWxlSW5mbykge1xuICAgICAgICByZXR1cm4gZ2V0TW9kdWxlSW5mbztcbiAgICB9XG4gICAgLy8gSWYgdGhlIHJlbW90ZSBpcyBub3QgaW5jbHVkZWQgaW4gdGhlIGhvc3RTbmFwc2hvdCwgZGVwbG95IGEgbWljcm8gYXBwIHNuYXBzaG90XG4gICAgaWYgKCd2ZXJzaW9uJyBpbiBtb2R1bGVJbmZvICYmIG1vZHVsZUluZm9bJ3ZlcnNpb24nXSkge1xuICAgICAgICB2YXIgdmVyc2lvbiA9IG1vZHVsZUluZm8udmVyc2lvbiwgcmVzTW9kdWxlSW5mbyA9IHBvbHlmaWxscy5fb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllc19sb29zZShtb2R1bGVJbmZvLCBbXG4gICAgICAgICAgICBcInZlcnNpb25cIlxuICAgICAgICBdKTtcbiAgICAgICAgdmFyIG1vZHVsZUtleVdpdGhvdXRWZXJzaW9uID0gZ2V0Rk1JZChyZXNNb2R1bGVJbmZvKTtcbiAgICAgICAgdmFyIGdldE1vZHVsZUluZm9XaXRob3V0VmVyc2lvbiA9IGdldEluZm9XaXRob3V0VHlwZShuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbywgbW9kdWxlS2V5V2l0aG91dFZlcnNpb24pLnZhbHVlO1xuICAgICAgICBpZiAoKGdldE1vZHVsZUluZm9XaXRob3V0VmVyc2lvbiA9PSBudWxsID8gdm9pZCAwIDogZ2V0TW9kdWxlSW5mb1dpdGhvdXRWZXJzaW9uLnZlcnNpb24pID09PSB2ZXJzaW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0TW9kdWxlSW5mb1dpdGhvdXRWZXJzaW9uO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybjtcbn07XG52YXIgZ2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvID0gKG1vZHVsZUluZm8pPT5nZXRUYXJnZXRTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8obW9kdWxlSW5mbywgbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm8pO1xudmFyIHNldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyA9IChyZW1vdGVJbmZvLCBtb2R1bGVEZXRhaWxJbmZvKT0+e1xuICAgIHZhciBtb2R1bGVLZXkgPSBnZXRGTUlkKHJlbW90ZUluZm8pO1xuICAgIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvW21vZHVsZUtleV0gPSBtb2R1bGVEZXRhaWxJbmZvO1xuICAgIHJldHVybiBuYXRpdmVHbG9iYWwuX19GRURFUkFUSU9OX18ubW9kdWxlSW5mbztcbn07XG52YXIgYWRkR2xvYmFsU25hcHNob3QgPSAobW9kdWxlSW5mb3MpPT57XG4gICAgbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm8gPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5tb2R1bGVJbmZvLCBtb2R1bGVJbmZvcyk7XG4gICAgcmV0dXJuICgpPT57XG4gICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMobW9kdWxlSW5mb3MpO1xuICAgICAgICBmb3IgKHZhciBrZXkgb2Yga2V5cyl7XG4gICAgICAgICAgICBkZWxldGUgbmF0aXZlR2xvYmFsLl9fRkVERVJBVElPTl9fLm1vZHVsZUluZm9ba2V5XTtcbiAgICAgICAgfVxuICAgIH07XG59O1xudmFyIGdldFJlbW90ZUVudHJ5RXhwb3J0cyA9IChuYW1lMSwgZ2xvYmFsTmFtZSk9PntcbiAgICB2YXIgcmVtb3RlRW50cnlLZXkgPSBnbG9iYWxOYW1lIHx8IGBfX0ZFREVSQVRJT05fJHtuYW1lMX06Y3VzdG9tX19gO1xuICAgIHZhciBlbnRyeUV4cG9ydHMgPSBDdXJyZW50R2xvYmFsW3JlbW90ZUVudHJ5S2V5XTtcbiAgICByZXR1cm4ge1xuICAgICAgICByZW1vdGVFbnRyeUtleSxcbiAgICAgICAgZW50cnlFeHBvcnRzXG4gICAgfTtcbn07XG4vLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVnaXN0ZXIgZ2xvYmFsIHBsdWdpbnMuXG4vLyBJdCBpdGVyYXRlcyBvdmVyIHRoZSBwcm92aWRlZCBwbHVnaW5zIGFuZCBjaGVja3MgaWYgdGhleSBhcmUgYWxyZWFkeSByZWdpc3RlcmVkLlxuLy8gSWYgYSBwbHVnaW4gaXMgbm90IHJlZ2lzdGVyZWQsIGl0IGlzIGFkZGVkIHRvIHRoZSBnbG9iYWwgcGx1Z2lucy5cbi8vIElmIGEgcGx1Z2luIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCwgYSB3YXJuaW5nIG1lc3NhZ2UgaXMgbG9nZ2VkLlxudmFyIHJlZ2lzdGVyR2xvYmFsUGx1Z2lucyA9IChwbHVnaW5zKT0+e1xuICAgIHZhciBfX0dMT0JBTF9QTFVHSU5fXyA9IG5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXztcbiAgICBwbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgaWYgKF9fR0xPQkFMX1BMVUdJTl9fLmZpbmRJbmRleCgocCk9PnAubmFtZSA9PT0gcGx1Z2luLm5hbWUpID09PSAtMSkge1xuICAgICAgICAgICAgX19HTE9CQUxfUExVR0lOX18ucHVzaChwbHVnaW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgd2FybihgVGhlIHBsdWdpbiAke3BsdWdpbi5uYW1lfSBoYXMgYmVlbiByZWdpc3RlcmVkLmApO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xudmFyIGdldEdsb2JhbEhvc3RQbHVnaW5zID0gKCk9Pm5hdGl2ZUdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0dMT0JBTF9QTFVHSU5fXztcbnZhciBnZXRQcmVsb2FkZWQgPSAoaWQpPT5DdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fUFJFTE9BREVEX01BUF9fLmdldChpZCk7XG52YXIgc2V0UHJlbG9hZGVkID0gKGlkKT0+Q3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1BSRUxPQURFRF9NQVBfXy5zZXQoaWQsIHRydWUpO1xudmFyIERFRkFVTFRfU0NPUEUgPSAnZGVmYXVsdCc7XG52YXIgREVGQVVMVF9SRU1PVEVfVFlQRSA9ICdnbG9iYWwnO1xuLy8gZm9yayBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9vcmlnaW5qcy92aXRlLXBsdWdpbi1mZWRlcmF0aW9uL2Jsb2IvdjEuMS4xMi9wYWNrYWdlcy9saWIvc3JjL3V0aWxzL3NlbXZlci9pbmRleC50c1xuLy8gdGhvc2UgY29uc3RhbnRzIGFyZSBiYXNlZCBvbiBodHRwczovL3d3dy5ydWJ5ZG9jLmluZm8vZ2Vtcy9zZW1hbnRpY19yYW5nZS8zLjAuMC9TZW1hbnRpY1JhbmdlI0JVSUxESURFTlRJRklFUi1jb25zdGFudFxuLy8gQ29weXJpZ2h0IChjKVxuLy8gdml0ZS1wbHVnaW4tZmVkZXJhdGlvbiBpcyBsaWNlbnNlZCB1bmRlciBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgY2FuIHVzZSB0aGlzIHNvZnR3YXJlIGFjY29yZGluZyB0byB0aGUgdGVybXMgYW5kIGNvbmRpdGlvbnMgb2YgdGhlIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiBNdWxhbiBQU0wgdjIgYXQ6XG4vLyAgICAgIGh0dHA6Ly9saWNlbnNlLmNvc2NsLm9yZy5jbi9NdWxhblBTTDJcbi8vIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgT04gQU4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT0YgQU5ZIEtJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gTk9OLUlORlJJTkdFTUVOVCwgTUVSQ0hBTlRBQklMSVRZIE9SIEZJVCBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuXG4vLyBTZWUgdGhlIE11bGFuIFBTTCB2MiBmb3IgbW9yZSBkZXRhaWxzLlxudmFyIGJ1aWxkSWRlbnRpZmllciA9ICdbMC05QS1aYS16LV0rJztcbnZhciBidWlsZCA9IGAoPzpcXFxcKygke2J1aWxkSWRlbnRpZmllcn0oPzpcXFxcLiR7YnVpbGRJZGVudGlmaWVyfSkqKSlgO1xudmFyIG51bWVyaWNJZGVudGlmaWVyID0gJzB8WzEtOV1cXFxcZConO1xudmFyIG51bWVyaWNJZGVudGlmaWVyTG9vc2UgPSAnWzAtOV0rJztcbnZhciBub25OdW1lcmljSWRlbnRpZmllciA9ICdcXFxcZCpbYS16QS1aLV1bYS16QS1aMC05LV0qJztcbnZhciBwcmVSZWxlYXNlSWRlbnRpZmllckxvb3NlID0gYCg/OiR7bnVtZXJpY0lkZW50aWZpZXJMb29zZX18JHtub25OdW1lcmljSWRlbnRpZmllcn0pYDtcbnZhciBwcmVSZWxlYXNlTG9vc2UgPSBgKD86LT8oJHtwcmVSZWxlYXNlSWRlbnRpZmllckxvb3NlfSg/OlxcXFwuJHtwcmVSZWxlYXNlSWRlbnRpZmllckxvb3NlfSkqKSlgO1xudmFyIHByZVJlbGVhc2VJZGVudGlmaWVyID0gYCg/OiR7bnVtZXJpY0lkZW50aWZpZXJ9fCR7bm9uTnVtZXJpY0lkZW50aWZpZXJ9KWA7XG52YXIgcHJlUmVsZWFzZSA9IGAoPzotKCR7cHJlUmVsZWFzZUlkZW50aWZpZXJ9KD86XFxcXC4ke3ByZVJlbGVhc2VJZGVudGlmaWVyfSkqKSlgO1xudmFyIHhSYW5nZUlkZW50aWZpZXIgPSBgJHtudW1lcmljSWRlbnRpZmllcn18eHxYfFxcXFwqYDtcbnZhciB4UmFuZ2VQbGFpbiA9IGBbdj1cXFxcc10qKCR7eFJhbmdlSWRlbnRpZmllcn0pKD86XFxcXC4oJHt4UmFuZ2VJZGVudGlmaWVyfSkoPzpcXFxcLigke3hSYW5nZUlkZW50aWZpZXJ9KSg/OiR7cHJlUmVsZWFzZX0pPyR7YnVpbGR9Pyk/KT9gO1xudmFyIGh5cGhlblJhbmdlID0gYF5cXFxccyooJHt4UmFuZ2VQbGFpbn0pXFxcXHMrLVxcXFxzKygke3hSYW5nZVBsYWlufSlcXFxccyokYDtcbnZhciBtYWluVmVyc2lvbkxvb3NlID0gYCgke251bWVyaWNJZGVudGlmaWVyTG9vc2V9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJMb29zZX0pXFxcXC4oJHtudW1lcmljSWRlbnRpZmllckxvb3NlfSlgO1xudmFyIGxvb3NlUGxhaW4gPSBgW3Y9XFxcXHNdKiR7bWFpblZlcnNpb25Mb29zZX0ke3ByZVJlbGVhc2VMb29zZX0/JHtidWlsZH0/YDtcbnZhciBndGx0ID0gJygoPzo8fD4pPz0/KSc7XG52YXIgY29tcGFyYXRvclRyaW0gPSBgKFxcXFxzKikke2d0bHR9XFxcXHMqKCR7bG9vc2VQbGFpbn18JHt4UmFuZ2VQbGFpbn0pYDtcbnZhciBsb25lVGlsZGUgPSAnKD86fj4/KSc7XG52YXIgdGlsZGVUcmltID0gYChcXFxccyopJHtsb25lVGlsZGV9XFxcXHMrYDtcbnZhciBsb25lQ2FyZXQgPSAnKD86XFxcXF4pJztcbnZhciBjYXJldFRyaW0gPSBgKFxcXFxzKikke2xvbmVDYXJldH1cXFxccytgO1xudmFyIHN0YXIgPSAnKDx8Pik/PT9cXFxccypcXFxcKic7XG52YXIgY2FyZXQgPSBgXiR7bG9uZUNhcmV0fSR7eFJhbmdlUGxhaW59JGA7XG52YXIgbWFpblZlcnNpb24gPSBgKCR7bnVtZXJpY0lkZW50aWZpZXJ9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJ9KVxcXFwuKCR7bnVtZXJpY0lkZW50aWZpZXJ9KWA7XG52YXIgZnVsbFBsYWluID0gYHY/JHttYWluVmVyc2lvbn0ke3ByZVJlbGVhc2V9PyR7YnVpbGR9P2A7XG52YXIgdGlsZGUgPSBgXiR7bG9uZVRpbGRlfSR7eFJhbmdlUGxhaW59JGA7XG52YXIgeFJhbmdlID0gYF4ke2d0bHR9XFxcXHMqJHt4UmFuZ2VQbGFpbn0kYDtcbnZhciBjb21wYXJhdG9yID0gYF4ke2d0bHR9XFxcXHMqKCR7ZnVsbFBsYWlufSkkfF4kYDtcbi8vIGNvcHkgZnJvbSBzZW12ZXIgcGFja2FnZVxudmFyIGd0ZTAgPSAnXlxcXFxzKj49XFxcXHMqMC4wLjBcXFxccyokJztcbi8vIGZvcmsgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vb3JpZ2luanMvdml0ZS1wbHVnaW4tZmVkZXJhdGlvbi9ibG9iL3YxLjEuMTIvcGFja2FnZXMvbGliL3NyYy91dGlscy9zZW12ZXIvaW5kZXgudHNcbi8vIENvcHlyaWdodCAoYylcbi8vIHZpdGUtcGx1Z2luLWZlZGVyYXRpb24gaXMgbGljZW5zZWQgdW5kZXIgTXVsYW4gUFNMIHYyLlxuLy8gWW91IGNhbiB1c2UgdGhpcyBzb2Z0d2FyZSBhY2NvcmRpbmcgdG8gdGhlIHRlcm1zIGFuZCBjb25kaXRpb25zIG9mIHRoZSBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgTXVsYW4gUFNMIHYyIGF0OlxuLy8gICAgICBodHRwOi8vbGljZW5zZS5jb3NjbC5vcmcuY24vTXVsYW5QU0wyXG4vLyBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIE9OIEFOIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9GIEFOWSBLSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIE5PTi1JTkZSSU5HRU1FTlQsIE1FUkNIQU5UQUJJTElUWSBPUiBGSVQgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLlxuLy8gU2VlIHRoZSBNdWxhbiBQU0wgdjIgZm9yIG1vcmUgZGV0YWlscy5cbmZ1bmN0aW9uIHBhcnNlUmVnZXgoc291cmNlKSB7XG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoc291cmNlKTtcbn1cbmZ1bmN0aW9uIGlzWFZlcnNpb24odmVyc2lvbikge1xuICAgIHJldHVybiAhdmVyc2lvbiB8fCB2ZXJzaW9uLnRvTG93ZXJDYXNlKCkgPT09ICd4JyB8fCB2ZXJzaW9uID09PSAnKic7XG59XG5mdW5jdGlvbiBwaXBlKC4uLmZucykge1xuICAgIHJldHVybiAoeCk9PmZucy5yZWR1Y2UoKHYsIGYpPT5mKHYpLCB4KTtcbn1cbmZ1bmN0aW9uIGV4dHJhY3RDb21wYXJhdG9yKGNvbXBhcmF0b3JTdHJpbmcpIHtcbiAgICByZXR1cm4gY29tcGFyYXRvclN0cmluZy5tYXRjaChwYXJzZVJlZ2V4KGNvbXBhcmF0b3IpKTtcbn1cbmZ1bmN0aW9uIGNvbWJpbmVWZXJzaW9uKG1ham9yLCBtaW5vciwgcGF0Y2gsIHByZVJlbGVhc2UpIHtcbiAgICB2YXIgbWFpblZlcnNpb24gPSBgJHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH1gO1xuICAgIGlmIChwcmVSZWxlYXNlKSB7XG4gICAgICAgIHJldHVybiBgJHttYWluVmVyc2lvbn0tJHtwcmVSZWxlYXNlfWA7XG4gICAgfVxuICAgIHJldHVybiBtYWluVmVyc2lvbjtcbn1cbi8vIGZvcmsgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vb3JpZ2luanMvdml0ZS1wbHVnaW4tZmVkZXJhdGlvbi9ibG9iL3YxLjEuMTIvcGFja2FnZXMvbGliL3NyYy91dGlscy9zZW12ZXIvaW5kZXgudHNcbi8vIENvcHlyaWdodCAoYylcbi8vIHZpdGUtcGx1Z2luLWZlZGVyYXRpb24gaXMgbGljZW5zZWQgdW5kZXIgTXVsYW4gUFNMIHYyLlxuLy8gWW91IGNhbiB1c2UgdGhpcyBzb2Z0d2FyZSBhY2NvcmRpbmcgdG8gdGhlIHRlcm1zIGFuZCBjb25kaXRpb25zIG9mIHRoZSBNdWxhbiBQU0wgdjIuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgTXVsYW4gUFNMIHYyIGF0OlxuLy8gICAgICBodHRwOi8vbGljZW5zZS5jb3NjbC5vcmcuY24vTXVsYW5QU0wyXG4vLyBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIE9OIEFOIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9GIEFOWSBLSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIE5PTi1JTkZSSU5HRU1FTlQsIE1FUkNIQU5UQUJJTElUWSBPUiBGSVQgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLlxuLy8gU2VlIHRoZSBNdWxhbiBQU0wgdjIgZm9yIG1vcmUgZGV0YWlscy5cbmZ1bmN0aW9uIHBhcnNlSHlwaGVuKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnJlcGxhY2UocGFyc2VSZWdleChoeXBoZW5SYW5nZSksIChfcmFuZ2UsIGZyb20sIGZyb21NYWpvciwgZnJvbU1pbm9yLCBmcm9tUGF0Y2gsIF9mcm9tUHJlUmVsZWFzZSwgX2Zyb21CdWlsZCwgdG8sIHRvTWFqb3IsIHRvTWlub3IsIHRvUGF0Y2gsIHRvUHJlUmVsZWFzZSk9PntcbiAgICAgICAgaWYgKGlzWFZlcnNpb24oZnJvbU1ham9yKSkge1xuICAgICAgICAgICAgZnJvbSA9ICcnO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24oZnJvbU1pbm9yKSkge1xuICAgICAgICAgICAgZnJvbSA9IGA+PSR7ZnJvbU1ham9yfS4wLjBgO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24oZnJvbVBhdGNoKSkge1xuICAgICAgICAgICAgZnJvbSA9IGA+PSR7ZnJvbU1ham9yfS4ke2Zyb21NaW5vcn0uMGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmcm9tID0gYD49JHtmcm9tfWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzWFZlcnNpb24odG9NYWpvcikpIHtcbiAgICAgICAgICAgIHRvID0gJyc7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbih0b01pbm9yKSkge1xuICAgICAgICAgICAgdG8gPSBgPCR7TnVtYmVyKHRvTWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICB9IGVsc2UgaWYgKGlzWFZlcnNpb24odG9QYXRjaCkpIHtcbiAgICAgICAgICAgIHRvID0gYDwke3RvTWFqb3J9LiR7TnVtYmVyKHRvTWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgfSBlbHNlIGlmICh0b1ByZVJlbGVhc2UpIHtcbiAgICAgICAgICAgIHRvID0gYDw9JHt0b01ham9yfS4ke3RvTWlub3J9LiR7dG9QYXRjaH0tJHt0b1ByZVJlbGVhc2V9YDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRvID0gYDw9JHt0b31gO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgJHtmcm9tfSAke3RvfWAudHJpbSgpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VDb21wYXJhdG9yVHJpbShyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS5yZXBsYWNlKHBhcnNlUmVnZXgoY29tcGFyYXRvclRyaW0pLCAnJDEkMiQzJyk7XG59XG5mdW5jdGlvbiBwYXJzZVRpbGRlVHJpbShyYW5nZSkge1xuICAgIHJldHVybiByYW5nZS5yZXBsYWNlKHBhcnNlUmVnZXgodGlsZGVUcmltKSwgJyQxficpO1xufVxuZnVuY3Rpb24gcGFyc2VDYXJldFRyaW0ocmFuZ2UpIHtcbiAgICByZXR1cm4gcmFuZ2UucmVwbGFjZShwYXJzZVJlZ2V4KGNhcmV0VHJpbSksICckMV4nKTtcbn1cbmZ1bmN0aW9uIHBhcnNlQ2FyZXRzKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnRyaW0oKS5zcGxpdCgvXFxzKy8pLm1hcCgocmFuZ2VWZXJzaW9uKT0+cmFuZ2VWZXJzaW9uLnJlcGxhY2UocGFyc2VSZWdleChjYXJldCksIChfLCBtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKT0+e1xuICAgICAgICAgICAgaWYgKGlzWFZlcnNpb24obWFqb3IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKG1pbm9yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4wLjAgPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbihwYXRjaCkpIHtcbiAgICAgICAgICAgICAgICBpZiAobWFqb3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCA8JHtOdW1iZXIobWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlUmVsZWFzZSkge1xuICAgICAgICAgICAgICAgIGlmIChtYWpvciA9PT0gJzAnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtaW5vciA9PT0gJzAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0tJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHttaW5vcn0uJHtOdW1iZXIocGF0Y2gpICsgMX0tMGA7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0tJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofS0ke3ByZVJlbGVhc2V9IDwke051bWJlcihtYWpvcikgKyAxfS4wLjAtMGA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAobWFqb3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWlub3IgPT09ICcwJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9IDwke21ham9yfS4ke21pbm9yfS4ke051bWJlcihwYXRjaCkgKyAxfS0wYDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0gPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLmpvaW4oJyAnKTtcbn1cbmZ1bmN0aW9uIHBhcnNlVGlsZGVzKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnRyaW0oKS5zcGxpdCgvXFxzKy8pLm1hcCgocmFuZ2VWZXJzaW9uKT0+cmFuZ2VWZXJzaW9uLnJlcGxhY2UocGFyc2VSZWdleCh0aWxkZSksIChfLCBtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKT0+e1xuICAgICAgICAgICAgaWYgKGlzWFZlcnNpb24obWFqb3IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1hWZXJzaW9uKG1pbm9yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4wLjAgPCR7TnVtYmVyKG1ham9yKSArIDF9LjAuMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYVmVyc2lvbihwYXRjaCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uJHttaW5vcn0uMCA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlUmVsZWFzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4ke3BhdGNofS0ke3ByZVJlbGVhc2V9IDwke21ham9yfS4ke051bWJlcihtaW5vcikgKyAxfS4wLTBgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGA+PSR7bWFqb3J9LiR7bWlub3J9LiR7cGF0Y2h9IDwke21ham9yfS4ke051bWJlcihtaW5vcikgKyAxfS4wLTBgO1xuICAgICAgICB9KSkuam9pbignICcpO1xufVxuZnVuY3Rpb24gcGFyc2VYUmFuZ2VzKHJhbmdlKSB7XG4gICAgcmV0dXJuIHJhbmdlLnNwbGl0KC9cXHMrLykubWFwKChyYW5nZVZlcnNpb24pPT5yYW5nZVZlcnNpb24udHJpbSgpLnJlcGxhY2UocGFyc2VSZWdleCh4UmFuZ2UpLCAocmV0LCBndGx0LCBtYWpvciwgbWlub3IsIHBhdGNoLCBwcmVSZWxlYXNlKT0+e1xuICAgICAgICAgICAgdmFyIGlzWE1ham9yID0gaXNYVmVyc2lvbihtYWpvcik7XG4gICAgICAgICAgICB2YXIgaXNYTWlub3IgPSBpc1hNYWpvciB8fCBpc1hWZXJzaW9uKG1pbm9yKTtcbiAgICAgICAgICAgIHZhciBpc1hQYXRjaCA9IGlzWE1pbm9yIHx8IGlzWFZlcnNpb24ocGF0Y2gpO1xuICAgICAgICAgICAgaWYgKGd0bHQgPT09ICc9JyAmJiBpc1hQYXRjaCkge1xuICAgICAgICAgICAgICAgIGd0bHQgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByZVJlbGVhc2UgPSAnJztcbiAgICAgICAgICAgIGlmIChpc1hNYWpvcikge1xuICAgICAgICAgICAgICAgIGlmIChndGx0ID09PSAnPicgfHwgZ3RsdCA9PT0gJzwnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdGhpbmcgaXMgYWxsb3dlZFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzwwLjAuMC0wJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBub3RoaW5nIGlzIGZvcmJpZGRlblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyonO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3RsdCAmJiBpc1hQYXRjaCkge1xuICAgICAgICAgICAgICAgIC8vIHJlcGxhY2UgWCB3aXRoIDBcbiAgICAgICAgICAgICAgICBpZiAoaXNYTWlub3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbWlub3IgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwYXRjaCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKGd0bHQgPT09ICc+Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyA+MSA9PiA+PTIuMC4wXG4gICAgICAgICAgICAgICAgICAgIC8vID4xLjIgPT4gPj0xLjMuMFxuICAgICAgICAgICAgICAgICAgICBndGx0ID0gJz49JztcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzWE1pbm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWpvciA9IE51bWJlcihtYWpvcikgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWlub3IgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0Y2ggPSAwO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWlub3IgPSBOdW1iZXIobWlub3IpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3RsdCA9PT0gJzw9Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyA8PTAuNy54IGlzIGFjdHVhbGx5IDwwLjguMCwgc2luY2UgYW55IDAuNy54IHNob3VsZCBwYXNzXG4gICAgICAgICAgICAgICAgICAgIC8vIFNpbWlsYXJseSwgPD03LnggaXMgYWN0dWFsbHkgPDguMC4wLCBldGMuXG4gICAgICAgICAgICAgICAgICAgIGd0bHQgPSAnPCc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1hNaW5vcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFqb3IgPSBOdW1iZXIobWFqb3IpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbm9yID0gTnVtYmVyKG1pbm9yKSArIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGd0bHQgPT09ICc8Jykge1xuICAgICAgICAgICAgICAgICAgICBwcmVSZWxlYXNlID0gJy0wJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke2d0bHQgKyBtYWpvcn0uJHttaW5vcn0uJHtwYXRjaH0ke3ByZVJlbGVhc2V9YDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNYTWlub3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD49JHttYWpvcn0uMC4wJHtwcmVSZWxlYXNlfSA8JHtOdW1iZXIobWFqb3IpICsgMX0uMC4wLTBgO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc1hQYXRjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgPj0ke21ham9yfS4ke21pbm9yfS4wJHtwcmVSZWxlYXNlfSA8JHttYWpvcn0uJHtOdW1iZXIobWlub3IpICsgMX0uMC0wYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH0pKS5qb2luKCcgJyk7XG59XG5mdW5jdGlvbiBwYXJzZVN0YXIocmFuZ2UpIHtcbiAgICByZXR1cm4gcmFuZ2UudHJpbSgpLnJlcGxhY2UocGFyc2VSZWdleChzdGFyKSwgJycpO1xufVxuZnVuY3Rpb24gcGFyc2VHVEUwKGNvbXBhcmF0b3JTdHJpbmcpIHtcbiAgICByZXR1cm4gY29tcGFyYXRvclN0cmluZy50cmltKCkucmVwbGFjZShwYXJzZVJlZ2V4KGd0ZTApLCAnJyk7XG59XG4vLyBmb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL29yaWdpbmpzL3ZpdGUtcGx1Z2luLWZlZGVyYXRpb24vYmxvYi92MS4xLjEyL3BhY2thZ2VzL2xpYi9zcmMvdXRpbHMvc2VtdmVyL2luZGV4LnRzXG4vLyBDb3B5cmlnaHQgKGMpXG4vLyB2aXRlLXBsdWdpbi1mZWRlcmF0aW9uIGlzIGxpY2Vuc2VkIHVuZGVyIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBjYW4gdXNlIHRoaXMgc29mdHdhcmUgYWNjb3JkaW5nIHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgTXVsYW4gUFNMIHYyLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIE11bGFuIFBTTCB2MiBhdDpcbi8vICAgICAgaHR0cDovL2xpY2Vuc2UuY29zY2wub3JnLmNuL011bGFuUFNMMlxuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBOT04tSU5GUklOR0VNRU5ULCBNRVJDSEFOVEFCSUxJVFkgT1IgRklUIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cbi8vIFNlZSB0aGUgTXVsYW4gUFNMIHYyIGZvciBtb3JlIGRldGFpbHMuXG5mdW5jdGlvbiBjb21wYXJlQXRvbShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB7XG4gICAgcmFuZ2VBdG9tID0gTnVtYmVyKHJhbmdlQXRvbSkgfHwgcmFuZ2VBdG9tO1xuICAgIHZlcnNpb25BdG9tID0gTnVtYmVyKHZlcnNpb25BdG9tKSB8fCB2ZXJzaW9uQXRvbTtcbiAgICBpZiAocmFuZ2VBdG9tID4gdmVyc2lvbkF0b20pIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGlmIChyYW5nZUF0b20gPT09IHZlcnNpb25BdG9tKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gLTE7XG59XG5mdW5jdGlvbiBjb21wYXJlUHJlUmVsZWFzZShyYW5nZUF0b20sIHZlcnNpb25BdG9tKSB7XG4gICAgdmFyIHJhbmdlUHJlUmVsZWFzZSA9IHJhbmdlQXRvbS5wcmVSZWxlYXNlO1xuICAgIHZhciB2ZXJzaW9uUHJlUmVsZWFzZSA9IHZlcnNpb25BdG9tLnByZVJlbGVhc2U7XG4gICAgaWYgKHJhbmdlUHJlUmVsZWFzZSA9PT0gdW5kZWZpbmVkICYmIEJvb2xlYW4odmVyc2lvblByZVJlbGVhc2UpKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBpZiAoQm9vbGVhbihyYW5nZVByZVJlbGVhc2UpICYmIHZlcnNpb25QcmVSZWxlYXNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpZiAocmFuZ2VQcmVSZWxlYXNlID09PSB1bmRlZmluZWQgJiYgdmVyc2lvblByZVJlbGVhc2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgZm9yKHZhciBpID0gMCwgbiA9IHJhbmdlUHJlUmVsZWFzZS5sZW5ndGg7IGkgPD0gbjsgaSsrKXtcbiAgICAgICAgdmFyIHJhbmdlRWxlbWVudCA9IHJhbmdlUHJlUmVsZWFzZVtpXTtcbiAgICAgICAgdmFyIHZlcnNpb25FbGVtZW50ID0gdmVyc2lvblByZVJlbGVhc2VbaV07XG4gICAgICAgIGlmIChyYW5nZUVsZW1lbnQgPT09IHZlcnNpb25FbGVtZW50KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmFuZ2VFbGVtZW50ID09PSB1bmRlZmluZWQgJiYgdmVyc2lvbkVsZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyYW5nZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmVyc2lvbkVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29tcGFyZUF0b20ocmFuZ2VFbGVtZW50LCB2ZXJzaW9uRWxlbWVudCk7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuZnVuY3Rpb24gY29tcGFyZVZlcnNpb24ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkge1xuICAgIHJldHVybiBjb21wYXJlQXRvbShyYW5nZUF0b20ubWFqb3IsIHZlcnNpb25BdG9tLm1ham9yKSB8fCBjb21wYXJlQXRvbShyYW5nZUF0b20ubWlub3IsIHZlcnNpb25BdG9tLm1pbm9yKSB8fCBjb21wYXJlQXRvbShyYW5nZUF0b20ucGF0Y2gsIHZlcnNpb25BdG9tLnBhdGNoKSB8fCBjb21wYXJlUHJlUmVsZWFzZShyYW5nZUF0b20sIHZlcnNpb25BdG9tKTtcbn1cbmZ1bmN0aW9uIGVxKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHtcbiAgICByZXR1cm4gcmFuZ2VBdG9tLnZlcnNpb24gPT09IHZlcnNpb25BdG9tLnZlcnNpb247XG59XG5mdW5jdGlvbiBjb21wYXJlKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHtcbiAgICBzd2l0Y2gocmFuZ2VBdG9tLm9wZXJhdG9yKXtcbiAgICAgICAgY2FzZSAnJzpcbiAgICAgICAgY2FzZSAnPSc6XG4gICAgICAgICAgICByZXR1cm4gZXEocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSk7XG4gICAgICAgIGNhc2UgJz4nOlxuICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIDwgMDtcbiAgICAgICAgY2FzZSAnPj0nOlxuICAgICAgICAgICAgcmV0dXJuIGVxKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIHx8IGNvbXBhcmVWZXJzaW9uKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pIDwgMDtcbiAgICAgICAgY2FzZSAnPCc6XG4gICAgICAgICAgICByZXR1cm4gY29tcGFyZVZlcnNpb24ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkgPiAwO1xuICAgICAgICBjYXNlICc8PSc6XG4gICAgICAgICAgICByZXR1cm4gZXEocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkgfHwgY29tcGFyZVZlcnNpb24ocmFuZ2VBdG9tLCB2ZXJzaW9uQXRvbSkgPiAwO1xuICAgICAgICBjYXNlIHVuZGVmaW5lZDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBtZWFuICogb3IgeCAtPiBhbGwgdmVyc2lvbnNcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG4vLyBmb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL29yaWdpbmpzL3ZpdGUtcGx1Z2luLWZlZGVyYXRpb24vYmxvYi92MS4xLjEyL3BhY2thZ2VzL2xpYi9zcmMvdXRpbHMvc2VtdmVyL2luZGV4LnRzXG4vLyBDb3B5cmlnaHQgKGMpXG4vLyB2aXRlLXBsdWdpbi1mZWRlcmF0aW9uIGlzIGxpY2Vuc2VkIHVuZGVyIE11bGFuIFBTTCB2Mi5cbi8vIFlvdSBjYW4gdXNlIHRoaXMgc29mdHdhcmUgYWNjb3JkaW5nIHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB0aGUgTXVsYW4gUFNMIHYyLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIE11bGFuIFBTTCB2MiBhdDpcbi8vICAgICAgaHR0cDovL2xpY2Vuc2UuY29zY2wub3JnLmNuL011bGFuUFNMMlxuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBOT04tSU5GUklOR0VNRU5ULCBNRVJDSEFOVEFCSUxJVFkgT1IgRklUIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cbi8vIFNlZSB0aGUgTXVsYW4gUFNMIHYyIGZvciBtb3JlIGRldGFpbHMuXG5mdW5jdGlvbiBwYXJzZUNvbXBhcmF0b3JTdHJpbmcocmFuZ2UpIHtcbiAgICByZXR1cm4gcGlwZSgvLyBeIC0tPiAqIChhbnksIGtpbmRhIHNpbGx5KVxuICAgIC8vIF4yLCBeMi54LCBeMi54LnggLS0+ID49Mi4wLjAgPDMuMC4wLTBcbiAgICAvLyBeMi4wLCBeMi4wLnggLS0+ID49Mi4wLjAgPDMuMC4wLTBcbiAgICAvLyBeMS4yLCBeMS4yLnggLS0+ID49MS4yLjAgPDIuMC4wLTBcbiAgICAvLyBeMS4yLjMgLS0+ID49MS4yLjMgPDIuMC4wLTBcbiAgICAvLyBeMS4yLjAgLS0+ID49MS4yLjAgPDIuMC4wLTBcbiAgICBwYXJzZUNhcmV0cywgLy8gfiwgfj4gLS0+ICogKGFueSwga2luZGEgc2lsbHkpXG4gICAgLy8gfjIsIH4yLngsIH4yLngueCwgfj4yLCB+PjIueCB+PjIueC54IC0tPiA+PTIuMC4wIDwzLjAuMC0wXG4gICAgLy8gfjIuMCwgfjIuMC54LCB+PjIuMCwgfj4yLjAueCAtLT4gPj0yLjAuMCA8Mi4xLjAtMFxuICAgIC8vIH4xLjIsIH4xLjIueCwgfj4xLjIsIH4+MS4yLnggLS0+ID49MS4yLjAgPDEuMy4wLTBcbiAgICAvLyB+MS4yLjMsIH4+MS4yLjMgLS0+ID49MS4yLjMgPDEuMy4wLTBcbiAgICAvLyB+MS4yLjAsIH4+MS4yLjAgLS0+ID49MS4yLjAgPDEuMy4wLTBcbiAgICBwYXJzZVRpbGRlcywgcGFyc2VYUmFuZ2VzLCBwYXJzZVN0YXIpKHJhbmdlKTtcbn1cbmZ1bmN0aW9uIHBhcnNlUmFuZ2UocmFuZ2UpIHtcbiAgICByZXR1cm4gcGlwZSgvLyBgMS4yLjMgLSAxLjIuNGAgPT4gYD49MS4yLjMgPD0xLjIuNGBcbiAgICBwYXJzZUh5cGhlbiwgLy8gYD4gMS4yLjMgPCAxLjIuNWAgPT4gYD4xLjIuMyA8MS4yLjVgXG4gICAgcGFyc2VDb21wYXJhdG9yVHJpbSwgLy8gYH4gMS4yLjNgID0+IGB+MS4yLjNgXG4gICAgcGFyc2VUaWxkZVRyaW0sIC8vIGBeIDEuMi4zYCA9PiBgXjEuMi4zYFxuICAgIHBhcnNlQ2FyZXRUcmltKShyYW5nZS50cmltKCkpLnNwbGl0KC9cXHMrLykuam9pbignICcpO1xufVxuZnVuY3Rpb24gc2F0aXNmeSh2ZXJzaW9uLCByYW5nZSkge1xuICAgIGlmICghdmVyc2lvbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBwYXJzZWRSYW5nZSA9IHBhcnNlUmFuZ2UocmFuZ2UpO1xuICAgIHZhciBwYXJzZWRDb21wYXJhdG9yID0gcGFyc2VkUmFuZ2Uuc3BsaXQoJyAnKS5tYXAoKHJhbmdlVmVyc2lvbik9PnBhcnNlQ29tcGFyYXRvclN0cmluZyhyYW5nZVZlcnNpb24pKS5qb2luKCcgJyk7XG4gICAgdmFyIGNvbXBhcmF0b3JzID0gcGFyc2VkQ29tcGFyYXRvci5zcGxpdCgvXFxzKy8pLm1hcCgoY29tcGFyYXRvcik9PnBhcnNlR1RFMChjb21wYXJhdG9yKSk7XG4gICAgdmFyIGV4dHJhY3RlZFZlcnNpb24gPSBleHRyYWN0Q29tcGFyYXRvcih2ZXJzaW9uKTtcbiAgICBpZiAoIWV4dHJhY3RlZFZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgX2V4dHJhY3RlZFZlcnNpb24gPSBfc2xpY2VkX3RvX2FycmF5Ll8oZXh0cmFjdGVkVmVyc2lvbiwgNyksIHZlcnNpb25PcGVyYXRvciA9IF9leHRyYWN0ZWRWZXJzaW9uWzFdLCB2ZXJzaW9uTWFqb3IgPSBfZXh0cmFjdGVkVmVyc2lvblszXSwgdmVyc2lvbk1pbm9yID0gX2V4dHJhY3RlZFZlcnNpb25bNF0sIHZlcnNpb25QYXRjaCA9IF9leHRyYWN0ZWRWZXJzaW9uWzVdLCB2ZXJzaW9uUHJlUmVsZWFzZSA9IF9leHRyYWN0ZWRWZXJzaW9uWzZdO1xuICAgIHZhciB2ZXJzaW9uQXRvbSA9IHtcbiAgICAgICAgb3BlcmF0b3I6IHZlcnNpb25PcGVyYXRvcixcbiAgICAgICAgdmVyc2lvbjogY29tYmluZVZlcnNpb24odmVyc2lvbk1ham9yLCB2ZXJzaW9uTWlub3IsIHZlcnNpb25QYXRjaCwgdmVyc2lvblByZVJlbGVhc2UpLFxuICAgICAgICBtYWpvcjogdmVyc2lvbk1ham9yLFxuICAgICAgICBtaW5vcjogdmVyc2lvbk1pbm9yLFxuICAgICAgICBwYXRjaDogdmVyc2lvblBhdGNoLFxuICAgICAgICBwcmVSZWxlYXNlOiB2ZXJzaW9uUHJlUmVsZWFzZSA9PSBudWxsID8gdm9pZCAwIDogdmVyc2lvblByZVJlbGVhc2Uuc3BsaXQoJy4nKVxuICAgIH07XG4gICAgZm9yICh2YXIgY29tcGFyYXRvciBvZiBjb21wYXJhdG9ycyl7XG4gICAgICAgIHZhciBleHRyYWN0ZWRDb21wYXJhdG9yID0gZXh0cmFjdENvbXBhcmF0b3IoY29tcGFyYXRvcik7XG4gICAgICAgIGlmICghZXh0cmFjdGVkQ29tcGFyYXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBfZXh0cmFjdGVkQ29tcGFyYXRvciA9IF9zbGljZWRfdG9fYXJyYXkuXyhleHRyYWN0ZWRDb21wYXJhdG9yLCA3KSwgcmFuZ2VPcGVyYXRvciA9IF9leHRyYWN0ZWRDb21wYXJhdG9yWzFdLCByYW5nZU1ham9yID0gX2V4dHJhY3RlZENvbXBhcmF0b3JbM10sIHJhbmdlTWlub3IgPSBfZXh0cmFjdGVkQ29tcGFyYXRvcls0XSwgcmFuZ2VQYXRjaCA9IF9leHRyYWN0ZWRDb21wYXJhdG9yWzVdLCByYW5nZVByZVJlbGVhc2UgPSBfZXh0cmFjdGVkQ29tcGFyYXRvcls2XTtcbiAgICAgICAgdmFyIHJhbmdlQXRvbSA9IHtcbiAgICAgICAgICAgIG9wZXJhdG9yOiByYW5nZU9wZXJhdG9yLFxuICAgICAgICAgICAgdmVyc2lvbjogY29tYmluZVZlcnNpb24ocmFuZ2VNYWpvciwgcmFuZ2VNaW5vciwgcmFuZ2VQYXRjaCwgcmFuZ2VQcmVSZWxlYXNlKSxcbiAgICAgICAgICAgIG1ham9yOiByYW5nZU1ham9yLFxuICAgICAgICAgICAgbWlub3I6IHJhbmdlTWlub3IsXG4gICAgICAgICAgICBwYXRjaDogcmFuZ2VQYXRjaCxcbiAgICAgICAgICAgIHByZVJlbGVhc2U6IHJhbmdlUHJlUmVsZWFzZSA9PSBudWxsID8gdm9pZCAwIDogcmFuZ2VQcmVSZWxlYXNlLnNwbGl0KCcuJylcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCFjb21wYXJlKHJhbmdlQXRvbSwgdmVyc2lvbkF0b20pKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIGVhcmx5IHJldHVyblxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gZm9ybWF0U2hhcmUoc2hhcmVBcmdzLCBmcm9tLCBuYW1lMSwgc2hhcmVTdHJhdGVneSkge1xuICAgIHZhciBnZXQ7XG4gICAgaWYgKCdnZXQnIGluIHNoYXJlQXJncykge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWRlc3RydWN0dXJpbmdcbiAgICAgICAgZ2V0ID0gc2hhcmVBcmdzLmdldDtcbiAgICB9IGVsc2UgaWYgKCdsaWInIGluIHNoYXJlQXJncykge1xuICAgICAgICBnZXQgPSAoKT0+UHJvbWlzZS5yZXNvbHZlKHNoYXJlQXJncy5saWIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGdldCA9ICgpPT5Qcm9taXNlLnJlc29sdmUoKCk9PntcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbiBub3QgZ2V0IHNoYXJlZCAnJHtuYW1lMX0nIWApO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChzaGFyZUFyZ3Muc3RyYXRlZ3kpIHtcbiAgICAgICAgd2FybihgXCJzaGFyZWQuc3RyYXRlZ3kgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHNldCBpbiBpbml0T3B0aW9ucy5zaGFyZVN0cmF0ZWd5IGluc3RlYWQhXCJgKTtcbiAgICB9XG4gICAgdmFyIF9zaGFyZUFyZ3NfdmVyc2lvbiwgX3NoYXJlQXJnc19zY29wZSwgX3NoYXJlQXJnc19zdHJhdGVneTtcbiAgICByZXR1cm4gcG9seWZpbGxzLl9leHRlbmRzKHtcbiAgICAgICAgZGVwczogW10sXG4gICAgICAgIHVzZUluOiBbXSxcbiAgICAgICAgZnJvbSxcbiAgICAgICAgbG9hZGluZzogbnVsbFxuICAgIH0sIHNoYXJlQXJncywge1xuICAgICAgICBzaGFyZUNvbmZpZzogcG9seWZpbGxzLl9leHRlbmRzKHtcbiAgICAgICAgICAgIHJlcXVpcmVkVmVyc2lvbjogYF4ke3NoYXJlQXJncy52ZXJzaW9ufWAsXG4gICAgICAgICAgICBzaW5nbGV0b246IGZhbHNlLFxuICAgICAgICAgICAgZWFnZXI6IGZhbHNlLFxuICAgICAgICAgICAgc3RyaWN0VmVyc2lvbjogZmFsc2VcbiAgICAgICAgfSwgc2hhcmVBcmdzLnNoYXJlQ29uZmlnKSxcbiAgICAgICAgZ2V0LFxuICAgICAgICBsb2FkZWQ6IChzaGFyZUFyZ3MgPT0gbnVsbCA/IHZvaWQgMCA6IHNoYXJlQXJncy5sb2FkZWQpIHx8ICdsaWInIGluIHNoYXJlQXJncyA/IHRydWUgOiB1bmRlZmluZWQsXG4gICAgICAgIHZlcnNpb246IChfc2hhcmVBcmdzX3ZlcnNpb24gPSBzaGFyZUFyZ3MudmVyc2lvbikgIT0gbnVsbCA/IF9zaGFyZUFyZ3NfdmVyc2lvbiA6ICcwJyxcbiAgICAgICAgc2NvcGU6IEFycmF5LmlzQXJyYXkoc2hhcmVBcmdzLnNjb3BlKSA/IHNoYXJlQXJncy5zY29wZSA6IFtcbiAgICAgICAgICAgIChfc2hhcmVBcmdzX3Njb3BlID0gc2hhcmVBcmdzLnNjb3BlKSAhPSBudWxsID8gX3NoYXJlQXJnc19zY29wZSA6ICdkZWZhdWx0J1xuICAgICAgICBdLFxuICAgICAgICBzdHJhdGVneTogKChfc2hhcmVBcmdzX3N0cmF0ZWd5ID0gc2hhcmVBcmdzLnN0cmF0ZWd5KSAhPSBudWxsID8gX3NoYXJlQXJnc19zdHJhdGVneSA6IHNoYXJlU3RyYXRlZ3kpIHx8ICd2ZXJzaW9uLWZpcnN0J1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZm9ybWF0U2hhcmVDb25maWdzKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKSB7XG4gICAgdmFyIHNoYXJlQXJncyA9IHVzZXJPcHRpb25zLnNoYXJlZCB8fCB7fTtcbiAgICB2YXIgZnJvbSA9IHVzZXJPcHRpb25zLm5hbWU7XG4gICAgdmFyIHNoYXJlSW5mb3MgPSBPYmplY3Qua2V5cyhzaGFyZUFyZ3MpLnJlZHVjZSgocmVzLCBwa2dOYW1lKT0+e1xuICAgICAgICB2YXIgYXJyYXlTaGFyZUFyZ3MgPSBhcnJheU9wdGlvbnMoc2hhcmVBcmdzW3BrZ05hbWVdKTtcbiAgICAgICAgcmVzW3BrZ05hbWVdID0gcmVzW3BrZ05hbWVdIHx8IFtdO1xuICAgICAgICBhcnJheVNoYXJlQXJncy5mb3JFYWNoKChzaGFyZUNvbmZpZyk9PntcbiAgICAgICAgICAgIHJlc1twa2dOYW1lXS5wdXNoKGZvcm1hdFNoYXJlKHNoYXJlQ29uZmlnLCBmcm9tLCBwa2dOYW1lLCB1c2VyT3B0aW9ucy5zaGFyZVN0cmF0ZWd5KSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH0sIHt9KTtcbiAgICB2YXIgc2hhcmVkID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBnbG9iYWxPcHRpb25zLnNoYXJlZCk7XG4gICAgT2JqZWN0LmtleXMoc2hhcmVJbmZvcykuZm9yRWFjaCgoc2hhcmVLZXkpPT57XG4gICAgICAgIGlmICghc2hhcmVkW3NoYXJlS2V5XSkge1xuICAgICAgICAgICAgc2hhcmVkW3NoYXJlS2V5XSA9IHNoYXJlSW5mb3Nbc2hhcmVLZXldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2hhcmVJbmZvc1tzaGFyZUtleV0uZm9yRWFjaCgobmV3VXNlclNoYXJlZE9wdGlvbnMpPT57XG4gICAgICAgICAgICAgICAgdmFyIGlzU2FtZVZlcnNpb24gPSBzaGFyZWRbc2hhcmVLZXldLmZpbmQoKHNoYXJlZFZhbCk9PnNoYXJlZFZhbC52ZXJzaW9uID09PSBuZXdVc2VyU2hhcmVkT3B0aW9ucy52ZXJzaW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzU2FtZVZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkW3NoYXJlS2V5XS5wdXNoKG5ld1VzZXJTaGFyZWRPcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIHNoYXJlZCxcbiAgICAgICAgc2hhcmVJbmZvc1xuICAgIH07XG59XG5mdW5jdGlvbiB2ZXJzaW9uTHQoYSwgYikge1xuICAgIHZhciB0cmFuc2Zvcm1JbnZhbGlkVmVyc2lvbiA9ICh2ZXJzaW9uKT0+e1xuICAgICAgICB2YXIgaXNOdW1iZXJWZXJzaW9uID0gIU51bWJlci5pc05hTihOdW1iZXIodmVyc2lvbikpO1xuICAgICAgICBpZiAoaXNOdW1iZXJWZXJzaW9uKSB7XG4gICAgICAgICAgICB2YXIgc3BsaXRBcnIgPSB2ZXJzaW9uLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICB2YXIgdmFsaWRWZXJzaW9uID0gdmVyc2lvbjtcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCAzIC0gc3BsaXRBcnIubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgIHZhbGlkVmVyc2lvbiArPSAnLjAnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbGlkVmVyc2lvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmVyc2lvbjtcbiAgICB9O1xuICAgIGlmIChzYXRpc2Z5KHRyYW5zZm9ybUludmFsaWRWZXJzaW9uKGEpLCBgPD0ke3RyYW5zZm9ybUludmFsaWRWZXJzaW9uKGIpfWApKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG52YXIgZmluZFZlcnNpb24gPSAoc2hhcmVWZXJzaW9uTWFwLCBjYik9PntcbiAgICB2YXIgY2FsbGJhY2sgPSBjYiB8fCBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgcmV0dXJuIHZlcnNpb25MdChwcmV2LCBjdXIpO1xuICAgIH07XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHNoYXJlVmVyc2lvbk1hcCkucmVkdWNlKChwcmV2LCBjdXIpPT57XG4gICAgICAgIGlmICghcHJldikge1xuICAgICAgICAgICAgcmV0dXJuIGN1cjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FsbGJhY2socHJldiwgY3VyKSkge1xuICAgICAgICAgICAgcmV0dXJuIGN1cjtcbiAgICAgICAgfVxuICAgICAgICAvLyBkZWZhdWx0IHZlcnNpb24gaXMgJzAnIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJwYWNrL3dlYnBhY2svYmxvYi9tYWluL2xpYi9zaGFyaW5nL1Byb3ZpZGVTaGFyZWRNb2R1bGUuanMjTDEzNlxuICAgICAgICBpZiAocHJldiA9PT0gJzAnKSB7XG4gICAgICAgICAgICByZXR1cm4gY3VyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmV2O1xuICAgIH0sIDApO1xufTtcbnZhciBpc0xvYWRlZCA9IChzaGFyZWQpPT57XG4gICAgcmV0dXJuIEJvb2xlYW4oc2hhcmVkLmxvYWRlZCkgfHwgdHlwZW9mIHNoYXJlZC5saWIgPT09ICdmdW5jdGlvbic7XG59O1xudmFyIGlzTG9hZGluZyA9IChzaGFyZWQpPT57XG4gICAgcmV0dXJuIEJvb2xlYW4oc2hhcmVkLmxvYWRpbmcpO1xufTtcbmZ1bmN0aW9uIGZpbmRTaW5nbGV0b25WZXJzaW9uT3JkZXJCeVZlcnNpb24oc2hhcmVTY29wZU1hcCwgc2NvcGUsIHBrZ05hbWUpIHtcbiAgICB2YXIgdmVyc2lvbnMgPSBzaGFyZVNjb3BlTWFwW3Njb3BlXVtwa2dOYW1lXTtcbiAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgcmV0dXJuICFpc0xvYWRlZCh2ZXJzaW9uc1twcmV2XSkgJiYgdmVyc2lvbkx0KHByZXYsIGN1cik7XG4gICAgfTtcbiAgICByZXR1cm4gZmluZFZlcnNpb24oc2hhcmVTY29wZU1hcFtzY29wZV1bcGtnTmFtZV0sIGNhbGxiYWNrKTtcbn1cbmZ1bmN0aW9uIGZpbmRTaW5nbGV0b25WZXJzaW9uT3JkZXJCeUxvYWRlZChzaGFyZVNjb3BlTWFwLCBzY29wZSwgcGtnTmFtZSkge1xuICAgIHZhciB2ZXJzaW9ucyA9IHNoYXJlU2NvcGVNYXBbc2NvcGVdW3BrZ05hbWVdO1xuICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKHByZXYsIGN1cikge1xuICAgICAgICB2YXIgaXNMb2FkaW5nT3JMb2FkZWQgPSAoc2hhcmVkKT0+e1xuICAgICAgICAgICAgcmV0dXJuIGlzTG9hZGVkKHNoYXJlZCkgfHwgaXNMb2FkaW5nKHNoYXJlZCk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChpc0xvYWRpbmdPckxvYWRlZCh2ZXJzaW9uc1tjdXJdKSkge1xuICAgICAgICAgICAgaWYgKGlzTG9hZGluZ09yTG9hZGVkKHZlcnNpb25zW3ByZXZdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBCb29sZWFuKHZlcnNpb25MdChwcmV2LCBjdXIpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTG9hZGluZ09yTG9hZGVkKHZlcnNpb25zW3ByZXZdKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2ZXJzaW9uTHQocHJldiwgY3VyKTtcbiAgICB9O1xuICAgIHJldHVybiBmaW5kVmVyc2lvbihzaGFyZVNjb3BlTWFwW3Njb3BlXVtwa2dOYW1lXSwgY2FsbGJhY2spO1xufVxuZnVuY3Rpb24gZ2V0RmluZFNoYXJlRnVuY3Rpb24oc3RyYXRlZ3kpIHtcbiAgICBpZiAoc3RyYXRlZ3kgPT09ICdsb2FkZWQtZmlyc3QnKSB7XG4gICAgICAgIHJldHVybiBmaW5kU2luZ2xldG9uVmVyc2lvbk9yZGVyQnlMb2FkZWQ7XG4gICAgfVxuICAgIHJldHVybiBmaW5kU2luZ2xldG9uVmVyc2lvbk9yZGVyQnlWZXJzaW9uO1xufVxuZnVuY3Rpb24gZ2V0UmVnaXN0ZXJlZFNoYXJlKGxvY2FsU2hhcmVTY29wZU1hcCwgcGtnTmFtZSwgc2hhcmVJbmZvLCByZXNvbHZlU2hhcmUpIHtcbiAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbihzYykge1xuICAgICAgICBpZiAoc2hhcmVDb25maWcgJiYgbG9jYWxTaGFyZVNjb3BlTWFwW3NjXSAmJiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdKSB7XG4gICAgICAgICAgICB2YXIgcmVxdWlyZWRWZXJzaW9uID0gc2hhcmVDb25maWcucmVxdWlyZWRWZXJzaW9uO1xuICAgICAgICAgICAgdmFyIGZpbmRTaGFyZUZ1bmN0aW9uID0gZ2V0RmluZFNoYXJlRnVuY3Rpb24oc3RyYXRlZ3kpO1xuICAgICAgICAgICAgdmFyIG1heE9yU2luZ2xldG9uVmVyc2lvbiA9IGZpbmRTaGFyZUZ1bmN0aW9uKGxvY2FsU2hhcmVTY29wZU1hcCwgc2MsIHBrZ05hbWUpO1xuICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICB2YXIgZGVmYXVsdFJlc29sdmVyID0gKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoc2hhcmVDb25maWcuc2luZ2xldG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVxdWlyZWRWZXJzaW9uID09PSAnc3RyaW5nJyAmJiAhc2F0aXNmeShtYXhPclNpbmdsZXRvblZlcnNpb24sIHJlcXVpcmVkVmVyc2lvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtc2cgPSBgVmVyc2lvbiAke21heE9yU2luZ2xldG9uVmVyc2lvbn0gZnJvbSAke21heE9yU2luZ2xldG9uVmVyc2lvbiAmJiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW21heE9yU2luZ2xldG9uVmVyc2lvbl0uZnJvbX0gb2Ygc2hhcmVkIHNpbmdsZXRvbiBtb2R1bGUgJHtwa2dOYW1lfSBkb2VzIG5vdCBzYXRpc2Z5IHRoZSByZXF1aXJlbWVudCBvZiAke3NoYXJlSW5mby5mcm9tfSB3aGljaCBuZWVkcyAke3JlcXVpcmVkVmVyc2lvbn0pYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IobXNnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2Fybihtc2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW21heE9yU2luZ2xldG9uVmVyc2lvbl07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVpcmVkVmVyc2lvbiA9PT0gZmFsc2UgfHwgcmVxdWlyZWRWZXJzaW9uID09PSAnKicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW21heE9yU2luZ2xldG9uVmVyc2lvbl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNhdGlzZnkobWF4T3JTaW5nbGV0b25WZXJzaW9uLCByZXF1aXJlZFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVttYXhPclNpbmdsZXRvblZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHJlZiBvZiBPYmplY3QuZW50cmllcyhsb2NhbFNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDIpLCB2ZXJzaW9uS2V5ID0gX3JlZlswXSwgdmVyc2lvblZhbHVlID0gX3JlZlsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzYXRpc2Z5KHZlcnNpb25LZXksIHJlcXVpcmVkVmVyc2lvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmVyc2lvblZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgc2hhcmVTY29wZU1hcDogbG9jYWxTaGFyZVNjb3BlTWFwLFxuICAgICAgICAgICAgICAgIHNjb3BlOiBzYyxcbiAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IG1heE9yU2luZ2xldG9uVmVyc2lvbixcbiAgICAgICAgICAgICAgICBHbG9iYWxGZWRlcmF0aW9uOiBHbG9iYWwuX19GRURFUkFUSU9OX18sXG4gICAgICAgICAgICAgICAgcmVzb2x2ZXI6IGRlZmF1bHRSZXNvbHZlclxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciByZXNvbHZlU2hhcmVkID0gcmVzb2x2ZVNoYXJlLmVtaXQocGFyYW1zKSB8fCBwYXJhbXM7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHY6IHJlc29sdmVTaGFyZWQucmVzb2x2ZXIoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgaWYgKCFsb2NhbFNoYXJlU2NvcGVNYXApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgc2hhcmVDb25maWcgPSBzaGFyZUluZm8uc2hhcmVDb25maWcsIF9zaGFyZUluZm9fc2NvcGUgPSBzaGFyZUluZm8uc2NvcGUsIHNjb3BlID0gX3NoYXJlSW5mb19zY29wZSA9PT0gdm9pZCAwID8gREVGQVVMVF9TQ09QRSA6IF9zaGFyZUluZm9fc2NvcGUsIHN0cmF0ZWd5ID0gc2hhcmVJbmZvLnN0cmF0ZWd5O1xuICAgIHZhciBzY29wZXMgPSBBcnJheS5pc0FycmF5KHNjb3BlKSA/IHNjb3BlIDogW1xuICAgICAgICBzY29wZVxuICAgIF07XG4gICAgZm9yICh2YXIgc2Mgb2Ygc2NvcGVzKXtcbiAgICAgICAgdmFyIF9yZXQgPSBfbG9vcChzYyk7XG4gICAgICAgIGlmIChfdHlwZV9vZi5fKF9yZXQpID09PSBcIm9iamVjdFwiKSByZXR1cm4gX3JldC52O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldEdsb2JhbFNoYXJlU2NvcGUoKSB7XG4gICAgcmV0dXJuIEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX1NIQVJFX187XG59XG5mdW5jdGlvbiBnZXRUYXJnZXRTaGFyZWRPcHRpb25zKG9wdGlvbnMpIHtcbiAgICB2YXIgcGtnTmFtZSA9IG9wdGlvbnMucGtnTmFtZSwgZXh0cmFPcHRpb25zID0gb3B0aW9ucy5leHRyYU9wdGlvbnMsIHNoYXJlSW5mb3MgPSBvcHRpb25zLnNoYXJlSW5mb3M7XG4gICAgdmFyIGRlZmF1bHRSZXNvbHZlciA9IChzaGFyZWRPcHRpb25zKT0+e1xuICAgICAgICBpZiAoIXNoYXJlZE9wdGlvbnMpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNoYXJlVmVyc2lvbk1hcCA9IHt9O1xuICAgICAgICBzaGFyZWRPcHRpb25zLmZvckVhY2goKHNoYXJlZCk9PntcbiAgICAgICAgICAgIHNoYXJlVmVyc2lvbk1hcFtzaGFyZWQudmVyc2lvbl0gPSBzaGFyZWQ7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbihwcmV2LCBjdXIpIHtcbiAgICAgICAgICAgIHJldHVybiAhaXNMb2FkZWQoc2hhcmVWZXJzaW9uTWFwW3ByZXZdKSAmJiB2ZXJzaW9uTHQocHJldiwgY3VyKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG1heFZlcnNpb24gPSBmaW5kVmVyc2lvbihzaGFyZVZlcnNpb25NYXAsIGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuIHNoYXJlVmVyc2lvbk1hcFttYXhWZXJzaW9uXTtcbiAgICB9O1xuICAgIHZhciBfZXh0cmFPcHRpb25zX3Jlc29sdmVyO1xuICAgIHZhciByZXNvbHZlciA9IChfZXh0cmFPcHRpb25zX3Jlc29sdmVyID0gZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMucmVzb2x2ZXIpICE9IG51bGwgPyBfZXh0cmFPcHRpb25zX3Jlc29sdmVyIDogZGVmYXVsdFJlc29sdmVyO1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCByZXNvbHZlcihzaGFyZUluZm9zW3BrZ05hbWVdKSwgZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuY3VzdG9tU2hhcmVJbmZvKTtcbn1cbnZhciBTaGFyZVV0aWxzID0ge1xuICAgIGdldFJlZ2lzdGVyZWRTaGFyZSxcbiAgICBnZXRHbG9iYWxTaGFyZVNjb3BlXG59O1xudmFyIEdsb2JhbFV0aWxzID0ge1xuICAgIEdsb2JhbCxcbiAgICBuYXRpdmVHbG9iYWwsXG4gICAgcmVzZXRGZWRlcmF0aW9uR2xvYmFsSW5mbyxcbiAgICBzZXRHbG9iYWxGZWRlcmF0aW9uSW5zdGFuY2UsXG4gICAgZ2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yLFxuICAgIHNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcixcbiAgICBnZXRJbmZvV2l0aG91dFR5cGUsXG4gICAgZ2V0R2xvYmFsU25hcHNob3QsXG4gICAgZ2V0VGFyZ2V0U25hcHNob3RJbmZvQnlNb2R1bGVJbmZvLFxuICAgIGdldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyxcbiAgICBzZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8sXG4gICAgYWRkR2xvYmFsU25hcHNob3QsXG4gICAgZ2V0UmVtb3RlRW50cnlFeHBvcnRzLFxuICAgIHJlZ2lzdGVyR2xvYmFsUGx1Z2lucyxcbiAgICBnZXRHbG9iYWxIb3N0UGx1Z2lucyxcbiAgICBnZXRQcmVsb2FkZWQsXG4gICAgc2V0UHJlbG9hZGVkXG59O1xudmFyIGhlbHBlcnMgPSB7XG4gICAgZ2xvYmFsOiBHbG9iYWxVdGlscyxcbiAgICBzaGFyZTogU2hhcmVVdGlsc1xufTtcbmZ1bmN0aW9uIGdldEJ1aWxkZXJJZCgpIHtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICByZXR1cm4gIHRydWUgPyBcInRyYXZlbHM6MS4wLjBcIiA6IDA7XG59XG4vLyBGdW5jdGlvbiB0byBtYXRjaCBhIHJlbW90ZSB3aXRoIGl0cyBuYW1lIGFuZCBleHBvc2Vcbi8vIGlkOiBwa2dOYW1lKEBmZWRlcmF0aW9uL2FwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBAZmVkZXJhdGlvbi9hcHAxL2J1dHRvblxuLy8gaWQ6IGFsaWFzKGFwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBhcHAxL2J1dHRvblxuLy8gaWQ6IGFsaWFzKGFwcDEvdXRpbHMpICsgZXhwb3NlKGxvYWRhc2gvc29ydCkgPSBhcHAxL3V0aWxzL2xvYWRhc2gvc29ydFxuZnVuY3Rpb24gbWF0Y2hSZW1vdGVXaXRoTmFtZUFuZEV4cG9zZShyZW1vdGVzLCBpZCkge1xuICAgIGZvciAodmFyIHJlbW90ZSBvZiByZW1vdGVzKXtcbiAgICAgICAgLy8gbWF0Y2ggcGtnTmFtZVxuICAgICAgICB2YXIgaXNOYW1lTWF0Y2hlZCA9IGlkLnN0YXJ0c1dpdGgocmVtb3RlLm5hbWUpO1xuICAgICAgICB2YXIgZXhwb3NlID0gaWQucmVwbGFjZShyZW1vdGUubmFtZSwgJycpO1xuICAgICAgICBpZiAoaXNOYW1lTWF0Y2hlZCkge1xuICAgICAgICAgICAgaWYgKGV4cG9zZS5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGtnTmFtZU9yQWxpYXMgPSByZW1vdGUubmFtZTtcbiAgICAgICAgICAgICAgICBleHBvc2UgPSBgLiR7ZXhwb3NlfWA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcGtnTmFtZU9yQWxpYXMsXG4gICAgICAgICAgICAgICAgICAgIGV4cG9zZSxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhwb3NlID09PSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzOiByZW1vdGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlOiAnLicsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gbWF0Y2ggYWxpYXNcbiAgICAgICAgdmFyIGlzQWxpYXNNYXRjaGVkID0gcmVtb3RlLmFsaWFzICYmIGlkLnN0YXJ0c1dpdGgocmVtb3RlLmFsaWFzKTtcbiAgICAgICAgdmFyIGV4cG9zZVdpdGhBbGlhcyA9IHJlbW90ZS5hbGlhcyAmJiBpZC5yZXBsYWNlKHJlbW90ZS5hbGlhcywgJycpO1xuICAgICAgICBpZiAocmVtb3RlLmFsaWFzICYmIGlzQWxpYXNNYXRjaGVkKSB7XG4gICAgICAgICAgICBpZiAoZXhwb3NlV2l0aEFsaWFzICYmIGV4cG9zZVdpdGhBbGlhcy5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGtnTmFtZU9yQWxpYXMxID0gcmVtb3RlLmFsaWFzO1xuICAgICAgICAgICAgICAgIGV4cG9zZVdpdGhBbGlhcyA9IGAuJHtleHBvc2VXaXRoQWxpYXN9YDtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwa2dOYW1lT3JBbGlhczogcGtnTmFtZU9yQWxpYXMxLFxuICAgICAgICAgICAgICAgICAgICBleHBvc2U6IGV4cG9zZVdpdGhBbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhwb3NlV2l0aEFsaWFzID09PSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzOiByZW1vdGUuYWxpYXMsXG4gICAgICAgICAgICAgICAgICAgIGV4cG9zZTogJy4nLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybjtcbn1cbi8vIEZ1bmN0aW9uIHRvIG1hdGNoIGEgcmVtb3RlIHdpdGggaXRzIG5hbWUgb3IgYWxpYXNcbmZ1bmN0aW9uIG1hdGNoUmVtb3RlKHJlbW90ZXMsIG5hbWVPckFsaWFzKSB7XG4gICAgZm9yICh2YXIgcmVtb3RlIG9mIHJlbW90ZXMpe1xuICAgICAgICB2YXIgaXNOYW1lTWF0Y2hlZCA9IG5hbWVPckFsaWFzID09PSByZW1vdGUubmFtZTtcbiAgICAgICAgaWYgKGlzTmFtZU1hdGNoZWQpIHtcbiAgICAgICAgICAgIHJldHVybiByZW1vdGU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlzQWxpYXNNYXRjaGVkID0gcmVtb3RlLmFsaWFzICYmIG5hbWVPckFsaWFzID09PSByZW1vdGUuYWxpYXM7XG4gICAgICAgIGlmIChpc0FsaWFzTWF0Y2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm47XG59XG5mdW5jdGlvbiByZWdpc3RlclBsdWdpbnMocGx1Z2lucywgaG9va0luc3RhbmNlcykge1xuICAgIHZhciBnbG9iYWxQbHVnaW5zID0gZ2V0R2xvYmFsSG9zdFBsdWdpbnMoKTtcbiAgICAvLyBJbmNvcnBvcmF0ZSBnbG9iYWwgcGx1Z2luc1xuICAgIGlmIChnbG9iYWxQbHVnaW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZ2xvYmFsUGx1Z2lucy5mb3JFYWNoKChwbHVnaW4pPT57XG4gICAgICAgICAgICBpZiAocGx1Z2lucyA9PSBudWxsID8gdm9pZCAwIDogcGx1Z2lucy5maW5kKChpdGVtKT0+aXRlbS5uYW1lICE9PSBwbHVnaW4ubmFtZSkpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW5zLnB1c2gocGx1Z2luKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChwbHVnaW5zICYmIHBsdWdpbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBwbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgICAgIGhvb2tJbnN0YW5jZXMuZm9yRWFjaCgoaG9va0luc3RhbmNlKT0+e1xuICAgICAgICAgICAgICAgIGhvb2tJbnN0YW5jZS5hcHBseVBsdWdpbihwbHVnaW4pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcGx1Z2lucztcbn1cbmZ1bmN0aW9uIGxvYWRFc21FbnRyeShfMCkge1xuICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKHJlZikge1xuICAgICAgICB2YXIgZW50cnkgPSByZWYuZW50cnksIHJlbW90ZUVudHJ5RXhwb3J0cyA9IHJlZi5yZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+e1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoIXJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEZ1bmN0aW9uKCdjYWxsYmFja3MnLCBgaW1wb3J0KFwiJHtlbnRyeX1cIikudGhlbihjYWxsYmFja3NbMF0pLmNhdGNoKGNhbGxiYWNrc1sxXSlgKShbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge31cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlbW90ZUVudHJ5RXhwb3J0cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIGxvYWRTeXN0ZW1Kc0VudHJ5KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHJlZi5lbnRyeSwgcmVtb3RlRW50cnlFeHBvcnRzID0gcmVmLnJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpPT57XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghcmVtb3RlRW50cnlFeHBvcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmFsc2UpIHt9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEZ1bmN0aW9uKCdjYWxsYmFja3MnLCBgU3lzdGVtLmltcG9ydChcIiR7ZW50cnl9XCIpLnRoZW4oY2FsbGJhY2tzWzBdKS5jYXRjaChjYWxsYmFja3NbMV0pYCkoW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVtb3RlRW50cnlFeHBvcnRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gbG9hZEVudHJ5U2NyaXB0KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBuYW1lMSA9IHJlZi5uYW1lLCBnbG9iYWxOYW1lID0gcmVmLmdsb2JhbE5hbWUsIGVudHJ5ID0gcmVmLmVudHJ5LCBsb2FkZXJIb29rID0gcmVmLmxvYWRlckhvb2s7XG4gICAgICAgIHZhciBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzID0gZ2V0UmVtb3RlRW50cnlFeHBvcnRzKG5hbWUxLCBnbG9iYWxOYW1lKSwgcmVtb3RlRW50cnlFeHBvcnRzID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5lbnRyeUV4cG9ydHM7XG4gICAgICAgIGlmIChyZW1vdGVFbnRyeUV4cG9ydHMpIHtcbiAgICAgICAgICAgIHJldHVybiByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNkay5sb2FkU2NyaXB0KGVudHJ5LCB7XG4gICAgICAgICAgICBhdHRyczoge30sXG4gICAgICAgICAgICBjcmVhdGVTY3JpcHRIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gbG9hZGVySG9vay5saWZlY3ljbGUuY3JlYXRlU2NyaXB0LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXMpIHJldHVybjtcbiAgICAgICAgICAgICAgICBpZiAocmVzIGluc3RhbmNlb2YgSFRNTFNjcmlwdEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCdzY3JpcHQnIGluIHJlcyB8fCAndGltZW91dCcgaW4gcmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkudGhlbigoKT0+e1xuICAgICAgICAgICAgdmFyIF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMgPSBnZXRSZW1vdGVFbnRyeUV4cG9ydHMobmFtZTEsIGdsb2JhbE5hbWUpLCByZW1vdGVFbnRyeUtleSA9IF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMucmVtb3RlRW50cnlLZXksIGVudHJ5RXhwb3J0cyA9IF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMuZW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgYXNzZXJ0KGVudHJ5RXhwb3J0cywgZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDEsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICByZW1vdGVOYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICByZW1vdGVFbnRyeVVybDogZW50cnksXG4gICAgICAgICAgICAgICAgcmVtb3RlRW50cnlLZXlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJldHVybiBlbnRyeUV4cG9ydHM7XG4gICAgICAgIH0pLmNhdGNoKChlKT0+e1xuICAgICAgICAgICAgYXNzZXJ0KHVuZGVmaW5lZCwgZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDgsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICByZW1vdGVOYW1lOiBuYW1lMSxcbiAgICAgICAgICAgICAgICByZXNvdXJjZVVybDogZW50cnlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgIH0pO1xuICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBsb2FkRW50cnlEb20oXzApIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKihyZWYpIHtcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSByZWYucmVtb3RlSW5mbywgcmVtb3RlRW50cnlFeHBvcnRzID0gcmVmLnJlbW90ZUVudHJ5RXhwb3J0cywgbG9hZGVySG9vayA9IHJlZi5sb2FkZXJIb29rO1xuICAgICAgICB2YXIgZW50cnkgPSByZW1vdGVJbmZvLmVudHJ5LCBnbG9iYWxOYW1lID0gcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUsIG5hbWUxID0gcmVtb3RlSW5mby5uYW1lLCB0eXBlID0gcmVtb3RlSW5mby50eXBlO1xuICAgICAgICBzd2l0Y2godHlwZSl7XG4gICAgICAgICAgICBjYXNlICdlc20nOlxuICAgICAgICAgICAgY2FzZSAnbW9kdWxlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZEVzbUVudHJ5KHtcbiAgICAgICAgICAgICAgICAgICAgZW50cnksXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0c1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY2FzZSAnc3lzdGVtJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZFN5c3RlbUpzRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICBlbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkRW50cnlTY3JpcHQoe1xuICAgICAgICAgICAgICAgICAgICBlbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgICAgIGxvYWRlckhvb2tcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBsb2FkRW50cnlOb2RlKF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciByZW1vdGVJbmZvID0gcmVmLnJlbW90ZUluZm8sIGxvYWRlckhvb2sgPSByZWYubG9hZGVySG9vaztcbiAgICAgICAgdmFyIGVudHJ5ID0gcmVtb3RlSW5mby5lbnRyeSwgZ2xvYmFsTmFtZSA9IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lLCBuYW1lMSA9IHJlbW90ZUluZm8ubmFtZSwgdHlwZSA9IHJlbW90ZUluZm8udHlwZTtcbiAgICAgICAgdmFyIF9nZXRSZW1vdGVFbnRyeUV4cG9ydHMgPSBnZXRSZW1vdGVFbnRyeUV4cG9ydHMobmFtZTEsIGdsb2JhbE5hbWUpLCByZW1vdGVFbnRyeUV4cG9ydHMgPSBfZ2V0UmVtb3RlRW50cnlFeHBvcnRzLmVudHJ5RXhwb3J0cztcbiAgICAgICAgaWYgKHJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2RrLmxvYWRTY3JpcHROb2RlKGVudHJ5LCB7XG4gICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIGdsb2JhbE5hbWUsXG4gICAgICAgICAgICAgICAgdHlwZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxvYWRlckhvb2s6IHtcbiAgICAgICAgICAgICAgICBjcmVhdGVTY3JpcHRIb29rOiAodXJsLCByZWYpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBhdHRycyA9IHJlZiA9PT0gdm9pZCAwID8ge30gOiByZWY7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBsb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVTY3JpcHQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyc1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXMpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCd1cmwnIGluIHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KS50aGVuKCgpPT57XG4gICAgICAgICAgICB2YXIgX2dldFJlbW90ZUVudHJ5RXhwb3J0cyA9IGdldFJlbW90ZUVudHJ5RXhwb3J0cyhuYW1lMSwgZ2xvYmFsTmFtZSksIHJlbW90ZUVudHJ5S2V5ID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5yZW1vdGVFbnRyeUtleSwgZW50cnlFeHBvcnRzID0gX2dldFJlbW90ZUVudHJ5RXhwb3J0cy5lbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICBhc3NlcnQoZW50cnlFeHBvcnRzLCBlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwMSwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgIHJlbW90ZU5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5VXJsOiBlbnRyeSxcbiAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUtleVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIGVudHJ5RXhwb3J0cztcbiAgICAgICAgfSkuY2F0Y2goKGUpPT57XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9KTtcbiAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gZ2V0UmVtb3RlRW50cnlVbmlxdWVLZXkocmVtb3RlSW5mbykge1xuICAgIHZhciBlbnRyeSA9IHJlbW90ZUluZm8uZW50cnksIG5hbWUxID0gcmVtb3RlSW5mby5uYW1lO1xuICAgIHJldHVybiBzZGsuY29tcG9zZUtleVdpdGhTZXBhcmF0b3IobmFtZTEsIGVudHJ5KTtcbn1cbmZ1bmN0aW9uIGdldFJlbW90ZUVudHJ5KF8wKSB7XG4gICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbioocmVmKSB7XG4gICAgICAgIHZhciBvcmlnaW4gPSByZWYub3JpZ2luLCByZW1vdGVFbnRyeUV4cG9ydHMgPSByZWYucmVtb3RlRW50cnlFeHBvcnRzLCByZW1vdGVJbmZvID0gcmVmLnJlbW90ZUluZm87XG4gICAgICAgIHZhciB1bmlxdWVLZXkgPSBnZXRSZW1vdGVFbnRyeVVuaXF1ZUtleShyZW1vdGVJbmZvKTtcbiAgICAgICAgaWYgKHJlbW90ZUVudHJ5RXhwb3J0cykge1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWdsb2JhbExvYWRpbmdbdW5pcXVlS2V5XSkge1xuICAgICAgICAgICAgdmFyIGxvYWRFbnRyeUhvb2sgPSBvcmlnaW4ucmVtb3RlSGFuZGxlci5ob29rcy5saWZlY3ljbGUubG9hZEVudHJ5O1xuICAgICAgICAgICAgdmFyIGxvYWRlckhvb2sgPSBvcmlnaW4ubG9hZGVySG9vaztcbiAgICAgICAgICAgIGdsb2JhbExvYWRpbmdbdW5pcXVlS2V5XSA9IGxvYWRFbnRyeUhvb2suZW1pdCh7XG4gICAgICAgICAgICAgICAgbG9hZGVySG9vayxcbiAgICAgICAgICAgICAgICByZW1vdGVJbmZvLFxuICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0c1xuICAgICAgICAgICAgfSkudGhlbigocmVzKT0+e1xuICAgICAgICAgICAgICAgIGlmIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNkay5pc0Jyb3dzZXJFbnYoKSA/IGxvYWRFbnRyeURvbSh7XG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVySG9va1xuICAgICAgICAgICAgICAgIH0pIDogbG9hZEVudHJ5Tm9kZSh7XG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIGxvYWRlckhvb2tcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBnbG9iYWxMb2FkaW5nW3VuaXF1ZUtleV07XG4gICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIGdldFJlbW90ZUluZm8ocmVtb3RlKSB7XG4gICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgcmVtb3RlLCB7XG4gICAgICAgIGVudHJ5OiAnZW50cnknIGluIHJlbW90ZSA/IHJlbW90ZS5lbnRyeSA6ICcnLFxuICAgICAgICB0eXBlOiByZW1vdGUudHlwZSB8fCBERUZBVUxUX1JFTU9URV9UWVBFLFxuICAgICAgICBlbnRyeUdsb2JhbE5hbWU6IHJlbW90ZS5lbnRyeUdsb2JhbE5hbWUgfHwgcmVtb3RlLm5hbWUsXG4gICAgICAgIHNoYXJlU2NvcGU6IHJlbW90ZS5zaGFyZVNjb3BlIHx8IERFRkFVTFRfU0NPUEVcbiAgICB9KTtcbn1cbnZhciBNb2R1bGUgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIE1vZHVsZShyZWYpIHtcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSByZWYucmVtb3RlSW5mbywgaG9zdCA9IHJlZi5ob3N0O1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIE1vZHVsZSk7XG4gICAgICAgIHRoaXMuaW5pdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubGliID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJlbW90ZUluZm8gPSByZW1vdGVJbmZvO1xuICAgICAgICB0aGlzLmhvc3QgPSBob3N0O1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oTW9kdWxlLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRFbnRyeVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEVudHJ5KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yZW1vdGVFbnRyeUV4cG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgZ2V0UmVtb3RlRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogdGhpcy5ob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IHRoaXMucmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUV4cG9ydHM6IHRoaXMucmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdW5pcXVlS2V5ID0gZ2V0UmVtb3RlRW50cnlVbmlxdWVLZXkodGhpcy5yZW1vdGVJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0cyA9IHlpZWxkIHRoaXMuaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5sb2FkRW50cnlFcnJvci5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRSZW1vdGVFbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMuaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbmZvOiB0aGlzLnJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzOiB0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxMb2FkaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXF1ZUtleVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHJlbW90ZUVudHJ5RXhwb3J0cywgYHJlbW90ZUVudHJ5RXhwb3J0cyBpcyB1bmRlZmluZWQgXFxuICR7c2RrLnNhZmVUb1N0cmluZyh0aGlzLnJlbW90ZUluZm8pfWApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW90ZUVudHJ5RXhwb3J0cyA9IHJlbW90ZUVudHJ5RXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRW50cnlFeHBvcnRzO1xuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0KGlkLCBleHBvc2UsIG9wdGlvbnMsIHJlbW90ZVNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gb3B0aW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkRmFjdG9yeTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9LCBfcmVmX2xvYWRGYWN0b3J5ID0gX3JlZi5sb2FkRmFjdG9yeSwgbG9hZEZhY3RvcnkgPSBfcmVmX2xvYWRGYWN0b3J5ID09PSB2b2lkIDAgPyB0cnVlIDogX3JlZl9sb2FkRmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHJlbW90ZUVudHJ5LmpzXG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVFbnRyeUV4cG9ydHMgPSB5aWVsZCB0aGlzLmdldEVudHJ5KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbml0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbFNoYXJlU2NvcGVNYXAgPSB0aGlzLmhvc3Quc2hhcmVTY29wZU1hcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVTaGFyZVNjb3BlID0gdGhpcy5yZW1vdGVJbmZvLnNoYXJlU2NvcGUgfHwgJ2RlZmF1bHQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsb2NhbFNoYXJlU2NvcGVNYXBbcmVtb3RlU2hhcmVTY29wZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFNoYXJlU2NvcGVNYXBbcmVtb3RlU2hhcmVTY29wZV0gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlID0gbG9jYWxTaGFyZVNjb3BlTWFwW3JlbW90ZVNoYXJlU2NvcGVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRTY29wZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5yZW1vdGVJbmZvLnZlcnNpb24gfHwgJydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIZWxwIHRvIGZpbmQgaG9zdCBpbnN0YW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsICdzaGFyZVNjb3BlTWFwJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBsb2NhbFNoYXJlU2NvcGVNYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3RlRW50cnlJbml0T3B0aW9ucyB3aWxsIGJlIHRyYXZlcnNlZCBhbmQgYXNzaWduZWQgZHVyaW5nIGNvbnRhaW5lciBpbml0LCAsc28gdGhpcyBhdHRyaWJ1dGUgaXMgbm90IGFsbG93ZWQgdG8gYmUgdHJhdmVyc2VkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRDb250YWluZXJPcHRpb25zID0geWllbGQgdGhpcy5ob3N0Lmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVJbml0Q29udGFpbmVyLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSBzaGFyZVNjb3BlTWFwIHdpbGwgYmUgc2V0IGJ5IE9iamVjdC5kZWZpbmVQcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdFNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IHRoaXMucmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMuaG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIChyZW1vdGVFbnRyeUV4cG9ydHMgPT0gbnVsbCA/IHZvaWQgMCA6IHJlbW90ZUVudHJ5RXhwb3J0cy5pbml0KSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcihlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwMiwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVOYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeVVybDogdGhpcy5yZW1vdGVJbmZvLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeUtleTogdGhpcy5yZW1vdGVJbmZvLmVudHJ5R2xvYmFsTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHJlbW90ZUVudHJ5RXhwb3J0cy5pbml0KGluaXRDb250YWluZXJPcHRpb25zLnNoYXJlU2NvcGUsIGluaXRDb250YWluZXJPcHRpb25zLmluaXRTY29wZSwgaW5pdENvbnRhaW5lck9wdGlvbnMucmVtb3RlRW50cnlJbml0T3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhvc3QuaG9va3MubGlmZWN5Y2xlLmluaXRDb250YWluZXIuZW1pdChwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGluaXRDb250YWluZXJPcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saWIgPSByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZUZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZUZhY3RvcnkgPSB5aWVsZCB0aGlzLmhvc3QubG9hZGVySG9vay5saWZlY3ljbGUuZ2V0TW9kdWxlRmFjdG9yeS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm86IHRoaXMucmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGV4cG9zZUdldHRlclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZHVsZUZhY3RvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUZhY3RvcnkgPSB5aWVsZCByZW1vdGVFbnRyeUV4cG9ydHMuZ2V0KGV4cG9zZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1vZHVsZUZhY3RvcnksIGAke2dldEZNSWQodGhpcy5yZW1vdGVJbmZvKX0gcmVtb3RlIGRvbid0IGV4cG9ydCAke2V4cG9zZX0uYCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGtlZXAgc3ltYm9sIGZvciBtb2R1bGUgbmFtZSBhbHdheXMgb25lIGZvcm1hdFxuICAgICAgICAgICAgICAgICAgICB2YXIgc3ltYm9sTmFtZSA9IHByb2Nlc3NNb2R1bGVBbGlhcyh0aGlzLnJlbW90ZUluZm8ubmFtZSwgZXhwb3NlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdyYXBNb2R1bGVGYWN0b3J5ID0gdGhpcy53cmFwZXJGYWN0b3J5KG1vZHVsZUZhY3RvcnksIHN5bWJvbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWxvYWRGYWN0b3J5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gd3JhcE1vZHVsZUZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4cG9zZUNvbnRlbnQgPSB5aWVsZCB3cmFwTW9kdWxlRmFjdG9yeSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhwb3NlQ29udGVudDtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwid3JhcGVyRmFjdG9yeVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdyYXBlckZhY3RvcnkobW9kdWxlRmFjdG9yeSwgaWQpIHtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZWZpbmVNb2R1bGVJZChyZXMsIGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgdHlwZW9mIHJlcyA9PT0gJ29iamVjdCcgJiYgT2JqZWN0LmlzRXh0ZW5zaWJsZShyZXMpICYmICFPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHJlcywgU3ltYm9sLmZvcignbWZfbW9kdWxlX2lkJykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVzLCBTeW1ib2wuZm9yKCdtZl9tb2R1bGVfaWQnKSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1vZHVsZUZhY3RvcnkgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0geWllbGQgbW9kdWxlRmFjdG9yeSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgcGFyYW1ldGVyIGlzIHVzZWQgZm9yIGJyaWRnZSBkZWJ1Z2dpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZpbmVNb2R1bGVJZChyZXMsIGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBtb2R1bGVGYWN0b3J5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHBhcmFtZXRlciBpcyB1c2VkIGZvciBicmlkZ2UgZGVidWdnaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZpbmVNb2R1bGVJZChyZXMsIGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIE1vZHVsZTtcbn0oKTtcbnZhciBTeW5jSG9vayA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gU3luY0hvb2sodHlwZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFN5bmNIb29rKTtcbiAgICAgICAgdGhpcy50eXBlID0gJyc7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gbmV3IFNldCgpO1xuICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oU3luY0hvb2ssIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcIm9uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb24oZm4pIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLmFkZChmbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwib25jZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uY2UoZm4pIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXNcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5vbihmdW5jdGlvbiB3cmFwcGVyKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZW1vdmUod3JhcHBlcik7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImVtaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlbWl0KC4uLmRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxpc3RlbmVycy5zaXplID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLXNwcmVhZFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5mb3JFYWNoKChmbik9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZuLmFwcGx5KHZvaWQgMCwgX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhkYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVtb3ZlXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlKGZuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnMuZGVsZXRlKGZuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlbW92ZUFsbFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUFsbCgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5jbGVhcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFN5bmNIb29rO1xufSgpO1xudmFyIEFzeW5jSG9vayA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oU3luY0hvb2spIHtcbiAgICBfaW5oZXJpdHMuXyhBc3luY0hvb2ssIFN5bmNIb29rKTtcbiAgICBmdW5jdGlvbiBBc3luY0hvb2soKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgQXN5bmNIb29rKTtcbiAgICAgICAgcmV0dXJuIF9jYWxsX3N1cGVyLl8odGhpcywgQXN5bmNIb29rLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oQXN5bmNIb29rLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJlbWl0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZW1pdCguLi5kYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB2YXIgbHMgPSBBcnJheS5mcm9tKHRoaXMubGlzdGVuZXJzKTtcbiAgICAgICAgICAgICAgICBpZiAobHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjYWxsID0gKHByZXYpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldiA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIEFib3J0IHByb2Nlc3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA8IGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobHNbaSsrXS5hcHBseShudWxsLCBkYXRhKSkudGhlbihjYWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNhbGwoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIEFzeW5jSG9vaztcbn0oU3luY0hvb2spO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXNcbmZ1bmN0aW9uIGNoZWNrUmV0dXJuRGF0YShvcmlnaW5hbERhdGEsIHJldHVybmVkRGF0YSkge1xuICAgIGlmICghaXNPYmplY3QocmV0dXJuZWREYXRhKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChvcmlnaW5hbERhdGEgIT09IHJldHVybmVkRGF0YSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1zeW50YXhcbiAgICAgICAgZm9yKHZhciBrZXkgaW4gb3JpZ2luYWxEYXRhKXtcbiAgICAgICAgICAgIGlmICghKGtleSBpbiByZXR1cm5lZERhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxudmFyIFN5bmNXYXRlcmZhbGxIb29rID0gLyojX19QVVJFX18qLyBmdW5jdGlvbihTeW5jSG9vaykge1xuICAgIF9pbmhlcml0cy5fKFN5bmNXYXRlcmZhbGxIb29rLCBTeW5jSG9vayk7XG4gICAgZnVuY3Rpb24gU3luY1dhdGVyZmFsbEhvb2sodHlwZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFN5bmNXYXRlcmZhbGxIb29rKTtcbiAgICAgICAgdmFyIF90aGlzO1xuICAgICAgICBfdGhpcyA9IF9jYWxsX3N1cGVyLl8odGhpcywgU3luY1dhdGVyZmFsbEhvb2spLCBfdGhpcy5vbmVycm9yID0gZXJyb3I7XG4gICAgICAgIF90aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTeW5jV2F0ZXJmYWxsSG9vaywgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZW1pdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGVtaXQoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmICghaXNPYmplY3QoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IoYFRoZSBkYXRhIGZvciB0aGUgXCIke3RoaXMudHlwZX1cIiBob29rIHNob3VsZCBiZSBhbiBvYmplY3QuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGZuIG9mIHRoaXMubGlzdGVuZXJzKXtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wRGF0YSA9IGZuKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrUmV0dXJuRGF0YShkYXRhLCB0ZW1wRGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGVtcERhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25lcnJvcihgQSBwbHVnaW4gcmV0dXJuZWQgYW4gdW5hY2NlcHRhYmxlIHZhbHVlIGZvciB0aGUgXCIke3RoaXMudHlwZX1cIiB0eXBlLmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFN5bmNXYXRlcmZhbGxIb29rO1xufShTeW5jSG9vayk7XG52YXIgQXN5bmNXYXRlcmZhbGxIb29rID0gLyojX19QVVJFX18qLyBmdW5jdGlvbihTeW5jSG9vaykge1xuICAgIF9pbmhlcml0cy5fKEFzeW5jV2F0ZXJmYWxsSG9vaywgU3luY0hvb2spO1xuICAgIGZ1bmN0aW9uIEFzeW5jV2F0ZXJmYWxsSG9vayh0eXBlKSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgQXN5bmNXYXRlcmZhbGxIb29rKTtcbiAgICAgICAgdmFyIF90aGlzO1xuICAgICAgICBfdGhpcyA9IF9jYWxsX3N1cGVyLl8odGhpcywgQXN5bmNXYXRlcmZhbGxIb29rKSwgX3RoaXMub25lcnJvciA9IGVycm9yO1xuICAgICAgICBfdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oQXN5bmNXYXRlcmZhbGxIb29rLCBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJlbWl0XCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZW1pdChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc09iamVjdChkYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcihgVGhlIHJlc3BvbnNlIGRhdGEgZm9yIHRoZSBcIiR7dGhpcy50eXBlfVwiIGhvb2sgbXVzdCBiZSBhbiBvYmplY3QuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBscyA9IEFycmF5LmZyb20odGhpcy5saXN0ZW5lcnMpO1xuICAgICAgICAgICAgICAgIGlmIChscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NFcnJvciA9IChlKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgd2FybihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25lcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FsbCA9IChwcmV2RGF0YSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGVja1JldHVybkRhdGEoZGF0YSwgcHJldkRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHByZXZEYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpIDwgbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGxzW2krK10oZGF0YSkpLnRoZW4oY2FsbCwgcHJvY2Vzc0Vycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NFcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGBBIHBsdWdpbiByZXR1cm5lZCBhbiBpbmNvcnJlY3QgdmFsdWUgZm9yIHRoZSBcIiR7dGhpcy50eXBlfVwiIHR5cGUuYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjYWxsKGRhdGEpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBBc3luY1dhdGVyZmFsbEhvb2s7XG59KFN5bmNIb29rKTtcbnZhciBQbHVnaW5TeXN0ZW0gPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIFBsdWdpblN5c3RlbShsaWZlY3ljbGUpIHtcbiAgICAgICAgX2NsYXNzX2NhbGxfY2hlY2suXyh0aGlzLCBQbHVnaW5TeXN0ZW0pO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyUGx1Z2lucyA9IHt9O1xuICAgICAgICB0aGlzLmxpZmVjeWNsZSA9IGxpZmVjeWNsZTtcbiAgICAgICAgdGhpcy5saWZlY3ljbGVLZXlzID0gT2JqZWN0LmtleXMobGlmZWN5Y2xlKTtcbiAgICB9XG4gICAgX2NyZWF0ZV9jbGFzcy5fKFBsdWdpblN5c3RlbSwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiYXBwbHlQbHVnaW5cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseVBsdWdpbihwbHVnaW4pIHtcbiAgICAgICAgICAgICAgICBhc3NlcnQoaXNQbGFpbk9iamVjdChwbHVnaW4pLCAnUGx1Z2luIGNvbmZpZ3VyYXRpb24gaXMgaW52YWxpZC4nKTtcbiAgICAgICAgICAgICAgICAvLyBUaGUgcGx1Z2luJ3MgbmFtZSBpcyBtYW5kYXRvcnkgYW5kIG11c3QgYmUgdW5pcXVlXG4gICAgICAgICAgICAgICAgdmFyIHBsdWdpbk5hbWUgPSBwbHVnaW4ubmFtZTtcbiAgICAgICAgICAgICAgICBhc3NlcnQocGx1Z2luTmFtZSwgJ0EgbmFtZSBtdXN0IGJlIHByb3ZpZGVkIGJ5IHRoZSBwbHVnaW4uJyk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXSA9IHBsdWdpbjtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5saWZlY3ljbGUpLmZvckVhY2goKGtleSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbHVnaW5MaWZlID0gcGx1Z2luW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGx1Z2luTGlmZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlmZWN5Y2xlW2tleV0ub24ocGx1Z2luTGlmZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlbW92ZVBsdWdpblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVBsdWdpbihwbHVnaW5OYW1lKSB7XG4gICAgICAgICAgICAgICAgYXNzZXJ0KHBsdWdpbk5hbWUsICdBIG5hbWUgaXMgcmVxdWlyZWQuJyk7XG4gICAgICAgICAgICAgICAgdmFyIHBsdWdpbiA9IHRoaXMucmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdO1xuICAgICAgICAgICAgICAgIGFzc2VydChwbHVnaW4sIGBUaGUgcGx1Z2luIFwiJHtwbHVnaW5OYW1lfVwiIGlzIG5vdCByZWdpc3RlcmVkLmApO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHBsdWdpbikuZm9yRWFjaCgoa2V5KT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSAnbmFtZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlmZWN5Y2xlW2tleV0ucmVtb3ZlKHBsdWdpbltrZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXNoYWRvd1xuICAgICAgICAgICAga2V5OiBcImluaGVyaXRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbmhlcml0KHJlZikge1xuICAgICAgICAgICAgICAgIHZhciBsaWZlY3ljbGUgPSByZWYubGlmZWN5Y2xlLCByZWdpc3RlclBsdWdpbnMgPSByZWYucmVnaXN0ZXJQbHVnaW5zO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGxpZmVjeWNsZSkuZm9yRWFjaCgoaG9va05hbWUpPT57XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydCghdGhpcy5saWZlY3ljbGVbaG9va05hbWVdLCBgVGhlIGhvb2sgXCIke2hvb2tOYW1lfVwiIGhhcyBhIGNvbmZsaWN0IGFuZCBjYW5ub3QgYmUgaW5oZXJpdGVkLmApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpZmVjeWNsZVtob29rTmFtZV0gPSBsaWZlY3ljbGVbaG9va05hbWVdO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlZ2lzdGVyUGx1Z2lucykuZm9yRWFjaCgocGx1Z2luTmFtZSk9PntcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCF0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXSwgYFRoZSBwbHVnaW4gXCIke3BsdWdpbk5hbWV9XCIgaGFzIGEgY29uZmxpY3QgYW5kIGNhbm5vdCBiZSBpbmhlcml0ZWQuYCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlQbHVnaW4ocmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBQbHVnaW5TeXN0ZW07XG59KCk7XG5mdW5jdGlvbiBkZWZhdWx0UHJlbG9hZEFyZ3MocHJlbG9hZENvbmZpZykge1xuICAgIHJldHVybiBwb2x5ZmlsbHMuX2V4dGVuZHMoe1xuICAgICAgICByZXNvdXJjZUNhdGVnb3J5OiAnc3luYycsXG4gICAgICAgIHNoYXJlOiB0cnVlLFxuICAgICAgICBkZXBzUmVtb3RlOiB0cnVlLFxuICAgICAgICBwcmVmZXRjaEludGVyZmFjZTogZmFsc2VcbiAgICB9LCBwcmVsb2FkQ29uZmlnKTtcbn1cbmZ1bmN0aW9uIGZvcm1hdFByZWxvYWRBcmdzKHJlbW90ZXMsIHByZWxvYWRBcmdzKSB7XG4gICAgcmV0dXJuIHByZWxvYWRBcmdzLm1hcCgoYXJncyk9PntcbiAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBtYXRjaFJlbW90ZShyZW1vdGVzLCBhcmdzLm5hbWVPckFsaWFzKTtcbiAgICAgICAgYXNzZXJ0KHJlbW90ZUluZm8sIGBVbmFibGUgdG8gcHJlbG9hZCAke2FyZ3MubmFtZU9yQWxpYXN9IGFzIGl0IGlzIG5vdCBpbmNsdWRlZCBpbiAkeyFyZW1vdGVJbmZvICYmIHNkay5zYWZlVG9TdHJpbmcoe1xuICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgIHJlbW90ZXNcbiAgICAgICAgfSl9YCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZW1vdGU6IHJlbW90ZUluZm8sXG4gICAgICAgICAgICBwcmVsb2FkQ29uZmlnOiBkZWZhdWx0UHJlbG9hZEFyZ3MoYXJncylcbiAgICAgICAgfTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZVByZWxvYWRFeHBvc2VzKGV4cG9zZXMpIHtcbiAgICBpZiAoIWV4cG9zZXMpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICByZXR1cm4gZXhwb3Nlcy5tYXAoKGV4cG9zZSk9PntcbiAgICAgICAgaWYgKGV4cG9zZSA9PT0gJy4nKSB7XG4gICAgICAgICAgICByZXR1cm4gZXhwb3NlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChleHBvc2Uuc3RhcnRzV2l0aCgnLi8nKSkge1xuICAgICAgICAgICAgcmV0dXJuIGV4cG9zZS5yZXBsYWNlKCcuLycsICcnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXhwb3NlO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gcHJlbG9hZEFzc2V0cyhyZW1vdGVJbmZvLCBob3N0LCBhc3NldHMsIHJlZikge1xuICAgIHZhciB1c2VMaW5rUHJlbG9hZCA9IHJlZiA9PT0gdm9pZCAwID8gdHJ1ZSA6IHJlZjtcbiAgICB2YXIgY3NzQXNzZXRzID0gYXNzZXRzLmNzc0Fzc2V0cywganNBc3NldHNXaXRob3V0RW50cnkgPSBhc3NldHMuanNBc3NldHNXaXRob3V0RW50cnksIGVudHJ5QXNzZXRzID0gYXNzZXRzLmVudHJ5QXNzZXRzO1xuICAgIGlmIChob3N0Lm9wdGlvbnMuaW5Ccm93c2VyKSB7XG4gICAgICAgIGVudHJ5QXNzZXRzLmZvckVhY2goKGFzc2V0KT0+e1xuICAgICAgICAgICAgdmFyIG1vZHVsZUluZm8gPSBhc3NldC5tb2R1bGVJbmZvO1xuICAgICAgICAgICAgdmFyIG1vZHVsZSA9IGhvc3QubW9kdWxlQ2FjaGUuZ2V0KHJlbW90ZUluZm8ubmFtZSk7XG4gICAgICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgZ2V0UmVtb3RlRW50cnkoe1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm86IG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUVudHJ5RXhwb3J0czogbW9kdWxlLnJlbW90ZUVudHJ5RXhwb3J0c1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBnZXRSZW1vdGVFbnRyeSh7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbzogbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh1c2VMaW5rUHJlbG9hZCkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRBdHRycyA9IHtcbiAgICAgICAgICAgICAgICByZWw6ICdwcmVsb2FkJyxcbiAgICAgICAgICAgICAgICBhczogJ3N0eWxlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNzc0Fzc2V0cy5mb3JFYWNoKChjc3NVcmwpPT57XG4gICAgICAgICAgICAgICAgdmFyIF9zZGtfY3JlYXRlTGluayA9IHNkay5jcmVhdGVMaW5rKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBjc3NVcmwsXG4gICAgICAgICAgICAgICAgICAgIGNiOiAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAvLyBub29wXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzOiBkZWZhdWx0QXR0cnMsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxpbmtIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZUxpbmsuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MTGlua0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksIGNzc0VsID0gX3Nka19jcmVhdGVMaW5rLmxpbmssIG5lZWRBdHRhY2ggPSBfc2RrX2NyZWF0ZUxpbmsubmVlZEF0dGFjaDtcbiAgICAgICAgICAgICAgICBuZWVkQXR0YWNoICYmIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoY3NzRWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdEF0dHJzMSA9IHtcbiAgICAgICAgICAgICAgICByZWw6ICdzdHlsZXNoZWV0JyxcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dC9jc3MnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY3NzQXNzZXRzLmZvckVhY2goKGNzc1VybCk9PntcbiAgICAgICAgICAgICAgICB2YXIgX3Nka19jcmVhdGVMaW5rID0gc2RrLmNyZWF0ZUxpbmsoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGNzc1VybCxcbiAgICAgICAgICAgICAgICAgICAgY2I6ICgpPT57XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vb3BcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYXR0cnM6IGRlZmF1bHRBdHRyczEsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxpbmtIb29rOiAodXJsLCBhdHRycyk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBob3N0LmxvYWRlckhvb2subGlmZWN5Y2xlLmNyZWF0ZUxpbmsuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MTGlua0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBuZWVkRGVsZXRlTGluazogZmFsc2VcbiAgICAgICAgICAgICAgICB9KSwgY3NzRWwgPSBfc2RrX2NyZWF0ZUxpbmsubGluaywgbmVlZEF0dGFjaCA9IF9zZGtfY3JlYXRlTGluay5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjc3NFbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXNlTGlua1ByZWxvYWQpIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0QXR0cnMyID0ge1xuICAgICAgICAgICAgICAgIHJlbDogJ3ByZWxvYWQnLFxuICAgICAgICAgICAgICAgIGFzOiAnc2NyaXB0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5LmZvckVhY2goKGpzVXJsKT0+e1xuICAgICAgICAgICAgICAgIHZhciBfc2RrX2NyZWF0ZUxpbmsgPSBzZGsuY3JlYXRlTGluayh7XG4gICAgICAgICAgICAgICAgICAgIHVybDoganNVcmwsXG4gICAgICAgICAgICAgICAgICAgIGNiOiAoKT0+e1xuICAgICAgICAgICAgICAgICAgICAvLyBub29wXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzOiBkZWZhdWx0QXR0cnMyLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVMaW5rSG9vazogKHVybCwgYXR0cnMpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVMaW5rLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyc1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzIGluc3RhbmNlb2YgSFRNTExpbmtFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLCBsaW5rRWwgPSBfc2RrX2NyZWF0ZUxpbmsubGluaywgbmVlZEF0dGFjaCA9IF9zZGtfY3JlYXRlTGluay5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChsaW5rRWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdEF0dHJzMyA9IHtcbiAgICAgICAgICAgICAgICBmZXRjaHByaW9yaXR5OiAnaGlnaCcsXG4gICAgICAgICAgICAgICAgdHlwZTogKHJlbW90ZUluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IHJlbW90ZUluZm8udHlwZSkgPT09ICdtb2R1bGUnID8gJ21vZHVsZScgOiAndGV4dC9qYXZhc2NyaXB0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGpzQXNzZXRzV2l0aG91dEVudHJ5LmZvckVhY2goKGpzVXJsKT0+e1xuICAgICAgICAgICAgICAgIHZhciBfc2RrX2NyZWF0ZVNjcmlwdCA9IHNkay5jcmVhdGVTY3JpcHQoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGpzVXJsLFxuICAgICAgICAgICAgICAgICAgICBjYjogKCk9PntcbiAgICAgICAgICAgICAgICAgICAgLy8gbm9vcFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhdHRyczogZGVmYXVsdEF0dHJzMyxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2NyaXB0SG9vazogKHVybCwgYXR0cnMpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gaG9zdC5sb2FkZXJIb29rLmxpZmVjeWNsZS5jcmVhdGVTY3JpcHQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIVE1MU2NyaXB0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVTY3JpcHQ6IHRydWVcbiAgICAgICAgICAgICAgICB9KSwgc2NyaXB0RWwgPSBfc2RrX2NyZWF0ZVNjcmlwdC5zY3JpcHQsIG5lZWRBdHRhY2ggPSBfc2RrX2NyZWF0ZVNjcmlwdC5uZWVkQXR0YWNoO1xuICAgICAgICAgICAgICAgIG5lZWRBdHRhY2ggJiYgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHRFbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGFzc2lnblJlbW90ZUluZm8ocmVtb3RlSW5mbywgcmVtb3RlU25hcHNob3QpIHtcbiAgICB2YXIgcmVtb3RlRW50cnlJbmZvID0gZ2V0UmVtb3RlRW50cnlJbmZvRnJvbVNuYXBzaG90KHJlbW90ZVNuYXBzaG90KTtcbiAgICBpZiAoIXJlbW90ZUVudHJ5SW5mby51cmwpIHtcbiAgICAgICAgZXJyb3IoYFRoZSBhdHRyaWJ1dGUgcmVtb3RlRW50cnkgb2YgJHtyZW1vdGVJbmZvLm5hbWV9IG11c3Qgbm90IGJlIHVuZGVmaW5lZC5gKTtcbiAgICB9XG4gICAgdmFyIGVudHJ5VXJsID0gc2RrLmdldFJlc291cmNlVXJsKHJlbW90ZVNuYXBzaG90LCByZW1vdGVFbnRyeUluZm8udXJsKTtcbiAgICBpZiAoIXNkay5pc0Jyb3dzZXJFbnYoKSAmJiAhZW50cnlVcmwuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XG4gICAgICAgIGVudHJ5VXJsID0gYGh0dHBzOiR7ZW50cnlVcmx9YDtcbiAgICB9XG4gICAgcmVtb3RlSW5mby50eXBlID0gcmVtb3RlRW50cnlJbmZvLnR5cGU7XG4gICAgcmVtb3RlSW5mby5lbnRyeUdsb2JhbE5hbWUgPSByZW1vdGVFbnRyeUluZm8uZ2xvYmFsTmFtZTtcbiAgICByZW1vdGVJbmZvLmVudHJ5ID0gZW50cnlVcmw7XG4gICAgcmVtb3RlSW5mby52ZXJzaW9uID0gcmVtb3RlU25hcHNob3QudmVyc2lvbjtcbiAgICByZW1vdGVJbmZvLmJ1aWxkVmVyc2lvbiA9IHJlbW90ZVNuYXBzaG90LmJ1aWxkVmVyc2lvbjtcbn1cbmZ1bmN0aW9uIHNuYXBzaG90UGx1Z2luKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6ICdzbmFwc2hvdC1wbHVnaW4nLFxuICAgICAgICBhZnRlclJlc29sdmUgKGFyZ3MpIHtcbiAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSBhcmdzLnJlbW90ZSwgcGtnTmFtZU9yQWxpYXMgPSBhcmdzLnBrZ05hbWVPckFsaWFzLCBleHBvc2UgPSBhcmdzLmV4cG9zZSwgb3JpZ2luID0gYXJncy5vcmlnaW4sIHJlbW90ZUluZm8gPSBhcmdzLnJlbW90ZUluZm87XG4gICAgICAgICAgICAgICAgaWYgKCFpc1JlbW90ZUluZm9XaXRoRW50cnkocmVtb3RlKSB8fCAhaXNQdXJlUmVtb3RlRW50cnkocmVtb3RlKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IHlpZWxkIG9yaWdpbi5zbmFwc2hvdEhhbmRsZXIubG9hZFJlbW90ZVNuYXBzaG90SW5mbyhyZW1vdGUpLCByZW1vdGVTbmFwc2hvdCA9IF9yZWYucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90ID0gX3JlZi5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgYXNzaWduUmVtb3RlSW5mbyhyZW1vdGVJbmZvLCByZW1vdGVTbmFwc2hvdCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHByZWxvYWRpbmcgYXNzZXRzXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmVsb2FkT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRDb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lT3JBbGlhczogcGtnTmFtZU9yQWxpYXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlQ2F0ZWdvcnk6ICdzeW5jJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwc1JlbW90ZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2V0cyA9IHlpZWxkIG9yaWdpbi5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5nZW5lcmF0ZVByZWxvYWRBc3NldHMuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVsb2FkT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXNzZXRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVsb2FkQXNzZXRzKHJlbW90ZUluZm8sIG9yaWdpbiwgYXNzZXRzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgYXJncywge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhcmdzO1xuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgfVxuICAgIH07XG59XG4vLyBuYW1lXG4vLyBuYW1lOnZlcnNpb25cbmZ1bmN0aW9uIHNwbGl0SWQoaWQpIHtcbiAgICB2YXIgc3BsaXRJbmZvID0gaWQuc3BsaXQoJzonKTtcbiAgICBpZiAoc3BsaXRJbmZvLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogc3BsaXRJbmZvWzBdLFxuICAgICAgICAgICAgdmVyc2lvbjogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmIChzcGxpdEluZm8ubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBzcGxpdEluZm9bMF0sXG4gICAgICAgICAgICB2ZXJzaW9uOiBzcGxpdEluZm9bMV1cbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogc3BsaXRJbmZvWzFdLFxuICAgICAgICAgICAgdmVyc2lvbjogc3BsaXRJbmZvWzJdXG4gICAgICAgIH07XG4gICAgfVxufVxuLy8gVHJhdmVyc2UgYWxsIG5vZGVzIGluIG1vZHVsZUluZm8gYW5kIHRyYXZlcnNlIHRoZSBlbnRpcmUgc25hcHNob3RcbmZ1bmN0aW9uIHRyYXZlcnNlTW9kdWxlSW5mbyhnbG9iYWxTbmFwc2hvdCwgcmVtb3RlSW5mbywgdHJhdmVyc2UsIGlzUm9vdCwgcmVmLCByZW1vdGVTbmFwc2hvdCkge1xuICAgIHZhciBtZW1vID0gcmVmID09PSB2b2lkIDAgPyB7fSA6IHJlZjtcbiAgICB2YXIgaWQgPSBnZXRGTUlkKHJlbW90ZUluZm8pO1xuICAgIHZhciBfZ2V0SW5mb1dpdGhvdXRUeXBlID0gZ2V0SW5mb1dpdGhvdXRUeXBlKGdsb2JhbFNuYXBzaG90LCBpZCksIHNuYXBzaG90VmFsdWUgPSBfZ2V0SW5mb1dpdGhvdXRUeXBlLnZhbHVlO1xuICAgIHZhciBlZmZlY3RpdmVSZW1vdGVTbmFwc2hvdCA9IHJlbW90ZVNuYXBzaG90IHx8IHNuYXBzaG90VmFsdWU7XG4gICAgaWYgKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90ICYmICFzZGsuaXNNYW5pZmVzdFByb3ZpZGVyKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90KSkge1xuICAgICAgICB0cmF2ZXJzZShlZmZlY3RpdmVSZW1vdGVTbmFwc2hvdCwgcmVtb3RlSW5mbywgaXNSb290KTtcbiAgICAgICAgaWYgKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LnJlbW90ZXNJbmZvKSB7XG4gICAgICAgICAgICB2YXIgcmVtb3RlS2V5cyA9IE9iamVjdC5rZXlzKGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LnJlbW90ZXNJbmZvKTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBvZiByZW1vdGVLZXlzKXtcbiAgICAgICAgICAgICAgICBpZiAobWVtb1trZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtZW1vW2tleV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBzdWJSZW1vdGVJbmZvID0gc3BsaXRJZChrZXkpO1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVWYWx1ZSA9IGVmZmVjdGl2ZVJlbW90ZVNuYXBzaG90LnJlbW90ZXNJbmZvW2tleV07XG4gICAgICAgICAgICAgICAgdHJhdmVyc2VNb2R1bGVJbmZvKGdsb2JhbFNuYXBzaG90LCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHN1YlJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogcmVtb3RlVmFsdWUubWF0Y2hlZFZlcnNpb25cbiAgICAgICAgICAgICAgICB9LCB0cmF2ZXJzZSwgZmFsc2UsIG1lbW8sIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvblxuZnVuY3Rpb24gZ2VuZXJhdGVQcmVsb2FkQXNzZXRzKG9yaWdpbiwgcHJlbG9hZE9wdGlvbnMsIHJlbW90ZSwgZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90KSB7XG4gICAgdmFyIGNzc0Fzc2V0cyA9IFtdO1xuICAgIHZhciBqc0Fzc2V0cyA9IFtdO1xuICAgIHZhciBlbnRyeUFzc2V0cyA9IFtdO1xuICAgIHZhciBsb2FkZWRTaGFyZWRKc0Fzc2V0cyA9IG5ldyBTZXQoKTtcbiAgICB2YXIgbG9hZGVkU2hhcmVkQ3NzQXNzZXRzID0gbmV3IFNldCgpO1xuICAgIHZhciBvcHRpb25zID0gb3JpZ2luLm9wdGlvbnM7XG4gICAgdmFyIHJvb3RQcmVsb2FkQ29uZmlnID0gcHJlbG9hZE9wdGlvbnMucHJlbG9hZENvbmZpZztcbiAgICB2YXIgZGVwc1JlbW90ZSA9IHJvb3RQcmVsb2FkQ29uZmlnLmRlcHNSZW1vdGU7XG4gICAgdmFyIG1lbW8gPSB7fTtcbiAgICB0cmF2ZXJzZU1vZHVsZUluZm8oZ2xvYmFsU25hcHNob3QsIHJlbW90ZSwgKG1vZHVsZUluZm9TbmFwc2hvdCwgcmVtb3RlSW5mbywgaXNSb290KT0+e1xuICAgICAgICB2YXIgcHJlbG9hZENvbmZpZztcbiAgICAgICAgaWYgKGlzUm9vdCkge1xuICAgICAgICAgICAgcHJlbG9hZENvbmZpZyA9IHJvb3RQcmVsb2FkQ29uZmlnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZGVwc1JlbW90ZSkpIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgYXJyYXktY2FsbGJhY2stcmV0dXJuXG4gICAgICAgICAgICAgICAgdmFyIGZpbmRQcmVsb2FkQ29uZmlnID0gZGVwc1JlbW90ZS5maW5kKChyZW1vdGVDb25maWcpPT57XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdGVDb25maWcubmFtZU9yQWxpYXMgPT09IHJlbW90ZUluZm8ubmFtZSB8fCByZW1vdGVDb25maWcubmFtZU9yQWxpYXMgPT09IHJlbW90ZUluZm8uYWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIWZpbmRQcmVsb2FkQ29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJlbG9hZENvbmZpZyA9IGRlZmF1bHRQcmVsb2FkQXJncyhmaW5kUHJlbG9hZENvbmZpZyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRlcHNSZW1vdGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBwcmVsb2FkQ29uZmlnID0gcm9vdFByZWxvYWRDb25maWc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVtb3RlRW50cnlVcmwgPSBzZGsuZ2V0UmVzb3VyY2VVcmwobW9kdWxlSW5mb1NuYXBzaG90LCBnZXRSZW1vdGVFbnRyeUluZm9Gcm9tU25hcHNob3QobW9kdWxlSW5mb1NuYXBzaG90KS51cmwpO1xuICAgICAgICBpZiAocmVtb3RlRW50cnlVcmwpIHtcbiAgICAgICAgICAgIGVudHJ5QXNzZXRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICBtb2R1bGVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZW50cnk6IHJlbW90ZUVudHJ5VXJsLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAncmVtb3RlRW50cnlUeXBlJyBpbiBtb2R1bGVJbmZvU25hcHNob3QgPyBtb2R1bGVJbmZvU25hcHNob3QucmVtb3RlRW50cnlUeXBlIDogJ2dsb2JhbCcsXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5R2xvYmFsTmFtZTogJ2dsb2JhbE5hbWUnIGluIG1vZHVsZUluZm9TbmFwc2hvdCA/IG1vZHVsZUluZm9TbmFwc2hvdC5nbG9iYWxOYW1lIDogcmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZVNjb3BlOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogJ3ZlcnNpb24nIGluIG1vZHVsZUluZm9TbmFwc2hvdCA/IG1vZHVsZUluZm9TbmFwc2hvdC52ZXJzaW9uIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1cmw6IHJlbW90ZUVudHJ5VXJsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbW9kdWxlQXNzZXRzSW5mbyA9ICdtb2R1bGVzJyBpbiBtb2R1bGVJbmZvU25hcHNob3QgPyBtb2R1bGVJbmZvU25hcHNob3QubW9kdWxlcyA6IFtdO1xuICAgICAgICB2YXIgbm9ybWFsaXplZFByZWxvYWRFeHBvc2VzID0gbm9ybWFsaXplUHJlbG9hZEV4cG9zZXMocHJlbG9hZENvbmZpZy5leHBvc2VzKTtcbiAgICAgICAgaWYgKG5vcm1hbGl6ZWRQcmVsb2FkRXhwb3Nlcy5sZW5ndGggJiYgJ21vZHVsZXMnIGluIG1vZHVsZUluZm9TbmFwc2hvdCkge1xuICAgICAgICAgICAgdmFyIF9tb2R1bGVJbmZvU25hcHNob3RfbW9kdWxlcztcbiAgICAgICAgICAgIG1vZHVsZUFzc2V0c0luZm8gPSBtb2R1bGVJbmZvU25hcHNob3QgPT0gbnVsbCA/IHZvaWQgMCA6IChfbW9kdWxlSW5mb1NuYXBzaG90X21vZHVsZXMgPSBtb2R1bGVJbmZvU25hcHNob3QubW9kdWxlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9tb2R1bGVJbmZvU25hcHNob3RfbW9kdWxlcy5yZWR1Y2UoKGFzc2V0cywgbW9kdWxlQXNzZXRJbmZvKT0+e1xuICAgICAgICAgICAgICAgIGlmICgobm9ybWFsaXplZFByZWxvYWRFeHBvc2VzID09IG51bGwgPyB2b2lkIDAgOiBub3JtYWxpemVkUHJlbG9hZEV4cG9zZXMuaW5kZXhPZihtb2R1bGVBc3NldEluZm8ubW9kdWxlTmFtZSkpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBhc3NldHMucHVzaChtb2R1bGVBc3NldEluZm8pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXRzO1xuICAgICAgICAgICAgfSwgW10pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZUFzc2V0cyhhc3NldHMpIHtcbiAgICAgICAgICAgIHZhciBhc3NldHNSZXMgPSBhc3NldHMubWFwKChhc3NldCk9PnNkay5nZXRSZXNvdXJjZVVybChtb2R1bGVJbmZvU25hcHNob3QsIGFzc2V0KSk7XG4gICAgICAgICAgICBpZiAocHJlbG9hZENvbmZpZy5maWx0ZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXRzUmVzLmZpbHRlcihwcmVsb2FkQ29uZmlnLmZpbHRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYXNzZXRzUmVzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb2R1bGVBc3NldHNJbmZvKSB7XG4gICAgICAgICAgICB2YXIgYXNzZXRzTGVuZ3RoID0gbW9kdWxlQXNzZXRzSW5mby5sZW5ndGg7XG4gICAgICAgICAgICBmb3IodmFyIGluZGV4ID0gMDsgaW5kZXggPCBhc3NldHNMZW5ndGg7IGluZGV4Kyspe1xuICAgICAgICAgICAgICAgIHZhciBhc3NldHNJbmZvID0gbW9kdWxlQXNzZXRzSW5mb1tpbmRleF07XG4gICAgICAgICAgICAgICAgdmFyIGV4cG9zZUZ1bGxQYXRoID0gYCR7cmVtb3RlSW5mby5uYW1lfS8ke2Fzc2V0c0luZm8ubW9kdWxlTmFtZX1gO1xuICAgICAgICAgICAgICAgIG9yaWdpbi5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5oYW5kbGVQcmVsb2FkTW9kdWxlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBpZDogYXNzZXRzSW5mby5tb2R1bGVOYW1lID09PSAnLicgPyByZW1vdGVJbmZvLm5hbWUgOiBleHBvc2VGdWxsUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlSW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdDogbW9kdWxlSW5mb1NuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICBwcmVsb2FkQ29uZmlnLFxuICAgICAgICAgICAgICAgICAgICByZW1vdGU6IHJlbW90ZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwcmVsb2FkZWQgPSBnZXRQcmVsb2FkZWQoZXhwb3NlRnVsbFBhdGgpO1xuICAgICAgICAgICAgICAgIGlmIChwcmVsb2FkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwcmVsb2FkQ29uZmlnLnJlc291cmNlQ2F0ZWdvcnkgPT09ICdhbGwnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY3NzQXNzZXRzLCBfY3NzQXNzZXRzMSwgX2pzQXNzZXRzLCBfanNBc3NldHMxO1xuICAgICAgICAgICAgICAgICAgICAoX2Nzc0Fzc2V0cyA9IGNzc0Fzc2V0cykucHVzaC5hcHBseShfY3NzQXNzZXRzLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5jc3MuYXN5bmMpKSk7XG4gICAgICAgICAgICAgICAgICAgIChfY3NzQXNzZXRzMSA9IGNzc0Fzc2V0cykucHVzaC5hcHBseShfY3NzQXNzZXRzMSwgX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhoYW5kbGVBc3NldHMoYXNzZXRzSW5mby5hc3NldHMuY3NzLnN5bmMpKSk7XG4gICAgICAgICAgICAgICAgICAgIChfanNBc3NldHMgPSBqc0Fzc2V0cykucHVzaC5hcHBseShfanNBc3NldHMsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmpzLmFzeW5jKSkpO1xuICAgICAgICAgICAgICAgICAgICAoX2pzQXNzZXRzMSA9IGpzQXNzZXRzKS5wdXNoLmFwcGx5KF9qc0Fzc2V0czEsIF90b19jb25zdW1hYmxlX2FycmF5Ll8oaGFuZGxlQXNzZXRzKGFzc2V0c0luZm8uYXNzZXRzLmpzLnN5bmMpKSk7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlbG9hZENvbmZpZy5yZXNvdXJjZUNhdGVnb3J5ID0gJ3N5bmMnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY3NzQXNzZXRzMiwgX2pzQXNzZXRzMjtcbiAgICAgICAgICAgICAgICAgICAgKF9jc3NBc3NldHMyID0gY3NzQXNzZXRzKS5wdXNoLmFwcGx5KF9jc3NBc3NldHMyLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5jc3Muc3luYykpKTtcbiAgICAgICAgICAgICAgICAgICAgKF9qc0Fzc2V0czIgPSBqc0Fzc2V0cykucHVzaC5hcHBseShfanNBc3NldHMyLCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKGhhbmRsZUFzc2V0cyhhc3NldHNJbmZvLmFzc2V0cy5qcy5zeW5jKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZXRQcmVsb2FkZWQoZXhwb3NlRnVsbFBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgdHJ1ZSwgbWVtbywgcmVtb3RlU25hcHNob3QpO1xuICAgIGlmIChyZW1vdGVTbmFwc2hvdC5zaGFyZWQpIHtcbiAgICAgICAgdmFyIGNvbGxlY3RTaGFyZWRBc3NldHMgPSAoc2hhcmVJbmZvLCBzbmFwc2hvdFNoYXJlZCk9PntcbiAgICAgICAgICAgIHZhciByZWdpc3RlcmVkU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKG9yaWdpbi5zaGFyZVNjb3BlTWFwLCBzbmFwc2hvdFNoYXJlZC5zaGFyZWROYW1lLCBzaGFyZUluZm8sIG9yaWdpbi5zaGFyZWRIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5yZXNvbHZlU2hhcmUpO1xuICAgICAgICAgICAgLy8gSWYgdGhlIGdsb2JhbCBzaGFyZSBkb2VzIG5vdCBleGlzdCwgb3IgdGhlIGxpYiBmdW5jdGlvbiBkb2VzIG5vdCBleGlzdCwgaXQgbWVhbnMgdGhhdCB0aGUgc2hhcmVkIGhhcyBub3QgYmVlbiBsb2FkZWQgeWV0IGFuZCBjYW4gYmUgcHJlbG9hZGVkLlxuICAgICAgICAgICAgaWYgKHJlZ2lzdGVyZWRTaGFyZWQgJiYgdHlwZW9mIHJlZ2lzdGVyZWRTaGFyZWQubGliID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgc25hcHNob3RTaGFyZWQuYXNzZXRzLmpzLnN5bmMuZm9yRWFjaCgoYXNzZXQpPT57XG4gICAgICAgICAgICAgICAgICAgIGxvYWRlZFNoYXJlZEpzQXNzZXRzLmFkZChhc3NldCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgc25hcHNob3RTaGFyZWQuYXNzZXRzLmNzcy5zeW5jLmZvckVhY2goKGFzc2V0KT0+e1xuICAgICAgICAgICAgICAgICAgICBsb2FkZWRTaGFyZWRDc3NBc3NldHMuYWRkKGFzc2V0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmVtb3RlU25hcHNob3Quc2hhcmVkLmZvckVhY2goKHNoYXJlZCk9PntcbiAgICAgICAgICAgIHZhciBfb3B0aW9uc19zaGFyZWQ7XG4gICAgICAgICAgICB2YXIgc2hhcmVJbmZvcyA9IChfb3B0aW9uc19zaGFyZWQgPSBvcHRpb25zLnNoYXJlZCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9vcHRpb25zX3NoYXJlZFtzaGFyZWQuc2hhcmVkTmFtZV07XG4gICAgICAgICAgICBpZiAoIXNoYXJlSW5mb3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiBubyB2ZXJzaW9uLCBwcmVsb2FkIGFsbCBzaGFyZWRcbiAgICAgICAgICAgIHZhciBzaGFyZWRPcHRpb25zID0gc2hhcmVkLnZlcnNpb24gPyBzaGFyZUluZm9zLmZpbmQoKHMpPT5zLnZlcnNpb24gPT09IHNoYXJlZC52ZXJzaW9uKSA6IHNoYXJlSW5mb3M7XG4gICAgICAgICAgICBpZiAoIXNoYXJlZE9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYXJyYXlTaGFyZUluZm8gPSBhcnJheU9wdGlvbnMoc2hhcmVkT3B0aW9ucyk7XG4gICAgICAgICAgICBhcnJheVNoYXJlSW5mby5mb3JFYWNoKChzKT0+e1xuICAgICAgICAgICAgICAgIGNvbGxlY3RTaGFyZWRBc3NldHMocywgc2hhcmVkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgdmFyIG5lZWRQcmVsb2FkSnNBc3NldHMgPSBqc0Fzc2V0cy5maWx0ZXIoKGFzc2V0KT0+IWxvYWRlZFNoYXJlZEpzQXNzZXRzLmhhcyhhc3NldCkpO1xuICAgIHZhciBuZWVkUHJlbG9hZENzc0Fzc2V0cyA9IGNzc0Fzc2V0cy5maWx0ZXIoKGFzc2V0KT0+IWxvYWRlZFNoYXJlZENzc0Fzc2V0cy5oYXMoYXNzZXQpKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjc3NBc3NldHM6IG5lZWRQcmVsb2FkQ3NzQXNzZXRzLFxuICAgICAgICBqc0Fzc2V0c1dpdGhvdXRFbnRyeTogbmVlZFByZWxvYWRKc0Fzc2V0cyxcbiAgICAgICAgZW50cnlBc3NldHNcbiAgICB9O1xufVxudmFyIGdlbmVyYXRlUHJlbG9hZEFzc2V0c1BsdWdpbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6ICdnZW5lcmF0ZS1wcmVsb2FkLWFzc2V0cy1wbHVnaW4nLFxuICAgICAgICBnZW5lcmF0ZVByZWxvYWRBc3NldHMgKGFyZ3MpIHtcbiAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIHZhciBvcmlnaW4gPSBhcmdzLm9yaWdpbiwgcHJlbG9hZE9wdGlvbnMgPSBhcmdzLnByZWxvYWRPcHRpb25zLCByZW1vdGVJbmZvID0gYXJncy5yZW1vdGVJbmZvLCByZW1vdGUgPSBhcmdzLnJlbW90ZSwgZ2xvYmFsU25hcHNob3QgPSBhcmdzLmdsb2JhbFNuYXBzaG90LCByZW1vdGVTbmFwc2hvdCA9IGFyZ3MucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgaWYgKGlzUmVtb3RlSW5mb1dpdGhFbnRyeShyZW1vdGUpICYmIGlzUHVyZVJlbW90ZUVudHJ5KHJlbW90ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzc0Fzc2V0czogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBqc0Fzc2V0c1dpdGhvdXRFbnRyeTogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRyeUFzc2V0czogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogcmVtb3RlLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGVJbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeTogcmVtb3RlLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogcmVtb3RlSW5mby50eXBlIHx8ICdnbG9iYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlHbG9iYWxOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGU6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFzc2lnblJlbW90ZUluZm8ocmVtb3RlSW5mbywgcmVtb3RlU25hcHNob3QpO1xuICAgICAgICAgICAgICAgIHZhciBhc3NldHMgPSBnZW5lcmF0ZVByZWxvYWRBc3NldHMob3JpZ2luLCBwcmVsb2FkT3B0aW9ucywgcmVtb3RlSW5mbywgZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXRzO1xuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuZnVuY3Rpb24gZ2V0R2xvYmFsUmVtb3RlSW5mbyhtb2R1bGVJbmZvLCBvcmlnaW4pIHtcbiAgICB2YXIgaG9zdEdsb2JhbFNuYXBzaG90ID0gZ2V0R2xvYmFsU25hcHNob3RJbmZvQnlNb2R1bGVJbmZvKHtcbiAgICAgICAgbmFtZTogb3JpZ2luLm9wdGlvbnMubmFtZSxcbiAgICAgICAgdmVyc2lvbjogb3JpZ2luLm9wdGlvbnMudmVyc2lvblxuICAgIH0pO1xuICAgIC8vIGdldCByZW1vdGUgZGV0YWlsIGluZm8gZnJvbSBnbG9iYWxcbiAgICB2YXIgZ2xvYmFsUmVtb3RlSW5mbyA9IGhvc3RHbG9iYWxTbmFwc2hvdCAmJiAncmVtb3Rlc0luZm8nIGluIGhvc3RHbG9iYWxTbmFwc2hvdCAmJiBob3N0R2xvYmFsU25hcHNob3QucmVtb3Rlc0luZm8gJiYgZ2V0SW5mb1dpdGhvdXRUeXBlKGhvc3RHbG9iYWxTbmFwc2hvdC5yZW1vdGVzSW5mbywgbW9kdWxlSW5mby5uYW1lKS52YWx1ZTtcbiAgICBpZiAoZ2xvYmFsUmVtb3RlSW5mbyAmJiBnbG9iYWxSZW1vdGVJbmZvLm1hdGNoZWRWZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBob3N0R2xvYmFsU25hcHNob3QsXG4gICAgICAgICAgICBnbG9iYWxTbmFwc2hvdDogZ2V0R2xvYmFsU25hcHNob3QoKSxcbiAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICAgICAgICAgIG5hbWU6IG1vZHVsZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBnbG9iYWxSZW1vdGVJbmZvLm1hdGNoZWRWZXJzaW9uXG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBob3N0R2xvYmFsU25hcHNob3Q6IHVuZGVmaW5lZCxcbiAgICAgICAgZ2xvYmFsU25hcHNob3Q6IGdldEdsb2JhbFNuYXBzaG90KCksXG4gICAgICAgIHJlbW90ZVNuYXBzaG90OiBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICAgICAgbmFtZTogbW9kdWxlSW5mby5uYW1lLFxuICAgICAgICAgICAgdmVyc2lvbjogJ3ZlcnNpb24nIGluIG1vZHVsZUluZm8gPyBtb2R1bGVJbmZvLnZlcnNpb24gOiB1bmRlZmluZWRcbiAgICAgICAgfSlcbiAgICB9O1xufVxudmFyIFNuYXBzaG90SGFuZGxlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gU25hcHNob3RIYW5kbGVyKEhvc3RJbnN0YW5jZSkge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIFNuYXBzaG90SGFuZGxlcik7XG4gICAgICAgIHRoaXMubG9hZGluZ0hvc3RTbmFwc2hvdCA9IG51bGw7XG4gICAgICAgIHRoaXMubWFuaWZlc3RDYWNoZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5ob29rcyA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYmVmb3JlTG9hZFJlbW90ZVNuYXBzaG90OiBuZXcgQXN5bmNIb29rKCdiZWZvcmVMb2FkUmVtb3RlU25hcHNob3QnKSxcbiAgICAgICAgICAgIGxvYWRTbmFwc2hvdDogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnbG9hZEdsb2JhbFNuYXBzaG90JyksXG4gICAgICAgICAgICBsb2FkUmVtb3RlU25hcHNob3Q6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2xvYWRSZW1vdGVTbmFwc2hvdCcpLFxuICAgICAgICAgICAgYWZ0ZXJMb2FkU25hcHNob3Q6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2FmdGVyTG9hZFNuYXBzaG90JylcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubWFuaWZlc3RMb2FkaW5nID0gR2xvYmFsLl9fRkVERVJBVElPTl9fLl9fTUFOSUZFU1RfTE9BRElOR19fO1xuICAgICAgICB0aGlzLkhvc3RJbnN0YW5jZSA9IEhvc3RJbnN0YW5jZTtcbiAgICAgICAgdGhpcy5sb2FkZXJIb29rID0gSG9zdEluc3RhbmNlLmxvYWRlckhvb2s7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhTbmFwc2hvdEhhbmRsZXIsIFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTbmFwc2hvdFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTbmFwc2hvdChtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8gPSB0aGlzLmdldEdsb2JhbFJlbW90ZUluZm8obW9kdWxlSW5mbyksIGhvc3RHbG9iYWxTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8uaG9zdEdsb2JhbFNuYXBzaG90LCByZW1vdGVTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8ucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90ID0gX3RoaXNfZ2V0R2xvYmFsUmVtb3RlSW5mby5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5sb2FkU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RHbG9iYWxTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgfSksIGdsb2JhbFJlbW90ZVNuYXBzaG90ID0gX3JlZi5yZW1vdGVTbmFwc2hvdCwgZ2xvYmFsU25hcHNob3RSZXMgPSBfcmVmLmdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IGdsb2JhbFJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3Q6IGdsb2JhbFNuYXBzaG90UmVzXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRSZW1vdGVTbmFwc2hvdEluZm9cIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxpbmVzLXBlci1mdW5jdGlvblxuICAgICAgICAgICAgZnVuY3Rpb24gbG9hZFJlbW90ZVNuYXBzaG90SW5mbyhtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlTG9hZFJlbW90ZVNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm9cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob3N0U25hcHNob3QgPSBnZXRHbG9iYWxTbmFwc2hvdEluZm9CeU1vZHVsZUluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucy52ZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWhvc3RTbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFNuYXBzaG90ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IHRoaXMuSG9zdEluc3RhbmNlLm9wdGlvbnMudmVyc2lvbiB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFbnRyeTogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3Rlc0luZm86IHt9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkR2xvYmFsU25hcHNob3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLm5hbWVdOiBob3N0U25hcHNob3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEluIGR5bmFtaWMgbG9hZFJlbW90ZSBzY2VuYXJpb3MsIGluY29tcGxldGUgcmVtb3Rlc0luZm8gZGVsaXZlcnkgbWF5IG9jY3VyLiBJbiBzdWNoIGNhc2VzLCB0aGUgcmVtb3Rlc0luZm8gaW4gdGhlIGhvc3QgbmVlZHMgdG8gYmUgY29tcGxldGVkIGluIHRoZSBzbmFwc2hvdCBhdCBydW50aW1lLlxuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGVuc3VyZXMgdGhlIHNuYXBzaG90J3MgaW50ZWdyaXR5IGFuZCBoZWxwcyB0aGUgY2hyb21lIHBsdWdpbiBjb3JyZWN0bHkgaWRlbnRpZnkgYWxsIHByb2R1Y2VyIG1vZHVsZXMsIGVuc3VyaW5nIHRoYXQgcHJveHlhYmxlIHByb2R1Y2VyIG1vZHVsZXMgd2lsbCBub3QgYmUgbWlzc2luZy5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGhvc3RTbmFwc2hvdCAmJiAncmVtb3Rlc0luZm8nIGluIGhvc3RTbmFwc2hvdCAmJiAhZ2V0SW5mb1dpdGhvdXRUeXBlKGhvc3RTbmFwc2hvdC5yZW1vdGVzSW5mbywgbW9kdWxlSW5mby5uYW1lKS52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCd2ZXJzaW9uJyBpbiBtb2R1bGVJbmZvIHx8ICdlbnRyeScgaW4gbW9kdWxlSW5mbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RTbmFwc2hvdC5yZW1vdGVzSW5mbyA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgaG9zdFNuYXBzaG90ID09IG51bGwgPyB2b2lkIDAgOiBob3N0U25hcHNob3QucmVtb3Rlc0luZm8sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW21vZHVsZUluZm8ubmFtZV06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uOiAndmVyc2lvbicgaW4gbW9kdWxlSW5mbyA/IG1vZHVsZUluZm8udmVyc2lvbiA6IG1vZHVsZUluZm8uZW50cnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvID0gdGhpcy5nZXRHbG9iYWxSZW1vdGVJbmZvKG1vZHVsZUluZm8pLCBob3N0R2xvYmFsU25hcHNob3QgPSBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvLmhvc3RHbG9iYWxTbmFwc2hvdCwgcmVtb3RlU25hcHNob3QgPSBfdGhpc19nZXRHbG9iYWxSZW1vdGVJbmZvLnJlbW90ZVNuYXBzaG90LCBnbG9iYWxTbmFwc2hvdCA9IF90aGlzX2dldEdsb2JhbFJlbW90ZUluZm8uZ2xvYmFsU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUubG9hZFNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0R2xvYmFsU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH0pLCBnbG9iYWxSZW1vdGVTbmFwc2hvdCA9IF9yZWYucmVtb3RlU25hcHNob3QsIGdsb2JhbFNuYXBzaG90UmVzID0gX3JlZi5nbG9iYWxTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1TbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgLy8gZ2xvYmFsIHNuYXBzaG90IGluY2x1ZGVzIG1hbmlmZXN0IG9yIG1vZHVsZSBpbmZvIGluY2x1ZGVzIG1hbmlmZXN0XG4gICAgICAgICAgICAgICAgICAgIGlmIChnbG9iYWxSZW1vdGVTbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNkay5pc01hbmlmZXN0UHJvdmlkZXIoZ2xvYmFsUmVtb3RlU25hcHNob3QpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5ID0gc2RrLmlzQnJvd3NlckVudigpID8gZ2xvYmFsUmVtb3RlU25hcHNob3QucmVtb3RlRW50cnkgOiBnbG9iYWxSZW1vdGVTbmFwc2hvdC5zc3JSZW1vdGVFbnRyeSB8fCBnbG9iYWxSZW1vdGVTbmFwc2hvdC5yZW1vdGVFbnRyeSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlU25hcHNob3QgPSB5aWVsZCB0aGlzLmdldE1hbmlmZXN0SnNvbihyZW1vdGVFbnRyeSwgbW9kdWxlSW5mbywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tc2hhZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNuYXBzaG90UmVzMSA9IHNldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyhwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIG1vZHVsZUluZm8sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGdsb2JhbCByZW1vdGUgbWF5IGJlIG92ZXJyaWRkZW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmVmb3JlLCBzZXQgdGhlIHNuYXBzaG90IGtleSB0byB0aGUgZ2xvYmFsIGFkZHJlc3Mgb2YgdGhlIGFjdHVhbCByZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5OiByZW1vdGVFbnRyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBtb2R1bGVTbmFwc2hvdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbVNuYXBzaG90ID0gbW9kdWxlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NuYXBzaG90ID0gZ2xvYmFsU25hcHNob3RSZXMxO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjEgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5sb2FkUmVtb3RlU25hcHNob3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuSG9zdEluc3RhbmNlLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBnbG9iYWxSZW1vdGVTbmFwc2hvdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ2dsb2JhbCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgcmVtb3RlU25hcHNob3RSZXMgPSBfcmVmMS5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtU25hcHNob3QgPSByZW1vdGVTbmFwc2hvdFJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU25hcHNob3QgPSBnbG9iYWxTbmFwc2hvdFJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1JlbW90ZUluZm9XaXRoRW50cnkobW9kdWxlSW5mbykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZnJvbSBtYW5pZmVzdC5qc29uIGFuZCBtZXJnZSByZW1vdGUgaW5mbyBmcm9tIHJlbW90ZSBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlU25hcHNob3QxID0geWllbGQgdGhpcy5nZXRNYW5pZmVzdEpzb24obW9kdWxlSW5mby5lbnRyeSwgbW9kdWxlSW5mbywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tc2hhZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNuYXBzaG90UmVzMiA9IHNldEdsb2JhbFNuYXBzaG90SW5mb0J5TW9kdWxlSW5mbyhtb2R1bGVJbmZvLCBtb2R1bGVTbmFwc2hvdDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMiA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmxvYWRSZW1vdGVTbmFwc2hvdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogdGhpcy5Ib3N0SW5zdGFuY2Uub3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IG1vZHVsZVNuYXBzaG90MSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ2dsb2JhbCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgcmVtb3RlU25hcHNob3RSZXMxID0gX3JlZjIucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbVNuYXBzaG90ID0gcmVtb3RlU25hcHNob3RSZXMxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdTbmFwc2hvdCA9IGdsb2JhbFNuYXBzaG90UmVzMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoZXJyb3JDb2Rlcy5nZXRTaG9ydEVycm9yTXNnKGVycm9yQ29kZXMuUlVOVElNRV8wMDcsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdE5hbWU6IG1vZHVsZUluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFZlcnNpb246IG1vZHVsZUluZm8udmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3Q6IEpTT04uc3RyaW5naWZ5KGdsb2JhbFNuYXBzaG90UmVzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5hZnRlckxvYWRTbmFwc2hvdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU25hcHNob3Q6IG1TbmFwc2hvdFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90OiBtU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTbmFwc2hvdDogZ1NuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImdldEdsb2JhbFJlbW90ZUluZm9cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRHbG9iYWxSZW1vdGVJbmZvMShtb2R1bGVJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEdsb2JhbFJlbW90ZUluZm8obW9kdWxlSW5mbywgdGhpcy5Ib3N0SW5zdGFuY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZ2V0TWFuaWZlc3RKc29uXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWFuaWZlc3RKc29uKG1hbmlmZXN0VXJsLCBtb2R1bGVJbmZvLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdldE1hbmlmZXN0ID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hbmlmZXN0SnNvbiA9IHRoaXMubWFuaWZlc3RDYWNoZS5nZXQobWFuaWZlc3RVcmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYW5pZmVzdEpzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hbmlmZXN0SnNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHlpZWxkIHRoaXMubG9hZGVySG9vay5saWZlY3ljbGUuZmV0Y2guZW1pdChtYW5pZmVzdFVybCwge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlcyB8fCAhKHJlcyBpbnN0YW5jZW9mIFJlc3BvbnNlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0geWllbGQgZmV0Y2gobWFuaWZlc3RVcmwsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdEpzb24gPSB5aWVsZCByZXMuanNvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdEpzb24gPSB5aWVsZCB0aGlzLkhvc3RJbnN0YW5jZS5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5lcnJvckxvYWRSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogbWFuaWZlc3RVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJ2FmdGVyUmVzb2x2ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IHRoaXMuSG9zdEluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1hbmlmZXN0SnNvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMubWFuaWZlc3RMb2FkaW5nW21hbmlmZXN0VXJsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDAzLCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3RVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlTmFtZTogbW9kdWxlSW5mby5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBgJHtlcnJ9YCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydChtYW5pZmVzdEpzb24ubWV0YURhdGEgJiYgbWFuaWZlc3RKc29uLmV4cG9zZXMgJiYgbWFuaWZlc3RKc29uLnNoYXJlZCwgYCR7bWFuaWZlc3RVcmx9IGlzIG5vdCBhIGZlZGVyYXRpb24gbWFuaWZlc3RgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0Q2FjaGUuc2V0KG1hbmlmZXN0VXJsLCBtYW5pZmVzdEpzb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYW5pZmVzdEpzb247XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXN5bmNMb2FkUHJvY2VzcyA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYW5pZmVzdEpzb24gPSB5aWVsZCBnZXRNYW5pZmVzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVTbmFwc2hvdCA9IHNkay5nZW5lcmF0ZVNuYXBzaG90RnJvbU1hbmlmZXN0KG1hbmlmZXN0SnNvbiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiBtYW5pZmVzdFVybFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUubG9hZFJlbW90ZVNuYXBzaG90LmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB0aGlzLkhvc3RJbnN0YW5jZS5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdEpzb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdFVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogJ21hbmlmZXN0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCByZW1vdGVTbmFwc2hvdFJlcyA9IF9yZWYucmVtb3RlU25hcHNob3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbW90ZVNuYXBzaG90UmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLm1hbmlmZXN0TG9hZGluZ1ttYW5pZmVzdFVybF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFuaWZlc3RMb2FkaW5nW21hbmlmZXN0VXJsXSA9IGFzeW5jTG9hZFByb2Nlc3MoKS50aGVuKChyZXMpPT5yZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1hbmlmZXN0TG9hZGluZ1ttYW5pZmVzdFVybF07XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBTbmFwc2hvdEhhbmRsZXI7XG59KCk7XG52YXIgU2hhcmVkSGFuZGxlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gU2hhcmVkSGFuZGxlcihob3N0KSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgU2hhcmVkSGFuZGxlcik7XG4gICAgICAgIHRoaXMuaG9va3MgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIGFmdGVyUmVzb2x2ZTogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYWZ0ZXJSZXNvbHZlJyksXG4gICAgICAgICAgICBiZWZvcmVMb2FkU2hhcmU6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZUxvYWRTaGFyZScpLFxuICAgICAgICAgICAgLy8gbm90IHVzZWQgeWV0XG4gICAgICAgICAgICBsb2FkU2hhcmU6IG5ldyBBc3luY0hvb2soKSxcbiAgICAgICAgICAgIHJlc29sdmVTaGFyZTogbmV3IFN5bmNXYXRlcmZhbGxIb29rKCdyZXNvbHZlU2hhcmUnKSxcbiAgICAgICAgICAgIC8vIG1heWJlIHdpbGwgY2hhbmdlLCB0ZW1wb3JhcmlseSBmb3IgaW50ZXJuYWwgdXNlIG9ubHlcbiAgICAgICAgICAgIGluaXRDb250YWluZXJTaGFyZVNjb3BlTWFwOiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ2luaXRDb250YWluZXJTaGFyZVNjb3BlTWFwJylcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XG4gICAgICAgIHRoaXMuc2hhcmVTY29wZU1hcCA9IHt9O1xuICAgICAgICB0aGlzLmluaXRUb2tlbnMgPSB7fTtcbiAgICAgICAgdGhpcy5fc2V0R2xvYmFsU2hhcmVTY29wZU1hcChob3N0Lm9wdGlvbnMpO1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oU2hhcmVkSGFuZGxlciwgW1xuICAgICAgICB7XG4gICAgICAgICAgICAvLyByZWdpc3RlciBzaGFyZWQgaW4gc2hhcmVTY29wZU1hcFxuICAgICAgICAgICAga2V5OiBcInJlZ2lzdGVyU2hhcmVkXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJTaGFyZWQoZ2xvYmFsT3B0aW9ucywgdXNlck9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2Zvcm1hdFNoYXJlQ29uZmlncyA9IGZvcm1hdFNoYXJlQ29uZmlncyhnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucyksIHNoYXJlSW5mb3MgPSBfZm9ybWF0U2hhcmVDb25maWdzLnNoYXJlSW5mb3MsIHNoYXJlZCA9IF9mb3JtYXRTaGFyZUNvbmZpZ3Muc2hhcmVkO1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZWRLZXlzID0gT2JqZWN0LmtleXMoc2hhcmVJbmZvcyk7XG4gICAgICAgICAgICAgICAgc2hhcmVkS2V5cy5mb3JFYWNoKChzaGFyZWRLZXkpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWRWYWxzID0gc2hhcmVJbmZvc1tzaGFyZWRLZXldO1xuICAgICAgICAgICAgICAgICAgICBzaGFyZWRWYWxzLmZvckVhY2goKHNoYXJlZFZhbCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWdpc3RlcmVkU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKHRoaXMuc2hhcmVTY29wZU1hcCwgc2hhcmVkS2V5LCBzaGFyZWRWYWwsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlZ2lzdGVyZWRTaGFyZWQgJiYgc2hhcmVkVmFsICYmIHNoYXJlZFZhbC5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNoYXJlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWU6IHNoYXJlZEtleSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliOiBzaGFyZWRWYWwubGliLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXQ6IHNoYXJlZFZhbC5nZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkOiBzaGFyZWRWYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IHVzZXJPcHRpb25zLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvcyxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRTaGFyZShwa2dOYW1lLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZnVuY3Rpb24gcGVyZm9ybXMgdGhlIGZvbGxvd2luZyBzdGVwczpcbiAgICAgICAgICAgICAgICAgICAgLy8gMS4gQ2hlY2tzIGlmIHRoZSBjdXJyZW50bHkgbG9hZGVkIHNoYXJlIGFscmVhZHkgZXhpc3RzLCBpZiBub3QsIGl0IHRocm93cyBhbiBlcnJvclxuICAgICAgICAgICAgICAgICAgICAvLyAyLiBTZWFyY2hlcyBnbG9iYWxseSBmb3IgYSBtYXRjaGluZyBzaGFyZSwgaWYgZm91bmQsIGl0IHVzZXMgaXQgZGlyZWN0bHlcbiAgICAgICAgICAgICAgICAgICAgLy8gMy4gSWYgbm90IGZvdW5kLCBpdCByZXRyaWV2ZXMgaXQgZnJvbSB0aGUgY3VycmVudCBzaGFyZSBhbmQgc3RvcmVzIHRoZSBvYnRhaW5lZCBzaGFyZSBnbG9iYWxseS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlSW5mbyA9IGdldFRhcmdldFNoYXJlZE9wdGlvbnMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb3M6IGhvc3Qub3B0aW9ucy5zaGFyZWRcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZUluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IHNoYXJlSW5mby5zY29wZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgUHJvbWlzZS5hbGwoc2hhcmVJbmZvLnNjb3BlLm1hcCgoc2hhcmVTY29wZSk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIFByb21pc2UuYWxsKHRoaXMuaW5pdGlhbGl6ZVNoYXJpbmcoc2hhcmVTY29wZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3k6IHNoYXJlSW5mby5zdHJhdGVneVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRTaGFyZVJlcyA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZUxvYWRTaGFyZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IGhvc3Qub3B0aW9ucy5zaGFyZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZUluZm9SZXMgPSBsb2FkU2hhcmVSZXMuc2hhcmVJbmZvO1xuICAgICAgICAgICAgICAgICAgICAvLyBBc3NlcnQgdGhhdCBzaGFyZUluZm9SZXMgZXhpc3RzLCBpZiBub3QsIHRocm93IGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChzaGFyZUluZm9SZXMsIGBDYW5ub3QgZmluZCAke3BrZ05hbWV9IFNoYXJlIGluIHRoZSAke2hvc3Qub3B0aW9ucy5uYW1lfS4gUGxlYXNlIGVuc3VyZSB0aGF0IHRoZSAke3BrZ05hbWV9IFNoYXJlIHBhcmFtZXRlcnMgaGF2ZSBiZWVuIGluamVjdGVkYCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJldHJpZXZlIGZyb20gY2FjaGVcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUodGhpcy5zaGFyZVNjb3BlTWFwLCBwa2dOYW1lLCBzaGFyZUluZm9SZXMsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhZGRVc2VJbiA9IChzaGFyZWQpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNoYXJlZC51c2VJbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZC51c2VJbiA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVW5pcXVlSXRlbShzaGFyZWQudXNlSW4sIGhvc3Qub3B0aW9ucy5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlZ2lzdGVyZWRTaGFyZWQgJiYgcmVnaXN0ZXJlZFNoYXJlZC5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHJlZ2lzdGVyZWRTaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2lzdGVyZWRTaGFyZWQubGliO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlZ2lzdGVyZWRTaGFyZWQgJiYgcmVnaXN0ZXJlZFNoYXJlZC5sb2FkaW5nICYmICFyZWdpc3RlcmVkU2hhcmVkLmxvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhY3RvcnkgPSB5aWVsZCByZWdpc3RlcmVkU2hhcmVkLmxvYWRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpc3RlcmVkU2hhcmVkLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlZ2lzdGVyZWRTaGFyZWQubGliKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJlZFNoYXJlZC5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4ocmVnaXN0ZXJlZFNoYXJlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWdpc3RlcmVkU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXN5bmNMb2FkUHJvY2VzcyA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFjdG9yeSA9IHlpZWxkIHJlZ2lzdGVyZWRTaGFyZWQuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mb1Jlcy5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9SZXMubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVXNlSW4oc2hhcmVJbmZvUmVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdTaGFyZWQgPSBnZXRSZWdpc3RlcmVkU2hhcmUodGhpcy5zaGFyZVNjb3BlTWFwLCBwa2dOYW1lLCBzaGFyZUluZm9SZXMsIHRoaXMuaG9va3MubGlmZWN5Y2xlLnJlc29sdmVTaGFyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU2hhcmVkLmxpYiA9IGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnU2hhcmVkLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2FkaW5nID0gYXN5bmNMb2FkUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTaGFyZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHJlZ2lzdGVyZWRTaGFyZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRpbmc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuY3VzdG9tU2hhcmVJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzeW5jTG9hZFByb2Nlc3MxID0gKCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWN0b3J5ID0geWllbGQgc2hhcmVJbmZvUmVzLmdldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9SZXMubGliID0gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvUmVzLmxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHNoYXJlSW5mb1Jlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnU2hhcmVkID0gZ2V0UmVnaXN0ZXJlZFNoYXJlKHRoaXMuc2hhcmVTY29wZU1hcCwgcGtnTmFtZSwgc2hhcmVJbmZvUmVzLCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5yZXNvbHZlU2hhcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ1NoYXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NoYXJlZC5saWIgPSBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1NoYXJlZC5sb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZGluZzEgPSBhc3luY0xvYWRQcm9jZXNzMSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTaGFyZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHNoYXJlSW5mb1JlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWI6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZzogbG9hZGluZzFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRpbmcxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAqIFRoaXMgZnVuY3Rpb24gaW5pdGlhbGl6ZXMgdGhlIHNoYXJpbmcgc2VxdWVuY2UgKGV4ZWN1dGVkIG9ubHkgb25jZSBwZXIgc2hhcmUgc2NvcGUpLlxuICAgKiBJdCBhY2NlcHRzIG9uZSBhcmd1bWVudCwgdGhlIG5hbWUgb2YgdGhlIHNoYXJlIHNjb3BlLlxuICAgKiBJZiB0aGUgc2hhcmUgc2NvcGUgZG9lcyBub3QgZXhpc3QsIGl0IGNyZWF0ZXMgb25lLlxuICAgKi8gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9tZW1iZXItb3JkZXJpbmdcbiAgICAgICAgICAgIGtleTogXCJpbml0aWFsaXplU2hhcmluZ1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemVTaGFyaW5nKHJlZiwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGVOYW1lID0gcmVmID09PSB2b2lkIDAgPyBERUZBVUxUX1NDT1BFIDogcmVmO1xuICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgIHZhciBmcm9tID0gZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuZnJvbTtcbiAgICAgICAgICAgICAgICB2YXIgc3RyYXRlZ3kgPSBleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5zdHJhdGVneTtcbiAgICAgICAgICAgICAgICB2YXIgaW5pdFNjb3BlID0gZXh0cmFPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBleHRyYU9wdGlvbnMuaW5pdFNjb3BlO1xuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChmcm9tICE9PSAnYnVpbGQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbml0VG9rZW5zID0gdGhpcy5pbml0VG9rZW5zO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWluaXRTY29wZSkgaW5pdFNjb3BlID0gW107XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbml0VG9rZW4gPSBpbml0VG9rZW5zW3NoYXJlU2NvcGVOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpbml0VG9rZW4pIGluaXRUb2tlbiA9IGluaXRUb2tlbnNbc2hhcmVTY29wZU5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogdGhpcy5ob3N0Lm5hbWVcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluaXRTY29wZS5pbmRleE9mKGluaXRUb2tlbikgPj0gMCkgcmV0dXJuIHByb21pc2VzO1xuICAgICAgICAgICAgICAgICAgICBpbml0U2NvcGUucHVzaChpbml0VG9rZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2hhcmVTY29wZSA9IHRoaXMuc2hhcmVTY29wZU1hcDtcbiAgICAgICAgICAgICAgICB2YXIgaG9zdE5hbWUgPSBob3N0Lm9wdGlvbnMubmFtZTtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGVzIGEgbmV3IHNoYXJlIHNjb3BlIGlmIG5lY2Vzc2FyeVxuICAgICAgICAgICAgICAgIGlmICghc2hhcmVTY29wZVtzaGFyZVNjb3BlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZVtzaGFyZVNjb3BlTmFtZV0gPSB7fTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRXhlY3V0ZXMgYWxsIGluaXRpYWxpemF0aW9uIHNuaXBwZXRzIGZyb20gYWxsIGFjY2Vzc2libGUgbW9kdWxlc1xuICAgICAgICAgICAgICAgIHZhciBzY29wZSA9IHNoYXJlU2NvcGVbc2hhcmVTY29wZU5hbWVdO1xuICAgICAgICAgICAgICAgIHZhciByZWdpc3RlciA9IChuYW1lMSwgc2hhcmVkKT0+e1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2FjdGl2ZVZlcnNpb25fc2hhcmVDb25maWc7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gc2hhcmVkLnZlcnNpb24sIGVhZ2VyID0gc2hhcmVkLmVhZ2VyO1xuICAgICAgICAgICAgICAgICAgICBzY29wZVtuYW1lMV0gPSBzY29wZVtuYW1lMV0gfHwge307XG4gICAgICAgICAgICAgICAgICAgIHZhciB2ZXJzaW9ucyA9IHNjb3BlW25hbWUxXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVZlcnNpb24gPSB2ZXJzaW9uc1t2ZXJzaW9uXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVZlcnNpb25FYWdlciA9IEJvb2xlYW4oYWN0aXZlVmVyc2lvbiAmJiAoYWN0aXZlVmVyc2lvbi5lYWdlciB8fCAoKF9hY3RpdmVWZXJzaW9uX3NoYXJlQ29uZmlnID0gYWN0aXZlVmVyc2lvbi5zaGFyZUNvbmZpZykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hY3RpdmVWZXJzaW9uX3NoYXJlQ29uZmlnLmVhZ2VyKSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWFjdGl2ZVZlcnNpb24gfHwgYWN0aXZlVmVyc2lvbi5zdHJhdGVneSAhPT0gJ2xvYWRlZC1maXJzdCcgJiYgIWFjdGl2ZVZlcnNpb24ubG9hZGVkICYmIChCb29sZWFuKCFlYWdlcikgIT09ICFhY3RpdmVWZXJzaW9uRWFnZXIgPyBlYWdlciA6IGhvc3ROYW1lID4gYWN0aXZlVmVyc2lvbi5mcm9tKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbnNbdmVyc2lvbl0gPSBzaGFyZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBpbml0Rm4gPSAobW9kKT0+bW9kICYmIG1vZC5pbml0ICYmIG1vZC5pbml0KHNoYXJlU2NvcGVbc2hhcmVTY29wZU5hbWVdLCBpbml0U2NvcGUpO1xuICAgICAgICAgICAgICAgIHZhciBpbml0UmVtb3RlTW9kdWxlID0gKGtleSk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gKHlpZWxkIGhvc3QucmVtb3RlSGFuZGxlci5nZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDoga2V5XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSkubW9kdWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZHVsZS5nZXRFbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVFbnRyeUV4cG9ydHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgbW9kdWxlLmdldEVudHJ5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRW50cnlFeHBvcnRzID0geWllbGQgaG9zdC5yZW1vdGVIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5lcnJvckxvYWRSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDoga2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAncnVudGltZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZlY3ljbGU6ICdiZWZvcmVMb2FkU2hhcmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZHVsZS5pbml0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgaW5pdEZuKHJlbW90ZUVudHJ5RXhwb3J0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZS5pbml0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhob3N0Lm9wdGlvbnMuc2hhcmVkKS5mb3JFYWNoKChzaGFyZU5hbWUpPT57XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWRBcnIgPSBob3N0Lm9wdGlvbnMuc2hhcmVkW3NoYXJlTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZEFyci5mb3JFYWNoKChzaGFyZWQpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hhcmVkLnNjb3BlLmluY2x1ZGVzKHNoYXJlU2NvcGVOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyKHNoYXJlTmFtZSwgc2hhcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogc3RyYXRlZ3k9PT0ndmVyc2lvbi1maXJzdCcgbmVlZCB0byBiZSByZW1vdmVkIGluIHRoZSBmdXR1cmVcbiAgICAgICAgICAgICAgICBpZiAoaG9zdC5vcHRpb25zLnNoYXJlU3RyYXRlZ3kgPT09ICd2ZXJzaW9uLWZpcnN0JyB8fCBzdHJhdGVneSA9PT0gJ3ZlcnNpb24tZmlyc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGhvc3Qub3B0aW9ucy5yZW1vdGVzLmZvckVhY2goKHJlbW90ZSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdGUuc2hhcmVTY29wZSA9PT0gc2hhcmVTY29wZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGluaXRSZW1vdGVNb2R1bGUocmVtb3RlLm5hbWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVGhlIGxpYiBmdW5jdGlvbiB3aWxsIG9ubHkgYmUgYXZhaWxhYmxlIGlmIHRoZSBzaGFyZWQgc2V0IGJ5IGVhZ2VyIG9yIHJ1bnRpbWUgaW5pdCBpcyBzZXQgb3IgdGhlIHNoYXJlZCBpcyBzdWNjZXNzZnVsbHkgbG9hZGVkLlxuICAgICAgICAgICAgLy8gMS4gSWYgdGhlIGxvYWRlZCBzaGFyZWQgYWxyZWFkeSBleGlzdHMgZ2xvYmFsbHksIHRoZW4gaXQgd2lsbCBiZSByZXVzZWRcbiAgICAgICAgICAgIC8vIDIuIElmIGxpYiBleGlzdHMgaW4gbG9jYWwgc2hhcmVkLCBpdCB3aWxsIGJlIHVzZWQgZGlyZWN0bHlcbiAgICAgICAgICAgIC8vIDMuIElmIHRoZSBsb2NhbCBnZXQgcmV0dXJucyBzb21ldGhpbmcgb3RoZXIgdGhhbiBQcm9taXNlLCB0aGVuIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseVxuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVN5bmNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkU2hhcmVTeW5jKHBrZ05hbWUsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZUluZm8gPSBnZXRUYXJnZXRTaGFyZWRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZXh0cmFPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm9zOiBob3N0Lm9wdGlvbnMuc2hhcmVkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mbyA9PSBudWxsID8gdm9pZCAwIDogc2hhcmVJbmZvLnNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mby5zY29wZS5mb3JFYWNoKChzaGFyZVNjb3BlKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplU2hhcmluZyhzaGFyZVNjb3BlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3k6IHNoYXJlSW5mby5zdHJhdGVneVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVnaXN0ZXJlZFNoYXJlZCA9IGdldFJlZ2lzdGVyZWRTaGFyZSh0aGlzLnNoYXJlU2NvcGVNYXAsIHBrZ05hbWUsIHNoYXJlSW5mbywgdGhpcy5ob29rcy5saWZlY3ljbGUucmVzb2x2ZVNoYXJlKTtcbiAgICAgICAgICAgICAgICB2YXIgYWRkVXNlSW4gPSAoc2hhcmVkKT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNoYXJlZC51c2VJbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkLnVzZUluID0gW107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYWRkVW5pcXVlSXRlbShzaGFyZWQudXNlSW4sIGhvc3Qub3B0aW9ucy5uYW1lKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChyZWdpc3RlcmVkU2hhcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVnaXN0ZXJlZFNoYXJlZC5saWIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHJlZ2lzdGVyZWRTaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZWdpc3RlcmVkU2hhcmVkLmxvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyZWRTaGFyZWQubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVnaXN0ZXJlZFNoYXJlZC5mcm9tID09PSBob3N0Lm9wdGlvbnMubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm8ubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnaXN0ZXJlZFNoYXJlZC5saWI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZWdpc3RlcmVkU2hhcmVkLmdldCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZSA9IHJlZ2lzdGVyZWRTaGFyZWQuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShtb2R1bGUgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVzZUluKHJlZ2lzdGVyZWRTaGFyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2hhcmVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGtnTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBob3N0Lm9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliOiBtb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZDogcmVnaXN0ZXJlZFNoYXJlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mby5saWIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzaGFyZUluZm8ubG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUluZm8ubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hhcmVJbmZvLmxpYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNoYXJlSW5mby5nZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZTEgPSBzaGFyZUluZm8uZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtb2R1bGUxIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yQ29kZSA9IChleHRyYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4dHJhT3B0aW9ucy5mcm9tKSA9PT0gJ2J1aWxkJyA/IGVycm9yQ29kZXMuUlVOVElNRV8wMDUgOiBlcnJvckNvZGVzLlJVTlRJTUVfMDA2O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGUsIGVycm9yQ29kZXMucnVudGltZURlc2NNYXAsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkUGtnTmFtZTogcGtnTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlSW5mby5saWIgPSBtb2R1bGUxO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNoYXJlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwa2dOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaWI6IHNoYXJlSW5mby5saWIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWQ6IHNoYXJlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNoYXJlSW5mby5saWI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvckNvZGVzLmdldFNob3J0RXJyb3JNc2coZXJyb3JDb2Rlcy5SVU5USU1FXzAwNiwgZXJyb3JDb2Rlcy5ydW50aW1lRGVzY01hcCwge1xuICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZFBrZ05hbWU6IHBrZ05hbWVcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0U2hhcmVTY29wZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRTaGFyZVNjb3BlTWFwKHNjb3BlTmFtZSwgc2hhcmVTY29wZSwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4dHJhT3B0aW9ucyA9IHJlZiA9PT0gdm9pZCAwID8ge30gOiByZWY7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwW3Njb3BlTmFtZV0gPSBzaGFyZVNjb3BlO1xuICAgICAgICAgICAgICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmluaXRDb250YWluZXJTaGFyZVNjb3BlTWFwLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBzaGFyZVNjb3BlLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVOYW1lLFxuICAgICAgICAgICAgICAgICAgICBob3N0U2hhcmVTY29wZU1hcDogZXh0cmFPcHRpb25zLmhvc3RTaGFyZVNjb3BlTWFwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJzZXRTaGFyZWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTaGFyZWQocmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBrZ05hbWUgPSByZWYucGtnTmFtZSwgc2hhcmVkID0gcmVmLnNoYXJlZCwgZnJvbSA9IHJlZi5mcm9tLCBsaWIgPSByZWYubGliLCBsb2FkaW5nID0gcmVmLmxvYWRpbmcsIGxvYWRlZCA9IHJlZi5sb2FkZWQsIGdldCA9IHJlZi5nZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHZlcnNpb24gPSBzaGFyZWQudmVyc2lvbiwgX3NoYXJlZF9zY29wZSA9IHNoYXJlZC5zY29wZSwgc2NvcGUgPSBfc2hhcmVkX3Njb3BlID09PSB2b2lkIDAgPyAnZGVmYXVsdCcgOiBfc2hhcmVkX3Njb3BlLCBzaGFyZUluZm8gPSBwb2x5ZmlsbHMuX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2Uoc2hhcmVkLCBbXG4gICAgICAgICAgICAgICAgICAgIFwidmVyc2lvblwiLFxuICAgICAgICAgICAgICAgICAgICBcInNjb3BlXCJcbiAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NvcGVzID0gQXJyYXkuaXNBcnJheShzY29wZSkgPyBzY29wZSA6IFtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIHNjb3Blcy5mb3JFYWNoKChzYyk9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNoYXJlU2NvcGVNYXBbc2NdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdID0ge307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdID0ge307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dID0gcG9seWZpbGxzLl9leHRlbmRzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkZWZhdWx0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHNoYXJlSW5mbywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwW3NjXVtwa2dOYW1lXVt2ZXJzaW9uXS5nZXQgPSBnZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZ2lzdGVyZWRTaGFyZWQgPSB0aGlzLnNoYXJlU2NvcGVNYXBbc2NdW3BrZ05hbWVdW3ZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGluZyAmJiAhcmVnaXN0ZXJlZFNoYXJlZC5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpc3RlcmVkU2hhcmVkLmxvYWRpbmcgPSBsb2FkaW5nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJfc2V0R2xvYmFsU2hhcmVTY29wZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRHbG9iYWxTaGFyZVNjb3BlTWFwKGhvc3RPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNoYXJlU2NvcGVNYXAgPSBnZXRHbG9iYWxTaGFyZVNjb3BlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGlkZW50aWZpZXIgPSBob3N0T3B0aW9ucy5pZCB8fCBob3N0T3B0aW9ucy5uYW1lO1xuICAgICAgICAgICAgICAgIGlmIChpZGVudGlmaWVyICYmICFnbG9iYWxTaGFyZVNjb3BlTWFwW2lkZW50aWZpZXJdKSB7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbFNoYXJlU2NvcGVNYXBbaWRlbnRpZmllcl0gPSB0aGlzLnNoYXJlU2NvcGVNYXA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIFNoYXJlZEhhbmRsZXI7XG59KCk7XG52YXIgUmVtb3RlSGFuZGxlciA9IC8qI19fUFVSRV9fKi8gZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gUmVtb3RlSGFuZGxlcihob3N0KSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgUmVtb3RlSGFuZGxlcik7XG4gICAgICAgIHRoaXMuaG9va3MgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIGJlZm9yZVJlZ2lzdGVyUmVtb3RlOiBuZXcgU3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZVJlZ2lzdGVyUmVtb3RlJyksXG4gICAgICAgICAgICByZWdpc3RlclJlbW90ZTogbmV3IFN5bmNXYXRlcmZhbGxIb29rKCdyZWdpc3RlclJlbW90ZScpLFxuICAgICAgICAgICAgYmVmb3JlUmVxdWVzdDogbmV3IEFzeW5jV2F0ZXJmYWxsSG9vaygnYmVmb3JlUmVxdWVzdCcpLFxuICAgICAgICAgICAgb25Mb2FkOiBuZXcgQXN5bmNIb29rKCdvbkxvYWQnKSxcbiAgICAgICAgICAgIGhhbmRsZVByZWxvYWRNb2R1bGU6IG5ldyBTeW5jSG9vaygnaGFuZGxlUHJlbG9hZE1vZHVsZScpLFxuICAgICAgICAgICAgZXJyb3JMb2FkUmVtb3RlOiBuZXcgQXN5bmNIb29rKCdlcnJvckxvYWRSZW1vdGUnKSxcbiAgICAgICAgICAgIGJlZm9yZVByZWxvYWRSZW1vdGU6IG5ldyBBc3luY0hvb2soJ2JlZm9yZVByZWxvYWRSZW1vdGUnKSxcbiAgICAgICAgICAgIGdlbmVyYXRlUHJlbG9hZEFzc2V0czogbmV3IEFzeW5jSG9vaygnZ2VuZXJhdGVQcmVsb2FkQXNzZXRzJyksXG4gICAgICAgICAgICAvLyBub3QgdXNlZCB5ZXRcbiAgICAgICAgICAgIGFmdGVyUHJlbG9hZFJlbW90ZTogbmV3IEFzeW5jSG9vaygpLFxuICAgICAgICAgICAgbG9hZEVudHJ5OiBuZXcgQXN5bmNIb29rKClcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XG4gICAgICAgIHRoaXMuaWRUb1JlbW90ZU1hcCA9IHt9O1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oUmVtb3RlSGFuZGxlciwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZm9ybWF0QW5kUmVnaXN0ZXJSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JtYXRBbmRSZWdpc3RlclJlbW90ZShnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciB1c2VyUmVtb3RlcyA9IHVzZXJPcHRpb25zLnJlbW90ZXMgfHwgW107XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJSZW1vdGVzLnJlZHVjZSgocmVzLCByZW1vdGUpPT57XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJSZW1vdGUocmVtb3RlLCByZXMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9LCBnbG9iYWxPcHRpb25zLnJlbW90ZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwic2V0SWRUb1JlbW90ZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldElkVG9SZW1vdGVNYXAoaWQsIHJlbW90ZU1hdGNoSW5mbykge1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSByZW1vdGVNYXRjaEluZm8ucmVtb3RlLCBleHBvc2UgPSByZW1vdGVNYXRjaEluZm8uZXhwb3NlO1xuICAgICAgICAgICAgICAgIHZhciBuYW1lMSA9IHJlbW90ZS5uYW1lLCBhbGlhcyA9IHJlbW90ZS5hbGlhcztcbiAgICAgICAgICAgICAgICB0aGlzLmlkVG9SZW1vdGVNYXBbaWRdID0ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiByZW1vdGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZXhwb3NlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoYWxpYXMgJiYgaWQuc3RhcnRzV2l0aChuYW1lMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkV2l0aEFsaWFzID0gaWQucmVwbGFjZShuYW1lMSwgYWxpYXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlkVG9SZW1vdGVNYXBbaWRXaXRoQWxpYXNdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVtb3RlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWxpYXMgJiYgaWQuc3RhcnRzV2l0aChhbGlhcykpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkV2l0aE5hbWUgPSBpZC5yZXBsYWNlKGFsaWFzLCBuYW1lMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaWRUb1JlbW90ZU1hcFtpZFdpdGhOYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlbW90ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3NlXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9hZFJlbW90ZVwiLFxuICAgICAgICAgICAgdmFsdWU6IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGluZXMtcGVyLWZ1bmN0aW9uXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAgZnVuY3Rpb24gbG9hZFJlbW90ZShpZCwgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gb3B0aW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZEZhY3Rvcnk6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9yZWZfbG9hZEZhY3RvcnkgPSBfcmVmLmxvYWRGYWN0b3J5LCBsb2FkRmFjdG9yeSA9IF9yZWZfbG9hZEZhY3RvcnkgPT09IHZvaWQgMCA/IHRydWUgOiBfcmVmX2xvYWRGYWN0b3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMS4gVmFsaWRhdGUgdGhlIHBhcmFtZXRlcnMgb2YgdGhlIHJldHJpZXZlZCBtb2R1bGUuIFRoZXJlIGFyZSB0d28gbW9kdWxlIHJlcXVlc3QgbWV0aG9kczogcGtnTmFtZSArIGV4cG9zZSBhbmQgYWxpYXMgKyBleHBvc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAyLiBSZXF1ZXN0IHRoZSBzbmFwc2hvdCBpbmZvcm1hdGlvbiBvZiB0aGUgY3VycmVudCBob3N0IGFuZCBnbG9iYWxseSBzdG9yZSB0aGUgb2J0YWluZWQgc25hcHNob3QgaW5mb3JtYXRpb24uIFRoZSByZXRyaWV2ZWQgbW9kdWxlIGluZm9ybWF0aW9uIGlzIHBhcnRpYWxseSBvZmZsaW5lIGFuZCBwYXJ0aWFsbHkgb25saW5lLiBUaGUgb25saW5lIG1vZHVsZSBpbmZvcm1hdGlvbiB3aWxsIHJldHJpZXZlIHRoZSBtb2R1bGVzIHVzZWQgb25saW5lLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMy4gUmV0cmlldmUgdGhlIGRldGFpbGVkIGluZm9ybWF0aW9uIG9mIHRoZSBjdXJyZW50IG1vZHVsZSBmcm9tIGdsb2JhbCAocmVtb3RlRW50cnkgYWRkcmVzcywgZXhwb3NlIHJlc291cmNlIGFkZHJlc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA0LiBBZnRlciByZXRyaWV2aW5nIHJlbW90ZUVudHJ5LCBjYWxsIHRoZSBpbml0IG9mIHRoZSBtb2R1bGUsIGFuZCB0aGVuIHJldHJpZXZlIHRoZSBleHBvcnRlZCBjb250ZW50IG9mIHRoZSBtb2R1bGUgdGhyb3VnaCBnZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlkOiBwa2dOYW1lKEBmZWRlcmF0aW9uL2FwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBAZmVkZXJhdGlvbi9hcHAxL2J1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWQ6IGFsaWFzKGFwcDEpICsgZXhwb3NlKGJ1dHRvbikgPSBhcHAxL2J1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWQ6IGFsaWFzKGFwcDEvdXRpbHMpICsgZXhwb3NlKGxvYWRhc2gvc29ydCkgPSBhcHAxL3V0aWxzL2xvYWRhc2gvc29ydFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYxID0geWllbGQgdGhpcy5nZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSksIG1vZHVsZSA9IF9yZWYxLm1vZHVsZSwgbW9kdWxlT3B0aW9ucyA9IF9yZWYxLm1vZHVsZU9wdGlvbnMsIHJlbW90ZU1hdGNoSW5mbyA9IF9yZWYxLnJlbW90ZU1hdGNoSW5mbztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwa2dOYW1lT3JBbGlhcyA9IHJlbW90ZU1hdGNoSW5mby5wa2dOYW1lT3JBbGlhcywgcmVtb3RlID0gcmVtb3RlTWF0Y2hJbmZvLnJlbW90ZSwgZXhwb3NlID0gcmVtb3RlTWF0Y2hJbmZvLmV4cG9zZSwgaWRSZXMgPSByZW1vdGVNYXRjaEluZm8uaWQsIHJlbW90ZVNuYXBzaG90ID0gcmVtb3RlTWF0Y2hJbmZvLnJlbW90ZVNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZU9yRmFjdG9yeSA9IHlpZWxkIG1vZHVsZS5nZXQoaWRSZXMsIGV4cG9zZSwgb3B0aW9ucywgcmVtb3RlU25hcHNob3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZVdyYXBwZXIgPSB5aWVsZCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5vbkxvYWQuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkUmVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrZ05hbWVPckFsaWFzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvc2VNb2R1bGU6IGxvYWRGYWN0b3J5ID8gbW9kdWxlT3JGYWN0b3J5IDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9zZU1vZHVsZUZhY3Rvcnk6IGxvYWRGYWN0b3J5ID8gdW5kZWZpbmVkIDogbW9kdWxlT3JGYWN0b3J5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBtb2R1bGVPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZUluc3RhbmNlOiBtb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0SWRUb1JlbW90ZU1hcChpZCwgcmVtb3RlTWF0Y2hJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbW9kdWxlV3JhcHBlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGVXcmFwcGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZU9yRmFjdG9yeTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMiA9IG9wdGlvbnMgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgX3JlZl9mcm9tID0gX3JlZjIuZnJvbSwgZnJvbSA9IF9yZWZfZnJvbSA9PT0gdm9pZCAwID8gJ3J1bnRpbWUnIDogX3JlZl9mcm9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWxPdmVyID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuZXJyb3JMb2FkUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb20sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlmZWN5Y2xlOiAnb25Mb2FkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmYWlsT3Zlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhaWxPdmVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInByZWxvYWRSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAgZnVuY3Rpb24gcHJlbG9hZFJlbW90ZShwcmVsb2FkT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlUHJlbG9hZFJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRPcHM6IHByZWxvYWRPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogaG9zdC5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJlbG9hZE9wcyA9IGZvcm1hdFByZWxvYWRBcmdzKGhvc3Qub3B0aW9ucy5yZW1vdGVzLCBwcmVsb2FkT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIFByb21pc2UuYWxsKHByZWxvYWRPcHMubWFwKChvcHMpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSBvcHMucmVtb3RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gZ2V0UmVtb3RlSW5mbyhyZW1vdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0geWllbGQgaG9zdC5zbmFwc2hvdEhhbmRsZXIubG9hZFJlbW90ZVNuYXBzaG90SW5mbyhyZW1vdGUpLCBnbG9iYWxTbmFwc2hvdCA9IF9yZWYuZ2xvYmFsU25hcHNob3QsIHJlbW90ZVNuYXBzaG90ID0gX3JlZi5yZW1vdGVTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzZXRzID0geWllbGQgdGhpcy5ob29rcy5saWZlY3ljbGUuZ2VuZXJhdGVQcmVsb2FkQXNzZXRzLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRPcHRpb25zOiBvcHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU25hcHNob3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhc3NldHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVsb2FkQXNzZXRzKHJlbW90ZUluZm8sIGhvc3QsIGFzc2V0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpKSk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInJlZ2lzdGVyUmVtb3Rlc1wiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyUmVtb3RlcyhyZW1vdGVzLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgcmVtb3Rlcy5mb3JFYWNoKChyZW1vdGUpPT57XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJSZW1vdGUocmVtb3RlLCBob3N0Lm9wdGlvbnMucmVtb3Rlcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2U6IG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuZm9yY2VcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJnZXRSZW1vdGVNb2R1bGVBbmRPcHRpb25zXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVtb3RlTW9kdWxlQW5kT3B0aW9ucyhvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBvcHRpb25zLmlkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFJlbW90ZUFyZ3M7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkUmVtb3RlQXJncyA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZVJlcXVlc3QuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogaG9zdC5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkUmVtb3RlQXJncyA9IHlpZWxkIHRoaXMuaG9va3MubGlmZWN5Y2xlLmVycm9yTG9hZFJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBob3N0Lm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206ICdydW50aW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWZlY3ljbGU6ICdiZWZvcmVSZXF1ZXN0J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxvYWRSZW1vdGVBcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkUmVzID0gbG9hZFJlbW90ZUFyZ3MuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVTcGxpdEluZm8gPSBtYXRjaFJlbW90ZVdpdGhOYW1lQW5kRXhwb3NlKGhvc3Qub3B0aW9ucy5yZW1vdGVzLCBpZFJlcyk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChyZW1vdGVTcGxpdEluZm8sIGVycm9yQ29kZXMuZ2V0U2hvcnRFcnJvck1zZyhlcnJvckNvZGVzLlJVTlRJTUVfMDA0LCBlcnJvckNvZGVzLnJ1bnRpbWVEZXNjTWFwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogaG9zdC5vcHRpb25zLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0SWQ6IGlkUmVzXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhd1JlbW90ZSA9IHJlbW90ZVNwbGl0SW5mby5yZW1vdGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVJbmZvID0gZ2V0UmVtb3RlSW5mbyhyYXdSZW1vdGUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hJbmZvID0geWllbGQgaG9zdC5zaGFyZWRIYW5kbGVyLmhvb2tzLmxpZmVjeWNsZS5hZnRlclJlc29sdmUuZW1pdChwb2x5ZmlsbHMuX2V4dGVuZHMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkUmVzXG4gICAgICAgICAgICAgICAgICAgIH0sIHJlbW90ZVNwbGl0SW5mbywge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogaG9zdC5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGUgPSBtYXRjaEluZm8ucmVtb3RlLCBleHBvc2UgPSBtYXRjaEluZm8uZXhwb3NlO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQocmVtb3RlICYmIGV4cG9zZSwgYFRoZSAnYmVmb3JlUmVxdWVzdCcgaG9vayB3YXMgZXhlY3V0ZWQsIGJ1dCBpdCBmYWlsZWQgdG8gcmV0dXJuIHRoZSBjb3JyZWN0ICdyZW1vdGUnIGFuZCAnZXhwb3NlJyB2YWx1ZXMgd2hpbGUgbG9hZGluZyAke2lkUmVzfS5gKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZSA9IGhvc3QubW9kdWxlQ2FjaGUuZ2V0KHJlbW90ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZHVsZU9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0OiBob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlSW5mb1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlID0gbmV3IE1vZHVsZShtb2R1bGVPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QubW9kdWxlQ2FjaGUuc2V0KHJlbW90ZS5uYW1lLCBtb2R1bGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVPcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlTWF0Y2hJbmZvOiBtYXRjaEluZm9cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVnaXN0ZXJSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlclJlbW90ZShyZW1vdGUsIHRhcmdldFJlbW90ZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgICAgICAgICAgICAgICB2YXIgbm9ybWFsaXplUmVtb3RlID0gKCk9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZS5hbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVmFsaWRhdGUgaWYgYWxpYXMgZXF1YWxzIHRoZSBwcmVmaXggb2YgcmVtb3RlLm5hbWUgYW5kIHJlbW90ZS5hbGlhcywgaWYgc28sIHRocm93IGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcyBtdWx0aS1sZXZlbCBwYXRoIHJlZmVyZW5jZXMgY2Fubm90IGd1YXJhbnRlZSB1bmlxdWUgbmFtZXMsIGFsaWFzIGJlaW5nIGEgcHJlZml4IG9mIHJlbW90ZS5uYW1lIGlzIG5vdCBzdXBwb3J0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaW5kRXF1YWwgPSB0YXJnZXRSZW1vdGVzLmZpbmQoKGl0ZW0pPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9pdGVtX2FsaWFzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZW1vdGUuYWxpYXMgJiYgKGl0ZW0ubmFtZS5zdGFydHNXaXRoKHJlbW90ZS5hbGlhcykgfHwgKChfaXRlbV9hbGlhcyA9IGl0ZW0uYWxpYXMpID09IG51bGwgPyB2b2lkIDAgOiBfaXRlbV9hbGlhcy5zdGFydHNXaXRoKHJlbW90ZS5hbGlhcykpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCFmaW5kRXF1YWwsIGBUaGUgYWxpYXMgJHtyZW1vdGUuYWxpYXN9IG9mIHJlbW90ZSAke3JlbW90ZS5uYW1lfSBpcyBub3QgYWxsb3dlZCB0byBiZSB0aGUgcHJlZml4IG9mICR7ZmluZEVxdWFsICYmIGZpbmRFcXVhbC5uYW1lfSBuYW1lIG9yIGFsaWFzYCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSByZW1vdGUgZW50cnkgdG8gYSBjb21wbGV0ZSBwYXRoXG4gICAgICAgICAgICAgICAgICAgIGlmICgnZW50cnknIGluIHJlbW90ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNkay5pc0Jyb3dzZXJFbnYoKSAmJiAhcmVtb3RlLmVudHJ5LnN0YXJ0c1dpdGgoJ2h0dHAnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZS5lbnRyeSA9IG5ldyBVUkwocmVtb3RlLmVudHJ5LCB3aW5kb3cubG9jYXRpb24ub3JpZ2luKS5ocmVmO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVtb3RlLnNoYXJlU2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZS5zaGFyZVNjb3BlID0gREVGQVVMVF9TQ09QRTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlbW90ZS50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUudHlwZSA9IERFRkFVTFRfUkVNT1RFX1RZUEU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZVJlZ2lzdGVyUmVtb3RlLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogaG9zdFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciByZWdpc3RlcmVkUmVtb3RlID0gdGFyZ2V0UmVtb3Rlcy5maW5kKChpdGVtKT0+aXRlbS5uYW1lID09PSByZW1vdGUubmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZWdpc3RlcmVkUmVtb3RlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZVJlbW90ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRSZW1vdGVzLnB1c2gocmVtb3RlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUucmVnaXN0ZXJSZW1vdGUuZW1pdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IGhvc3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VzID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgYFRoZSByZW1vdGUgXCIke3JlbW90ZS5uYW1lfVwiIGlzIGFscmVhZHkgcmVnaXN0ZXJlZC5gLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ1BsZWFzZSBub3RlIHRoYXQgb3ZlcnJpZGluZyBpdCBtYXkgY2F1c2UgdW5leHBlY3RlZCBlcnJvcnMuJ1xuICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5mb3JjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHJlZ2lzdGVyZWQgcmVtb3RlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVJlbW90ZShyZWdpc3RlcmVkUmVtb3RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZVJlbW90ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UmVtb3Rlcy5wdXNoKHJlbW90ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5yZWdpc3RlclJlbW90ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNkay53YXJuKG1lc3NhZ2VzLmpvaW4oJyAnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZW1vdmVSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVSZW1vdGUocmVtb3RlKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lMSA9IHJlbW90ZS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5kZXggPSBob3N0Lm9wdGlvbnMucmVtb3Rlcy5maW5kSW5kZXgoKGl0ZW0pPT5pdGVtLm5hbWUgPT09IG5hbWUxKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5vcHRpb25zLnJlbW90ZXMuc3BsaWNlKHJlbW90ZUluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZGVkTW9kdWxlID0gaG9zdC5tb2R1bGVDYWNoZS5nZXQocmVtb3RlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGVkTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5mbyA9IGxvYWRlZE1vZHVsZS5yZW1vdGVJbmZvO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IHJlbW90ZUluZm8uZW50cnlHbG9iYWxOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEN1cnJlbnRHbG9iYWxba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfT2JqZWN0X2dldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKF9PYmplY3RfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihDdXJyZW50R2xvYmFsLCBrZXkpKSA9PSBudWxsID8gdm9pZCAwIDogX09iamVjdF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IuY29uZmlndXJhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBDdXJyZW50R2xvYmFsW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDdXJyZW50R2xvYmFsW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5VW5pcXVlS2V5ID0gZ2V0UmVtb3RlRW50cnlVbmlxdWVLZXkobG9hZGVkTW9kdWxlLnJlbW90ZUluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdsb2JhbExvYWRpbmdbcmVtb3RlRW50cnlVbmlxdWVLZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGdsb2JhbExvYWRpbmdbcmVtb3RlRW50cnlVbmlxdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5zbmFwc2hvdEhhbmRsZXIubWFuaWZlc3RDYWNoZS5kZWxldGUocmVtb3RlSW5mby5lbnRyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkZWxldGUgdW5sb2FkZWQgc2hhcmVkIGFuZCBpbnN0YW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluc0lkID0gcmVtb3RlSW5mby5idWlsZFZlcnNpb24gPyBzZGsuY29tcG9zZUtleVdpdGhTZXBhcmF0b3IocmVtb3RlSW5mby5uYW1lLCByZW1vdGVJbmZvLmJ1aWxkVmVyc2lvbikgOiByZW1vdGVJbmZvLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5zSW5kZXggPSBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX18uZmluZEluZGV4KChpbnMpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUluZm8uYnVpbGRWZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnMub3B0aW9ucy5pZCA9PT0gcmVtb3RlSW5zSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlucy5uYW1lID09PSByZW1vdGVJbnNJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdGVJbnNJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSW5zID0gQ3VycmVudEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX0lOU1RBTkNFU19fW3JlbW90ZUluc0luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVJbnNJZCA9IHJlbW90ZUlucy5vcHRpb25zLmlkIHx8IHJlbW90ZUluc0lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnbG9iYWxTaGFyZVNjb3BlTWFwID0gZ2V0R2xvYmFsU2hhcmVTY29wZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0FsbFNoYXJlZE5vdFVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZWVkRGVsZXRlS2V5cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGdsb2JhbFNoYXJlU2NvcGVNYXApLmZvckVhY2goKGluc3RJZCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNoYXJlU2NvcGVNYXAgPSBnbG9iYWxTaGFyZVNjb3BlTWFwW2luc3RJZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGVNYXAgJiYgT2JqZWN0LmtleXMoc2hhcmVTY29wZU1hcCkuZm9yRWFjaCgoc2hhcmVTY29wZSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlVmFsID0gc2hhcmVTY29wZU1hcFtzaGFyZVNjb3BlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGVWYWwgJiYgT2JqZWN0LmtleXMoc2hhcmVTY29wZVZhbCkuZm9yRWFjaCgoc2hhcmVOYW1lKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZWRQa2dzID0gc2hhcmVTY29wZVZhbFtzaGFyZU5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZFBrZ3MgJiYgT2JqZWN0LmtleXMoc2hhcmVkUGtncykuZm9yRWFjaCgoc2hhcmVWZXJzaW9uKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2hhcmVkID0gc2hhcmVkUGtnc1tzaGFyZVZlcnNpb25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hhcmVkICYmIHR5cGVvZiBzaGFyZWQgPT09ICdvYmplY3QnICYmIHNoYXJlZC5mcm9tID09PSByZW1vdGVJbmZvLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWQubG9hZGVkIHx8IHNoYXJlZC5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkLnVzZUluID0gc2hhcmVkLnVzZUluLmZpbHRlcigodXNlZEhvc3ROYW1lKT0+dXNlZEhvc3ROYW1lICE9PSByZW1vdGVJbmZvLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWQudXNlSW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQWxsU2hhcmVkTm90VXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVLZXlzLnB1c2goW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVTY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlVmVyc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lZWREZWxldGVLZXlzLnB1c2goW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlU2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVWZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBbGxTaGFyZWROb3RVc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUlucy5zaGFyZVNjb3BlTWFwID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBnbG9iYWxTaGFyZVNjb3BlTWFwW3JlbW90ZUluc0lkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZERlbGV0ZUtleXMuZm9yRWFjaCgocmVmKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDQpLCBpbnNJZCA9IF9yZWZbMF0sIHNoYXJlU2NvcGUgPSBfcmVmWzFdLCBzaGFyZU5hbWUgPSBfcmVmWzJdLCBzaGFyZVZlcnNpb24gPSBfcmVmWzNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZV9zaGFyZU5hbWUsIF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkX3NoYXJlU2NvcGUsIF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWQgPSBnbG9iYWxTaGFyZVNjb3BlTWFwW2luc0lkXSkgPT0gbnVsbCA/IHRydWUgOiAoX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZSA9IF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkW3NoYXJlU2NvcGVdKSA9PSBudWxsID8gdHJ1ZSA6IChfZ2xvYmFsU2hhcmVTY29wZU1hcF9pbnNJZF9zaGFyZVNjb3BlX3NoYXJlTmFtZSA9IF9nbG9iYWxTaGFyZVNjb3BlTWFwX2luc0lkX3NoYXJlU2NvcGVbc2hhcmVOYW1lXSkgPT0gbnVsbCA/IHRydWUgOiBkZWxldGUgX2dsb2JhbFNoYXJlU2NvcGVNYXBfaW5zSWRfc2hhcmVTY29wZV9zaGFyZU5hbWVbc2hhcmVWZXJzaW9uXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDdXJyZW50R2xvYmFsLl9fRkVERVJBVElPTl9fLl9fSU5TVEFOQ0VTX18uc3BsaWNlKHJlbW90ZUluc0luZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBob3N0R2xvYmFsU25hcHNob3QgPSBnZXRHbG9iYWxSZW1vdGVJbmZvKHJlbW90ZSwgaG9zdCkuaG9zdEdsb2JhbFNuYXBzaG90O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhvc3RHbG9iYWxTbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVLZXkgPSBob3N0R2xvYmFsU25hcHNob3QgJiYgJ3JlbW90ZXNJbmZvJyBpbiBob3N0R2xvYmFsU25hcHNob3QgJiYgaG9zdEdsb2JhbFNuYXBzaG90LnJlbW90ZXNJbmZvICYmIGdldEluZm9XaXRob3V0VHlwZShob3N0R2xvYmFsU25hcHNob3QucmVtb3Rlc0luZm8sIHJlbW90ZS5uYW1lKS5rZXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW90ZUtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgaG9zdEdsb2JhbFNuYXBzaG90LnJlbW90ZXNJbmZvW3JlbW90ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX01BTklGRVNUX0xPQURJTkdfX1tyZW1vdGVLZXldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIEdsb2JhbC5fX0ZFREVSQVRJT05fXy5fX01BTklGRVNUX0xPQURJTkdfX1tyZW1vdGVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdC5tb2R1bGVDYWNoZS5kZWxldGUocmVtb3RlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coJ3JlbW92ZVJlbW90ZSBmYWlsOiAnLCBlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBSZW1vdGVIYW5kbGVyO1xufSgpO1xudmFyIEZlZGVyYXRpb25Ib3N0ID0gLyojX19QVVJFX18qLyBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBGZWRlcmF0aW9uSG9zdCh1c2VyT3B0aW9ucykge1xuICAgICAgICBfY2xhc3NfY2FsbF9jaGVjay5fKHRoaXMsIEZlZGVyYXRpb25Ib3N0KTtcbiAgICAgICAgdGhpcy5ob29rcyA9IG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgICAgICAgICAgYmVmb3JlSW5pdDogbmV3IFN5bmNXYXRlcmZhbGxIb29rKCdiZWZvcmVJbml0JyksXG4gICAgICAgICAgICBpbml0OiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIC8vIG1heWJlIHdpbGwgY2hhbmdlLCB0ZW1wb3JhcmlseSBmb3IgaW50ZXJuYWwgdXNlIG9ubHlcbiAgICAgICAgICAgIGJlZm9yZUluaXRDb250YWluZXI6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2JlZm9yZUluaXRDb250YWluZXInKSxcbiAgICAgICAgICAgIC8vIG1heWJlIHdpbGwgY2hhbmdlLCB0ZW1wb3JhcmlseSBmb3IgaW50ZXJuYWwgdXNlIG9ubHlcbiAgICAgICAgICAgIGluaXRDb250YWluZXI6IG5ldyBBc3luY1dhdGVyZmFsbEhvb2soJ2luaXRDb250YWluZXInKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gXCIwLjEwLjBcIjtcbiAgICAgICAgdGhpcy5tb2R1bGVDYWNoZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5sb2FkZXJIb29rID0gbmV3IFBsdWdpblN5c3RlbSh7XG4gICAgICAgICAgICAvLyBGSVhNRTogbWF5IG5vdCBiZSBzdWl0YWJsZSAsIG5vdCBvcGVuIHRvIHRoZSBwdWJsaWMgeWV0XG4gICAgICAgICAgICBnZXRNb2R1bGVJbmZvOiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGNyZWF0ZVNjcmlwdDogbmV3IFN5bmNIb29rKCksXG4gICAgICAgICAgICBjcmVhdGVMaW5rOiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGZldGNoOiBuZXcgQXN5bmNIb29rKCksXG4gICAgICAgICAgICBsb2FkRW50cnlFcnJvcjogbmV3IEFzeW5jSG9vaygpLFxuICAgICAgICAgICAgZ2V0TW9kdWxlRmFjdG9yeTogbmV3IEFzeW5jSG9vaygpXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJyaWRnZUhvb2sgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgICAgICAgIGJlZm9yZUJyaWRnZVJlbmRlcjogbmV3IFN5bmNIb29rKCksXG4gICAgICAgICAgICBhZnRlckJyaWRnZVJlbmRlcjogbmV3IFN5bmNIb29rKCksXG4gICAgICAgICAgICBiZWZvcmVCcmlkZ2VEZXN0cm95OiBuZXcgU3luY0hvb2soKSxcbiAgICAgICAgICAgIGFmdGVyQnJpZGdlRGVzdHJveTogbmV3IFN5bmNIb29rKClcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFRPRE86IFZhbGlkYXRlIHRoZSBkZXRhaWxzIG9mIHRoZSBvcHRpb25zXG4gICAgICAgIC8vIEluaXRpYWxpemUgb3B0aW9ucyB3aXRoIGRlZmF1bHQgdmFsdWVzXG4gICAgICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgICAgICAgIGlkOiBnZXRCdWlsZGVySWQoKSxcbiAgICAgICAgICAgIG5hbWU6IHVzZXJPcHRpb25zLm5hbWUsXG4gICAgICAgICAgICBwbHVnaW5zOiBbXG4gICAgICAgICAgICAgICAgc25hcHNob3RQbHVnaW4oKSxcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZVByZWxvYWRBc3NldHNQbHVnaW4oKVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHJlbW90ZXM6IFtdLFxuICAgICAgICAgICAgc2hhcmVkOiB7fSxcbiAgICAgICAgICAgIGluQnJvd3Nlcjogc2RrLmlzQnJvd3NlckVudigpXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubmFtZSA9IHVzZXJPcHRpb25zLm5hbWU7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICB0aGlzLnNuYXBzaG90SGFuZGxlciA9IG5ldyBTbmFwc2hvdEhhbmRsZXIodGhpcyk7XG4gICAgICAgIHRoaXMuc2hhcmVkSGFuZGxlciA9IG5ldyBTaGFyZWRIYW5kbGVyKHRoaXMpO1xuICAgICAgICB0aGlzLnJlbW90ZUhhbmRsZXIgPSBuZXcgUmVtb3RlSGFuZGxlcih0aGlzKTtcbiAgICAgICAgdGhpcy5zaGFyZVNjb3BlTWFwID0gdGhpcy5zaGFyZWRIYW5kbGVyLnNoYXJlU2NvcGVNYXA7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJQbHVnaW5zKF90b19jb25zdW1hYmxlX2FycmF5Ll8oZGVmYXVsdE9wdGlvbnMucGx1Z2lucykuY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8odXNlck9wdGlvbnMucGx1Z2lucyB8fCBbXSkpKTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gdGhpcy5mb3JtYXRPcHRpb25zKGRlZmF1bHRPcHRpb25zLCB1c2VyT3B0aW9ucyk7XG4gICAgfVxuICAgIF9jcmVhdGVfY2xhc3MuXyhGZWRlcmF0aW9uSG9zdCwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdE9wdGlvbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0T3B0aW9ucyh1c2VyT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJQbHVnaW5zKHVzZXJPcHRpb25zLnBsdWdpbnMpO1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5mb3JtYXRPcHRpb25zKHRoaXMub3B0aW9ucywgdXNlck9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2FkU2hhcmVcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkU2hhcmUocGtnTmFtZSwgZXh0cmFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNoYXJlZEhhbmRsZXIubG9hZFNoYXJlKHBrZ05hbWUsIGV4dHJhT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVGhlIGxpYiBmdW5jdGlvbiB3aWxsIG9ubHkgYmUgYXZhaWxhYmxlIGlmIHRoZSBzaGFyZWQgc2V0IGJ5IGVhZ2VyIG9yIHJ1bnRpbWUgaW5pdCBpcyBzZXQgb3IgdGhlIHNoYXJlZCBpcyBzdWNjZXNzZnVsbHkgbG9hZGVkLlxuICAgICAgICAgICAgLy8gMS4gSWYgdGhlIGxvYWRlZCBzaGFyZWQgYWxyZWFkeSBleGlzdHMgZ2xvYmFsbHksIHRoZW4gaXQgd2lsbCBiZSByZXVzZWRcbiAgICAgICAgICAgIC8vIDIuIElmIGxpYiBleGlzdHMgaW4gbG9jYWwgc2hhcmVkLCBpdCB3aWxsIGJlIHVzZWQgZGlyZWN0bHlcbiAgICAgICAgICAgIC8vIDMuIElmIHRoZSBsb2NhbCBnZXQgcmV0dXJucyBzb21ldGhpbmcgb3RoZXIgdGhhbiBQcm9taXNlLCB0aGVuIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseVxuICAgICAgICAgICAga2V5OiBcImxvYWRTaGFyZVN5bmNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkU2hhcmVTeW5jKHBrZ05hbWUsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNoYXJlZEhhbmRsZXIubG9hZFNoYXJlU3luYyhwa2dOYW1lLCBleHRyYU9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdGlhbGl6ZVNoYXJpbmdcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0aWFsaXplU2hhcmluZyhyZWYsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZVNjb3BlTmFtZSA9IHJlZiA9PT0gdm9pZCAwID8gREVGQVVMVF9TQ09QRSA6IHJlZjtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zaGFyZWRIYW5kbGVyLmluaXRpYWxpemVTaGFyaW5nKHNoYXJlU2NvcGVOYW1lLCBleHRyYU9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiaW5pdFJhd0NvbnRhaW5lclwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRSYXdDb250YWluZXIobmFtZTEsIHVybCwgY29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBnZXRSZW1vdGVJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZTEsXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5OiB1cmxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gbmV3IE1vZHVsZSh7XG4gICAgICAgICAgICAgICAgICAgIGhvc3Q6IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZUluZm9cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBtb2R1bGUucmVtb3RlRW50cnlFeHBvcnRzID0gY29udGFpbmVyO1xuICAgICAgICAgICAgICAgIHRoaXMubW9kdWxlQ2FjaGUuc2V0KG5hbWUxLCBtb2R1bGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJsb2FkUmVtb3RlXCIsXG4gICAgICAgICAgICB2YWx1ZTogLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1saW5lcy1wZXItZnVuY3Rpb25cbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbWVtYmVyLW9yZGVyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2FkUmVtb3RlKGlkLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZUhhbmRsZXIubG9hZFJlbW90ZShpZCwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSkuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcInByZWxvYWRSZW1vdGVcIixcbiAgICAgICAgICAgIHZhbHVlOiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L21lbWJlci1vcmRlcmluZ1xuICAgICAgICAgICAgZnVuY3Rpb24gcHJlbG9hZFJlbW90ZShwcmVsb2FkT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVIYW5kbGVyLnByZWxvYWRSZW1vdGUocHJlbG9hZE9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIH0pLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJpbml0U2hhcmVTY29wZU1hcFwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRTaGFyZVNjb3BlTWFwKHNjb3BlTmFtZSwgc2hhcmVTY29wZSwgcmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4dHJhT3B0aW9ucyA9IHJlZiA9PT0gdm9pZCAwID8ge30gOiByZWY7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRIYW5kbGVyLmluaXRTaGFyZVNjb3BlTWFwKHNjb3BlTmFtZSwgc2hhcmVTY29wZSwgZXh0cmFPcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImZvcm1hdE9wdGlvbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JtYXRPcHRpb25zKGdsb2JhbE9wdGlvbnMsIHVzZXJPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlZCA9IGZvcm1hdFNoYXJlQ29uZmlncyhnbG9iYWxPcHRpb25zLCB1c2VyT3B0aW9ucykuc2hhcmVkO1xuICAgICAgICAgICAgICAgIHZhciBfdGhpc19ob29rc19saWZlY3ljbGVfYmVmb3JlSW5pdF9lbWl0ID0gdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlSW5pdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICB1c2VyT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogZ2xvYmFsT3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVJbmZvOiBzaGFyZWRcbiAgICAgICAgICAgICAgICB9KSwgdXNlck9wdGlvbnNSZXMgPSBfdGhpc19ob29rc19saWZlY3ljbGVfYmVmb3JlSW5pdF9lbWl0LnVzZXJPcHRpb25zLCBnbG9iYWxPcHRpb25zUmVzID0gX3RoaXNfaG9va3NfbGlmZWN5Y2xlX2JlZm9yZUluaXRfZW1pdC5vcHRpb25zO1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVzID0gdGhpcy5yZW1vdGVIYW5kbGVyLmZvcm1hdEFuZFJlZ2lzdGVyUmVtb3RlKGdsb2JhbE9wdGlvbnNSZXMsIHVzZXJPcHRpb25zUmVzKTtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXNfc2hhcmVkSGFuZGxlcl9yZWdpc3RlclNoYXJlZCA9IHRoaXMuc2hhcmVkSGFuZGxlci5yZWdpc3RlclNoYXJlZChnbG9iYWxPcHRpb25zUmVzLCB1c2VyT3B0aW9uc1JlcyksIGhhbmRsZWRTaGFyZWQgPSBfdGhpc19zaGFyZWRIYW5kbGVyX3JlZ2lzdGVyU2hhcmVkLnNoYXJlZDtcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2lucyA9IF90b19jb25zdW1hYmxlX2FycmF5Ll8oZ2xvYmFsT3B0aW9uc1Jlcy5wbHVnaW5zKTtcbiAgICAgICAgICAgICAgICBpZiAodXNlck9wdGlvbnNSZXMucGx1Z2lucykge1xuICAgICAgICAgICAgICAgICAgICB1c2VyT3B0aW9uc1Jlcy5wbHVnaW5zLmZvckVhY2goKHBsdWdpbik9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGx1Z2lucy5pbmNsdWRlcyhwbHVnaW4pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2lucy5wdXNoKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uc1JlcyA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgZ2xvYmFsT3B0aW9ucywgdXNlck9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2lucyxcbiAgICAgICAgICAgICAgICAgICAgcmVtb3RlcyxcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkOiBoYW5kbGVkU2hhcmVkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuaW5pdC5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zUmVzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnNSZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZWdpc3RlclBsdWdpbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlclBsdWdpbnMxKHBsdWdpbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2luUmVzID0gcmVnaXN0ZXJQbHVnaW5zKHBsdWdpbnMsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ob29rcyxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdGVIYW5kbGVyLmhvb2tzLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZEhhbmRsZXIuaG9va3MsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc25hcHNob3RIYW5kbGVyLmhvb2tzLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRlckhvb2ssXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnJpZGdlSG9va1xuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIC8vIE1lcmdlIHBsdWdpblxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wbHVnaW5zID0gdGhpcy5vcHRpb25zLnBsdWdpbnMucmVkdWNlKChyZXMsIHBsdWdpbik9PntcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwbHVnaW4pIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgIXJlcy5maW5kKChpdGVtKT0+aXRlbS5uYW1lID09PSBwbHVnaW4ubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9LCBwbHVnaW5SZXMgfHwgW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVnaXN0ZXJSZW1vdGVzXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJSZW1vdGVzKHJlbW90ZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVIYW5kbGVyLnJlZ2lzdGVyUmVtb3RlcyhyZW1vdGVzLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0pO1xuICAgIHJldHVybiBGZWRlcmF0aW9uSG9zdDtcbn0oKTtcbnZhciBpbmRleCA9IC8qI19fUFVSRV9fKi8gT2JqZWN0LmZyZWV6ZSh7XG4gICAgX19wcm90b19fOiBudWxsXG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImxvYWRTY3JpcHRcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBzZGsubG9hZFNjcmlwdDtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJsb2FkU2NyaXB0Tm9kZVwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHNkay5sb2FkU2NyaXB0Tm9kZTtcbiAgICB9XG59KSk7XG5leHBvcnRzLkN1cnJlbnRHbG9iYWwgPSBDdXJyZW50R2xvYmFsO1xuZXhwb3J0cy5GZWRlcmF0aW9uSG9zdCA9IEZlZGVyYXRpb25Ib3N0O1xuZXhwb3J0cy5HbG9iYWwgPSBHbG9iYWw7XG5leHBvcnRzLk1vZHVsZSA9IE1vZHVsZTtcbmV4cG9ydHMuYWRkR2xvYmFsU25hcHNob3QgPSBhZGRHbG9iYWxTbmFwc2hvdDtcbmV4cG9ydHMuYXNzZXJ0ID0gYXNzZXJ0O1xuZXhwb3J0cy5nZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IgPSBnZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3I7XG5leHBvcnRzLmdldEdsb2JhbFNuYXBzaG90ID0gZ2V0R2xvYmFsU25hcHNob3Q7XG5leHBvcnRzLmdldEluZm9XaXRob3V0VHlwZSA9IGdldEluZm9XaXRob3V0VHlwZTtcbmV4cG9ydHMuZ2V0UmVnaXN0ZXJlZFNoYXJlID0gZ2V0UmVnaXN0ZXJlZFNoYXJlO1xuZXhwb3J0cy5nZXRSZW1vdGVFbnRyeSA9IGdldFJlbW90ZUVudHJ5O1xuZXhwb3J0cy5nZXRSZW1vdGVJbmZvID0gZ2V0UmVtb3RlSW5mbztcbmV4cG9ydHMuaGVscGVycyA9IGhlbHBlcnM7XG5leHBvcnRzLmlzU3RhdGljUmVzb3VyY2VzRXF1YWwgPSBpc1N0YXRpY1Jlc291cmNlc0VxdWFsO1xuZXhwb3J0cy5tYXRjaFJlbW90ZVdpdGhOYW1lQW5kRXhwb3NlID0gbWF0Y2hSZW1vdGVXaXRoTmFtZUFuZEV4cG9zZTtcbmV4cG9ydHMucmVnaXN0ZXJHbG9iYWxQbHVnaW5zID0gcmVnaXN0ZXJHbG9iYWxQbHVnaW5zO1xuZXhwb3J0cy5yZXNldEZlZGVyYXRpb25HbG9iYWxJbmZvID0gcmVzZXRGZWRlcmF0aW9uR2xvYmFsSW5mbztcbmV4cG9ydHMuc2FmZVdyYXBwZXIgPSBzYWZlV3JhcHBlcjtcbmV4cG9ydHMuc2F0aXNmeSA9IHNhdGlzZnk7XG5leHBvcnRzLnNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvciA9IHNldEdsb2JhbEZlZGVyYXRpb25Db25zdHJ1Y3RvcjtcbmV4cG9ydHMuc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlID0gc2V0R2xvYmFsRmVkZXJhdGlvbkluc3RhbmNlO1xuZXhwb3J0cy50eXBlcyA9IGluZGV4O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlL2Rpc3QvcG9seWZpbGxzLmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L3BvbHlmaWxscy5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gICAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQpIHtcbiAgICAgICAgZm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gc291cmNlKWlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbiAgICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIF9vYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzX2xvb3NlKHNvdXJjZSwgZXhjbHVkZWQpIHtcbiAgICBpZiAoc291cmNlID09IG51bGwpIHJldHVybiB7fTtcbiAgICB2YXIgdGFyZ2V0ID0ge307XG4gICAgdmFyIHNvdXJjZUtleXMgPSBPYmplY3Qua2V5cyhzb3VyY2UpO1xuICAgIHZhciBrZXksIGk7XG4gICAgZm9yKGkgPSAwOyBpIDwgc291cmNlS2V5cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIGtleSA9IHNvdXJjZUtleXNbaV07XG4gICAgICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7XG4gICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5leHBvcnRzLl9leHRlbmRzID0gX2V4dGVuZHM7XG5leHBvcnRzLl9vYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzX2xvb3NlID0gX29iamVjdF93aXRob3V0X3Byb3BlcnRpZXNfbG9vc2U7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L2luZGV4LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgcnVudGltZUNvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS1jb3JlICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZS9kaXN0L2luZGV4LmNqcy5qc1wiKTtcbnZhciB1dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vdXRpbHMuY2pzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvZGlzdC91dGlscy5janMuanNcIik7XG52YXIgRmVkZXJhdGlvbkluc3RhbmNlID0gbnVsbDtcbmZ1bmN0aW9uIGluaXQob3B0aW9ucykge1xuICAgIC8vIFJldHJpZXZlIHRoZSBzYW1lIGluc3RhbmNlIHdpdGggdGhlIHNhbWUgbmFtZVxuICAgIHZhciBpbnN0YW5jZSA9IHV0aWxzLmdldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZShvcHRpb25zLm5hbWUsIG9wdGlvbnMudmVyc2lvbik7XG4gICAgaWYgKCFpbnN0YW5jZSkge1xuICAgICAgICAvLyBSZXRyaWV2ZSBkZWJ1ZyBjb25zdHJ1Y3RvclxuICAgICAgICB2YXIgRmVkZXJhdGlvbkNvbnN0cnVjdG9yID0gcnVudGltZUNvcmUuZ2V0R2xvYmFsRmVkZXJhdGlvbkNvbnN0cnVjdG9yKCkgfHwgcnVudGltZUNvcmUuRmVkZXJhdGlvbkhvc3Q7XG4gICAgICAgIEZlZGVyYXRpb25JbnN0YW5jZSA9IG5ldyBGZWRlcmF0aW9uQ29uc3RydWN0b3Iob3B0aW9ucyk7XG4gICAgICAgIHJ1bnRpbWVDb3JlLnNldEdsb2JhbEZlZGVyYXRpb25JbnN0YW5jZShGZWRlcmF0aW9uSW5zdGFuY2UpO1xuICAgICAgICByZXR1cm4gRmVkZXJhdGlvbkluc3RhbmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE1lcmdlIG9wdGlvbnNcbiAgICAgICAgaW5zdGFuY2UuaW5pdE9wdGlvbnMob3B0aW9ucyk7XG4gICAgICAgIGlmICghRmVkZXJhdGlvbkluc3RhbmNlKSB7XG4gICAgICAgICAgICBGZWRlcmF0aW9uSW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfVxufVxuZnVuY3Rpb24gbG9hZFJlbW90ZSguLi5hcmdzKSB7XG4gICAgcnVudGltZUNvcmUuYXNzZXJ0KEZlZGVyYXRpb25JbnN0YW5jZSwgJ1BsZWFzZSBjYWxsIGluaXQgZmlyc3QnKTtcbiAgICB2YXIgbG9hZFJlbW90ZTEgPSBGZWRlcmF0aW9uSW5zdGFuY2UubG9hZFJlbW90ZTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLXNwcmVhZFxuICAgIHJldHVybiBsb2FkUmVtb3RlMS5hcHBseShGZWRlcmF0aW9uSW5zdGFuY2UsIGFyZ3MpO1xufVxuZnVuY3Rpb24gbG9hZFNoYXJlKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgdmFyIGxvYWRTaGFyZTEgPSBGZWRlcmF0aW9uSW5zdGFuY2UubG9hZFNoYXJlO1xuICAgIHJldHVybiBsb2FkU2hhcmUxLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiBsb2FkU2hhcmVTeW5jKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIHZhciBsb2FkU2hhcmVTeW5jMSA9IEZlZGVyYXRpb25JbnN0YW5jZS5sb2FkU2hhcmVTeW5jO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIGxvYWRTaGFyZVN5bmMxLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiBwcmVsb2FkUmVtb3RlKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIEZlZGVyYXRpb25JbnN0YW5jZS5wcmVsb2FkUmVtb3RlLmFwcGx5KEZlZGVyYXRpb25JbnN0YW5jZSwgYXJncyk7XG59XG5mdW5jdGlvbiByZWdpc3RlclJlbW90ZXMoLi4uYXJncykge1xuICAgIHJ1bnRpbWVDb3JlLmFzc2VydChGZWRlcmF0aW9uSW5zdGFuY2UsICdQbGVhc2UgY2FsbCBpbml0IGZpcnN0Jyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1zcHJlYWRcbiAgICByZXR1cm4gRmVkZXJhdGlvbkluc3RhbmNlLnJlZ2lzdGVyUmVtb3Rlcy5hcHBseShGZWRlcmF0aW9uSW5zdGFuY2UsIGFyZ3MpO1xufVxuZnVuY3Rpb24gcmVnaXN0ZXJQbHVnaW5zKC4uLmFyZ3MpIHtcbiAgICBydW50aW1lQ29yZS5hc3NlcnQoRmVkZXJhdGlvbkluc3RhbmNlLCAnUGxlYXNlIGNhbGwgaW5pdCBmaXJzdCcpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItc3ByZWFkXG4gICAgcmV0dXJuIEZlZGVyYXRpb25JbnN0YW5jZS5yZWdpc3RlclBsdWdpbnMuYXBwbHkoRmVkZXJhdGlvbkluc3RhbmNlLCBhcmdzKTtcbn1cbmZ1bmN0aW9uIGdldEluc3RhbmNlKCkge1xuICAgIHJldHVybiBGZWRlcmF0aW9uSW5zdGFuY2U7XG59XG4vLyBJbmplY3QgZm9yIGRlYnVnXG5ydW50aW1lQ29yZS5zZXRHbG9iYWxGZWRlcmF0aW9uQ29uc3RydWN0b3IocnVudGltZUNvcmUuRmVkZXJhdGlvbkhvc3QpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiRmVkZXJhdGlvbkhvc3RcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5GZWRlcmF0aW9uSG9zdDtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJNb2R1bGVcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5Nb2R1bGU7XG4gICAgfVxufSkpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZ2V0UmVtb3RlRW50cnlcIiwgKHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBydW50aW1lQ29yZS5nZXRSZW1vdGVFbnRyeTtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJnZXRSZW1vdGVJbmZvXCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcnVudGltZUNvcmUuZ2V0UmVtb3RlSW5mbztcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJsb2FkU2NyaXB0XCIsICh7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcnVudGltZUNvcmUubG9hZFNjcmlwdDtcbiAgICB9XG59KSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJsb2FkU2NyaXB0Tm9kZVwiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLmxvYWRTY3JpcHROb2RlO1xuICAgIH1cbn0pKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInJlZ2lzdGVyR2xvYmFsUGx1Z2luc1wiLCAoe1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJ1bnRpbWVDb3JlLnJlZ2lzdGVyR2xvYmFsUGx1Z2lucztcbiAgICB9XG59KSk7XG5leHBvcnRzLmdldEluc3RhbmNlID0gZ2V0SW5zdGFuY2U7XG5leHBvcnRzLmluaXQgPSBpbml0O1xuZXhwb3J0cy5sb2FkUmVtb3RlID0gbG9hZFJlbW90ZTtcbmV4cG9ydHMubG9hZFNoYXJlID0gbG9hZFNoYXJlO1xuZXhwb3J0cy5sb2FkU2hhcmVTeW5jID0gbG9hZFNoYXJlU3luYztcbmV4cG9ydHMucHJlbG9hZFJlbW90ZSA9IHByZWxvYWRSZW1vdGU7XG5leHBvcnRzLnJlZ2lzdGVyUGx1Z2lucyA9IHJlZ2lzdGVyUGx1Z2lucztcbmV4cG9ydHMucmVnaXN0ZXJSZW1vdGVzID0gcmVnaXN0ZXJSZW1vdGVzO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9kaXN0L3V0aWxzLmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvZGlzdC91dGlscy5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIHJ1bnRpbWVDb3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUtY29yZSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lLWNvcmUvZGlzdC9pbmRleC5janMuanNcIik7XG4vLyBpbmplY3RlZCBieSBidW5kbGVyLCBzbyBpdCBjYW4gbm90IHVzZSBydW50aW1lLWNvcmUgc3R1ZmZcbmZ1bmN0aW9uIGdldEJ1aWxkZXJJZCgpIHtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICByZXR1cm4gIHRydWUgPyBcInRyYXZlbHM6MS4wLjBcIiA6IDA7XG59XG5mdW5jdGlvbiBnZXRHbG9iYWxGZWRlcmF0aW9uSW5zdGFuY2UobmFtZSwgdmVyc2lvbikge1xuICAgIHZhciBidWlsZElkID0gZ2V0QnVpbGRlcklkKCk7XG4gICAgcmV0dXJuIHJ1bnRpbWVDb3JlLkN1cnJlbnRHbG9iYWwuX19GRURFUkFUSU9OX18uX19JTlNUQU5DRVNfXy5maW5kKChHTUluc3RhbmNlKT0+e1xuICAgICAgICBpZiAoYnVpbGRJZCAmJiBHTUluc3RhbmNlLm9wdGlvbnMuaWQgPT09IGdldEJ1aWxkZXJJZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoR01JbnN0YW5jZS5vcHRpb25zLm5hbWUgPT09IG5hbWUgJiYgIUdNSW5zdGFuY2Uub3B0aW9ucy52ZXJzaW9uICYmICF2ZXJzaW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoR01JbnN0YW5jZS5vcHRpb25zLm5hbWUgPT09IG5hbWUgJiYgdmVyc2lvbiAmJiBHTUluc3RhbmNlLm9wdGlvbnMudmVyc2lvbiA9PT0gdmVyc2lvbikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xufVxuZXhwb3J0cy5nZXRHbG9iYWxGZWRlcmF0aW9uSW5zdGFuY2UgPSBnZXRHbG9iYWxGZWRlcmF0aW9uSW5zdGFuY2U7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9zZGsvZGlzdC9pbmRleC5janMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L2luZGV4LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xudmFyIF9hc3luY190b19nZW5lcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fYXN5bmNfdG9fZ2VuZXJhdG9yICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqc1wiKTtcbnZhciBfY2xhc3NfY2FsbF9jaGVjayA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jbGFzc19jYWxsX2NoZWNrICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janNcIik7XG52YXIgX2NyZWF0ZV9jbGFzcyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19jcmVhdGVfY2xhc3MgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzXCIpO1xudmFyIF9zbGljZWRfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fc2xpY2VkX3RvX2FycmF5ICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2xpY2VkX3RvX2FycmF5LmNqc1wiKTtcbnZhciBfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fdG9fYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19hcnJheS5janNcIik7XG52YXIgX3RvX2NvbnN1bWFibGVfYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9fdG9fY29uc3VtYWJsZV9hcnJheSAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2NvbnN1bWFibGVfYXJyYXkuY2pzXCIpO1xudmFyIHBvbHlmaWxscyA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vcG9seWZpbGxzLmNqcy5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9zZGsvZGlzdC9wb2x5ZmlsbHMuY2pzLmpzXCIpO1xudmFyIEZlZGVyYXRpb25Nb2R1bGVNYW5pZmVzdCA9ICdmZWRlcmF0aW9uLW1hbmlmZXN0Lmpzb24nO1xudmFyIE1BTklGRVNUX0VYVCA9ICcuanNvbic7XG52YXIgQlJPV1NFUl9MT0dfS0VZID0gJ0ZFREVSQVRJT05fREVCVUcnO1xudmFyIEJST1dTRVJfTE9HX1ZBTFVFID0gJzEnO1xudmFyIE5hbWVUcmFuc2Zvcm1TeW1ib2wgPSB7XG4gICAgQVQ6ICdAJyxcbiAgICBIWVBIRU46ICctJyxcbiAgICBTTEFTSDogJy8nXG59O1xudmFyIE5hbWVUcmFuc2Zvcm1NYXAgPSB7XG4gICAgW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdOiAnc2NvcGVfJyxcbiAgICBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dOiAnXycsXG4gICAgW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdOiAnX18nXG59O1xudmFyIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwID0ge1xuICAgIFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdXTogTmFtZVRyYW5zZm9ybVN5bWJvbC5BVCxcbiAgICBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl1dOiBOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTixcbiAgICBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXV06IE5hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hcbn07XG52YXIgU0VQQVJBVE9SID0gJzonO1xudmFyIE1hbmlmZXN0RmlsZU5hbWUgPSAnbWYtbWFuaWZlc3QuanNvbic7XG52YXIgU3RhdHNGaWxlTmFtZSA9ICdtZi1zdGF0cy5qc29uJztcbnZhciBNRk1vZHVsZVR5cGUgPSB7XG4gICAgTlBNOiAnbnBtJyxcbiAgICBBUFA6ICdhcHAnXG59O1xudmFyIE1PRFVMRV9ERVZUT09MX0lERU5USUZJRVIgPSAnX19NRl9ERVZUT09MU19NT0RVTEVfSU5GT19fJztcbnZhciBFTkNPREVfTkFNRV9QUkVGSVggPSAnRU5DT0RFX05BTUVfUFJFRklYJztcbnZhciBURU1QX0RJUiA9ICcuZmVkZXJhdGlvbic7XG52YXIgTUZQcmVmZXRjaENvbW1vbiA9IHtcbiAgICBpZGVudGlmaWVyOiAnTUZEYXRhUHJlZmV0Y2gnLFxuICAgIGdsb2JhbEtleTogJ19fUFJFRkVUQ0hfXycsXG4gICAgbGlicmFyeTogJ21mLWRhdGEtcHJlZmV0Y2gnLFxuICAgIGV4cG9ydHNLZXk6ICdfX1BSRUZFVENIX0VYUE9SVFNfXycsXG4gICAgZmlsZU5hbWU6ICdib290c3RyYXAuanMnXG59O1xudmFyIENvbnRhaW5lclBsdWdpbiA9IC8qI19fUFVSRV9fKi8gT2JqZWN0LmZyZWV6ZSh7XG4gICAgX19wcm90b19fOiBudWxsXG59KTtcbnZhciBDb250YWluZXJSZWZlcmVuY2VQbHVnaW4gPSAvKiNfX1BVUkVfXyovIE9iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbFxufSk7XG52YXIgTW9kdWxlRmVkZXJhdGlvblBsdWdpbiA9IC8qI19fUFVSRV9fKi8gT2JqZWN0LmZyZWV6ZSh7XG4gICAgX19wcm90b19fOiBudWxsXG59KTtcbnZhciBTaGFyZVBsdWdpbiA9IC8qI19fUFVSRV9fKi8gT2JqZWN0LmZyZWV6ZSh7XG4gICAgX19wcm90b19fOiBudWxsXG59KTtcbmZ1bmN0aW9uIGlzQnJvd3NlckVudigpIHtcbiAgICByZXR1cm4gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCc7XG59XG5mdW5jdGlvbiBpc0Jyb3dzZXJEZWJ1ZygpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAoaXNCcm93c2VyRW52KCkgJiYgd2luZG93LmxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKEJST1dTRVJfTE9HX0tFWSkgPT09IEJST1dTRVJfTE9HX1ZBTFVFO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IxKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gaXNEZWJ1Z01vZGUoKSB7XG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudlsnRkVERVJBVElPTl9ERUJVRyddKSB7XG4gICAgICAgIHJldHVybiBCb29sZWFuKHByb2Nlc3MuZW52WydGRURFUkFUSU9OX0RFQlVHJ10pO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIEZFREVSQVRJT05fREVCVUcgIT09ICd1bmRlZmluZWQnICYmIEJvb2xlYW4oRkVERVJBVElPTl9ERUJVRykpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBpc0Jyb3dzZXJEZWJ1ZygpO1xufVxudmFyIGdldFByb2Nlc3NFbnYgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHByb2Nlc3MuZW52ID8gcHJvY2Vzcy5lbnYgOiB7fTtcbn07XG52YXIgTE9HX0NBVEVHT1JZID0gJ1sgRmVkZXJhdGlvbiBSdW50aW1lIF0nO1xuLy8gZW50cnk6IG5hbWU6dmVyc2lvbiAgIHZlcnNpb24gOiAxLjAuMCB8IF4xLjIuM1xuLy8gZW50cnk6IG5hbWU6ZW50cnkgIGVudHJ5OiAgaHR0cHM6Ly9sb2NhbGhvc3Q6OTAwMC9mZWRlcmF0aW9uLW1hbmlmZXN0Lmpzb25cbnZhciBwYXJzZUVudHJ5ID0gKHN0ciwgZGV2VmVyT3JVcmwsIHJlZik9PntcbiAgICB2YXIgc2VwYXJhdG9yID0gcmVmID09PSB2b2lkIDAgPyBTRVBBUkFUT1IgOiByZWY7XG4gICAgdmFyIHN0clNwbGl0ID0gc3RyLnNwbGl0KHNlcGFyYXRvcik7XG4gICAgdmFyIGRldlZlcnNpb25PclVybCA9IGdldFByb2Nlc3NFbnYoKVsnTk9ERV9FTlYnXSA9PT0gJ2RldmVsb3BtZW50JyAmJiBkZXZWZXJPclVybDtcbiAgICB2YXIgZGVmYXVsdFZlcnNpb24gPSAnKic7XG4gICAgdmFyIGlzRW50cnkgPSAocyk9PnMuc3RhcnRzV2l0aCgnaHR0cCcpIHx8IHMuaW5jbHVkZXMoTUFOSUZFU1RfRVhUKTtcbiAgICAvLyBDaGVjayBpZiB0aGUgc3RyaW5nIHN0YXJ0cyB3aXRoIGEgdHlwZVxuICAgIGlmIChzdHJTcGxpdC5sZW5ndGggPj0gMikge1xuICAgICAgICB2YXIgX3N0clNwbGl0ID0gX3RvX2FycmF5Ll8oc3RyU3BsaXQpLCBuYW1lID0gX3N0clNwbGl0WzBdLCB2ZXJzaW9uT3JFbnRyeUFyciA9IF9zdHJTcGxpdC5zbGljZSgxKTtcbiAgICAgICAgLy8gQG5hbWVAbWFuaWZlc3QtdXJsLmpzb25cbiAgICAgICAgaWYgKHN0ci5zdGFydHNXaXRoKHNlcGFyYXRvcikpIHtcbiAgICAgICAgICAgIG5hbWUgPSBzdHJTcGxpdC5zbGljZSgwLCAyKS5qb2luKHNlcGFyYXRvcik7XG4gICAgICAgICAgICB2ZXJzaW9uT3JFbnRyeUFyciA9IFtcbiAgICAgICAgICAgICAgICBkZXZWZXJzaW9uT3JVcmwgfHwgc3RyU3BsaXQuc2xpY2UoMikuam9pbihzZXBhcmF0b3IpXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2ZXJzaW9uT3JFbnRyeSA9IGRldlZlcnNpb25PclVybCB8fCB2ZXJzaW9uT3JFbnRyeUFyci5qb2luKHNlcGFyYXRvcik7XG4gICAgICAgIGlmIChpc0VudHJ5KHZlcnNpb25PckVudHJ5KSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICAgIGVudHJ5OiB2ZXJzaW9uT3JFbnRyeVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEFwcGx5IHZlcnNpb24gcnVsZVxuICAgICAgICAgICAgLy8gZGV2VmVyc2lvbk9yVXJsID0+IGlucHV0VmVyc2lvbiA9PiBkZWZhdWx0VmVyc2lvblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IHZlcnNpb25PckVudHJ5IHx8IGRlZmF1bHRWZXJzaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChzdHJTcGxpdC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgdmFyIF9zdHJTcGxpdDEgPSBfc2xpY2VkX3RvX2FycmF5Ll8oc3RyU3BsaXQsIDEpLCBuYW1lMSA9IF9zdHJTcGxpdDFbMF07XG4gICAgICAgIGlmIChkZXZWZXJzaW9uT3JVcmwgJiYgaXNFbnRyeShkZXZWZXJzaW9uT3JVcmwpKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgICAgIGVudHJ5OiBkZXZWZXJzaW9uT3JVcmxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IG5hbWUxLFxuICAgICAgICAgICAgdmVyc2lvbjogZGV2VmVyc2lvbk9yVXJsIHx8IGRlZmF1bHRWZXJzaW9uXG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgYEludmFsaWQgZW50cnkgdmFsdWU6ICR7c3RyfWA7XG4gICAgfVxufTtcbnZhciBjb21wb3NlS2V5V2l0aFNlcGFyYXRvciA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICBpZiAoIWFyZ3MubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgcmV0dXJuIGFyZ3MucmVkdWNlKChzdW0sIGN1cik9PntcbiAgICAgICAgaWYgKCFjdXIpIHtcbiAgICAgICAgICAgIHJldHVybiBzdW07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzdW0pIHtcbiAgICAgICAgICAgIHJldHVybiBjdXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke3N1bX0ke1NFUEFSQVRPUn0ke2N1cn1gO1xuICAgIH0sICcnKTtcbn07XG52YXIgZW5jb2RlTmFtZSA9IGZ1bmN0aW9uKG5hbWUsIHJlZiwgcmVmMSkge1xuICAgIHZhciBwcmVmaXggPSByZWYgPT09IHZvaWQgMCA/ICcnIDogcmVmLCB3aXRoRXh0ID0gcmVmMSA9PT0gdm9pZCAwID8gZmFsc2UgOiByZWYxO1xuICAgIHRyeSB7XG4gICAgICAgIHZhciBleHQgPSB3aXRoRXh0ID8gJy5qcycgOiAnJztcbiAgICAgICAgcmV0dXJuIGAke3ByZWZpeH0ke25hbWUucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1TeW1ib2wuQVR9YCwgJ2cnKSwgTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXSkucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOfWAsICdnJyksIE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSH1gLCAnZycpLCBOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdKX0ke2V4dH1gO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgfVxufTtcbnZhciBkZWNvZGVOYW1lID0gZnVuY3Rpb24obmFtZSwgcHJlZml4LCB3aXRoRXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIGRlY29kZWROYW1lID0gbmFtZTtcbiAgICAgICAgaWYgKHByZWZpeCkge1xuICAgICAgICAgICAgaWYgKCFkZWNvZGVkTmFtZS5zdGFydHNXaXRoKHByZWZpeCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjb2RlZE5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWNvZGVkTmFtZSA9IGRlY29kZWROYW1lLnJlcGxhY2UobmV3IFJlZ0V4cChwcmVmaXgsICdnJyksICcnKTtcbiAgICAgICAgfVxuICAgICAgICBkZWNvZGVkTmFtZSA9IGRlY29kZWROYW1lLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdfWAsICdnJyksIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5BVF1dKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXX1gLCAnZycpLCBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdXSkucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dfWAsICdnJyksIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dXSk7XG4gICAgICAgIGlmICh3aXRoRXh0KSB7XG4gICAgICAgICAgICBkZWNvZGVkTmFtZSA9IGRlY29kZWROYW1lLnJlcGxhY2UoJy5qcycsICcnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGVjb2RlZE5hbWU7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICB9XG59O1xudmFyIGdlbmVyYXRlRXhwb3NlRmlsZW5hbWUgPSAoZXhwb3NlTmFtZSwgd2l0aEV4dCk9PntcbiAgICBpZiAoIWV4cG9zZU5hbWUpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICB2YXIgZXhwb3NlID0gZXhwb3NlTmFtZTtcbiAgICBpZiAoZXhwb3NlID09PSAnLicpIHtcbiAgICAgICAgZXhwb3NlID0gJ2RlZmF1bHRfZXhwb3J0JztcbiAgICB9XG4gICAgaWYgKGV4cG9zZS5zdGFydHNXaXRoKCcuLycpKSB7XG4gICAgICAgIGV4cG9zZSA9IGV4cG9zZS5yZXBsYWNlKCcuLycsICcnKTtcbiAgICB9XG4gICAgcmV0dXJuIGVuY29kZU5hbWUoZXhwb3NlLCAnX19mZWRlcmF0aW9uX2V4cG9zZV8nLCB3aXRoRXh0KTtcbn07XG52YXIgZ2VuZXJhdGVTaGFyZUZpbGVuYW1lID0gKHBrZ05hbWUsIHdpdGhFeHQpPT57XG4gICAgaWYgKCFwa2dOYW1lKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgcmV0dXJuIGVuY29kZU5hbWUocGtnTmFtZSwgJ19fZmVkZXJhdGlvbl9zaGFyZWRfJywgd2l0aEV4dCk7XG59O1xudmFyIGdldFJlc291cmNlVXJsID0gKG1vZHVsZSwgc291cmNlVXJsKT0+e1xuICAgIGlmICgnZ2V0UHVibGljUGF0aCcgaW4gbW9kdWxlKSB7XG4gICAgICAgIHZhciBwdWJsaWNQYXRoO1xuICAgICAgICBpZiAoIW1vZHVsZS5nZXRQdWJsaWNQYXRoLnN0YXJ0c1dpdGgoJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgICAgIHB1YmxpY1BhdGggPSBuZXcgRnVuY3Rpb24obW9kdWxlLmdldFB1YmxpY1BhdGgpKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwdWJsaWNQYXRoID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gJyArIG1vZHVsZS5nZXRQdWJsaWNQYXRoKSgpKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke3B1YmxpY1BhdGh9JHtzb3VyY2VVcmx9YDtcbiAgICB9IGVsc2UgaWYgKCdwdWJsaWNQYXRoJyBpbiBtb2R1bGUpIHtcbiAgICAgICAgcmV0dXJuIGAke21vZHVsZS5wdWJsaWNQYXRofSR7c291cmNlVXJsfWA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdDYW5ub3QgZ2V0IHJlc291cmNlIFVSTC4gSWYgaW4gZGVidWcgbW9kZSwgcGxlYXNlIGlnbm9yZS4nLCBtb2R1bGUsIHNvdXJjZVVybCk7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG59O1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXNcbnZhciBhc3NlcnQgPSAoY29uZGl0aW9uLCBtc2cpPT57XG4gICAgaWYgKCFjb25kaXRpb24pIHtcbiAgICAgICAgZXJyb3IobXNnKTtcbiAgICB9XG59O1xudmFyIGVycm9yID0gKG1zZyk9PntcbiAgICB0aHJvdyBuZXcgRXJyb3IoYCR7TE9HX0NBVEVHT1JZfTogJHttc2d9YCk7XG59O1xudmFyIHdhcm4gPSAobXNnKT0+e1xuICAgIGNvbnNvbGUud2FybihgJHtMT0dfQ0FURUdPUll9OiAke21zZ31gKTtcbn07XG5mdW5jdGlvbiBzYWZlVG9TdHJpbmcoaW5mbykge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShpbmZvLCBudWxsLCAyKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG59XG4vLyBSZWdFeHAgZm9yIHZlcnNpb24gc3RyaW5nXG52YXIgVkVSU0lPTl9QQVRURVJOX1JFR0VYUCA9IC9eKFtcXGRePXY8Pn5dfFsqeFhdJCkvO1xuZnVuY3Rpb24gaXNSZXF1aXJlZFZlcnNpb24oc3RyKSB7XG4gICAgcmV0dXJuIFZFUlNJT05fUEFUVEVSTl9SRUdFWFAudGVzdChzdHIpO1xufVxudmFyIHNpbXBsZUpvaW5SZW1vdGVFbnRyeSA9IChyUGF0aCwgck5hbWUpPT57XG4gICAgaWYgKCFyUGF0aCkge1xuICAgICAgICByZXR1cm4gck5hbWU7XG4gICAgfVxuICAgIHZhciB0cmFuc2Zvcm1QYXRoID0gKHN0cik9PntcbiAgICAgICAgaWYgKHN0ciA9PT0gJy4nKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ci5zdGFydHNXaXRoKCcuLycpKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoJy4vJywgJycpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdHIuc3RhcnRzV2l0aCgnLycpKSB7XG4gICAgICAgICAgICB2YXIgc3RyV2l0aG91dFNsYXNoID0gc3RyLnNsaWNlKDEpO1xuICAgICAgICAgICAgaWYgKHN0cldpdGhvdXRTbGFzaC5lbmRzV2l0aCgnLycpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0cldpdGhvdXRTbGFzaC5zbGljZSgwLCAtMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc3RyV2l0aG91dFNsYXNoO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfTtcbiAgICB2YXIgdHJhbnNmb3JtZWRQYXRoID0gdHJhbnNmb3JtUGF0aChyUGF0aCk7XG4gICAgaWYgKCF0cmFuc2Zvcm1lZFBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHJOYW1lO1xuICAgIH1cbiAgICBpZiAodHJhbnNmb3JtZWRQYXRoLmVuZHNXaXRoKCcvJykpIHtcbiAgICAgICAgcmV0dXJuIGAke3RyYW5zZm9ybWVkUGF0aH0ke3JOYW1lfWA7XG4gICAgfVxuICAgIHJldHVybiBgJHt0cmFuc2Zvcm1lZFBhdGh9LyR7ck5hbWV9YDtcbn07XG5mdW5jdGlvbiBpbmZlckF1dG9QdWJsaWNQYXRoKHVybCkge1xuICAgIHJldHVybiB1cmwucmVwbGFjZSgvIy4qJC8sICcnKS5yZXBsYWNlKC9cXD8uKiQvLCAnJykucmVwbGFjZSgvXFwvW15cXC9dKyQvLCAnLycpO1xufVxuLy8gUHJpb3JpdHk6IG92ZXJyaWRlcyA+IHJlbW90ZXNcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGluZXMtcGVyLWZ1bmN0aW9uXG5mdW5jdGlvbiBnZW5lcmF0ZVNuYXBzaG90RnJvbU1hbmlmZXN0KG1hbmlmZXN0LCByZWYpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHJlZiA9PT0gdm9pZCAwID8ge30gOiByZWY7XG4gICAgdmFyIF9tYW5pZmVzdF9tZXRhRGF0YSwgX21hbmlmZXN0X21ldGFEYXRhMTtcbiAgICB2YXIgX29wdGlvbnNfcmVtb3RlcyA9IG9wdGlvbnMucmVtb3RlcywgcmVtb3RlcyA9IF9vcHRpb25zX3JlbW90ZXMgPT09IHZvaWQgMCA/IHt9IDogX29wdGlvbnNfcmVtb3RlcywgX29wdGlvbnNfb3ZlcnJpZGVzID0gb3B0aW9ucy5vdmVycmlkZXMsIG92ZXJyaWRlcyA9IF9vcHRpb25zX292ZXJyaWRlcyA9PT0gdm9pZCAwID8ge30gOiBfb3B0aW9uc19vdmVycmlkZXMsIHZlcnNpb24gPSBvcHRpb25zLnZlcnNpb247XG4gICAgdmFyIHJlbW90ZVNuYXBzaG90O1xuICAgIHZhciBnZXRQdWJsaWNQYXRoID0gKCk9PntcbiAgICAgICAgaWYgKCdwdWJsaWNQYXRoJyBpbiBtYW5pZmVzdC5tZXRhRGF0YSkge1xuICAgICAgICAgICAgaWYgKG1hbmlmZXN0Lm1ldGFEYXRhLnB1YmxpY1BhdGggPT09ICdhdXRvJyAmJiB2ZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgLy8gdXNlIHNhbWUgaW1wbGVtZW50YXRpb24gYXMgcHVibGljUGF0aCBhdXRvIHJ1bnRpbWUgbW9kdWxlIGltcGxlbWVudHNcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5mZXJBdXRvUHVibGljUGF0aCh2ZXJzaW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBtYW5pZmVzdC5tZXRhRGF0YS5wdWJsaWNQYXRoO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG1hbmlmZXN0Lm1ldGFEYXRhLmdldFB1YmxpY1BhdGg7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBvdmVycmlkZXNLZXlzID0gT2JqZWN0LmtleXMob3ZlcnJpZGVzKTtcbiAgICB2YXIgcmVtb3Rlc0luZm8gPSB7fTtcbiAgICAvLyBJZiByZW1vdGVzIGFyZSBub3QgcHJvdmlkZWQsIG9ubHkgdGhlIHJlbW90ZXMgaW4gdGhlIG1hbmlmZXN0IHdpbGwgYmUgcmVhZFxuICAgIGlmICghT2JqZWN0LmtleXMocmVtb3RlcykubGVuZ3RoKSB7XG4gICAgICAgIHZhciBfbWFuaWZlc3RfcmVtb3RlcztcbiAgICAgICAgcmVtb3Rlc0luZm8gPSAoKF9tYW5pZmVzdF9yZW1vdGVzID0gbWFuaWZlc3QucmVtb3RlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9tYW5pZmVzdF9yZW1vdGVzLnJlZHVjZSgocmVzLCBuZXh0KT0+e1xuICAgICAgICAgICAgdmFyIG1hdGNoZWRWZXJzaW9uO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBuZXh0LmZlZGVyYXRpb25Db250YWluZXJOYW1lO1xuICAgICAgICAgICAgLy8gb3ZlcnJpZGVzIGhhdmUgaGlnaGVyIHByaW9yaXR5XG4gICAgICAgICAgICBpZiAob3ZlcnJpZGVzS2V5cy5pbmNsdWRlcyhuYW1lKSkge1xuICAgICAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uID0gb3ZlcnJpZGVzW25hbWVdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoJ3ZlcnNpb24nIGluIG5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZFZlcnNpb24gPSBuZXh0LnZlcnNpb247XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZFZlcnNpb24gPSBuZXh0LmVudHJ5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc1tuYW1lXSA9IHtcbiAgICAgICAgICAgICAgICBtYXRjaGVkVmVyc2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0sIHt9KSkgfHwge307XG4gICAgfVxuICAgIC8vIElmIHJlbW90ZXMgKGRlcGxveSBzY2VuYXJpbykgYXJlIHNwZWNpZmllZCwgdGhleSBuZWVkIHRvIGJlIHRyYXZlcnNlZCBhZ2FpblxuICAgIE9iamVjdC5rZXlzKHJlbW90ZXMpLmZvckVhY2goKGtleSk9PnJlbW90ZXNJbmZvW2tleV0gPSB7XG4gICAgICAgICAgICAvLyBvdmVycmlkZXMgd2lsbCBvdmVycmlkZSBkZXBlbmRlbmNpZXNcbiAgICAgICAgICAgIG1hdGNoZWRWZXJzaW9uOiBvdmVycmlkZXNLZXlzLmluY2x1ZGVzKGtleSkgPyBvdmVycmlkZXNba2V5XSA6IHJlbW90ZXNba2V5XVxuICAgICAgICB9KTtcbiAgICB2YXIgX21hbmlmZXN0X21ldGFEYXRhMiA9IG1hbmlmZXN0Lm1ldGFEYXRhLCBfbWFuaWZlc3RfbWV0YURhdGFfcmVtb3RlRW50cnkgPSBfbWFuaWZlc3RfbWV0YURhdGEyLnJlbW90ZUVudHJ5LCByZW1vdGVFbnRyeVBhdGggPSBfbWFuaWZlc3RfbWV0YURhdGFfcmVtb3RlRW50cnkucGF0aCwgcmVtb3RlRW50cnlOYW1lID0gX21hbmlmZXN0X21ldGFEYXRhX3JlbW90ZUVudHJ5Lm5hbWUsIHJlbW90ZUVudHJ5VHlwZSA9IF9tYW5pZmVzdF9tZXRhRGF0YV9yZW1vdGVFbnRyeS50eXBlLCByZW1vdGVUeXBlcyA9IF9tYW5pZmVzdF9tZXRhRGF0YTIudHlwZXMsIGJ1aWxkVmVyc2lvbiA9IF9tYW5pZmVzdF9tZXRhRGF0YTIuYnVpbGRJbmZvLmJ1aWxkVmVyc2lvbiwgZ2xvYmFsTmFtZSA9IF9tYW5pZmVzdF9tZXRhRGF0YTIuZ2xvYmFsTmFtZSwgc3NyUmVtb3RlRW50cnkgPSBfbWFuaWZlc3RfbWV0YURhdGEyLnNzclJlbW90ZUVudHJ5O1xuICAgIHZhciBleHBvc2VzID0gbWFuaWZlc3QuZXhwb3NlcztcbiAgICB2YXIgYmFzaWNSZW1vdGVTbmFwc2hvdCA9IHtcbiAgICAgICAgdmVyc2lvbjogdmVyc2lvbiA/IHZlcnNpb24gOiAnJyxcbiAgICAgICAgYnVpbGRWZXJzaW9uLFxuICAgICAgICBnbG9iYWxOYW1lLFxuICAgICAgICByZW1vdGVFbnRyeTogc2ltcGxlSm9pblJlbW90ZUVudHJ5KHJlbW90ZUVudHJ5UGF0aCwgcmVtb3RlRW50cnlOYW1lKSxcbiAgICAgICAgcmVtb3RlRW50cnlUeXBlLFxuICAgICAgICByZW1vdGVUeXBlczogc2ltcGxlSm9pblJlbW90ZUVudHJ5KHJlbW90ZVR5cGVzLnBhdGgsIHJlbW90ZVR5cGVzLm5hbWUpLFxuICAgICAgICByZW1vdGVUeXBlc1ppcDogcmVtb3RlVHlwZXMuemlwIHx8ICcnLFxuICAgICAgICByZW1vdGVUeXBlc0FQSTogcmVtb3RlVHlwZXMuYXBpIHx8ICcnLFxuICAgICAgICByZW1vdGVzSW5mbyxcbiAgICAgICAgc2hhcmVkOiBtYW5pZmVzdCA9PSBudWxsID8gdm9pZCAwIDogbWFuaWZlc3Quc2hhcmVkLm1hcCgoaXRlbSk9Pih7XG4gICAgICAgICAgICAgICAgYXNzZXRzOiBpdGVtLmFzc2V0cyxcbiAgICAgICAgICAgICAgICBzaGFyZWROYW1lOiBpdGVtLm5hbWUsXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogaXRlbS52ZXJzaW9uXG4gICAgICAgICAgICB9KSksXG4gICAgICAgIG1vZHVsZXM6IGV4cG9zZXMgPT0gbnVsbCA/IHZvaWQgMCA6IGV4cG9zZXMubWFwKChleHBvc2UpPT4oe1xuICAgICAgICAgICAgICAgIG1vZHVsZU5hbWU6IGV4cG9zZS5uYW1lLFxuICAgICAgICAgICAgICAgIG1vZHVsZVBhdGg6IGV4cG9zZS5wYXRoLFxuICAgICAgICAgICAgICAgIGFzc2V0czogZXhwb3NlLmFzc2V0c1xuICAgICAgICAgICAgfSkpXG4gICAgfTtcbiAgICBpZiAoKF9tYW5pZmVzdF9tZXRhRGF0YSA9IG1hbmlmZXN0Lm1ldGFEYXRhKSA9PSBudWxsID8gdm9pZCAwIDogX21hbmlmZXN0X21ldGFEYXRhLnByZWZldGNoSW50ZXJmYWNlKSB7XG4gICAgICAgIHZhciBwcmVmZXRjaEludGVyZmFjZSA9IG1hbmlmZXN0Lm1ldGFEYXRhLnByZWZldGNoSW50ZXJmYWNlO1xuICAgICAgICBiYXNpY1JlbW90ZVNuYXBzaG90ID0gcG9seWZpbGxzLl9leHRlbmRzKHt9LCBiYXNpY1JlbW90ZVNuYXBzaG90LCB7XG4gICAgICAgICAgICBwcmVmZXRjaEludGVyZmFjZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKChfbWFuaWZlc3RfbWV0YURhdGExID0gbWFuaWZlc3QubWV0YURhdGEpID09IG51bGwgPyB2b2lkIDAgOiBfbWFuaWZlc3RfbWV0YURhdGExLnByZWZldGNoRW50cnkpIHtcbiAgICAgICAgdmFyIF9tYW5pZmVzdF9tZXRhRGF0YV9wcmVmZXRjaEVudHJ5ID0gbWFuaWZlc3QubWV0YURhdGEucHJlZmV0Y2hFbnRyeSwgcGF0aCA9IF9tYW5pZmVzdF9tZXRhRGF0YV9wcmVmZXRjaEVudHJ5LnBhdGgsIG5hbWUgPSBfbWFuaWZlc3RfbWV0YURhdGFfcHJlZmV0Y2hFbnRyeS5uYW1lLCB0eXBlID0gX21hbmlmZXN0X21ldGFEYXRhX3ByZWZldGNoRW50cnkudHlwZTtcbiAgICAgICAgYmFzaWNSZW1vdGVTbmFwc2hvdCA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgYmFzaWNSZW1vdGVTbmFwc2hvdCwge1xuICAgICAgICAgICAgcHJlZmV0Y2hFbnRyeTogc2ltcGxlSm9pblJlbW90ZUVudHJ5KHBhdGgsIG5hbWUpLFxuICAgICAgICAgICAgcHJlZmV0Y2hFbnRyeVR5cGU6IHR5cGVcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmICgncHVibGljUGF0aCcgaW4gbWFuaWZlc3QubWV0YURhdGEpIHtcbiAgICAgICAgcmVtb3RlU25hcHNob3QgPSBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGJhc2ljUmVtb3RlU25hcHNob3QsIHtcbiAgICAgICAgICAgIHB1YmxpY1BhdGg6IGdldFB1YmxpY1BhdGgoKVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZW1vdGVTbmFwc2hvdCA9IHBvbHlmaWxscy5fZXh0ZW5kcyh7fSwgYmFzaWNSZW1vdGVTbmFwc2hvdCwge1xuICAgICAgICAgICAgZ2V0UHVibGljUGF0aDogZ2V0UHVibGljUGF0aCgpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoc3NyUmVtb3RlRW50cnkpIHtcbiAgICAgICAgdmFyIGZ1bGxTU1JSZW1vdGVFbnRyeSA9IHNpbXBsZUpvaW5SZW1vdGVFbnRyeShzc3JSZW1vdGVFbnRyeS5wYXRoLCBzc3JSZW1vdGVFbnRyeS5uYW1lKTtcbiAgICAgICAgcmVtb3RlU25hcHNob3Quc3NyUmVtb3RlRW50cnkgPSBmdWxsU1NSUmVtb3RlRW50cnk7XG4gICAgICAgIHJlbW90ZVNuYXBzaG90LnNzclJlbW90ZUVudHJ5VHlwZSA9IHNzclJlbW90ZUVudHJ5LnR5cGUgfHwgJ2NvbW1vbmpzLW1vZHVsZSc7XG4gICAgfVxuICAgIHJldHVybiByZW1vdGVTbmFwc2hvdDtcbn1cbmZ1bmN0aW9uIGlzTWFuaWZlc3RQcm92aWRlcihtb2R1bGVJbmZvKSB7XG4gICAgaWYgKCdyZW1vdGVFbnRyeScgaW4gbW9kdWxlSW5mbyAmJiBtb2R1bGVJbmZvLnJlbW90ZUVudHJ5LmluY2x1ZGVzKE1BTklGRVNUX0VYVCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cbnZhciBQUkVGSVggPSAnWyBNb2R1bGUgRmVkZXJhdGlvbiBdJztcbnZhciBMb2dnZXIgPSAvKiNfX1BVUkVfXyovIGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIExvZ2dlcjEocHJlZml4KSB7XG4gICAgICAgIF9jbGFzc19jYWxsX2NoZWNrLl8odGhpcywgTG9nZ2VyMSk7XG4gICAgICAgIHRoaXMucHJlZml4ID0gcHJlZml4O1xuICAgIH1cbiAgICBfY3JlYXRlX2NsYXNzLl8oTG9nZ2VyMSwgW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwibG9nXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9nKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwid2FyblwiLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdhcm4xKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwiZXJyb3JcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlcnJvcjEoLi4uYXJncykge1xuICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhcbiAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJzdWNjZXNzXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3VjY2VzcyguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImluZm9cIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbmZvKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NvbnNvbGU7XG4gICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4XG4gICAgICAgICAgICAgICAgXS5jb25jYXQoX3RvX2NvbnN1bWFibGVfYXJyYXkuXyhhcmdzKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBrZXk6IFwicmVhZHlcIixcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWFkeSguLi5hcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jb25zb2xlO1xuICAgICAgICAgICAgICAgIChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgIF0uY29uY2F0KF90b19jb25zdW1hYmxlX2FycmF5Ll8oYXJncykpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAga2V5OiBcImRlYnVnXCIsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVidWcoLi4uYXJncykge1xuICAgICAgICAgICAgICAgIGlmIChpc0RlYnVnTW9kZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY29uc29sZTtcbiAgICAgICAgICAgICAgICAgICAgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBbXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWZpeFxuICAgICAgICAgICAgICAgICAgICBdLmNvbmNhdChfdG9fY29uc3VtYWJsZV9hcnJheS5fKGFyZ3MpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSk7XG4gICAgcmV0dXJuIExvZ2dlcjE7XG59KCk7XG5mdW5jdGlvbiBjcmVhdGVMb2dnZXIocHJlZml4KSB7XG4gICAgcmV0dXJuIG5ldyBMb2dnZXIocHJlZml4KTtcbn1cbnZhciBsb2dnZXIgPSBjcmVhdGVMb2dnZXIoUFJFRklYKTtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5mdW5jdGlvbiBzYWZlV3JhcHBlcihjYWxsYmFjaywgZGlzYWJsZVdhcm4pIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciByZXMgPSB5aWVsZCBjYWxsYmFjaygpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgIWRpc2FibGVXYXJuICYmIHdhcm4oZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9KSgpO1xufVxuZnVuY3Rpb24gaXNTdGF0aWNSZXNvdXJjZXNFcXVhbCh1cmwxLCB1cmwyKSB7XG4gICAgdmFyIFJFR19FWFAgPSAvXihodHRwcz86KT9cXC9cXC8vaTtcbiAgICAvLyBUcmFuc2Zvcm0gdXJsMSBhbmQgdXJsMiBpbnRvIHJlbGF0aXZlIHBhdGhzXG4gICAgdmFyIHJlbGF0aXZlVXJsMSA9IHVybDEucmVwbGFjZShSRUdfRVhQLCAnJykucmVwbGFjZSgvXFwvJC8sICcnKTtcbiAgICB2YXIgcmVsYXRpdmVVcmwyID0gdXJsMi5yZXBsYWNlKFJFR19FWFAsICcnKS5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgIC8vIENoZWNrIGlmIHRoZSByZWxhdGl2ZSBwYXRocyBhcmUgaWRlbnRpY2FsXG4gICAgcmV0dXJuIHJlbGF0aXZlVXJsMSA9PT0gcmVsYXRpdmVVcmwyO1xufVxuZnVuY3Rpb24gY3JlYXRlU2NyaXB0KGluZm8pIHtcbiAgICAvLyBSZXRyaWV2ZSB0aGUgZXhpc3Rpbmcgc2NyaXB0IGVsZW1lbnQgYnkgaXRzIHNyYyBhdHRyaWJ1dGVcbiAgICB2YXIgc2NyaXB0ID0gbnVsbDtcbiAgICB2YXIgbmVlZEF0dGFjaCA9IHRydWU7XG4gICAgdmFyIHRpbWVvdXQgPSAyMDAwMDtcbiAgICB2YXIgdGltZW91dElkO1xuICAgIHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBzY3JpcHRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgdmFyIHMgPSBzY3JpcHRzW2ldO1xuICAgICAgICB2YXIgc2NyaXB0U3JjID0gcy5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuICAgICAgICBpZiAoc2NyaXB0U3JjICYmIGlzU3RhdGljUmVzb3VyY2VzRXF1YWwoc2NyaXB0U3JjLCBpbmZvLnVybCkpIHtcbiAgICAgICAgICAgIHNjcmlwdCA9IHM7XG4gICAgICAgICAgICBuZWVkQXR0YWNoID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXNjcmlwdCkge1xuICAgICAgICB2YXIgYXR0cnMgPSBpbmZvLmF0dHJzO1xuICAgICAgICBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgc2NyaXB0LnR5cGUgPSAoYXR0cnMgPT0gbnVsbCA/IHZvaWQgMCA6IGF0dHJzWyd0eXBlJ10pID09PSAnbW9kdWxlJyA/ICdtb2R1bGUnIDogJ3RleHQvamF2YXNjcmlwdCc7XG4gICAgICAgIHZhciBjcmVhdGVTY3JpcHRSZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChpbmZvLmNyZWF0ZVNjcmlwdEhvb2spIHtcbiAgICAgICAgICAgIGNyZWF0ZVNjcmlwdFJlcyA9IGluZm8uY3JlYXRlU2NyaXB0SG9vayhpbmZvLnVybCwgaW5mby5hdHRycyk7XG4gICAgICAgICAgICBpZiAoY3JlYXRlU2NyaXB0UmVzIGluc3RhbmNlb2YgSFRNTFNjcmlwdEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBzY3JpcHQgPSBjcmVhdGVTY3JpcHRSZXM7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBjcmVhdGVTY3JpcHRSZXMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCdzY3JpcHQnIGluIGNyZWF0ZVNjcmlwdFJlcyAmJiBjcmVhdGVTY3JpcHRSZXMuc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgICAgIHNjcmlwdCA9IGNyZWF0ZVNjcmlwdFJlcy5zY3JpcHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgndGltZW91dCcgaW4gY3JlYXRlU2NyaXB0UmVzICYmIGNyZWF0ZVNjcmlwdFJlcy50aW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBjcmVhdGVTY3JpcHRSZXMudGltZW91dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzY3JpcHQuc3JjKSB7XG4gICAgICAgICAgICBzY3JpcHQuc3JjID0gaW5mby51cmw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGF0dHJzICYmICFjcmVhdGVTY3JpcHRSZXMpIHtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGF0dHJzKS5mb3JFYWNoKChuYW1lKT0+e1xuICAgICAgICAgICAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdhc3luYycgfHwgbmFtZSA9PT0gJ2RlZmVyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NyaXB0W25hbWVdID0gYXR0cnNbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIC8vIEF0dHJpYnV0ZXMgdGhhdCBkbyBub3QgZXhpc3QgYXJlIGNvbnNpZGVyZWQgb3ZlcnJpZGRlblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFzY3JpcHQuZ2V0QXR0cmlidXRlKG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHQuc2V0QXR0cmlidXRlKG5hbWUsIGF0dHJzW25hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBvblNjcmlwdENvbXBsZXRlID0gKHByZXYsIGV2ZW50KT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICAgICAgdmFyIG9uU2NyaXB0Q29tcGxldGVDYWxsYmFjayA9ICgpPT57XG4gICAgICAgICAgICAgICAgaWYgKChldmVudCA9PSBudWxsID8gdm9pZCAwIDogZXZlbnQudHlwZSkgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgICAgICAgICAgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8ub25FcnJvckNhbGxiYWNrKSAmJiAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5vbkVycm9yQ2FsbGJhY2soZXZlbnQpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5jYikgJiYgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8uY2IoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIFByZXZlbnQgbWVtb3J5IGxlYWtzIGluIElFLlxuICAgICAgICAgICAgaWYgKHNjcmlwdCkge1xuICAgICAgICAgICAgICAgIHNjcmlwdC5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzY3JpcHQub25sb2FkID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzYWZlV3JhcHBlcigoKT0+e1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2luZm9fbmVlZERlbGV0ZVNjcmlwdCA9IGluZm8ubmVlZERlbGV0ZVNjcmlwdCwgbmVlZERlbGV0ZVNjcmlwdCA9IF9pbmZvX25lZWREZWxldGVTY3JpcHQgPT09IHZvaWQgMCA/IHRydWUgOiBfaW5mb19uZWVkRGVsZXRlU2NyaXB0O1xuICAgICAgICAgICAgICAgICAgICBpZiAobmVlZERlbGV0ZVNjcmlwdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgKHNjcmlwdCA9PSBudWxsID8gdm9pZCAwIDogc2NyaXB0LnBhcmVudE5vZGUpICYmIHNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAocHJldiAmJiB0eXBlb2YgcHJldiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gcHJldihldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0geWllbGQgcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgb25TY3JpcHRDb21wbGV0ZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG9uU2NyaXB0Q29tcGxldGVDYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9uU2NyaXB0Q29tcGxldGVDYWxsYmFjaygpO1xuICAgICAgICB9KSgpO1xuICAgIHNjcmlwdC5vbmVycm9yID0gb25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHNjcmlwdC5vbmVycm9yKTtcbiAgICBzY3JpcHQub25sb2FkID0gb25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHNjcmlwdC5vbmxvYWQpO1xuICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCk9PntcbiAgICAgICAgb25TY3JpcHRDb21wbGV0ZShudWxsLCBuZXcgRXJyb3IoYFJlbW90ZSBzY3JpcHQgXCIke2luZm8udXJsfVwiIHRpbWUtb3V0ZWQuYCkpO1xuICAgIH0sIHRpbWVvdXQpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHNjcmlwdCxcbiAgICAgICAgbmVlZEF0dGFjaFxuICAgIH07XG59XG5mdW5jdGlvbiBjcmVhdGVMaW5rKGluZm8pIHtcbiAgICAvLyA8bGluayByZWw9XCJwcmVsb2FkXCIgaHJlZj1cInNjcmlwdC5qc1wiIGFzPVwic2NyaXB0XCI+XG4gICAgLy8gUmV0cmlldmUgdGhlIGV4aXN0aW5nIHNjcmlwdCBlbGVtZW50IGJ5IGl0cyBzcmMgYXR0cmlidXRlXG4gICAgdmFyIGxpbmsgPSBudWxsO1xuICAgIHZhciBuZWVkQXR0YWNoID0gdHJ1ZTtcbiAgICB2YXIgbGlua3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbGluaycpO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIHZhciBsID0gbGlua3NbaV07XG4gICAgICAgIHZhciBsaW5rSHJlZiA9IGwuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gICAgICAgIHZhciBsaW5rUmVsID0gbC5nZXRBdHRyaWJ1dGUoJ3JlbCcpO1xuICAgICAgICBpZiAobGlua0hyZWYgJiYgaXNTdGF0aWNSZXNvdXJjZXNFcXVhbChsaW5rSHJlZiwgaW5mby51cmwpICYmIGxpbmtSZWwgPT09IGluZm8uYXR0cnNbJ3JlbCddKSB7XG4gICAgICAgICAgICBsaW5rID0gbDtcbiAgICAgICAgICAgIG5lZWRBdHRhY2ggPSBmYWxzZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghbGluaykge1xuICAgICAgICBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGluaycpO1xuICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIGluZm8udXJsKTtcbiAgICAgICAgdmFyIGNyZWF0ZUxpbmtSZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBhdHRycyA9IGluZm8uYXR0cnM7XG4gICAgICAgIGlmIChpbmZvLmNyZWF0ZUxpbmtIb29rKSB7XG4gICAgICAgICAgICBjcmVhdGVMaW5rUmVzID0gaW5mby5jcmVhdGVMaW5rSG9vayhpbmZvLnVybCwgYXR0cnMpO1xuICAgICAgICAgICAgaWYgKGNyZWF0ZUxpbmtSZXMgaW5zdGFuY2VvZiBIVE1MTGlua0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBsaW5rID0gY3JlYXRlTGlua1JlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoYXR0cnMgJiYgIWNyZWF0ZUxpbmtSZXMpIHtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGF0dHJzKS5mb3JFYWNoKChuYW1lKT0+e1xuICAgICAgICAgICAgICAgIGlmIChsaW5rICYmICFsaW5rLmdldEF0dHJpYnV0ZShuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZShuYW1lLCBhdHRyc1tuYW1lXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIG9uTGlua0NvbXBsZXRlID0gKHByZXYsIGV2ZW50KT0+e1xuICAgICAgICB2YXIgb25MaW5rQ29tcGxldGVDYWxsYmFjayA9ICgpPT57XG4gICAgICAgICAgICBpZiAoKGV2ZW50ID09IG51bGwgPyB2b2lkIDAgOiBldmVudC50eXBlKSA9PT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgICAgIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLm9uRXJyb3JDYWxsYmFjaykgJiYgKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IGluZm8ub25FcnJvckNhbGxiYWNrKGV2ZW50KSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIChpbmZvID09IG51bGwgPyB2b2lkIDAgOiBpbmZvLmNiKSAmJiAoaW5mbyA9PSBudWxsID8gdm9pZCAwIDogaW5mby5jYigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gUHJldmVudCBtZW1vcnkgbGVha3MgaW4gSUUuXG4gICAgICAgIGlmIChsaW5rKSB7XG4gICAgICAgICAgICBsaW5rLm9uZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgbGluay5vbmxvYWQgPSBudWxsO1xuICAgICAgICAgICAgc2FmZVdyYXBwZXIoKCk9PntcbiAgICAgICAgICAgICAgICB2YXIgX2luZm9fbmVlZERlbGV0ZUxpbmsgPSBpbmZvLm5lZWREZWxldGVMaW5rLCBuZWVkRGVsZXRlTGluayA9IF9pbmZvX25lZWREZWxldGVMaW5rID09PSB2b2lkIDAgPyB0cnVlIDogX2luZm9fbmVlZERlbGV0ZUxpbms7XG4gICAgICAgICAgICAgICAgaWYgKG5lZWREZWxldGVMaW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIChsaW5rID09IG51bGwgPyB2b2lkIDAgOiBsaW5rLnBhcmVudE5vZGUpICYmIGxpbmsucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsaW5rKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChwcmV2KSB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gcHJldihldmVudCk7XG4gICAgICAgICAgICAgICAgb25MaW5rQ29tcGxldGVDYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb25MaW5rQ29tcGxldGVDYWxsYmFjaygpO1xuICAgIH07XG4gICAgbGluay5vbmVycm9yID0gb25MaW5rQ29tcGxldGUuYmluZChudWxsLCBsaW5rLm9uZXJyb3IpO1xuICAgIGxpbmsub25sb2FkID0gb25MaW5rQ29tcGxldGUuYmluZChudWxsLCBsaW5rLm9ubG9hZCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbGluayxcbiAgICAgICAgbmVlZEF0dGFjaFxuICAgIH07XG59XG5mdW5jdGlvbiBsb2FkU2NyaXB0KHVybCwgaW5mbykge1xuICAgIHZhciBfaW5mb19hdHRycyA9IGluZm8uYXR0cnMsIGF0dHJzID0gX2luZm9fYXR0cnMgPT09IHZvaWQgMCA/IHt9IDogX2luZm9fYXR0cnMsIGNyZWF0ZVNjcmlwdEhvb2sgPSBpbmZvLmNyZWF0ZVNjcmlwdEhvb2s7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpPT57XG4gICAgICAgIHZhciBfY3JlYXRlU2NyaXB0ID0gY3JlYXRlU2NyaXB0KHtcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIGNiOiByZXNvbHZlLFxuICAgICAgICAgICAgb25FcnJvckNhbGxiYWNrOiByZWplY3QsXG4gICAgICAgICAgICBhdHRyczogcG9seWZpbGxzLl9leHRlbmRzKHtcbiAgICAgICAgICAgICAgICBmZXRjaHByaW9yaXR5OiAnaGlnaCdcbiAgICAgICAgICAgIH0sIGF0dHJzKSxcbiAgICAgICAgICAgIGNyZWF0ZVNjcmlwdEhvb2ssXG4gICAgICAgICAgICBuZWVkRGVsZXRlU2NyaXB0OiB0cnVlXG4gICAgICAgIH0pLCBzY3JpcHQgPSBfY3JlYXRlU2NyaXB0LnNjcmlwdCwgbmVlZEF0dGFjaCA9IF9jcmVhdGVTY3JpcHQubmVlZEF0dGFjaDtcbiAgICAgICAgbmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBpbXBvcnROb2RlTW9kdWxlKG5hbWUpIHtcbiAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbXBvcnQgc3BlY2lmaWVyIGlzIHJlcXVpcmVkJyk7XG4gICAgfVxuICAgIHZhciBpbXBvcnRNb2R1bGUgPSBuZXcgRnVuY3Rpb24oJ25hbWUnLCBgcmV0dXJuIGltcG9ydChuYW1lKWApO1xuICAgIHJldHVybiBpbXBvcnRNb2R1bGUobmFtZSkudGhlbigocmVzKT0+cmVzKS5jYXRjaCgoZXJyb3IxKT0+e1xuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBpbXBvcnRpbmcgbW9kdWxlICR7bmFtZX06YCwgZXJyb3IxKTtcbiAgICAgICAgdGhyb3cgZXJyb3IxO1xuICAgIH0pO1xufVxudmFyIGxvYWROb2RlRmV0Y2ggPSAoKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgdmFyIGZldGNoTW9kdWxlID0geWllbGQgaW1wb3J0Tm9kZU1vZHVsZSgnbm9kZS1mZXRjaCcpO1xuICAgICAgICByZXR1cm4gZmV0Y2hNb2R1bGUuZGVmYXVsdCB8fCBmZXRjaE1vZHVsZTtcbiAgICB9KSgpO1xudmFyIGxhenlMb2FkZXJIb29rRmV0Y2ggPSAoaW5wdXQsIGluaXQsIGxvYWRlckhvb2spPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICB2YXIgaG9vayA9ICh1cmwsIGluaXQpPT57XG4gICAgICAgICAgICByZXR1cm4gbG9hZGVySG9vay5saWZlY3ljbGUuZmV0Y2guZW1pdCh1cmwsIGluaXQpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgcmVzID0geWllbGQgaG9vayhpbnB1dCwgaW5pdCB8fCB7fSk7XG4gICAgICAgIGlmICghcmVzIHx8ICEocmVzIGluc3RhbmNlb2YgUmVzcG9uc2UpKSB7XG4gICAgICAgICAgICB2YXIgZmV0Y2hGdW5jdGlvbiA9IHR5cGVvZiBmZXRjaCA9PT0gJ3VuZGVmaW5lZCcgPyB5aWVsZCBsb2FkTm9kZUZldGNoKCkgOiBmZXRjaDtcbiAgICAgICAgICAgIHJldHVybiBmZXRjaEZ1bmN0aW9uKGlucHV0LCBpbml0IHx8IHt9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH0pKCk7XG5mdW5jdGlvbiBjcmVhdGVTY3JpcHROb2RlKHVybCwgY2IsIGF0dHJzLCBsb2FkZXJIb29rKSB7XG4gICAgaWYgKGxvYWRlckhvb2sgPT0gbnVsbCA/IHZvaWQgMCA6IGxvYWRlckhvb2suY3JlYXRlU2NyaXB0SG9vaykge1xuICAgICAgICB2YXIgaG9va1Jlc3VsdCA9IGxvYWRlckhvb2suY3JlYXRlU2NyaXB0SG9vayh1cmwpO1xuICAgICAgICBpZiAoaG9va1Jlc3VsdCAmJiB0eXBlb2YgaG9va1Jlc3VsdCA9PT0gJ29iamVjdCcgJiYgJ3VybCcgaW4gaG9va1Jlc3VsdCkge1xuICAgICAgICAgICAgdXJsID0gaG9va1Jlc3VsdC51cmw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHVybE9iajtcbiAgICB0cnkge1xuICAgICAgICB1cmxPYmogPSBuZXcgVVJMKHVybCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjb25zdHJ1Y3RpbmcgVVJMOicsIGUpO1xuICAgICAgICBjYihuZXcgRXJyb3IoYEludmFsaWQgVVJMOiAke2V9YCkpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBnZXRGZXRjaCA9ICgpPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgaWYgKGxvYWRlckhvb2sgPT0gbnVsbCA/IHZvaWQgMCA6IGxvYWRlckhvb2suZmV0Y2gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGlucHV0LCBpbml0KT0+bGF6eUxvYWRlckhvb2tGZXRjaChpbnB1dCwgaW5pdCwgbG9hZGVySG9vayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIGZldGNoID09PSAndW5kZWZpbmVkJyA/IGxvYWROb2RlRmV0Y2goKSA6IGZldGNoO1xuICAgICAgICB9KSgpO1xuICAgIHZhciBoYW5kbGVTY3JpcHRGZXRjaCA9IChmLCB1cmxPYmopPT5fYXN5bmNfdG9fZ2VuZXJhdG9yLl8oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgX3ZtX2NvbnN0YW50cztcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0geWllbGQgZih1cmxPYmouaHJlZik7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB5aWVsZCByZXMudGV4dCgpO1xuICAgICAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKCh5aWVsZCBQcm9taXNlLmFsbChbXG4gICAgICAgICAgICAgICAgICAgIGltcG9ydE5vZGVNb2R1bGUoJ3BhdGgnKSxcbiAgICAgICAgICAgICAgICAgICAgaW1wb3J0Tm9kZU1vZHVsZSgndm0nKVxuICAgICAgICAgICAgICAgIF0pKSwgMiksIHBhdGggPSBfcmVmWzBdLCB2bSA9IF9yZWZbMV07XG4gICAgICAgICAgICAgICAgdmFyIHNjcmlwdENvbnRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGV4cG9ydHM6IHt9LFxuICAgICAgICAgICAgICAgICAgICBtb2R1bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9ydHM6IHt9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciB1cmxEaXJuYW1lID0gdXJsT2JqLnBhdGhuYW1lLnNwbGl0KCcvJykuc2xpY2UoMCwgLTEpLmpvaW4oJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgZmlsZW5hbWUgPSBwYXRoLmJhc2VuYW1lKHVybE9iai5wYXRobmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIF92bV9jb25zdGFudHNfVVNFX01BSU5fQ09OVEVYVF9ERUZBVUxUX0xPQURFUjtcbiAgICAgICAgICAgICAgICB2YXIgc2NyaXB0ID0gbmV3IHZtLlNjcmlwdChgKGZ1bmN0aW9uKGV4cG9ydHMsIG1vZHVsZSwgcmVxdWlyZSwgX19kaXJuYW1lLCBfX2ZpbGVuYW1lKSB7JHtkYXRhfVxcbn0pYCwge1xuICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgaW1wb3J0TW9kdWxlRHluYW1pY2FsbHk6IChfdm1fY29uc3RhbnRzX1VTRV9NQUlOX0NPTlRFWFRfREVGQVVMVF9MT0FERVIgPSAoX3ZtX2NvbnN0YW50cyA9IHZtLmNvbnN0YW50cykgPT0gbnVsbCA/IHZvaWQgMCA6IF92bV9jb25zdGFudHMuVVNFX01BSU5fQ09OVEVYVF9ERUZBVUxUX0xPQURFUikgIT0gbnVsbCA/IF92bV9jb25zdGFudHNfVVNFX01BSU5fQ09OVEVYVF9ERUZBVUxUX0xPQURFUiA6IGltcG9ydE5vZGVNb2R1bGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBzY3JpcHQucnVuSW5UaGlzQ29udGV4dCgpKHNjcmlwdENvbnRleHQuZXhwb3J0cywgc2NyaXB0Q29udGV4dC5tb2R1bGUsIGV2YWwoJ3JlcXVpcmUnKSwgdXJsRGlybmFtZSwgZmlsZW5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBleHBvcnRlZEludGVyZmFjZSA9IHNjcmlwdENvbnRleHQubW9kdWxlLmV4cG9ydHMgfHwgc2NyaXB0Q29udGV4dC5leHBvcnRzO1xuICAgICAgICAgICAgICAgIGlmIChhdHRycyAmJiBleHBvcnRlZEludGVyZmFjZSAmJiBhdHRyc1snZ2xvYmFsTmFtZSddKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBleHBvcnRlZEludGVyZmFjZVthdHRyc1snZ2xvYmFsTmFtZSddXSB8fCBleHBvcnRlZEludGVyZmFjZTtcbiAgICAgICAgICAgICAgICAgICAgY2IodW5kZWZpbmVkLCBjb250YWluZXIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNiKHVuZGVmaW5lZCwgZXhwb3J0ZWRJbnRlcmZhY2UpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNiKGUgaW5zdGFuY2VvZiBFcnJvciA/IGUgOiBuZXcgRXJyb3IoYFNjcmlwdCBleGVjdXRpb24gZXJyb3I6ICR7ZX1gKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG4gICAgZ2V0RmV0Y2goKS50aGVuKChmKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgIGlmICgoYXR0cnMgPT0gbnVsbCA/IHZvaWQgMCA6IGF0dHJzWyd0eXBlJ10pID09PSAnZXNtJyB8fCAoYXR0cnMgPT0gbnVsbCA/IHZvaWQgMCA6IGF0dHJzWyd0eXBlJ10pID09PSAnbW9kdWxlJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkTW9kdWxlKHVybE9iai5ocmVmLCB7XG4gICAgICAgICAgICAgICAgICAgIGZldGNoOiBmLFxuICAgICAgICAgICAgICAgICAgICB2bTogeWllbGQgaW1wb3J0Tm9kZU1vZHVsZSgndm0nKVxuICAgICAgICAgICAgICAgIH0pLnRoZW4oKG1vZHVsZSk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBtb2R1bGUuZXZhbHVhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNiKHVuZGVmaW5lZCwgbW9kdWxlLm5hbWVzcGFjZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pKCkpLmNhdGNoKChlKT0+e1xuICAgICAgICAgICAgICAgICAgICBjYihlIGluc3RhbmNlb2YgRXJyb3IgPyBlIDogbmV3IEVycm9yKGBTY3JpcHQgZXhlY3V0aW9uIGVycm9yOiAke2V9YCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGFuZGxlU2NyaXB0RmV0Y2goZiwgdXJsT2JqKTtcbiAgICAgICAgfSkoKSkuY2F0Y2goKGVycik9PntcbiAgICAgICAgY2IoZXJyKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGxvYWRTY3JpcHROb2RlKHVybCwgaW5mbykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+e1xuICAgICAgICBjcmVhdGVTY3JpcHROb2RlKHVybCwgKGVycm9yMSwgc2NyaXB0Q29udGV4dCk9PntcbiAgICAgICAgICAgIGlmIChlcnJvcjEpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIF9pbmZvX2F0dHJzLCBfaW5mb19hdHRyczE7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZUVudHJ5S2V5ID0gKGluZm8gPT0gbnVsbCA/IHZvaWQgMCA6IChfaW5mb19hdHRycyA9IGluZm8uYXR0cnMpID09IG51bGwgPyB2b2lkIDAgOiBfaW5mb19hdHRyc1snZ2xvYmFsTmFtZSddKSB8fCBgX19GRURFUkFUSU9OXyR7aW5mbyA9PSBudWxsID8gdm9pZCAwIDogKF9pbmZvX2F0dHJzMSA9IGluZm8uYXR0cnMpID09IG51bGwgPyB2b2lkIDAgOiBfaW5mb19hdHRyczFbJ25hbWUnXX06Y3VzdG9tX19gO1xuICAgICAgICAgICAgICAgIHZhciBlbnRyeUV4cG9ydHMgPSBnbG9iYWxUaGlzW3JlbW90ZUVudHJ5S2V5XSA9IHNjcmlwdENvbnRleHQ7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShlbnRyeUV4cG9ydHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBpbmZvLmF0dHJzLCBpbmZvLmxvYWRlckhvb2spO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gbG9hZE1vZHVsZSh1cmwsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gX2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgdmFyIGZldGNoMSA9IG9wdGlvbnMuZmV0Y2gsIHZtID0gb3B0aW9ucy52bTtcbiAgICAgICAgdmFyIHJlc3BvbnNlID0geWllbGQgZmV0Y2gxKHVybCk7XG4gICAgICAgIHZhciBjb2RlID0geWllbGQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICB2YXIgbW9kdWxlID0gbmV3IHZtLlNvdXJjZVRleHRNb2R1bGUoY29kZSwge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgaW1wb3J0TW9kdWxlRHluYW1pY2FsbHk6IChzcGVjaWZpZXIsIHNjcmlwdCk9Pl9hc3luY190b19nZW5lcmF0b3IuXyhmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXNvbHZlZFVybCA9IG5ldyBVUkwoc3BlY2lmaWVyLCB1cmwpLmhyZWY7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2FkTW9kdWxlKHJlc29sdmVkVXJsLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9KSgpXG4gICAgICAgIH0pO1xuICAgICAgICB5aWVsZCBtb2R1bGUubGluaygoc3BlY2lmaWVyKT0+X2FzeW5jX3RvX2dlbmVyYXRvci5fKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzb2x2ZWRVcmwgPSBuZXcgVVJMKHNwZWNpZmllciwgdXJsKS5ocmVmO1xuICAgICAgICAgICAgICAgIHZhciBtb2R1bGUgPSB5aWVsZCBsb2FkTW9kdWxlKHJlc29sdmVkVXJsLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9kdWxlO1xuICAgICAgICAgICAgfSkoKSk7XG4gICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgfSkoKTtcbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZU9wdGlvbnMoZW5hYmxlRGVmYXVsdCwgZGVmYXVsdE9wdGlvbnMsIGtleSkge1xuICAgIHJldHVybiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIGlmIChvcHRpb25zID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGlmIChlbmFibGVEZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0T3B0aW9ucztcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2x5ZmlsbHMuX2V4dGVuZHMoe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgdHlwZSBmb3IgXFxgJHtrZXl9XFxgLCBleHBlY3QgYm9vbGVhbi91bmRlZmluZWQvb2JqZWN0LCBnb3Q6ICR7dHlwZW9mIG9wdGlvbnN9YCk7XG4gICAgfTtcbn1cbmV4cG9ydHMuQlJPV1NFUl9MT0dfS0VZID0gQlJPV1NFUl9MT0dfS0VZO1xuZXhwb3J0cy5CUk9XU0VSX0xPR19WQUxVRSA9IEJST1dTRVJfTE9HX1ZBTFVFO1xuZXhwb3J0cy5FTkNPREVfTkFNRV9QUkVGSVggPSBFTkNPREVfTkFNRV9QUkVGSVg7XG5leHBvcnRzLkVuY29kZWROYW1lVHJhbnNmb3JtTWFwID0gRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXA7XG5leHBvcnRzLkZlZGVyYXRpb25Nb2R1bGVNYW5pZmVzdCA9IEZlZGVyYXRpb25Nb2R1bGVNYW5pZmVzdDtcbmV4cG9ydHMuTUFOSUZFU1RfRVhUID0gTUFOSUZFU1RfRVhUO1xuZXhwb3J0cy5NRk1vZHVsZVR5cGUgPSBNRk1vZHVsZVR5cGU7XG5leHBvcnRzLk1GUHJlZmV0Y2hDb21tb24gPSBNRlByZWZldGNoQ29tbW9uO1xuZXhwb3J0cy5NT0RVTEVfREVWVE9PTF9JREVOVElGSUVSID0gTU9EVUxFX0RFVlRPT0xfSURFTlRJRklFUjtcbmV4cG9ydHMuTWFuaWZlc3RGaWxlTmFtZSA9IE1hbmlmZXN0RmlsZU5hbWU7XG5leHBvcnRzLk5hbWVUcmFuc2Zvcm1NYXAgPSBOYW1lVHJhbnNmb3JtTWFwO1xuZXhwb3J0cy5OYW1lVHJhbnNmb3JtU3ltYm9sID0gTmFtZVRyYW5zZm9ybVN5bWJvbDtcbmV4cG9ydHMuU0VQQVJBVE9SID0gU0VQQVJBVE9SO1xuZXhwb3J0cy5TdGF0c0ZpbGVOYW1lID0gU3RhdHNGaWxlTmFtZTtcbmV4cG9ydHMuVEVNUF9ESVIgPSBURU1QX0RJUjtcbmV4cG9ydHMuYXNzZXJ0ID0gYXNzZXJ0O1xuZXhwb3J0cy5jb21wb3NlS2V5V2l0aFNlcGFyYXRvciA9IGNvbXBvc2VLZXlXaXRoU2VwYXJhdG9yO1xuZXhwb3J0cy5jb250YWluZXJQbHVnaW4gPSBDb250YWluZXJQbHVnaW47XG5leHBvcnRzLmNvbnRhaW5lclJlZmVyZW5jZVBsdWdpbiA9IENvbnRhaW5lclJlZmVyZW5jZVBsdWdpbjtcbmV4cG9ydHMuY3JlYXRlTGluayA9IGNyZWF0ZUxpbms7XG5leHBvcnRzLmNyZWF0ZUxvZ2dlciA9IGNyZWF0ZUxvZ2dlcjtcbmV4cG9ydHMuY3JlYXRlU2NyaXB0ID0gY3JlYXRlU2NyaXB0O1xuZXhwb3J0cy5jcmVhdGVTY3JpcHROb2RlID0gY3JlYXRlU2NyaXB0Tm9kZTtcbmV4cG9ydHMuZGVjb2RlTmFtZSA9IGRlY29kZU5hbWU7XG5leHBvcnRzLmVuY29kZU5hbWUgPSBlbmNvZGVOYW1lO1xuZXhwb3J0cy5lcnJvciA9IGVycm9yO1xuZXhwb3J0cy5nZW5lcmF0ZUV4cG9zZUZpbGVuYW1lID0gZ2VuZXJhdGVFeHBvc2VGaWxlbmFtZTtcbmV4cG9ydHMuZ2VuZXJhdGVTaGFyZUZpbGVuYW1lID0gZ2VuZXJhdGVTaGFyZUZpbGVuYW1lO1xuZXhwb3J0cy5nZW5lcmF0ZVNuYXBzaG90RnJvbU1hbmlmZXN0ID0gZ2VuZXJhdGVTbmFwc2hvdEZyb21NYW5pZmVzdDtcbmV4cG9ydHMuZ2V0UHJvY2Vzc0VudiA9IGdldFByb2Nlc3NFbnY7XG5leHBvcnRzLmdldFJlc291cmNlVXJsID0gZ2V0UmVzb3VyY2VVcmw7XG5leHBvcnRzLmluZmVyQXV0b1B1YmxpY1BhdGggPSBpbmZlckF1dG9QdWJsaWNQYXRoO1xuZXhwb3J0cy5pc0Jyb3dzZXJFbnYgPSBpc0Jyb3dzZXJFbnY7XG5leHBvcnRzLmlzRGVidWdNb2RlID0gaXNEZWJ1Z01vZGU7XG5leHBvcnRzLmlzTWFuaWZlc3RQcm92aWRlciA9IGlzTWFuaWZlc3RQcm92aWRlcjtcbmV4cG9ydHMuaXNSZXF1aXJlZFZlcnNpb24gPSBpc1JlcXVpcmVkVmVyc2lvbjtcbmV4cG9ydHMuaXNTdGF0aWNSZXNvdXJjZXNFcXVhbCA9IGlzU3RhdGljUmVzb3VyY2VzRXF1YWw7XG5leHBvcnRzLmxvYWRTY3JpcHQgPSBsb2FkU2NyaXB0O1xuZXhwb3J0cy5sb2FkU2NyaXB0Tm9kZSA9IGxvYWRTY3JpcHROb2RlO1xuZXhwb3J0cy5sb2dnZXIgPSBsb2dnZXI7XG5leHBvcnRzLm1vZHVsZUZlZGVyYXRpb25QbHVnaW4gPSBNb2R1bGVGZWRlcmF0aW9uUGx1Z2luO1xuZXhwb3J0cy5ub3JtYWxpemVPcHRpb25zID0gbm9ybWFsaXplT3B0aW9ucztcbmV4cG9ydHMucGFyc2VFbnRyeSA9IHBhcnNlRW50cnk7XG5leHBvcnRzLnNhZmVUb1N0cmluZyA9IHNhZmVUb1N0cmluZztcbmV4cG9ydHMuc2FmZVdyYXBwZXIgPSBzYWZlV3JhcHBlcjtcbmV4cG9ydHMuc2hhcmVQbHVnaW4gPSBTaGFyZVBsdWdpbjtcbmV4cG9ydHMuc2ltcGxlSm9pblJlbW90ZUVudHJ5ID0gc2ltcGxlSm9pblJlbW90ZUVudHJ5O1xuZXhwb3J0cy53YXJuID0gd2FybjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3Nkay9kaXN0L3BvbHlmaWxscy5janMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi9zZGsvZGlzdC9wb2x5ZmlsbHMuY2pzLmpzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9leHRlbmRzKCkge1xuICAgIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0KSB7XG4gICAgICAgIGZvcih2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGZvcih2YXIga2V5IGluIHNvdXJjZSlpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH07XG4gICAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5leHBvcnRzLl9leHRlbmRzID0gX2V4dGVuZHM7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2NvbnN0YW50LmNqcy5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2NvbnN0YW50LmNqcy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIEZFREVSQVRJT05fU1VQUE9SVEVEX1RZUEVTID0gW1xuICAgICdzY3JpcHQnXG5dO1xuZXhwb3J0cy5GRURFUkFUSU9OX1NVUFBPUlRFRF9UWVBFUyA9IEZFREVSQVRJT05fU1VQUE9SVEVEX1RZUEVTO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9AbW9kdWxlLWZlZGVyYXRpb24vd2VicGFjay1idW5kbGVyLXJ1bnRpbWUvZGlzdC9pbmRleC5janMuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbnZhciBfb2JqZWN0X3NwcmVhZCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19vYmplY3Rfc3ByZWFkICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fb2JqZWN0X3NwcmVhZC5janNcIik7XG52YXIgcnVudGltZSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBtb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lICovIFwiLi9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3J1bnRpbWUvZGlzdC9pbmRleC5janMuanNcIik7XG52YXIgY29uc3RhbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL2NvbnN0YW50LmNqcy5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2NvbnN0YW50LmNqcy5qc1wiKTtcbmZ1bmN0aW9uIF9pbnRlcm9wTmFtZXNwYWNlRGVmYXVsdChlKSB7XG4gICAgdmFyIG4gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIGlmIChlKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKGUpLmZvckVhY2goZnVuY3Rpb24oaykge1xuICAgICAgICAgICAgaWYgKGsgIT09ICdkZWZhdWx0Jykge1xuICAgICAgICAgICAgICAgIHZhciBkID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLCBrKTtcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobiwgaywgZC5nZXQgPyBkIDoge1xuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVba107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG4uZGVmYXVsdCA9IGU7XG4gICAgcmV0dXJuIE9iamVjdC5mcmVlemUobik7XG59XG52YXIgcnVudGltZV9fbmFtZXNwYWNlID0gLyojX19QVVJFX18qLyBfaW50ZXJvcE5hbWVzcGFjZURlZmF1bHQocnVudGltZSk7XG5mdW5jdGlvbiBhdHRhY2hTaGFyZVNjb3BlTWFwKHdlYnBhY2tSZXF1aXJlKSB7XG4gICAgaWYgKCF3ZWJwYWNrUmVxdWlyZS5TIHx8IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaGFzQXR0YWNoU2hhcmVTY29wZU1hcCB8fCAhd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZSB8fCAhd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZS5zaGFyZVNjb3BlTWFwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgd2VicGFja1JlcXVpcmUuUyA9IHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uaW5zdGFuY2Uuc2hhcmVTY29wZU1hcDtcbiAgICB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmhhc0F0dGFjaFNoYXJlU2NvcGVNYXAgPSB0cnVlO1xufVxudmFyIE5hbWVUcmFuc2Zvcm1TeW1ib2wgPSB7XG4gICAgQVQ6ICdAJyxcbiAgICBIWVBIRU46ICctJyxcbiAgICBTTEFTSDogJy8nXG59O1xudmFyIE5hbWVUcmFuc2Zvcm1NYXAgPSB7XG4gICAgW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdOiAnc2NvcGVfJyxcbiAgICBbTmFtZVRyYW5zZm9ybVN5bWJvbC5IWVBIRU5dOiAnXycsXG4gICAgW05hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hdOiAnX18nXG59O1xudmFyIEVuY29kZWROYW1lVHJhbnNmb3JtTWFwID0ge1xuICAgIFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdXTogTmFtZVRyYW5zZm9ybVN5bWJvbC5BVCxcbiAgICBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTl1dOiBOYW1lVHJhbnNmb3JtU3ltYm9sLkhZUEhFTixcbiAgICBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXV06IE5hbWVUcmFuc2Zvcm1TeW1ib2wuU0xBU0hcbn07XG52YXIgRU5DT0RFX05BTUVfUFJFRklYID0gJ0VOQ09ERV9OQU1FX1BSRUZJWCc7XG52YXIgZGVjb2RlTmFtZSA9IGZ1bmN0aW9uKG5hbWUsIHByZWZpeCwgd2l0aEV4dCkge1xuICAgIHRyeSB7XG4gICAgICAgIHZhciBkZWNvZGVkTmFtZSA9IG5hbWU7XG4gICAgICAgIGlmIChwcmVmaXgpIHtcbiAgICAgICAgICAgIGlmICghZGVjb2RlZE5hbWUuc3RhcnRzV2l0aChwcmVmaXgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlY29kZWROYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVjb2RlZE5hbWUgPSBkZWNvZGVkTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAocHJlZml4LCAnZycpLCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgZGVjb2RlZE5hbWUgPSBkZWNvZGVkTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoYCR7TmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLkFUXX1gLCAnZycpLCBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuQVRdXSkucmVwbGFjZShuZXcgUmVnRXhwKGAke05hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybVN5bWJvbC5TTEFTSF19YCwgJ2cnKSwgRW5jb2RlZE5hbWVUcmFuc2Zvcm1NYXBbTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtU3ltYm9sLlNMQVNIXV0pLnJlcGxhY2UobmV3IFJlZ0V4cChgJHtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXX1gLCAnZycpLCBFbmNvZGVkTmFtZVRyYW5zZm9ybU1hcFtOYW1lVHJhbnNmb3JtTWFwW05hbWVUcmFuc2Zvcm1TeW1ib2wuSFlQSEVOXV0pO1xuICAgICAgICBpZiAod2l0aEV4dCkgO1xuICAgICAgICByZXR1cm4gZGVjb2RlZE5hbWU7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICB9XG59O1xuZnVuY3Rpb24gcmVtb3RlcyhvcHRpb25zKSB7XG4gICAgdmFyIGNodW5rSWQgPSBvcHRpb25zLmNodW5rSWQsIHByb21pc2VzID0gb3B0aW9ucy5wcm9taXNlcywgY2h1bmtNYXBwaW5nID0gb3B0aW9ucy5jaHVua01hcHBpbmcsIGlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nID0gb3B0aW9ucy5pZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZywgd2VicGFja1JlcXVpcmUgPSBvcHRpb25zLndlYnBhY2tSZXF1aXJlLCBpZFRvUmVtb3RlTWFwID0gb3B0aW9ucy5pZFRvUmVtb3RlTWFwO1xuICAgIGF0dGFjaFNoYXJlU2NvcGVNYXAod2VicGFja1JlcXVpcmUpO1xuICAgIGlmICh3ZWJwYWNrUmVxdWlyZS5vKGNodW5rTWFwcGluZywgY2h1bmtJZCkpIHtcbiAgICAgICAgY2h1bmtNYXBwaW5nW2NodW5rSWRdLmZvckVhY2goKGlkKT0+e1xuICAgICAgICAgICAgdmFyIGdldFNjb3BlID0gd2VicGFja1JlcXVpcmUuUjtcbiAgICAgICAgICAgIGlmICghZ2V0U2NvcGUpIHtcbiAgICAgICAgICAgICAgICBnZXRTY29wZSA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRhdGEgPSBpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1tpZF07XG4gICAgICAgICAgICB2YXIgcmVtb3RlSW5mb3MgPSBpZFRvUmVtb3RlTWFwW2lkXTtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgc2VlbXMgbm90IHdvcmtcbiAgICAgICAgICAgIGlmIChnZXRTY29wZS5pbmRleE9mKGRhdGEpID49IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIHNlZW1zIG5vdCB3b3JrXG4gICAgICAgICAgICBnZXRTY29wZS5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgaWYgKGRhdGEucCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlcy5wdXNoKGRhdGEucCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb25FcnJvciA9IChlcnJvcik9PntcbiAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yID0gbmV3IEVycm9yKCdDb250YWluZXIgbWlzc2luZycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVycm9yLm1lc3NhZ2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UgKz0gYFxcbndoaWxlIGxvYWRpbmcgXCIke2RhdGFbMV19XCIgZnJvbSAke2RhdGFbMl19YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgd2VicGFja1JlcXVpcmUubVtpZF0gPSAoKT0+e1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGRhdGEucCA9IDA7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGhhbmRsZUZ1bmN0aW9uID0gKGZuLCBhcmcxLCBhcmcyLCBkLCBuZXh0LCBmaXJzdCk9PntcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGZuKGFyZzEsIGFyZzIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvbWlzZSAmJiBwcm9taXNlLnRoZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gcHJvbWlzZS50aGVuKChyZXN1bHQpPT5uZXh0KHJlc3VsdCwgZCksIG9uRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChkYXRhLnAgPSBwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dChwcm9taXNlLCBkLCBmaXJzdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIG9uRXh0ZXJuYWwgPSAoZXh0ZXJuYWwsIF8sIGZpcnN0KT0+ZXh0ZXJuYWwgPyBoYW5kbGVGdW5jdGlvbih3ZWJwYWNrUmVxdWlyZS5JLCBkYXRhWzBdLCAwLCBleHRlcm5hbCwgb25Jbml0aWFsaXplZCwgZmlyc3QpIDogb25FcnJvcigpO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXZhclxuICAgICAgICAgICAgdmFyIG9uSW5pdGlhbGl6ZWQgPSAoXywgZXh0ZXJuYWwsIGZpcnN0KT0+aGFuZGxlRnVuY3Rpb24oZXh0ZXJuYWwuZ2V0LCBkYXRhWzFdLCBnZXRTY29wZSwgMCwgb25GYWN0b3J5LCBmaXJzdCk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdmFyXG4gICAgICAgICAgICB2YXIgb25GYWN0b3J5ID0gKGZhY3RvcnkpPT57XG4gICAgICAgICAgICAgICAgZGF0YS5wID0gMTtcbiAgICAgICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZS5tW2lkXSA9IChtb2R1bGUxKT0+e1xuICAgICAgICAgICAgICAgICAgICBtb2R1bGUxLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgb25SZW1vdGVMb2FkZWQgPSAoKT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVOYW1lID0gZGVjb2RlTmFtZShyZW1vdGVJbmZvc1swXS5uYW1lLCBFTkNPREVfTkFNRV9QUkVGSVgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlTW9kdWxlTmFtZSA9IHJlbW90ZU5hbWUgKyBkYXRhWzFdLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZFJlbW90ZSA9ICgpPT53ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlLmxvYWRSZW1vdGUocmVtb3RlTW9kdWxlTmFtZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRGYWN0b3J5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiAnYnVpbGQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLm9wdGlvbnMuc2hhcmVTdHJhdGVneSA9PT0gJ3ZlcnNpb24tZmlyc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoaW5zdGFuY2Uuc2hhcmVkSGFuZGxlci5pbml0aWFsaXplU2hhcmluZyhkYXRhWzBdKSkudGhlbigoKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2FkUmVtb3RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9hZFJlbW90ZSgpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgdXNlUnVudGltZUxvYWQgPSByZW1vdGVJbmZvcy5sZW5ndGggPT09IDEgJiYgY29uc3RhbnQuRkVERVJBVElPTl9TVVBQT1JURURfVFlQRVMuaW5jbHVkZXMocmVtb3RlSW5mb3NbMF0uZXh0ZXJuYWxUeXBlKSAmJiByZW1vdGVJbmZvc1swXS5uYW1lO1xuICAgICAgICAgICAgaWYgKHVzZVJ1bnRpbWVMb2FkKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlRnVuY3Rpb24ob25SZW1vdGVMb2FkZWQsIGRhdGFbMl0sIDAsIDAsIG9uRmFjdG9yeSwgMSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGhhbmRsZUZ1bmN0aW9uKHdlYnBhY2tSZXF1aXJlLCBkYXRhWzJdLCAwLCAwLCBvbkV4dGVybmFsLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY29uc3VtZXMob3B0aW9ucykge1xuICAgIHZhciBjaHVua0lkID0gb3B0aW9ucy5jaHVua0lkLCBwcm9taXNlcyA9IG9wdGlvbnMucHJvbWlzZXMsIGNodW5rTWFwcGluZyA9IG9wdGlvbnMuY2h1bmtNYXBwaW5nLCBpbnN0YWxsZWRNb2R1bGVzID0gb3B0aW9ucy5pbnN0YWxsZWRNb2R1bGVzLCBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nID0gb3B0aW9ucy5tb2R1bGVUb0hhbmRsZXJNYXBwaW5nLCB3ZWJwYWNrUmVxdWlyZSA9IG9wdGlvbnMud2VicGFja1JlcXVpcmU7XG4gICAgYXR0YWNoU2hhcmVTY29wZU1hcCh3ZWJwYWNrUmVxdWlyZSk7XG4gICAgaWYgKHdlYnBhY2tSZXF1aXJlLm8oY2h1bmtNYXBwaW5nLCBjaHVua0lkKSkge1xuICAgICAgICBjaHVua01hcHBpbmdbY2h1bmtJZF0uZm9yRWFjaCgoaWQpPT57XG4gICAgICAgICAgICBpZiAod2VicGFja1JlcXVpcmUubyhpbnN0YWxsZWRNb2R1bGVzLCBpZCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZXMucHVzaChpbnN0YWxsZWRNb2R1bGVzW2lkXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb25GYWN0b3J5ID0gKGZhY3RvcnkpPT57XG4gICAgICAgICAgICAgICAgaW5zdGFsbGVkTW9kdWxlc1tpZF0gPSAwO1xuICAgICAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlLm1baWRdID0gKG1vZHVsZTEpPT57XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3ZWJwYWNrUmVxdWlyZS5jW2lkXTtcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlMS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIG9uRXJyb3IgPSAoZXJyb3IpPT57XG4gICAgICAgICAgICAgICAgZGVsZXRlIGluc3RhbGxlZE1vZHVsZXNbaWRdO1xuICAgICAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlLm1baWRdID0gKG1vZHVsZTEpPT57XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3ZWJwYWNrUmVxdWlyZS5jW2lkXTtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBmZWRlcmF0aW9uSW5zdGFuY2UgPSB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlO1xuICAgICAgICAgICAgICAgIGlmICghZmVkZXJhdGlvbkluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmVkZXJhdGlvbiBpbnN0YW5jZSBub3QgZm91bmQhJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBfbW9kdWxlVG9IYW5kbGVyTWFwcGluZ19pZCA9IG1vZHVsZVRvSGFuZGxlck1hcHBpbmdbaWRdLCBzaGFyZUtleSA9IF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX2lkLnNoYXJlS2V5LCBnZXR0ZXIgPSBfbW9kdWxlVG9IYW5kbGVyTWFwcGluZ19pZC5nZXR0ZXIsIHNoYXJlSW5mbyA9IF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX2lkLnNoYXJlSW5mbztcbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGZlZGVyYXRpb25JbnN0YW5jZS5sb2FkU2hhcmUoc2hhcmVLZXksIHtcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tU2hhcmVJbmZvOiBzaGFyZUluZm9cbiAgICAgICAgICAgICAgICB9KS50aGVuKChmYWN0b3J5KT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmFjdG9yeSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXR0ZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFjdG9yeTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAocHJvbWlzZS50aGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goaW5zdGFsbGVkTW9kdWxlc1tpZF0gPSBwcm9taXNlLnRoZW4ob25GYWN0b3J5KS5jYXRjaChvbkVycm9yKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSBtYWludGFpbiBwcmV2aW91cyBsb2dpY1xuICAgICAgICAgICAgICAgICAgICBvbkZhY3RvcnkocHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGluaXRpYWxpemVTaGFyaW5nKHJlZikge1xuICAgIHZhciBzaGFyZVNjb3BlTmFtZSA9IHJlZi5zaGFyZVNjb3BlTmFtZSwgd2VicGFja1JlcXVpcmUgPSByZWYud2VicGFja1JlcXVpcmUsIGluaXRQcm9taXNlcyA9IHJlZi5pbml0UHJvbWlzZXMsIGluaXRUb2tlbnMgPSByZWYuaW5pdFRva2VucywgaW5pdFNjb3BlID0gcmVmLmluaXRTY29wZTtcbiAgICBpZiAoIWluaXRTY29wZSkgaW5pdFNjb3BlID0gW107XG4gICAgdmFyIG1mSW5zdGFuY2UgPSB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlO1xuICAgIC8vIGhhbmRsaW5nIGNpcmN1bGFyIGluaXQgY2FsbHNcbiAgICB2YXIgaW5pdFRva2VuID0gaW5pdFRva2Vuc1tzaGFyZVNjb3BlTmFtZV07XG4gICAgaWYgKCFpbml0VG9rZW4pIGluaXRUb2tlbiA9IGluaXRUb2tlbnNbc2hhcmVTY29wZU5hbWVdID0ge1xuICAgICAgICBmcm9tOiBtZkluc3RhbmNlLm5hbWVcbiAgICB9O1xuICAgIGlmIChpbml0U2NvcGUuaW5kZXhPZihpbml0VG9rZW4pID49IDApIHJldHVybjtcbiAgICBpbml0U2NvcGUucHVzaChpbml0VG9rZW4pO1xuICAgIHZhciBwcm9taXNlID0gaW5pdFByb21pc2VzW3NoYXJlU2NvcGVOYW1lXTtcbiAgICBpZiAocHJvbWlzZSkgcmV0dXJuIHByb21pc2U7XG4gICAgdmFyIHdhcm4gPSAobXNnKT0+dHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUud2FybiAmJiBjb25zb2xlLndhcm4obXNnKTtcbiAgICB2YXIgaW5pdEV4dGVybmFsID0gKGlkKT0+e1xuICAgICAgICB2YXIgaGFuZGxlRXJyb3IgPSAoZXJyKT0+d2FybignSW5pdGlhbGl6YXRpb24gb2Ygc2hhcmluZyBleHRlcm5hbCBmYWlsZWQ6ICcgKyBlcnIpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIF8kbW9kdWxlID0gd2VicGFja1JlcXVpcmUoaWQpO1xuICAgICAgICAgICAgaWYgKCFfJG1vZHVsZSkgcmV0dXJuO1xuICAgICAgICAgICAgdmFyIGluaXRGbiA9IChtb2R1bGUxKT0+bW9kdWxlMSAmJiBtb2R1bGUxLmluaXQgJiYgLy8gQHRzLWlnbm9yZSBjb21wYXQgbGVnYWN5IG1mIHNoYXJlZCBiZWhhdmlvclxuICAgICAgICAgICAgICAgIG1vZHVsZTEuaW5pdCh3ZWJwYWNrUmVxdWlyZS5TW3NoYXJlU2NvcGVOYW1lXSwgaW5pdFNjb3BlKTtcbiAgICAgICAgICAgIGlmIChfJG1vZHVsZS50aGVuKSByZXR1cm4gcHJvbWlzZXMucHVzaChfJG1vZHVsZS50aGVuKGluaXRGbiwgaGFuZGxlRXJyb3IpKTtcbiAgICAgICAgICAgIHZhciBpbml0UmVzdWx0ID0gaW5pdEZuKF8kbW9kdWxlKTtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGlmIChpbml0UmVzdWx0ICYmIHR5cGVvZiBpbml0UmVzdWx0ICE9PSAnYm9vbGVhbicgJiYgaW5pdFJlc3VsdC50aGVuKSAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZXMucHVzaChpbml0UmVzdWx0WydjYXRjaCddKGhhbmRsZUVycm9yKSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgaGFuZGxlRXJyb3IoZXJyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmFyIHByb21pc2VzID0gbWZJbnN0YW5jZS5pbml0aWFsaXplU2hhcmluZyhzaGFyZVNjb3BlTmFtZSwge1xuICAgICAgICBzdHJhdGVneTogbWZJbnN0YW5jZS5vcHRpb25zLnNoYXJlU3RyYXRlZ3ksXG4gICAgICAgIGluaXRTY29wZSxcbiAgICAgICAgZnJvbTogJ2J1aWxkJ1xuICAgIH0pO1xuICAgIGF0dGFjaFNoYXJlU2NvcGVNYXAod2VicGFja1JlcXVpcmUpO1xuICAgIHZhciBidW5kbGVyUnVudGltZVJlbW90ZXNPcHRpb25zID0gd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcztcbiAgICBpZiAoYnVuZGxlclJ1bnRpbWVSZW1vdGVzT3B0aW9ucykge1xuICAgICAgICBPYmplY3Qua2V5cyhidW5kbGVyUnVudGltZVJlbW90ZXNPcHRpb25zLmlkVG9SZW1vdGVNYXApLmZvckVhY2goKG1vZHVsZUlkKT0+e1xuICAgICAgICAgICAgdmFyIGluZm8gPSBidW5kbGVyUnVudGltZVJlbW90ZXNPcHRpb25zLmlkVG9SZW1vdGVNYXBbbW9kdWxlSWRdO1xuICAgICAgICAgICAgdmFyIGV4dGVybmFsTW9kdWxlSWQgPSBidW5kbGVyUnVudGltZVJlbW90ZXNPcHRpb25zLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nW21vZHVsZUlkXVsyXTtcbiAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBpbml0RXh0ZXJuYWwoZXh0ZXJuYWxNb2R1bGVJZCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZUluZm8gPSBpbmZvWzBdO1xuICAgICAgICAgICAgICAgIGlmICghY29uc3RhbnQuRkVERVJBVElPTl9TVVBQT1JURURfVFlQRVMuaW5jbHVkZXMocmVtb3RlSW5mby5leHRlcm5hbFR5cGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGluaXRFeHRlcm5hbChleHRlcm5hbE1vZHVsZUlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIXByb21pc2VzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gaW5pdFByb21pc2VzW3NoYXJlU2NvcGVOYW1lXSA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBpbml0UHJvbWlzZXNbc2hhcmVTY29wZU5hbWVdID0gUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oKCk9PmluaXRQcm9taXNlc1tzaGFyZVNjb3BlTmFtZV0gPSB0cnVlKTtcbn1cbmZ1bmN0aW9uIGhhbmRsZUluaXRpYWxDb25zdW1lcyhvcHRpb25zKSB7XG4gICAgdmFyIG1vZHVsZUlkID0gb3B0aW9ucy5tb2R1bGVJZCwgbW9kdWxlVG9IYW5kbGVyTWFwcGluZyA9IG9wdGlvbnMubW9kdWxlVG9IYW5kbGVyTWFwcGluZywgd2VicGFja1JlcXVpcmUgPSBvcHRpb25zLndlYnBhY2tSZXF1aXJlO1xuICAgIHZhciBmZWRlcmF0aW9uSW5zdGFuY2UgPSB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlO1xuICAgIGlmICghZmVkZXJhdGlvbkluc3RhbmNlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmVkZXJhdGlvbiBpbnN0YW5jZSBub3QgZm91bmQhJyk7XG4gICAgfVxuICAgIHZhciBfbW9kdWxlVG9IYW5kbGVyTWFwcGluZ19tb2R1bGVJZCA9IG1vZHVsZVRvSGFuZGxlck1hcHBpbmdbbW9kdWxlSWRdLCBzaGFyZUtleSA9IF9tb2R1bGVUb0hhbmRsZXJNYXBwaW5nX21vZHVsZUlkLnNoYXJlS2V5LCBzaGFyZUluZm8gPSBfbW9kdWxlVG9IYW5kbGVyTWFwcGluZ19tb2R1bGVJZC5zaGFyZUluZm87XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGZlZGVyYXRpb25JbnN0YW5jZS5sb2FkU2hhcmVTeW5jKHNoYXJlS2V5LCB7XG4gICAgICAgICAgICBjdXN0b21TaGFyZUluZm86IHNoYXJlSW5mb1xuICAgICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignbG9hZFNoYXJlU3luYyBmYWlsZWQhIFRoZSBmdW5jdGlvbiBzaG91bGQgbm90IGJlIGNhbGxlZCB1bmxlc3MgeW91IHNldCBcImVhZ2VyOnRydWVcIi4gSWYgeW91IGRvIG5vdCBzZXQgaXQsIGFuZCBlbmNvdW50ZXIgdGhpcyBpc3N1ZSwgeW91IGNhbiBjaGVjayB3aGV0aGVyIGFuIGFzeW5jIGJvdW5kYXJ5IGlzIGltcGxlbWVudGVkLicpO1xuICAgICAgICBjb25zb2xlLmVycm9yKCdUaGUgb3JpZ2luYWwgZXJyb3IgbWVzc2FnZSBpcyBhcyBmb2xsb3dzOiAnKTtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGluc3RhbGxJbml0aWFsQ29uc3VtZXMob3B0aW9ucykge1xuICAgIHZhciBtb2R1bGVUb0hhbmRsZXJNYXBwaW5nID0gb3B0aW9ucy5tb2R1bGVUb0hhbmRsZXJNYXBwaW5nLCB3ZWJwYWNrUmVxdWlyZSA9IG9wdGlvbnMud2VicGFja1JlcXVpcmUsIGluc3RhbGxlZE1vZHVsZXMgPSBvcHRpb25zLmluc3RhbGxlZE1vZHVsZXMsIGluaXRpYWxDb25zdW1lcyA9IG9wdGlvbnMuaW5pdGlhbENvbnN1bWVzO1xuICAgIGluaXRpYWxDb25zdW1lcy5mb3JFYWNoKChpZCk9PntcbiAgICAgICAgd2VicGFja1JlcXVpcmUubVtpZF0gPSAobW9kdWxlMSk9PntcbiAgICAgICAgICAgIC8vIEhhbmRsZSBzY2VuYXJpbyB3aGVuIG1vZHVsZSBpcyB1c2VkIHN5bmNocm9ub3VzbHlcbiAgICAgICAgICAgIGluc3RhbGxlZE1vZHVsZXNbaWRdID0gMDtcbiAgICAgICAgICAgIGRlbGV0ZSB3ZWJwYWNrUmVxdWlyZS5jW2lkXTtcbiAgICAgICAgICAgIHZhciBmYWN0b3J5ID0gaGFuZGxlSW5pdGlhbENvbnN1bWVzKHtcbiAgICAgICAgICAgICAgICBtb2R1bGVJZDogaWQsXG4gICAgICAgICAgICAgICAgbW9kdWxlVG9IYW5kbGVyTWFwcGluZyxcbiAgICAgICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGZhY3RvcnkgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNoYXJlZCBtb2R1bGUgaXMgbm90IGF2YWlsYWJsZSBmb3IgZWFnZXIgY29uc3VtcHRpb246ICR7aWR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtb2R1bGUxLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG4gICAgICAgIH07XG4gICAgfSk7XG59XG5mdW5jdGlvbiBpbml0Q29udGFpbmVyRW50cnkob3B0aW9ucykge1xuICAgIHZhciB3ZWJwYWNrUmVxdWlyZSA9IG9wdGlvbnMud2VicGFja1JlcXVpcmUsIHNoYXJlU2NvcGUgPSBvcHRpb25zLnNoYXJlU2NvcGUsIGluaXRTY29wZSA9IG9wdGlvbnMuaW5pdFNjb3BlLCBzaGFyZVNjb3BlS2V5ID0gb3B0aW9ucy5zaGFyZVNjb3BlS2V5LCByZW1vdGVFbnRyeUluaXRPcHRpb25zID0gb3B0aW9ucy5yZW1vdGVFbnRyeUluaXRPcHRpb25zO1xuICAgIGlmICghd2VicGFja1JlcXVpcmUuUykgcmV0dXJuO1xuICAgIGlmICghd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbiB8fCAhd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbnN0YW5jZSB8fCAhd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5pbml0T3B0aW9ucykgcmV0dXJuO1xuICAgIHZhciBmZWRlcmF0aW9uSW5zdGFuY2UgPSB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluc3RhbmNlO1xuICAgIHZhciBuYW1lID0gc2hhcmVTY29wZUtleSB8fCAnZGVmYXVsdCc7XG4gICAgZmVkZXJhdGlvbkluc3RhbmNlLmluaXRPcHRpb25zKF9vYmplY3Rfc3ByZWFkLl8oe1xuICAgICAgICBuYW1lOiB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmluaXRPcHRpb25zLm5hbWUsXG4gICAgICAgIHJlbW90ZXM6IFtdXG4gICAgfSwgcmVtb3RlRW50cnlJbml0T3B0aW9ucykpO1xuICAgIGZlZGVyYXRpb25JbnN0YW5jZS5pbml0U2hhcmVTY29wZU1hcChuYW1lLCBzaGFyZVNjb3BlLCB7XG4gICAgICAgIGhvc3RTaGFyZVNjb3BlTWFwOiAocmVtb3RlRW50cnlJbml0T3B0aW9ucyA9PT0gbnVsbCB8fCByZW1vdGVFbnRyeUluaXRPcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZW1vdGVFbnRyeUluaXRPcHRpb25zLnNoYXJlU2NvcGVNYXApIHx8IHt9XG4gICAgfSk7XG4gICAgaWYgKHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCkge1xuICAgICAgICB3ZWJwYWNrUmVxdWlyZS5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAod2VicGFja1JlcXVpcmUpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHdlYnBhY2tSZXF1aXJlLmZlZGVyYXRpb24ucHJlZmV0Y2ggPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgd2VicGFja1JlcXVpcmUuZmVkZXJhdGlvbi5wcmVmZXRjaCgpO1xuICAgIH1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgcmV0dXJuIHdlYnBhY2tSZXF1aXJlLkkobmFtZSwgaW5pdFNjb3BlKTtcbn1cbnZhciBmZWRlcmF0aW9uID0ge1xuICAgIHJ1bnRpbWU6IHJ1bnRpbWVfX25hbWVzcGFjZSxcbiAgICBpbnN0YW5jZTogdW5kZWZpbmVkLFxuICAgIGluaXRPcHRpb25zOiB1bmRlZmluZWQsXG4gICAgYnVuZGxlclJ1bnRpbWU6IHtcbiAgICAgICAgcmVtb3RlcyxcbiAgICAgICAgY29uc3VtZXMsXG4gICAgICAgIEk6IGluaXRpYWxpemVTaGFyaW5nLFxuICAgICAgICBTOiB7fSxcbiAgICAgICAgaW5zdGFsbEluaXRpYWxDb25zdW1lcyxcbiAgICAgICAgaW5pdENvbnRhaW5lckVudHJ5XG4gICAgfSxcbiAgICBhdHRhY2hTaGFyZVNjb3BlTWFwLFxuICAgIGJ1bmRsZXJSdW50aW1lT3B0aW9uczoge31cbn07XG5tb2R1bGUuZXhwb3J0cyA9IGZlZGVyYXRpb247XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X2xpa2VfdG9fYXJyYXkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV9saWtlX3RvX2FycmF5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfYXJyYXlfbGlrZV90b19hcnJheShhcnIsIGxlbikge1xuICAgIGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoO1xuICAgIGZvcih2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKWFycjJbaV0gPSBhcnJbaV07XG4gICAgcmV0dXJuIGFycjI7XG59XG5leHBvcnRzLl8gPSBfYXJyYXlfbGlrZV90b19hcnJheTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aF9ob2xlcy5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhfaG9sZXMuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9hcnJheV93aXRoX2hvbGVzKGFycikge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7XG59XG5leHBvcnRzLl8gPSBfYXJyYXlfd2l0aF9ob2xlcztcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfd2l0aG91dF9ob2xlcy5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FycmF5X3dpdGhvdXRfaG9sZXMuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfYXJyYXlfbGlrZV90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2FycmF5X2xpa2VfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfbGlrZV90b19hcnJheS5janNcIik7XG5mdW5jdGlvbiBfYXJyYXlfd2l0aG91dF9ob2xlcyhhcnIpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gX2FycmF5X2xpa2VfdG9fYXJyYXkuXyhhcnIpO1xufVxuZXhwb3J0cy5fID0gX2FycmF5X3dpdGhvdXRfaG9sZXM7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2Fzc2VydF90aGlzX2luaXRpYWxpemVkLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2Fzc2VydF90aGlzX2luaXRpYWxpemVkLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2Fzc2VydF90aGlzX2luaXRpYWxpemVkKHNlbGYpIHtcbiAgICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7XG4gICAgcmV0dXJuIHNlbGY7XG59XG5leHBvcnRzLl8gPSBfYXNzZXJ0X3RoaXNfaW5pdGlhbGl6ZWQ7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2FzeW5jX3RvX2dlbmVyYXRvci5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXN5bmNfdG9fZ2VuZXJhdG9yLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHtcbiAgICB0cnkge1xuICAgICAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7XG4gICAgICAgIHZhciB2YWx1ZSA9IGluZm8udmFsdWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoaW5mby5kb25lKSByZXNvbHZlKHZhbHVlKTtcbiAgICBlbHNlIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTtcbn1cbmZ1bmN0aW9uIF9hc3luY190b19nZW5lcmF0b3IoZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpO1xuICAgICAgICAgICAgZnVuY3Rpb24gX25leHQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIFwibmV4dFwiLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7XG4gICAgICAgICAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBcInRocm93XCIsIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfbmV4dCh1bmRlZmluZWQpO1xuICAgICAgICB9KTtcbiAgICB9O1xufVxuZXhwb3J0cy5fID0gX2FzeW5jX3RvX2dlbmVyYXRvcjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2FsbF9zdXBlci5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2NhbGxfc3VwZXIuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfZ2V0X3Byb3RvdHlwZV9vZiA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2dldF9wcm90b3R5cGVfb2YuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZ2V0X3Byb3RvdHlwZV9vZi5janNcIik7XG52YXIgX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdC5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QuY2pzXCIpO1xudmFyIF9wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4uY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuLmNqc1wiKTtcbmZ1bmN0aW9uIF9jYWxsX3N1cGVyKF90aGlzLCBkZXJpdmVkLCBhcmdzKSB7XG4gICAgLy8gU3VwZXJcbiAgICBkZXJpdmVkID0gX2dldF9wcm90b3R5cGVfb2YuXyhkZXJpdmVkKTtcbiAgICByZXR1cm4gX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybi5fKF90aGlzLCBfaXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0Ll8oKSA/IFJlZmxlY3QuY29uc3RydWN0KGRlcml2ZWQsIGFyZ3MgfHwgW10sIF9nZXRfcHJvdG90eXBlX29mLl8oX3RoaXMpLmNvbnN0cnVjdG9yKSA6IGRlcml2ZWQuYXBwbHkoX3RoaXMsIGFyZ3MpKTtcbn1cbmV4cG9ydHMuXyA9IF9jYWxsX3N1cGVyO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jbGFzc19jYWxsX2NoZWNrLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY2xhc3NfY2FsbF9jaGVjay5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2NsYXNzX2NhbGxfY2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gICAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XG59XG5leHBvcnRzLl8gPSBfY2xhc3NfY2FsbF9jaGVjaztcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fY3JlYXRlX2NsYXNzLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19jcmVhdGVfY2xhc3MuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykge1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07XG4gICAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTtcbiAgICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgICAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7XG4gICAgfVxufVxuZnVuY3Rpb24gX2NyZWF0ZV9jbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHtcbiAgICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTtcbiAgICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7XG4gICAgcmV0dXJuIENvbnN0cnVjdG9yO1xufVxuZXhwb3J0cy5fID0gX2NyZWF0ZV9jbGFzcztcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZGVmaW5lX3Byb3BlcnR5LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19kZWZpbmVfcHJvcGVydHkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2RlZmluZV9wcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHtcbiAgICBpZiAoa2V5IGluIG9iaikge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Ugb2JqW2tleV0gPSB2YWx1ZTtcbiAgICByZXR1cm4gb2JqO1xufVxuZXhwb3J0cy5fID0gX2RlZmluZV9wcm9wZXJ0eTtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZXhwb3J0X3N0YXIuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fZXhwb3J0X3N0YXIuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfZXhwb3J0X3N0YXIoZnJvbSwgdG8pIHtcbiAgICBPYmplY3Qua2V5cyhmcm9tKS5mb3JFYWNoKGZ1bmN0aW9uKGspIHtcbiAgICAgICAgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodG8sIGspKSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodG8sIGssIHtcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmcm9tW2tdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGZyb207XG59XG5leHBvcnRzLl8gPSBfZXhwb3J0X3N0YXI7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2dldF9wcm90b3R5cGVfb2YuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19nZXRfcHJvdG90eXBlX29mLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfZ2V0X3Byb3RvdHlwZV9vZihvKSB7XG4gICAgZXhwb3J0cy5fID0gX2dldF9wcm90b3R5cGVfb2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZihvKSB7XG4gICAgICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7XG4gICAgfTtcbiAgICByZXR1cm4gX2dldF9wcm90b3R5cGVfb2Yobyk7XG59XG5leHBvcnRzLl8gPSBfZ2V0X3Byb3RvdHlwZV9vZjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW5oZXJpdHMuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW5oZXJpdHMuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX3NldF9wcm90b3R5cGVfb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19zZXRfcHJvdG90eXBlX29mLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NldF9wcm90b3R5cGVfb2YuY2pzXCIpO1xuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7XG4gICAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwge1xuICAgICAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgICAgICAgdmFsdWU6IHN1YkNsYXNzLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChzdXBlckNsYXNzKSBfc2V0X3Byb3RvdHlwZV9vZi5fKHN1YkNsYXNzLCBzdXBlckNsYXNzKTtcbn1cbmV4cG9ydHMuXyA9IF9pbmhlcml0cztcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQob2JqKSB7XG4gICAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHtcbiAgICAgICAgZGVmYXVsdDogb2JqXG4gICAgfTtcbn1cbmV4cG9ydHMuXyA9IF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pc19uYXRpdmVfcmVmbGVjdF9jb25zdHJ1Y3QuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdCgpIHtcbiAgICAvLyBTaW5jZSBSZWZsZWN0LmNvbnN0cnVjdCBjYW4ndCBiZSBwcm9wZXJseSBwb2x5ZmlsbGVkLCBzb21lXG4gICAgLy8gaW1wbGVtZW50YXRpb25zIChlLmcuIGNvcmUtanNAMikgZG9uJ3Qgc2V0IHRoZSBjb3JyZWN0IGludGVybmFsIHNsb3RzLlxuICAgIC8vIFRob3NlIHBvbHlmaWxscyBkb24ndCBhbGxvdyB1cyB0byBzdWJjbGFzcyBidWlsdC1pbnMsIHNvIHdlIG5lZWQgdG9cbiAgICAvLyB1c2Ugb3VyIGZhbGxiYWNrIGltcGxlbWVudGF0aW9uLlxuICAgIHRyeSB7XG4gICAgICAgIC8vIElmIHRoZSBpbnRlcm5hbCBzbG90cyBhcmVuJ3Qgc2V0LCB0aGlzIHRocm93cyBhbiBlcnJvciBzaW1pbGFyIHRvXG4gICAgICAgIC8vICAgVHlwZUVycm9yOiB0aGlzIGlzIG5vdCBhIEJvb2xlYW4gb2JqZWN0LlxuICAgICAgICB2YXIgcmVzdWx0ID0gIUJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24oKSB7fSkpO1xuICAgIH0gY2F0Y2ggKF8pIHt9XG4gICAgcmV0dXJuIChleHBvcnRzLl8gPSBfaXNfbmF0aXZlX3JlZmxlY3RfY29uc3RydWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAhIXJlc3VsdDtcbiAgICB9KSgpO1xufVxuZXhwb3J0cy5fID0gX2lzX25hdGl2ZV9yZWZsZWN0X2NvbnN0cnVjdDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXkuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9faXRlcmFibGVfdG9fYXJyYXkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfaXRlcmFibGVfdG9fYXJyYXkoaXRlcikge1xuICAgIGlmICh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGl0ZXJbU3ltYm9sLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbXCJAQGl0ZXJhdG9yXCJdICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7XG4gICAgfVxufVxuZXhwb3J0cy5fID0gX2l0ZXJhYmxlX3RvX2FycmF5O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pdGVyYWJsZV90b19hcnJheV9saW1pdC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pdGVyYWJsZV90b19hcnJheV9saW1pdC5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9pdGVyYWJsZV90b19hcnJheV9saW1pdChhcnIsIGkpIHtcbiAgICB2YXIgX2kgPSBhcnIgPT0gbnVsbCA/IG51bGwgOiB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGFycltTeW1ib2wuaXRlcmF0b3JdIHx8IGFycltcIkBAaXRlcmF0b3JcIl07XG4gICAgaWYgKF9pID09IG51bGwpIHJldHVybjtcbiAgICB2YXIgX2FyciA9IFtdO1xuICAgIHZhciBfbiA9IHRydWU7XG4gICAgdmFyIF9kID0gZmFsc2U7XG4gICAgdmFyIF9zLCBfZTtcbiAgICB0cnkge1xuICAgICAgICBmb3IoX2kgPSBfaS5jYWxsKGFycik7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpe1xuICAgICAgICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTtcbiAgICAgICAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhaztcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBfZCA9IHRydWU7XG4gICAgICAgIF9lID0gZXJyO1xuICAgIH0gZmluYWxseXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghX24gJiYgX2lbXCJyZXR1cm5cIl0gIT0gbnVsbCkgX2lbXCJyZXR1cm5cIl0oKTtcbiAgICAgICAgfSBmaW5hbGx5e1xuICAgICAgICAgICAgaWYgKF9kKSB0aHJvdyBfZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gX2Fycjtcbn1cbmV4cG9ydHMuXyA9IF9pdGVyYWJsZV90b19hcnJheV9saW1pdDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fbm9uX2l0ZXJhYmxlX3Jlc3QuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fbm9uX2l0ZXJhYmxlX3Jlc3QuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpIHtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfbm9uX2l0ZXJhYmxlX3Jlc3QoKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcbn1cbmV4cG9ydHMuXyA9IF9ub25faXRlcmFibGVfcmVzdDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fbm9uX2l0ZXJhYmxlX3NwcmVhZC5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9zcHJlYWQuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9ub25faXRlcmFibGVfc3ByZWFkKCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xufVxuZXhwb3J0cy5fID0gX25vbl9pdGVyYWJsZV9zcHJlYWQ7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX29iamVjdF9zcHJlYWQuY2pzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19vYmplY3Rfc3ByZWFkLmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG52YXIgX2RlZmluZV9wcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2RlZmluZV9wcm9wZXJ0eS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19kZWZpbmVfcHJvcGVydHkuY2pzXCIpO1xuZnVuY3Rpb24gX29iamVjdF9zcHJlYWQodGFyZ2V0KSB7XG4gICAgZm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9O1xuICAgICAgICB2YXIgb3duS2V5cyA9IE9iamVjdC5rZXlzKHNvdXJjZSk7XG4gICAgICAgIGlmICh0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBvd25LZXlzID0gb3duS2V5cy5jb25jYXQoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzb3VyY2UpLmZpbHRlcihmdW5jdGlvbihzeW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIHN5bSkuZW51bWVyYWJsZTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBvd25LZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgICBfZGVmaW5lX3Byb3BlcnR5Ll8odGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5leHBvcnRzLl8gPSBfb2JqZWN0X3NwcmVhZDtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19wb3NzaWJsZV9jb25zdHJ1Y3Rvcl9yZXR1cm4uY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9hc3NlcnRfdGhpc19pbml0aWFsaXplZCA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2Fzc2VydF90aGlzX2luaXRpYWxpemVkLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX2Fzc2VydF90aGlzX2luaXRpYWxpemVkLmNqc1wiKTtcbnZhciBfdHlwZV9vZiA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3R5cGVfb2YuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdHlwZV9vZi5janNcIik7XG5mdW5jdGlvbiBfcG9zc2libGVfY29uc3RydWN0b3JfcmV0dXJuKHNlbGYsIGNhbGwpIHtcbiAgICBpZiAoY2FsbCAmJiAoX3R5cGVfb2YuXyhjYWxsKSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSkgcmV0dXJuIGNhbGw7XG4gICAgcmV0dXJuIF9hc3NlcnRfdGhpc19pbml0aWFsaXplZC5fKHNlbGYpO1xufVxuZXhwb3J0cy5fID0gX3Bvc3NpYmxlX2NvbnN0cnVjdG9yX3JldHVybjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2V0X3Byb3RvdHlwZV9vZi5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3NldF9wcm90b3R5cGVfb2YuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9zZXRfcHJvdG90eXBlX29mKG8sIHApIHtcbiAgICBleHBvcnRzLl8gPSBfc2V0X3Byb3RvdHlwZV9vZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihvLCBwKSB7XG4gICAgICAgIG8uX19wcm90b19fID0gcDtcbiAgICAgICAgcmV0dXJuIG87XG4gICAgfTtcbiAgICByZXR1cm4gX3NldF9wcm90b3R5cGVfb2YobywgcCk7XG59XG5leHBvcnRzLl8gPSBfc2V0X3Byb3RvdHlwZV9vZjtcblxuXG59KSxcblwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fc2xpY2VkX3RvX2FycmF5LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9hcnJheV93aXRoX2hvbGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fYXJyYXlfd2l0aF9ob2xlcy5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRoX2hvbGVzLmNqc1wiKTtcbnZhciBfaXRlcmFibGVfdG9fYXJyYXlfbGltaXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19pdGVyYWJsZV90b19hcnJheV9saW1pdC5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pdGVyYWJsZV90b19hcnJheV9saW1pdC5janNcIik7XG52YXIgX25vbl9pdGVyYWJsZV9yZXN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fbm9uX2l0ZXJhYmxlX3Jlc3QuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fbm9uX2l0ZXJhYmxlX3Jlc3QuY2pzXCIpO1xudmFyIF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiKTtcbmZ1bmN0aW9uIF9zbGljZWRfdG9fYXJyYXkoYXJyLCBpKSB7XG4gICAgcmV0dXJuIF9hcnJheV93aXRoX2hvbGVzLl8oYXJyKSB8fCBfaXRlcmFibGVfdG9fYXJyYXlfbGltaXQuXyhhcnIsIGkpIHx8IF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5fKGFyciwgaSkgfHwgX25vbl9pdGVyYWJsZV9yZXN0Ll8oKTtcbn1cbmV4cG9ydHMuXyA9IF9zbGljZWRfdG9fYXJyYXk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2FycmF5LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3RvX2FycmF5LmNqcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9hcnJheV93aXRoX2hvbGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fYXJyYXlfd2l0aF9ob2xlcy5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRoX2hvbGVzLmNqc1wiKTtcbnZhciBfaXRlcmFibGVfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19pdGVyYWJsZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pdGVyYWJsZV90b19hcnJheS5janNcIik7XG52YXIgX25vbl9pdGVyYWJsZV9yZXN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fbm9uX2l0ZXJhYmxlX3Jlc3QuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fbm9uX2l0ZXJhYmxlX3Jlc3QuY2pzXCIpO1xudmFyIF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiKTtcbmZ1bmN0aW9uIF90b19hcnJheShhcnIpIHtcbiAgICByZXR1cm4gX2FycmF5X3dpdGhfaG9sZXMuXyhhcnIpIHx8IF9pdGVyYWJsZV90b19hcnJheS5fKGFycikgfHwgX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5Ll8oYXJyKSB8fCBfbm9uX2l0ZXJhYmxlX3Jlc3QuXygpO1xufVxuZXhwb3J0cy5fID0gX3RvX2FycmF5O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdG9fY29uc3VtYWJsZV9hcnJheS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIF9hcnJheV93aXRob3V0X2hvbGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9fYXJyYXlfd2l0aG91dF9ob2xlcy5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19hcnJheV93aXRob3V0X2hvbGVzLmNqc1wiKTtcbnZhciBfaXRlcmFibGVfdG9fYXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19pdGVyYWJsZV90b19hcnJheS5janMgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pdGVyYWJsZV90b19hcnJheS5janNcIik7XG52YXIgX25vbl9pdGVyYWJsZV9zcHJlYWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL19ub25faXRlcmFibGVfc3ByZWFkLmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX25vbl9pdGVyYWJsZV9zcHJlYWQuY2pzXCIpO1xudmFyIF91bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5LmNqcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Bzd2MvaGVscGVycy9janMvX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5LmNqc1wiKTtcbmZ1bmN0aW9uIF90b19jb25zdW1hYmxlX2FycmF5KGFycikge1xuICAgIHJldHVybiBfYXJyYXlfd2l0aG91dF9ob2xlcy5fKGFycikgfHwgX2l0ZXJhYmxlX3RvX2FycmF5Ll8oYXJyKSB8fCBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkuXyhhcnIpIHx8IF9ub25faXRlcmFibGVfc3ByZWFkLl8oKTtcbn1cbmV4cG9ydHMuXyA9IF90b19jb25zdW1hYmxlX2FycmF5O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190eXBlX29mLmNqc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fdHlwZV9vZi5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX3R5cGVfb2Yob2JqKSB7XG4gICAgXCJAc3djL2hlbHBlcnMgLSB0eXBlb2ZcIjtcbiAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajtcbn1cbmV4cG9ydHMuXyA9IF90eXBlX29mO1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiAuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL191bnN1cHBvcnRlZF9pdGVyYWJsZV90b19hcnJheS5janMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfYXJyYXlfbGlrZV90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vX2FycmF5X2xpa2VfdG9fYXJyYXkuY2pzICovIFwiLi9ub2RlX21vZHVsZXMvQHN3Yy9oZWxwZXJzL2Nqcy9fYXJyYXlfbGlrZV90b19hcnJheS5janNcIik7XG5mdW5jdGlvbiBfdW5zdXBwb3J0ZWRfaXRlcmFibGVfdG9fYXJyYXkobywgbWluTGVuKSB7XG4gICAgaWYgKCFvKSByZXR1cm47XG4gICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5X2xpa2VfdG9fYXJyYXkuXyhvLCBtaW5MZW4pO1xuICAgIHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTtcbiAgICBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgIGlmIChuID09PSBcIk1hcFwiIHx8IG4gPT09IFwiU2V0XCIpIHJldHVybiBBcnJheS5mcm9tKG4pO1xuICAgIGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5X2xpa2VfdG9fYXJyYXkuXyhvLCBtaW5MZW4pO1xufVxuZXhwb3J0cy5fID0gX3Vuc3VwcG9ydGVkX2l0ZXJhYmxlX3RvX2FycmF5O1xuXG5cbn0pLFxuXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9kaXN0L21vZHVsZXMvU2NyaXB0TWFuYWdlci9OYXRpdmVTY3JpcHRNYW5hZ2VyLmpzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9TY3JpcHRNYW5hZ2VyL05hdGl2ZVNjcmlwdE1hbmFnZXIuanMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgICB2YWx1ZTogdHJ1ZVxufSkpO1xuZnVuY3Rpb24gX2V4cG9ydCh0YXJnZXQsIGFsbCkge1xuICAgIGZvcih2YXIgbmFtZSBpbiBhbGwpT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgbmFtZSwge1xuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBnZXQ6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYWxsLCBuYW1lKS5nZXRcbiAgICB9KTtcbn1cbl9leHBvcnQoZXhwb3J0cywge1xuICAgIGdldCBOb3JtYWxpemVkU2NyaXB0TG9jYXRvckhUVFBNZXRob2QgKCkge1xuICAgICAgICByZXR1cm4gTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kO1xuICAgIH0sXG4gICAgZ2V0IE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZSAoKSB7XG4gICAgICAgIHJldHVybiBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGU7XG4gICAgfSxcbiAgICBnZXQgZGVmYXVsdCAoKSB7XG4gICAgICAgIHJldHVybiBfZGVmYXVsdDtcbiAgICB9XG59KTtcbnZhciBfcmVhY3RuYXRpdmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUgKi8gXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/ODI4YlwiKTtcbnZhciBOb3JtYWxpemVkU2NyaXB0TG9jYXRvckhUVFBNZXRob2QgPSBmdW5jdGlvbihOb3JtYWxpemVkU2NyaXB0TG9jYXRvckhUVFBNZXRob2QpIHtcbiAgICBOb3JtYWxpemVkU2NyaXB0TG9jYXRvckhUVFBNZXRob2RbXCJHRVRcIl0gPSBcIkdFVFwiO1xuICAgIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9ySFRUUE1ldGhvZFtcIlBPU1RcIl0gPSBcIlBPU1RcIjtcbiAgICByZXR1cm4gTm9ybWFsaXplZFNjcmlwdExvY2F0b3JIVFRQTWV0aG9kO1xufSh7fSk7XG52YXIgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlID0gZnVuY3Rpb24oTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlKSB7XG4gICAgTm9ybWFsaXplZFNjcmlwdExvY2F0b3JTaWduYXR1cmVWZXJpZmljYXRpb25Nb2RlW1wiU1RSSUNUXCJdID0gXCJzdHJpY3RcIjtcbiAgICBOb3JtYWxpemVkU2NyaXB0TG9jYXRvclNpZ25hdHVyZVZlcmlmaWNhdGlvbk1vZGVbXCJMQVhcIl0gPSBcImxheFwiO1xuICAgIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZVtcIk9GRlwiXSA9IFwib2ZmXCI7XG4gICAgcmV0dXJuIE5vcm1hbGl6ZWRTY3JpcHRMb2NhdG9yU2lnbmF0dXJlVmVyaWZpY2F0aW9uTW9kZTtcbn0oe30pO1xudmFyIF9kZWZhdWx0ID0gX3JlYWN0bmF0aXZlLlR1cmJvTW9kdWxlUmVnaXN0cnkuZ2V0KCdTY3JpcHRNYW5hZ2VyJyk7XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanNcIjogXG4vKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9ub2RlX21vZHVsZXMvZXZlbnRzL2V2ZW50cy5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuKGZ1bmN0aW9uIChtb2R1bGUpIHtcblwidXNlIHN0cmljdFwiO1xuLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbnZhciBSID0gdHlwZW9mIFJlZmxlY3QgPT09ICdvYmplY3QnID8gUmVmbGVjdCA6IG51bGw7XG52YXIgUmVmbGVjdEFwcGx5ID0gUiAmJiB0eXBlb2YgUi5hcHBseSA9PT0gJ2Z1bmN0aW9uJyA/IFIuYXBwbHkgOiBmdW5jdGlvbiBSZWZsZWN0QXBwbHkodGFyZ2V0LCByZWNlaXZlciwgYXJncykge1xuICAgIHJldHVybiBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuY2FsbCh0YXJnZXQsIHJlY2VpdmVyLCBhcmdzKTtcbn07XG52YXIgUmVmbGVjdE93bktleXM7XG5pZiAoUiAmJiB0eXBlb2YgUi5vd25LZXlzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgUmVmbGVjdE93bktleXMgPSBSLm93bktleXM7XG59IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICBSZWZsZWN0T3duS2V5cyA9IGZ1bmN0aW9uIFJlZmxlY3RPd25LZXlzKHRhcmdldCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGFyZ2V0KS5jb25jYXQoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyh0YXJnZXQpKTtcbiAgICB9O1xufSBlbHNlIHtcbiAgICBSZWZsZWN0T3duS2V5cyA9IGZ1bmN0aW9uIFJlZmxlY3RPd25LZXlzKHRhcmdldCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGFyZ2V0KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gUHJvY2Vzc0VtaXRXYXJuaW5nKHdhcm5pbmcpIHtcbiAgICBpZiAoY29uc29sZSAmJiBjb25zb2xlLndhcm4pIGNvbnNvbGUud2Fybih3YXJuaW5nKTtcbn1cbnZhciBOdW1iZXJJc05hTiA9IE51bWJlci5pc05hTiB8fCBmdW5jdGlvbiBOdW1iZXJJc05hTih2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSAhPT0gdmFsdWU7XG59O1xuZnVuY3Rpb24gRXZlbnRFbWl0dGVyKCkge1xuICAgIEV2ZW50RW1pdHRlci5pbml0LmNhbGwodGhpcyk7XG59XG5tb2R1bGUuZXhwb3J0cyA9IEV2ZW50RW1pdHRlcjtcbm1vZHVsZS5leHBvcnRzLm9uY2UgPSBvbmNlO1xuLy8gQmFja3dhcmRzLWNvbXBhdCB3aXRoIG5vZGUgMC4xMC54XG5FdmVudEVtaXR0ZXIuRXZlbnRFbWl0dGVyID0gRXZlbnRFbWl0dGVyO1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fZXZlbnRzID0gdW5kZWZpbmVkO1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fZXZlbnRzQ291bnQgPSAwO1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fbWF4TGlzdGVuZXJzID0gdW5kZWZpbmVkO1xuLy8gQnkgZGVmYXVsdCBFdmVudEVtaXR0ZXJzIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIG1vcmUgdGhhbiAxMCBsaXN0ZW5lcnMgYXJlXG4vLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLlxudmFyIGRlZmF1bHRNYXhMaXN0ZW5lcnMgPSAxMDtcbmZ1bmN0aW9uIGNoZWNrTGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgICBpZiAodHlwZW9mIGxpc3RlbmVyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBcImxpc3RlbmVyXCIgYXJndW1lbnQgbXVzdCBiZSBvZiB0eXBlIEZ1bmN0aW9uLiBSZWNlaXZlZCB0eXBlICcgKyB0eXBlb2YgbGlzdGVuZXIpO1xuICAgIH1cbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShFdmVudEVtaXR0ZXIsICdkZWZhdWx0TWF4TGlzdGVuZXJzJywge1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRNYXhMaXN0ZW5lcnM7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uKGFyZykge1xuICAgICAgICBpZiAodHlwZW9mIGFyZyAhPT0gJ251bWJlcicgfHwgYXJnIDwgMCB8fCBOdW1iZXJJc05hTihhcmcpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignVGhlIHZhbHVlIG9mIFwiZGVmYXVsdE1heExpc3RlbmVyc1wiIGlzIG91dCBvZiByYW5nZS4gSXQgbXVzdCBiZSBhIG5vbi1uZWdhdGl2ZSBudW1iZXIuIFJlY2VpdmVkICcgKyBhcmcgKyAnLicpO1xuICAgICAgICB9XG4gICAgICAgIGRlZmF1bHRNYXhMaXN0ZW5lcnMgPSBhcmc7XG4gICAgfVxufSk7XG5FdmVudEVtaXR0ZXIuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLl9ldmVudHMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLl9ldmVudHMgPT09IE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKS5fZXZlbnRzKSB7XG4gICAgICAgIHRoaXMuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIHRoaXMuX2V2ZW50c0NvdW50ID0gMDtcbiAgICB9XG4gICAgdGhpcy5fbWF4TGlzdGVuZXJzID0gdGhpcy5fbWF4TGlzdGVuZXJzIHx8IHVuZGVmaW5lZDtcbn07XG4vLyBPYnZpb3VzbHkgbm90IGFsbCBFbWl0dGVycyBzaG91bGQgYmUgbGltaXRlZCB0byAxMC4gVGhpcyBmdW5jdGlvbiBhbGxvd3Ncbi8vIHRoYXQgdG8gYmUgaW5jcmVhc2VkLiBTZXQgdG8gemVybyBmb3IgdW5saW1pdGVkLlxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5zZXRNYXhMaXN0ZW5lcnMgPSBmdW5jdGlvbiBzZXRNYXhMaXN0ZW5lcnMobikge1xuICAgIGlmICh0eXBlb2YgbiAhPT0gJ251bWJlcicgfHwgbiA8IDAgfHwgTnVtYmVySXNOYU4obikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSB2YWx1ZSBvZiBcIm5cIiBpcyBvdXQgb2YgcmFuZ2UuIEl0IG11c3QgYmUgYSBub24tbmVnYXRpdmUgbnVtYmVyLiBSZWNlaXZlZCAnICsgbiArICcuJyk7XG4gICAgfVxuICAgIHRoaXMuX21heExpc3RlbmVycyA9IG47XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuZnVuY3Rpb24gX2dldE1heExpc3RlbmVycyh0aGF0KSB7XG4gICAgaWYgKHRoYXQuX21heExpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnM7XG4gICAgcmV0dXJuIHRoYXQuX21heExpc3RlbmVycztcbn1cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZ2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24gZ2V0TWF4TGlzdGVuZXJzKCkge1xuICAgIHJldHVybiBfZ2V0TWF4TGlzdGVuZXJzKHRoaXMpO1xufTtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uIGVtaXQodHlwZSkge1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylhcmdzLnB1c2goYXJndW1lbnRzW2ldKTtcbiAgICB2YXIgZG9FcnJvciA9IHR5cGUgPT09ICdlcnJvcic7XG4gICAgdmFyIGV2ZW50cyA9IHRoaXMuX2V2ZW50cztcbiAgICBpZiAoZXZlbnRzICE9PSB1bmRlZmluZWQpIGRvRXJyb3IgPSBkb0Vycm9yICYmIGV2ZW50cy5lcnJvciA9PT0gdW5kZWZpbmVkO1xuICAgIGVsc2UgaWYgKCFkb0Vycm9yKSByZXR1cm4gZmFsc2U7XG4gICAgLy8gSWYgdGhlcmUgaXMgbm8gJ2Vycm9yJyBldmVudCBsaXN0ZW5lciB0aGVuIHRocm93LlxuICAgIGlmIChkb0Vycm9yKSB7XG4gICAgICAgIHZhciBlcjtcbiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gMCkgZXIgPSBhcmdzWzBdO1xuICAgICAgICBpZiAoZXIgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgLy8gTm90ZTogVGhlIGNvbW1lbnRzIG9uIHRoZSBgdGhyb3dgIGxpbmVzIGFyZSBpbnRlbnRpb25hbCwgdGhleSBzaG93XG4gICAgICAgICAgICAvLyB1cCBpbiBOb2RlJ3Mgb3V0cHV0IGlmIHRoaXMgcmVzdWx0cyBpbiBhbiB1bmhhbmRsZWQgZXhjZXB0aW9uLlxuICAgICAgICAgICAgdGhyb3cgZXI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50XG4gICAgICAgIH1cbiAgICAgICAgLy8gQXQgbGVhc3QgZ2l2ZSBzb21lIGtpbmQgb2YgY29udGV4dCB0byB0aGUgdXNlclxuICAgICAgICB2YXIgZXJyID0gbmV3IEVycm9yKCdVbmhhbmRsZWQgZXJyb3IuJyArIChlciA/ICcgKCcgKyBlci5tZXNzYWdlICsgJyknIDogJycpKTtcbiAgICAgICAgZXJyLmNvbnRleHQgPSBlcjtcbiAgICAgICAgdGhyb3cgZXJyOyAvLyBVbmhhbmRsZWQgJ2Vycm9yJyBldmVudFxuICAgIH1cbiAgICB2YXIgaGFuZGxlciA9IGV2ZW50c1t0eXBlXTtcbiAgICBpZiAoaGFuZGxlciA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIFJlZmxlY3RBcHBseShoYW5kbGVyLCB0aGlzLCBhcmdzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbGVuID0gaGFuZGxlci5sZW5ndGg7XG4gICAgICAgIHZhciBsaXN0ZW5lcnMgPSBhcnJheUNsb25lKGhhbmRsZXIsIGxlbik7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47ICsraSlSZWZsZWN0QXBwbHkobGlzdGVuZXJzW2ldLCB0aGlzLCBhcmdzKTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuZnVuY3Rpb24gX2FkZExpc3RlbmVyKHRhcmdldCwgdHlwZSwgbGlzdGVuZXIsIHByZXBlbmQpIHtcbiAgICB2YXIgbTtcbiAgICB2YXIgZXZlbnRzO1xuICAgIHZhciBleGlzdGluZztcbiAgICBjaGVja0xpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICBldmVudHMgPSB0YXJnZXQuX2V2ZW50cztcbiAgICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZXZlbnRzID0gdGFyZ2V0Ll9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICB0YXJnZXQuX2V2ZW50c0NvdW50ID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBUbyBhdm9pZCByZWN1cnNpb24gaW4gdGhlIGNhc2UgdGhhdCB0eXBlID09PSBcIm5ld0xpc3RlbmVyXCIhIEJlZm9yZVxuICAgICAgICAvLyBhZGRpbmcgaXQgdG8gdGhlIGxpc3RlbmVycywgZmlyc3QgZW1pdCBcIm5ld0xpc3RlbmVyXCIuXG4gICAgICAgIGlmIChldmVudHMubmV3TGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGFyZ2V0LmVtaXQoJ25ld0xpc3RlbmVyJywgdHlwZSwgbGlzdGVuZXIubGlzdGVuZXIgPyBsaXN0ZW5lci5saXN0ZW5lciA6IGxpc3RlbmVyKTtcbiAgICAgICAgICAgIC8vIFJlLWFzc2lnbiBgZXZlbnRzYCBiZWNhdXNlIGEgbmV3TGlzdGVuZXIgaGFuZGxlciBjb3VsZCBoYXZlIGNhdXNlZCB0aGVcbiAgICAgICAgICAgIC8vIHRoaXMuX2V2ZW50cyB0byBiZSBhc3NpZ25lZCB0byBhIG5ldyBvYmplY3RcbiAgICAgICAgICAgIGV2ZW50cyA9IHRhcmdldC5fZXZlbnRzO1xuICAgICAgICB9XG4gICAgICAgIGV4aXN0aW5nID0gZXZlbnRzW3R5cGVdO1xuICAgIH1cbiAgICBpZiAoZXhpc3RpbmcgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBPcHRpbWl6ZSB0aGUgY2FzZSBvZiBvbmUgbGlzdGVuZXIuIERvbid0IG5lZWQgdGhlIGV4dHJhIGFycmF5IG9iamVjdC5cbiAgICAgICAgZXhpc3RpbmcgPSBldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjtcbiAgICAgICAgKyt0YXJnZXQuX2V2ZW50c0NvdW50O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0eXBlb2YgZXhpc3RpbmcgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIC8vIEFkZGluZyB0aGUgc2Vjb25kIGVsZW1lbnQsIG5lZWQgdG8gY2hhbmdlIHRvIGFycmF5LlxuICAgICAgICAgICAgZXhpc3RpbmcgPSBldmVudHNbdHlwZV0gPSBwcmVwZW5kID8gW1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyLFxuICAgICAgICAgICAgICAgIGV4aXN0aW5nXG4gICAgICAgICAgICBdIDogW1xuICAgICAgICAgICAgICAgIGV4aXN0aW5nLFxuICAgICAgICAgICAgICAgIGxpc3RlbmVyXG4gICAgICAgICAgICBdO1xuICAgICAgICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IGdvdCBhbiBhcnJheSwganVzdCBhcHBlbmQuXG4gICAgICAgIH0gZWxzZSBpZiAocHJlcGVuZCkge1xuICAgICAgICAgICAgZXhpc3RpbmcudW5zaGlmdChsaXN0ZW5lcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBleGlzdGluZy5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBDaGVjayBmb3IgbGlzdGVuZXIgbGVha1xuICAgICAgICBtID0gX2dldE1heExpc3RlbmVycyh0YXJnZXQpO1xuICAgICAgICBpZiAobSA+IDAgJiYgZXhpc3RpbmcubGVuZ3RoID4gbSAmJiAhZXhpc3Rpbmcud2FybmVkKSB7XG4gICAgICAgICAgICBleGlzdGluZy53YXJuZWQgPSB0cnVlO1xuICAgICAgICAgICAgLy8gTm8gZXJyb3IgY29kZSBmb3IgdGhpcyBzaW5jZSBpdCBpcyBhIFdhcm5pbmdcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXN5bnRheFxuICAgICAgICAgICAgdmFyIHcgPSBuZXcgRXJyb3IoJ1Bvc3NpYmxlIEV2ZW50RW1pdHRlciBtZW1vcnkgbGVhayBkZXRlY3RlZC4gJyArIGV4aXN0aW5nLmxlbmd0aCArICcgJyArIFN0cmluZyh0eXBlKSArICcgbGlzdGVuZXJzICcgKyAnYWRkZWQuIFVzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvICcgKyAnaW5jcmVhc2UgbGltaXQnKTtcbiAgICAgICAgICAgIHcubmFtZSA9ICdNYXhMaXN0ZW5lcnNFeGNlZWRlZFdhcm5pbmcnO1xuICAgICAgICAgICAgdy5lbWl0dGVyID0gdGFyZ2V0O1xuICAgICAgICAgICAgdy50eXBlID0gdHlwZTtcbiAgICAgICAgICAgIHcuY291bnQgPSBleGlzdGluZy5sZW5ndGg7XG4gICAgICAgICAgICBQcm9jZXNzRW1pdFdhcm5pbmcodyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbn1cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBmdW5jdGlvbiBhZGRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikge1xuICAgIHJldHVybiBfYWRkTGlzdGVuZXIodGhpcywgdHlwZSwgbGlzdGVuZXIsIGZhbHNlKTtcbn07XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uID0gRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lcjtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucHJlcGVuZExpc3RlbmVyID0gZnVuY3Rpb24gcHJlcGVuZExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgcmV0dXJuIF9hZGRMaXN0ZW5lcih0aGlzLCB0eXBlLCBsaXN0ZW5lciwgdHJ1ZSk7XG59O1xuZnVuY3Rpb24gb25jZVdyYXBwZXIoKSB7XG4gICAgaWYgKCF0aGlzLmZpcmVkKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0LnJlbW92ZUxpc3RlbmVyKHRoaXMudHlwZSwgdGhpcy53cmFwRm4pO1xuICAgICAgICB0aGlzLmZpcmVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHJldHVybiB0aGlzLmxpc3RlbmVyLmNhbGwodGhpcy50YXJnZXQpO1xuICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW5lci5hcHBseSh0aGlzLnRhcmdldCwgYXJndW1lbnRzKTtcbiAgICB9XG59XG5mdW5jdGlvbiBfb25jZVdyYXAodGFyZ2V0LCB0eXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBzdGF0ZSA9IHtcbiAgICAgICAgZmlyZWQ6IGZhbHNlLFxuICAgICAgICB3cmFwRm46IHVuZGVmaW5lZCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXG4gICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgIGxpc3RlbmVyOiBsaXN0ZW5lclxuICAgIH07XG4gICAgdmFyIHdyYXBwZWQgPSBvbmNlV3JhcHBlci5iaW5kKHN0YXRlKTtcbiAgICB3cmFwcGVkLmxpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgc3RhdGUud3JhcEZuID0gd3JhcHBlZDtcbiAgICByZXR1cm4gd3JhcHBlZDtcbn1cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uIG9uY2UodHlwZSwgbGlzdGVuZXIpIHtcbiAgICBjaGVja0xpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICB0aGlzLm9uKHR5cGUsIF9vbmNlV3JhcCh0aGlzLCB0eXBlLCBsaXN0ZW5lcikpO1xuICAgIHJldHVybiB0aGlzO1xufTtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucHJlcGVuZE9uY2VMaXN0ZW5lciA9IGZ1bmN0aW9uIHByZXBlbmRPbmNlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHtcbiAgICBjaGVja0xpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICB0aGlzLnByZXBlbmRMaXN0ZW5lcih0eXBlLCBfb25jZVdyYXAodGhpcywgdHlwZSwgbGlzdGVuZXIpKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG4vLyBFbWl0cyBhICdyZW1vdmVMaXN0ZW5lcicgZXZlbnQgaWYgYW5kIG9ubHkgaWYgdGhlIGxpc3RlbmVyIHdhcyByZW1vdmVkLlxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lciA9IGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIGxpc3QsIGV2ZW50cywgcG9zaXRpb24sIGksIG9yaWdpbmFsTGlzdGVuZXI7XG4gICAgY2hlY2tMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuICAgIGlmIChldmVudHMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXM7XG4gICAgbGlzdCA9IGV2ZW50c1t0eXBlXTtcbiAgICBpZiAobGlzdCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdGhpcztcbiAgICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHwgbGlzdC5saXN0ZW5lciA9PT0gbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKC0tdGhpcy5fZXZlbnRzQ291bnQgPT09IDApIHRoaXMuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGVsZXRlIGV2ZW50c1t0eXBlXTtcbiAgICAgICAgICAgIGlmIChldmVudHMucmVtb3ZlTGlzdGVuZXIpIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0Lmxpc3RlbmVyIHx8IGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGxpc3QgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcG9zaXRpb24gPSAtMTtcbiAgICAgICAgZm9yKGkgPSBsaXN0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKXtcbiAgICAgICAgICAgIGlmIChsaXN0W2ldID09PSBsaXN0ZW5lciB8fCBsaXN0W2ldLmxpc3RlbmVyID09PSBsaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsTGlzdGVuZXIgPSBsaXN0W2ldLmxpc3RlbmVyO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gaTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocG9zaXRpb24gPCAwKSByZXR1cm4gdGhpcztcbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSAwKSBsaXN0LnNoaWZ0KCk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3BsaWNlT25lKGxpc3QsIHBvc2l0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGlzdC5sZW5ndGggPT09IDEpIGV2ZW50c1t0eXBlXSA9IGxpc3RbMF07XG4gICAgICAgIGlmIChldmVudHMucmVtb3ZlTGlzdGVuZXIgIT09IHVuZGVmaW5lZCkgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIG9yaWdpbmFsTGlzdGVuZXIgfHwgbGlzdGVuZXIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9mZiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXI7XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycyA9IGZ1bmN0aW9uIHJlbW92ZUFsbExpc3RlbmVycyh0eXBlKSB7XG4gICAgdmFyIGxpc3RlbmVycywgZXZlbnRzLCBpO1xuICAgIGV2ZW50cyA9IHRoaXMuX2V2ZW50cztcbiAgICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpIHJldHVybiB0aGlzO1xuICAgIC8vIG5vdCBsaXN0ZW5pbmcgZm9yIHJlbW92ZUxpc3RlbmVyLCBubyBuZWVkIHRvIGVtaXRcbiAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgICAgICB0aGlzLl9ldmVudHNDb3VudCA9IDA7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnRzW3R5cGVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGlmICgtLXRoaXMuX2V2ZW50c0NvdW50ID09PSAwKSB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICAgICAgZWxzZSBkZWxldGUgZXZlbnRzW3R5cGVdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvLyBlbWl0IHJlbW92ZUxpc3RlbmVyIGZvciBhbGwgbGlzdGVuZXJzIG9uIGFsbCBldmVudHNcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGV2ZW50cyk7XG4gICAgICAgIHZhciBrZXk7XG4gICAgICAgIGZvcihpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAga2V5ID0ga2V5c1tpXTtcbiAgICAgICAgICAgIGlmIChrZXkgPT09ICdyZW1vdmVMaXN0ZW5lcicpIGNvbnRpbnVlO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoa2V5KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygncmVtb3ZlTGlzdGVuZXInKTtcbiAgICAgICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgdGhpcy5fZXZlbnRzQ291bnQgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgbGlzdGVuZXJzID0gZXZlbnRzW3R5cGVdO1xuICAgIGlmICh0eXBlb2YgbGlzdGVuZXJzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzKTtcbiAgICB9IGVsc2UgaWYgKGxpc3RlbmVycyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIExJRk8gb3JkZXJcbiAgICAgICAgZm9yKGkgPSBsaXN0ZW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnNbaV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcbmZ1bmN0aW9uIF9saXN0ZW5lcnModGFyZ2V0LCB0eXBlLCB1bndyYXApIHtcbiAgICB2YXIgZXZlbnRzID0gdGFyZ2V0Ll9ldmVudHM7XG4gICAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gW107XG4gICAgdmFyIGV2bGlzdGVuZXIgPSBldmVudHNbdHlwZV07XG4gICAgaWYgKGV2bGlzdGVuZXIgPT09IHVuZGVmaW5lZCkgcmV0dXJuIFtdO1xuICAgIGlmICh0eXBlb2YgZXZsaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIHVud3JhcCA/IFtcbiAgICAgICAgZXZsaXN0ZW5lci5saXN0ZW5lciB8fCBldmxpc3RlbmVyXG4gICAgXSA6IFtcbiAgICAgICAgZXZsaXN0ZW5lclxuICAgIF07XG4gICAgcmV0dXJuIHVud3JhcCA/IHVud3JhcExpc3RlbmVycyhldmxpc3RlbmVyKSA6IGFycmF5Q2xvbmUoZXZsaXN0ZW5lciwgZXZsaXN0ZW5lci5sZW5ndGgpO1xufVxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lcnMgPSBmdW5jdGlvbiBsaXN0ZW5lcnModHlwZSkge1xuICAgIHJldHVybiBfbGlzdGVuZXJzKHRoaXMsIHR5cGUsIHRydWUpO1xufTtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmF3TGlzdGVuZXJzID0gZnVuY3Rpb24gcmF3TGlzdGVuZXJzKHR5cGUpIHtcbiAgICByZXR1cm4gX2xpc3RlbmVycyh0aGlzLCB0eXBlLCBmYWxzZSk7XG59O1xuRXZlbnRFbWl0dGVyLmxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbihlbWl0dGVyLCB0eXBlKSB7XG4gICAgaWYgKHR5cGVvZiBlbWl0dGVyLmxpc3RlbmVyQ291bnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIGVtaXR0ZXIubGlzdGVuZXJDb3VudCh0eXBlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbGlzdGVuZXJDb3VudC5jYWxsKGVtaXR0ZXIsIHR5cGUpO1xuICAgIH1cbn07XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVyQ291bnQgPSBsaXN0ZW5lckNvdW50O1xuZnVuY3Rpb24gbGlzdGVuZXJDb3VudCh0eXBlKSB7XG4gICAgdmFyIGV2ZW50cyA9IHRoaXMuX2V2ZW50cztcbiAgICBpZiAoZXZlbnRzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyIGV2bGlzdGVuZXIgPSBldmVudHNbdHlwZV07XG4gICAgICAgIGlmICh0eXBlb2YgZXZsaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZsaXN0ZW5lciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZXZsaXN0ZW5lci5sZW5ndGg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmV2ZW50TmFtZXMgPSBmdW5jdGlvbiBldmVudE5hbWVzKCkge1xuICAgIHJldHVybiB0aGlzLl9ldmVudHNDb3VudCA+IDAgPyBSZWZsZWN0T3duS2V5cyh0aGlzLl9ldmVudHMpIDogW107XG59O1xuZnVuY3Rpb24gYXJyYXlDbG9uZShhcnIsIG4pIHtcbiAgICB2YXIgY29weSA9IG5ldyBBcnJheShuKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbjsgKytpKWNvcHlbaV0gPSBhcnJbaV07XG4gICAgcmV0dXJuIGNvcHk7XG59XG5mdW5jdGlvbiBzcGxpY2VPbmUobGlzdCwgaW5kZXgpIHtcbiAgICBmb3IoOyBpbmRleCArIDEgPCBsaXN0Lmxlbmd0aDsgaW5kZXgrKylsaXN0W2luZGV4XSA9IGxpc3RbaW5kZXggKyAxXTtcbiAgICBsaXN0LnBvcCgpO1xufVxuZnVuY3Rpb24gdW53cmFwTGlzdGVuZXJzKGFycikge1xuICAgIHZhciByZXQgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHJldC5sZW5ndGg7ICsraSl7XG4gICAgICAgIHJldFtpXSA9IGFycltpXS5saXN0ZW5lciB8fCBhcnJbaV07XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59XG5mdW5jdGlvbiBvbmNlKGVtaXR0ZXIsIG5hbWUpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGVycm9yTGlzdGVuZXIoZXJyKSB7XG4gICAgICAgICAgICBlbWl0dGVyLnJlbW92ZUxpc3RlbmVyKG5hbWUsIHJlc29sdmVyKTtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlc29sdmVyKCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBlbWl0dGVyLnJlbW92ZUxpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgZW1pdHRlci5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBlcnJvckxpc3RlbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc29sdmUoW10uc2xpY2UuY2FsbChhcmd1bWVudHMpKTtcbiAgICAgICAgfVxuICAgICAgICA7XG4gICAgICAgIGV2ZW50VGFyZ2V0QWdub3N0aWNBZGRMaXN0ZW5lcihlbWl0dGVyLCBuYW1lLCByZXNvbHZlciwge1xuICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG5hbWUgIT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgIGFkZEVycm9ySGFuZGxlcklmRXZlbnRFbWl0dGVyKGVtaXR0ZXIsIGVycm9yTGlzdGVuZXIsIHtcbiAgICAgICAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZnVuY3Rpb24gYWRkRXJyb3JIYW5kbGVySWZFdmVudEVtaXR0ZXIoZW1pdHRlciwgaGFuZGxlciwgZmxhZ3MpIHtcbiAgICBpZiAodHlwZW9mIGVtaXR0ZXIub24gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgZXZlbnRUYXJnZXRBZ25vc3RpY0FkZExpc3RlbmVyKGVtaXR0ZXIsICdlcnJvcicsIGhhbmRsZXIsIGZsYWdzKTtcbiAgICB9XG59XG5mdW5jdGlvbiBldmVudFRhcmdldEFnbm9zdGljQWRkTGlzdGVuZXIoZW1pdHRlciwgbmFtZSwgbGlzdGVuZXIsIGZsYWdzKSB7XG4gICAgaWYgKHR5cGVvZiBlbWl0dGVyLm9uID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGlmIChmbGFncy5vbmNlKSB7XG4gICAgICAgICAgICBlbWl0dGVyLm9uY2UobmFtZSwgbGlzdGVuZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZW1pdHRlci5vbihuYW1lLCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbWl0dGVyLmFkZEV2ZW50TGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgLy8gRXZlbnRUYXJnZXQgZG9lcyBub3QgaGF2ZSBgZXJyb3JgIGV2ZW50IHNlbWFudGljcyBsaWtlIE5vZGVcbiAgICAgICAgLy8gRXZlbnRFbWl0dGVycywgd2UgZG8gbm90IGxpc3RlbiBmb3IgYGVycm9yYCBldmVudHMgaGVyZS5cbiAgICAgICAgZW1pdHRlci5hZGRFdmVudExpc3RlbmVyKG5hbWUsIGZ1bmN0aW9uIHdyYXBMaXN0ZW5lcihhcmcpIHtcbiAgICAgICAgICAgIC8vIElFIGRvZXMgbm90IGhhdmUgYnVpbHRpbiBgeyBvbmNlOiB0cnVlIH1gIHN1cHBvcnQgc28gd2VcbiAgICAgICAgICAgIC8vIGhhdmUgdG8gZG8gaXQgbWFudWFsbHkuXG4gICAgICAgICAgICBpZiAoZmxhZ3Mub25jZSkge1xuICAgICAgICAgICAgICAgIGVtaXR0ZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCB3cmFwTGlzdGVuZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGlzdGVuZXIoYXJnKTtcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIFwiZW1pdHRlclwiIGFyZ3VtZW50IG11c3QgYmUgb2YgdHlwZSBFdmVudEVtaXR0ZXIuIFJlY2VpdmVkIHR5cGUgJyArIHR5cGVvZiBlbWl0dGVyKTtcbiAgICB9XG59XG5cblxufSksXG5cIi4vbm9kZV9tb2R1bGVzL3NoYWxsb3dlcXVhbC9pbmRleC5qc1wiOiBcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIC4vbm9kZV9tb2R1bGVzL3NoYWxsb3dlcXVhbC9pbmRleC5qcyAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKG1vZHVsZSkge1xuLy9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gc2hhbGxvd0VxdWFsKG9iakEsIG9iakIsIGNvbXBhcmUsIGNvbXBhcmVDb250ZXh0KSB7XG4gICAgdmFyIHJldCA9IGNvbXBhcmUgPyBjb21wYXJlLmNhbGwoY29tcGFyZUNvbnRleHQsIG9iakEsIG9iakIpIDogdm9pZCAwO1xuICAgIGlmIChyZXQgIT09IHZvaWQgMCkge1xuICAgICAgICByZXR1cm4gISFyZXQ7XG4gICAgfVxuICAgIGlmIChvYmpBID09PSBvYmpCKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9iakEgIT09IFwib2JqZWN0XCIgfHwgIW9iakEgfHwgdHlwZW9mIG9iakIgIT09IFwib2JqZWN0XCIgfHwgIW9iakIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIga2V5c0EgPSBPYmplY3Qua2V5cyhvYmpBKTtcbiAgICB2YXIga2V5c0IgPSBPYmplY3Qua2V5cyhvYmpCKTtcbiAgICBpZiAoa2V5c0EubGVuZ3RoICE9PSBrZXlzQi5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgYkhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5iaW5kKG9iakIpO1xuICAgIC8vIFRlc3QgZm9yIEEncyBrZXlzIGRpZmZlcmVudCBmcm9tIEIuXG4gICAgZm9yKHZhciBpZHggPSAwOyBpZHggPCBrZXlzQS5sZW5ndGg7IGlkeCsrKXtcbiAgICAgICAgdmFyIGtleSA9IGtleXNBW2lkeF07XG4gICAgICAgIGlmICghYkhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmFsdWVBID0gb2JqQVtrZXldO1xuICAgICAgICB2YXIgdmFsdWVCID0gb2JqQltrZXldO1xuICAgICAgICByZXQgPSBjb21wYXJlID8gY29tcGFyZS5jYWxsKGNvbXBhcmVDb250ZXh0LCB2YWx1ZUEsIHZhbHVlQiwga2V5KSA6IHZvaWQgMDtcbiAgICAgICAgaWYgKHJldCA9PT0gZmFsc2UgfHwgcmV0ID09PSB2b2lkIDAgJiYgdmFsdWVBICE9PSB2YWx1ZUIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cblxufSksXG5cIkBtb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL3JzcGFjay5qcyE9IWRhdGE6dGV4dC9qYXZhc2NyaXB0LGltcG9ydCBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3RyYXZlbHMvbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3RyYXZlbHMvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL3Jlc29sdmVyLXBsdWdpbi5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3RyYXZlbHMvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzXFxcIjtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luc19fID0gW19fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fKCksIF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fKCldO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX18gPSB7fTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18gPSBcXFwidHJhdmVsc1xcXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fID0gXFxcImxvYWRlZC1maXJzdFxcXCI7aWYoKF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhfHxfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkmJl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbil7dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyO2NvbnN0IG92ZXJyaWRlPShvYmosa2V5LHZhbHVlKT0+e2lmKCFvYmopcmV0dXJuO2lmKG9ialtrZXldKW9ialtrZXldPXZhbHVlfTtjb25zdCBtZXJnZT0ob2JqLGtleSxmbik9Pntjb25zdCB2YWx1ZT1mbigpO2lmKEFycmF5LmlzQXJyYXkodmFsdWUpKXt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPVtdO29ialtrZXldLnB1c2goLi4udmFsdWUpfWVsc2UgaWYodHlwZW9mIHZhbHVlPT09XFxcIm9iamVjdFxcXCImJnZhbHVlIT09bnVsbCl7dmFyIF9vYmoxLF9rZXkxO3ZhciBfMTsoXzE9KF9vYmoxPW9iailbX2tleTE9a2V5XSkhPT1udWxsJiZfMSE9PXZvaWQgMD9fMTpfb2JqMVtfa2V5MV09e307T2JqZWN0LmFzc2lnbihvYmpba2V5XSx2YWx1ZSl9fTtjb25zdCBlYXJseT0ob2JqLGtleSxpbml0aWFsKT0+e3ZhciBfb2JqLF9rZXk7dmFyIF87KF89KF9vYmo9b2JqKVtfa2V5PWtleV0pIT09bnVsbCYmXyE9PXZvaWQgMD9fOl9vYmpbX2tleV09aW5pdGlhbCgpfTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZztjb25zdCBpbml0aWFsaXplU2hhcmluZ1Njb3BlVG9Jbml0RGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCBjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc6e307Y29uc3QgY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcz17fTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcz1bXTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRUb2tlbnM9e307Y29uc3QgY29udGFpbmVyU2hhcmVTY29wZT0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLnNoYXJlU2NvcGU7Zm9yKGNvbnN0IGtleSBpbiBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fKXtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb25ba2V5XT1fX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fW2tleV19ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nXFxcIiwoKT0+e2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nKSl7Y29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1ttb2R1bGVJZF09e2dldHRlcjpkYXRhLmZhbGxiYWNrLHNoYXJlSW5mbzp7c2hhcmVDb25maWc6e2ZpeGVkRGVwZW5kZW5jaWVzOmZhbHNlLHJlcXVpcmVkVmVyc2lvbjpkYXRhLnJlcXVpcmVkVmVyc2lvbixzdHJpY3RWZXJzaW9uOmRhdGEuc3RyaWN0VmVyc2lvbixzaW5nbGV0b246ZGF0YS5zaW5nbGV0b24sZWFnZXI6ZGF0YS5lYWdlcn0sc2NvcGU6W2RhdGEuc2hhcmVTY29wZV19LHNoYXJlS2V5OmRhdGEuc2hhcmVLZXl9fXJldHVybiBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJpbml0T3B0aW9uc1xcXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwibmFtZVxcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJzaGFyZVN0cmF0ZWd5XFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXFxcInNoYXJlZFxcXCIsKCk9Pntjb25zdCBzaGFyZWQ9e307Zm9yKGxldFtzY29wZSxzdGFnZXNdb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nKSl7Zm9yKGxldCBzdGFnZSBvZiBzdGFnZXMpe2lmKHR5cGVvZiBzdGFnZT09PVxcXCJvYmplY3RcXFwiJiZzdGFnZSE9PW51bGwpe2NvbnN0e25hbWUsdmVyc2lvbixmYWN0b3J5LGVhZ2VyLHNpbmdsZXRvbixyZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbn09c3RhZ2U7Y29uc3Qgc2hhcmVDb25maWc9e307Y29uc3QgaXNWYWxpZFZhbHVlPWZ1bmN0aW9uKHZhbCl7cmV0dXJuIHR5cGVvZiB2YWwhPT1cXFwidW5kZWZpbmVkXFxcIn07aWYoaXNWYWxpZFZhbHVlKHNpbmdsZXRvbikpe3NoYXJlQ29uZmlnLnNpbmdsZXRvbj1zaW5nbGV0b259aWYoaXNWYWxpZFZhbHVlKHJlcXVpcmVkVmVyc2lvbikpe3NoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbj1yZXF1aXJlZFZlcnNpb259aWYoaXNWYWxpZFZhbHVlKGVhZ2VyKSl7c2hhcmVDb25maWcuZWFnZXI9ZWFnZXJ9aWYoaXNWYWxpZFZhbHVlKHN0cmljdFZlcnNpb24pKXtzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uPXN0cmljdFZlcnNpb259Y29uc3Qgb3B0aW9ucz17dmVyc2lvbixzY29wZTpbc2NvcGVdLHNoYXJlQ29uZmlnLGdldDpmYWN0b3J5fTtpZihzaGFyZWRbbmFtZV0pe3NoYXJlZFtuYW1lXS5wdXNoKG9wdGlvbnMpfWVsc2V7c2hhcmVkW25hbWVdPVtvcHRpb25zXX19fX1yZXR1cm4gc2hhcmVkfSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKHJlbW90ZT0+cmVtb3RlLmV4dGVybmFsVHlwZT09PVxcXCJzY3JpcHRcXFwiKSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJwbHVnaW5zXFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJidW5kbGVyUnVudGltZU9wdGlvbnNcXFwiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJjaHVua01hcHBpbmdcXFwiLCgpPT5yZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1xcXCIsKCk9Pntjb25zdCByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZz17fTtmb3IobGV0W21vZHVsZUlkLGRhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtyZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ1ttb2R1bGVJZF09W2RhdGEuc2hhcmVTY29wZSxkYXRhLm5hbWUsZGF0YS5leHRlcm5hbE1vZHVsZUlkLGRhdGEucmVtb3RlTmFtZV19cmV0dXJuIHJlbW90ZXNMb2FkaW5nSWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJ3ZWJwYWNrUmVxdWlyZVxcXCIsKCk9Pl9fd2VicGFja19yZXF1aXJlX18pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiaWRUb1JlbW90ZU1hcFxcXCIsKCk9Pntjb25zdCBpZFRvUmVtb3RlTWFwPXt9O2ZvcihsZXRbaWQscmVtb3RlRGF0YV1vZiBPYmplY3QuZW50cmllcyhyZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykpe2NvbnN0IGluZm89X19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfX1tyZW1vdGVEYXRhLnJlbW90ZU5hbWVdO2lmKGluZm8paWRUb1JlbW90ZU1hcFtpZF09aW5mb31yZXR1cm4gaWRUb1JlbW90ZU1hcH0pO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcIlNcXFwiLF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtpZihfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyl9b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLFxcXCJyZW1vdGVzXFxcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpyZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyxpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsaWRUb1JlbW90ZU1hcDpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb1JlbW90ZU1hcCx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcXFwiY29uc3VtZXNcXFwiLChjaHVua0lkLHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmNvbnN1bWVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmcsbW9kdWxlVG9IYW5kbGVyTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZyxpbnN0YWxsZWRNb2R1bGVzOmNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJJXFxcIiwobmFtZSxpbml0U2NvcGUpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuSSh7c2hhcmVTY29wZU5hbWU6bmFtZSxpbml0U2NvcGUsaW5pdFByb21pc2VzOmluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzLGluaXRUb2tlbnM6aW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcXFwiaW5pdENvbnRhaW5lclxcXCIsKHNoYXJlU2NvcGUsaW5pdFNjb3BlLHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5pdENvbnRhaW5lckVudHJ5KHtzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zLHNoYXJlU2NvcGVLZXk6Y29udGFpbmVyU2hhcmVTY29wZSx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcImdldENvbnRhaW5lclxcXCIsKG1vZHVsZTEsZ2V0U2NvcGUpPT57dmFyIG1vZHVsZU1hcD1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YS5tb2R1bGVNYXA7X193ZWJwYWNrX3JlcXVpcmVfXy5SPWdldFNjb3BlO2dldFNjb3BlPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2R1bGVNYXAsbW9kdWxlMSk/bW9kdWxlTWFwW21vZHVsZTFdKCk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKT0+e3Rocm93IG5ldyBFcnJvcignTW9kdWxlIFxcXCInK21vZHVsZTErJ1xcXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5SPXVuZGVmaW5lZDtyZXR1cm4gZ2V0U2NvcGV9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5zdGFuY2U9X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyLmluaXRpYWxDb25zdW1lcyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe3dlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX18saW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLGluaXRpYWxDb25zdW1lczpfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmd9KX19XCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXFxcbiAgISoqKiBAbW9kdWxlLWZlZGVyYXRpb24vcnVudGltZS9yc3BhY2suanMhPSFkYXRhOnRleHQvamF2YXNjcmlwdCxpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyBmcm9tIFwiL2hvbWUvcm9jay93b3Jrc3BhY2UvYm9pbGVycGxhdGUvdHJhdmVscy9ub2RlX21vZHVsZXMvQG1vZHVsZS1mZWRlcmF0aW9uL3dlYnBhY2stYnVuZGxlci1ydW50aW1lL2Rpc3QvaW5kZXguY2pzLmpzXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fIGZyb20gXCIvaG9tZS9yb2NrL3dvcmtzcGFjZS9ib2lsZXJwbGF0ZS90cmF2ZWxzL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanNcIjtpbXBvcnQgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbl8xX18gZnJvbSBcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3RyYXZlbHMvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyA9IFtfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzBfXygpLCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luXzFfXygpXTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fID0ge307Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fID0gXCJ0cmF2ZWxzXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fID0gXCJsb2FkZWQtZmlyc3RcIjtpZigoX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGF8fF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhKSYmX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uKXt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExLF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTI7Y29uc3Qgb3ZlcnJpZGU9KG9iaixrZXksdmFsdWUpPT57aWYoIW9iailyZXR1cm47aWYob2JqW2tleV0pb2JqW2tleV09dmFsdWV9O2NvbnN0IG1lcmdlPShvYmosa2V5LGZuKT0+e2NvbnN0IHZhbHVlPWZuKCk7aWYoQXJyYXkuaXNBcnJheSh2YWx1ZSkpe3ZhciBfb2JqLF9rZXk7dmFyIF87KF89KF9vYmo9b2JqKVtfa2V5PWtleV0pIT09bnVsbCYmXyE9PXZvaWQgMD9fOl9vYmpbX2tleV09W107b2JqW2tleV0ucHVzaCguLi52YWx1ZSl9ZWxzZSBpZih0eXBlb2YgdmFsdWU9PT1cIm9iamVjdFwiJiZ2YWx1ZSE9PW51bGwpe3ZhciBfb2JqMSxfa2V5MTt2YXIgXzE7KF8xPShfb2JqMT1vYmopW19rZXkxPWtleV0pIT09bnVsbCYmXzEhPT12b2lkIDA/XzE6X29iajFbX2tleTFdPXt9O09iamVjdC5hc3NpZ24ob2JqW2tleV0sdmFsdWUpfX07Y29uc3QgZWFybHk9KG9iaixrZXksaW5pdGlhbCk9Pnt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPWluaXRpYWwoKX07dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCByZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZztjb25zdCByZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9X193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEubW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZyE9PXZvaWQgMD9fX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc7Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVTaGFyaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGEuc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLmNodW5rTWFwcGluZykhPT1udWxsJiZfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc6e307dmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nO2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZz0oX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMT09PXZvaWQgMD92b2lkIDA6X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nOnt9O2NvbnN0IGNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXM9e307Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdJbml0UHJvbWlzZXM9W107Y29uc3QgaW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zPXt9O2NvbnN0IGNvbnRhaW5lclNoYXJlU2NvcGU9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YS5zaGFyZVNjb3BlO2Zvcihjb25zdCBrZXkgaW4gX19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfXyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uW2tleV09X19tb2R1bGVfZmVkZXJhdGlvbl9idW5kbGVyX3J1bnRpbWVfX1trZXldfWVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbixcImNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdcIiwoKT0+e2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nKSl7Y29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1ttb2R1bGVJZF09e2dldHRlcjpkYXRhLmZhbGxiYWNrLHNoYXJlSW5mbzp7c2hhcmVDb25maWc6e2ZpeGVkRGVwZW5kZW5jaWVzOmZhbHNlLHJlcXVpcmVkVmVyc2lvbjpkYXRhLnJlcXVpcmVkVmVyc2lvbixzdHJpY3RWZXJzaW9uOmRhdGEuc3RyaWN0VmVyc2lvbixzaW5nbGV0b246ZGF0YS5zaW5nbGV0b24sZWFnZXI6ZGF0YS5lYWdlcn0sc2NvcGU6W2RhdGEuc2hhcmVTY29wZV19LHNoYXJlS2V5OmRhdGEuc2hhcmVLZXl9fXJldHVybiBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFwiaW5pdE9wdGlvbnNcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFwibmFtZVwiLCgpPT5fX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18pO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcInNoYXJlU3RyYXRlZ3lcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXCJzaGFyZWRcIiwoKT0+e2NvbnN0IHNoYXJlZD17fTtmb3IobGV0W3Njb3BlLHN0YWdlc11vZiBPYmplY3QuZW50cmllcyhpbml0aWFsaXplU2hhcmluZ1Njb3BlVG9Jbml0RGF0YU1hcHBpbmcpKXtmb3IobGV0IHN0YWdlIG9mIHN0YWdlcyl7aWYodHlwZW9mIHN0YWdlPT09XCJvYmplY3RcIiYmc3RhZ2UhPT1udWxsKXtjb25zdHtuYW1lLHZlcnNpb24sZmFjdG9yeSxlYWdlcixzaW5nbGV0b24scmVxdWlyZWRWZXJzaW9uLHN0cmljdFZlcnNpb259PXN0YWdlO2NvbnN0IHNoYXJlQ29uZmlnPXt9O2NvbnN0IGlzVmFsaWRWYWx1ZT1mdW5jdGlvbih2YWwpe3JldHVybiB0eXBlb2YgdmFsIT09XCJ1bmRlZmluZWRcIn07aWYoaXNWYWxpZFZhbHVlKHNpbmdsZXRvbikpe3NoYXJlQ29uZmlnLnNpbmdsZXRvbj1zaW5nbGV0b259aWYoaXNWYWxpZFZhbHVlKHJlcXVpcmVkVmVyc2lvbikpe3NoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbj1yZXF1aXJlZFZlcnNpb259aWYoaXNWYWxpZFZhbHVlKGVhZ2VyKSl7c2hhcmVDb25maWcuZWFnZXI9ZWFnZXJ9aWYoaXNWYWxpZFZhbHVlKHN0cmljdFZlcnNpb24pKXtzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uPXN0cmljdFZlcnNpb259Y29uc3Qgb3B0aW9ucz17dmVyc2lvbixzY29wZTpbc2NvcGVdLHNoYXJlQ29uZmlnLGdldDpmYWN0b3J5fTtpZihzaGFyZWRbbmFtZV0pe3NoYXJlZFtuYW1lXS5wdXNoKG9wdGlvbnMpfWVsc2V7c2hhcmVkW25hbWVdPVtvcHRpb25zXX19fX1yZXR1cm4gc2hhcmVkfSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFwicmVtb3Rlc1wiLCgpPT5PYmplY3QudmFsdWVzKF9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX18pLmZsYXQoKS5maWx0ZXIocmVtb3RlPT5yZW1vdGUuZXh0ZXJuYWxUeXBlPT09XCJzY3JpcHRcIikpO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcInBsdWdpbnNcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFwiYnVuZGxlclJ1bnRpbWVPcHRpb25zXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMsXCJyZW1vdGVzXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcImNodW5rTWFwcGluZ1wiLCgpPT5yZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFwiaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdcIiwoKT0+e2NvbnN0IHJlbW90ZXNMb2FkaW5nSWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdNYXBwaW5nPXt9O2ZvcihsZXRbbW9kdWxlSWQsZGF0YV1vZiBPYmplY3QuZW50cmllcyhyZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykpe3JlbW90ZXNMb2FkaW5nSWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdNYXBwaW5nW21vZHVsZUlkXT1bZGF0YS5zaGFyZVNjb3BlLGRhdGEubmFtZSxkYXRhLmV4dGVybmFsTW9kdWxlSWQsZGF0YS5yZW1vdGVOYW1lXX1yZXR1cm4gcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmd9KTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsXCJ3ZWJwYWNrUmVxdWlyZVwiLCgpPT5fX3dlYnBhY2tfcmVxdWlyZV9fKTttZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsXCJpZFRvUmVtb3RlTWFwXCIsKCk9Pntjb25zdCBpZFRvUmVtb3RlTWFwPXt9O2ZvcihsZXRbaWQscmVtb3RlRGF0YV1vZiBPYmplY3QuZW50cmllcyhyZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykpe2NvbnN0IGluZm89X19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfX1tyZW1vdGVEYXRhLnJlbW90ZU5hbWVdO2lmKGluZm8paWRUb1JlbW90ZU1hcFtpZF09aW5mb31yZXR1cm4gaWRUb1JlbW90ZU1hcH0pO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXCJTXCIsX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLlMpO2lmKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5hdHRhY2hTaGFyZVNjb3BlTWFwKXtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcChfX3dlYnBhY2tfcmVxdWlyZV9fKX1vdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLmYsXCJyZW1vdGVzXCIsKGNodW5rSWQscHJvbWlzZXMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUucmVtb3Rlcyh7Y2h1bmtJZCxwcm9taXNlcyxjaHVua01hcHBpbmc6cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcsaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nLGlkVG9SZW1vdGVNYXA6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9SZW1vdGVNYXAsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLmYsXCJjb25zdW1lc1wiLChjaHVua0lkLHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmNvbnN1bWVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmcsbW9kdWxlVG9IYW5kbGVyTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZyxpbnN0YWxsZWRNb2R1bGVzOmNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFwiSVwiLChuYW1lLGluaXRTY29wZSk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5JKHtzaGFyZVNjb3BlTmFtZTpuYW1lLGluaXRTY29wZSxpbml0UHJvbWlzZXM6aW5pdGlhbGl6ZVNoYXJpbmdJbml0UHJvbWlzZXMsaW5pdFRva2Vuczppbml0aWFsaXplU2hhcmluZ0luaXRUb2tlbnMsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFwiaW5pdENvbnRhaW5lclwiLChzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluaXRDb250YWluZXJFbnRyeSh7c2hhcmVTY29wZSxpbml0U2NvcGUscmVtb3RlRW50cnlJbml0T3B0aW9ucyxzaGFyZVNjb3BlS2V5OmNvbnRhaW5lclNoYXJlU2NvcGUsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFwiZ2V0Q29udGFpbmVyXCIsKG1vZHVsZTEsZ2V0U2NvcGUpPT57dmFyIG1vZHVsZU1hcD1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YS5tb2R1bGVNYXA7X193ZWJwYWNrX3JlcXVpcmVfXy5SPWdldFNjb3BlO2dldFNjb3BlPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2R1bGVNYXAsbW9kdWxlMSk/bW9kdWxlTWFwW21vZHVsZTFdKCk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKT0+e3Rocm93IG5ldyBFcnJvcignTW9kdWxlIFwiJyttb2R1bGUxKydcIiBkb2VzIG5vdCBleGlzdCBpbiBjb250YWluZXIuJyl9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLlI9dW5kZWZpbmVkO3JldHVybiBnZXRTY29wZX0pO19fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbnN0YW5jZT1fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24ucnVudGltZS5pbml0KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyk7aWYoKF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTI9X193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTI9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YTIuaW5pdGlhbENvbnN1bWVzKXtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5zdGFsbEluaXRpYWxDb25zdW1lcyh7d2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfXyxpbnN0YWxsZWRNb2R1bGVzOmNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMsaW5pdGlhbENvbnN1bWVzOl9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YS5pbml0aWFsQ29uc3VtZXMsbW9kdWxlVG9IYW5kbGVyTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ30pfX0gKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4oZnVuY3Rpb24gKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gICAgdmFsdWU6IHRydWVcbn0pKTtcbnZhciBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAc3djL2hlbHBlcnMvXy9faW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5janNcIik7XG52YXIgX3NsaWNlZF90b19hcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBzd2MvaGVscGVycy9fL19zbGljZWRfdG9fYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL19zbGljZWRfdG9fYXJyYXkuY2pzXCIpO1xudmFyIF90b19jb25zdW1hYmxlX2FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHN3Yy9oZWxwZXJzL18vX3RvX2NvbnN1bWFibGVfYXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9Ac3djL2hlbHBlcnMvY2pzL190b19jb25zdW1hYmxlX2FycmF5LmNqc1wiKTtcbnZhciBfaW5kZXhjanMgPSAvKiNfX1BVUkVfXyovIF9pbnRlcm9wX3JlcXVpcmVfZGVmYXVsdC5fKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1wiKSk7XG52YXIgX3Jlc29sdmVycGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9yZXNvbHZlci1wbHVnaW4uanNcIikpO1xudmFyIF9jb3JlcGx1Z2luID0gLyojX19QVVJFX18qLyBfaW50ZXJvcF9yZXF1aXJlX2RlZmF1bHQuXyhfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9AY2FsbHN0YWNrL3JlcGFjay9tZi9jb3JlLXBsdWdpbi5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzXCIpKTtcbnZhciBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luc19fID0gW1xuICAgICgwLCBfcmVzb2x2ZXJwbHVnaW4uZGVmYXVsdCkoKSxcbiAgICAoMCwgX2NvcmVwbHVnaW4uZGVmYXVsdCkoKVxuXTtcbnZhciBfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fID0ge307XG52YXIgX19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fID0gXCJ0cmF2ZWxzXCI7XG52YXIgX19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fID0gXCJsb2FkZWQtZmlyc3RcIjtcbmlmICgoX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEgfHwgX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpICYmIF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbikge1xuICAgIHZhciBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YSwgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGExLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLCBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMjtcbiAgICB2YXIgb3ZlcnJpZGUgPSAob2JqLCBrZXksIHZhbHVlKT0+e1xuICAgICAgICBpZiAoIW9iaikgcmV0dXJuO1xuICAgICAgICBpZiAob2JqW2tleV0pIG9ialtrZXldID0gdmFsdWU7XG4gICAgfTtcbiAgICB2YXIgbWVyZ2UgPSAob2JqLCBrZXksIGZuKT0+e1xuICAgICAgICB2YXIgdmFsdWUgPSBmbigpO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHZhciBfb2JqX2tleTtcbiAgICAgICAgICAgIHZhciBfb2JqLCBfa2V5O1xuICAgICAgICAgICAgdmFyIF87XG4gICAgICAgICAgICAoXyA9IChfb2JqID0gb2JqKVtfa2V5ID0ga2V5XSkgIT09IG51bGwgJiYgXyAhPT0gdm9pZCAwID8gXyA6IF9vYmpbX2tleV0gPSBbXTtcbiAgICAgICAgICAgIChfb2JqX2tleSA9IG9ialtrZXldKS5wdXNoLmFwcGx5KF9vYmpfa2V5LCBfdG9fY29uc3VtYWJsZV9hcnJheS5fKHZhbHVlKSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgX29iajEsIF9rZXkxO1xuICAgICAgICAgICAgdmFyIF8xO1xuICAgICAgICAgICAgKF8xID0gKF9vYmoxID0gb2JqKVtfa2V5MSA9IGtleV0pICE9PSBudWxsICYmIF8xICE9PSB2b2lkIDAgPyBfMSA6IF9vYmoxW19rZXkxXSA9IHt9O1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihvYmpba2V5XSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgZWFybHkgPSAob2JqLCBrZXksIGluaXRpYWwpPT57XG4gICAgICAgIHZhciBfb2JqLCBfa2V5O1xuICAgICAgICB2YXIgXztcbiAgICAgICAgKF8gPSAoX29iaiA9IG9iailbX2tleSA9IGtleV0pICE9PSBudWxsICYmIF8gIT09IHZvaWQgMCA/IF8gOiBfb2JqW19rZXldID0gaW5pdGlhbCgpO1xuICAgIH07XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztcbiAgICB2YXIgcmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5yZW1vdGVzTG9hZGluZ0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZyAhPT0gdm9pZCAwID8gX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZztcbiAgICB2YXIgcmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcgPSAoX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSA9IF9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZyAhPT0gdm9pZCAwID8gX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc7XG4gICAgdmFyIGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSAhPT0gbnVsbCAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YV9zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc7XG4gICAgdmFyIGNvbnN1bWVzTG9hZGluZ0NodW5rTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nID0gKF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YSA9IF9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSAhPT0gbnVsbCAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIDoge307XG4gICAgdmFyIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nO1xuICAgIHZhciBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0NvbnN1bWVEYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExID0gX193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhKSA9PT0gbnVsbCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpICE9PSBudWxsICYmIF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nICE9PSB2b2lkIDAgPyBfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb0NvbnN1bWVEYXRhTWFwcGluZyA6IHt9O1xuICAgIHZhciBjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzID0ge307XG4gICAgdmFyIGluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzID0gW107XG4gICAgdmFyIGluaXRpYWxpemVTaGFyaW5nSW5pdFRva2VucyA9IHt9O1xuICAgIHZhciBjb250YWluZXJTaGFyZVNjb3BlID0gKF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpID09PSBudWxsIHx8IF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YS5zaGFyZVNjb3BlO1xuICAgIGZvcih2YXIga2V5IGluIF9pbmRleGNqcy5kZWZhdWx0KXtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uW2tleV0gPSBfaW5kZXhjanMuZGVmYXVsdFtrZXldO1xuICAgIH1cbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24sIFwiY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1wiLCAoKT0+e1xuICAgICAgICB2YXIgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZyA9IHt9O1xuICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMoY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmcpKXtcbiAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMiksIG1vZHVsZUlkID0gX3JlZlswXSwgZGF0YSA9IF9yZWZbMV07XG4gICAgICAgICAgICBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nW21vZHVsZUlkXSA9IHtcbiAgICAgICAgICAgICAgICBnZXR0ZXI6IGRhdGEuZmFsbGJhY2ssXG4gICAgICAgICAgICAgICAgc2hhcmVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZERlcGVuZGVuY2llczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZFZlcnNpb246IGRhdGEucmVxdWlyZWRWZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaWN0VmVyc2lvbjogZGF0YS5zdHJpY3RWZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2luZ2xldG9uOiBkYXRhLnNpbmdsZXRvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGVhZ2VyOiBkYXRhLmVhZ2VyXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnNoYXJlU2NvcGVcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2hhcmVLZXk6IGRhdGEuc2hhcmVLZXlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmc7XG4gICAgfSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLCBcImluaXRPcHRpb25zXCIsICgpPT4oe30pKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwibmFtZVwiLCAoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9jb250YWluZXJfbmFtZV9fKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwic2hhcmVTdHJhdGVneVwiLCAoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fKTtcbiAgICBlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwic2hhcmVkXCIsICgpPT57XG4gICAgICAgIHZhciBzaGFyZWQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgcmVmIG9mIE9iamVjdC5lbnRyaWVzKGluaXRpYWxpemVTaGFyaW5nU2NvcGVUb0luaXREYXRhTWFwcGluZykpe1xuICAgICAgICAgICAgdmFyIF9yZWYgPSBfc2xpY2VkX3RvX2FycmF5Ll8ocmVmLCAyKSwgc2NvcGUgPSBfcmVmWzBdLCBzdGFnZXMgPSBfcmVmWzFdO1xuICAgICAgICAgICAgZm9yICh2YXIgc3RhZ2Ugb2Ygc3RhZ2VzKXtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0YWdlID09PSBcIm9iamVjdFwiICYmIHN0YWdlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gc3RhZ2UubmFtZSwgdmVyc2lvbiA9IHN0YWdlLnZlcnNpb24sIGZhY3RvcnkgPSBzdGFnZS5mYWN0b3J5LCBlYWdlciA9IHN0YWdlLmVhZ2VyLCBzaW5nbGV0b24gPSBzdGFnZS5zaW5nbGV0b24sIHJlcXVpcmVkVmVyc2lvbiA9IHN0YWdlLnJlcXVpcmVkVmVyc2lvbiwgc3RyaWN0VmVyc2lvbiA9IHN0YWdlLnN0cmljdFZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaGFyZUNvbmZpZyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNWYWxpZFZhbHVlID0gZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbCAhPT0gXCJ1bmRlZmluZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShzaW5nbGV0b24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUNvbmZpZy5zaW5nbGV0b24gPSBzaW5nbGV0b247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShyZXF1aXJlZFZlcnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZUNvbmZpZy5yZXF1aXJlZFZlcnNpb24gPSByZXF1aXJlZFZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShlYWdlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnLmVhZ2VyID0gZWFnZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRWYWx1ZShzdHJpY3RWZXJzaW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVDb25maWcuc3RyaWN0VmVyc2lvbiA9IHN0cmljdFZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZVxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0OiBmYWN0b3J5XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGFyZWRbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZFtuYW1lXS5wdXNoKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkW25hbWVdID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNoYXJlZDtcbiAgICB9KTtcbiAgICBtZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsIFwicmVtb3Rlc1wiLCAoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKChyZW1vdGUpPT5yZW1vdGUuZXh0ZXJuYWxUeXBlID09PSBcInNjcmlwdFwiKSk7XG4gICAgbWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLCBcInBsdWdpbnNcIiwgKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5zX18pO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbiwgXCJidW5kbGVyUnVudGltZU9wdGlvbnNcIiwgKCk9Pih7fSkpO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMsIFwicmVtb3Rlc1wiLCAoKT0+KHt9KSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLCBcImNodW5rTWFwcGluZ1wiLCAoKT0+cmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcpO1xuICAgIGVhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcywgXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1wiLCAoKT0+e1xuICAgICAgICB2YXIgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmcgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgcmVmIG9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nKSl7XG4gICAgICAgICAgICB2YXIgX3JlZiA9IF9zbGljZWRfdG9fYXJyYXkuXyhyZWYsIDIpLCBtb2R1bGVJZCA9IF9yZWZbMF0sIGRhdGEgPSBfcmVmWzFdO1xuICAgICAgICAgICAgcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmdbbW9kdWxlSWRdID0gW1xuICAgICAgICAgICAgICAgIGRhdGEuc2hhcmVTY29wZSxcbiAgICAgICAgICAgICAgICBkYXRhLm5hbWUsXG4gICAgICAgICAgICAgICAgZGF0YS5leHRlcm5hbE1vZHVsZUlkLFxuICAgICAgICAgICAgICAgIGRhdGEucmVtb3RlTmFtZVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVtb3Rlc0xvYWRpbmdJZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ01hcHBpbmc7XG4gICAgfSk7XG4gICAgZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLCBcIndlYnBhY2tSZXF1aXJlXCIsICgpPT5fX3dlYnBhY2tfcmVxdWlyZV9fKTtcbiAgICBtZXJnZShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMsIFwiaWRUb1JlbW90ZU1hcFwiLCAoKT0+e1xuICAgICAgICB2YXIgaWRUb1JlbW90ZU1hcCA9IHt9O1xuICAgICAgICBmb3IgKHZhciByZWYgb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtcbiAgICAgICAgICAgIHZhciBfcmVmID0gX3NsaWNlZF90b19hcnJheS5fKHJlZiwgMiksIGlkID0gX3JlZlswXSwgcmVtb3RlRGF0YSA9IF9yZWZbMV07XG4gICAgICAgICAgICB2YXIgaW5mbyA9IF9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX19bcmVtb3RlRGF0YS5yZW1vdGVOYW1lXTtcbiAgICAgICAgICAgIGlmIChpbmZvKSBpZFRvUmVtb3RlTWFwW2lkXSA9IGluZm87XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlkVG9SZW1vdGVNYXA7XG4gICAgfSk7XG4gICAgb3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXywgXCJTXCIsIF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtcbiAgICBpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXApIHtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4gICAgfVxuICAgIG92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZiwgXCJyZW1vdGVzXCIsIChjaHVua0lkLCBwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtcbiAgICAgICAgICAgIGNodW5rSWQsXG4gICAgICAgICAgICBwcm9taXNlcyxcbiAgICAgICAgICAgIGNodW5rTWFwcGluZzogcmVtb3Rlc0xvYWRpbmdDaHVua01hcHBpbmcsXG4gICAgICAgICAgICBpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nLFxuICAgICAgICAgICAgaWRUb1JlbW90ZU1hcDogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLmlkVG9SZW1vdGVNYXAsXG4gICAgICAgICAgICB3ZWJwYWNrUmVxdWlyZTogX193ZWJwYWNrX3JlcXVpcmVfX1xuICAgICAgICB9KSk7XG4gICAgb3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLCBcImNvbnN1bWVzXCIsIChjaHVua0lkLCBwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5jb25zdW1lcyh7XG4gICAgICAgICAgICBjaHVua0lkLFxuICAgICAgICAgICAgcHJvbWlzZXMsXG4gICAgICAgICAgICBjaHVua01hcHBpbmc6IGNvbnN1bWVzTG9hZGluZ0NodW5rTWFwcGluZyxcbiAgICAgICAgICAgIG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6IF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5jb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nLFxuICAgICAgICAgICAgaW5zdGFsbGVkTW9kdWxlczogY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcyxcbiAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlOiBfX3dlYnBhY2tfcmVxdWlyZV9fXG4gICAgICAgIH0pKTtcbiAgICBvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLCBcIklcIiwgKG5hbWUsIGluaXRTY29wZSk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5JKHtcbiAgICAgICAgICAgIHNoYXJlU2NvcGVOYW1lOiBuYW1lLFxuICAgICAgICAgICAgaW5pdFNjb3BlLFxuICAgICAgICAgICAgaW5pdFByb21pc2VzOiBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcyxcbiAgICAgICAgICAgIGluaXRUb2tlbnM6IGluaXRpYWxpemVTaGFyaW5nSW5pdFRva2VucyxcbiAgICAgICAgICAgIHdlYnBhY2tSZXF1aXJlOiBfX3dlYnBhY2tfcmVxdWlyZV9fXG4gICAgICAgIH0pKTtcbiAgICBvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLCBcImluaXRDb250YWluZXJcIiwgKHNoYXJlU2NvcGUsIGluaXRTY29wZSwgcmVtb3RlRW50cnlJbml0T3B0aW9ucyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5pbml0Q29udGFpbmVyRW50cnkoe1xuICAgICAgICAgICAgc2hhcmVTY29wZSxcbiAgICAgICAgICAgIGluaXRTY29wZSxcbiAgICAgICAgICAgIHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMsXG4gICAgICAgICAgICBzaGFyZVNjb3BlS2V5OiBjb250YWluZXJTaGFyZVNjb3BlLFxuICAgICAgICAgICAgd2VicGFja1JlcXVpcmU6IF9fd2VicGFja19yZXF1aXJlX19cbiAgICAgICAgfSkpO1xuICAgIG92ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sIFwiZ2V0Q29udGFpbmVyXCIsIChtb2R1bGUxLCBnZXRTY29wZSk9PntcbiAgICAgICAgdmFyIG1vZHVsZU1hcCA9IF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZUV4cG9zZXNEYXRhLm1vZHVsZU1hcDtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5SID0gZ2V0U2NvcGU7XG4gICAgICAgIGdldFNjb3BlID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZHVsZU1hcCwgbW9kdWxlMSkgPyBtb2R1bGVNYXBbbW9kdWxlMV0oKSA6IFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCk9PntcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTW9kdWxlIFwiJyArIG1vZHVsZTEgKyAnXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpO1xuICAgICAgICB9KTtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5SID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gZ2V0U2NvcGU7XG4gICAgfSk7XG4gICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluc3RhbmNlID0gX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO1xuICAgIGlmICgoX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMiA9IF9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSkgPT09IG51bGwgfHwgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMi5pbml0aWFsQ29uc3VtZXMpIHtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe1xuICAgICAgICAgICAgd2VicGFja1JlcXVpcmU6IF9fd2VicGFja19yZXF1aXJlX18sXG4gICAgICAgICAgICBpbnN0YWxsZWRNb2R1bGVzOiBjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLFxuICAgICAgICAgICAgaW5pdGlhbENvbnN1bWVzOiBfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLFxuICAgICAgICAgICAgbW9kdWxlVG9IYW5kbGVyTWFwcGluZzogX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmdcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5cbn0pLFxuXCJ3ZWJwYWNrL2NvbnRhaW5lci9lbnRyeS90cmF2ZWxzXCI6IFxuLyohKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogY29udGFpbmVyIGVudHJ5ICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKi9cbihmdW5jdGlvbiAoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblwidXNlIHN0cmljdFwiO1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoZXhwb3J0cywge1xuXHRnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5nZXRDb250YWluZXI7IH0sXG5cdGluaXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0Q29udGFpbmVyOyB9XG59KTtcblxufSksXG5cbn0pO1xuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG52YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcbmlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xucmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xufVxuLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbnZhciBtb2R1bGUgPSAoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcbmlkOiBtb2R1bGVJZCxcbmxvYWRlZDogZmFsc2UsXG5leHBvcnRzOiB7fVxufSk7XG4vLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbl9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4vLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG5tb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5yZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG5cbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX187XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vLyBtb2R1bGVfZmVkZXJhdGlvbi9ydW50aW1lXG4hZnVuY3Rpb24oKSB7XG5cbmlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24pe1xuICAgIF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbiA9IHtcbiAgICAgICAgXG5jaHVua01hdGNoZXI6IGZ1bmN0aW9uKGNodW5rSWQpIHtcbiAgICByZXR1cm4gIS9eKFxcLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3RcXC1fKDhjN2F8ZmE4Yyl8d2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdFxcLW5hdGl2ZV8oYXNzZXRzXFwtcmVnaXN0cnlfKHBhdGhcXC1zdXBwb3J0X3JlYWN0XFwtbmF0aXZlX2Fzc2V0c1xcLTM1ZjE1NHxyZWdpc3RyeV9yZWFjdFxcLW5hdGl2ZV9hc3NldHNcXC1yZWdcXC01ZDFlYWUpfExpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbFxcLTk2YTY5Nnxub3JtYWxpemVcXC1jb2xvcnNfcmVhY3RcXC1uYXRpdmVfbm9ybWFsaXplXFwtY29sb3JzfHJlYWN0XFwtbmF0aXZlfHNyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc1xcLWZkMzA5MHx2aXJ0dWFsaXplZFxcLWxpc3RzX3JlYWN0XFwtbmF0aXZlX3ZpcnR1YWxpemVkXFwtbGlzdHNcXC1mNjEzNzkpKSQvLnRlc3QoY2h1bmtJZCk7XG59LFxucm9vdE91dHB1dERpcjogXCJcIixcblxuICAgIH07XG59XG5cbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9kZWZpbmVfcHJvcGVydHlfZ2V0dGVyc1xuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgZGVmaW5pdGlvbikge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG4gICAgICAgIGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcbiAgICAgICAgfVxuICAgIH1cbn07XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvZW5zdXJlX2NodW5rXG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmYgPSB7fTtcbi8vIFRoaXMgZmlsZSBjb250YWlucyBvbmx5IHRoZSBlbnRyeSBjaHVuay5cbi8vIFRoZSBjaHVuayBsb2FkaW5nIGZ1bmN0aW9uIGZvciBhZGRpdGlvbmFsIGNodW5rc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5lID0gZnVuY3Rpb24oY2h1bmtJZCkge1xuXHRyZXR1cm4gUHJvbWlzZS5hbGwoXG5cdFx0T2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5mKS5yZWR1Y2UoZnVuY3Rpb24ocHJvbWlzZXMsIGtleSkge1xuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5mW2tleV0oY2h1bmtJZCwgcHJvbWlzZXMpO1xuXHRcdFx0cmV0dXJuIHByb21pc2VzO1xuXHRcdH0sIFtdKVxuXHQpO1xufTtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9nZXQgamF2YXNjcmlwdCBjaHVuayBmaWxlbmFtZVxuIWZ1bmN0aW9uKCkge1xuLy8gVGhpcyBmdW5jdGlvbiBhbGxvdyB0byByZWZlcmVuY2UgY2h1bmtzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnUgPSBmdW5jdGlvbihjaHVua0lkKSB7XG4gIC8vIHJldHVybiB1cmwgZm9yIGZpbGVuYW1lcyBub3QgYmFzZWQgb24gdGVtcGxhdGVcbiAgXG4gIC8vIHJldHVybiB1cmwgZm9yIGZpbGVuYW1lcyBiYXNlZCBvbiB0ZW1wbGF0ZVxuICByZXR1cm4gXCJcIiArIGNodW5rSWQgKyBcIi5jaHVuay5idW5kbGVcIlxufVxufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2dsb2JhbFxuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9oYXNfb3duX3Byb3BlcnR5XG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmosIHByb3ApIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApOyB9XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvbG9hZF9zY3JpcHRcbiFmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gbG9hZFNjcmlwdEhhbmRsZXIobmFtZSwgY2FsbGVyLCBkb25lLCByZWZlcmVuY2VVcmwpIHtcbiAgICBpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5yZXBhY2suc2hhcmVkLnNjcmlwdE1hbmFnZXIpIHtcbiAgICAgIF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyLmxvYWRTY3JpcHQobmFtZSwgY2FsbGVyLCBfX3dlYnBhY2tfcmVxdWlyZV9fLCByZWZlcmVuY2VVcmwpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBkb25lKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW1JlcGFja1J1bnRpbWVdIExvYWRpbmcgc2NyaXB0IGZhaWxlZDonLCByZWFzb24pO1xuICAgICAgICBkb25lKHtcbiAgICAgICAgICB0eXBlOiAnZXhlYycsXG4gICAgICAgICAgdGFyZ2V0OiB7XG4gICAgICAgICAgICBzcmM6IG5hbWVcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZXBhY2tSdW50aW1lXSBTY3JpcHQgbWFuYWdlciB3YXMgbm90IHByb3ZpZGVkJyk7XG4gICAgICBkb25lKHtcbiAgICAgICAgdHlwZTogJ2V4ZWMnLFxuICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICBzcmM6IG5hbWVcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGxvYWRIb3RVcGRhdGVIYW5kbGVyKHVybCwgZG9uZSkge1xuICAgIGlmICghZmFsc2UpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZXBhY2tSdW50aW1lXSBMb2FkaW5nIEhNUiB1cGRhdGUgY2h1bmtzIGlzIGRpc2FibGVkJyk7XG4gICAgICBkb25lKHtcbiAgICAgICAgdHlwZTogJ2Rpc2FibGVkJyxcbiAgICAgICAgdGFyZ2V0OiB7XG4gICAgICAgICAgc3JjOiB1cmxcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGZldGNoKHVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW1JlcGFja1J1bnRpbWVdIExvYWRpbmcgSE1SIHVwZGF0ZSBmYWlsZWQ6JywgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG4gICAgICAgIGRvbmUoe1xuICAgICAgICAgIHR5cGU6IHJlc3BvbnNlLnN0YXR1c1RleHQsXG4gICAgICAgICAgdGFyZ2V0OiB7XG4gICAgICAgICAgICBzcmM6IHVybFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7XG4gICAgfSkudGhlbihmdW5jdGlvbiAoc2NyaXB0KSB7XG4gICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgIGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQuc2NyaXB0TWFuYWdlcikge1xuICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18ucmVwYWNrLnNoYXJlZC5zY3JpcHRNYW5hZ2VyLnVuc3RhYmxlX2V2YWx1YXRlU2NyaXB0KHNjcmlwdCwgdXJsKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBldmFsKHNjcmlwdCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbUmVwYWNrUnVudGltZV0gTG9hZGluZyBITVIgdXBkYXRlIGNodW5rIGZhaWxlZDonLCByZWFzb24pO1xuICAgICAgZG9uZSh7XG4gICAgICAgIHR5cGU6ICdleGVjJyxcbiAgICAgICAgdGFyZ2V0OiB7XG4gICAgICAgICAgc3JjOiB1cmxcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgX193ZWJwYWNrX3JlcXVpcmVfXy5sID0gZnVuY3Rpb24gbG9hZFNjcmlwdCh1cmwsIGRvbmUsIGtleSwgY2h1bmtJZCkge1xuICAgIGlmIChrZXkgJiYgY2h1bmtJZCkge1xuICAgICAgbG9hZFNjcmlwdEhhbmRsZXIoY2h1bmtJZCwgJ3RyYXZlbHMnLCBkb25lLCB1cmwpO1xuICAgIH0gZWxzZSBpZiAoa2V5KSB7XG4gICAgICBsb2FkU2NyaXB0SGFuZGxlcihrZXksIHVuZGVmaW5lZCwgZG9uZSwgdXJsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9hZEhvdFVwZGF0ZUhhbmRsZXIodXJsLCBkb25lKTtcbiAgICB9XG4gIH07XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvbm9kZV9tb2R1bGVfZGVjb3JhdG9yXG4hZnVuY3Rpb24oKSB7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLm5tZCA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuICBtb2R1bGUucGF0aHMgPSBbXTtcbiAgaWYgKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xuICByZXR1cm4gbW9kdWxlO1xufTtcbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9wdWJsaWNfcGF0aFxuIWZ1bmN0aW9uKCkge1xuX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJub29wOi8vL1wiO1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL3JlcGFjay9ndWFyZGVkIHJlcXVpcmVcbiFmdW5jdGlvbigpIHtcbiAgdmFyIGluR3VhcmQgPSBmYWxzZTtcbiAgdmFyIG9yaWdpbmFsV2VicGFja1JlcXVpcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fO1xuICBmdW5jdGlvbiBndWFyZGVkV2VicGFja1JlcXVpcmUobW9kdWxlSWQpIHtcbiAgICBpZiAoIWluR3VhcmQgJiYgc2VsZi5FcnJvclV0aWxzKSB7XG4gICAgICBpbkd1YXJkID0gdHJ1ZTtcbiAgICAgIGxldCBleHBvcnRzO1xuICAgICAgdHJ5IHtcbiAgICAgICAgZXhwb3J0cyA9IG9yaWdpbmFsV2VicGFja1JlcXVpcmUobW9kdWxlSWQpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBzZWxmLkVycm9yVXRpbHMucmVwb3J0RmF0YWxFcnJvcihlKTtcbiAgICAgIH1cbiAgICAgIGluR3VhcmQgPSBmYWxzZTtcbiAgICAgIHJldHVybiBleHBvcnRzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gb3JpZ2luYWxXZWJwYWNrUmVxdWlyZShtb2R1bGVJZCk7XG4gICAgfVxuICB9XG4gIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9yaWdpbmFsV2VicGFja1JlcXVpcmUpLmZvckVhY2goa2V5ID0+IHtcbiAgICBndWFyZGVkV2VicGFja1JlcXVpcmVba2V5XSA9IG9yaWdpbmFsV2VicGFja1JlcXVpcmVba2V5XTtcbiAgfSk7XG4gIF9fd2VicGFja19yZXF1aXJlX18gPSBndWFyZGVkV2VicGFja1JlcXVpcmU7XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvcmVwYWNrL2luaXRcbiFmdW5jdGlvbigpIHtcbiAgdmFyIHJlcGFja1J1bnRpbWUgPSB7XG4gICAgc2hhcmVkOiBzZWxmLl9fcmVwYWNrX18gJiYgc2VsZi5fX3JlcGFja19fLnNoYXJlZCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjayAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjay5zaGFyZWQgfHwge1xuICAgICAgc2NyaXB0TWFuYWdlcjogdW5kZWZpbmVkXG4gICAgfVxuICB9O1xuICBfX3dlYnBhY2tfcmVxdWlyZV9fLnJlcGFjayA9IHNlbGYuX19yZXBhY2tfXyA9IHJlcGFja1J1bnRpbWU7XG59KCk7XG4vLyB3ZWJwYWNrL3J1bnRpbWUvcnNwYWNrX3ZlcnNpb25cbiFmdW5jdGlvbigpIHtcbl9fd2VicGFja19yZXF1aXJlX18ucnYgPSBmdW5jdGlvbigpIHsgcmV0dXJuIFwiMS4zLjE1XCI7IH1cbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9zaGFyaW5nXG4hZnVuY3Rpb24oKSB7XG5cbl9fd2VicGFja19yZXF1aXJlX18uUyA9IHt9O1xuX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplU2hhcmluZ0RhdGEgPSB7IHNjb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc6IHsgXCJkZWZhdWx0XCI6IFt7IG5hbWU6IFwiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9yc1wiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX2luZGV4X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcIkByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHNcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzhjN2FcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3JlYWN0LW5hdGl2ZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLWZkMzA5MFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19fZ2V0X2Nqcy1ub2RlX21vZHVsZXNfc3djX2hlbHBlcnNfY2pzX19pbnRlcm9wX3JlcXVpcmVfd2lsZGNhcmRfLWRkMjU3ZVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzL2luZGV4LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5XCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0ltYWdlX0Fzc2V0UmVnaXN0cnlfanMtXzI0NTUxXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5LmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtX2ZhOGNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19zd2NfaGVscGVyc19janNfX2NsYXNzX3ByaXZhdGVfZmllbGRfbG9vc2VfYmFzZV9janMtbm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqcy0zMTIyN2JcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5LmpzXCIpOyB9OyB9KTsgfSwgZWFnZXI6IDAsIHNpbmdsZXRvbjogMSwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiB9LCB7IG5hbWU6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19OYXRpdmVDb21wb25lbnRfVmlld0Nvbi05OTFjOGFcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlLmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0X2pzeC1ydW50aW1lX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0TmF0aXZlX1JlbmRlcmVyUHJveHlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV9mYThjXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fOGM3YVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlXCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX2NhbGxzdGFja19yZXBhY2tfZGlzdF9tb2R1bGVzX0VtcHR5TW9kdWxlX2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9FbXB0eU1vZHVsZS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL2Rpc3QvbW9kdWxlcy9FbXB0eU1vZHVsZS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV9mYThjXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fOGM3YVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZS5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZS5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIiwgdmVyc2lvbjogXCIwLjc4LjBcIiwgZmFjdG9yeTogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfU3R5bGVTaGVldF9wcm9jZXNzQ29sb3JfanNcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yLmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvci5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIm5vZGVfbW9kdWxlc19pbnZhcmlhbnRfYnJvd3Nlcl9qcy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19TdHlsZVNoZWV0X3Byb2Nlc3NDb2xvci1lODZlZTZcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkuanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkuanNcIik7IH07IH0pOyB9LCBlYWdlcjogMCwgc2luZ2xldG9uOiAxLCByZXF1aXJlZFZlcnNpb246IFwiKlwiIH0sIHsgbmFtZTogXCJyZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCIsIHZlcnNpb246IFwiMC43OC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfVHVyYm9Nb2R1bGVfVHVyYm9Nb2R1bGVSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX3NyY19wcml2YXRlX2ZlYXR1cmVmbGFnc19SZWFjdE5hdGl2ZUZlYXR1cmVGbGFnc19qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3N3Y19oZWxwZXJzX2Nqc19faW50ZXJvcF9yZXF1aXJlX3dpbGRjYXJkX2Nqcy1ub2RlX21vZHVsZXNfaW52YXJpYW50X2Jyb3dzZXJfanNcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLmpzICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIgfSwgeyBuYW1lOiBcInJlYWN0LW5hdGl2ZVwiLCB2ZXJzaW9uOiBcIjAuNzguMFwiLCBmYWN0b3J5OiBmdW5jdGlvbigpIHsgcmV0dXJuIFByb21pc2UuYWxsKFtfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1R1cmJvTW9kdWxlX1R1cmJvTW9kdWxlUmVnaXN0cnlfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9qc3gtcnVudGltZV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV9mYThjXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fOGM3YVwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsLTk2YTY5NlwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzLWY2MTM3OVwiKV0pLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qcyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEgfSwgeyBuYW1lOiBcInJlYWN0XCIsIHZlcnNpb246IFwiMTkuMC4wXCIsIGZhY3Rvcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9ub2RlX21vZHVsZXMvcmVhY3QvaW5kZXguanMgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0sIGVhZ2VyOiAwLCBzaW5nbGV0b246IDEgfV0gfSwgdW5pcXVlTmFtZTogXCJ0cmF2ZWxzXCIgfTtcbl9fd2VicGFja19yZXF1aXJlX18uSSA9IF9fd2VicGFja19yZXF1aXJlX18uSSB8fCBmdW5jdGlvbigpIHsgdGhyb3cgbmV3IEVycm9yKFwic2hvdWxkIGhhdmUgX193ZWJwYWNrX3JlcXVpcmVfXy5JXCIpIH1cblxufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2NvbnN1bWVzX2xvYWRpbmdcbiFmdW5jdGlvbigpIHtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5jb25zdW1lc0xvYWRpbmdEYXRhID0geyBjaHVua01hcHBpbmc6IHtcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnNcIl0sXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWwtOTZhNjk2XCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlXCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxpemVDb3JlXCJdLFwiX19mZWRlcmF0aW9uX2V4cG9zZV9BcHBcIjpbXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9yZWFjdC1uYXRpdmU/NWQ4Y1wiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD85YWQ0XCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3JlZ2lzdHJ5X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnLTVkMWVhZVwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnlcIl0sXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fOGM3YVwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QvcmVhY3Q/OGM3YVwiXSxcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3JlYWN0LW5hdGl2ZVwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT9kOGJhXCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzLWZkMzA5MFwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZ2lzdHJ5X3BhdGgtc3VwcG9ydF9yZWFjdC1uYXRpdmVfYXNzZXRzLTM1ZjE1NFwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0L0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydFwiXSxcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV9mYThjXCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC9yZWFjdD9mYThjXCJdLFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHNfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzLWY2MTM3OVwiOltcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeVwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmVcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlcIixcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eVwiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5XCIsXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0c1wiLFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIl0sXCJ0cmF2ZWxzXCI6W1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlPzgyOGJcIl19LCBtb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nOiB7IFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlP2Q4YmFcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmVcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV9mYThjXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X3JlYWN0LW5hdGl2ZV9hc3NldHMtMzVmMTU0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWwtOTZhNjk2XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHMtZjYxMzc5XCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL2luZGV4LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncy9yZWFjdC1uYXRpdmUvc3JjL3ByaXZhdGUvZmVhdHVyZWZsYWdzL1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcIiwgaW1wb3J0OiBcInJlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncyAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9zcmMvcHJpdmF0ZS9mZWF0dXJlZmxhZ3MvUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3RQcml2YXRlL1JlYWN0TmF0aXZlUHJpdmF0ZUludGVyZmFjZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW50ZXJmYWNlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfTmF0aXZlQ29tcG9uZW50X05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX1JlYWN0UHJpdmF0ZV9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2VfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbnRlcmZhY2UuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9OYXRpdmVDb21wb25lbnRSZWdpc3RyeVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L05hdGl2ZUNvbXBvbmVudFJlZ2lzdHJ5ICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvTmF0aXZlQ29tcG9uZW50UmVnaXN0cnkuanNcIik7IH07IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvSW1hZ2UvQXNzZXRSZWdpc3RyeS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9JbWFnZS9Bc3NldFJlZ2lzdHJ5XCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19JbWFnZV9Bc3NldFJlZ2lzdHJ5X2pzLV8yNDU1MFwiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnkgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL0ltYWdlL0Fzc2V0UmVnaXN0cnkuanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvclwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvclwiLCByZXF1aXJlZFZlcnNpb246IFwiKlwiLCBzdHJpY3RWZXJzaW9uOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlLCBlYWdlcjogZmFsc2UsIGZhbGxiYWNrOiBmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvciAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3IuanNcIik7IH07IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0PzhjN2FcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3RcIiwgaW1wb3J0OiBcInJlYWN0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0P2ZhOGNcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3RcIiwgaW1wb3J0OiBcInJlYWN0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCJeMTkuMC4wXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfaW5kZXhfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC9pbmRleC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvbm9ybWFsaXplLWNvbG9ycy9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnNcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwiQHJlYWN0LW5hdGl2ZS9ub3JtYWxpemUtY29sb3JzXCIsIGltcG9ydDogXCJAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnNcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfbm9ybWFsaXplLWNvbG9yc19pbmRleF9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL25vcm1hbGl6ZS1jb2xvcnMvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9wYXRoLXN1cHBvcnQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydFwiLCBpbXBvcnQ6IFwiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcGF0aC1zdXBwb3J0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X2pzXCIpLnRoZW4oZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIEByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydCAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3BhdGgtc3VwcG9ydC5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0L3JlYWN0PzlhZDRcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3RcIiwgaW1wb3J0OiBcInJlYWN0XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIxOS4wLjBcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdF9pbmRleF9qc1wiKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdCAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0L2luZGV4LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT84MjhiXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCI+PTAuNzRcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3ROYXRpdmVfUmVuZGVyZXJQcm94eV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19Db21wb25lbnRzX0FjY2Vzc2liaWxpdHlJbmZvX2xlZ2FjeVNlbmRBY2Nlc3NpYmlsLWY5MjcxOFwiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX2luZGV4X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzX3JlYWN0LW5hdGl2ZV9ub3JtYWxpemUtY29sb3JzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWctNWQxZWFlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCItd2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdF9yZWFjdC1fZmE4Y1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwiLXdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RfcmVhY3QtXzhjN2FcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9wYXRoLXN1cHBvcnRfcmVhY3QtbmF0aXZlX2Fzc2V0cy0zNWYxNTRcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbC05NmE2OTZcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX3ZpcnR1YWxpemVkLWxpc3RzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0cy1mNjEzNzlcIildKS50aGVuKGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5XCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvU3R5bGVTaGVldC9wcm9jZXNzQ29sb3JBcnJheVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9TdHlsZVNoZWV0L3Byb2Nlc3NDb2xvckFycmF5XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1N0eWxlU2hlZXQvcHJvY2Vzc0NvbG9yQXJyYXkuanNcIik7IH07IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMvQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0c1wiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzXCIsIGltcG9ydDogXCJAcmVhY3QtbmF0aXZlL3ZpcnR1YWxpemVkLWxpc3RzXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gUHJvbWlzZS5hbGwoW19fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19pbmRleF9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwid2VicGFja19zaGFyaW5nX2NvbnN1bWVfZGVmYXVsdF9yZWFjdC1uYXRpdmVfcmVhY3QtbmF0aXZlXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9zcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3MtZmQzMDkwXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHJlYWN0LW5hdGl2ZS92aXJ0dWFsaXplZC1saXN0cyAqLyBcIi4vbm9kZV9tb2R1bGVzL0ByZWFjdC1uYXRpdmUvdmlydHVhbGl6ZWQtbGlzdHMvaW5kZXguanNcIik7IH07IH0pOyB9IH0sIFwid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdFByaXZhdGVfUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmVfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdFByaXZhdGUvUmVhY3ROYXRpdmVQcml2YXRlSW5pdGlhbGl6ZUNvcmUgKi8gXCIuL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0UHJpdmF0ZS9SZWFjdE5hdGl2ZVByaXZhdGVJbml0aWFsaXplQ29yZS5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eS9yZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwicmVhY3QtbmF0aXZlL0xpYnJhcmllcy9SZWFjdE5hdGl2ZS9SZW5kZXJlclByb3h5XCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHlcIiwgcmVxdWlyZWRWZXJzaW9uOiBcIipcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBmdW5jdGlvbigpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eSAqLyBcIi4vbm9kZV9tb2R1bGVzL3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvUmVhY3ROYXRpdmUvUmVuZGVyZXJQcm94eS5qc1wiKTsgfTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvcmVhY3QtbmF0aXZlL3JlYWN0LW5hdGl2ZT81ZDhjXCI6IHsgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsIHNoYXJlS2V5OiBcInJlYWN0LW5hdGl2ZVwiLCBpbXBvcnQ6IFwicmVhY3QtbmF0aXZlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIwLjc4LjBcIiwgc3RyaWN0VmVyc2lvbjogZmFsc2UsIHNpbmdsZXRvbjogdHJ1ZSwgZWFnZXI6IGZhbHNlLCBmYWxsYmFjazogZnVuY3Rpb24oKSB7IHJldHVybiBQcm9taXNlLmFsbChbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19UdXJib01vZHVsZV9UdXJib01vZHVsZVJlZ2lzdHJ5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfc3JjX3ByaXZhdGVfZmVhdHVyZWZsYWdzX1JlYWN0TmF0aXZlRmVhdHVyZUZsYWdzX2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX05hdGl2ZUNvbXBvbmVudF9OYXRpdmVDb21wb25lbnRSZWdpc3RyeV9qc1wiKSwgX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtbmF0aXZlX0xpYnJhcmllc19SZWFjdE5hdGl2ZV9SZW5kZXJlclByb3h5X2pzXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfTGlicmFyaWVzX0NvbXBvbmVudHNfQWNjZXNzaWJpbGl0eUluZm9fbGVnYWN5U2VuZEFjY2Vzc2liaWwtZjkyNzE4XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yZWFjdC1uYXRpdmVfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNfcmVhY3QtbmF0aXZlX25vcm1hbGl6ZS1jb2xvcnNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIndlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3QtbmF0aXZlX2Fzc2V0cy1yZWdpc3RyeV9yZWdpc3RyeV9yZWFjdC1uYXRpdmVfYXNzZXRzLXJlZy01ZDFlYWVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV9mYThjXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcGF0aC1zdXBwb3J0X3JlYWN0LW5hdGl2ZV9hc3NldHMtMzVmMTU0XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9MaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWwtOTZhNjk2XCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV92aXJ0dWFsaXplZC1saXN0c19yZWFjdC1uYXRpdmVfdmlydHVhbGl6ZWQtbGlzdHMtZjYxMzc5XCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QtbmF0aXZlICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL2luZGV4LmpzXCIpOyB9OyB9KTsgfSB9LCBcIndlYnBhY2svc2hhcmluZy9jb25zdW1lL2RlZmF1bHQvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkvQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnlcIjogeyBzaGFyZVNjb3BlOiBcImRlZmF1bHRcIiwgc2hhcmVLZXk6IFwiQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnlcIiwgaW1wb3J0OiBcIkByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5XCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwibm9kZV9tb2R1bGVzX3JlYWN0LW5hdGl2ZV9hc3NldHMtcmVnaXN0cnlfcmVnaXN0cnlfanNcIikudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQHJlYWN0LW5hdGl2ZS9hc3NldHMtcmVnaXN0cnkvcmVnaXN0cnkgKi8gXCIuL25vZGVfbW9kdWxlcy9AcmVhY3QtbmF0aXZlL2Fzc2V0cy1yZWdpc3RyeS9yZWdpc3RyeS5qc1wiKTsgfTsgfSk7IH0gfSwgXCJ3ZWJwYWNrL3NoYXJpbmcvY29uc3VtZS9kZWZhdWx0L3JlYWN0LW5hdGl2ZS9MaWJyYXJpZXMvTmF0aXZlQ29tcG9uZW50L1ZpZXdDb25maWdJZ25vcmUvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZVwiOiB7IHNoYXJlU2NvcGU6IFwiZGVmYXVsdFwiLCBzaGFyZUtleTogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlXCIsIGltcG9ydDogXCJyZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlXCIsIHJlcXVpcmVkVmVyc2lvbjogXCIqXCIsIHN0cmljdFZlcnNpb246IGZhbHNlLCBzaW5nbGV0b246IHRydWUsIGVhZ2VyOiBmYWxzZSwgZmFsbGJhY2s6IGZ1bmN0aW9uKCkgeyByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdC1uYXRpdmUvTGlicmFyaWVzL05hdGl2ZUNvbXBvbmVudC9WaWV3Q29uZmlnSWdub3JlICovIFwiLi9ub2RlX21vZHVsZXMvcmVhY3QtbmF0aXZlL0xpYnJhcmllcy9OYXRpdmVDb21wb25lbnQvVmlld0NvbmZpZ0lnbm9yZS5qc1wiKTsgfTsgfSB9IH0sIGluaXRpYWxDb25zdW1lczogW1wid2VicGFjay9zaGFyaW5nL2NvbnN1bWUvZGVmYXVsdC9yZWFjdC1uYXRpdmUvcmVhY3QtbmF0aXZlPzgyOGJcIl0gfTtcbl9fd2VicGFja19yZXF1aXJlX18uZi5jb25zdW1lcyA9IF9fd2VicGFja19yZXF1aXJlX18uZi5jb25zdW1lcyB8fCBmdW5jdGlvbigpIHsgdGhyb3cgbmV3IEVycm9yKFwic2hvdWxkIGhhdmUgX193ZWJwYWNrX3JlcXVpcmVfXy5mLmNvbnN1bWVzXCIpIH1cbn0oKTtcbi8vIHdlYnBhY2svcnVudGltZS9pbml0aWFsaXplX2V4cG9zZXNcbiFmdW5jdGlvbigpIHtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEgPSB7XG4gIG1vZHVsZU1hcDoge1xuICBcIi4vQXBwXCI6IGZ1bmN0aW9uKCkge1xucmV0dXJuIFByb21pc2UuYWxsKC8qISAgfCBfX2ZlZGVyYXRpb25fZXhwb3NlX0FwcCAqLyBbX193ZWJwYWNrX3JlcXVpcmVfXy5lKFwidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3RfanN4LXJ1bnRpbWVfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcInZlbmRvcnMtbm9kZV9tb2R1bGVzX3Nob3BpZnlfcmVhY3QtbmF0aXZlLXBlcmZvcm1hbmNlX2Rpc3RfaW5kZXhfanNcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIi13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0LV84YzdhXCIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoXCJ3ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0LW5hdGl2ZV9yZWFjdC1uYXRpdmVcIiksIF9fd2VicGFja19yZXF1aXJlX18uZShcIl9fZmVkZXJhdGlvbl9leHBvc2VfQXBwXCIpXSkudGhlbihmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKCkgeyByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9BcHAuanMgKi8gXCIuL0FwcC5qc1wiKTsgfTsgfSk7XG59LFxufSxcbiAgc2hhcmVTY29wZTogXCJkZWZhdWx0XCIsXG59O1xuX193ZWJwYWNrX3JlcXVpcmVfXy5nZXRDb250YWluZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmdldENvbnRhaW5lciB8fCBmdW5jdGlvbigpIHsgdGhyb3cgbmV3IEVycm9yKFwic2hvdWxkIGhhdmUgX193ZWJwYWNrX3JlcXVpcmVfXy5nZXRDb250YWluZXJcIikgfTtfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRDb250YWluZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRDb250YWluZXIgfHwgZnVuY3Rpb24oKSB7IHRocm93IG5ldyBFcnJvcihcInNob3VsZCBoYXZlIF9fd2VicGFja19yZXF1aXJlX18uaW5pdENvbnRhaW5lclwiKSB9O1xufSgpO1xuLy8gd2VicGFjay9ydW50aW1lL2pzb25wX2NodW5rX2xvYWRpbmdcbiFmdW5jdGlvbigpIHtcblxuICAgICAgLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3NcbiAgICAgIC8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuICAgICAgLy8gW3Jlc29sdmUsIHJlamVjdCwgUHJvbWlzZV0gPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG4gICAgICB2YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1widHJhdmVsc1wiOiAwLH07XG4gICAgICBcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5mLmogPSBmdW5jdGlvbiAoY2h1bmtJZCwgcHJvbWlzZXMpIHtcbiAgICAgICAgICAvLyBKU09OUCBjaHVuayBsb2FkaW5nIGZvciBqYXZhc2NyaXB0XG52YXIgaW5zdGFsbGVkQ2h1bmtEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZClcblx0PyBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1cblx0OiB1bmRlZmluZWQ7XG5pZiAoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSB7XG5cdC8vIDAgbWVhbnMgXCJhbHJlYWR5IGluc3RhbGxlZFwiLlxuXG5cdC8vIGEgUHJvbWlzZSBtZWFucyBcImN1cnJlbnRseSBsb2FkaW5nXCIuXG5cdGlmIChpbnN0YWxsZWRDaHVua0RhdGEpIHtcblx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSk7XG5cdH0gZWxzZSB7XG5cdFx0aWYgKCEvXihcXC13ZWJwYWNrX3NoYXJpbmdfY29uc3VtZV9kZWZhdWx0X3JlYWN0X3JlYWN0XFwtXyg4YzdhfGZhOGMpfHdlYnBhY2tfc2hhcmluZ19jb25zdW1lX2RlZmF1bHRfcmVhY3RcXC1uYXRpdmVfKGFzc2V0c1xcLXJlZ2lzdHJ5XyhwYXRoXFwtc3VwcG9ydF9yZWFjdFxcLW5hdGl2ZV9hc3NldHNcXC0zNWYxNTR8cmVnaXN0cnlfcmVhY3RcXC1uYXRpdmVfYXNzZXRzXFwtcmVnXFwtNWQxZWFlKXxMaWJyYXJpZXNfUmVhY3RQcml2YXRlX1JlYWN0TmF0aXZlUHJpdmF0ZUluaXRpYWxcXC05NmE2OTZ8bm9ybWFsaXplXFwtY29sb3JzX3JlYWN0XFwtbmF0aXZlX25vcm1hbGl6ZVxcLWNvbG9yc3xyZWFjdFxcLW5hdGl2ZXxzcmNfcHJpdmF0ZV9mZWF0dXJlZmxhZ3NfUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3NcXC1mZDMwOTB8dmlydHVhbGl6ZWRcXC1saXN0c19yZWFjdFxcLW5hdGl2ZV92aXJ0dWFsaXplZFxcLWxpc3RzXFwtZjYxMzc5KSkkLy50ZXN0KGNodW5rSWQpKSB7XG5cdFx0XHQvLyBzZXR1cCBQcm9taXNlIGluIGNodW5rIGNhY2hlXG5cdFx0XHR2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgeyBpbnN0YWxsZWRDaHVua0RhdGEgPSBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSBbcmVzb2x2ZSwgcmVqZWN0XTsgfSk7XG5cdFx0XHRwcm9taXNlcy5wdXNoKChpbnN0YWxsZWRDaHVua0RhdGFbMl0gPSBwcm9taXNlKSk7XG5cblx0XHRcdC8vIHN0YXJ0IGNodW5rIGxvYWRpbmdcblx0XHRcdHZhciB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCk7XG5cdFx0XHQvLyBjcmVhdGUgZXJyb3IgYmVmb3JlIHN0YWNrIHVud291bmQgdG8gZ2V0IHVzZWZ1bCBzdGFja3RyYWNlIGxhdGVyXG5cdFx0XHR2YXIgZXJyb3IgPSBuZXcgRXJyb3IoKTtcblx0XHRcdHZhciBsb2FkaW5nRW5kZWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpKSB7XG5cdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdO1xuXHRcdFx0XHRcdGlmIChpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRpZiAoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdFx0XHR2YXIgZXJyb3JUeXBlID1cblx0XHRcdFx0XHRcdFx0ZXZlbnQgJiYgKGV2ZW50LnR5cGUgPT09ICdsb2FkJyA/ICdtaXNzaW5nJyA6IGV2ZW50LnR5cGUpO1xuXHRcdFx0XHRcdFx0dmFyIHJlYWxTcmMgPSBldmVudCAmJiBldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LnNyYztcblx0XHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UgPVxuXHRcdFx0XHRcdFx0XHQnTG9hZGluZyBjaHVuayAnICtcblx0XHRcdFx0XHRcdFx0Y2h1bmtJZCArXG5cdFx0XHRcdFx0XHRcdCcgZmFpbGVkLlxcbignICtcblx0XHRcdFx0XHRcdFx0ZXJyb3JUeXBlICtcblx0XHRcdFx0XHRcdFx0JzogJyArXG5cdFx0XHRcdFx0XHRcdHJlYWxTcmMgK1xuXHRcdFx0XHRcdFx0XHQnKSc7XG5cdFx0XHRcdFx0XHRlcnJvci5uYW1lID0gJ0NodW5rTG9hZEVycm9yJztcblx0XHRcdFx0XHRcdGVycm9yLnR5cGUgPSBlcnJvclR5cGU7XG5cdFx0XHRcdFx0XHRlcnJvci5yZXF1ZXN0ID0gcmVhbFNyYztcblx0XHRcdFx0XHRcdGluc3RhbGxlZENodW5rRGF0YVsxXShlcnJvcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5sKHVybCwgbG9hZGluZ0VuZGVkLCBcImNodW5rLVwiICsgY2h1bmtJZCwgY2h1bmtJZCk7XG5cdFx0fSBlbHNlIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG5cblx0fVxufVxuXG4gICAgICAgIH1cbiAgICAgICAgLy8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG52YXIgd2VicGFja0pzb25wQ2FsbGJhY2sgPSBmdW5jdGlvbihwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiwgZGF0YSkge1xuXHR2YXIgY2h1bmtJZHMgPSBkYXRhWzBdO1xudmFyIG1vcmVNb2R1bGVzID0gZGF0YVsxXTtcbnZhciBydW50aW1lID0gZGF0YVsyXTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRpZiAoY2h1bmtJZHMuc29tZShmdW5jdGlvbihpZCkgeyByZXR1cm4gaW5zdGFsbGVkQ2h1bmtzW2lkXSAhPT0gMDsgfSkpIHtcblx0XHRmb3IgKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG5cdFx0XHRpZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcblx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHJ1bnRpbWUpIHZhciByZXN1bHQgPSBydW50aW1lKF9fd2VicGFja19yZXF1aXJlX18pO1xuXHR9XG5cdGlmIChwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbikgcGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24oZGF0YSk7XG5cdGZvciAoOyBpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG5cdFx0aWYgKFxuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiZcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVxuXHRcdCkge1xuXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKCk7XG5cdFx0fVxuXHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG5cdH1cblx0XG59O1xuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua3RyYXZlbHNcIl0gPSBzZWxmW1wid2VicGFja0NodW5rdHJhdmVsc1wiXSB8fCBbXTtcbmNodW5rTG9hZGluZ0dsb2JhbC5mb3JFYWNoKHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgMCkpO1xuY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2ggPSB3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIGNodW5rTG9hZGluZ0dsb2JhbC5wdXNoLmJpbmQoY2h1bmtMb2FkaW5nR2xvYmFsKSk7XG5cbn0oKTtcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vLyBtb2R1bGUgY2FjaGUgYXJlIHVzZWQgc28gZW50cnkgaW5saW5pbmcgaXMgZGlzYWJsZWRcbi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXyhcIkBtb2R1bGUtZmVkZXJhdGlvbi9ydW50aW1lL3JzcGFjay5qcyE9IWRhdGE6dGV4dC9qYXZhc2NyaXB0LGltcG9ydCBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3RyYXZlbHMvbm9kZV9tb2R1bGVzL0Btb2R1bGUtZmVkZXJhdGlvbi93ZWJwYWNrLWJ1bmRsZXItcnVudGltZS9kaXN0L2luZGV4LmNqcy5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3RyYXZlbHMvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL3Jlc29sdmVyLXBsdWdpbi5qc1xcXCI7aW1wb3J0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fIGZyb20gXFxcIi9ob21lL3JvY2svd29ya3NwYWNlL2JvaWxlcnBsYXRlL3RyYXZlbHMvbm9kZV9tb2R1bGVzL0BjYWxsc3RhY2svcmVwYWNrL21mL2NvcmUtcGx1Z2luLmpzXFxcIjtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX3J1bnRpbWVfcGx1Z2luc19fID0gW19fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMF9fKCksIF9fbW9kdWxlX2ZlZGVyYXRpb25fcnVudGltZV9wbHVnaW5fMV9fKCldO2NvbnN0IF9fbW9kdWxlX2ZlZGVyYXRpb25fcmVtb3RlX2luZm9zX18gPSB7fTtjb25zdCBfX21vZHVsZV9mZWRlcmF0aW9uX2NvbnRhaW5lcl9uYW1lX18gPSBcXFwidHJhdmVsc1xcXCI7Y29uc3QgX19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fID0gXFxcImxvYWRlZC1maXJzdFxcXCI7aWYoKF9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhfHxfX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YSkmJl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbil7dmFyIF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhLF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEsX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhMSxfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVFeHBvc2VzRGF0YSxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyO2NvbnN0IG92ZXJyaWRlPShvYmosa2V5LHZhbHVlKT0+e2lmKCFvYmopcmV0dXJuO2lmKG9ialtrZXldKW9ialtrZXldPXZhbHVlfTtjb25zdCBtZXJnZT0ob2JqLGtleSxmbik9Pntjb25zdCB2YWx1ZT1mbigpO2lmKEFycmF5LmlzQXJyYXkodmFsdWUpKXt2YXIgX29iaixfa2V5O3ZhciBfOyhfPShfb2JqPW9iailbX2tleT1rZXldKSE9PW51bGwmJl8hPT12b2lkIDA/Xzpfb2JqW19rZXldPVtdO29ialtrZXldLnB1c2goLi4udmFsdWUpfWVsc2UgaWYodHlwZW9mIHZhbHVlPT09XFxcIm9iamVjdFxcXCImJnZhbHVlIT09bnVsbCl7dmFyIF9vYmoxLF9rZXkxO3ZhciBfMTsoXzE9KF9vYmoxPW9iailbX2tleTE9a2V5XSkhPT1udWxsJiZfMSE9PXZvaWQgMD9fMTpfb2JqMVtfa2V5MV09e307T2JqZWN0LmFzc2lnbihvYmpba2V5XSx2YWx1ZSl9fTtjb25zdCBlYXJseT0ob2JqLGtleSxpbml0aWFsKT0+e3ZhciBfb2JqLF9rZXk7dmFyIF87KF89KF9vYmo9b2JqKVtfa2V5PWtleV0pIT09bnVsbCYmXyE9PXZvaWQgMD9fOl9vYmpbX2tleV09aW5pdGlhbCgpfTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nQ2h1bmtNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18ucmVtb3Rlc0xvYWRpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YS5jaHVua01hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfY2h1bmtNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nO2NvbnN0IHJlbW90ZXNMb2FkaW5nTW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMT1fX3dlYnBhY2tfcmVxdWlyZV9fLnJlbW90ZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX3JlbW90ZXNMb2FkaW5nRGF0YTE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhMS5tb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19yZW1vdGVzTG9hZGluZ0RhdGFfbW9kdWxlSWRUb1JlbW90ZURhdGFNYXBwaW5nIT09dm9pZCAwP19fd2VicGFja19yZXF1aXJlX19fcmVtb3Rlc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZztjb25zdCBpbml0aWFsaXplU2hhcmluZ1Njb3BlVG9Jbml0RGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPV9fd2VicGFja19yZXF1aXJlX18uaW5pdGlhbGl6ZVNoYXJpbmdEYXRhKT09PW51bGx8fF9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2luaXRpYWxpemVTaGFyaW5nRGF0YS5zY29wZVRvU2hhcmluZ0RhdGFNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZVNoYXJpbmdEYXRhX3Njb3BlVG9TaGFyaW5nRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplU2hhcmluZ0RhdGFfc2NvcGVUb1NoYXJpbmdEYXRhTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZztjb25zdCBjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YT1fX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEuY2h1bmtNYXBwaW5nKSE9PW51bGwmJl9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9jaHVua01hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX2NodW5rTWFwcGluZzp7fTt2YXIgX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc7Y29uc3QgY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9Db25zdW1lRGF0YU1hcHBpbmc9KF9fd2VicGFja19yZXF1aXJlX19fY29uc3VtZXNMb2FkaW5nRGF0YV9tb2R1bGVJZFRvQ29uc3VtZURhdGFNYXBwaW5nPShfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGExLm1vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmcpIT09bnVsbCYmX193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmchPT12b2lkIDA/X193ZWJwYWNrX3JlcXVpcmVfX19jb25zdW1lc0xvYWRpbmdEYXRhX21vZHVsZUlkVG9Db25zdW1lRGF0YU1hcHBpbmc6e307Y29uc3QgY29uc3VtZXNMb2FkaW5naW5zdGFsbGVkTW9kdWxlcz17fTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRQcm9taXNlcz1bXTtjb25zdCBpbml0aWFsaXplU2hhcmluZ0luaXRUb2tlbnM9e307Y29uc3QgY29udGFpbmVyU2hhcmVTY29wZT0oX193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9X193ZWJwYWNrX3JlcXVpcmVfXy5pbml0aWFsaXplRXhwb3Nlc0RhdGEpPT09bnVsbHx8X193ZWJwYWNrX3JlcXVpcmVfX19pbml0aWFsaXplRXhwb3Nlc0RhdGE9PT12b2lkIDA/dm9pZCAwOl9fd2VicGFja19yZXF1aXJlX19faW5pdGlhbGl6ZUV4cG9zZXNEYXRhLnNoYXJlU2NvcGU7Zm9yKGNvbnN0IGtleSBpbiBfX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fKXtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb25ba2V5XT1fX21vZHVsZV9mZWRlcmF0aW9uX2J1bmRsZXJfcnVudGltZV9fW2tleV19ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nXFxcIiwoKT0+e2NvbnN0IGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmc9e307Zm9yKGxldFttb2R1bGVJZCxkYXRhXW9mIE9iamVjdC5lbnRyaWVzKGNvbnN1bWVzTG9hZGluZ01vZHVsZVRvQ29uc3VtZURhdGFNYXBwaW5nKSl7Y29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZ1ttb2R1bGVJZF09e2dldHRlcjpkYXRhLmZhbGxiYWNrLHNoYXJlSW5mbzp7c2hhcmVDb25maWc6e2ZpeGVkRGVwZW5kZW5jaWVzOmZhbHNlLHJlcXVpcmVkVmVyc2lvbjpkYXRhLnJlcXVpcmVkVmVyc2lvbixzdHJpY3RWZXJzaW9uOmRhdGEuc3RyaWN0VmVyc2lvbixzaW5nbGV0b246ZGF0YS5zaW5nbGV0b24sZWFnZXI6ZGF0YS5lYWdlcn0sc2NvcGU6W2RhdGEuc2hhcmVTY29wZV19LHNoYXJlS2V5OmRhdGEuc2hhcmVLZXl9fXJldHVybiBjb25zdW1lc0xvYWRpbmdNb2R1bGVUb0hhbmRsZXJNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJpbml0T3B0aW9uc1xcXCIsKCk9Pih7fSkpO2Vhcmx5KF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5pbml0T3B0aW9ucyxcXFwibmFtZVxcXCIsKCk9Pl9fbW9kdWxlX2ZlZGVyYXRpb25fY29udGFpbmVyX25hbWVfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJzaGFyZVN0cmF0ZWd5XFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9zaGFyZV9zdHJhdGVneV9fKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMsXFxcInNoYXJlZFxcXCIsKCk9Pntjb25zdCBzaGFyZWQ9e307Zm9yKGxldFtzY29wZSxzdGFnZXNdb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbGl6ZVNoYXJpbmdTY29wZVRvSW5pdERhdGFNYXBwaW5nKSl7Zm9yKGxldCBzdGFnZSBvZiBzdGFnZXMpe2lmKHR5cGVvZiBzdGFnZT09PVxcXCJvYmplY3RcXFwiJiZzdGFnZSE9PW51bGwpe2NvbnN0e25hbWUsdmVyc2lvbixmYWN0b3J5LGVhZ2VyLHNpbmdsZXRvbixyZXF1aXJlZFZlcnNpb24sc3RyaWN0VmVyc2lvbn09c3RhZ2U7Y29uc3Qgc2hhcmVDb25maWc9e307Y29uc3QgaXNWYWxpZFZhbHVlPWZ1bmN0aW9uKHZhbCl7cmV0dXJuIHR5cGVvZiB2YWwhPT1cXFwidW5kZWZpbmVkXFxcIn07aWYoaXNWYWxpZFZhbHVlKHNpbmdsZXRvbikpe3NoYXJlQ29uZmlnLnNpbmdsZXRvbj1zaW5nbGV0b259aWYoaXNWYWxpZFZhbHVlKHJlcXVpcmVkVmVyc2lvbikpe3NoYXJlQ29uZmlnLnJlcXVpcmVkVmVyc2lvbj1yZXF1aXJlZFZlcnNpb259aWYoaXNWYWxpZFZhbHVlKGVhZ2VyKSl7c2hhcmVDb25maWcuZWFnZXI9ZWFnZXJ9aWYoaXNWYWxpZFZhbHVlKHN0cmljdFZlcnNpb24pKXtzaGFyZUNvbmZpZy5zdHJpY3RWZXJzaW9uPXN0cmljdFZlcnNpb259Y29uc3Qgb3B0aW9ucz17dmVyc2lvbixzY29wZTpbc2NvcGVdLHNoYXJlQ29uZmlnLGdldDpmYWN0b3J5fTtpZihzaGFyZWRbbmFtZV0pe3NoYXJlZFtuYW1lXS5wdXNoKG9wdGlvbnMpfWVsc2V7c2hhcmVkW25hbWVdPVtvcHRpb25zXX19fX1yZXR1cm4gc2hhcmVkfSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+T2JqZWN0LnZhbHVlcyhfX21vZHVsZV9mZWRlcmF0aW9uX3JlbW90ZV9pbmZvc19fKS5mbGF0KCkuZmlsdGVyKHJlbW90ZT0+cmVtb3RlLmV4dGVybmFsVHlwZT09PVxcXCJzY3JpcHRcXFwiKSk7bWVyZ2UoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmluaXRPcHRpb25zLFxcXCJwbHVnaW5zXFxcIiwoKT0+X19tb2R1bGVfZmVkZXJhdGlvbl9ydW50aW1lX3BsdWdpbnNfXyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLFxcXCJidW5kbGVyUnVudGltZU9wdGlvbnNcXFwiLCgpPT4oe30pKTtlYXJseShfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLFxcXCJyZW1vdGVzXFxcIiwoKT0+KHt9KSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJjaHVua01hcHBpbmdcXFwiLCgpPT5yZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZ1xcXCIsKCk9Pntjb25zdCByZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZz17fTtmb3IobGV0W21vZHVsZUlkLGRhdGFdb2YgT2JqZWN0LmVudHJpZXMocmVtb3Rlc0xvYWRpbmdNb2R1bGVJZFRvUmVtb3RlRGF0YU1hcHBpbmcpKXtyZW1vdGVzTG9hZGluZ0lkVG9FeHRlcm5hbEFuZE5hbWVNYXBwaW5nTWFwcGluZ1ttb2R1bGVJZF09W2RhdGEuc2hhcmVTY29wZSxkYXRhLm5hbWUsZGF0YS5leHRlcm5hbE1vZHVsZUlkLGRhdGEucmVtb3RlTmFtZV19cmV0dXJuIHJlbW90ZXNMb2FkaW5nSWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmdNYXBwaW5nfSk7ZWFybHkoX193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lT3B0aW9ucy5yZW1vdGVzLFxcXCJ3ZWJwYWNrUmVxdWlyZVxcXCIsKCk9Pl9fd2VicGFja19yZXF1aXJlX18pO21lcmdlKF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZU9wdGlvbnMucmVtb3RlcyxcXFwiaWRUb1JlbW90ZU1hcFxcXCIsKCk9Pntjb25zdCBpZFRvUmVtb3RlTWFwPXt9O2ZvcihsZXRbaWQscmVtb3RlRGF0YV1vZiBPYmplY3QuZW50cmllcyhyZW1vdGVzTG9hZGluZ01vZHVsZUlkVG9SZW1vdGVEYXRhTWFwcGluZykpe2NvbnN0IGluZm89X19tb2R1bGVfZmVkZXJhdGlvbl9yZW1vdGVfaW5mb3NfX1tyZW1vdGVEYXRhLnJlbW90ZU5hbWVdO2lmKGluZm8paWRUb1JlbW90ZU1hcFtpZF09aW5mb31yZXR1cm4gaWRUb1JlbW90ZU1hcH0pO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcIlNcXFwiLF9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5TKTtpZihfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYXR0YWNoU2hhcmVTY29wZU1hcCl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmF0dGFjaFNoYXJlU2NvcGVNYXAoX193ZWJwYWNrX3JlcXVpcmVfXyl9b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXy5mLFxcXCJyZW1vdGVzXFxcIiwoY2h1bmtJZCxwcm9taXNlcyk9Pl9fd2VicGFja19yZXF1aXJlX18uZmVkZXJhdGlvbi5idW5kbGVyUnVudGltZS5yZW1vdGVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpyZW1vdGVzTG9hZGluZ0NodW5rTWFwcGluZyxpZFRvRXh0ZXJuYWxBbmROYW1lTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb0V4dGVybmFsQW5kTmFtZU1hcHBpbmcsaWRUb1JlbW90ZU1hcDpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWVPcHRpb25zLnJlbW90ZXMuaWRUb1JlbW90ZU1hcCx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18uZixcXFwiY29uc3VtZXNcXFwiLChjaHVua0lkLHByb21pc2VzKT0+X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmNvbnN1bWVzKHtjaHVua0lkLHByb21pc2VzLGNodW5rTWFwcGluZzpjb25zdW1lc0xvYWRpbmdDaHVua01hcHBpbmcsbW9kdWxlVG9IYW5kbGVyTWFwcGluZzpfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uY29uc3VtZXNMb2FkaW5nTW9kdWxlVG9IYW5kbGVyTWFwcGluZyxpbnN0YWxsZWRNb2R1bGVzOmNvbnN1bWVzTG9hZGluZ2luc3RhbGxlZE1vZHVsZXMsd2VicGFja1JlcXVpcmU6X193ZWJwYWNrX3JlcXVpcmVfX30pKTtvdmVycmlkZShfX3dlYnBhY2tfcmVxdWlyZV9fLFxcXCJJXFxcIiwobmFtZSxpbml0U2NvcGUpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuSSh7c2hhcmVTY29wZU5hbWU6bmFtZSxpbml0U2NvcGUsaW5pdFByb21pc2VzOmluaXRpYWxpemVTaGFyaW5nSW5pdFByb21pc2VzLGluaXRUb2tlbnM6aW5pdGlhbGl6ZVNoYXJpbmdJbml0VG9rZW5zLHdlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX199KSk7b3ZlcnJpZGUoX193ZWJwYWNrX3JlcXVpcmVfXyxcXFwiaW5pdENvbnRhaW5lclxcXCIsKHNoYXJlU2NvcGUsaW5pdFNjb3BlLHJlbW90ZUVudHJ5SW5pdE9wdGlvbnMpPT5fX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uYnVuZGxlclJ1bnRpbWUuaW5pdENvbnRhaW5lckVudHJ5KHtzaGFyZVNjb3BlLGluaXRTY29wZSxyZW1vdGVFbnRyeUluaXRPcHRpb25zLHNoYXJlU2NvcGVLZXk6Y29udGFpbmVyU2hhcmVTY29wZSx3ZWJwYWNrUmVxdWlyZTpfX3dlYnBhY2tfcmVxdWlyZV9ffSkpO292ZXJyaWRlKF9fd2VicGFja19yZXF1aXJlX18sXFxcImdldENvbnRhaW5lclxcXCIsKG1vZHVsZTEsZ2V0U2NvcGUpPT57dmFyIG1vZHVsZU1hcD1fX3dlYnBhY2tfcmVxdWlyZV9fLmluaXRpYWxpemVFeHBvc2VzRGF0YS5tb2R1bGVNYXA7X193ZWJwYWNrX3JlcXVpcmVfXy5SPWdldFNjb3BlO2dldFNjb3BlPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2R1bGVNYXAsbW9kdWxlMSk/bW9kdWxlTWFwW21vZHVsZTFdKCk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKT0+e3Rocm93IG5ldyBFcnJvcignTW9kdWxlIFxcXCInK21vZHVsZTErJ1xcXCIgZG9lcyBub3QgZXhpc3QgaW4gY29udGFpbmVyLicpfSk7X193ZWJwYWNrX3JlcXVpcmVfXy5SPXVuZGVmaW5lZDtyZXR1cm4gZ2V0U2NvcGV9KTtfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5zdGFuY2U9X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLnJ1bnRpbWUuaW5pdChfX3dlYnBhY2tfcmVxdWlyZV9fLmZlZGVyYXRpb24uaW5pdE9wdGlvbnMpO2lmKChfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPV9fd2VicGFja19yZXF1aXJlX18uY29uc3VtZXNMb2FkaW5nRGF0YSk9PT1udWxsfHxfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyPT09dm9pZCAwP3ZvaWQgMDpfX3dlYnBhY2tfcmVxdWlyZV9fX2NvbnN1bWVzTG9hZGluZ0RhdGEyLmluaXRpYWxDb25zdW1lcyl7X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmJ1bmRsZXJSdW50aW1lLmluc3RhbGxJbml0aWFsQ29uc3VtZXMoe3dlYnBhY2tSZXF1aXJlOl9fd2VicGFja19yZXF1aXJlX18saW5zdGFsbGVkTW9kdWxlczpjb25zdW1lc0xvYWRpbmdpbnN0YWxsZWRNb2R1bGVzLGluaXRpYWxDb25zdW1lczpfX3dlYnBhY2tfcmVxdWlyZV9fLmNvbnN1bWVzTG9hZGluZ0RhdGEuaW5pdGlhbENvbnN1bWVzLG1vZHVsZVRvSGFuZGxlck1hcHBpbmc6X193ZWJwYWNrX3JlcXVpcmVfXy5mZWRlcmF0aW9uLmNvbnN1bWVzTG9hZGluZ01vZHVsZVRvSGFuZGxlck1hcHBpbmd9KX19XCIpO1xudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFwid2VicGFjay9jb250YWluZXIvZW50cnkvdHJhdmVsc1wiKTtcbnRyYXZlbHMgPSBfX3dlYnBhY2tfZXhwb3J0c19fO1xufSkoKVxuOy8vIyBzb3VyY2VNYXBwaW5nVVJMPXRyYXZlbHMuY29udGFpbmVyLmJ1bmRsZS5tYXA/cGxhdGZvcm09YW5kcm9pZCIsInJlc3BvbnNlVGltZSI6NDM0MCwiaXNIdG1sIjpmYWxzZX0sImVycm9yIjpudWxsLCJzdGF0dXMiOiJwYXNzIiwiYXNzZXJ0aW9uUmVzdWx0cyI6W10sInRlc3RSZXN1bHRzIjpbXSwicHJlUmVxdWVzdFRlc3RSZXN1bHRzIjpbXSwicG9zdFJlc3BvbnNlVGVzdFJlc3VsdHMiOltdLCJzaG91bGRTdG9wUnVubmVyRXhlY3V0aW9uIjpmYWxzZSwicnVuRHVyYXRpb24iOjUuMzQyNDQ5Mjg3LCJuYW1lIjoiL3RyYXZlbHMvbGVhc3QvYW5kcm9pZC9kZXZlbG9wbWVudC90cmF2ZWxzLmNvbnRhaW5lci5idW5kbGUiLCJwYXRoIjoidHJhdmVscy1sZWFzdC1hbmRyb2lkLWRldmVsb3BtZW50LXRyYXZlbHMuY29udGFpbmVyLmJ1bmRsZSIsIml0ZXJhdGlvbkluZGV4IjoxfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJtb3ZpZXMuanBlZy5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvbW92aWVzLmpwZWciLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJjb25uZWN0IEVUSU1FRE9VVCAxMy4yMTUuMjM5LjIxOTo0NDMiLCJzdGF0dXMiOiJlcnJvciIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjoxLjUwNzU0MDY2LCJuYW1lIjoibW92aWVzLmpwZWciLCJwYXRoIjoibW92aWVzLmpwZWciLCJpdGVyYXRpb25JbmRleCI6MX0seyJ0ZXN0Ijp7ImZpbGVuYW1lIjoibXVzaWNzLmpwZWcuYnJ1In0sInJlcXVlc3QiOnsibWV0aG9kIjoiR0VUIiwidXJsIjoiaHR0cHM6Ly9yZWFjdC1uYXRpdmUtYXJ0aWZhY3RzLm5ldGxpZnkuYXBwL211c2ljcy5qcGVnIiwiaGVhZGVycyI6eyJVc2VyLUFnZW50IjoiaW5zb21uaWEvMTEuMi4wIn0sImlzSHRtbCI6ZmFsc2V9LCJyZXNwb25zZSI6eyJzdGF0dXMiOiJlcnJvciIsInN0YXR1c1RleHQiOm51bGwsImhlYWRlcnMiOm51bGwsImRhdGEiOm51bGwsInJlc3BvbnNlVGltZSI6MCwiaXNIdG1sIjpmYWxzZX0sImVycm9yIjoic29ja2V0IGhhbmcgdXAiLCJzdGF0dXMiOiJlcnJvciIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjo2LjYyNTMxMjc0MiwibmFtZSI6Im11c2ljcy5qcGVnIiwicGF0aCI6Im11c2ljcy5qcGVnIiwiaXRlcmF0aW9uSW5kZXgiOjF9LHsidGVzdCI6eyJmaWxlbmFtZSI6Im91dGRvb3JzLmpwZWcuYnJ1In0sInJlcXVlc3QiOnsibWV0aG9kIjoiR0VUIiwidXJsIjoiaHR0cHM6Ly9yZWFjdC1uYXRpdmUtYXJ0aWZhY3RzLm5ldGxpZnkuYXBwL291dGRvb3JzLmpwZWciLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJjb25uZWN0IEVUSU1FRE9VVCAxMy4yMTUuMjM5LjIxOTo0NDMiLCJzdGF0dXMiOiJlcnJvciIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjoxLjUwOTAzNjM4NiwibmFtZSI6Im91dGRvb3JzLmpwZWciLCJwYXRoIjoib3V0ZG9vcnMuanBlZyIsIml0ZXJhdGlvbkluZGV4IjoxfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJzcG9ydHMuanBnLmJydSJ9LCJyZXF1ZXN0Ijp7Im1ldGhvZCI6IkdFVCIsInVybCI6Imh0dHBzOi8vcmVhY3QtbmF0aXZlLWFydGlmYWN0cy5uZXRsaWZ5LmFwcC9zcG9ydHMuanBnIiwiaGVhZGVycyI6eyJVc2VyLUFnZW50IjoiaW5zb21uaWEvMTEuMi4wIn0sImlzSHRtbCI6ZmFsc2V9LCJyZXNwb25zZSI6eyJzdGF0dXMiOjIwMCwic3RhdHVzVGV4dCI6Ik9LIiwiaGVhZGVycyI6eyJhY2NlcHQtcmFuZ2VzIjoiYnl0ZXMiLCJhZ2UiOiIwIiwiY2FjaGUtY29udHJvbCI6InB1YmxpYyxtYXgtYWdlPTAsbXVzdC1yZXZhbGlkYXRlIiwiY2FjaGUtc3RhdHVzIjoiXCJOZXRsaWZ5IEVkZ2VcIjsgZndkPW1pc3MiLCJjb250ZW50LWxlbmd0aCI6IjEyNDcwNiIsImNvbnRlbnQtdHlwZSI6ImltYWdlL2pwZWciLCJkYXRlIjoiVGh1LCAxNyBKdWwgMjAyNSAxNjoyMToyMSBHTVQiLCJldGFnIjoiXCJlNGQwMWQxOGY4NDI2OTAyNDA2NTYzOGY4MTk0M2ZjZC1zc2xcIiIsInNlcnZlciI6Ik5ldGxpZnkiLCJzdHJpY3QtdHJhbnNwb3J0LXNlY3VyaXR5IjoibWF4LWFnZT0zMTUzNjAwMDsgaW5jbHVkZVN1YkRvbWFpbnM7IHByZWxvYWQiLCJ4LW5mLXJlcXVlc3QtaWQiOiIwMUswQ0sxRkYwOEFCQU5STVQ4TlBHOTZLVCIsImNvbm5lY3Rpb24iOiJjbG9zZSJ9LCJkYXRhIjoiUmVzcG9uc2UgY29udGVudCByZWRhY3RlZCAoaW1hZ2UgZGF0YSkiLCJyZXNwb25zZVRpbWUiOjEzMzc1MywiaXNIdG1sIjpmYWxzZX0sImVycm9yIjpudWxsLCJzdGF0dXMiOiJwYXNzIiwiYXNzZXJ0aW9uUmVzdWx0cyI6W10sInRlc3RSZXN1bHRzIjpbXSwicHJlUmVxdWVzdFRlc3RSZXN1bHRzIjpbXSwicG9zdFJlc3BvbnNlVGVzdFJlc3VsdHMiOltdLCJzaG91bGRTdG9wUnVubmVyRXhlY3V0aW9uIjpmYWxzZSwicnVuRHVyYXRpb24iOjEzNC43NTc2NTEyMywibmFtZSI6InNwb3J0cy5qcGciLCJwYXRoIjoic3BvcnRzLmpwZyIsIml0ZXJhdGlvbkluZGV4IjoxfSx7InRlc3QiOnsiZmlsZW5hbWUiOiJ0cmF2ZWxzLmpwZy5icnUifSwicmVxdWVzdCI6eyJtZXRob2QiOiJHRVQiLCJ1cmwiOiJodHRwczovL3JlYWN0LW5hdGl2ZS1hcnRpZmFjdHMubmV0bGlmeS5hcHAvdHJhdmVscy5qcGciLCJoZWFkZXJzIjp7IlVzZXItQWdlbnQiOiJpbnNvbW5pYS8xMS4yLjAifSwiaXNIdG1sIjpmYWxzZX0sInJlc3BvbnNlIjp7InN0YXR1cyI6ImVycm9yIiwic3RhdHVzVGV4dCI6bnVsbCwiaGVhZGVycyI6bnVsbCwiZGF0YSI6bnVsbCwicmVzcG9uc2VUaW1lIjowLCJpc0h0bWwiOmZhbHNlfSwiZXJyb3IiOiJyZWFkIEVDT05OUkVTRVQiLCJzdGF0dXMiOiJlcnJvciIsImFzc2VydGlvblJlc3VsdHMiOltdLCJ0ZXN0UmVzdWx0cyI6W10sInByZVJlcXVlc3RUZXN0UmVzdWx0cyI6W10sInBvc3RSZXNwb25zZVRlc3RSZXN1bHRzIjpbXSwic2hvdWxkU3RvcFJ1bm5lckV4ZWN1dGlvbiI6ZmFsc2UsInJ1bkR1cmF0aW9uIjoyMDEuOTI0NjgyNjA4LCJuYW1lIjoidHJhdmVscy5qcGciLCJwYXRoIjoidHJhdmVscy5qcGciLCJpdGVyYXRpb25JbmRleCI6MX1dLCJzdW1tYXJ5Ijp7InRvdGFsUmVxdWVzdHMiOjE2LCJwYXNzZWRSZXF1ZXN0cyI6OCwiZmFpbGVkUmVxdWVzdHMiOjAsInNraXBwZWRSZXF1ZXN0cyI6MCwiZXJyb3JSZXF1ZXN0cyI6OCwidG90YWxBc3NlcnRpb25zIjowLCJwYXNzZWRBc3NlcnRpb25zIjowLCJmYWlsZWRBc3NlcnRpb25zIjowLCJ0b3RhbFRlc3RzIjowLCJwYXNzZWRUZXN0cyI6MCwiZmFpbGVkVGVzdHMiOjAsInRvdGFsUHJlUmVxdWVzdFRlc3RzIjowLCJwYXNzZWRQcmVSZXF1ZXN0VGVzdHMiOjAsImZhaWxlZFByZVJlcXVlc3RUZXN0cyI6MCwidG90YWxQb3N0UmVzcG9uc2VUZXN0cyI6MCwicGFzc2VkUG9zdFJlc3BvbnNlVGVzdHMiOjAsImZhaWxlZFBvc3RSZXNwb25zZVRlc3RzIjowfX1d'));
            return mergeTests(rawResults);
          });

          const currentTab = ref('summary');

          const getTabFromQueryParam = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const tab = urlParams.get('tab');
            return tab && ['summary', 'requests'].includes(tab) ? tab : 'summary';
          };

          onMounted(() => {
            currentTab.value = getTabFromQueryParam();
          });

          const darkMode = ref(false);
          const theme = computed(() => {
            return darkMode.value ? naive.darkTheme : null;
          });
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            darkMode.value = true;
          }
          // To watch for os theme changes
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (event) => {
            darkMode.value = event.matches;
          });
          return {
            res,
            theme,
            darkMode,
            darkModeRailStyle: () => ({ background: 'var(--n-rail-color)' }),
            currentTab
          };
        }
      };
      const app = Vue.createApp(App);

      app.component('x-summary', {
        template: '#summary-component',
        props: ['res'],
        setup(props) {
          const summaryColumns = [
            {
              title: 'SUMMARY ITEM',
              key: 'title'
            },
            {
              title: 'TOTAL',
              key: 'total'
            },
            {
              title: 'PASSED',
              key: 'passed'
            },
            {
              title: 'FAILED',
              key: 'failed'
            },
            {
              title: 'SKIPPED',
              key: 'skipped'
            },
            {
              title: 'ERROR',
              key: 'error'
            }
          ];
          const summaryData = computed(() => [
            {
              title: 'Requests',
              total: props.res.summary.totalRequests,
              passed: props.res.summary.passedRequests,
              failed: props.res.summary.failedRequests,
              skipped: props.res.summary.skippedRequests,
              error: props.res.summary.errorRequests
            },
            {
              title: 'Assertions',
              total: props.res.summary.totalAssertions,
              passed: props.res.summary.passedAssertions,
              failed: props.res.summary.failedAssertions,
              skipped: '-',
              error: '-'
            },
            {
              title: 'Tests',
              total: props.res.summary.totalTests,
              passed: props.res.summary.passedTests,
              failed: props.res.summary.failedTests,
              skipped: '-',
              error: '-'
            }
          ]);
          const summaryTotalRequests = computed(() => {
            return props.res.summary.totalRequests;
          });
          const summaryTotalControls = computed(() => {
            return props.res.summary.totalTests + props.res.summary.totalAssertions;
          });
          const summaryFailedControls = computed(
            () => props.res.summary.failedTests + props.res.summary.failedAssertions
          );
          const summarySkippedRequests = computed(() => props?.res?.summary?.skippedRequests || 0);
          const summaryErrors = computed(() => props?.res?.results?.filter((r) => r.error || r.status === 'error').length) || 0;
          const totalRunDuration = computed(() => props.res?.results?.reduce((total, result) => result.runDuration + total, 0));
          const iterationIndex = Number(props.res.iterationIndex) + 1;
          return {
            summaryColumns,
            summaryData,
            summaryTotalControls,
            summaryTotalRequests,
            summaryFailedControls,
            summarySkippedRequests,
            summaryErrors,
            totalRunDuration,
            iterationTitle: 'Iteration ' + iterationIndex
          };
        }
      });

      app.component('x-requests', {
        template: '#requests-component',
        props: ['res'],
        setup(props) {
          const onlyFailed = ref(false);
          const filteredResults = computed(() => {
            if (onlyFailed.value) {
              return props?.res?.results?.filter(
                (r) =>
                  r.status === 'error' ||
                  !!r?.testResults?.find((t) => t.status !== 'pass') ||
                  !!r?.assertionResults?.find((t) => t.status !== 'pass')
              );
            }
            return props.res.results;
          });
          const iterationIndex = Number(props.res.iterationIndex) + 1;
          return {
            onlyFailed,
            results: filteredResults,
            railStyle: ({ checked }) => {
              const style = {};
              if (checked) {
                style.background = '#d03050';
              }
              return style;
            },
            iterationTitle: 'Iteration ' + iterationIndex
          };
        }
      });

      app.component('x-result', {
        template: '#result-component',
        props: ['result'],
        setup(props) {
          const headerColumns = [
            {
              title: 'Header Name',
              key: 'name',
              className: 'min-width-150'
            },
            {
              title: 'Header Value',
              key: 'value'
            }
          ];
          const assertionsColumns = [
            {
              title: 'Expression',
              key: 'lhsExpr'
            },
            {
              title: 'Operator',
              key: 'operator'
            },
            {
              title: 'Operand',
              key: 'rhsOperand'
            },
            {
              title: 'Status',
              key: 'status',
              className: 'status'
            },
            {
              title: 'Error',
              key: 'error'
            }
          ];
          const assertionsRowClassName = (row) => {
            return row.status === 'fail' ? 'error' : 'success';
          };
          const testsRowClassName = (row) => {
            if (row.status === 'skipped') return 'skipped';
            return row.status === 'fail' ? 'error' : 'success';
          };
          const testsColumns = [
            {
              title: 'Description',
              key: 'description'
            },
            {
              title: 'Status',
              key: 'status',
              className: 'status'
            },
            {
              title: 'Error',
              key: 'error'
            }
          ];

          function mapHeaderToTableData(headers) {
            if (!headers) {
              return [];
            }
            return Object.keys(headers).map((name) => ({
              name,
              value: headers[name]
            }));
          }
          const headerDataRequest = computed(() => {
            return mapHeaderToTableData(props?.result?.request?.headers);
          });
          const headerDataResponse = computed(() => {
            return mapHeaderToTableData(props?.result?.response?.headers);
          });
          const totalPassed = computed(() => {
            return (
              (props?.result?.testResults?.filter((t) => t.status === 'pass').length || 0) +
              (props?.result?.assertionResults?.filter((t) => t.status === 'pass').length || 0)
            );
          });
          const total = computed(() => {
            return (props?.result?.testResults?.length || 0) + (props?.result?.assertionResults?.length || 0);
          });

          const hasError = computed(() => !!props?.result?.error || props?.result?.status === 'error');
          const hasFailure = computed(() => total.value !== totalPassed.value);
          const testDuration = computed(() => Math.round(props?.result?.runDuration * 1000) + ' ms');
          const resultTitle = computed(() => props?.result?.path + ' ' + props?.result?.response?.status + ' ' + props?.result?.response?.statusText);
          const getAlertType = computed(() => {
            if (props.result.response.status === 'skipped') {
              return 'warning';
            }
            return hasError.value || hasFailure.value ? 'error' : 'success';
          });
          return {
            headerColumns,
            headerDataRequest,
            headerDataResponse,
            assertionsColumns,
            assertionsRowClassName,
            testsRowClassName,
            totalPassed,
            total,
            hasFailure,
            hasError,
            testsColumns,
            result: props.result,
            testDuration,
            resultTitle,
            getAlertType,
            iterationIndex: props?.result?.iterationIndex
          };
        }
      });

      app.use(naive);
      app.mount('#app');
    </script>
  </body>
</html>
